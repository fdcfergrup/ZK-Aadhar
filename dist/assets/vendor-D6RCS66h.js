var di=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function SR(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function e1(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var r=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(i).forEach(function(t){var a=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(r,t,a.get?a:{enumerable:!0,get:function(){return i[t]}})}),r}function ao(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var We={},cf={exports:{}},uf={exports:{}},mc={},$s={},yp;function t8(){if(yp)return $s;yp=1,$s.byteLength=u,$s.toByteArray=o,$s.fromByteArray=y;for(var i=[],e=[],r=typeof Uint8Array<"u"?Uint8Array:Array,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,n=t.length;a<n;++a)i[a]=t[a],e[t.charCodeAt(a)]=a;e[45]=62,e[95]=63;function c(_){var A=_.length;if(A%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var S=_.indexOf("=");S===-1&&(S=A);var T=S===A?0:4-S%4;return[S,T]}function u(_){var A=c(_),S=A[0],T=A[1];return(S+T)*3/4-T}function v(_,A,S){return(A+S)*3/4-S}function o(_){var A,S=c(_),T=S[0],B=S[1],M=new r(v(_,T,B)),R=0,P=B>0?T-4:T,D;for(D=0;D<P;D+=4)A=e[_.charCodeAt(D)]<<18|e[_.charCodeAt(D+1)]<<12|e[_.charCodeAt(D+2)]<<6|e[_.charCodeAt(D+3)],M[R++]=A>>16&255,M[R++]=A>>8&255,M[R++]=A&255;return B===2&&(A=e[_.charCodeAt(D)]<<2|e[_.charCodeAt(D+1)]>>4,M[R++]=A&255),B===1&&(A=e[_.charCodeAt(D)]<<10|e[_.charCodeAt(D+1)]<<4|e[_.charCodeAt(D+2)]>>2,M[R++]=A>>8&255,M[R++]=A&255),M}function h(_){return i[_>>18&63]+i[_>>12&63]+i[_>>6&63]+i[_&63]}function g(_,A,S){for(var T,B=[],M=A;M<S;M+=3)T=(_[M]<<16&16711680)+(_[M+1]<<8&65280)+(_[M+2]&255),B.push(h(T));return B.join("")}function y(_){for(var A,S=_.length,T=S%3,B=[],M=16383,R=0,P=S-T;R<P;R+=M)B.push(g(_,R,R+M>P?P:R+M));return T===1?(A=_[S-1],B.push(i[A>>2]+i[A<<4&63]+"==")):T===2&&(A=(_[S-2]<<8)+_[S-1],B.push(i[A>>10]+i[A>>4&63]+i[A<<2&63]+"=")),B.join("")}return $s}var hf={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var bp;function e8(){return bp||(bp=1,hf.read=function(i,e,r,t,a){var n,c,u=a*8-t-1,v=(1<<u)-1,o=v>>1,h=-7,g=r?a-1:0,y=r?-1:1,_=i[e+g];for(g+=y,n=_&(1<<-h)-1,_>>=-h,h+=u;h>0;n=n*256+i[e+g],g+=y,h-=8);for(c=n&(1<<-h)-1,n>>=-h,h+=t;h>0;c=c*256+i[e+g],g+=y,h-=8);if(n===0)n=1-o;else{if(n===v)return c?NaN:(_?-1:1)*(1/0);c=c+Math.pow(2,t),n=n-o}return(_?-1:1)*c*Math.pow(2,n-t)},hf.write=function(i,e,r,t,a,n){var c,u,v,o=n*8-a-1,h=(1<<o)-1,g=h>>1,y=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=t?0:n-1,A=t?1:-1,S=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,c=h):(c=Math.floor(Math.log(e)/Math.LN2),e*(v=Math.pow(2,-c))<1&&(c--,v*=2),c+g>=1?e+=y/v:e+=y*Math.pow(2,1-g),e*v>=2&&(c++,v/=2),c+g>=h?(u=0,c=h):c+g>=1?(u=(e*v-1)*Math.pow(2,a),c=c+g):(u=e*Math.pow(2,g-1)*Math.pow(2,a),c=0));a>=8;i[r+_]=u&255,_+=A,u/=256,a-=8);for(c=c<<a|u,o+=a;o>0;i[r+_]=c&255,_+=A,c/=256,o-=8);i[r+_-A]|=S*128}),hf}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var _p;function Ni(){return _p||(_p=1,function(i){const e=t8(),r=e8(),t=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;i.Buffer=u,i.SlowBuffer=M,i.INSPECT_MAX_BYTES=50;const a=2147483647;i.kMaxLength=a,u.TYPED_ARRAY_SUPPORT=n(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function n(){try{const at=new Uint8Array(1),J={foo:function(){return 42}};return Object.setPrototypeOf(J,Uint8Array.prototype),Object.setPrototypeOf(at,J),at.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(at){if(at>a)throw new RangeError('The value "'+at+'" is invalid for option "size"');const J=new Uint8Array(at);return Object.setPrototypeOf(J,u.prototype),J}function u(at,J,rt){if(typeof at=="number"){if(typeof J=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return g(at)}return v(at,J,rt)}u.poolSize=8192;function v(at,J,rt){if(typeof at=="string")return y(at,J);if(ArrayBuffer.isView(at))return A(at);if(at==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof at);if(pt(at,ArrayBuffer)||at&&pt(at.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(pt(at,SharedArrayBuffer)||at&&pt(at.buffer,SharedArrayBuffer)))return S(at,J,rt);if(typeof at=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const lt=at.valueOf&&at.valueOf();if(lt!=null&&lt!==at)return u.from(lt,J,rt);const gt=T(at);if(gt)return gt;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof at[Symbol.toPrimitive]=="function")return u.from(at[Symbol.toPrimitive]("string"),J,rt);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof at)}u.from=function(at,J,rt){return v(at,J,rt)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function o(at){if(typeof at!="number")throw new TypeError('"size" argument must be of type number');if(at<0)throw new RangeError('The value "'+at+'" is invalid for option "size"')}function h(at,J,rt){return o(at),at<=0?c(at):J!==void 0?typeof rt=="string"?c(at).fill(J,rt):c(at).fill(J):c(at)}u.alloc=function(at,J,rt){return h(at,J,rt)};function g(at){return o(at),c(at<0?0:B(at)|0)}u.allocUnsafe=function(at){return g(at)},u.allocUnsafeSlow=function(at){return g(at)};function y(at,J){if((typeof J!="string"||J==="")&&(J="utf8"),!u.isEncoding(J))throw new TypeError("Unknown encoding: "+J);const rt=R(at,J)|0;let lt=c(rt);const gt=lt.write(at,J);return gt!==rt&&(lt=lt.slice(0,gt)),lt}function _(at){const J=at.length<0?0:B(at.length)|0,rt=c(J);for(let lt=0;lt<J;lt+=1)rt[lt]=at[lt]&255;return rt}function A(at){if(pt(at,Uint8Array)){const J=new Uint8Array(at);return S(J.buffer,J.byteOffset,J.byteLength)}return _(at)}function S(at,J,rt){if(J<0||at.byteLength<J)throw new RangeError('"offset" is outside of buffer bounds');if(at.byteLength<J+(rt||0))throw new RangeError('"length" is outside of buffer bounds');let lt;return J===void 0&&rt===void 0?lt=new Uint8Array(at):rt===void 0?lt=new Uint8Array(at,J):lt=new Uint8Array(at,J,rt),Object.setPrototypeOf(lt,u.prototype),lt}function T(at){if(u.isBuffer(at)){const J=B(at.length)|0,rt=c(J);return rt.length===0||at.copy(rt,0,0,J),rt}if(at.length!==void 0)return typeof at.length!="number"||Ut(at.length)?c(0):_(at);if(at.type==="Buffer"&&Array.isArray(at.data))return _(at.data)}function B(at){if(at>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return at|0}function M(at){return+at!=at&&(at=0),u.alloc(+at)}u.isBuffer=function(J){return J!=null&&J._isBuffer===!0&&J!==u.prototype},u.compare=function(J,rt){if(pt(J,Uint8Array)&&(J=u.from(J,J.offset,J.byteLength)),pt(rt,Uint8Array)&&(rt=u.from(rt,rt.offset,rt.byteLength)),!u.isBuffer(J)||!u.isBuffer(rt))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(J===rt)return 0;let lt=J.length,gt=rt.length;for(let Dt=0,ut=Math.min(lt,gt);Dt<ut;++Dt)if(J[Dt]!==rt[Dt]){lt=J[Dt],gt=rt[Dt];break}return lt<gt?-1:gt<lt?1:0},u.isEncoding=function(J){switch(String(J).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(J,rt){if(!Array.isArray(J))throw new TypeError('"list" argument must be an Array of Buffers');if(J.length===0)return u.alloc(0);let lt;if(rt===void 0)for(rt=0,lt=0;lt<J.length;++lt)rt+=J[lt].length;const gt=u.allocUnsafe(rt);let Dt=0;for(lt=0;lt<J.length;++lt){let ut=J[lt];if(pt(ut,Uint8Array))Dt+ut.length>gt.length?(u.isBuffer(ut)||(ut=u.from(ut)),ut.copy(gt,Dt)):Uint8Array.prototype.set.call(gt,ut,Dt);else if(u.isBuffer(ut))ut.copy(gt,Dt);else throw new TypeError('"list" argument must be an Array of Buffers');Dt+=ut.length}return gt};function R(at,J){if(u.isBuffer(at))return at.length;if(ArrayBuffer.isView(at)||pt(at,ArrayBuffer))return at.byteLength;if(typeof at!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof at);const rt=at.length,lt=arguments.length>2&&arguments[2]===!0;if(!lt&&rt===0)return 0;let gt=!1;for(;;)switch(J){case"ascii":case"latin1":case"binary":return rt;case"utf8":case"utf-8":return nt(at).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return rt*2;case"hex":return rt>>>1;case"base64":return vt(at).length;default:if(gt)return lt?-1:nt(at).length;J=(""+J).toLowerCase(),gt=!0}}u.byteLength=R;function P(at,J,rt){let lt=!1;if((J===void 0||J<0)&&(J=0),J>this.length||((rt===void 0||rt>this.length)&&(rt=this.length),rt<=0)||(rt>>>=0,J>>>=0,rt<=J))return"";for(at||(at="utf8");;)switch(at){case"hex":return b(this,J,rt);case"utf8":case"utf-8":return d(this,J,rt);case"ascii":return w(this,J,rt);case"latin1":case"binary":return x(this,J,rt);case"base64":return l(this,J,rt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f(this,J,rt);default:if(lt)throw new TypeError("Unknown encoding: "+at);at=(at+"").toLowerCase(),lt=!0}}u.prototype._isBuffer=!0;function D(at,J,rt){const lt=at[J];at[J]=at[rt],at[rt]=lt}u.prototype.swap16=function(){const J=this.length;if(J%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let rt=0;rt<J;rt+=2)D(this,rt,rt+1);return this},u.prototype.swap32=function(){const J=this.length;if(J%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let rt=0;rt<J;rt+=4)D(this,rt,rt+3),D(this,rt+1,rt+2);return this},u.prototype.swap64=function(){const J=this.length;if(J%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let rt=0;rt<J;rt+=8)D(this,rt,rt+7),D(this,rt+1,rt+6),D(this,rt+2,rt+5),D(this,rt+3,rt+4);return this},u.prototype.toString=function(){const J=this.length;return J===0?"":arguments.length===0?d(this,0,J):P.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(J){if(!u.isBuffer(J))throw new TypeError("Argument must be a Buffer");return this===J?!0:u.compare(this,J)===0},u.prototype.inspect=function(){let J="";const rt=i.INSPECT_MAX_BYTES;return J=this.toString("hex",0,rt).replace(/(.{2})/g,"$1 ").trim(),this.length>rt&&(J+=" ... "),"<Buffer "+J+">"},t&&(u.prototype[t]=u.prototype.inspect),u.prototype.compare=function(J,rt,lt,gt,Dt){if(pt(J,Uint8Array)&&(J=u.from(J,J.offset,J.byteLength)),!u.isBuffer(J))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof J);if(rt===void 0&&(rt=0),lt===void 0&&(lt=J?J.length:0),gt===void 0&&(gt=0),Dt===void 0&&(Dt=this.length),rt<0||lt>J.length||gt<0||Dt>this.length)throw new RangeError("out of range index");if(gt>=Dt&&rt>=lt)return 0;if(gt>=Dt)return-1;if(rt>=lt)return 1;if(rt>>>=0,lt>>>=0,gt>>>=0,Dt>>>=0,this===J)return 0;let ut=Dt-gt,Y=lt-rt;const tt=Math.min(ut,Y),dt=this.slice(gt,Dt),mt=J.slice(rt,lt);for(let xt=0;xt<tt;++xt)if(dt[xt]!==mt[xt]){ut=dt[xt],Y=mt[xt];break}return ut<Y?-1:Y<ut?1:0};function q(at,J,rt,lt,gt){if(at.length===0)return-1;if(typeof rt=="string"?(lt=rt,rt=0):rt>2147483647?rt=2147483647:rt<-2147483648&&(rt=-2147483648),rt=+rt,Ut(rt)&&(rt=gt?0:at.length-1),rt<0&&(rt=at.length+rt),rt>=at.length){if(gt)return-1;rt=at.length-1}else if(rt<0)if(gt)rt=0;else return-1;if(typeof J=="string"&&(J=u.from(J,lt)),u.isBuffer(J))return J.length===0?-1:k(at,J,rt,lt,gt);if(typeof J=="number")return J=J&255,typeof Uint8Array.prototype.indexOf=="function"?gt?Uint8Array.prototype.indexOf.call(at,J,rt):Uint8Array.prototype.lastIndexOf.call(at,J,rt):k(at,[J],rt,lt,gt);throw new TypeError("val must be string, number or Buffer")}function k(at,J,rt,lt,gt){let Dt=1,ut=at.length,Y=J.length;if(lt!==void 0&&(lt=String(lt).toLowerCase(),lt==="ucs2"||lt==="ucs-2"||lt==="utf16le"||lt==="utf-16le")){if(at.length<2||J.length<2)return-1;Dt=2,ut/=2,Y/=2,rt/=2}function tt(mt,xt){return Dt===1?mt[xt]:mt.readUInt16BE(xt*Dt)}let dt;if(gt){let mt=-1;for(dt=rt;dt<ut;dt++)if(tt(at,dt)===tt(J,mt===-1?0:dt-mt)){if(mt===-1&&(mt=dt),dt-mt+1===Y)return mt*Dt}else mt!==-1&&(dt-=dt-mt),mt=-1}else for(rt+Y>ut&&(rt=ut-Y),dt=rt;dt>=0;dt--){let mt=!0;for(let xt=0;xt<Y;xt++)if(tt(at,dt+xt)!==tt(J,xt)){mt=!1;break}if(mt)return dt}return-1}u.prototype.includes=function(J,rt,lt){return this.indexOf(J,rt,lt)!==-1},u.prototype.indexOf=function(J,rt,lt){return q(this,J,rt,lt,!0)},u.prototype.lastIndexOf=function(J,rt,lt){return q(this,J,rt,lt,!1)};function U(at,J,rt,lt){rt=Number(rt)||0;const gt=at.length-rt;lt?(lt=Number(lt),lt>gt&&(lt=gt)):lt=gt;const Dt=J.length;lt>Dt/2&&(lt=Dt/2);let ut;for(ut=0;ut<lt;++ut){const Y=parseInt(J.substr(ut*2,2),16);if(Ut(Y))return ut;at[rt+ut]=Y}return ut}function O(at,J,rt,lt){return ot(nt(J,at.length-rt),at,rt,lt)}function G(at,J,rt,lt){return ot(st(J),at,rt,lt)}function E(at,J,rt,lt){return ot(vt(J),at,rt,lt)}function s(at,J,rt,lt){return ot(ft(J,at.length-rt),at,rt,lt)}u.prototype.write=function(J,rt,lt,gt){if(rt===void 0)gt="utf8",lt=this.length,rt=0;else if(lt===void 0&&typeof rt=="string")gt=rt,lt=this.length,rt=0;else if(isFinite(rt))rt=rt>>>0,isFinite(lt)?(lt=lt>>>0,gt===void 0&&(gt="utf8")):(gt=lt,lt=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Dt=this.length-rt;if((lt===void 0||lt>Dt)&&(lt=Dt),J.length>0&&(lt<0||rt<0)||rt>this.length)throw new RangeError("Attempt to write outside buffer bounds");gt||(gt="utf8");let ut=!1;for(;;)switch(gt){case"hex":return U(this,J,rt,lt);case"utf8":case"utf-8":return O(this,J,rt,lt);case"ascii":case"latin1":case"binary":return G(this,J,rt,lt);case"base64":return E(this,J,rt,lt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s(this,J,rt,lt);default:if(ut)throw new TypeError("Unknown encoding: "+gt);gt=(""+gt).toLowerCase(),ut=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function l(at,J,rt){return J===0&&rt===at.length?e.fromByteArray(at):e.fromByteArray(at.slice(J,rt))}function d(at,J,rt){rt=Math.min(at.length,rt);const lt=[];let gt=J;for(;gt<rt;){const Dt=at[gt];let ut=null,Y=Dt>239?4:Dt>223?3:Dt>191?2:1;if(gt+Y<=rt){let tt,dt,mt,xt;switch(Y){case 1:Dt<128&&(ut=Dt);break;case 2:tt=at[gt+1],(tt&192)===128&&(xt=(Dt&31)<<6|tt&63,xt>127&&(ut=xt));break;case 3:tt=at[gt+1],dt=at[gt+2],(tt&192)===128&&(dt&192)===128&&(xt=(Dt&15)<<12|(tt&63)<<6|dt&63,xt>2047&&(xt<55296||xt>57343)&&(ut=xt));break;case 4:tt=at[gt+1],dt=at[gt+2],mt=at[gt+3],(tt&192)===128&&(dt&192)===128&&(mt&192)===128&&(xt=(Dt&15)<<18|(tt&63)<<12|(dt&63)<<6|mt&63,xt>65535&&xt<1114112&&(ut=xt))}}ut===null?(ut=65533,Y=1):ut>65535&&(ut-=65536,lt.push(ut>>>10&1023|55296),ut=56320|ut&1023),lt.push(ut),gt+=Y}return m(lt)}const p=4096;function m(at){const J=at.length;if(J<=p)return String.fromCharCode.apply(String,at);let rt="",lt=0;for(;lt<J;)rt+=String.fromCharCode.apply(String,at.slice(lt,lt+=p));return rt}function w(at,J,rt){let lt="";rt=Math.min(at.length,rt);for(let gt=J;gt<rt;++gt)lt+=String.fromCharCode(at[gt]&127);return lt}function x(at,J,rt){let lt="";rt=Math.min(at.length,rt);for(let gt=J;gt<rt;++gt)lt+=String.fromCharCode(at[gt]);return lt}function b(at,J,rt){const lt=at.length;(!J||J<0)&&(J=0),(!rt||rt<0||rt>lt)&&(rt=lt);let gt="";for(let Dt=J;Dt<rt;++Dt)gt+=At[at[Dt]];return gt}function f(at,J,rt){const lt=at.slice(J,rt);let gt="";for(let Dt=0;Dt<lt.length-1;Dt+=2)gt+=String.fromCharCode(lt[Dt]+lt[Dt+1]*256);return gt}u.prototype.slice=function(J,rt){const lt=this.length;J=~~J,rt=rt===void 0?lt:~~rt,J<0?(J+=lt,J<0&&(J=0)):J>lt&&(J=lt),rt<0?(rt+=lt,rt<0&&(rt=0)):rt>lt&&(rt=lt),rt<J&&(rt=J);const gt=this.subarray(J,rt);return Object.setPrototypeOf(gt,u.prototype),gt};function C(at,J,rt){if(at%1!==0||at<0)throw new RangeError("offset is not uint");if(at+J>rt)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(J,rt,lt){J=J>>>0,rt=rt>>>0,lt||C(J,rt,this.length);let gt=this[J],Dt=1,ut=0;for(;++ut<rt&&(Dt*=256);)gt+=this[J+ut]*Dt;return gt},u.prototype.readUintBE=u.prototype.readUIntBE=function(J,rt,lt){J=J>>>0,rt=rt>>>0,lt||C(J,rt,this.length);let gt=this[J+--rt],Dt=1;for(;rt>0&&(Dt*=256);)gt+=this[J+--rt]*Dt;return gt},u.prototype.readUint8=u.prototype.readUInt8=function(J,rt){return J=J>>>0,rt||C(J,1,this.length),this[J]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(J,rt){return J=J>>>0,rt||C(J,2,this.length),this[J]|this[J+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(J,rt){return J=J>>>0,rt||C(J,2,this.length),this[J]<<8|this[J+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(J,rt){return J=J>>>0,rt||C(J,4,this.length),(this[J]|this[J+1]<<8|this[J+2]<<16)+this[J+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(J,rt){return J=J>>>0,rt||C(J,4,this.length),this[J]*16777216+(this[J+1]<<16|this[J+2]<<8|this[J+3])},u.prototype.readBigUInt64LE=It(function(J){J=J>>>0,Z(J,"offset");const rt=this[J],lt=this[J+7];(rt===void 0||lt===void 0)&&H(J,this.length-8);const gt=rt+this[++J]*2**8+this[++J]*2**16+this[++J]*2**24,Dt=this[++J]+this[++J]*2**8+this[++J]*2**16+lt*2**24;return BigInt(gt)+(BigInt(Dt)<<BigInt(32))}),u.prototype.readBigUInt64BE=It(function(J){J=J>>>0,Z(J,"offset");const rt=this[J],lt=this[J+7];(rt===void 0||lt===void 0)&&H(J,this.length-8);const gt=rt*2**24+this[++J]*2**16+this[++J]*2**8+this[++J],Dt=this[++J]*2**24+this[++J]*2**16+this[++J]*2**8+lt;return(BigInt(gt)<<BigInt(32))+BigInt(Dt)}),u.prototype.readIntLE=function(J,rt,lt){J=J>>>0,rt=rt>>>0,lt||C(J,rt,this.length);let gt=this[J],Dt=1,ut=0;for(;++ut<rt&&(Dt*=256);)gt+=this[J+ut]*Dt;return Dt*=128,gt>=Dt&&(gt-=Math.pow(2,8*rt)),gt},u.prototype.readIntBE=function(J,rt,lt){J=J>>>0,rt=rt>>>0,lt||C(J,rt,this.length);let gt=rt,Dt=1,ut=this[J+--gt];for(;gt>0&&(Dt*=256);)ut+=this[J+--gt]*Dt;return Dt*=128,ut>=Dt&&(ut-=Math.pow(2,8*rt)),ut},u.prototype.readInt8=function(J,rt){return J=J>>>0,rt||C(J,1,this.length),this[J]&128?(255-this[J]+1)*-1:this[J]},u.prototype.readInt16LE=function(J,rt){J=J>>>0,rt||C(J,2,this.length);const lt=this[J]|this[J+1]<<8;return lt&32768?lt|4294901760:lt},u.prototype.readInt16BE=function(J,rt){J=J>>>0,rt||C(J,2,this.length);const lt=this[J+1]|this[J]<<8;return lt&32768?lt|4294901760:lt},u.prototype.readInt32LE=function(J,rt){return J=J>>>0,rt||C(J,4,this.length),this[J]|this[J+1]<<8|this[J+2]<<16|this[J+3]<<24},u.prototype.readInt32BE=function(J,rt){return J=J>>>0,rt||C(J,4,this.length),this[J]<<24|this[J+1]<<16|this[J+2]<<8|this[J+3]},u.prototype.readBigInt64LE=It(function(J){J=J>>>0,Z(J,"offset");const rt=this[J],lt=this[J+7];(rt===void 0||lt===void 0)&&H(J,this.length-8);const gt=this[J+4]+this[J+5]*2**8+this[J+6]*2**16+(lt<<24);return(BigInt(gt)<<BigInt(32))+BigInt(rt+this[++J]*2**8+this[++J]*2**16+this[++J]*2**24)}),u.prototype.readBigInt64BE=It(function(J){J=J>>>0,Z(J,"offset");const rt=this[J],lt=this[J+7];(rt===void 0||lt===void 0)&&H(J,this.length-8);const gt=(rt<<24)+this[++J]*2**16+this[++J]*2**8+this[++J];return(BigInt(gt)<<BigInt(32))+BigInt(this[++J]*2**24+this[++J]*2**16+this[++J]*2**8+lt)}),u.prototype.readFloatLE=function(J,rt){return J=J>>>0,rt||C(J,4,this.length),r.read(this,J,!0,23,4)},u.prototype.readFloatBE=function(J,rt){return J=J>>>0,rt||C(J,4,this.length),r.read(this,J,!1,23,4)},u.prototype.readDoubleLE=function(J,rt){return J=J>>>0,rt||C(J,8,this.length),r.read(this,J,!0,52,8)},u.prototype.readDoubleBE=function(J,rt){return J=J>>>0,rt||C(J,8,this.length),r.read(this,J,!1,52,8)};function F(at,J,rt,lt,gt,Dt){if(!u.isBuffer(at))throw new TypeError('"buffer" argument must be a Buffer instance');if(J>gt||J<Dt)throw new RangeError('"value" argument is out of bounds');if(rt+lt>at.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(J,rt,lt,gt){if(J=+J,rt=rt>>>0,lt=lt>>>0,!gt){const Y=Math.pow(2,8*lt)-1;F(this,J,rt,lt,Y,0)}let Dt=1,ut=0;for(this[rt]=J&255;++ut<lt&&(Dt*=256);)this[rt+ut]=J/Dt&255;return rt+lt},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(J,rt,lt,gt){if(J=+J,rt=rt>>>0,lt=lt>>>0,!gt){const Y=Math.pow(2,8*lt)-1;F(this,J,rt,lt,Y,0)}let Dt=lt-1,ut=1;for(this[rt+Dt]=J&255;--Dt>=0&&(ut*=256);)this[rt+Dt]=J/ut&255;return rt+lt},u.prototype.writeUint8=u.prototype.writeUInt8=function(J,rt,lt){return J=+J,rt=rt>>>0,lt||F(this,J,rt,1,255,0),this[rt]=J&255,rt+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(J,rt,lt){return J=+J,rt=rt>>>0,lt||F(this,J,rt,2,65535,0),this[rt]=J&255,this[rt+1]=J>>>8,rt+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(J,rt,lt){return J=+J,rt=rt>>>0,lt||F(this,J,rt,2,65535,0),this[rt]=J>>>8,this[rt+1]=J&255,rt+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(J,rt,lt){return J=+J,rt=rt>>>0,lt||F(this,J,rt,4,4294967295,0),this[rt+3]=J>>>24,this[rt+2]=J>>>16,this[rt+1]=J>>>8,this[rt]=J&255,rt+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(J,rt,lt){return J=+J,rt=rt>>>0,lt||F(this,J,rt,4,4294967295,0),this[rt]=J>>>24,this[rt+1]=J>>>16,this[rt+2]=J>>>8,this[rt+3]=J&255,rt+4};function z(at,J,rt,lt,gt){V(J,lt,gt,at,rt,7);let Dt=Number(J&BigInt(4294967295));at[rt++]=Dt,Dt=Dt>>8,at[rt++]=Dt,Dt=Dt>>8,at[rt++]=Dt,Dt=Dt>>8,at[rt++]=Dt;let ut=Number(J>>BigInt(32)&BigInt(4294967295));return at[rt++]=ut,ut=ut>>8,at[rt++]=ut,ut=ut>>8,at[rt++]=ut,ut=ut>>8,at[rt++]=ut,rt}function W(at,J,rt,lt,gt){V(J,lt,gt,at,rt,7);let Dt=Number(J&BigInt(4294967295));at[rt+7]=Dt,Dt=Dt>>8,at[rt+6]=Dt,Dt=Dt>>8,at[rt+5]=Dt,Dt=Dt>>8,at[rt+4]=Dt;let ut=Number(J>>BigInt(32)&BigInt(4294967295));return at[rt+3]=ut,ut=ut>>8,at[rt+2]=ut,ut=ut>>8,at[rt+1]=ut,ut=ut>>8,at[rt]=ut,rt+8}u.prototype.writeBigUInt64LE=It(function(J,rt=0){return z(this,J,rt,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=It(function(J,rt=0){return W(this,J,rt,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(J,rt,lt,gt){if(J=+J,rt=rt>>>0,!gt){const tt=Math.pow(2,8*lt-1);F(this,J,rt,lt,tt-1,-tt)}let Dt=0,ut=1,Y=0;for(this[rt]=J&255;++Dt<lt&&(ut*=256);)J<0&&Y===0&&this[rt+Dt-1]!==0&&(Y=1),this[rt+Dt]=(J/ut>>0)-Y&255;return rt+lt},u.prototype.writeIntBE=function(J,rt,lt,gt){if(J=+J,rt=rt>>>0,!gt){const tt=Math.pow(2,8*lt-1);F(this,J,rt,lt,tt-1,-tt)}let Dt=lt-1,ut=1,Y=0;for(this[rt+Dt]=J&255;--Dt>=0&&(ut*=256);)J<0&&Y===0&&this[rt+Dt+1]!==0&&(Y=1),this[rt+Dt]=(J/ut>>0)-Y&255;return rt+lt},u.prototype.writeInt8=function(J,rt,lt){return J=+J,rt=rt>>>0,lt||F(this,J,rt,1,127,-128),J<0&&(J=255+J+1),this[rt]=J&255,rt+1},u.prototype.writeInt16LE=function(J,rt,lt){return J=+J,rt=rt>>>0,lt||F(this,J,rt,2,32767,-32768),this[rt]=J&255,this[rt+1]=J>>>8,rt+2},u.prototype.writeInt16BE=function(J,rt,lt){return J=+J,rt=rt>>>0,lt||F(this,J,rt,2,32767,-32768),this[rt]=J>>>8,this[rt+1]=J&255,rt+2},u.prototype.writeInt32LE=function(J,rt,lt){return J=+J,rt=rt>>>0,lt||F(this,J,rt,4,2147483647,-2147483648),this[rt]=J&255,this[rt+1]=J>>>8,this[rt+2]=J>>>16,this[rt+3]=J>>>24,rt+4},u.prototype.writeInt32BE=function(J,rt,lt){return J=+J,rt=rt>>>0,lt||F(this,J,rt,4,2147483647,-2147483648),J<0&&(J=4294967295+J+1),this[rt]=J>>>24,this[rt+1]=J>>>16,this[rt+2]=J>>>8,this[rt+3]=J&255,rt+4},u.prototype.writeBigInt64LE=It(function(J,rt=0){return z(this,J,rt,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=It(function(J,rt=0){return W(this,J,rt,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function $(at,J,rt,lt,gt,Dt){if(rt+lt>at.length)throw new RangeError("Index out of range");if(rt<0)throw new RangeError("Index out of range")}function I(at,J,rt,lt,gt){return J=+J,rt=rt>>>0,gt||$(at,J,rt,4),r.write(at,J,rt,lt,23,4),rt+4}u.prototype.writeFloatLE=function(J,rt,lt){return I(this,J,rt,!0,lt)},u.prototype.writeFloatBE=function(J,rt,lt){return I(this,J,rt,!1,lt)};function K(at,J,rt,lt,gt){return J=+J,rt=rt>>>0,gt||$(at,J,rt,8),r.write(at,J,rt,lt,52,8),rt+8}u.prototype.writeDoubleLE=function(J,rt,lt){return K(this,J,rt,!0,lt)},u.prototype.writeDoubleBE=function(J,rt,lt){return K(this,J,rt,!1,lt)},u.prototype.copy=function(J,rt,lt,gt){if(!u.isBuffer(J))throw new TypeError("argument should be a Buffer");if(lt||(lt=0),!gt&&gt!==0&&(gt=this.length),rt>=J.length&&(rt=J.length),rt||(rt=0),gt>0&&gt<lt&&(gt=lt),gt===lt||J.length===0||this.length===0)return 0;if(rt<0)throw new RangeError("targetStart out of bounds");if(lt<0||lt>=this.length)throw new RangeError("Index out of range");if(gt<0)throw new RangeError("sourceEnd out of bounds");gt>this.length&&(gt=this.length),J.length-rt<gt-lt&&(gt=J.length-rt+lt);const Dt=gt-lt;return this===J&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(rt,lt,gt):Uint8Array.prototype.set.call(J,this.subarray(lt,gt),rt),Dt},u.prototype.fill=function(J,rt,lt,gt){if(typeof J=="string"){if(typeof rt=="string"?(gt=rt,rt=0,lt=this.length):typeof lt=="string"&&(gt=lt,lt=this.length),gt!==void 0&&typeof gt!="string")throw new TypeError("encoding must be a string");if(typeof gt=="string"&&!u.isEncoding(gt))throw new TypeError("Unknown encoding: "+gt);if(J.length===1){const ut=J.charCodeAt(0);(gt==="utf8"&&ut<128||gt==="latin1")&&(J=ut)}}else typeof J=="number"?J=J&255:typeof J=="boolean"&&(J=Number(J));if(rt<0||this.length<rt||this.length<lt)throw new RangeError("Out of range index");if(lt<=rt)return this;rt=rt>>>0,lt=lt===void 0?this.length:lt>>>0,J||(J=0);let Dt;if(typeof J=="number")for(Dt=rt;Dt<lt;++Dt)this[Dt]=J;else{const ut=u.isBuffer(J)?J:u.from(J,gt),Y=ut.length;if(Y===0)throw new TypeError('The value "'+J+'" is invalid for argument "value"');for(Dt=0;Dt<lt-rt;++Dt)this[Dt+rt]=ut[Dt%Y]}return this};const N={};function X(at,J,rt){N[at]=class extends rt{constructor(){super(),Object.defineProperty(this,"message",{value:J.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${at}]`,this.stack,delete this.name}get code(){return at}set code(gt){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:gt,writable:!0})}toString(){return`${this.name} [${at}]: ${this.message}`}}}X("ERR_BUFFER_OUT_OF_BOUNDS",function(at){return at?`${at} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),X("ERR_INVALID_ARG_TYPE",function(at,J){return`The "${at}" argument must be of type number. Received type ${typeof J}`},TypeError),X("ERR_OUT_OF_RANGE",function(at,J,rt){let lt=`The value of "${at}" is out of range.`,gt=rt;return Number.isInteger(rt)&&Math.abs(rt)>2**32?gt=Q(String(rt)):typeof rt=="bigint"&&(gt=String(rt),(rt>BigInt(2)**BigInt(32)||rt<-(BigInt(2)**BigInt(32)))&&(gt=Q(gt)),gt+="n"),lt+=` It must be ${J}. Received ${gt}`,lt},RangeError);function Q(at){let J="",rt=at.length;const lt=at[0]==="-"?1:0;for(;rt>=lt+4;rt-=3)J=`_${at.slice(rt-3,rt)}${J}`;return`${at.slice(0,rt)}${J}`}function L(at,J,rt){Z(J,"offset"),(at[J]===void 0||at[J+rt]===void 0)&&H(J,at.length-(rt+1))}function V(at,J,rt,lt,gt,Dt){if(at>rt||at<J){const ut=typeof J=="bigint"?"n":"";let Y;throw J===0||J===BigInt(0)?Y=`>= 0${ut} and < 2${ut} ** ${(Dt+1)*8}${ut}`:Y=`>= -(2${ut} ** ${(Dt+1)*8-1}${ut}) and < 2 ** ${(Dt+1)*8-1}${ut}`,new N.ERR_OUT_OF_RANGE("value",Y,at)}L(lt,gt,Dt)}function Z(at,J){if(typeof at!="number")throw new N.ERR_INVALID_ARG_TYPE(J,"number",at)}function H(at,J,rt){throw Math.floor(at)!==at?(Z(at,rt),new N.ERR_OUT_OF_RANGE("offset","an integer",at)):J<0?new N.ERR_BUFFER_OUT_OF_BOUNDS:new N.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${J}`,at)}const j=/[^+/0-9A-Za-z-_]/g;function et(at){if(at=at.split("=")[0],at=at.trim().replace(j,""),at.length<2)return"";for(;at.length%4!==0;)at=at+"=";return at}function nt(at,J){J=J||1/0;let rt;const lt=at.length;let gt=null;const Dt=[];for(let ut=0;ut<lt;++ut){if(rt=at.charCodeAt(ut),rt>55295&&rt<57344){if(!gt){if(rt>56319){(J-=3)>-1&&Dt.push(239,191,189);continue}else if(ut+1===lt){(J-=3)>-1&&Dt.push(239,191,189);continue}gt=rt;continue}if(rt<56320){(J-=3)>-1&&Dt.push(239,191,189),gt=rt;continue}rt=(gt-55296<<10|rt-56320)+65536}else gt&&(J-=3)>-1&&Dt.push(239,191,189);if(gt=null,rt<128){if((J-=1)<0)break;Dt.push(rt)}else if(rt<2048){if((J-=2)<0)break;Dt.push(rt>>6|192,rt&63|128)}else if(rt<65536){if((J-=3)<0)break;Dt.push(rt>>12|224,rt>>6&63|128,rt&63|128)}else if(rt<1114112){if((J-=4)<0)break;Dt.push(rt>>18|240,rt>>12&63|128,rt>>6&63|128,rt&63|128)}else throw new Error("Invalid code point")}return Dt}function st(at){const J=[];for(let rt=0;rt<at.length;++rt)J.push(at.charCodeAt(rt)&255);return J}function ft(at,J){let rt,lt,gt;const Dt=[];for(let ut=0;ut<at.length&&!((J-=2)<0);++ut)rt=at.charCodeAt(ut),lt=rt>>8,gt=rt%256,Dt.push(gt),Dt.push(lt);return Dt}function vt(at){return e.toByteArray(et(at))}function ot(at,J,rt,lt){let gt;for(gt=0;gt<lt&&!(gt+rt>=J.length||gt>=at.length);++gt)J[gt+rt]=at[gt];return gt}function pt(at,J){return at instanceof J||at!=null&&at.constructor!=null&&at.constructor.name!=null&&at.constructor.name===J.name}function Ut(at){return at!==at}const At=function(){const at="0123456789abcdef",J=new Array(256);for(let rt=0;rt<16;++rt){const lt=rt*16;for(let gt=0;gt<16;++gt)J[lt+gt]=at[rt]+at[gt]}return J}();function It(at){return typeof BigInt>"u"?Jt:at}function Jt(){throw new Error("BigInt not supported")}}(mc)),mc}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var wp;function er(){return wp||(wp=1,function(i,e){var r=Ni(),t=r.Buffer;function a(c,u){for(var v in c)u[v]=c[v]}t.from&&t.alloc&&t.allocUnsafe&&t.allocUnsafeSlow?i.exports=r:(a(r,e),e.Buffer=n);function n(c,u,v){return t(c,u,v)}n.prototype=Object.create(t.prototype),a(t,n),n.from=function(c,u,v){if(typeof c=="number")throw new TypeError("Argument must not be a number");return t(c,u,v)},n.alloc=function(c,u,v){if(typeof c!="number")throw new TypeError("Argument must be a number");var o=t(c);return u!==void 0?typeof v=="string"?o.fill(u,v):o.fill(u):o.fill(0),o},n.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return t(c)},n.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(c)}}(uf,uf.exports)),uf.exports}var Cp;function Is(){if(Cp)return cf.exports;Cp=1;var i=65536,e=4294967295;function r(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var t=er().Buffer,a=globalThis.crypto||globalThis.msCrypto;a&&a.getRandomValues?cf.exports=n:cf.exports=r;function n(c,u){if(c>e)throw new RangeError("requested too many random bytes");var v=t.allocUnsafe(c);if(c>0)if(c>i)for(var o=0;o<c;o+=i)a.getRandomValues(v.slice(o,o+i));else a.getRandomValues(v);return typeof u=="function"?process.nextTick(function(){u(null,v)}):v}return cf.exports}var df={exports:{}},Ep;function De(){return Ep||(Ep=1,typeof Object.create=="function"?df.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:df.exports=function(e,r){if(r){e.super_=r;var t=function(){};t.prototype=r.prototype,e.prototype=new t,e.prototype.constructor=e}}),df.exports}var pf={exports:{}},Ap;function Oo(){if(Ap)return pf.exports;Ap=1;var i=typeof Reflect=="object"?Reflect:null,e=i&&typeof i.apply=="function"?i.apply:function(D,q,k){return Function.prototype.apply.call(D,q,k)},r;i&&typeof i.ownKeys=="function"?r=i.ownKeys:Object.getOwnPropertySymbols?r=function(D){return Object.getOwnPropertyNames(D).concat(Object.getOwnPropertySymbols(D))}:r=function(D){return Object.getOwnPropertyNames(D)};function t(P){console&&console.warn&&console.warn(P)}var a=Number.isNaN||function(D){return D!==D};function n(){n.init.call(this)}pf.exports=n,pf.exports.once=B,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var c=10;function u(P){if(typeof P!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof P)}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(P){if(typeof P!="number"||P<0||a(P))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+P+".");c=P}}),n.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(D){if(typeof D!="number"||D<0||a(D))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+D+".");return this._maxListeners=D,this};function v(P){return P._maxListeners===void 0?n.defaultMaxListeners:P._maxListeners}n.prototype.getMaxListeners=function(){return v(this)},n.prototype.emit=function(D){for(var q=[],k=1;k<arguments.length;k++)q.push(arguments[k]);var U=D==="error",O=this._events;if(O!==void 0)U=U&&O.error===void 0;else if(!U)return!1;if(U){var G;if(q.length>0&&(G=q[0]),G instanceof Error)throw G;var E=new Error("Unhandled error."+(G?" ("+G.message+")":""));throw E.context=G,E}var s=O[D];if(s===void 0)return!1;if(typeof s=="function")e(s,this,q);else for(var l=s.length,d=A(s,l),k=0;k<l;++k)e(d[k],this,q);return!0};function o(P,D,q,k){var U,O,G;if(u(q),O=P._events,O===void 0?(O=P._events=Object.create(null),P._eventsCount=0):(O.newListener!==void 0&&(P.emit("newListener",D,q.listener?q.listener:q),O=P._events),G=O[D]),G===void 0)G=O[D]=q,++P._eventsCount;else if(typeof G=="function"?G=O[D]=k?[q,G]:[G,q]:k?G.unshift(q):G.push(q),U=v(P),U>0&&G.length>U&&!G.warned){G.warned=!0;var E=new Error("Possible EventEmitter memory leak detected. "+G.length+" "+String(D)+" listeners added. Use emitter.setMaxListeners() to increase limit");E.name="MaxListenersExceededWarning",E.emitter=P,E.type=D,E.count=G.length,t(E)}return P}n.prototype.addListener=function(D,q){return o(this,D,q,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(D,q){return o(this,D,q,!0)};function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(P,D,q){var k={fired:!1,wrapFn:void 0,target:P,type:D,listener:q},U=h.bind(k);return U.listener=q,k.wrapFn=U,U}n.prototype.once=function(D,q){return u(q),this.on(D,g(this,D,q)),this},n.prototype.prependOnceListener=function(D,q){return u(q),this.prependListener(D,g(this,D,q)),this},n.prototype.removeListener=function(D,q){var k,U,O,G,E;if(u(q),U=this._events,U===void 0)return this;if(k=U[D],k===void 0)return this;if(k===q||k.listener===q)--this._eventsCount===0?this._events=Object.create(null):(delete U[D],U.removeListener&&this.emit("removeListener",D,k.listener||q));else if(typeof k!="function"){for(O=-1,G=k.length-1;G>=0;G--)if(k[G]===q||k[G].listener===q){E=k[G].listener,O=G;break}if(O<0)return this;O===0?k.shift():S(k,O),k.length===1&&(U[D]=k[0]),U.removeListener!==void 0&&this.emit("removeListener",D,E||q)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(D){var q,k,U;if(k=this._events,k===void 0)return this;if(k.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):k[D]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete k[D]),this;if(arguments.length===0){var O=Object.keys(k),G;for(U=0;U<O.length;++U)G=O[U],G!=="removeListener"&&this.removeAllListeners(G);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(q=k[D],typeof q=="function")this.removeListener(D,q);else if(q!==void 0)for(U=q.length-1;U>=0;U--)this.removeListener(D,q[U]);return this};function y(P,D,q){var k=P._events;if(k===void 0)return[];var U=k[D];return U===void 0?[]:typeof U=="function"?q?[U.listener||U]:[U]:q?T(U):A(U,U.length)}n.prototype.listeners=function(D){return y(this,D,!0)},n.prototype.rawListeners=function(D){return y(this,D,!1)},n.listenerCount=function(P,D){return typeof P.listenerCount=="function"?P.listenerCount(D):_.call(P,D)},n.prototype.listenerCount=_;function _(P){var D=this._events;if(D!==void 0){var q=D[P];if(typeof q=="function")return 1;if(q!==void 0)return q.length}return 0}n.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function A(P,D){for(var q=new Array(D),k=0;k<D;++k)q[k]=P[k];return q}function S(P,D){for(;D+1<P.length;D++)P[D]=P[D+1];P.pop()}function T(P){for(var D=new Array(P.length),q=0;q<D.length;++q)D[q]=P[q].listener||P[q];return D}function B(P,D){return new Promise(function(q,k){function U(G){P.removeListener(D,O),k(G)}function O(){typeof P.removeListener=="function"&&P.removeListener("error",U),q([].slice.call(arguments))}R(P,D,O,{once:!0}),D!=="error"&&M(P,U,{once:!0})})}function M(P,D,q){typeof P.on=="function"&&R(P,"error",D,q)}function R(P,D,q,k){if(typeof P.on=="function")k.once?P.once(D,q):P.on(D,q);else if(typeof P.addEventListener=="function")P.addEventListener(D,function U(O){k.once&&P.removeEventListener(D,U),q(O)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof P)}return pf.exports}var yc,Sp;function ly(){return Sp||(Sp=1,yc=Oo().EventEmitter),yc}const r8={},i8=Object.freeze(Object.defineProperty({__proto__:null,default:r8},Symbol.toStringTag,{value:"Module"})),$i=e1(i8);var bc,xp;function n8(){if(xp)return bc;xp=1;function i(A,S){var T=Object.keys(A);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(A);S&&(B=B.filter(function(M){return Object.getOwnPropertyDescriptor(A,M).enumerable})),T.push.apply(T,B)}return T}function e(A){for(var S=1;S<arguments.length;S++){var T=arguments[S]!=null?arguments[S]:{};S%2?i(Object(T),!0).forEach(function(B){r(A,B,T[B])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(T)):i(Object(T)).forEach(function(B){Object.defineProperty(A,B,Object.getOwnPropertyDescriptor(T,B))})}return A}function r(A,S,T){return S=c(S),S in A?Object.defineProperty(A,S,{value:T,enumerable:!0,configurable:!0,writable:!0}):A[S]=T,A}function t(A,S){if(!(A instanceof S))throw new TypeError("Cannot call a class as a function")}function a(A,S){for(var T=0;T<S.length;T++){var B=S[T];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(A,c(B.key),B)}}function n(A,S,T){return S&&a(A.prototype,S),Object.defineProperty(A,"prototype",{writable:!1}),A}function c(A){var S=u(A,"string");return typeof S=="symbol"?S:String(S)}function u(A,S){if(typeof A!="object"||A===null)return A;var T=A[Symbol.toPrimitive];if(T!==void 0){var B=T.call(A,S||"default");if(typeof B!="object")return B;throw new TypeError("@@toPrimitive must return a primitive value.")}return(S==="string"?String:Number)(A)}var v=Ni(),o=v.Buffer,h=$i,g=h.inspect,y=g&&g.custom||"inspect";function _(A,S,T){o.prototype.copy.call(A,S,T)}return bc=function(){function A(){t(this,A),this.head=null,this.tail=null,this.length=0}return n(A,[{key:"push",value:function(T){var B={data:T,next:null};this.length>0?this.tail.next=B:this.head=B,this.tail=B,++this.length}},{key:"unshift",value:function(T){var B={data:T,next:this.head};this.length===0&&(this.tail=B),this.head=B,++this.length}},{key:"shift",value:function(){if(this.length!==0){var T=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,T}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(T){if(this.length===0)return"";for(var B=this.head,M=""+B.data;B=B.next;)M+=T+B.data;return M}},{key:"concat",value:function(T){if(this.length===0)return o.alloc(0);for(var B=o.allocUnsafe(T>>>0),M=this.head,R=0;M;)_(M.data,B,R),R+=M.data.length,M=M.next;return B}},{key:"consume",value:function(T,B){var M;return T<this.head.data.length?(M=this.head.data.slice(0,T),this.head.data=this.head.data.slice(T)):T===this.head.data.length?M=this.shift():M=B?this._getString(T):this._getBuffer(T),M}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(T){var B=this.head,M=1,R=B.data;for(T-=R.length;B=B.next;){var P=B.data,D=T>P.length?P.length:T;if(D===P.length?R+=P:R+=P.slice(0,T),T-=D,T===0){D===P.length?(++M,B.next?this.head=B.next:this.head=this.tail=null):(this.head=B,B.data=P.slice(D));break}++M}return this.length-=M,R}},{key:"_getBuffer",value:function(T){var B=o.allocUnsafe(T),M=this.head,R=1;for(M.data.copy(B),T-=M.data.length;M=M.next;){var P=M.data,D=T>P.length?P.length:T;if(P.copy(B,B.length-T,0,D),T-=D,T===0){D===P.length?(++R,M.next?this.head=M.next:this.head=this.tail=null):(this.head=M,M.data=P.slice(D));break}++R}return this.length-=R,B}},{key:y,value:function(T,B){return g(this,e(e({},B),{},{depth:0,customInspect:!1}))}}]),A}(),bc}var _c,Ip;function cy(){if(Ip)return _c;Ip=1;function i(c,u){var v=this,o=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return o||h?(u?u(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(a,this,c)):process.nextTick(a,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,function(g){!u&&g?v._writableState?v._writableState.errorEmitted?process.nextTick(r,v):(v._writableState.errorEmitted=!0,process.nextTick(e,v,g)):process.nextTick(e,v,g):u?(process.nextTick(r,v),u(g)):process.nextTick(r,v)}),this)}function e(c,u){a(c,u),r(c)}function r(c){c._writableState&&!c._writableState.emitClose||c._readableState&&!c._readableState.emitClose||c.emit("close")}function t(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function a(c,u){c.emit("error",u)}function n(c,u){var v=c._readableState,o=c._writableState;v&&v.autoDestroy||o&&o.autoDestroy?c.destroy(u):c.emit("error",u)}return _c={destroy:i,undestroy:t,errorOrDestroy:n},_c}var wc={},Mp;function Ms(){if(Mp)return wc;Mp=1;function i(u,v){u.prototype=Object.create(v.prototype),u.prototype.constructor=u,u.__proto__=v}var e={};function r(u,v,o){o||(o=Error);function h(y,_,A){return typeof v=="string"?v:v(y,_,A)}var g=function(y){i(_,y);function _(A,S,T){return y.call(this,h(A,S,T))||this}return _}(o);g.prototype.name=o.name,g.prototype.code=u,e[u]=g}function t(u,v){if(Array.isArray(u)){var o=u.length;return u=u.map(function(h){return String(h)}),o>2?"one of ".concat(v," ").concat(u.slice(0,o-1).join(", "),", or ")+u[o-1]:o===2?"one of ".concat(v," ").concat(u[0]," or ").concat(u[1]):"of ".concat(v," ").concat(u[0])}else return"of ".concat(v," ").concat(String(u))}function a(u,v,o){return u.substr(0,v.length)===v}function n(u,v,o){return(o===void 0||o>u.length)&&(o=u.length),u.substring(o-v.length,o)===v}function c(u,v,o){return typeof o!="number"&&(o=0),o+v.length>u.length?!1:u.indexOf(v,o)!==-1}return r("ERR_INVALID_OPT_VALUE",function(u,v){return'The value "'+v+'" is invalid for option "'+u+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(u,v,o){var h;typeof v=="string"&&a(v,"not ")?(h="must not be",v=v.replace(/^not /,"")):h="must be";var g;if(n(u," argument"))g="The ".concat(u," ").concat(h," ").concat(t(v,"type"));else{var y=c(u,".")?"property":"argument";g='The "'.concat(u,'" ').concat(y," ").concat(h," ").concat(t(v,"type"))}return g+=". Received type ".concat(typeof o),g},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(u){return"The "+u+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(u){return"Cannot call "+u+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(u){return"Unknown encoding: "+u},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),wc.codes=e,wc}var Cc,Bp;function uy(){if(Bp)return Cc;Bp=1;var i=Ms().codes.ERR_INVALID_OPT_VALUE;function e(t,a,n){return t.highWaterMark!=null?t.highWaterMark:a?t[n]:null}function r(t,a,n,c){var u=e(a,c,n);if(u!=null){if(!(isFinite(u)&&Math.floor(u)===u)||u<0){var v=c?n:"highWaterMark";throw new i(v,u)}return Math.floor(u)}return t.objectMode?16:16*1024}return Cc={getHighWaterMark:r},Cc}var Ec,Lp;function hy(){if(Lp)return Ec;Lp=1,Ec=i;function i(r,t){if(e("noDeprecation"))return r;var a=!1;function n(){if(!a){if(e("throwDeprecation"))throw new Error(t);e("traceDeprecation")?console.trace(t):console.warn(t),a=!0}return r.apply(this,arguments)}return n}function e(r){try{if(!globalThis.localStorage)return!1}catch{return!1}var t=globalThis.localStorage[r];return t==null?!1:String(t).toLowerCase()==="true"}return Ec}var Ac,Tp;function dy(){if(Tp)return Ac;Tp=1,Ac=U;function i(I){var K=this;this.next=null,this.entry=null,this.finish=function(){$(K,I)}}var e;U.WritableState=q;var r={deprecate:hy()},t=ly(),a=Ni().Buffer,n=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function c(I){return a.from(I)}function u(I){return a.isBuffer(I)||I instanceof n}var v=cy(),o=uy(),h=o.getHighWaterMark,g=Ms().codes,y=g.ERR_INVALID_ARG_TYPE,_=g.ERR_METHOD_NOT_IMPLEMENTED,A=g.ERR_MULTIPLE_CALLBACK,S=g.ERR_STREAM_CANNOT_PIPE,T=g.ERR_STREAM_DESTROYED,B=g.ERR_STREAM_NULL_VALUES,M=g.ERR_STREAM_WRITE_AFTER_END,R=g.ERR_UNKNOWN_ENCODING,P=v.errorOrDestroy;De()(U,t);function D(){}function q(I,K,N){e=e||gs(),I=I||{},typeof N!="boolean"&&(N=K instanceof e),this.objectMode=!!I.objectMode,N&&(this.objectMode=this.objectMode||!!I.writableObjectMode),this.highWaterMark=h(this,I,"writableHighWaterMark",N),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var X=I.decodeStrings===!1;this.decodeStrings=!X,this.defaultEncoding=I.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Q){m(K,Q)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=I.emitClose!==!1,this.autoDestroy=!!I.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}q.prototype.getBuffer=function(){for(var K=this.bufferedRequest,N=[];K;)N.push(K),K=K.next;return N},function(){try{Object.defineProperty(q.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var k;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(k=Function.prototype[Symbol.hasInstance],Object.defineProperty(U,Symbol.hasInstance,{value:function(K){return k.call(this,K)?!0:this!==U?!1:K&&K._writableState instanceof q}})):k=function(K){return K instanceof this};function U(I){e=e||gs();var K=this instanceof e;if(!K&&!k.call(U,this))return new U(I);this._writableState=new q(I,this,K),this.writable=!0,I&&(typeof I.write=="function"&&(this._write=I.write),typeof I.writev=="function"&&(this._writev=I.writev),typeof I.destroy=="function"&&(this._destroy=I.destroy),typeof I.final=="function"&&(this._final=I.final)),t.call(this)}U.prototype.pipe=function(){P(this,new S)};function O(I,K){var N=new M;P(I,N),process.nextTick(K,N)}function G(I,K,N,X){var Q;return N===null?Q=new B:typeof N!="string"&&!K.objectMode&&(Q=new y("chunk",["string","Buffer"],N)),Q?(P(I,Q),process.nextTick(X,Q),!1):!0}U.prototype.write=function(I,K,N){var X=this._writableState,Q=!1,L=!X.objectMode&&u(I);return L&&!a.isBuffer(I)&&(I=c(I)),typeof K=="function"&&(N=K,K=null),L?K="buffer":K||(K=X.defaultEncoding),typeof N!="function"&&(N=D),X.ending?O(this,N):(L||G(this,X,I,N))&&(X.pendingcb++,Q=s(this,X,L,I,K,N)),Q},U.prototype.cork=function(){this._writableState.corked++},U.prototype.uncork=function(){var I=this._writableState;I.corked&&(I.corked--,!I.writing&&!I.corked&&!I.bufferProcessing&&I.bufferedRequest&&b(this,I))},U.prototype.setDefaultEncoding=function(K){if(typeof K=="string"&&(K=K.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((K+"").toLowerCase())>-1))throw new R(K);return this._writableState.defaultEncoding=K,this},Object.defineProperty(U.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function E(I,K,N){return!I.objectMode&&I.decodeStrings!==!1&&typeof K=="string"&&(K=a.from(K,N)),K}Object.defineProperty(U.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function s(I,K,N,X,Q,L){if(!N){var V=E(K,X,Q);X!==V&&(N=!0,Q="buffer",X=V)}var Z=K.objectMode?1:X.length;K.length+=Z;var H=K.length<K.highWaterMark;if(H||(K.needDrain=!0),K.writing||K.corked){var j=K.lastBufferedRequest;K.lastBufferedRequest={chunk:X,encoding:Q,isBuf:N,callback:L,next:null},j?j.next=K.lastBufferedRequest:K.bufferedRequest=K.lastBufferedRequest,K.bufferedRequestCount+=1}else l(I,K,!1,Z,X,Q,L);return H}function l(I,K,N,X,Q,L,V){K.writelen=X,K.writecb=V,K.writing=!0,K.sync=!0,K.destroyed?K.onwrite(new T("write")):N?I._writev(Q,K.onwrite):I._write(Q,L,K.onwrite),K.sync=!1}function d(I,K,N,X,Q){--K.pendingcb,N?(process.nextTick(Q,X),process.nextTick(z,I,K),I._writableState.errorEmitted=!0,P(I,X)):(Q(X),I._writableState.errorEmitted=!0,P(I,X),z(I,K))}function p(I){I.writing=!1,I.writecb=null,I.length-=I.writelen,I.writelen=0}function m(I,K){var N=I._writableState,X=N.sync,Q=N.writecb;if(typeof Q!="function")throw new A;if(p(N),K)d(I,N,X,K,Q);else{var L=f(N)||I.destroyed;!L&&!N.corked&&!N.bufferProcessing&&N.bufferedRequest&&b(I,N),X?process.nextTick(w,I,N,L,Q):w(I,N,L,Q)}}function w(I,K,N,X){N||x(I,K),K.pendingcb--,X(),z(I,K)}function x(I,K){K.length===0&&K.needDrain&&(K.needDrain=!1,I.emit("drain"))}function b(I,K){K.bufferProcessing=!0;var N=K.bufferedRequest;if(I._writev&&N&&N.next){var X=K.bufferedRequestCount,Q=new Array(X),L=K.corkedRequestsFree;L.entry=N;for(var V=0,Z=!0;N;)Q[V]=N,N.isBuf||(Z=!1),N=N.next,V+=1;Q.allBuffers=Z,l(I,K,!0,K.length,Q,"",L.finish),K.pendingcb++,K.lastBufferedRequest=null,L.next?(K.corkedRequestsFree=L.next,L.next=null):K.corkedRequestsFree=new i(K),K.bufferedRequestCount=0}else{for(;N;){var H=N.chunk,j=N.encoding,et=N.callback,nt=K.objectMode?1:H.length;if(l(I,K,!1,nt,H,j,et),N=N.next,K.bufferedRequestCount--,K.writing)break}N===null&&(K.lastBufferedRequest=null)}K.bufferedRequest=N,K.bufferProcessing=!1}U.prototype._write=function(I,K,N){N(new _("_write()"))},U.prototype._writev=null,U.prototype.end=function(I,K,N){var X=this._writableState;return typeof I=="function"?(N=I,I=null,K=null):typeof K=="function"&&(N=K,K=null),I!=null&&this.write(I,K),X.corked&&(X.corked=1,this.uncork()),X.ending||W(this,X,N),this},Object.defineProperty(U.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function f(I){return I.ending&&I.length===0&&I.bufferedRequest===null&&!I.finished&&!I.writing}function C(I,K){I._final(function(N){K.pendingcb--,N&&P(I,N),K.prefinished=!0,I.emit("prefinish"),z(I,K)})}function F(I,K){!K.prefinished&&!K.finalCalled&&(typeof I._final=="function"&&!K.destroyed?(K.pendingcb++,K.finalCalled=!0,process.nextTick(C,I,K)):(K.prefinished=!0,I.emit("prefinish")))}function z(I,K){var N=f(K);if(N&&(F(I,K),K.pendingcb===0&&(K.finished=!0,I.emit("finish"),K.autoDestroy))){var X=I._readableState;(!X||X.autoDestroy&&X.endEmitted)&&I.destroy()}return N}function W(I,K,N){K.ending=!0,z(I,K),N&&(K.finished?process.nextTick(N):I.once("finish",N)),K.ended=!0,I.writable=!1}function $(I,K,N){var X=I.entry;for(I.entry=null;X;){var Q=X.callback;K.pendingcb--,Q(N),X=X.next}K.corkedRequestsFree.next=I}return Object.defineProperty(U.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(K){this._writableState&&(this._writableState.destroyed=K)}}),U.prototype.destroy=v.destroy,U.prototype._undestroy=v.undestroy,U.prototype._destroy=function(I,K){K(I)},Ac}var Sc,Rp;function gs(){if(Rp)return Sc;Rp=1;var i=Object.keys||function(o){var h=[];for(var g in o)h.push(g);return h};Sc=c;var e=py(),r=dy();De()(c,e);for(var t=i(r.prototype),a=0;a<t.length;a++){var n=t[a];c.prototype[n]||(c.prototype[n]=r.prototype[n])}function c(o){if(!(this instanceof c))return new c(o);e.call(this,o),r.call(this,o),this.allowHalfOpen=!0,o&&(o.readable===!1&&(this.readable=!1),o.writable===!1&&(this.writable=!1),o.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",u)))}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function u(){this._writableState.ended||process.nextTick(v,this)}function v(o){o.end()}return Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(h){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=h,this._writableState.destroyed=h)}}),Sc}var xc={},Np;function jh(){if(Np)return xc;Np=1;var i=er().Buffer,e=i.isEncoding||function(B){switch(B=""+B,B&&B.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(B){if(!B)return"utf8";for(var M;;)switch(B){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return B;default:if(M)return;B=(""+B).toLowerCase(),M=!0}}function t(B){var M=r(B);if(typeof M!="string"&&(i.isEncoding===e||!e(B)))throw new Error("Unknown encoding: "+B);return M||B}xc.StringDecoder=a;function a(B){this.encoding=t(B);var M;switch(this.encoding){case"utf16le":this.text=g,this.end=y,M=4;break;case"utf8":this.fillLast=v,M=4;break;case"base64":this.text=_,this.end=A,M=3;break;default:this.write=S,this.end=T;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(M)}a.prototype.write=function(B){if(B.length===0)return"";var M,R;if(this.lastNeed){if(M=this.fillLast(B),M===void 0)return"";R=this.lastNeed,this.lastNeed=0}else R=0;return R<B.length?M?M+this.text(B,R):this.text(B,R):M||""},a.prototype.end=h,a.prototype.text=o,a.prototype.fillLast=function(B){if(this.lastNeed<=B.length)return B.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);B.copy(this.lastChar,this.lastTotal-this.lastNeed,0,B.length),this.lastNeed-=B.length};function n(B){return B<=127?0:B>>5===6?2:B>>4===14?3:B>>3===30?4:B>>6===2?-1:-2}function c(B,M,R){var P=M.length-1;if(P<R)return 0;var D=n(M[P]);return D>=0?(D>0&&(B.lastNeed=D-1),D):--P<R||D===-2?0:(D=n(M[P]),D>=0?(D>0&&(B.lastNeed=D-2),D):--P<R||D===-2?0:(D=n(M[P]),D>=0?(D>0&&(D===2?D=0:B.lastNeed=D-3),D):0))}function u(B,M,R){if((M[0]&192)!==128)return B.lastNeed=0,"";if(B.lastNeed>1&&M.length>1){if((M[1]&192)!==128)return B.lastNeed=1,"";if(B.lastNeed>2&&M.length>2&&(M[2]&192)!==128)return B.lastNeed=2,""}}function v(B){var M=this.lastTotal-this.lastNeed,R=u(this,B);if(R!==void 0)return R;if(this.lastNeed<=B.length)return B.copy(this.lastChar,M,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);B.copy(this.lastChar,M,0,B.length),this.lastNeed-=B.length}function o(B,M){var R=c(this,B,M);if(!this.lastNeed)return B.toString("utf8",M);this.lastTotal=R;var P=B.length-(R-this.lastNeed);return B.copy(this.lastChar,0,P),B.toString("utf8",M,P)}function h(B){var M=B&&B.length?this.write(B):"";return this.lastNeed?M+"":M}function g(B,M){if((B.length-M)%2===0){var R=B.toString("utf16le",M);if(R){var P=R.charCodeAt(R.length-1);if(P>=55296&&P<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=B[B.length-2],this.lastChar[1]=B[B.length-1],R.slice(0,-1)}return R}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=B[B.length-1],B.toString("utf16le",M,B.length-1)}function y(B){var M=B&&B.length?this.write(B):"";if(this.lastNeed){var R=this.lastTotal-this.lastNeed;return M+this.lastChar.toString("utf16le",0,R)}return M}function _(B,M){var R=(B.length-M)%3;return R===0?B.toString("base64",M):(this.lastNeed=3-R,this.lastTotal=3,R===1?this.lastChar[0]=B[B.length-1]:(this.lastChar[0]=B[B.length-2],this.lastChar[1]=B[B.length-1]),B.toString("base64",M,B.length-R))}function A(B){var M=B&&B.length?this.write(B):"";return this.lastNeed?M+this.lastChar.toString("base64",0,3-this.lastNeed):M}function S(B){return B.toString(this.encoding)}function T(B){return B&&B.length?this.write(B):""}return xc}var Ic,kp;function r1(){if(kp)return Ic;kp=1;var i=Ms().codes.ERR_STREAM_PREMATURE_CLOSE;function e(n){var c=!1;return function(){if(!c){c=!0;for(var u=arguments.length,v=new Array(u),o=0;o<u;o++)v[o]=arguments[o];n.apply(this,v)}}}function r(){}function t(n){return n.setHeader&&typeof n.abort=="function"}function a(n,c,u){if(typeof c=="function")return a(n,null,c);c||(c={}),u=e(u||r);var v=c.readable||c.readable!==!1&&n.readable,o=c.writable||c.writable!==!1&&n.writable,h=function(){n.writable||y()},g=n._writableState&&n._writableState.finished,y=function(){o=!1,g=!0,v||u.call(n)},_=n._readableState&&n._readableState.endEmitted,A=function(){v=!1,_=!0,o||u.call(n)},S=function(R){u.call(n,R)},T=function(){var R;if(v&&!_)return(!n._readableState||!n._readableState.ended)&&(R=new i),u.call(n,R);if(o&&!g)return(!n._writableState||!n._writableState.ended)&&(R=new i),u.call(n,R)},B=function(){n.req.on("finish",y)};return t(n)?(n.on("complete",y),n.on("abort",T),n.req?B():n.on("request",B)):o&&!n._writableState&&(n.on("end",h),n.on("close",h)),n.on("end",A),n.on("finish",y),c.error!==!1&&n.on("error",S),n.on("close",T),function(){n.removeListener("complete",y),n.removeListener("abort",T),n.removeListener("request",B),n.req&&n.req.removeListener("finish",y),n.removeListener("end",h),n.removeListener("close",h),n.removeListener("finish",y),n.removeListener("end",A),n.removeListener("error",S),n.removeListener("close",T)}}return Ic=a,Ic}var Mc,Pp;function a8(){if(Pp)return Mc;Pp=1;var i;function e(R,P,D){return P=r(P),P in R?Object.defineProperty(R,P,{value:D,enumerable:!0,configurable:!0,writable:!0}):R[P]=D,R}function r(R){var P=t(R,"string");return typeof P=="symbol"?P:String(P)}function t(R,P){if(typeof R!="object"||R===null)return R;var D=R[Symbol.toPrimitive];if(D!==void 0){var q=D.call(R,P||"default");if(typeof q!="object")return q;throw new TypeError("@@toPrimitive must return a primitive value.")}return(P==="string"?String:Number)(R)}var a=r1(),n=Symbol("lastResolve"),c=Symbol("lastReject"),u=Symbol("error"),v=Symbol("ended"),o=Symbol("lastPromise"),h=Symbol("handlePromise"),g=Symbol("stream");function y(R,P){return{value:R,done:P}}function _(R){var P=R[n];if(P!==null){var D=R[g].read();D!==null&&(R[o]=null,R[n]=null,R[c]=null,P(y(D,!1)))}}function A(R){process.nextTick(_,R)}function S(R,P){return function(D,q){R.then(function(){if(P[v]){D(y(void 0,!0));return}P[h](D,q)},q)}}var T=Object.getPrototypeOf(function(){}),B=Object.setPrototypeOf((i={get stream(){return this[g]},next:function(){var P=this,D=this[u];if(D!==null)return Promise.reject(D);if(this[v])return Promise.resolve(y(void 0,!0));if(this[g].destroyed)return new Promise(function(O,G){process.nextTick(function(){P[u]?G(P[u]):O(y(void 0,!0))})});var q=this[o],k;if(q)k=new Promise(S(q,this));else{var U=this[g].read();if(U!==null)return Promise.resolve(y(U,!1));k=new Promise(this[h])}return this[o]=k,k}},e(i,Symbol.asyncIterator,function(){return this}),e(i,"return",function(){var P=this;return new Promise(function(D,q){P[g].destroy(null,function(k){if(k){q(k);return}D(y(void 0,!0))})})}),i),T),M=function(P){var D,q=Object.create(B,(D={},e(D,g,{value:P,writable:!0}),e(D,n,{value:null,writable:!0}),e(D,c,{value:null,writable:!0}),e(D,u,{value:null,writable:!0}),e(D,v,{value:P._readableState.endEmitted,writable:!0}),e(D,h,{value:function(U,O){var G=q[g].read();G?(q[o]=null,q[n]=null,q[c]=null,U(y(G,!1))):(q[n]=U,q[c]=O)},writable:!0}),D));return q[o]=null,a(P,function(k){if(k&&k.code!=="ERR_STREAM_PREMATURE_CLOSE"){var U=q[c];U!==null&&(q[o]=null,q[n]=null,q[c]=null,U(k)),q[u]=k;return}var O=q[n];O!==null&&(q[o]=null,q[n]=null,q[c]=null,O(y(void 0,!0))),q[v]=!0}),P.on("readable",A.bind(null,q)),q};return Mc=M,Mc}var Bc,Up;function s8(){return Up||(Up=1,Bc=function(){throw new Error("Readable.from is not available in the browser")}),Bc}var Lc,Dp;function py(){if(Dp)return Lc;Dp=1,Lc=O;var i;O.ReadableState=U,Oo().EventEmitter;var e=function(V,Z){return V.listeners(Z).length},r=ly(),t=Ni().Buffer,a=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function n(L){return t.from(L)}function c(L){return t.isBuffer(L)||L instanceof a}var u=$i,v;u&&u.debuglog?v=u.debuglog("stream"):v=function(){};var o=n8(),h=cy(),g=uy(),y=g.getHighWaterMark,_=Ms().codes,A=_.ERR_INVALID_ARG_TYPE,S=_.ERR_STREAM_PUSH_AFTER_EOF,T=_.ERR_METHOD_NOT_IMPLEMENTED,B=_.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,M,R,P;De()(O,r);var D=h.errorOrDestroy,q=["error","close","destroy","pause","resume"];function k(L,V,Z){if(typeof L.prependListener=="function")return L.prependListener(V,Z);!L._events||!L._events[V]?L.on(V,Z):Array.isArray(L._events[V])?L._events[V].unshift(Z):L._events[V]=[Z,L._events[V]]}function U(L,V,Z){i=i||gs(),L=L||{},typeof Z!="boolean"&&(Z=V instanceof i),this.objectMode=!!L.objectMode,Z&&(this.objectMode=this.objectMode||!!L.readableObjectMode),this.highWaterMark=y(this,L,"readableHighWaterMark",Z),this.buffer=new o,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=L.emitClose!==!1,this.autoDestroy=!!L.autoDestroy,this.destroyed=!1,this.defaultEncoding=L.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,L.encoding&&(M||(M=jh().StringDecoder),this.decoder=new M(L.encoding),this.encoding=L.encoding)}function O(L){if(i=i||gs(),!(this instanceof O))return new O(L);var V=this instanceof i;this._readableState=new U(L,this,V),this.readable=!0,L&&(typeof L.read=="function"&&(this._read=L.read),typeof L.destroy=="function"&&(this._destroy=L.destroy)),r.call(this)}Object.defineProperty(O.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(V){this._readableState&&(this._readableState.destroyed=V)}}),O.prototype.destroy=h.destroy,O.prototype._undestroy=h.undestroy,O.prototype._destroy=function(L,V){V(L)},O.prototype.push=function(L,V){var Z=this._readableState,H;return Z.objectMode?H=!0:typeof L=="string"&&(V=V||Z.defaultEncoding,V!==Z.encoding&&(L=t.from(L,V),V=""),H=!0),G(this,L,V,!1,H)},O.prototype.unshift=function(L){return G(this,L,null,!0,!1)};function G(L,V,Z,H,j){v("readableAddChunk",V);var et=L._readableState;if(V===null)et.reading=!1,m(L,et);else{var nt;if(j||(nt=s(et,V)),nt)D(L,nt);else if(et.objectMode||V&&V.length>0)if(typeof V!="string"&&!et.objectMode&&Object.getPrototypeOf(V)!==t.prototype&&(V=n(V)),H)et.endEmitted?D(L,new B):E(L,et,V,!0);else if(et.ended)D(L,new S);else{if(et.destroyed)return!1;et.reading=!1,et.decoder&&!Z?(V=et.decoder.write(V),et.objectMode||V.length!==0?E(L,et,V,!1):b(L,et)):E(L,et,V,!1)}else H||(et.reading=!1,b(L,et))}return!et.ended&&(et.length<et.highWaterMark||et.length===0)}function E(L,V,Z,H){V.flowing&&V.length===0&&!V.sync?(V.awaitDrain=0,L.emit("data",Z)):(V.length+=V.objectMode?1:Z.length,H?V.buffer.unshift(Z):V.buffer.push(Z),V.needReadable&&w(L)),b(L,V)}function s(L,V){var Z;return!c(V)&&typeof V!="string"&&V!==void 0&&!L.objectMode&&(Z=new A("chunk",["string","Buffer","Uint8Array"],V)),Z}O.prototype.isPaused=function(){return this._readableState.flowing===!1},O.prototype.setEncoding=function(L){M||(M=jh().StringDecoder);var V=new M(L);this._readableState.decoder=V,this._readableState.encoding=this._readableState.decoder.encoding;for(var Z=this._readableState.buffer.head,H="";Z!==null;)H+=V.write(Z.data),Z=Z.next;return this._readableState.buffer.clear(),H!==""&&this._readableState.buffer.push(H),this._readableState.length=H.length,this};var l=1073741824;function d(L){return L>=l?L=l:(L--,L|=L>>>1,L|=L>>>2,L|=L>>>4,L|=L>>>8,L|=L>>>16,L++),L}function p(L,V){return L<=0||V.length===0&&V.ended?0:V.objectMode?1:L!==L?V.flowing&&V.length?V.buffer.head.data.length:V.length:(L>V.highWaterMark&&(V.highWaterMark=d(L)),L<=V.length?L:V.ended?V.length:(V.needReadable=!0,0))}O.prototype.read=function(L){v("read",L),L=parseInt(L,10);var V=this._readableState,Z=L;if(L!==0&&(V.emittedReadable=!1),L===0&&V.needReadable&&((V.highWaterMark!==0?V.length>=V.highWaterMark:V.length>0)||V.ended))return v("read: emitReadable",V.length,V.ended),V.length===0&&V.ended?N(this):w(this),null;if(L=p(L,V),L===0&&V.ended)return V.length===0&&N(this),null;var H=V.needReadable;v("need readable",H),(V.length===0||V.length-L<V.highWaterMark)&&(H=!0,v("length less than watermark",H)),V.ended||V.reading?(H=!1,v("reading or ended",H)):H&&(v("do read"),V.reading=!0,V.sync=!0,V.length===0&&(V.needReadable=!0),this._read(V.highWaterMark),V.sync=!1,V.reading||(L=p(Z,V)));var j;return L>0?j=K(L,V):j=null,j===null?(V.needReadable=V.length<=V.highWaterMark,L=0):(V.length-=L,V.awaitDrain=0),V.length===0&&(V.ended||(V.needReadable=!0),Z!==L&&V.ended&&N(this)),j!==null&&this.emit("data",j),j};function m(L,V){if(v("onEofChunk"),!V.ended){if(V.decoder){var Z=V.decoder.end();Z&&Z.length&&(V.buffer.push(Z),V.length+=V.objectMode?1:Z.length)}V.ended=!0,V.sync?w(L):(V.needReadable=!1,V.emittedReadable||(V.emittedReadable=!0,x(L)))}}function w(L){var V=L._readableState;v("emitReadable",V.needReadable,V.emittedReadable),V.needReadable=!1,V.emittedReadable||(v("emitReadable",V.flowing),V.emittedReadable=!0,process.nextTick(x,L))}function x(L){var V=L._readableState;v("emitReadable_",V.destroyed,V.length,V.ended),!V.destroyed&&(V.length||V.ended)&&(L.emit("readable"),V.emittedReadable=!1),V.needReadable=!V.flowing&&!V.ended&&V.length<=V.highWaterMark,I(L)}function b(L,V){V.readingMore||(V.readingMore=!0,process.nextTick(f,L,V))}function f(L,V){for(;!V.reading&&!V.ended&&(V.length<V.highWaterMark||V.flowing&&V.length===0);){var Z=V.length;if(v("maybeReadMore read 0"),L.read(0),Z===V.length)break}V.readingMore=!1}O.prototype._read=function(L){D(this,new T("_read()"))},O.prototype.pipe=function(L,V){var Z=this,H=this._readableState;switch(H.pipesCount){case 0:H.pipes=L;break;case 1:H.pipes=[H.pipes,L];break;default:H.pipes.push(L);break}H.pipesCount+=1,v("pipe count=%d opts=%j",H.pipesCount,V);var j=(!V||V.end!==!1)&&L!==process.stdout&&L!==process.stderr,et=j?st:Jt;H.endEmitted?process.nextTick(et):Z.once("end",et),L.on("unpipe",nt);function nt(at,J){v("onunpipe"),at===Z&&J&&J.hasUnpiped===!1&&(J.hasUnpiped=!0,ot())}function st(){v("onend"),L.end()}var ft=C(Z);L.on("drain",ft);var vt=!1;function ot(){v("cleanup"),L.removeListener("close",At),L.removeListener("finish",It),L.removeListener("drain",ft),L.removeListener("error",Ut),L.removeListener("unpipe",nt),Z.removeListener("end",st),Z.removeListener("end",Jt),Z.removeListener("data",pt),vt=!0,H.awaitDrain&&(!L._writableState||L._writableState.needDrain)&&ft()}Z.on("data",pt);function pt(at){v("ondata");var J=L.write(at);v("dest.write",J),J===!1&&((H.pipesCount===1&&H.pipes===L||H.pipesCount>1&&Q(H.pipes,L)!==-1)&&!vt&&(v("false write response, pause",H.awaitDrain),H.awaitDrain++),Z.pause())}function Ut(at){v("onerror",at),Jt(),L.removeListener("error",Ut),e(L,"error")===0&&D(L,at)}k(L,"error",Ut);function At(){L.removeListener("finish",It),Jt()}L.once("close",At);function It(){v("onfinish"),L.removeListener("close",At),Jt()}L.once("finish",It);function Jt(){v("unpipe"),Z.unpipe(L)}return L.emit("pipe",Z),H.flowing||(v("pipe resume"),Z.resume()),L};function C(L){return function(){var Z=L._readableState;v("pipeOnDrain",Z.awaitDrain),Z.awaitDrain&&Z.awaitDrain--,Z.awaitDrain===0&&e(L,"data")&&(Z.flowing=!0,I(L))}}O.prototype.unpipe=function(L){var V=this._readableState,Z={hasUnpiped:!1};if(V.pipesCount===0)return this;if(V.pipesCount===1)return L&&L!==V.pipes?this:(L||(L=V.pipes),V.pipes=null,V.pipesCount=0,V.flowing=!1,L&&L.emit("unpipe",this,Z),this);if(!L){var H=V.pipes,j=V.pipesCount;V.pipes=null,V.pipesCount=0,V.flowing=!1;for(var et=0;et<j;et++)H[et].emit("unpipe",this,{hasUnpiped:!1});return this}var nt=Q(V.pipes,L);return nt===-1?this:(V.pipes.splice(nt,1),V.pipesCount-=1,V.pipesCount===1&&(V.pipes=V.pipes[0]),L.emit("unpipe",this,Z),this)},O.prototype.on=function(L,V){var Z=r.prototype.on.call(this,L,V),H=this._readableState;return L==="data"?(H.readableListening=this.listenerCount("readable")>0,H.flowing!==!1&&this.resume()):L==="readable"&&!H.endEmitted&&!H.readableListening&&(H.readableListening=H.needReadable=!0,H.flowing=!1,H.emittedReadable=!1,v("on readable",H.length,H.reading),H.length?w(this):H.reading||process.nextTick(z,this)),Z},O.prototype.addListener=O.prototype.on,O.prototype.removeListener=function(L,V){var Z=r.prototype.removeListener.call(this,L,V);return L==="readable"&&process.nextTick(F,this),Z},O.prototype.removeAllListeners=function(L){var V=r.prototype.removeAllListeners.apply(this,arguments);return(L==="readable"||L===void 0)&&process.nextTick(F,this),V};function F(L){var V=L._readableState;V.readableListening=L.listenerCount("readable")>0,V.resumeScheduled&&!V.paused?V.flowing=!0:L.listenerCount("data")>0&&L.resume()}function z(L){v("readable nexttick read 0"),L.read(0)}O.prototype.resume=function(){var L=this._readableState;return L.flowing||(v("resume"),L.flowing=!L.readableListening,W(this,L)),L.paused=!1,this};function W(L,V){V.resumeScheduled||(V.resumeScheduled=!0,process.nextTick($,L,V))}function $(L,V){v("resume",V.reading),V.reading||L.read(0),V.resumeScheduled=!1,L.emit("resume"),I(L),V.flowing&&!V.reading&&L.read(0)}O.prototype.pause=function(){return v("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(v("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function I(L){var V=L._readableState;for(v("flow",V.flowing);V.flowing&&L.read()!==null;);}O.prototype.wrap=function(L){var V=this,Z=this._readableState,H=!1;L.on("end",function(){if(v("wrapped end"),Z.decoder&&!Z.ended){var nt=Z.decoder.end();nt&&nt.length&&V.push(nt)}V.push(null)}),L.on("data",function(nt){if(v("wrapped data"),Z.decoder&&(nt=Z.decoder.write(nt)),!(Z.objectMode&&nt==null)&&!(!Z.objectMode&&(!nt||!nt.length))){var st=V.push(nt);st||(H=!0,L.pause())}});for(var j in L)this[j]===void 0&&typeof L[j]=="function"&&(this[j]=function(st){return function(){return L[st].apply(L,arguments)}}(j));for(var et=0;et<q.length;et++)L.on(q[et],this.emit.bind(this,q[et]));return this._read=function(nt){v("wrapped _read",nt),H&&(H=!1,L.resume())},this},typeof Symbol=="function"&&(O.prototype[Symbol.asyncIterator]=function(){return R===void 0&&(R=a8()),R(this)}),Object.defineProperty(O.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(O.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(O.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(V){this._readableState&&(this._readableState.flowing=V)}}),O._fromList=K,Object.defineProperty(O.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function K(L,V){if(V.length===0)return null;var Z;return V.objectMode?Z=V.buffer.shift():!L||L>=V.length?(V.decoder?Z=V.buffer.join(""):V.buffer.length===1?Z=V.buffer.first():Z=V.buffer.concat(V.length),V.buffer.clear()):Z=V.buffer.consume(L,V.decoder),Z}function N(L){var V=L._readableState;v("endReadable",V.endEmitted),V.endEmitted||(V.ended=!0,process.nextTick(X,V,L))}function X(L,V){if(v("endReadableNT",L.endEmitted,L.length),!L.endEmitted&&L.length===0&&(L.endEmitted=!0,V.readable=!1,V.emit("end"),L.autoDestroy)){var Z=V._writableState;(!Z||Z.autoDestroy&&Z.finished)&&V.destroy()}}typeof Symbol=="function"&&(O.from=function(L,V){return P===void 0&&(P=s8()),P(O,L,V)});function Q(L,V){for(var Z=0,H=L.length;Z<H;Z++)if(L[Z]===V)return Z;return-1}return Lc}var Tc,Op;function vy(){if(Op)return Tc;Op=1,Tc=u;var i=Ms().codes,e=i.ERR_METHOD_NOT_IMPLEMENTED,r=i.ERR_MULTIPLE_CALLBACK,t=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=i.ERR_TRANSFORM_WITH_LENGTH_0,n=gs();De()(u,n);function c(h,g){var y=this._transformState;y.transforming=!1;var _=y.writecb;if(_===null)return this.emit("error",new r);y.writechunk=null,y.writecb=null,g!=null&&this.push(g),_(h);var A=this._readableState;A.reading=!1,(A.needReadable||A.length<A.highWaterMark)&&this._read(A.highWaterMark)}function u(h){if(!(this instanceof u))return new u(h);n.call(this,h),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,h&&(typeof h.transform=="function"&&(this._transform=h.transform),typeof h.flush=="function"&&(this._flush=h.flush)),this.on("prefinish",v)}function v(){var h=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(g,y){o(h,g,y)}):o(this,null,null)}u.prototype.push=function(h,g){return this._transformState.needTransform=!1,n.prototype.push.call(this,h,g)},u.prototype._transform=function(h,g,y){y(new e("_transform()"))},u.prototype._write=function(h,g,y){var _=this._transformState;if(_.writecb=y,_.writechunk=h,_.writeencoding=g,!_.transforming){var A=this._readableState;(_.needTransform||A.needReadable||A.length<A.highWaterMark)&&this._read(A.highWaterMark)}},u.prototype._read=function(h){var g=this._transformState;g.writechunk!==null&&!g.transforming?(g.transforming=!0,this._transform(g.writechunk,g.writeencoding,g.afterTransform)):g.needTransform=!0},u.prototype._destroy=function(h,g){n.prototype._destroy.call(this,h,function(y){g(y)})};function o(h,g,y){if(g)return h.emit("error",g);if(y!=null&&h.push(y),h._writableState.length)throw new a;if(h._transformState.transforming)throw new t;return h.push(null)}return Tc}var Rc,Fp;function o8(){if(Fp)return Rc;Fp=1,Rc=e;var i=vy();De()(e,i);function e(r){if(!(this instanceof e))return new e(r);i.call(this,r)}return e.prototype._transform=function(r,t,a){a(null,r)},Rc}var Nc,qp;function f8(){if(qp)return Nc;qp=1;var i;function e(y){var _=!1;return function(){_||(_=!0,y.apply(void 0,arguments))}}var r=Ms().codes,t=r.ERR_MISSING_ARGS,a=r.ERR_STREAM_DESTROYED;function n(y){if(y)throw y}function c(y){return y.setHeader&&typeof y.abort=="function"}function u(y,_,A,S){S=e(S);var T=!1;y.on("close",function(){T=!0}),i===void 0&&(i=r1()),i(y,{readable:_,writable:A},function(M){if(M)return S(M);T=!0,S()});var B=!1;return function(M){if(!T&&!B){if(B=!0,c(y))return y.abort();if(typeof y.destroy=="function")return y.destroy();S(M||new a("pipe"))}}}function v(y){y()}function o(y,_){return y.pipe(_)}function h(y){return!y.length||typeof y[y.length-1]!="function"?n:y.pop()}function g(){for(var y=arguments.length,_=new Array(y),A=0;A<y;A++)_[A]=arguments[A];var S=h(_);if(Array.isArray(_[0])&&(_=_[0]),_.length<2)throw new t("streams");var T,B=_.map(function(M,R){var P=R<_.length-1,D=R>0;return u(M,P,D,function(q){T||(T=q),q&&B.forEach(v),!P&&(B.forEach(v),S(T))})});return _.reduce(o)}return Nc=g,Nc}var kc,zp;function gy(){if(zp)return kc;zp=1,kc=r;var i=Oo().EventEmitter,e=De();e(r,i),r.Readable=py(),r.Writable=dy(),r.Duplex=gs(),r.Transform=vy(),r.PassThrough=o8(),r.finished=r1(),r.pipeline=f8(),r.Stream=r;function r(){i.call(this)}return r.prototype.pipe=function(t,a){var n=this;function c(_){t.writable&&t.write(_)===!1&&n.pause&&n.pause()}n.on("data",c);function u(){n.readable&&n.resume&&n.resume()}t.on("drain",u),!t._isStdio&&(!a||a.end!==!1)&&(n.on("end",o),n.on("close",h));var v=!1;function o(){v||(v=!0,t.end())}function h(){v||(v=!0,typeof t.destroy=="function"&&t.destroy())}function g(_){if(y(),i.listenerCount(this,"error")===0)throw _}n.on("error",g),t.on("error",g);function y(){n.removeListener("data",c),t.removeListener("drain",u),n.removeListener("end",o),n.removeListener("close",h),n.removeListener("error",g),t.removeListener("error",g),n.removeListener("end",y),n.removeListener("close",y),t.removeListener("close",y)}return n.on("end",y),n.on("close",y),t.on("close",y),t.emit("pipe",n),t},kc}var Pc,Vp;function my(){if(Vp)return Pc;Vp=1;var i=er().Buffer,e=gy().Transform,r=De();function t(u){e.call(this),this._block=i.allocUnsafe(u),this._blockSize=u,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}r(t,e),t.prototype._transform=function(u,v,o){var h=null;try{this.update(u,v)}catch(g){h=g}o(h)},t.prototype._flush=function(u){var v=null;try{this.push(this.digest())}catch(o){v=o}u(v)};var a=typeof Uint8Array<"u",n=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&ArrayBuffer.isView&&(i.prototype instanceof Uint8Array||i.TYPED_ARRAY_SUPPORT);function c(u,v){if(u instanceof i)return u;if(typeof u=="string")return i.from(u,v);if(n&&ArrayBuffer.isView(u)){if(u.byteLength===0)return i.alloc(0);var o=i.from(u.buffer,u.byteOffset,u.byteLength);if(o.byteLength===u.byteLength)return o}if(a&&u instanceof Uint8Array||i.isBuffer(u)&&u.constructor&&typeof u.constructor.isBuffer=="function"&&u.constructor.isBuffer(u))return i.from(u);throw new TypeError('The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView.')}return t.prototype.update=function(u,v){if(this._finalized)throw new Error("Digest already called");u=c(u,v);for(var o=this._block,h=0;this._blockOffset+u.length-h>=this._blockSize;){for(var g=this._blockOffset;g<this._blockSize;)o[g++]=u[h++];this._update(),this._blockOffset=0}for(;h<u.length;)o[this._blockOffset++]=u[h++];for(var y=0,_=u.length*8;_>0;++y)this._length[y]+=_,_=this._length[y]/4294967296|0,_>0&&(this._length[y]-=4294967296*_);return this},t.prototype._update=function(){throw new Error("_update is not implemented")},t.prototype.digest=function(u){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var v=this._digest();u!==void 0&&(v=v.toString(u)),this._block.fill(0),this._blockOffset=0;for(var o=0;o<4;++o)this._length[o]=0;return v},t.prototype._digest=function(){throw new Error("_digest is not implemented")},Pc=t,Pc}var Uc,Gp;function i1(){if(Gp)return Uc;Gp=1;var i=De(),e=my(),r=er().Buffer,t=new Array(16);function a(){e.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}i(a,e),a.prototype._update=function(){for(var h=t,g=0;g<16;++g)h[g]=this._block.readInt32LE(g*4);var y=this._a,_=this._b,A=this._c,S=this._d;y=c(y,_,A,S,h[0],3614090360,7),S=c(S,y,_,A,h[1],3905402710,12),A=c(A,S,y,_,h[2],606105819,17),_=c(_,A,S,y,h[3],3250441966,22),y=c(y,_,A,S,h[4],4118548399,7),S=c(S,y,_,A,h[5],1200080426,12),A=c(A,S,y,_,h[6],2821735955,17),_=c(_,A,S,y,h[7],4249261313,22),y=c(y,_,A,S,h[8],1770035416,7),S=c(S,y,_,A,h[9],2336552879,12),A=c(A,S,y,_,h[10],4294925233,17),_=c(_,A,S,y,h[11],2304563134,22),y=c(y,_,A,S,h[12],1804603682,7),S=c(S,y,_,A,h[13],4254626195,12),A=c(A,S,y,_,h[14],2792965006,17),_=c(_,A,S,y,h[15],1236535329,22),y=u(y,_,A,S,h[1],4129170786,5),S=u(S,y,_,A,h[6],3225465664,9),A=u(A,S,y,_,h[11],643717713,14),_=u(_,A,S,y,h[0],3921069994,20),y=u(y,_,A,S,h[5],3593408605,5),S=u(S,y,_,A,h[10],38016083,9),A=u(A,S,y,_,h[15],3634488961,14),_=u(_,A,S,y,h[4],3889429448,20),y=u(y,_,A,S,h[9],568446438,5),S=u(S,y,_,A,h[14],3275163606,9),A=u(A,S,y,_,h[3],4107603335,14),_=u(_,A,S,y,h[8],1163531501,20),y=u(y,_,A,S,h[13],2850285829,5),S=u(S,y,_,A,h[2],4243563512,9),A=u(A,S,y,_,h[7],1735328473,14),_=u(_,A,S,y,h[12],2368359562,20),y=v(y,_,A,S,h[5],4294588738,4),S=v(S,y,_,A,h[8],2272392833,11),A=v(A,S,y,_,h[11],1839030562,16),_=v(_,A,S,y,h[14],4259657740,23),y=v(y,_,A,S,h[1],2763975236,4),S=v(S,y,_,A,h[4],1272893353,11),A=v(A,S,y,_,h[7],4139469664,16),_=v(_,A,S,y,h[10],3200236656,23),y=v(y,_,A,S,h[13],681279174,4),S=v(S,y,_,A,h[0],3936430074,11),A=v(A,S,y,_,h[3],3572445317,16),_=v(_,A,S,y,h[6],76029189,23),y=v(y,_,A,S,h[9],3654602809,4),S=v(S,y,_,A,h[12],3873151461,11),A=v(A,S,y,_,h[15],530742520,16),_=v(_,A,S,y,h[2],3299628645,23),y=o(y,_,A,S,h[0],4096336452,6),S=o(S,y,_,A,h[7],1126891415,10),A=o(A,S,y,_,h[14],2878612391,15),_=o(_,A,S,y,h[5],4237533241,21),y=o(y,_,A,S,h[12],1700485571,6),S=o(S,y,_,A,h[3],2399980690,10),A=o(A,S,y,_,h[10],4293915773,15),_=o(_,A,S,y,h[1],2240044497,21),y=o(y,_,A,S,h[8],1873313359,6),S=o(S,y,_,A,h[15],4264355552,10),A=o(A,S,y,_,h[6],2734768916,15),_=o(_,A,S,y,h[13],1309151649,21),y=o(y,_,A,S,h[4],4149444226,6),S=o(S,y,_,A,h[11],3174756917,10),A=o(A,S,y,_,h[2],718787259,15),_=o(_,A,S,y,h[9],3951481745,21),this._a=this._a+y|0,this._b=this._b+_|0,this._c=this._c+A|0,this._d=this._d+S|0},a.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var h=r.allocUnsafe(16);return h.writeInt32LE(this._a,0),h.writeInt32LE(this._b,4),h.writeInt32LE(this._c,8),h.writeInt32LE(this._d,12),h};function n(h,g){return h<<g|h>>>32-g}function c(h,g,y,_,A,S,T){return n(h+(g&y|~g&_)+A+S|0,T)+g|0}function u(h,g,y,_,A,S,T){return n(h+(g&_|y&~_)+A+S|0,T)+g|0}function v(h,g,y,_,A,S,T){return n(h+(g^y^_)+A+S|0,T)+g|0}function o(h,g,y,_,A,S,T){return n(h+(y^(g|~_))+A+S|0,T)+g|0}return Uc=a,Uc}var Dc,Kp;function n1(){if(Kp)return Dc;Kp=1;var i=Ni().Buffer,e=De(),r=my(),t=new Array(16),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],n=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],c=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],u=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],v=[0,1518500249,1859775393,2400959708,2840853838],o=[1352829926,1548603684,1836072691,2053994217,0];function h(){r.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}e(h,r),h.prototype._update=function(){for(var B=t,M=0;M<16;++M)B[M]=this._block.readInt32LE(M*4);for(var R=this._a|0,P=this._b|0,D=this._c|0,q=this._d|0,k=this._e|0,U=this._a|0,O=this._b|0,G=this._c|0,E=this._d|0,s=this._e|0,l=0;l<80;l+=1){var d,p;l<16?(d=y(R,P,D,q,k,B[a[l]],v[0],c[l]),p=T(U,O,G,E,s,B[n[l]],o[0],u[l])):l<32?(d=_(R,P,D,q,k,B[a[l]],v[1],c[l]),p=S(U,O,G,E,s,B[n[l]],o[1],u[l])):l<48?(d=A(R,P,D,q,k,B[a[l]],v[2],c[l]),p=A(U,O,G,E,s,B[n[l]],o[2],u[l])):l<64?(d=S(R,P,D,q,k,B[a[l]],v[3],c[l]),p=_(U,O,G,E,s,B[n[l]],o[3],u[l])):(d=T(R,P,D,q,k,B[a[l]],v[4],c[l]),p=y(U,O,G,E,s,B[n[l]],o[4],u[l])),R=k,k=q,q=g(D,10),D=P,P=d,U=s,s=E,E=g(G,10),G=O,O=p}var m=this._b+D+E|0;this._b=this._c+q+s|0,this._c=this._d+k+U|0,this._d=this._e+R+O|0,this._e=this._a+P+G|0,this._a=m},h.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var B=i.alloc?i.alloc(20):new i(20);return B.writeInt32LE(this._a,0),B.writeInt32LE(this._b,4),B.writeInt32LE(this._c,8),B.writeInt32LE(this._d,12),B.writeInt32LE(this._e,16),B};function g(B,M){return B<<M|B>>>32-M}function y(B,M,R,P,D,q,k,U){return g(B+(M^R^P)+q+k|0,U)+D|0}function _(B,M,R,P,D,q,k,U){return g(B+(M&R|~M&P)+q+k|0,U)+D|0}function A(B,M,R,P,D,q,k,U){return g(B+((M|~R)^P)+q+k|0,U)+D|0}function S(B,M,R,P,D,q,k,U){return g(B+(M&P|R&~P)+q+k|0,U)+D|0}function T(B,M,R,P,D,q,k,U){return g(B+(M^(R|~P))+q+k|0,U)+D|0}return Dc=h,Dc}var Oc={exports:{}},Fc,Hp;function Bs(){if(Hp)return Fc;Hp=1;var i=er().Buffer;function e(r,t){this._block=i.alloc(r),this._finalSize=t,this._blockSize=r,this._len=0}return e.prototype.update=function(r,t){typeof r=="string"&&(t=t||"utf8",r=i.from(r,t));for(var a=this._block,n=this._blockSize,c=r.length,u=this._len,v=0;v<c;){for(var o=u%n,h=Math.min(c-v,n-o),g=0;g<h;g++)a[o+g]=r[v+g];u+=h,v+=h,u%n===0&&this._update(a)}return this._len+=c,this},e.prototype.digest=function(r){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var a=this._len*8;if(a<=4294967295)this._block.writeUInt32BE(a,this._blockSize-4);else{var n=(a&4294967295)>>>0,c=(a-n)/4294967296;this._block.writeUInt32BE(c,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var u=this._hash();return r?u.toString(r):u},e.prototype._update=function(){throw new Error("_update must be implemented by subclass")},Fc=e,Fc}var qc,Qp;function l8(){if(Qp)return qc;Qp=1;var i=De(),e=Bs(),r=er().Buffer,t=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function n(){this.init(),this._w=a,e.call(this,64,56)}i(n,e),n.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function c(o){return o<<5|o>>>27}function u(o){return o<<30|o>>>2}function v(o,h,g,y){return o===0?h&g|~h&y:o===2?h&g|h&y|g&y:h^g^y}return n.prototype._update=function(o){for(var h=this._w,g=this._a|0,y=this._b|0,_=this._c|0,A=this._d|0,S=this._e|0,T=0;T<16;++T)h[T]=o.readInt32BE(T*4);for(;T<80;++T)h[T]=h[T-3]^h[T-8]^h[T-14]^h[T-16];for(var B=0;B<80;++B){var M=~~(B/20),R=c(g)+v(M,y,_,A)+S+h[B]+t[M]|0;S=A,A=_,_=u(y),y=g,g=R}this._a=g+this._a|0,this._b=y+this._b|0,this._c=_+this._c|0,this._d=A+this._d|0,this._e=S+this._e|0},n.prototype._hash=function(){var o=r.allocUnsafe(20);return o.writeInt32BE(this._a|0,0),o.writeInt32BE(this._b|0,4),o.writeInt32BE(this._c|0,8),o.writeInt32BE(this._d|0,12),o.writeInt32BE(this._e|0,16),o},qc=n,qc}var zc,$p;function c8(){if($p)return zc;$p=1;var i=De(),e=Bs(),r=er().Buffer,t=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function n(){this.init(),this._w=a,e.call(this,64,56)}i(n,e),n.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function c(h){return h<<1|h>>>31}function u(h){return h<<5|h>>>27}function v(h){return h<<30|h>>>2}function o(h,g,y,_){return h===0?g&y|~g&_:h===2?g&y|g&_|y&_:g^y^_}return n.prototype._update=function(h){for(var g=this._w,y=this._a|0,_=this._b|0,A=this._c|0,S=this._d|0,T=this._e|0,B=0;B<16;++B)g[B]=h.readInt32BE(B*4);for(;B<80;++B)g[B]=c(g[B-3]^g[B-8]^g[B-14]^g[B-16]);for(var M=0;M<80;++M){var R=~~(M/20),P=u(y)+o(R,_,A,S)+T+g[M]+t[R]|0;T=S,S=A,A=v(_),_=y,y=P}this._a=y+this._a|0,this._b=_+this._b|0,this._c=A+this._c|0,this._d=S+this._d|0,this._e=T+this._e|0},n.prototype._hash=function(){var h=r.allocUnsafe(20);return h.writeInt32BE(this._a|0,0),h.writeInt32BE(this._b|0,4),h.writeInt32BE(this._c|0,8),h.writeInt32BE(this._d|0,12),h.writeInt32BE(this._e|0,16),h},zc=n,zc}var Vc,Zp;function yy(){if(Zp)return Vc;Zp=1;var i=De(),e=Bs(),r=er().Buffer,t=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function n(){this.init(),this._w=a,e.call(this,64,56)}i(n,e),n.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function c(y,_,A){return A^y&(_^A)}function u(y,_,A){return y&_|A&(y|_)}function v(y){return(y>>>2|y<<30)^(y>>>13|y<<19)^(y>>>22|y<<10)}function o(y){return(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7)}function h(y){return(y>>>7|y<<25)^(y>>>18|y<<14)^y>>>3}function g(y){return(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10}return n.prototype._update=function(y){for(var _=this._w,A=this._a|0,S=this._b|0,T=this._c|0,B=this._d|0,M=this._e|0,R=this._f|0,P=this._g|0,D=this._h|0,q=0;q<16;++q)_[q]=y.readInt32BE(q*4);for(;q<64;++q)_[q]=g(_[q-2])+_[q-7]+h(_[q-15])+_[q-16]|0;for(var k=0;k<64;++k){var U=D+o(M)+c(M,R,P)+t[k]+_[k]|0,O=v(A)+u(A,S,T)|0;D=P,P=R,R=M,M=B+U|0,B=T,T=S,S=A,A=U+O|0}this._a=A+this._a|0,this._b=S+this._b|0,this._c=T+this._c|0,this._d=B+this._d|0,this._e=M+this._e|0,this._f=R+this._f|0,this._g=P+this._g|0,this._h=D+this._h|0},n.prototype._hash=function(){var y=r.allocUnsafe(32);return y.writeInt32BE(this._a,0),y.writeInt32BE(this._b,4),y.writeInt32BE(this._c,8),y.writeInt32BE(this._d,12),y.writeInt32BE(this._e,16),y.writeInt32BE(this._f,20),y.writeInt32BE(this._g,24),y.writeInt32BE(this._h,28),y},Vc=n,Vc}var Gc,jp;function u8(){if(jp)return Gc;jp=1;var i=De(),e=yy(),r=Bs(),t=er().Buffer,a=new Array(64);function n(){this.init(),this._w=a,r.call(this,64,56)}return i(n,e),n.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},n.prototype._hash=function(){var c=t.allocUnsafe(28);return c.writeInt32BE(this._a,0),c.writeInt32BE(this._b,4),c.writeInt32BE(this._c,8),c.writeInt32BE(this._d,12),c.writeInt32BE(this._e,16),c.writeInt32BE(this._f,20),c.writeInt32BE(this._g,24),c},Gc=n,Gc}var Kc,Wp;function by(){if(Wp)return Kc;Wp=1;var i=De(),e=Bs(),r=er().Buffer,t=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function n(){this.init(),this._w=a,e.call(this,128,112)}i(n,e),n.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function c(S,T,B){return B^S&(T^B)}function u(S,T,B){return S&T|B&(S|T)}function v(S,T){return(S>>>28|T<<4)^(T>>>2|S<<30)^(T>>>7|S<<25)}function o(S,T){return(S>>>14|T<<18)^(S>>>18|T<<14)^(T>>>9|S<<23)}function h(S,T){return(S>>>1|T<<31)^(S>>>8|T<<24)^S>>>7}function g(S,T){return(S>>>1|T<<31)^(S>>>8|T<<24)^(S>>>7|T<<25)}function y(S,T){return(S>>>19|T<<13)^(T>>>29|S<<3)^S>>>6}function _(S,T){return(S>>>19|T<<13)^(T>>>29|S<<3)^(S>>>6|T<<26)}function A(S,T){return S>>>0<T>>>0?1:0}return n.prototype._update=function(S){for(var T=this._w,B=this._ah|0,M=this._bh|0,R=this._ch|0,P=this._dh|0,D=this._eh|0,q=this._fh|0,k=this._gh|0,U=this._hh|0,O=this._al|0,G=this._bl|0,E=this._cl|0,s=this._dl|0,l=this._el|0,d=this._fl|0,p=this._gl|0,m=this._hl|0,w=0;w<32;w+=2)T[w]=S.readInt32BE(w*4),T[w+1]=S.readInt32BE(w*4+4);for(;w<160;w+=2){var x=T[w-30],b=T[w-15*2+1],f=h(x,b),C=g(b,x);x=T[w-2*2],b=T[w-2*2+1];var F=y(x,b),z=_(b,x),W=T[w-7*2],$=T[w-7*2+1],I=T[w-16*2],K=T[w-16*2+1],N=C+$|0,X=f+W+A(N,C)|0;N=N+z|0,X=X+F+A(N,z)|0,N=N+K|0,X=X+I+A(N,K)|0,T[w]=X,T[w+1]=N}for(var Q=0;Q<160;Q+=2){X=T[Q],N=T[Q+1];var L=u(B,M,R),V=u(O,G,E),Z=v(B,O),H=v(O,B),j=o(D,l),et=o(l,D),nt=t[Q],st=t[Q+1],ft=c(D,q,k),vt=c(l,d,p),ot=m+et|0,pt=U+j+A(ot,m)|0;ot=ot+vt|0,pt=pt+ft+A(ot,vt)|0,ot=ot+st|0,pt=pt+nt+A(ot,st)|0,ot=ot+N|0,pt=pt+X+A(ot,N)|0;var Ut=H+V|0,At=Z+L+A(Ut,H)|0;U=k,m=p,k=q,p=d,q=D,d=l,l=s+ot|0,D=P+pt+A(l,s)|0,P=R,s=E,R=M,E=G,M=B,G=O,O=ot+Ut|0,B=pt+At+A(O,ot)|0}this._al=this._al+O|0,this._bl=this._bl+G|0,this._cl=this._cl+E|0,this._dl=this._dl+s|0,this._el=this._el+l|0,this._fl=this._fl+d|0,this._gl=this._gl+p|0,this._hl=this._hl+m|0,this._ah=this._ah+B+A(this._al,O)|0,this._bh=this._bh+M+A(this._bl,G)|0,this._ch=this._ch+R+A(this._cl,E)|0,this._dh=this._dh+P+A(this._dl,s)|0,this._eh=this._eh+D+A(this._el,l)|0,this._fh=this._fh+q+A(this._fl,d)|0,this._gh=this._gh+k+A(this._gl,p)|0,this._hh=this._hh+U+A(this._hl,m)|0},n.prototype._hash=function(){var S=r.allocUnsafe(64);function T(B,M,R){S.writeInt32BE(B,R),S.writeInt32BE(M,R+4)}return T(this._ah,this._al,0),T(this._bh,this._bl,8),T(this._ch,this._cl,16),T(this._dh,this._dl,24),T(this._eh,this._el,32),T(this._fh,this._fl,40),T(this._gh,this._gl,48),T(this._hh,this._hl,56),S},Kc=n,Kc}var Hc,Yp;function h8(){if(Yp)return Hc;Yp=1;var i=De(),e=by(),r=Bs(),t=er().Buffer,a=new Array(160);function n(){this.init(),this._w=a,r.call(this,128,112)}return i(n,e),n.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},n.prototype._hash=function(){var c=t.allocUnsafe(48);function u(v,o,h){c.writeInt32BE(v,h),c.writeInt32BE(o,h+4)}return u(this._ah,this._al,0),u(this._bh,this._bl,8),u(this._ch,this._cl,16),u(this._dh,this._dl,24),u(this._eh,this._el,32),u(this._fh,this._fl,40),c},Hc=n,Hc}var Xp;function a1(){if(Xp)return Oc.exports;Xp=1;var i=Oc.exports=function(r){r=r.toLowerCase();var t=i[r];if(!t)throw new Error(r+" is not supported (we accept pull requests)");return new t};return i.sha=l8(),i.sha1=c8(),i.sha224=u8(),i.sha256=yy(),i.sha384=h8(),i.sha512=by(),Oc.exports}var Qc,Jp;function ya(){if(Jp)return Qc;Jp=1;var i=er().Buffer,e=gy().Transform,r=jh().StringDecoder,t=De();function a(v){e.call(this),this.hashMode=typeof v=="string",this.hashMode?this[v]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}t(a,e);var n=typeof Uint8Array<"u",c=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&ArrayBuffer.isView&&(i.prototype instanceof Uint8Array||i.TYPED_ARRAY_SUPPORT);function u(v,o){if(v instanceof i)return v;if(typeof v=="string")return i.from(v,o);if(c&&ArrayBuffer.isView(v)){if(v.byteLength===0)return i.alloc(0);var h=i.from(v.buffer,v.byteOffset,v.byteLength);if(h.byteLength===v.byteLength)return h}if(n&&v instanceof Uint8Array||i.isBuffer(v)&&v.constructor&&typeof v.constructor.isBuffer=="function"&&v.constructor.isBuffer(v))return i.from(v);throw new TypeError('The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView.')}return a.prototype.update=function(v,o,h){var g=u(v,o),y=this._update(g);return this.hashMode?this:(h&&(y=this._toString(y,h)),y)},a.prototype.setAutoPadding=function(){},a.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},a.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},a.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},a.prototype._transform=function(v,o,h){var g;try{this.hashMode?this._update(v):this.push(this._update(v))}catch(y){g=y}finally{h(g)}},a.prototype._flush=function(v){var o;try{this.push(this.__final())}catch(h){o=h}v(o)},a.prototype._finalOrDigest=function(v){var o=this.__final()||i.alloc(0);return v&&(o=this._toString(o,v,!0)),o},a.prototype._toString=function(v,o,h){if(this._decoder||(this._decoder=new r(o),this._encoding=o),this._encoding!==o)throw new Error("cant switch encodings");var g=this._decoder.write(v);return h&&(g+=this._decoder.end()),g},Qc=a,Qc}var $c,t2;function Fo(){if(t2)return $c;t2=1;var i=De(),e=i1(),r=n1(),t=a1(),a=ya();function n(c){a.call(this,"digest"),this._hash=c}return i(n,a),n.prototype._update=function(c){this._hash.update(c)},n.prototype._final=function(){return this._hash.digest()},$c=function(u){return u=u.toLowerCase(),u==="md5"?new e:u==="rmd160"||u==="ripemd160"?new r:new n(t(u))},$c}var Zc,e2;function d8(){if(e2)return Zc;e2=1;var i=De(),e=er().Buffer,r=ya(),t=e.alloc(128),a=64;function n(c,u){r.call(this,"digest"),typeof u=="string"&&(u=e.from(u)),this._alg=c,this._key=u,u.length>a?u=c(u):u.length<a&&(u=e.concat([u,t],a));for(var v=this._ipad=e.allocUnsafe(a),o=this._opad=e.allocUnsafe(a),h=0;h<a;h++)v[h]=u[h]^54,o[h]=u[h]^92;this._hash=[v]}return i(n,r),n.prototype._update=function(c){this._hash.push(c)},n.prototype._final=function(){var c=this._alg(e.concat(this._hash));return this._alg(e.concat([this._opad,c]))},Zc=n,Zc}var jc,r2;function _y(){if(r2)return jc;r2=1;var i=i1();return jc=function(e){return new i().update(e).digest()},jc}var Wc,i2;function wy(){if(i2)return Wc;i2=1;var i=De(),e=d8(),r=ya(),t=er().Buffer,a=_y(),n=n1(),c=a1(),u=t.alloc(128);function v(o,h){r.call(this,"digest"),typeof h=="string"&&(h=t.from(h));var g=o==="sha512"||o==="sha384"?128:64;if(this._alg=o,this._key=h,h.length>g){var y=o==="rmd160"?new n:c(o);h=y.update(h).digest()}else h.length<g&&(h=t.concat([h,u],g));for(var _=this._ipad=t.allocUnsafe(g),A=this._opad=t.allocUnsafe(g),S=0;S<g;S++)_[S]=h[S]^54,A[S]=h[S]^92;this._hash=o==="rmd160"?new n:c(o),this._hash.update(_)}return i(v,r),v.prototype._update=function(o){this._hash.update(o)},v.prototype._final=function(){var o=this._hash.digest(),h=this._alg==="rmd160"?new n:c(this._alg);return h.update(this._opad).update(o).digest()},Wc=function(h,g){return h=h.toLowerCase(),h==="rmd160"||h==="ripemd160"?new v("rmd160",g):h==="md5"?new e(a,g):new v(h,g)},Wc}const p8={sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},v8={sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},g8={sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},m8={sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},y8={sign:"ecdsa",hash:"sha256",id:""},b8={sign:"ecdsa",hash:"sha224",id:""},_8={sign:"ecdsa",hash:"sha384",id:""},w8={sign:"ecdsa",hash:"sha512",id:""},C8={sign:"dsa",hash:"sha1",id:""},E8={sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},A8={sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},Cy={sha224WithRSAEncryption:p8,"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:v8,"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:g8,"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:m8,"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:y8,sha224:b8,sha384:_8,sha512:w8,"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:C8,"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:E8,"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:A8,"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}};var Yc,n2;function S8(){return n2||(n2=1,Yc=Cy),Yc}var vf={},Xc,a2;function Ey(){if(a2)return Xc;a2=1;var i=Math.pow(2,30)-1;return Xc=function(e,r){if(typeof e!="number")throw new TypeError("Iterations not a number");if(e<0)throw new TypeError("Bad iterations");if(typeof r!="number")throw new TypeError("Key length not a number");if(r<0||r>i||r!==r)throw new TypeError("Bad key length")},Xc}var Jc,s2;function Ay(){if(s2)return Jc;s2=1;var i;if(globalThis.process&&globalThis.process.browser)i="utf-8";else if(globalThis.process&&globalThis.process.version){var e=parseInt(process.version.split(".")[0].slice(1),10);i=e>=6?"utf-8":"binary"}else i="utf-8";return Jc=i,Jc}var tu,o2;function Sy(){if(o2)return tu;o2=1;var i=er().Buffer;return tu=function(e,r,t){if(i.isBuffer(e))return e;if(typeof e=="string")return i.from(e,r);if(ArrayBuffer.isView(e))return i.from(e.buffer);throw new TypeError(t+" must be a string, a Buffer, a typed array or a DataView")},tu}var eu,f2;function xy(){if(f2)return eu;f2=1;var i=_y(),e=n1(),r=a1(),t=er().Buffer,a=Ey(),n=Ay(),c=Sy(),u=t.alloc(128),v={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function o(y,_,A){var S=h(y),T=y==="sha512"||y==="sha384"?128:64;_.length>T?_=S(_):_.length<T&&(_=t.concat([_,u],T));for(var B=t.allocUnsafe(T+v[y]),M=t.allocUnsafe(T+v[y]),R=0;R<T;R++)B[R]=_[R]^54,M[R]=_[R]^92;var P=t.allocUnsafe(T+A+4);B.copy(P,0,0,T),this.ipad1=P,this.ipad2=B,this.opad=M,this.alg=y,this.blocksize=T,this.hash=S,this.size=v[y]}o.prototype.run=function(y,_){y.copy(_,this.blocksize);var A=this.hash(_);return A.copy(this.opad,this.blocksize),this.hash(this.opad)};function h(y){function _(S){return r(y).update(S).digest()}function A(S){return new e().update(S).digest()}return y==="rmd160"||y==="ripemd160"?A:y==="md5"?i:_}function g(y,_,A,S,T){a(A,S),y=c(y,n,"Password"),_=c(_,n,"Salt"),T=T||"sha1";var B=new o(T,y,_.length),M=t.allocUnsafe(S),R=t.allocUnsafe(_.length+4);_.copy(R,0,0,_.length);for(var P=0,D=v[T],q=Math.ceil(S/D),k=1;k<=q;k++){R.writeUInt32BE(k,_.length);for(var U=B.run(R,B.ipad1),O=U,G=1;G<A;G++){O=B.run(O,B.ipad2);for(var E=0;E<D;E++)U[E]^=O[E]}U.copy(M,P),P+=D}return M}return eu=g,eu}var ru,l2;function x8(){if(l2)return ru;l2=1;var i=er().Buffer,e=Ey(),r=Ay(),t=xy(),a=Sy(),n,c=globalThis.crypto&&globalThis.crypto.subtle,u={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},v=[];function o(A){if(globalThis.process&&!globalThis.process.browser||!c||!c.importKey||!c.deriveBits)return Promise.resolve(!1);if(v[A]!==void 0)return v[A];n=n||i.alloc(8);var S=y(n,n,10,128,A).then(function(){return!0}).catch(function(){return!1});return v[A]=S,S}var h;function g(){return h||(globalThis.process&&globalThis.process.nextTick?h=globalThis.process.nextTick:globalThis.queueMicrotask?h=globalThis.queueMicrotask:globalThis.setImmediate?h=globalThis.setImmediate:h=globalThis.setTimeout,h)}function y(A,S,T,B,M){return c.importKey("raw",A,{name:"PBKDF2"},!1,["deriveBits"]).then(function(R){return c.deriveBits({name:"PBKDF2",salt:S,iterations:T,hash:{name:M}},R,B<<3)}).then(function(R){return i.from(R)})}function _(A,S){A.then(function(T){g()(function(){S(null,T)})},function(T){g()(function(){S(T)})})}return ru=function(A,S,T,B,M,R){typeof M=="function"&&(R=M,M=void 0),M=M||"sha1";var P=u[M.toLowerCase()];if(!P||typeof globalThis.Promise!="function"){g()(function(){var D;try{D=t(A,S,T,B,M)}catch(q){return R(q)}R(null,D)});return}if(e(T,B),A=a(A,r,"Password"),S=a(S,r,"Salt"),typeof R!="function")throw new Error("No callback provided to pbkdf2");_(o(P).then(function(D){return D?y(A,S,T,B,P):t(A,S,T,B,M)}),R)},ru}var c2;function Iy(){return c2||(c2=1,vf.pbkdf2=x8(),vf.pbkdf2Sync=xy()),vf}var Pi={},Aa={},xi={},u2;function My(){if(u2)return xi;u2=1,xi.readUInt32BE=function(a,n){var c=a[0+n]<<24|a[1+n]<<16|a[2+n]<<8|a[3+n];return c>>>0},xi.writeUInt32BE=function(a,n,c){a[0+c]=n>>>24,a[1+c]=n>>>16&255,a[2+c]=n>>>8&255,a[3+c]=n&255},xi.ip=function(a,n,c,u){for(var v=0,o=0,h=6;h>=0;h-=2){for(var g=0;g<=24;g+=8)v<<=1,v|=n>>>g+h&1;for(var g=0;g<=24;g+=8)v<<=1,v|=a>>>g+h&1}for(var h=6;h>=0;h-=2){for(var g=1;g<=25;g+=8)o<<=1,o|=n>>>g+h&1;for(var g=1;g<=25;g+=8)o<<=1,o|=a>>>g+h&1}c[u+0]=v>>>0,c[u+1]=o>>>0},xi.rip=function(a,n,c,u){for(var v=0,o=0,h=0;h<4;h++)for(var g=24;g>=0;g-=8)v<<=1,v|=n>>>g+h&1,v<<=1,v|=a>>>g+h&1;for(var h=4;h<8;h++)for(var g=24;g>=0;g-=8)o<<=1,o|=n>>>g+h&1,o<<=1,o|=a>>>g+h&1;c[u+0]=v>>>0,c[u+1]=o>>>0},xi.pc1=function(a,n,c,u){for(var v=0,o=0,h=7;h>=5;h--){for(var g=0;g<=24;g+=8)v<<=1,v|=n>>g+h&1;for(var g=0;g<=24;g+=8)v<<=1,v|=a>>g+h&1}for(var g=0;g<=24;g+=8)v<<=1,v|=n>>g+h&1;for(var h=1;h<=3;h++){for(var g=0;g<=24;g+=8)o<<=1,o|=n>>g+h&1;for(var g=0;g<=24;g+=8)o<<=1,o|=a>>g+h&1}for(var g=0;g<=24;g+=8)o<<=1,o|=a>>g+h&1;c[u+0]=v>>>0,c[u+1]=o>>>0},xi.r28shl=function(a,n){return a<<n&268435455|a>>>28-n};var i=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];xi.pc2=function(a,n,c,u){for(var v=0,o=0,h=i.length>>>1,g=0;g<h;g++)v<<=1,v|=a>>>i[g]&1;for(var g=h;g<i.length;g++)o<<=1,o|=n>>>i[g]&1;c[u+0]=v>>>0,c[u+1]=o>>>0},xi.expand=function(a,n,c){var u=0,v=0;u=(a&1)<<5|a>>>27;for(var o=23;o>=15;o-=4)u<<=6,u|=a>>>o&63;for(var o=11;o>=3;o-=4)v|=a>>>o&63,v<<=6;v|=(a&31)<<1|a>>>31,n[c+0]=u>>>0,n[c+1]=v>>>0};var e=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];xi.substitute=function(a,n){for(var c=0,u=0;u<4;u++){var v=a>>>18-u*6&63,o=e[u*64+v];c<<=4,c|=o}for(var u=0;u<4;u++){var v=n>>>18-u*6&63,o=e[4*64+u*64+v];c<<=4,c|=o}return c>>>0};var r=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];return xi.permute=function(a){for(var n=0,c=0;c<r.length;c++)n<<=1,n|=a>>>r[c]&1;return n>>>0},xi.padSplit=function(a,n,c){for(var u=a.toString(2);u.length<n;)u="0"+u;for(var v=[],o=0;o<n;o+=c)v.push(u.slice(o,o+c));return v.join(" ")},xi}var iu,h2;function ki(){if(h2)return iu;h2=1,iu=i;function i(e,r){if(!e)throw new Error(r||"Assertion failed")}return i.equal=function(r,t,a){if(r!=t)throw new Error(a||"Assertion failed: "+r+" != "+t)},iu}var nu,d2;function s1(){if(d2)return nu;d2=1;var i=ki();function e(r){this.options=r,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=r.padding!==!1}return nu=e,e.prototype._init=function(){},e.prototype.update=function(t){return t.length===0?[]:this.type==="decrypt"?this._updateDecrypt(t):this._updateEncrypt(t)},e.prototype._buffer=function(t,a){for(var n=Math.min(this.buffer.length-this.bufferOff,t.length-a),c=0;c<n;c++)this.buffer[this.bufferOff+c]=t[a+c];return this.bufferOff+=n,n},e.prototype._flushBuffer=function(t,a){return this._update(this.buffer,0,t,a),this.bufferOff=0,this.blockSize},e.prototype._updateEncrypt=function(t){var a=0,n=0,c=(this.bufferOff+t.length)/this.blockSize|0,u=new Array(c*this.blockSize);this.bufferOff!==0&&(a+=this._buffer(t,a),this.bufferOff===this.buffer.length&&(n+=this._flushBuffer(u,n)));for(var v=t.length-(t.length-a)%this.blockSize;a<v;a+=this.blockSize)this._update(t,a,u,n),n+=this.blockSize;for(;a<t.length;a++,this.bufferOff++)this.buffer[this.bufferOff]=t[a];return u},e.prototype._updateDecrypt=function(t){for(var a=0,n=0,c=Math.ceil((this.bufferOff+t.length)/this.blockSize)-1,u=new Array(c*this.blockSize);c>0;c--)a+=this._buffer(t,a),n+=this._flushBuffer(u,n);return a+=this._buffer(t,a),u},e.prototype.final=function(t){var a;t&&(a=this.update(t));var n;return this.type==="encrypt"?n=this._finalEncrypt():n=this._finalDecrypt(),a?a.concat(n):n},e.prototype._pad=function(t,a){if(a===0)return!1;for(;a<t.length;)t[a++]=0;return!0},e.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var t=new Array(this.blockSize);return this._update(this.buffer,0,t,0),t},e.prototype._unpad=function(t){return t},e.prototype._finalDecrypt=function(){i.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var t=new Array(this.blockSize);return this._flushBuffer(t,0),this._unpad(t)},nu}var au,p2;function By(){if(p2)return au;p2=1;var i=ki(),e=De(),r=My(),t=s1();function a(){this.tmp=new Array(2),this.keys=null}function n(u){t.call(this,u);var v=new a;this._desState=v,this.deriveKeys(v,u.key)}e(n,t),au=n,n.create=function(v){return new n(v)};var c=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];return n.prototype.deriveKeys=function(v,o){v.keys=new Array(16*2),i.equal(o.length,this.blockSize,"Invalid key length");var h=r.readUInt32BE(o,0),g=r.readUInt32BE(o,4);r.pc1(h,g,v.tmp,0),h=v.tmp[0],g=v.tmp[1];for(var y=0;y<v.keys.length;y+=2){var _=c[y>>>1];h=r.r28shl(h,_),g=r.r28shl(g,_),r.pc2(h,g,v.keys,y)}},n.prototype._update=function(v,o,h,g){var y=this._desState,_=r.readUInt32BE(v,o),A=r.readUInt32BE(v,o+4);r.ip(_,A,y.tmp,0),_=y.tmp[0],A=y.tmp[1],this.type==="encrypt"?this._encrypt(y,_,A,y.tmp,0):this._decrypt(y,_,A,y.tmp,0),_=y.tmp[0],A=y.tmp[1],r.writeUInt32BE(h,_,g),r.writeUInt32BE(h,A,g+4)},n.prototype._pad=function(v,o){if(this.padding===!1)return!1;for(var h=v.length-o,g=o;g<v.length;g++)v[g]=h;return!0},n.prototype._unpad=function(v){if(this.padding===!1)return v;for(var o=v[v.length-1],h=v.length-o;h<v.length;h++)i.equal(v[h],o);return v.slice(0,v.length-o)},n.prototype._encrypt=function(v,o,h,g,y){for(var _=o,A=h,S=0;S<v.keys.length;S+=2){var T=v.keys[S],B=v.keys[S+1];r.expand(A,v.tmp,0),T^=v.tmp[0],B^=v.tmp[1];var M=r.substitute(T,B),R=r.permute(M),P=A;A=(_^R)>>>0,_=P}r.rip(A,_,g,y)},n.prototype._decrypt=function(v,o,h,g,y){for(var _=h,A=o,S=v.keys.length-2;S>=0;S-=2){var T=v.keys[S],B=v.keys[S+1];r.expand(_,v.tmp,0),T^=v.tmp[0],B^=v.tmp[1];var M=r.substitute(T,B),R=r.permute(M),P=_;_=(A^R)>>>0,A=P}r.rip(_,A,g,y)},au}var su={},v2;function I8(){if(v2)return su;v2=1;var i=ki(),e=De(),r={};function t(n){i.equal(n.length,8,"Invalid IV length"),this.iv=new Array(8);for(var c=0;c<this.iv.length;c++)this.iv[c]=n[c]}function a(n){function c(h){n.call(this,h),this._cbcInit()}e(c,n);for(var u=Object.keys(r),v=0;v<u.length;v++){var o=u[v];c.prototype[o]=r[o]}return c.create=function(g){return new c(g)},c}return su.instantiate=a,r._cbcInit=function(){var c=new t(this.options.iv);this._cbcState=c},r._update=function(c,u,v,o){var h=this._cbcState,g=this.constructor.super_.prototype,y=h.iv;if(this.type==="encrypt"){for(var _=0;_<this.blockSize;_++)y[_]^=c[u+_];g._update.call(this,y,0,v,o);for(var _=0;_<this.blockSize;_++)y[_]=v[o+_]}else{g._update.call(this,c,u,v,o);for(var _=0;_<this.blockSize;_++)v[o+_]^=y[_];for(var _=0;_<this.blockSize;_++)y[_]=c[u+_]}},su}var ou,g2;function M8(){if(g2)return ou;g2=1;var i=ki(),e=De(),r=s1(),t=By();function a(c,u){i.equal(u.length,24,"Invalid key length");var v=u.slice(0,8),o=u.slice(8,16),h=u.slice(16,24);c==="encrypt"?this.ciphers=[t.create({type:"encrypt",key:v}),t.create({type:"decrypt",key:o}),t.create({type:"encrypt",key:h})]:this.ciphers=[t.create({type:"decrypt",key:h}),t.create({type:"encrypt",key:o}),t.create({type:"decrypt",key:v})]}function n(c){r.call(this,c);var u=new a(this.type,this.options.key);this._edeState=u}return e(n,r),ou=n,n.create=function(u){return new n(u)},n.prototype._update=function(u,v,o,h){var g=this._edeState;g.ciphers[0]._update(u,v,o,h),g.ciphers[1]._update(o,h,o,h),g.ciphers[2]._update(o,h,o,h)},n.prototype._pad=t.prototype._pad,n.prototype._unpad=t.prototype._unpad,ou}var m2;function B8(){return m2||(m2=1,Aa.utils=My(),Aa.Cipher=s1(),Aa.DES=By(),Aa.CBC=I8(),Aa.EDE=M8()),Aa}var fu,y2;function L8(){if(y2)return fu;y2=1;var i=ya(),e=B8(),r=De(),t=er().Buffer,a={"des-ede3-cbc":e.CBC.instantiate(e.EDE),"des-ede3":e.EDE,"des-ede-cbc":e.CBC.instantiate(e.EDE),"des-ede":e.EDE,"des-cbc":e.CBC.instantiate(e.DES),"des-ecb":e.DES};a.des=a["des-cbc"],a.des3=a["des-ede3-cbc"],fu=n,r(n,i);function n(c){i.call(this);var u=c.mode.toLowerCase(),v=a[u],o;c.decrypt?o="decrypt":o="encrypt";var h=c.key;t.isBuffer(h)||(h=t.from(h)),(u==="des-ede"||u==="des-ede-cbc")&&(h=t.concat([h,h.slice(0,8)]));var g=c.iv;t.isBuffer(g)||(g=t.from(g)),this._des=v.create({key:h,iv:g,type:o})}return n.prototype._update=function(c){return t.from(this._des.update(c))},n.prototype._final=function(){return t.from(this._des.final())},fu}var Ui={},gf={},mf={},b2;function T8(){return b2||(b2=1,mf.encrypt=function(i,e){return i._cipher.encryptBlock(e)},mf.decrypt=function(i,e){return i._cipher.decryptBlock(e)}),mf}var yf={},lu,_2;function qo(){return _2||(_2=1,lu=function(e,r){for(var t=Math.min(e.length,r.length),a=new Buffer(t),n=0;n<t;++n)a[n]=e[n]^r[n];return a}),lu}var w2;function R8(){if(w2)return yf;w2=1;var i=qo();return yf.encrypt=function(e,r){var t=i(r,e._prev);return e._prev=e._cipher.encryptBlock(t),e._prev},yf.decrypt=function(e,r){var t=e._prev;e._prev=r;var a=e._cipher.decryptBlock(r);return i(a,t)},yf}var cu={},C2;function N8(){if(C2)return cu;C2=1;var i=er().Buffer,e=qo();function r(t,a,n){var c=a.length,u=e(a,t._cache);return t._cache=t._cache.slice(c),t._prev=i.concat([t._prev,n?a:u]),u}return cu.encrypt=function(t,a,n){for(var c=i.allocUnsafe(0),u;a.length;)if(t._cache.length===0&&(t._cache=t._cipher.encryptBlock(t._prev),t._prev=i.allocUnsafe(0)),t._cache.length<=a.length)u=t._cache.length,c=i.concat([c,r(t,a.slice(0,u),n)]),a=a.slice(u);else{c=i.concat([c,r(t,a,n)]);break}return c},cu}var uu={},E2;function k8(){if(E2)return uu;E2=1;var i=er().Buffer;function e(r,t,a){var n=r._cipher.encryptBlock(r._prev),c=n[0]^t;return r._prev=i.concat([r._prev.slice(1),i.from([a?t:c])]),c}return uu.encrypt=function(r,t,a){for(var n=t.length,c=i.allocUnsafe(n),u=-1;++u<n;)c[u]=e(r,t[u],a);return c},uu}var hu={},A2;function P8(){if(A2)return hu;A2=1;var i=er().Buffer;function e(t,a,n){for(var c,u=-1,v=8,o=0,h,g;++u<v;)c=t._cipher.encryptBlock(t._prev),h=a&1<<7-u?128:0,g=c[0]^h,o+=(g&128)>>u%8,t._prev=r(t._prev,n?h:g);return o}function r(t,a){var n=t.length,c=-1,u=i.allocUnsafe(t.length);for(t=i.concat([t,i.from([a])]);++c<n;)u[c]=t[c]<<1|t[c+1]>>7;return u}return hu.encrypt=function(t,a,n){for(var c=a.length,u=i.allocUnsafe(c),v=-1;++v<c;)u[v]=e(t,a[v],n);return u},hu}var du={},S2;function U8(){if(S2)return du;S2=1;var i=qo();function e(r){return r._prev=r._cipher.encryptBlock(r._prev),r._prev}return du.encrypt=function(r,t){for(;r._cache.length<t.length;)r._cache=Buffer.concat([r._cache,e(r)]);var a=r._cache.slice(0,t.length);return r._cache=r._cache.slice(t.length),i(t,a)},du}var pu={},vu,x2;function Ly(){if(x2)return vu;x2=1;function i(e){for(var r=e.length,t;r--;)if(t=e.readUInt8(r),t===255)e.writeUInt8(0,r);else{t++,e.writeUInt8(t,r);break}}return vu=i,vu}var I2;function M2(){if(I2)return pu;I2=1;var i=qo(),e=er().Buffer,r=Ly();function t(n){var c=n._cipher.encryptBlockRaw(n._prev);return r(n._prev),c}var a=16;return pu.encrypt=function(n,c){var u=Math.ceil(c.length/a),v=n._cache.length;n._cache=e.concat([n._cache,e.allocUnsafe(u*a)]);for(var o=0;o<u;o++){var h=t(n),g=v+o*a;n._cache.writeUInt32BE(h[0],g+0),n._cache.writeUInt32BE(h[1],g+4),n._cache.writeUInt32BE(h[2],g+8),n._cache.writeUInt32BE(h[3],g+12)}var y=n._cache.slice(0,c.length);return n._cache=n._cache.slice(c.length),i(c,y)},pu}const D8={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},O8={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},F8={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},Ty={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:D8,aes192:O8,aes256:F8,"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}};var gu,B2;function o1(){if(B2)return gu;B2=1;var i={ECB:T8(),CBC:R8(),CFB:N8(),CFB8:k8(),CFB1:P8(),OFB:U8(),CTR:M2(),GCM:M2()},e=Ty;for(var r in e)e[r].module=i[e[r].mode];return gu=e,gu}var mu={},L2;function Sl(){if(L2)return mu;L2=1;var i=er().Buffer;function e(u){i.isBuffer(u)||(u=i.from(u));for(var v=u.length/4|0,o=new Array(v),h=0;h<v;h++)o[h]=u.readUInt32BE(h*4);return o}function r(u){for(var v=0;v<u.length;u++)u[v]=0}function t(u,v,o,h,g){for(var y=o[0],_=o[1],A=o[2],S=o[3],T=u[0]^v[0],B=u[1]^v[1],M=u[2]^v[2],R=u[3]^v[3],P,D,q,k,U=4,O=1;O<g;O++)P=y[T>>>24]^_[B>>>16&255]^A[M>>>8&255]^S[R&255]^v[U++],D=y[B>>>24]^_[M>>>16&255]^A[R>>>8&255]^S[T&255]^v[U++],q=y[M>>>24]^_[R>>>16&255]^A[T>>>8&255]^S[B&255]^v[U++],k=y[R>>>24]^_[T>>>16&255]^A[B>>>8&255]^S[M&255]^v[U++],T=P,B=D,M=q,R=k;return P=(h[T>>>24]<<24|h[B>>>16&255]<<16|h[M>>>8&255]<<8|h[R&255])^v[U++],D=(h[B>>>24]<<24|h[M>>>16&255]<<16|h[R>>>8&255]<<8|h[T&255])^v[U++],q=(h[M>>>24]<<24|h[R>>>16&255]<<16|h[T>>>8&255]<<8|h[B&255])^v[U++],k=(h[R>>>24]<<24|h[T>>>16&255]<<16|h[B>>>8&255]<<8|h[M&255])^v[U++],P=P>>>0,D=D>>>0,q=q>>>0,k=k>>>0,[P,D,q,k]}var a=[0,1,2,4,8,16,32,64,128,27,54],n=function(){for(var u=new Array(256),v=0;v<256;v++)v<128?u[v]=v<<1:u[v]=v<<1^283;for(var o=[],h=[],g=[[],[],[],[]],y=[[],[],[],[]],_=0,A=0,S=0;S<256;++S){var T=A^A<<1^A<<2^A<<3^A<<4;T=T>>>8^T&255^99,o[_]=T,h[T]=_;var B=u[_],M=u[B],R=u[M],P=u[T]*257^T*16843008;g[0][_]=P<<24|P>>>8,g[1][_]=P<<16|P>>>16,g[2][_]=P<<8|P>>>24,g[3][_]=P,P=R*16843009^M*65537^B*257^_*16843008,y[0][T]=P<<24|P>>>8,y[1][T]=P<<16|P>>>16,y[2][T]=P<<8|P>>>24,y[3][T]=P,_===0?_=A=1:(_=B^u[u[u[R^B]]],A^=u[u[A]])}return{SBOX:o,INV_SBOX:h,SUB_MIX:g,INV_SUB_MIX:y}}();function c(u){this._key=e(u),this._reset()}return c.blockSize=4*4,c.keySize=256/8,c.prototype.blockSize=c.blockSize,c.prototype.keySize=c.keySize,c.prototype._reset=function(){for(var u=this._key,v=u.length,o=v+6,h=(o+1)*4,g=[],y=0;y<v;y++)g[y]=u[y];for(y=v;y<h;y++){var _=g[y-1];y%v===0?(_=_<<8|_>>>24,_=n.SBOX[_>>>24]<<24|n.SBOX[_>>>16&255]<<16|n.SBOX[_>>>8&255]<<8|n.SBOX[_&255],_^=a[y/v|0]<<24):v>6&&y%v===4&&(_=n.SBOX[_>>>24]<<24|n.SBOX[_>>>16&255]<<16|n.SBOX[_>>>8&255]<<8|n.SBOX[_&255]),g[y]=g[y-v]^_}for(var A=[],S=0;S<h;S++){var T=h-S,B=g[T-(S%4?0:4)];S<4||T<=4?A[S]=B:A[S]=n.INV_SUB_MIX[0][n.SBOX[B>>>24]]^n.INV_SUB_MIX[1][n.SBOX[B>>>16&255]]^n.INV_SUB_MIX[2][n.SBOX[B>>>8&255]]^n.INV_SUB_MIX[3][n.SBOX[B&255]]}this._nRounds=o,this._keySchedule=g,this._invKeySchedule=A},c.prototype.encryptBlockRaw=function(u){return u=e(u),t(u,this._keySchedule,n.SUB_MIX,n.SBOX,this._nRounds)},c.prototype.encryptBlock=function(u){var v=this.encryptBlockRaw(u),o=i.allocUnsafe(16);return o.writeUInt32BE(v[0],0),o.writeUInt32BE(v[1],4),o.writeUInt32BE(v[2],8),o.writeUInt32BE(v[3],12),o},c.prototype.decryptBlock=function(u){u=e(u);var v=u[1];u[1]=u[3],u[3]=v;var o=t(u,this._invKeySchedule,n.INV_SUB_MIX,n.INV_SBOX,this._nRounds),h=i.allocUnsafe(16);return h.writeUInt32BE(o[0],0),h.writeUInt32BE(o[3],4),h.writeUInt32BE(o[2],8),h.writeUInt32BE(o[1],12),h},c.prototype.scrub=function(){r(this._keySchedule),r(this._invKeySchedule),r(this._key)},mu.AES=c,mu}var yu,T2;function q8(){if(T2)return yu;T2=1;var i=er().Buffer,e=i.alloc(16,0);function r(n){return[n.readUInt32BE(0),n.readUInt32BE(4),n.readUInt32BE(8),n.readUInt32BE(12)]}function t(n){var c=i.allocUnsafe(16);return c.writeUInt32BE(n[0]>>>0,0),c.writeUInt32BE(n[1]>>>0,4),c.writeUInt32BE(n[2]>>>0,8),c.writeUInt32BE(n[3]>>>0,12),c}function a(n){this.h=n,this.state=i.alloc(16,0),this.cache=i.allocUnsafe(0)}return a.prototype.ghash=function(n){for(var c=-1;++c<n.length;)this.state[c]^=n[c];this._multiply()},a.prototype._multiply=function(){for(var n=r(this.h),c=[0,0,0,0],u,v,o,h=-1;++h<128;){for(v=(this.state[~~(h/8)]&1<<7-h%8)!==0,v&&(c[0]^=n[0],c[1]^=n[1],c[2]^=n[2],c[3]^=n[3]),o=(n[3]&1)!==0,u=3;u>0;u--)n[u]=n[u]>>>1|(n[u-1]&1)<<31;n[0]=n[0]>>>1,o&&(n[0]=n[0]^225<<24)}this.state=t(c)},a.prototype.update=function(n){this.cache=i.concat([this.cache,n]);for(var c;this.cache.length>=16;)c=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(c)},a.prototype.final=function(n,c){return this.cache.length&&this.ghash(i.concat([this.cache,e],16)),this.ghash(t([0,n,0,c])),this.state},yu=a,yu}var bu,R2;function Ry(){if(R2)return bu;R2=1;var i=Sl(),e=er().Buffer,r=ya(),t=De(),a=q8(),n=qo(),c=Ly();function u(h,g){var y=0;h.length!==g.length&&y++;for(var _=Math.min(h.length,g.length),A=0;A<_;++A)y+=h[A]^g[A];return y}function v(h,g,y){if(g.length===12)return h._finID=e.concat([g,e.from([0,0,0,1])]),e.concat([g,e.from([0,0,0,2])]);var _=new a(y),A=g.length,S=A%16;_.update(g),S&&(S=16-S,_.update(e.alloc(S,0))),_.update(e.alloc(8,0));var T=A*8,B=e.alloc(8);B.writeUIntBE(T,0,8),_.update(B),h._finID=_.state;var M=e.from(h._finID);return c(M),M}function o(h,g,y,_){r.call(this);var A=e.alloc(4,0);this._cipher=new i.AES(g);var S=this._cipher.encryptBlock(A);this._ghash=new a(S),y=v(this,y,S),this._prev=e.from(y),this._cache=e.allocUnsafe(0),this._secCache=e.allocUnsafe(0),this._decrypt=_,this._alen=0,this._len=0,this._mode=h,this._authTag=null,this._called=!1}return t(o,r),o.prototype._update=function(h){if(!this._called&&this._alen){var g=16-this._alen%16;g<16&&(g=e.alloc(g,0),this._ghash.update(g))}this._called=!0;var y=this._mode.encrypt(this,h);return this._decrypt?this._ghash.update(h):this._ghash.update(y),this._len+=h.length,y},o.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var h=n(this._ghash.final(this._alen*8,this._len*8),this._cipher.encryptBlock(this._finID));if(this._decrypt&&u(h,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=h,this._cipher.scrub()},o.prototype.getAuthTag=function(){if(this._decrypt||!e.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},o.prototype.setAuthTag=function(g){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=g},o.prototype.setAAD=function(g){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(g),this._alen+=g.length},bu=o,bu}var _u,N2;function Ny(){if(N2)return _u;N2=1;var i=Sl(),e=er().Buffer,r=ya(),t=De();function a(n,c,u,v){r.call(this),this._cipher=new i.AES(c),this._prev=e.from(u),this._cache=e.allocUnsafe(0),this._secCache=e.allocUnsafe(0),this._decrypt=v,this._mode=n}return t(a,r),a.prototype._update=function(n){return this._mode.encrypt(this,n,this._decrypt)},a.prototype._final=function(){this._cipher.scrub()},_u=a,_u}var wu,k2;function xl(){if(k2)return wu;k2=1;var i=er().Buffer,e=i1();function r(t,a,n,c){if(i.isBuffer(t)||(t=i.from(t,"binary")),a&&(i.isBuffer(a)||(a=i.from(a,"binary")),a.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var u=n/8,v=i.alloc(u),o=i.alloc(c||0),h=i.alloc(0);u>0||c>0;){var g=new e;g.update(h),g.update(t),a&&g.update(a),h=g.digest();var y=0;if(u>0){var _=v.length-u;y=Math.min(u,h.length),h.copy(v,_,0,y),u-=y}if(y<h.length&&c>0){var A=o.length-c,S=Math.min(c,h.length-y);h.copy(o,A,y,y+S),c-=S}}return h.fill(0),{key:v,iv:o}}return wu=r,wu}var P2;function z8(){if(P2)return gf;P2=1;var i=o1(),e=Ry(),r=er().Buffer,t=Ny(),a=ya(),n=Sl(),c=xl(),u=De();function v(_,A,S){a.call(this),this._cache=new h,this._cipher=new n.AES(A),this._prev=r.from(S),this._mode=_,this._autopadding=!0}u(v,a),v.prototype._update=function(_){this._cache.add(_);for(var A,S,T=[];A=this._cache.get();)S=this._mode.encrypt(this,A),T.push(S);return r.concat(T)};var o=r.alloc(16,16);v.prototype._final=function(){var _=this._cache.flush();if(this._autopadding)return _=this._mode.encrypt(this,_),this._cipher.scrub(),_;if(!_.equals(o))throw this._cipher.scrub(),new Error("data not multiple of block length")},v.prototype.setAutoPadding=function(_){return this._autopadding=!!_,this};function h(){this.cache=r.allocUnsafe(0)}h.prototype.add=function(_){this.cache=r.concat([this.cache,_])},h.prototype.get=function(){if(this.cache.length>15){var _=this.cache.slice(0,16);return this.cache=this.cache.slice(16),_}return null},h.prototype.flush=function(){for(var _=16-this.cache.length,A=r.allocUnsafe(_),S=-1;++S<_;)A.writeUInt8(_,S);return r.concat([this.cache,A])};function g(_,A,S){var T=i[_.toLowerCase()];if(!T)throw new TypeError("invalid suite type");if(typeof A=="string"&&(A=r.from(A)),A.length!==T.key/8)throw new TypeError("invalid key length "+A.length);if(typeof S=="string"&&(S=r.from(S)),T.mode!=="GCM"&&S.length!==T.iv)throw new TypeError("invalid iv length "+S.length);return T.type==="stream"?new t(T.module,A,S):T.type==="auth"?new e(T.module,A,S):new v(T.module,A,S)}function y(_,A){var S=i[_.toLowerCase()];if(!S)throw new TypeError("invalid suite type");var T=c(A,!1,S.key,S.iv);return g(_,T.key,T.iv)}return gf.createCipheriv=g,gf.createCipher=y,gf}var bf={},U2;function V8(){if(U2)return bf;U2=1;var i=Ry(),e=er().Buffer,r=o1(),t=Ny(),a=ya(),n=Sl(),c=xl(),u=De();function v(_,A,S){a.call(this),this._cache=new o,this._last=void 0,this._cipher=new n.AES(A),this._prev=e.from(S),this._mode=_,this._autopadding=!0}u(v,a),v.prototype._update=function(_){this._cache.add(_);for(var A,S,T=[];A=this._cache.get(this._autopadding);)S=this._mode.decrypt(this,A),T.push(S);return e.concat(T)},v.prototype._final=function(){var _=this._cache.flush();if(this._autopadding)return h(this._mode.decrypt(this,_));if(_)throw new Error("data not multiple of block length")},v.prototype.setAutoPadding=function(_){return this._autopadding=!!_,this};function o(){this.cache=e.allocUnsafe(0)}o.prototype.add=function(_){this.cache=e.concat([this.cache,_])},o.prototype.get=function(_){var A;if(_){if(this.cache.length>16)return A=this.cache.slice(0,16),this.cache=this.cache.slice(16),A}else if(this.cache.length>=16)return A=this.cache.slice(0,16),this.cache=this.cache.slice(16),A;return null},o.prototype.flush=function(){if(this.cache.length)return this.cache};function h(_){var A=_[15];if(A<1||A>16)throw new Error("unable to decrypt data");for(var S=-1;++S<A;)if(_[S+(16-A)]!==A)throw new Error("unable to decrypt data");if(A!==16)return _.slice(0,16-A)}function g(_,A,S){var T=r[_.toLowerCase()];if(!T)throw new TypeError("invalid suite type");if(typeof S=="string"&&(S=e.from(S)),T.mode!=="GCM"&&S.length!==T.iv)throw new TypeError("invalid iv length "+S.length);if(typeof A=="string"&&(A=e.from(A)),A.length!==T.key/8)throw new TypeError("invalid key length "+A.length);return T.type==="stream"?new t(T.module,A,S,!0):T.type==="auth"?new i(T.module,A,S,!0):new v(T.module,A,S)}function y(_,A){var S=r[_.toLowerCase()];if(!S)throw new TypeError("invalid suite type");var T=c(A,!1,S.key,S.iv);return g(_,T.key,T.iv)}return bf.createDecipher=y,bf.createDecipheriv=g,bf}var D2;function f1(){if(D2)return Ui;D2=1;var i=z8(),e=V8(),r=Ty;function t(){return Object.keys(r)}return Ui.createCipher=Ui.Cipher=i.createCipher,Ui.createCipheriv=Ui.Cipheriv=i.createCipheriv,Ui.createDecipher=Ui.Decipher=e.createDecipher,Ui.createDecipheriv=Ui.Decipheriv=e.createDecipheriv,Ui.listCiphers=Ui.getCiphers=t,Ui}var Cu={},O2;function G8(){return O2||(O2=1,function(i){i["des-ecb"]={key:8,iv:0},i["des-cbc"]=i.des={key:8,iv:8},i["des-ede3-cbc"]=i.des3={key:24,iv:8},i["des-ede3"]={key:24,iv:0},i["des-ede-cbc"]={key:16,iv:8},i["des-ede"]={key:16,iv:0}}(Cu)),Cu}var F2;function K8(){if(F2)return Pi;F2=1;var i=L8(),e=f1(),r=o1(),t=G8(),a=xl();function n(h,g){h=h.toLowerCase();var y,_;if(r[h])y=r[h].key,_=r[h].iv;else if(t[h])y=t[h].key*8,_=t[h].iv;else throw new TypeError("invalid suite type");var A=a(g,!1,y,_);return u(h,A.key,A.iv)}function c(h,g){h=h.toLowerCase();var y,_;if(r[h])y=r[h].key,_=r[h].iv;else if(t[h])y=t[h].key*8,_=t[h].iv;else throw new TypeError("invalid suite type");var A=a(g,!1,y,_);return v(h,A.key,A.iv)}function u(h,g,y){if(h=h.toLowerCase(),r[h])return e.createCipheriv(h,g,y);if(t[h])return new i({key:g,iv:y,mode:h});throw new TypeError("invalid suite type")}function v(h,g,y){if(h=h.toLowerCase(),r[h])return e.createDecipheriv(h,g,y);if(t[h])return new i({key:g,iv:y,mode:h,decrypt:!0});throw new TypeError("invalid suite type")}function o(){return Object.keys(t).concat(e.getCiphers())}return Pi.createCipher=Pi.Cipher=n,Pi.createCipheriv=Pi.Cipheriv=u,Pi.createDecipher=Pi.Decipher=c,Pi.createDecipheriv=Pi.Decipheriv=v,Pi.listCiphers=Pi.getCiphers=o,Pi}var Sa={},qf={exports:{}};qf.exports;var q2;function ky(){return q2||(q2=1,function(i){(function(e,r){function t(E,s){if(!E)throw new Error(s||"Assertion failed")}function a(E,s){E.super_=s;var l=function(){};l.prototype=s.prototype,E.prototype=new l,E.prototype.constructor=E}function n(E,s,l){if(n.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&((s==="le"||s==="be")&&(l=s,s=10),this._init(E||0,s||10,l||"be"))}typeof e=="object"?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=$i.Buffer}catch{}n.isBN=function(s){return s instanceof n?!0:s!==null&&typeof s=="object"&&s.constructor.wordSize===n.wordSize&&Array.isArray(s.words)},n.max=function(s,l){return s.cmp(l)>0?s:l},n.min=function(s,l){return s.cmp(l)<0?s:l},n.prototype._init=function(s,l,d){if(typeof s=="number")return this._initNumber(s,l,d);if(typeof s=="object")return this._initArray(s,l,d);l==="hex"&&(l=16),t(l===(l|0)&&l>=2&&l<=36),s=s.toString().replace(/\s+/g,"");var p=0;s[0]==="-"&&(p++,this.negative=1),p<s.length&&(l===16?this._parseHex(s,p,d):(this._parseBase(s,l,p),d==="le"&&this._initArray(this.toArray(),l,d)))},n.prototype._initNumber=function(s,l,d){s<0&&(this.negative=1,s=-s),s<67108864?(this.words=[s&67108863],this.length=1):s<4503599627370496?(this.words=[s&67108863,s/67108864&67108863],this.length=2):(t(s<9007199254740992),this.words=[s&67108863,s/67108864&67108863,1],this.length=3),d==="le"&&this._initArray(this.toArray(),l,d)},n.prototype._initArray=function(s,l,d){if(t(typeof s.length=="number"),s.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(s.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m,w,x=0;if(d==="be")for(p=s.length-1,m=0;p>=0;p-=3)w=s[p]|s[p-1]<<8|s[p-2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);else if(d==="le")for(p=0,m=0;p<s.length;p+=3)w=s[p]|s[p+1]<<8|s[p+2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);return this.strip()};function u(E,s){var l=E.charCodeAt(s);return l>=65&&l<=70?l-55:l>=97&&l<=102?l-87:l-48&15}function v(E,s,l){var d=u(E,l);return l-1>=s&&(d|=u(E,l-1)<<4),d}n.prototype._parseHex=function(s,l,d){this.length=Math.ceil((s.length-l)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m=0,w=0,x;if(d==="be")for(p=s.length-1;p>=l;p-=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8;else{var b=s.length-l;for(p=b%2===0?l+1:l;p<s.length;p+=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8}this.strip()};function o(E,s,l,d){for(var p=0,m=Math.min(E.length,l),w=s;w<m;w++){var x=E.charCodeAt(w)-48;p*=d,x>=49?p+=x-49+10:x>=17?p+=x-17+10:p+=x}return p}n.prototype._parseBase=function(s,l,d){this.words=[0],this.length=1;for(var p=0,m=1;m<=67108863;m*=l)p++;p--,m=m/l|0;for(var w=s.length-d,x=w%p,b=Math.min(w,w-x)+d,f=0,C=d;C<b;C+=p)f=o(s,C,C+p,l),this.imuln(m),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(x!==0){var F=1;for(f=o(s,C,s.length,l),C=0;C<x;C++)F*=l;this.imuln(F),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},n.prototype.copy=function(s){s.words=new Array(this.length);for(var l=0;l<this.length;l++)s.words[l]=this.words[l];s.length=this.length,s.negative=this.negative,s.red=this.red},n.prototype.clone=function(){var s=new n(null);return this.copy(s),s},n.prototype._expand=function(s){for(;this.length<s;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(s,l){s=s||10,l=l|0||1;var d;if(s===16||s==="hex"){d="";for(var p=0,m=0,w=0;w<this.length;w++){var x=this.words[w],b=((x<<p|m)&16777215).toString(16);m=x>>>24-p&16777215,p+=2,p>=26&&(p-=26,w--),m!==0||w!==this.length-1?d=h[6-b.length]+b+d:d=b+d}for(m!==0&&(d=m.toString(16)+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}if(s===(s|0)&&s>=2&&s<=36){var f=g[s],C=y[s];d="";var F=this.clone();for(F.negative=0;!F.isZero();){var z=F.modn(C).toString(s);F=F.idivn(C),F.isZero()?d=z+d:d=h[f-z.length]+z+d}for(this.isZero()&&(d="0"+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var s=this.words[0];return this.length===2?s+=this.words[1]*67108864:this.length===3&&this.words[2]===1?s+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-s:s},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(s,l){return t(typeof c<"u"),this.toArrayLike(c,s,l)},n.prototype.toArray=function(s,l){return this.toArrayLike(Array,s,l)},n.prototype.toArrayLike=function(s,l,d){var p=this.byteLength(),m=d||Math.max(1,p);t(p<=m,"byte array longer than desired length"),t(m>0,"Requested array length <= 0"),this.strip();var w=l==="le",x=new s(m),b,f,C=this.clone();if(w){for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[f]=b;for(;f<m;f++)x[f]=0}else{for(f=0;f<m-p;f++)x[f]=0;for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[m-f-1]=b}return x},Math.clz32?n.prototype._countBits=function(s){return 32-Math.clz32(s)}:n.prototype._countBits=function(s){var l=s,d=0;return l>=4096&&(d+=13,l>>>=13),l>=64&&(d+=7,l>>>=7),l>=8&&(d+=4,l>>>=4),l>=2&&(d+=2,l>>>=2),d+l},n.prototype._zeroBits=function(s){if(s===0)return 26;var l=s,d=0;return l&8191||(d+=13,l>>>=13),l&127||(d+=7,l>>>=7),l&15||(d+=4,l>>>=4),l&3||(d+=2,l>>>=2),l&1||d++,d},n.prototype.bitLength=function(){var s=this.words[this.length-1],l=this._countBits(s);return(this.length-1)*26+l};function _(E){for(var s=new Array(E.bitLength()),l=0;l<s.length;l++){var d=l/26|0,p=l%26;s[l]=(E.words[d]&1<<p)>>>p}return s}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var s=0,l=0;l<this.length;l++){var d=this._zeroBits(this.words[l]);if(s+=d,d!==26)break}return s},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(s){return this.negative!==0?this.abs().inotn(s).iaddn(1):this.clone()},n.prototype.fromTwos=function(s){return this.testn(s-1)?this.notn(s).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(s){for(;this.length<s.length;)this.words[this.length++]=0;for(var l=0;l<s.length;l++)this.words[l]=this.words[l]|s.words[l];return this.strip()},n.prototype.ior=function(s){return t((this.negative|s.negative)===0),this.iuor(s)},n.prototype.or=function(s){return this.length>s.length?this.clone().ior(s):s.clone().ior(this)},n.prototype.uor=function(s){return this.length>s.length?this.clone().iuor(s):s.clone().iuor(this)},n.prototype.iuand=function(s){var l;this.length>s.length?l=s:l=this;for(var d=0;d<l.length;d++)this.words[d]=this.words[d]&s.words[d];return this.length=l.length,this.strip()},n.prototype.iand=function(s){return t((this.negative|s.negative)===0),this.iuand(s)},n.prototype.and=function(s){return this.length>s.length?this.clone().iand(s):s.clone().iand(this)},n.prototype.uand=function(s){return this.length>s.length?this.clone().iuand(s):s.clone().iuand(this)},n.prototype.iuxor=function(s){var l,d;this.length>s.length?(l=this,d=s):(l=s,d=this);for(var p=0;p<d.length;p++)this.words[p]=l.words[p]^d.words[p];if(this!==l)for(;p<l.length;p++)this.words[p]=l.words[p];return this.length=l.length,this.strip()},n.prototype.ixor=function(s){return t((this.negative|s.negative)===0),this.iuxor(s)},n.prototype.xor=function(s){return this.length>s.length?this.clone().ixor(s):s.clone().ixor(this)},n.prototype.uxor=function(s){return this.length>s.length?this.clone().iuxor(s):s.clone().iuxor(this)},n.prototype.inotn=function(s){t(typeof s=="number"&&s>=0);var l=Math.ceil(s/26)|0,d=s%26;this._expand(l),d>0&&l--;for(var p=0;p<l;p++)this.words[p]=~this.words[p]&67108863;return d>0&&(this.words[p]=~this.words[p]&67108863>>26-d),this.strip()},n.prototype.notn=function(s){return this.clone().inotn(s)},n.prototype.setn=function(s,l){t(typeof s=="number"&&s>=0);var d=s/26|0,p=s%26;return this._expand(d+1),l?this.words[d]=this.words[d]|1<<p:this.words[d]=this.words[d]&~(1<<p),this.strip()},n.prototype.iadd=function(s){var l;if(this.negative!==0&&s.negative===0)return this.negative=0,l=this.isub(s),this.negative^=1,this._normSign();if(this.negative===0&&s.negative!==0)return s.negative=0,l=this.isub(s),s.negative=1,l._normSign();var d,p;this.length>s.length?(d=this,p=s):(d=s,p=this);for(var m=0,w=0;w<p.length;w++)l=(d.words[w]|0)+(p.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;for(;m!==0&&w<d.length;w++)l=(d.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;if(this.length=d.length,m!==0)this.words[this.length]=m,this.length++;else if(d!==this)for(;w<d.length;w++)this.words[w]=d.words[w];return this},n.prototype.add=function(s){var l;return s.negative!==0&&this.negative===0?(s.negative=0,l=this.sub(s),s.negative^=1,l):s.negative===0&&this.negative!==0?(this.negative=0,l=s.sub(this),this.negative=1,l):this.length>s.length?this.clone().iadd(s):s.clone().iadd(this)},n.prototype.isub=function(s){if(s.negative!==0){s.negative=0;var l=this.iadd(s);return s.negative=1,l._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(s),this.negative=1,this._normSign();var d=this.cmp(s);if(d===0)return this.negative=0,this.length=1,this.words[0]=0,this;var p,m;d>0?(p=this,m=s):(p=s,m=this);for(var w=0,x=0;x<m.length;x++)l=(p.words[x]|0)-(m.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;for(;w!==0&&x<p.length;x++)l=(p.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;if(w===0&&x<p.length&&p!==this)for(;x<p.length;x++)this.words[x]=p.words[x];return this.length=Math.max(this.length,x),p!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(s){return this.clone().isub(s)};function A(E,s,l){l.negative=s.negative^E.negative;var d=E.length+s.length|0;l.length=d,d=d-1|0;var p=E.words[0]|0,m=s.words[0]|0,w=p*m,x=w&67108863,b=w/67108864|0;l.words[0]=x;for(var f=1;f<d;f++){for(var C=b>>>26,F=b&67108863,z=Math.min(f,s.length-1),W=Math.max(0,f-E.length+1);W<=z;W++){var $=f-W|0;p=E.words[$]|0,m=s.words[W]|0,w=p*m+F,C+=w/67108864|0,F=w&67108863}l.words[f]=F|0,b=C|0}return b!==0?l.words[f]=b|0:l.length--,l.strip()}var S=function(s,l,d){var p=s.words,m=l.words,w=d.words,x=0,b,f,C,F=p[0]|0,z=F&8191,W=F>>>13,$=p[1]|0,I=$&8191,K=$>>>13,N=p[2]|0,X=N&8191,Q=N>>>13,L=p[3]|0,V=L&8191,Z=L>>>13,H=p[4]|0,j=H&8191,et=H>>>13,nt=p[5]|0,st=nt&8191,ft=nt>>>13,vt=p[6]|0,ot=vt&8191,pt=vt>>>13,Ut=p[7]|0,At=Ut&8191,It=Ut>>>13,Jt=p[8]|0,at=Jt&8191,J=Jt>>>13,rt=p[9]|0,lt=rt&8191,gt=rt>>>13,Dt=m[0]|0,ut=Dt&8191,Y=Dt>>>13,tt=m[1]|0,dt=tt&8191,mt=tt>>>13,xt=m[2]|0,bt=xt&8191,_t=xt>>>13,Ht=m[3]|0,St=Ht&8191,Mt=Ht>>>13,jt=m[4]|0,Lt=jt&8191,Ft=jt>>>13,te=m[5]|0,Bt=te&8191,Ot=te>>>13,ie=m[6]|0,kt=ie&8191,qt=ie>>>13,ae=m[7]|0,Rt=ae&8191,zt=ae>>>13,he=m[8]|0,Vt=he&8191,Qt=he>>>13,ge=m[9]|0,Gt=ge&8191,$t=ge>>>13;d.negative=s.negative^l.negative,d.length=19,b=Math.imul(z,ut),f=Math.imul(z,Y),f=f+Math.imul(W,ut)|0,C=Math.imul(W,Y);var pe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(pe>>>26)|0,pe&=67108863,b=Math.imul(I,ut),f=Math.imul(I,Y),f=f+Math.imul(K,ut)|0,C=Math.imul(K,Y),b=b+Math.imul(z,dt)|0,f=f+Math.imul(z,mt)|0,f=f+Math.imul(W,dt)|0,C=C+Math.imul(W,mt)|0;var de=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(de>>>26)|0,de&=67108863,b=Math.imul(X,ut),f=Math.imul(X,Y),f=f+Math.imul(Q,ut)|0,C=Math.imul(Q,Y),b=b+Math.imul(I,dt)|0,f=f+Math.imul(I,mt)|0,f=f+Math.imul(K,dt)|0,C=C+Math.imul(K,mt)|0,b=b+Math.imul(z,bt)|0,f=f+Math.imul(z,_t)|0,f=f+Math.imul(W,bt)|0,C=C+Math.imul(W,_t)|0;var Ee=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,b=Math.imul(V,ut),f=Math.imul(V,Y),f=f+Math.imul(Z,ut)|0,C=Math.imul(Z,Y),b=b+Math.imul(X,dt)|0,f=f+Math.imul(X,mt)|0,f=f+Math.imul(Q,dt)|0,C=C+Math.imul(Q,mt)|0,b=b+Math.imul(I,bt)|0,f=f+Math.imul(I,_t)|0,f=f+Math.imul(K,bt)|0,C=C+Math.imul(K,_t)|0,b=b+Math.imul(z,St)|0,f=f+Math.imul(z,Mt)|0,f=f+Math.imul(W,St)|0,C=C+Math.imul(W,Mt)|0;var xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(xe>>>26)|0,xe&=67108863,b=Math.imul(j,ut),f=Math.imul(j,Y),f=f+Math.imul(et,ut)|0,C=Math.imul(et,Y),b=b+Math.imul(V,dt)|0,f=f+Math.imul(V,mt)|0,f=f+Math.imul(Z,dt)|0,C=C+Math.imul(Z,mt)|0,b=b+Math.imul(X,bt)|0,f=f+Math.imul(X,_t)|0,f=f+Math.imul(Q,bt)|0,C=C+Math.imul(Q,_t)|0,b=b+Math.imul(I,St)|0,f=f+Math.imul(I,Mt)|0,f=f+Math.imul(K,St)|0,C=C+Math.imul(K,Mt)|0,b=b+Math.imul(z,Lt)|0,f=f+Math.imul(z,Ft)|0,f=f+Math.imul(W,Lt)|0,C=C+Math.imul(W,Ft)|0;var Se=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Se>>>26)|0,Se&=67108863,b=Math.imul(st,ut),f=Math.imul(st,Y),f=f+Math.imul(ft,ut)|0,C=Math.imul(ft,Y),b=b+Math.imul(j,dt)|0,f=f+Math.imul(j,mt)|0,f=f+Math.imul(et,dt)|0,C=C+Math.imul(et,mt)|0,b=b+Math.imul(V,bt)|0,f=f+Math.imul(V,_t)|0,f=f+Math.imul(Z,bt)|0,C=C+Math.imul(Z,_t)|0,b=b+Math.imul(X,St)|0,f=f+Math.imul(X,Mt)|0,f=f+Math.imul(Q,St)|0,C=C+Math.imul(Q,Mt)|0,b=b+Math.imul(I,Lt)|0,f=f+Math.imul(I,Ft)|0,f=f+Math.imul(K,Lt)|0,C=C+Math.imul(K,Ft)|0,b=b+Math.imul(z,Bt)|0,f=f+Math.imul(z,Ot)|0,f=f+Math.imul(W,Bt)|0,C=C+Math.imul(W,Ot)|0;var Be=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Be>>>26)|0,Be&=67108863,b=Math.imul(ot,ut),f=Math.imul(ot,Y),f=f+Math.imul(pt,ut)|0,C=Math.imul(pt,Y),b=b+Math.imul(st,dt)|0,f=f+Math.imul(st,mt)|0,f=f+Math.imul(ft,dt)|0,C=C+Math.imul(ft,mt)|0,b=b+Math.imul(j,bt)|0,f=f+Math.imul(j,_t)|0,f=f+Math.imul(et,bt)|0,C=C+Math.imul(et,_t)|0,b=b+Math.imul(V,St)|0,f=f+Math.imul(V,Mt)|0,f=f+Math.imul(Z,St)|0,C=C+Math.imul(Z,Mt)|0,b=b+Math.imul(X,Lt)|0,f=f+Math.imul(X,Ft)|0,f=f+Math.imul(Q,Lt)|0,C=C+Math.imul(Q,Ft)|0,b=b+Math.imul(I,Bt)|0,f=f+Math.imul(I,Ot)|0,f=f+Math.imul(K,Bt)|0,C=C+Math.imul(K,Ot)|0,b=b+Math.imul(z,kt)|0,f=f+Math.imul(z,qt)|0,f=f+Math.imul(W,kt)|0,C=C+Math.imul(W,qt)|0;var Ne=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,b=Math.imul(At,ut),f=Math.imul(At,Y),f=f+Math.imul(It,ut)|0,C=Math.imul(It,Y),b=b+Math.imul(ot,dt)|0,f=f+Math.imul(ot,mt)|0,f=f+Math.imul(pt,dt)|0,C=C+Math.imul(pt,mt)|0,b=b+Math.imul(st,bt)|0,f=f+Math.imul(st,_t)|0,f=f+Math.imul(ft,bt)|0,C=C+Math.imul(ft,_t)|0,b=b+Math.imul(j,St)|0,f=f+Math.imul(j,Mt)|0,f=f+Math.imul(et,St)|0,C=C+Math.imul(et,Mt)|0,b=b+Math.imul(V,Lt)|0,f=f+Math.imul(V,Ft)|0,f=f+Math.imul(Z,Lt)|0,C=C+Math.imul(Z,Ft)|0,b=b+Math.imul(X,Bt)|0,f=f+Math.imul(X,Ot)|0,f=f+Math.imul(Q,Bt)|0,C=C+Math.imul(Q,Ot)|0,b=b+Math.imul(I,kt)|0,f=f+Math.imul(I,qt)|0,f=f+Math.imul(K,kt)|0,C=C+Math.imul(K,qt)|0,b=b+Math.imul(z,Rt)|0,f=f+Math.imul(z,zt)|0,f=f+Math.imul(W,Rt)|0,C=C+Math.imul(W,zt)|0;var qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(qe>>>26)|0,qe&=67108863,b=Math.imul(at,ut),f=Math.imul(at,Y),f=f+Math.imul(J,ut)|0,C=Math.imul(J,Y),b=b+Math.imul(At,dt)|0,f=f+Math.imul(At,mt)|0,f=f+Math.imul(It,dt)|0,C=C+Math.imul(It,mt)|0,b=b+Math.imul(ot,bt)|0,f=f+Math.imul(ot,_t)|0,f=f+Math.imul(pt,bt)|0,C=C+Math.imul(pt,_t)|0,b=b+Math.imul(st,St)|0,f=f+Math.imul(st,Mt)|0,f=f+Math.imul(ft,St)|0,C=C+Math.imul(ft,Mt)|0,b=b+Math.imul(j,Lt)|0,f=f+Math.imul(j,Ft)|0,f=f+Math.imul(et,Lt)|0,C=C+Math.imul(et,Ft)|0,b=b+Math.imul(V,Bt)|0,f=f+Math.imul(V,Ot)|0,f=f+Math.imul(Z,Bt)|0,C=C+Math.imul(Z,Ot)|0,b=b+Math.imul(X,kt)|0,f=f+Math.imul(X,qt)|0,f=f+Math.imul(Q,kt)|0,C=C+Math.imul(Q,qt)|0,b=b+Math.imul(I,Rt)|0,f=f+Math.imul(I,zt)|0,f=f+Math.imul(K,Rt)|0,C=C+Math.imul(K,zt)|0,b=b+Math.imul(z,Vt)|0,f=f+Math.imul(z,Qt)|0,f=f+Math.imul(W,Vt)|0,C=C+Math.imul(W,Qt)|0;var Xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,b=Math.imul(lt,ut),f=Math.imul(lt,Y),f=f+Math.imul(gt,ut)|0,C=Math.imul(gt,Y),b=b+Math.imul(at,dt)|0,f=f+Math.imul(at,mt)|0,f=f+Math.imul(J,dt)|0,C=C+Math.imul(J,mt)|0,b=b+Math.imul(At,bt)|0,f=f+Math.imul(At,_t)|0,f=f+Math.imul(It,bt)|0,C=C+Math.imul(It,_t)|0,b=b+Math.imul(ot,St)|0,f=f+Math.imul(ot,Mt)|0,f=f+Math.imul(pt,St)|0,C=C+Math.imul(pt,Mt)|0,b=b+Math.imul(st,Lt)|0,f=f+Math.imul(st,Ft)|0,f=f+Math.imul(ft,Lt)|0,C=C+Math.imul(ft,Ft)|0,b=b+Math.imul(j,Bt)|0,f=f+Math.imul(j,Ot)|0,f=f+Math.imul(et,Bt)|0,C=C+Math.imul(et,Ot)|0,b=b+Math.imul(V,kt)|0,f=f+Math.imul(V,qt)|0,f=f+Math.imul(Z,kt)|0,C=C+Math.imul(Z,qt)|0,b=b+Math.imul(X,Rt)|0,f=f+Math.imul(X,zt)|0,f=f+Math.imul(Q,Rt)|0,C=C+Math.imul(Q,zt)|0,b=b+Math.imul(I,Vt)|0,f=f+Math.imul(I,Qt)|0,f=f+Math.imul(K,Vt)|0,C=C+Math.imul(K,Qt)|0,b=b+Math.imul(z,Gt)|0,f=f+Math.imul(z,$t)|0,f=f+Math.imul(W,Gt)|0,C=C+Math.imul(W,$t)|0;var Ge=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,b=Math.imul(lt,dt),f=Math.imul(lt,mt),f=f+Math.imul(gt,dt)|0,C=Math.imul(gt,mt),b=b+Math.imul(at,bt)|0,f=f+Math.imul(at,_t)|0,f=f+Math.imul(J,bt)|0,C=C+Math.imul(J,_t)|0,b=b+Math.imul(At,St)|0,f=f+Math.imul(At,Mt)|0,f=f+Math.imul(It,St)|0,C=C+Math.imul(It,Mt)|0,b=b+Math.imul(ot,Lt)|0,f=f+Math.imul(ot,Ft)|0,f=f+Math.imul(pt,Lt)|0,C=C+Math.imul(pt,Ft)|0,b=b+Math.imul(st,Bt)|0,f=f+Math.imul(st,Ot)|0,f=f+Math.imul(ft,Bt)|0,C=C+Math.imul(ft,Ot)|0,b=b+Math.imul(j,kt)|0,f=f+Math.imul(j,qt)|0,f=f+Math.imul(et,kt)|0,C=C+Math.imul(et,qt)|0,b=b+Math.imul(V,Rt)|0,f=f+Math.imul(V,zt)|0,f=f+Math.imul(Z,Rt)|0,C=C+Math.imul(Z,zt)|0,b=b+Math.imul(X,Vt)|0,f=f+Math.imul(X,Qt)|0,f=f+Math.imul(Q,Vt)|0,C=C+Math.imul(Q,Qt)|0,b=b+Math.imul(I,Gt)|0,f=f+Math.imul(I,$t)|0,f=f+Math.imul(K,Gt)|0,C=C+Math.imul(K,$t)|0;var Je=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Je>>>26)|0,Je&=67108863,b=Math.imul(lt,bt),f=Math.imul(lt,_t),f=f+Math.imul(gt,bt)|0,C=Math.imul(gt,_t),b=b+Math.imul(at,St)|0,f=f+Math.imul(at,Mt)|0,f=f+Math.imul(J,St)|0,C=C+Math.imul(J,Mt)|0,b=b+Math.imul(At,Lt)|0,f=f+Math.imul(At,Ft)|0,f=f+Math.imul(It,Lt)|0,C=C+Math.imul(It,Ft)|0,b=b+Math.imul(ot,Bt)|0,f=f+Math.imul(ot,Ot)|0,f=f+Math.imul(pt,Bt)|0,C=C+Math.imul(pt,Ot)|0,b=b+Math.imul(st,kt)|0,f=f+Math.imul(st,qt)|0,f=f+Math.imul(ft,kt)|0,C=C+Math.imul(ft,qt)|0,b=b+Math.imul(j,Rt)|0,f=f+Math.imul(j,zt)|0,f=f+Math.imul(et,Rt)|0,C=C+Math.imul(et,zt)|0,b=b+Math.imul(V,Vt)|0,f=f+Math.imul(V,Qt)|0,f=f+Math.imul(Z,Vt)|0,C=C+Math.imul(Z,Qt)|0,b=b+Math.imul(X,Gt)|0,f=f+Math.imul(X,$t)|0,f=f+Math.imul(Q,Gt)|0,C=C+Math.imul(Q,$t)|0;var ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ze>>>26)|0,ze&=67108863,b=Math.imul(lt,St),f=Math.imul(lt,Mt),f=f+Math.imul(gt,St)|0,C=Math.imul(gt,Mt),b=b+Math.imul(at,Lt)|0,f=f+Math.imul(at,Ft)|0,f=f+Math.imul(J,Lt)|0,C=C+Math.imul(J,Ft)|0,b=b+Math.imul(At,Bt)|0,f=f+Math.imul(At,Ot)|0,f=f+Math.imul(It,Bt)|0,C=C+Math.imul(It,Ot)|0,b=b+Math.imul(ot,kt)|0,f=f+Math.imul(ot,qt)|0,f=f+Math.imul(pt,kt)|0,C=C+Math.imul(pt,qt)|0,b=b+Math.imul(st,Rt)|0,f=f+Math.imul(st,zt)|0,f=f+Math.imul(ft,Rt)|0,C=C+Math.imul(ft,zt)|0,b=b+Math.imul(j,Vt)|0,f=f+Math.imul(j,Qt)|0,f=f+Math.imul(et,Vt)|0,C=C+Math.imul(et,Qt)|0,b=b+Math.imul(V,Gt)|0,f=f+Math.imul(V,$t)|0,f=f+Math.imul(Z,Gt)|0,C=C+Math.imul(Z,$t)|0;var rr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(rr>>>26)|0,rr&=67108863,b=Math.imul(lt,Lt),f=Math.imul(lt,Ft),f=f+Math.imul(gt,Lt)|0,C=Math.imul(gt,Ft),b=b+Math.imul(at,Bt)|0,f=f+Math.imul(at,Ot)|0,f=f+Math.imul(J,Bt)|0,C=C+Math.imul(J,Ot)|0,b=b+Math.imul(At,kt)|0,f=f+Math.imul(At,qt)|0,f=f+Math.imul(It,kt)|0,C=C+Math.imul(It,qt)|0,b=b+Math.imul(ot,Rt)|0,f=f+Math.imul(ot,zt)|0,f=f+Math.imul(pt,Rt)|0,C=C+Math.imul(pt,zt)|0,b=b+Math.imul(st,Vt)|0,f=f+Math.imul(st,Qt)|0,f=f+Math.imul(ft,Vt)|0,C=C+Math.imul(ft,Qt)|0,b=b+Math.imul(j,Gt)|0,f=f+Math.imul(j,$t)|0,f=f+Math.imul(et,Gt)|0,C=C+Math.imul(et,$t)|0;var Qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,b=Math.imul(lt,Bt),f=Math.imul(lt,Ot),f=f+Math.imul(gt,Bt)|0,C=Math.imul(gt,Ot),b=b+Math.imul(at,kt)|0,f=f+Math.imul(at,qt)|0,f=f+Math.imul(J,kt)|0,C=C+Math.imul(J,qt)|0,b=b+Math.imul(At,Rt)|0,f=f+Math.imul(At,zt)|0,f=f+Math.imul(It,Rt)|0,C=C+Math.imul(It,zt)|0,b=b+Math.imul(ot,Vt)|0,f=f+Math.imul(ot,Qt)|0,f=f+Math.imul(pt,Vt)|0,C=C+Math.imul(pt,Qt)|0,b=b+Math.imul(st,Gt)|0,f=f+Math.imul(st,$t)|0,f=f+Math.imul(ft,Gt)|0,C=C+Math.imul(ft,$t)|0;var Le=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Le>>>26)|0,Le&=67108863,b=Math.imul(lt,kt),f=Math.imul(lt,qt),f=f+Math.imul(gt,kt)|0,C=Math.imul(gt,qt),b=b+Math.imul(at,Rt)|0,f=f+Math.imul(at,zt)|0,f=f+Math.imul(J,Rt)|0,C=C+Math.imul(J,zt)|0,b=b+Math.imul(At,Vt)|0,f=f+Math.imul(At,Qt)|0,f=f+Math.imul(It,Vt)|0,C=C+Math.imul(It,Qt)|0,b=b+Math.imul(ot,Gt)|0,f=f+Math.imul(ot,$t)|0,f=f+Math.imul(pt,Gt)|0,C=C+Math.imul(pt,$t)|0;var ir=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ir>>>26)|0,ir&=67108863,b=Math.imul(lt,Rt),f=Math.imul(lt,zt),f=f+Math.imul(gt,Rt)|0,C=Math.imul(gt,zt),b=b+Math.imul(at,Vt)|0,f=f+Math.imul(at,Qt)|0,f=f+Math.imul(J,Vt)|0,C=C+Math.imul(J,Qt)|0,b=b+Math.imul(At,Gt)|0,f=f+Math.imul(At,$t)|0,f=f+Math.imul(It,Gt)|0,C=C+Math.imul(It,$t)|0;var nr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(nr>>>26)|0,nr&=67108863,b=Math.imul(lt,Vt),f=Math.imul(lt,Qt),f=f+Math.imul(gt,Vt)|0,C=Math.imul(gt,Qt),b=b+Math.imul(at,Gt)|0,f=f+Math.imul(at,$t)|0,f=f+Math.imul(J,Gt)|0,C=C+Math.imul(J,$t)|0;var Ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,b=Math.imul(lt,Gt),f=Math.imul(lt,$t),f=f+Math.imul(gt,Gt)|0,C=Math.imul(gt,$t);var ar=(x+b|0)+((f&8191)<<13)|0;return x=(C+(f>>>13)|0)+(ar>>>26)|0,ar&=67108863,w[0]=pe,w[1]=de,w[2]=Ee,w[3]=xe,w[4]=Se,w[5]=Be,w[6]=Ne,w[7]=qe,w[8]=Xe,w[9]=Ge,w[10]=Je,w[11]=ze,w[12]=rr,w[13]=Qe,w[14]=Le,w[15]=ir,w[16]=nr,w[17]=Ze,w[18]=ar,x!==0&&(w[19]=x,d.length++),d};Math.imul||(S=A);function T(E,s,l){l.negative=s.negative^E.negative,l.length=E.length+s.length;for(var d=0,p=0,m=0;m<l.length-1;m++){var w=p;p=0;for(var x=d&67108863,b=Math.min(m,s.length-1),f=Math.max(0,m-E.length+1);f<=b;f++){var C=m-f,F=E.words[C]|0,z=s.words[f]|0,W=F*z,$=W&67108863;w=w+(W/67108864|0)|0,$=$+x|0,x=$&67108863,w=w+($>>>26)|0,p+=w>>>26,w&=67108863}l.words[m]=x,d=w,w=p}return d!==0?l.words[m]=d:l.length--,l.strip()}function B(E,s,l){var d=new M;return d.mulp(E,s,l)}n.prototype.mulTo=function(s,l){var d,p=this.length+s.length;return this.length===10&&s.length===10?d=S(this,s,l):p<63?d=A(this,s,l):p<1024?d=T(this,s,l):d=B(this,s,l),d};function M(E,s){this.x=E,this.y=s}M.prototype.makeRBT=function(s){for(var l=new Array(s),d=n.prototype._countBits(s)-1,p=0;p<s;p++)l[p]=this.revBin(p,d,s);return l},M.prototype.revBin=function(s,l,d){if(s===0||s===d-1)return s;for(var p=0,m=0;m<l;m++)p|=(s&1)<<l-m-1,s>>=1;return p},M.prototype.permute=function(s,l,d,p,m,w){for(var x=0;x<w;x++)p[x]=l[s[x]],m[x]=d[s[x]]},M.prototype.transform=function(s,l,d,p,m,w){this.permute(w,s,l,d,p,m);for(var x=1;x<m;x<<=1)for(var b=x<<1,f=Math.cos(2*Math.PI/b),C=Math.sin(2*Math.PI/b),F=0;F<m;F+=b)for(var z=f,W=C,$=0;$<x;$++){var I=d[F+$],K=p[F+$],N=d[F+$+x],X=p[F+$+x],Q=z*N-W*X;X=z*X+W*N,N=Q,d[F+$]=I+N,p[F+$]=K+X,d[F+$+x]=I-N,p[F+$+x]=K-X,$!==b&&(Q=f*z-C*W,W=f*W+C*z,z=Q)}},M.prototype.guessLen13b=function(s,l){var d=Math.max(l,s)|1,p=d&1,m=0;for(d=d/2|0;d;d=d>>>1)m++;return 1<<m+1+p},M.prototype.conjugate=function(s,l,d){if(!(d<=1))for(var p=0;p<d/2;p++){var m=s[p];s[p]=s[d-p-1],s[d-p-1]=m,m=l[p],l[p]=-l[d-p-1],l[d-p-1]=-m}},M.prototype.normalize13b=function(s,l){for(var d=0,p=0;p<l/2;p++){var m=Math.round(s[2*p+1]/l)*8192+Math.round(s[2*p]/l)+d;s[p]=m&67108863,m<67108864?d=0:d=m/67108864|0}return s},M.prototype.convert13b=function(s,l,d,p){for(var m=0,w=0;w<l;w++)m=m+(s[w]|0),d[2*w]=m&8191,m=m>>>13,d[2*w+1]=m&8191,m=m>>>13;for(w=2*l;w<p;++w)d[w]=0;t(m===0),t((m&-8192)===0)},M.prototype.stub=function(s){for(var l=new Array(s),d=0;d<s;d++)l[d]=0;return l},M.prototype.mulp=function(s,l,d){var p=2*this.guessLen13b(s.length,l.length),m=this.makeRBT(p),w=this.stub(p),x=new Array(p),b=new Array(p),f=new Array(p),C=new Array(p),F=new Array(p),z=new Array(p),W=d.words;W.length=p,this.convert13b(s.words,s.length,x,p),this.convert13b(l.words,l.length,C,p),this.transform(x,w,b,f,p,m),this.transform(C,w,F,z,p,m);for(var $=0;$<p;$++){var I=b[$]*F[$]-f[$]*z[$];f[$]=b[$]*z[$]+f[$]*F[$],b[$]=I}return this.conjugate(b,f,p),this.transform(b,f,W,w,p,m),this.conjugate(W,w,p),this.normalize13b(W,p),d.negative=s.negative^l.negative,d.length=s.length+l.length,d.strip()},n.prototype.mul=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),this.mulTo(s,l)},n.prototype.mulf=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),B(this,s,l)},n.prototype.imul=function(s){return this.clone().mulTo(s,this)},n.prototype.imuln=function(s){t(typeof s=="number"),t(s<67108864);for(var l=0,d=0;d<this.length;d++){var p=(this.words[d]|0)*s,m=(p&67108863)+(l&67108863);l>>=26,l+=p/67108864|0,l+=m>>>26,this.words[d]=m&67108863}return l!==0&&(this.words[d]=l,this.length++),this},n.prototype.muln=function(s){return this.clone().imuln(s)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(s){var l=_(s);if(l.length===0)return new n(1);for(var d=this,p=0;p<l.length&&l[p]===0;p++,d=d.sqr());if(++p<l.length)for(var m=d.sqr();p<l.length;p++,m=m.sqr())l[p]!==0&&(d=d.mul(m));return d},n.prototype.iushln=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=67108863>>>26-l<<26-l,m;if(l!==0){var w=0;for(m=0;m<this.length;m++){var x=this.words[m]&p,b=(this.words[m]|0)-x<<l;this.words[m]=b|w,w=x>>>26-l}w&&(this.words[m]=w,this.length++)}if(d!==0){for(m=this.length-1;m>=0;m--)this.words[m+d]=this.words[m];for(m=0;m<d;m++)this.words[m]=0;this.length+=d}return this.strip()},n.prototype.ishln=function(s){return t(this.negative===0),this.iushln(s)},n.prototype.iushrn=function(s,l,d){t(typeof s=="number"&&s>=0);var p;l?p=(l-l%26)/26:p=0;var m=s%26,w=Math.min((s-m)/26,this.length),x=67108863^67108863>>>m<<m,b=d;if(p-=w,p=Math.max(0,p),b){for(var f=0;f<w;f++)b.words[f]=this.words[f];b.length=w}if(w!==0)if(this.length>w)for(this.length-=w,f=0;f<this.length;f++)this.words[f]=this.words[f+w];else this.words[0]=0,this.length=1;var C=0;for(f=this.length-1;f>=0&&(C!==0||f>=p);f--){var F=this.words[f]|0;this.words[f]=C<<26-m|F>>>m,C=F&x}return b&&C!==0&&(b.words[b.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(s,l,d){return t(this.negative===0),this.iushrn(s,l,d)},n.prototype.shln=function(s){return this.clone().ishln(s)},n.prototype.ushln=function(s){return this.clone().iushln(s)},n.prototype.shrn=function(s){return this.clone().ishrn(s)},n.prototype.ushrn=function(s){return this.clone().iushrn(s)},n.prototype.testn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return!1;var m=this.words[d];return!!(m&p)},n.prototype.imaskn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=d)return this;if(l!==0&&d++,this.length=Math.min(d,this.length),l!==0){var p=67108863^67108863>>>l<<l;this.words[this.length-1]&=p}return this.strip()},n.prototype.maskn=function(s){return this.clone().imaskn(s)},n.prototype.iaddn=function(s){return t(typeof s=="number"),t(s<67108864),s<0?this.isubn(-s):this.negative!==0?this.length===1&&(this.words[0]|0)<s?(this.words[0]=s-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(s),this.negative=1,this):this._iaddn(s)},n.prototype._iaddn=function(s){this.words[0]+=s;for(var l=0;l<this.length&&this.words[l]>=67108864;l++)this.words[l]-=67108864,l===this.length-1?this.words[l+1]=1:this.words[l+1]++;return this.length=Math.max(this.length,l+1),this},n.prototype.isubn=function(s){if(t(typeof s=="number"),t(s<67108864),s<0)return this.iaddn(-s);if(this.negative!==0)return this.negative=0,this.iaddn(s),this.negative=1,this;if(this.words[0]-=s,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var l=0;l<this.length&&this.words[l]<0;l++)this.words[l]+=67108864,this.words[l+1]-=1;return this.strip()},n.prototype.addn=function(s){return this.clone().iaddn(s)},n.prototype.subn=function(s){return this.clone().isubn(s)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(s,l,d){var p=s.length+d,m;this._expand(p);var w,x=0;for(m=0;m<s.length;m++){w=(this.words[m+d]|0)+x;var b=(s.words[m]|0)*l;w-=b&67108863,x=(w>>26)-(b/67108864|0),this.words[m+d]=w&67108863}for(;m<this.length-d;m++)w=(this.words[m+d]|0)+x,x=w>>26,this.words[m+d]=w&67108863;if(x===0)return this.strip();for(t(x===-1),x=0,m=0;m<this.length;m++)w=-(this.words[m]|0)+x,x=w>>26,this.words[m]=w&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(s,l){var d=this.length-s.length,p=this.clone(),m=s,w=m.words[m.length-1]|0,x=this._countBits(w);d=26-x,d!==0&&(m=m.ushln(d),p.iushln(d),w=m.words[m.length-1]|0);var b=p.length-m.length,f;if(l!=="mod"){f=new n(null),f.length=b+1,f.words=new Array(f.length);for(var C=0;C<f.length;C++)f.words[C]=0}var F=p.clone()._ishlnsubmul(m,1,b);F.negative===0&&(p=F,f&&(f.words[b]=1));for(var z=b-1;z>=0;z--){var W=(p.words[m.length+z]|0)*67108864+(p.words[m.length+z-1]|0);for(W=Math.min(W/w|0,67108863),p._ishlnsubmul(m,W,z);p.negative!==0;)W--,p.negative=0,p._ishlnsubmul(m,1,z),p.isZero()||(p.negative^=1);f&&(f.words[z]=W)}return f&&f.strip(),p.strip(),l!=="div"&&d!==0&&p.iushrn(d),{div:f||null,mod:p}},n.prototype.divmod=function(s,l,d){if(t(!s.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var p,m,w;return this.negative!==0&&s.negative===0?(w=this.neg().divmod(s,l),l!=="mod"&&(p=w.div.neg()),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.iadd(s)),{div:p,mod:m}):this.negative===0&&s.negative!==0?(w=this.divmod(s.neg(),l),l!=="mod"&&(p=w.div.neg()),{div:p,mod:w.mod}):this.negative&s.negative?(w=this.neg().divmod(s.neg(),l),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.isub(s)),{div:w.div,mod:m}):s.length>this.length||this.cmp(s)<0?{div:new n(0),mod:this}:s.length===1?l==="div"?{div:this.divn(s.words[0]),mod:null}:l==="mod"?{div:null,mod:new n(this.modn(s.words[0]))}:{div:this.divn(s.words[0]),mod:new n(this.modn(s.words[0]))}:this._wordDiv(s,l)},n.prototype.div=function(s){return this.divmod(s,"div",!1).div},n.prototype.mod=function(s){return this.divmod(s,"mod",!1).mod},n.prototype.umod=function(s){return this.divmod(s,"mod",!0).mod},n.prototype.divRound=function(s){var l=this.divmod(s);if(l.mod.isZero())return l.div;var d=l.div.negative!==0?l.mod.isub(s):l.mod,p=s.ushrn(1),m=s.andln(1),w=d.cmp(p);return w<0||m===1&&w===0?l.div:l.div.negative!==0?l.div.isubn(1):l.div.iaddn(1)},n.prototype.modn=function(s){t(s<=67108863);for(var l=(1<<26)%s,d=0,p=this.length-1;p>=0;p--)d=(l*d+(this.words[p]|0))%s;return d},n.prototype.idivn=function(s){t(s<=67108863);for(var l=0,d=this.length-1;d>=0;d--){var p=(this.words[d]|0)+l*67108864;this.words[d]=p/s|0,l=p%s}return this.strip()},n.prototype.divn=function(s){return this.clone().idivn(s)},n.prototype.egcd=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=new n(0),x=new n(1),b=0;l.isEven()&&d.isEven();)l.iushrn(1),d.iushrn(1),++b;for(var f=d.clone(),C=l.clone();!l.isZero();){for(var F=0,z=1;!(l.words[0]&z)&&F<26;++F,z<<=1);if(F>0)for(l.iushrn(F);F-- >0;)(p.isOdd()||m.isOdd())&&(p.iadd(f),m.isub(C)),p.iushrn(1),m.iushrn(1);for(var W=0,$=1;!(d.words[0]&$)&&W<26;++W,$<<=1);if(W>0)for(d.iushrn(W);W-- >0;)(w.isOdd()||x.isOdd())&&(w.iadd(f),x.isub(C)),w.iushrn(1),x.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(w),m.isub(x)):(d.isub(l),w.isub(p),x.isub(m))}return{a:w,b:x,gcd:d.iushln(b)}},n.prototype._invmp=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=d.clone();l.cmpn(1)>0&&d.cmpn(1)>0;){for(var x=0,b=1;!(l.words[0]&b)&&x<26;++x,b<<=1);if(x>0)for(l.iushrn(x);x-- >0;)p.isOdd()&&p.iadd(w),p.iushrn(1);for(var f=0,C=1;!(d.words[0]&C)&&f<26;++f,C<<=1);if(f>0)for(d.iushrn(f);f-- >0;)m.isOdd()&&m.iadd(w),m.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(m)):(d.isub(l),m.isub(p))}var F;return l.cmpn(1)===0?F=p:F=m,F.cmpn(0)<0&&F.iadd(s),F},n.prototype.gcd=function(s){if(this.isZero())return s.abs();if(s.isZero())return this.abs();var l=this.clone(),d=s.clone();l.negative=0,d.negative=0;for(var p=0;l.isEven()&&d.isEven();p++)l.iushrn(1),d.iushrn(1);do{for(;l.isEven();)l.iushrn(1);for(;d.isEven();)d.iushrn(1);var m=l.cmp(d);if(m<0){var w=l;l=d,d=w}else if(m===0||d.cmpn(1)===0)break;l.isub(d)}while(!0);return d.iushln(p)},n.prototype.invm=function(s){return this.egcd(s).a.umod(s)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(s){return this.words[0]&s},n.prototype.bincn=function(s){t(typeof s=="number");var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return this._expand(d+1),this.words[d]|=p,this;for(var m=p,w=d;m!==0&&w<this.length;w++){var x=this.words[w]|0;x+=m,m=x>>>26,x&=67108863,this.words[w]=x}return m!==0&&(this.words[w]=m,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(s){var l=s<0;if(this.negative!==0&&!l)return-1;if(this.negative===0&&l)return 1;this.strip();var d;if(this.length>1)d=1;else{l&&(s=-s),t(s<=67108863,"Number is too big");var p=this.words[0]|0;d=p===s?0:p<s?-1:1}return this.negative!==0?-d|0:d},n.prototype.cmp=function(s){if(this.negative!==0&&s.negative===0)return-1;if(this.negative===0&&s.negative!==0)return 1;var l=this.ucmp(s);return this.negative!==0?-l|0:l},n.prototype.ucmp=function(s){if(this.length>s.length)return 1;if(this.length<s.length)return-1;for(var l=0,d=this.length-1;d>=0;d--){var p=this.words[d]|0,m=s.words[d]|0;if(p!==m){p<m?l=-1:p>m&&(l=1);break}}return l},n.prototype.gtn=function(s){return this.cmpn(s)===1},n.prototype.gt=function(s){return this.cmp(s)===1},n.prototype.gten=function(s){return this.cmpn(s)>=0},n.prototype.gte=function(s){return this.cmp(s)>=0},n.prototype.ltn=function(s){return this.cmpn(s)===-1},n.prototype.lt=function(s){return this.cmp(s)===-1},n.prototype.lten=function(s){return this.cmpn(s)<=0},n.prototype.lte=function(s){return this.cmp(s)<=0},n.prototype.eqn=function(s){return this.cmpn(s)===0},n.prototype.eq=function(s){return this.cmp(s)===0},n.red=function(s){return new O(s)},n.prototype.toRed=function(s){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),s.convertTo(this)._forceRed(s)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(s){return this.red=s,this},n.prototype.forceRed=function(s){return t(!this.red,"Already a number in reduction context"),this._forceRed(s)},n.prototype.redAdd=function(s){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,s)},n.prototype.redIAdd=function(s){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,s)},n.prototype.redSub=function(s){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,s)},n.prototype.redISub=function(s){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,s)},n.prototype.redShl=function(s){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,s)},n.prototype.redMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.mul(this,s)},n.prototype.redIMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.imul(this,s)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(s){return t(this.red&&!s.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,s)};var R={k256:null,p224:null,p192:null,p25519:null};function P(E,s){this.name=E,this.p=new n(s,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}P.prototype._tmp=function(){var s=new n(null);return s.words=new Array(Math.ceil(this.n/13)),s},P.prototype.ireduce=function(s){var l=s,d;do this.split(l,this.tmp),l=this.imulK(l),l=l.iadd(this.tmp),d=l.bitLength();while(d>this.n);var p=d<this.n?-1:l.ucmp(this.p);return p===0?(l.words[0]=0,l.length=1):p>0?l.isub(this.p):l.strip!==void 0?l.strip():l._strip(),l},P.prototype.split=function(s,l){s.iushrn(this.n,0,l)},P.prototype.imulK=function(s){return s.imul(this.k)};function D(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(D,P),D.prototype.split=function(s,l){for(var d=4194303,p=Math.min(s.length,9),m=0;m<p;m++)l.words[m]=s.words[m];if(l.length=p,s.length<=9){s.words[0]=0,s.length=1;return}var w=s.words[9];for(l.words[l.length++]=w&d,m=10;m<s.length;m++){var x=s.words[m]|0;s.words[m-10]=(x&d)<<4|w>>>22,w=x}w>>>=22,s.words[m-10]=w,w===0&&s.length>10?s.length-=10:s.length-=9},D.prototype.imulK=function(s){s.words[s.length]=0,s.words[s.length+1]=0,s.length+=2;for(var l=0,d=0;d<s.length;d++){var p=s.words[d]|0;l+=p*977,s.words[d]=l&67108863,l=p*64+(l/67108864|0)}return s.words[s.length-1]===0&&(s.length--,s.words[s.length-1]===0&&s.length--),s};function q(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(q,P);function k(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(k,P);function U(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(U,P),U.prototype.imulK=function(s){for(var l=0,d=0;d<s.length;d++){var p=(s.words[d]|0)*19+l,m=p&67108863;p>>>=26,s.words[d]=m,l=p}return l!==0&&(s.words[s.length++]=l),s},n._prime=function(s){if(R[s])return R[s];var l;if(s==="k256")l=new D;else if(s==="p224")l=new q;else if(s==="p192")l=new k;else if(s==="p25519")l=new U;else throw new Error("Unknown prime "+s);return R[s]=l,l};function O(E){if(typeof E=="string"){var s=n._prime(E);this.m=s.p,this.prime=s}else t(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}O.prototype._verify1=function(s){t(s.negative===0,"red works only with positives"),t(s.red,"red works only with red numbers")},O.prototype._verify2=function(s,l){t((s.negative|l.negative)===0,"red works only with positives"),t(s.red&&s.red===l.red,"red works only with red numbers")},O.prototype.imod=function(s){return this.prime?this.prime.ireduce(s)._forceRed(this):s.umod(this.m)._forceRed(this)},O.prototype.neg=function(s){return s.isZero()?s.clone():this.m.sub(s)._forceRed(this)},O.prototype.add=function(s,l){this._verify2(s,l);var d=s.add(l);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},O.prototype.iadd=function(s,l){this._verify2(s,l);var d=s.iadd(l);return d.cmp(this.m)>=0&&d.isub(this.m),d},O.prototype.sub=function(s,l){this._verify2(s,l);var d=s.sub(l);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},O.prototype.isub=function(s,l){this._verify2(s,l);var d=s.isub(l);return d.cmpn(0)<0&&d.iadd(this.m),d},O.prototype.shl=function(s,l){return this._verify1(s),this.imod(s.ushln(l))},O.prototype.imul=function(s,l){return this._verify2(s,l),this.imod(s.imul(l))},O.prototype.mul=function(s,l){return this._verify2(s,l),this.imod(s.mul(l))},O.prototype.isqr=function(s){return this.imul(s,s.clone())},O.prototype.sqr=function(s){return this.mul(s,s)},O.prototype.sqrt=function(s){if(s.isZero())return s.clone();var l=this.m.andln(3);if(t(l%2===1),l===3){var d=this.m.add(new n(1)).iushrn(2);return this.pow(s,d)}for(var p=this.m.subn(1),m=0;!p.isZero()&&p.andln(1)===0;)m++,p.iushrn(1);t(!p.isZero());var w=new n(1).toRed(this),x=w.redNeg(),b=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new n(2*f*f).toRed(this);this.pow(f,b).cmp(x)!==0;)f.redIAdd(x);for(var C=this.pow(f,p),F=this.pow(s,p.addn(1).iushrn(1)),z=this.pow(s,p),W=m;z.cmp(w)!==0;){for(var $=z,I=0;$.cmp(w)!==0;I++)$=$.redSqr();t(I<W);var K=this.pow(C,new n(1).iushln(W-I-1));F=F.redMul(K),C=K.redSqr(),z=z.redMul(C),W=I}return F},O.prototype.invm=function(s){var l=s._invmp(this.m);return l.negative!==0?(l.negative=0,this.imod(l).redNeg()):this.imod(l)},O.prototype.pow=function(s,l){if(l.isZero())return new n(1).toRed(this);if(l.cmpn(1)===0)return s.clone();var d=4,p=new Array(1<<d);p[0]=new n(1).toRed(this),p[1]=s;for(var m=2;m<p.length;m++)p[m]=this.mul(p[m-1],s);var w=p[0],x=0,b=0,f=l.bitLength()%26;for(f===0&&(f=26),m=l.length-1;m>=0;m--){for(var C=l.words[m],F=f-1;F>=0;F--){var z=C>>F&1;if(w!==p[0]&&(w=this.sqr(w)),z===0&&x===0){b=0;continue}x<<=1,x|=z,b++,!(b!==d&&(m!==0||F!==0))&&(w=this.mul(w,p[x]),b=0,x=0)}f=26}return w},O.prototype.convertTo=function(s){var l=s.umod(this.m);return l===s?l.clone():l},O.prototype.convertFrom=function(s){var l=s.clone();return l.red=null,l},n.mont=function(s){return new G(s)};function G(E){O.call(this,E),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(G,O),G.prototype.convertTo=function(s){return this.imod(s.ushln(this.shift))},G.prototype.convertFrom=function(s){var l=this.imod(s.mul(this.rinv));return l.red=null,l},G.prototype.imul=function(s,l){if(s.isZero()||l.isZero())return s.words[0]=0,s.length=1,s;var d=s.imul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.mul=function(s,l){if(s.isZero()||l.isZero())return new n(0)._forceRed(this);var d=s.mul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.invm=function(s){var l=this.imod(s._invmp(this.m).mul(this.r2));return l._forceRed(this)}})(i,di)}(qf)),qf.exports}var zf={exports:{}};zf.exports;var z2;function H8(){return z2||(z2=1,function(i){(function(e,r){function t(E,s){if(!E)throw new Error(s||"Assertion failed")}function a(E,s){E.super_=s;var l=function(){};l.prototype=s.prototype,E.prototype=new l,E.prototype.constructor=E}function n(E,s,l){if(n.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&((s==="le"||s==="be")&&(l=s,s=10),this._init(E||0,s||10,l||"be"))}typeof e=="object"?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=$i.Buffer}catch{}n.isBN=function(s){return s instanceof n?!0:s!==null&&typeof s=="object"&&s.constructor.wordSize===n.wordSize&&Array.isArray(s.words)},n.max=function(s,l){return s.cmp(l)>0?s:l},n.min=function(s,l){return s.cmp(l)<0?s:l},n.prototype._init=function(s,l,d){if(typeof s=="number")return this._initNumber(s,l,d);if(typeof s=="object")return this._initArray(s,l,d);l==="hex"&&(l=16),t(l===(l|0)&&l>=2&&l<=36),s=s.toString().replace(/\s+/g,"");var p=0;s[0]==="-"&&(p++,this.negative=1),p<s.length&&(l===16?this._parseHex(s,p,d):(this._parseBase(s,l,p),d==="le"&&this._initArray(this.toArray(),l,d)))},n.prototype._initNumber=function(s,l,d){s<0&&(this.negative=1,s=-s),s<67108864?(this.words=[s&67108863],this.length=1):s<4503599627370496?(this.words=[s&67108863,s/67108864&67108863],this.length=2):(t(s<9007199254740992),this.words=[s&67108863,s/67108864&67108863,1],this.length=3),d==="le"&&this._initArray(this.toArray(),l,d)},n.prototype._initArray=function(s,l,d){if(t(typeof s.length=="number"),s.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(s.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m,w,x=0;if(d==="be")for(p=s.length-1,m=0;p>=0;p-=3)w=s[p]|s[p-1]<<8|s[p-2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);else if(d==="le")for(p=0,m=0;p<s.length;p+=3)w=s[p]|s[p+1]<<8|s[p+2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);return this.strip()};function u(E,s){var l=E.charCodeAt(s);return l>=65&&l<=70?l-55:l>=97&&l<=102?l-87:l-48&15}function v(E,s,l){var d=u(E,l);return l-1>=s&&(d|=u(E,l-1)<<4),d}n.prototype._parseHex=function(s,l,d){this.length=Math.ceil((s.length-l)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m=0,w=0,x;if(d==="be")for(p=s.length-1;p>=l;p-=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8;else{var b=s.length-l;for(p=b%2===0?l+1:l;p<s.length;p+=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8}this.strip()};function o(E,s,l,d){for(var p=0,m=Math.min(E.length,l),w=s;w<m;w++){var x=E.charCodeAt(w)-48;p*=d,x>=49?p+=x-49+10:x>=17?p+=x-17+10:p+=x}return p}n.prototype._parseBase=function(s,l,d){this.words=[0],this.length=1;for(var p=0,m=1;m<=67108863;m*=l)p++;p--,m=m/l|0;for(var w=s.length-d,x=w%p,b=Math.min(w,w-x)+d,f=0,C=d;C<b;C+=p)f=o(s,C,C+p,l),this.imuln(m),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(x!==0){var F=1;for(f=o(s,C,s.length,l),C=0;C<x;C++)F*=l;this.imuln(F),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},n.prototype.copy=function(s){s.words=new Array(this.length);for(var l=0;l<this.length;l++)s.words[l]=this.words[l];s.length=this.length,s.negative=this.negative,s.red=this.red},n.prototype.clone=function(){var s=new n(null);return this.copy(s),s},n.prototype._expand=function(s){for(;this.length<s;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(s,l){s=s||10,l=l|0||1;var d;if(s===16||s==="hex"){d="";for(var p=0,m=0,w=0;w<this.length;w++){var x=this.words[w],b=((x<<p|m)&16777215).toString(16);m=x>>>24-p&16777215,p+=2,p>=26&&(p-=26,w--),m!==0||w!==this.length-1?d=h[6-b.length]+b+d:d=b+d}for(m!==0&&(d=m.toString(16)+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}if(s===(s|0)&&s>=2&&s<=36){var f=g[s],C=y[s];d="";var F=this.clone();for(F.negative=0;!F.isZero();){var z=F.modn(C).toString(s);F=F.idivn(C),F.isZero()?d=z+d:d=h[f-z.length]+z+d}for(this.isZero()&&(d="0"+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var s=this.words[0];return this.length===2?s+=this.words[1]*67108864:this.length===3&&this.words[2]===1?s+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-s:s},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(s,l){return t(typeof c<"u"),this.toArrayLike(c,s,l)},n.prototype.toArray=function(s,l){return this.toArrayLike(Array,s,l)},n.prototype.toArrayLike=function(s,l,d){var p=this.byteLength(),m=d||Math.max(1,p);t(p<=m,"byte array longer than desired length"),t(m>0,"Requested array length <= 0"),this.strip();var w=l==="le",x=new s(m),b,f,C=this.clone();if(w){for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[f]=b;for(;f<m;f++)x[f]=0}else{for(f=0;f<m-p;f++)x[f]=0;for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[m-f-1]=b}return x},Math.clz32?n.prototype._countBits=function(s){return 32-Math.clz32(s)}:n.prototype._countBits=function(s){var l=s,d=0;return l>=4096&&(d+=13,l>>>=13),l>=64&&(d+=7,l>>>=7),l>=8&&(d+=4,l>>>=4),l>=2&&(d+=2,l>>>=2),d+l},n.prototype._zeroBits=function(s){if(s===0)return 26;var l=s,d=0;return l&8191||(d+=13,l>>>=13),l&127||(d+=7,l>>>=7),l&15||(d+=4,l>>>=4),l&3||(d+=2,l>>>=2),l&1||d++,d},n.prototype.bitLength=function(){var s=this.words[this.length-1],l=this._countBits(s);return(this.length-1)*26+l};function _(E){for(var s=new Array(E.bitLength()),l=0;l<s.length;l++){var d=l/26|0,p=l%26;s[l]=(E.words[d]&1<<p)>>>p}return s}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var s=0,l=0;l<this.length;l++){var d=this._zeroBits(this.words[l]);if(s+=d,d!==26)break}return s},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(s){return this.negative!==0?this.abs().inotn(s).iaddn(1):this.clone()},n.prototype.fromTwos=function(s){return this.testn(s-1)?this.notn(s).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(s){for(;this.length<s.length;)this.words[this.length++]=0;for(var l=0;l<s.length;l++)this.words[l]=this.words[l]|s.words[l];return this.strip()},n.prototype.ior=function(s){return t((this.negative|s.negative)===0),this.iuor(s)},n.prototype.or=function(s){return this.length>s.length?this.clone().ior(s):s.clone().ior(this)},n.prototype.uor=function(s){return this.length>s.length?this.clone().iuor(s):s.clone().iuor(this)},n.prototype.iuand=function(s){var l;this.length>s.length?l=s:l=this;for(var d=0;d<l.length;d++)this.words[d]=this.words[d]&s.words[d];return this.length=l.length,this.strip()},n.prototype.iand=function(s){return t((this.negative|s.negative)===0),this.iuand(s)},n.prototype.and=function(s){return this.length>s.length?this.clone().iand(s):s.clone().iand(this)},n.prototype.uand=function(s){return this.length>s.length?this.clone().iuand(s):s.clone().iuand(this)},n.prototype.iuxor=function(s){var l,d;this.length>s.length?(l=this,d=s):(l=s,d=this);for(var p=0;p<d.length;p++)this.words[p]=l.words[p]^d.words[p];if(this!==l)for(;p<l.length;p++)this.words[p]=l.words[p];return this.length=l.length,this.strip()},n.prototype.ixor=function(s){return t((this.negative|s.negative)===0),this.iuxor(s)},n.prototype.xor=function(s){return this.length>s.length?this.clone().ixor(s):s.clone().ixor(this)},n.prototype.uxor=function(s){return this.length>s.length?this.clone().iuxor(s):s.clone().iuxor(this)},n.prototype.inotn=function(s){t(typeof s=="number"&&s>=0);var l=Math.ceil(s/26)|0,d=s%26;this._expand(l),d>0&&l--;for(var p=0;p<l;p++)this.words[p]=~this.words[p]&67108863;return d>0&&(this.words[p]=~this.words[p]&67108863>>26-d),this.strip()},n.prototype.notn=function(s){return this.clone().inotn(s)},n.prototype.setn=function(s,l){t(typeof s=="number"&&s>=0);var d=s/26|0,p=s%26;return this._expand(d+1),l?this.words[d]=this.words[d]|1<<p:this.words[d]=this.words[d]&~(1<<p),this.strip()},n.prototype.iadd=function(s){var l;if(this.negative!==0&&s.negative===0)return this.negative=0,l=this.isub(s),this.negative^=1,this._normSign();if(this.negative===0&&s.negative!==0)return s.negative=0,l=this.isub(s),s.negative=1,l._normSign();var d,p;this.length>s.length?(d=this,p=s):(d=s,p=this);for(var m=0,w=0;w<p.length;w++)l=(d.words[w]|0)+(p.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;for(;m!==0&&w<d.length;w++)l=(d.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;if(this.length=d.length,m!==0)this.words[this.length]=m,this.length++;else if(d!==this)for(;w<d.length;w++)this.words[w]=d.words[w];return this},n.prototype.add=function(s){var l;return s.negative!==0&&this.negative===0?(s.negative=0,l=this.sub(s),s.negative^=1,l):s.negative===0&&this.negative!==0?(this.negative=0,l=s.sub(this),this.negative=1,l):this.length>s.length?this.clone().iadd(s):s.clone().iadd(this)},n.prototype.isub=function(s){if(s.negative!==0){s.negative=0;var l=this.iadd(s);return s.negative=1,l._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(s),this.negative=1,this._normSign();var d=this.cmp(s);if(d===0)return this.negative=0,this.length=1,this.words[0]=0,this;var p,m;d>0?(p=this,m=s):(p=s,m=this);for(var w=0,x=0;x<m.length;x++)l=(p.words[x]|0)-(m.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;for(;w!==0&&x<p.length;x++)l=(p.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;if(w===0&&x<p.length&&p!==this)for(;x<p.length;x++)this.words[x]=p.words[x];return this.length=Math.max(this.length,x),p!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(s){return this.clone().isub(s)};function A(E,s,l){l.negative=s.negative^E.negative;var d=E.length+s.length|0;l.length=d,d=d-1|0;var p=E.words[0]|0,m=s.words[0]|0,w=p*m,x=w&67108863,b=w/67108864|0;l.words[0]=x;for(var f=1;f<d;f++){for(var C=b>>>26,F=b&67108863,z=Math.min(f,s.length-1),W=Math.max(0,f-E.length+1);W<=z;W++){var $=f-W|0;p=E.words[$]|0,m=s.words[W]|0,w=p*m+F,C+=w/67108864|0,F=w&67108863}l.words[f]=F|0,b=C|0}return b!==0?l.words[f]=b|0:l.length--,l.strip()}var S=function(s,l,d){var p=s.words,m=l.words,w=d.words,x=0,b,f,C,F=p[0]|0,z=F&8191,W=F>>>13,$=p[1]|0,I=$&8191,K=$>>>13,N=p[2]|0,X=N&8191,Q=N>>>13,L=p[3]|0,V=L&8191,Z=L>>>13,H=p[4]|0,j=H&8191,et=H>>>13,nt=p[5]|0,st=nt&8191,ft=nt>>>13,vt=p[6]|0,ot=vt&8191,pt=vt>>>13,Ut=p[7]|0,At=Ut&8191,It=Ut>>>13,Jt=p[8]|0,at=Jt&8191,J=Jt>>>13,rt=p[9]|0,lt=rt&8191,gt=rt>>>13,Dt=m[0]|0,ut=Dt&8191,Y=Dt>>>13,tt=m[1]|0,dt=tt&8191,mt=tt>>>13,xt=m[2]|0,bt=xt&8191,_t=xt>>>13,Ht=m[3]|0,St=Ht&8191,Mt=Ht>>>13,jt=m[4]|0,Lt=jt&8191,Ft=jt>>>13,te=m[5]|0,Bt=te&8191,Ot=te>>>13,ie=m[6]|0,kt=ie&8191,qt=ie>>>13,ae=m[7]|0,Rt=ae&8191,zt=ae>>>13,he=m[8]|0,Vt=he&8191,Qt=he>>>13,ge=m[9]|0,Gt=ge&8191,$t=ge>>>13;d.negative=s.negative^l.negative,d.length=19,b=Math.imul(z,ut),f=Math.imul(z,Y),f=f+Math.imul(W,ut)|0,C=Math.imul(W,Y);var pe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(pe>>>26)|0,pe&=67108863,b=Math.imul(I,ut),f=Math.imul(I,Y),f=f+Math.imul(K,ut)|0,C=Math.imul(K,Y),b=b+Math.imul(z,dt)|0,f=f+Math.imul(z,mt)|0,f=f+Math.imul(W,dt)|0,C=C+Math.imul(W,mt)|0;var de=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(de>>>26)|0,de&=67108863,b=Math.imul(X,ut),f=Math.imul(X,Y),f=f+Math.imul(Q,ut)|0,C=Math.imul(Q,Y),b=b+Math.imul(I,dt)|0,f=f+Math.imul(I,mt)|0,f=f+Math.imul(K,dt)|0,C=C+Math.imul(K,mt)|0,b=b+Math.imul(z,bt)|0,f=f+Math.imul(z,_t)|0,f=f+Math.imul(W,bt)|0,C=C+Math.imul(W,_t)|0;var Ee=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,b=Math.imul(V,ut),f=Math.imul(V,Y),f=f+Math.imul(Z,ut)|0,C=Math.imul(Z,Y),b=b+Math.imul(X,dt)|0,f=f+Math.imul(X,mt)|0,f=f+Math.imul(Q,dt)|0,C=C+Math.imul(Q,mt)|0,b=b+Math.imul(I,bt)|0,f=f+Math.imul(I,_t)|0,f=f+Math.imul(K,bt)|0,C=C+Math.imul(K,_t)|0,b=b+Math.imul(z,St)|0,f=f+Math.imul(z,Mt)|0,f=f+Math.imul(W,St)|0,C=C+Math.imul(W,Mt)|0;var xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(xe>>>26)|0,xe&=67108863,b=Math.imul(j,ut),f=Math.imul(j,Y),f=f+Math.imul(et,ut)|0,C=Math.imul(et,Y),b=b+Math.imul(V,dt)|0,f=f+Math.imul(V,mt)|0,f=f+Math.imul(Z,dt)|0,C=C+Math.imul(Z,mt)|0,b=b+Math.imul(X,bt)|0,f=f+Math.imul(X,_t)|0,f=f+Math.imul(Q,bt)|0,C=C+Math.imul(Q,_t)|0,b=b+Math.imul(I,St)|0,f=f+Math.imul(I,Mt)|0,f=f+Math.imul(K,St)|0,C=C+Math.imul(K,Mt)|0,b=b+Math.imul(z,Lt)|0,f=f+Math.imul(z,Ft)|0,f=f+Math.imul(W,Lt)|0,C=C+Math.imul(W,Ft)|0;var Se=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Se>>>26)|0,Se&=67108863,b=Math.imul(st,ut),f=Math.imul(st,Y),f=f+Math.imul(ft,ut)|0,C=Math.imul(ft,Y),b=b+Math.imul(j,dt)|0,f=f+Math.imul(j,mt)|0,f=f+Math.imul(et,dt)|0,C=C+Math.imul(et,mt)|0,b=b+Math.imul(V,bt)|0,f=f+Math.imul(V,_t)|0,f=f+Math.imul(Z,bt)|0,C=C+Math.imul(Z,_t)|0,b=b+Math.imul(X,St)|0,f=f+Math.imul(X,Mt)|0,f=f+Math.imul(Q,St)|0,C=C+Math.imul(Q,Mt)|0,b=b+Math.imul(I,Lt)|0,f=f+Math.imul(I,Ft)|0,f=f+Math.imul(K,Lt)|0,C=C+Math.imul(K,Ft)|0,b=b+Math.imul(z,Bt)|0,f=f+Math.imul(z,Ot)|0,f=f+Math.imul(W,Bt)|0,C=C+Math.imul(W,Ot)|0;var Be=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Be>>>26)|0,Be&=67108863,b=Math.imul(ot,ut),f=Math.imul(ot,Y),f=f+Math.imul(pt,ut)|0,C=Math.imul(pt,Y),b=b+Math.imul(st,dt)|0,f=f+Math.imul(st,mt)|0,f=f+Math.imul(ft,dt)|0,C=C+Math.imul(ft,mt)|0,b=b+Math.imul(j,bt)|0,f=f+Math.imul(j,_t)|0,f=f+Math.imul(et,bt)|0,C=C+Math.imul(et,_t)|0,b=b+Math.imul(V,St)|0,f=f+Math.imul(V,Mt)|0,f=f+Math.imul(Z,St)|0,C=C+Math.imul(Z,Mt)|0,b=b+Math.imul(X,Lt)|0,f=f+Math.imul(X,Ft)|0,f=f+Math.imul(Q,Lt)|0,C=C+Math.imul(Q,Ft)|0,b=b+Math.imul(I,Bt)|0,f=f+Math.imul(I,Ot)|0,f=f+Math.imul(K,Bt)|0,C=C+Math.imul(K,Ot)|0,b=b+Math.imul(z,kt)|0,f=f+Math.imul(z,qt)|0,f=f+Math.imul(W,kt)|0,C=C+Math.imul(W,qt)|0;var Ne=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,b=Math.imul(At,ut),f=Math.imul(At,Y),f=f+Math.imul(It,ut)|0,C=Math.imul(It,Y),b=b+Math.imul(ot,dt)|0,f=f+Math.imul(ot,mt)|0,f=f+Math.imul(pt,dt)|0,C=C+Math.imul(pt,mt)|0,b=b+Math.imul(st,bt)|0,f=f+Math.imul(st,_t)|0,f=f+Math.imul(ft,bt)|0,C=C+Math.imul(ft,_t)|0,b=b+Math.imul(j,St)|0,f=f+Math.imul(j,Mt)|0,f=f+Math.imul(et,St)|0,C=C+Math.imul(et,Mt)|0,b=b+Math.imul(V,Lt)|0,f=f+Math.imul(V,Ft)|0,f=f+Math.imul(Z,Lt)|0,C=C+Math.imul(Z,Ft)|0,b=b+Math.imul(X,Bt)|0,f=f+Math.imul(X,Ot)|0,f=f+Math.imul(Q,Bt)|0,C=C+Math.imul(Q,Ot)|0,b=b+Math.imul(I,kt)|0,f=f+Math.imul(I,qt)|0,f=f+Math.imul(K,kt)|0,C=C+Math.imul(K,qt)|0,b=b+Math.imul(z,Rt)|0,f=f+Math.imul(z,zt)|0,f=f+Math.imul(W,Rt)|0,C=C+Math.imul(W,zt)|0;var qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(qe>>>26)|0,qe&=67108863,b=Math.imul(at,ut),f=Math.imul(at,Y),f=f+Math.imul(J,ut)|0,C=Math.imul(J,Y),b=b+Math.imul(At,dt)|0,f=f+Math.imul(At,mt)|0,f=f+Math.imul(It,dt)|0,C=C+Math.imul(It,mt)|0,b=b+Math.imul(ot,bt)|0,f=f+Math.imul(ot,_t)|0,f=f+Math.imul(pt,bt)|0,C=C+Math.imul(pt,_t)|0,b=b+Math.imul(st,St)|0,f=f+Math.imul(st,Mt)|0,f=f+Math.imul(ft,St)|0,C=C+Math.imul(ft,Mt)|0,b=b+Math.imul(j,Lt)|0,f=f+Math.imul(j,Ft)|0,f=f+Math.imul(et,Lt)|0,C=C+Math.imul(et,Ft)|0,b=b+Math.imul(V,Bt)|0,f=f+Math.imul(V,Ot)|0,f=f+Math.imul(Z,Bt)|0,C=C+Math.imul(Z,Ot)|0,b=b+Math.imul(X,kt)|0,f=f+Math.imul(X,qt)|0,f=f+Math.imul(Q,kt)|0,C=C+Math.imul(Q,qt)|0,b=b+Math.imul(I,Rt)|0,f=f+Math.imul(I,zt)|0,f=f+Math.imul(K,Rt)|0,C=C+Math.imul(K,zt)|0,b=b+Math.imul(z,Vt)|0,f=f+Math.imul(z,Qt)|0,f=f+Math.imul(W,Vt)|0,C=C+Math.imul(W,Qt)|0;var Xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,b=Math.imul(lt,ut),f=Math.imul(lt,Y),f=f+Math.imul(gt,ut)|0,C=Math.imul(gt,Y),b=b+Math.imul(at,dt)|0,f=f+Math.imul(at,mt)|0,f=f+Math.imul(J,dt)|0,C=C+Math.imul(J,mt)|0,b=b+Math.imul(At,bt)|0,f=f+Math.imul(At,_t)|0,f=f+Math.imul(It,bt)|0,C=C+Math.imul(It,_t)|0,b=b+Math.imul(ot,St)|0,f=f+Math.imul(ot,Mt)|0,f=f+Math.imul(pt,St)|0,C=C+Math.imul(pt,Mt)|0,b=b+Math.imul(st,Lt)|0,f=f+Math.imul(st,Ft)|0,f=f+Math.imul(ft,Lt)|0,C=C+Math.imul(ft,Ft)|0,b=b+Math.imul(j,Bt)|0,f=f+Math.imul(j,Ot)|0,f=f+Math.imul(et,Bt)|0,C=C+Math.imul(et,Ot)|0,b=b+Math.imul(V,kt)|0,f=f+Math.imul(V,qt)|0,f=f+Math.imul(Z,kt)|0,C=C+Math.imul(Z,qt)|0,b=b+Math.imul(X,Rt)|0,f=f+Math.imul(X,zt)|0,f=f+Math.imul(Q,Rt)|0,C=C+Math.imul(Q,zt)|0,b=b+Math.imul(I,Vt)|0,f=f+Math.imul(I,Qt)|0,f=f+Math.imul(K,Vt)|0,C=C+Math.imul(K,Qt)|0,b=b+Math.imul(z,Gt)|0,f=f+Math.imul(z,$t)|0,f=f+Math.imul(W,Gt)|0,C=C+Math.imul(W,$t)|0;var Ge=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,b=Math.imul(lt,dt),f=Math.imul(lt,mt),f=f+Math.imul(gt,dt)|0,C=Math.imul(gt,mt),b=b+Math.imul(at,bt)|0,f=f+Math.imul(at,_t)|0,f=f+Math.imul(J,bt)|0,C=C+Math.imul(J,_t)|0,b=b+Math.imul(At,St)|0,f=f+Math.imul(At,Mt)|0,f=f+Math.imul(It,St)|0,C=C+Math.imul(It,Mt)|0,b=b+Math.imul(ot,Lt)|0,f=f+Math.imul(ot,Ft)|0,f=f+Math.imul(pt,Lt)|0,C=C+Math.imul(pt,Ft)|0,b=b+Math.imul(st,Bt)|0,f=f+Math.imul(st,Ot)|0,f=f+Math.imul(ft,Bt)|0,C=C+Math.imul(ft,Ot)|0,b=b+Math.imul(j,kt)|0,f=f+Math.imul(j,qt)|0,f=f+Math.imul(et,kt)|0,C=C+Math.imul(et,qt)|0,b=b+Math.imul(V,Rt)|0,f=f+Math.imul(V,zt)|0,f=f+Math.imul(Z,Rt)|0,C=C+Math.imul(Z,zt)|0,b=b+Math.imul(X,Vt)|0,f=f+Math.imul(X,Qt)|0,f=f+Math.imul(Q,Vt)|0,C=C+Math.imul(Q,Qt)|0,b=b+Math.imul(I,Gt)|0,f=f+Math.imul(I,$t)|0,f=f+Math.imul(K,Gt)|0,C=C+Math.imul(K,$t)|0;var Je=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Je>>>26)|0,Je&=67108863,b=Math.imul(lt,bt),f=Math.imul(lt,_t),f=f+Math.imul(gt,bt)|0,C=Math.imul(gt,_t),b=b+Math.imul(at,St)|0,f=f+Math.imul(at,Mt)|0,f=f+Math.imul(J,St)|0,C=C+Math.imul(J,Mt)|0,b=b+Math.imul(At,Lt)|0,f=f+Math.imul(At,Ft)|0,f=f+Math.imul(It,Lt)|0,C=C+Math.imul(It,Ft)|0,b=b+Math.imul(ot,Bt)|0,f=f+Math.imul(ot,Ot)|0,f=f+Math.imul(pt,Bt)|0,C=C+Math.imul(pt,Ot)|0,b=b+Math.imul(st,kt)|0,f=f+Math.imul(st,qt)|0,f=f+Math.imul(ft,kt)|0,C=C+Math.imul(ft,qt)|0,b=b+Math.imul(j,Rt)|0,f=f+Math.imul(j,zt)|0,f=f+Math.imul(et,Rt)|0,C=C+Math.imul(et,zt)|0,b=b+Math.imul(V,Vt)|0,f=f+Math.imul(V,Qt)|0,f=f+Math.imul(Z,Vt)|0,C=C+Math.imul(Z,Qt)|0,b=b+Math.imul(X,Gt)|0,f=f+Math.imul(X,$t)|0,f=f+Math.imul(Q,Gt)|0,C=C+Math.imul(Q,$t)|0;var ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ze>>>26)|0,ze&=67108863,b=Math.imul(lt,St),f=Math.imul(lt,Mt),f=f+Math.imul(gt,St)|0,C=Math.imul(gt,Mt),b=b+Math.imul(at,Lt)|0,f=f+Math.imul(at,Ft)|0,f=f+Math.imul(J,Lt)|0,C=C+Math.imul(J,Ft)|0,b=b+Math.imul(At,Bt)|0,f=f+Math.imul(At,Ot)|0,f=f+Math.imul(It,Bt)|0,C=C+Math.imul(It,Ot)|0,b=b+Math.imul(ot,kt)|0,f=f+Math.imul(ot,qt)|0,f=f+Math.imul(pt,kt)|0,C=C+Math.imul(pt,qt)|0,b=b+Math.imul(st,Rt)|0,f=f+Math.imul(st,zt)|0,f=f+Math.imul(ft,Rt)|0,C=C+Math.imul(ft,zt)|0,b=b+Math.imul(j,Vt)|0,f=f+Math.imul(j,Qt)|0,f=f+Math.imul(et,Vt)|0,C=C+Math.imul(et,Qt)|0,b=b+Math.imul(V,Gt)|0,f=f+Math.imul(V,$t)|0,f=f+Math.imul(Z,Gt)|0,C=C+Math.imul(Z,$t)|0;var rr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(rr>>>26)|0,rr&=67108863,b=Math.imul(lt,Lt),f=Math.imul(lt,Ft),f=f+Math.imul(gt,Lt)|0,C=Math.imul(gt,Ft),b=b+Math.imul(at,Bt)|0,f=f+Math.imul(at,Ot)|0,f=f+Math.imul(J,Bt)|0,C=C+Math.imul(J,Ot)|0,b=b+Math.imul(At,kt)|0,f=f+Math.imul(At,qt)|0,f=f+Math.imul(It,kt)|0,C=C+Math.imul(It,qt)|0,b=b+Math.imul(ot,Rt)|0,f=f+Math.imul(ot,zt)|0,f=f+Math.imul(pt,Rt)|0,C=C+Math.imul(pt,zt)|0,b=b+Math.imul(st,Vt)|0,f=f+Math.imul(st,Qt)|0,f=f+Math.imul(ft,Vt)|0,C=C+Math.imul(ft,Qt)|0,b=b+Math.imul(j,Gt)|0,f=f+Math.imul(j,$t)|0,f=f+Math.imul(et,Gt)|0,C=C+Math.imul(et,$t)|0;var Qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,b=Math.imul(lt,Bt),f=Math.imul(lt,Ot),f=f+Math.imul(gt,Bt)|0,C=Math.imul(gt,Ot),b=b+Math.imul(at,kt)|0,f=f+Math.imul(at,qt)|0,f=f+Math.imul(J,kt)|0,C=C+Math.imul(J,qt)|0,b=b+Math.imul(At,Rt)|0,f=f+Math.imul(At,zt)|0,f=f+Math.imul(It,Rt)|0,C=C+Math.imul(It,zt)|0,b=b+Math.imul(ot,Vt)|0,f=f+Math.imul(ot,Qt)|0,f=f+Math.imul(pt,Vt)|0,C=C+Math.imul(pt,Qt)|0,b=b+Math.imul(st,Gt)|0,f=f+Math.imul(st,$t)|0,f=f+Math.imul(ft,Gt)|0,C=C+Math.imul(ft,$t)|0;var Le=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Le>>>26)|0,Le&=67108863,b=Math.imul(lt,kt),f=Math.imul(lt,qt),f=f+Math.imul(gt,kt)|0,C=Math.imul(gt,qt),b=b+Math.imul(at,Rt)|0,f=f+Math.imul(at,zt)|0,f=f+Math.imul(J,Rt)|0,C=C+Math.imul(J,zt)|0,b=b+Math.imul(At,Vt)|0,f=f+Math.imul(At,Qt)|0,f=f+Math.imul(It,Vt)|0,C=C+Math.imul(It,Qt)|0,b=b+Math.imul(ot,Gt)|0,f=f+Math.imul(ot,$t)|0,f=f+Math.imul(pt,Gt)|0,C=C+Math.imul(pt,$t)|0;var ir=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ir>>>26)|0,ir&=67108863,b=Math.imul(lt,Rt),f=Math.imul(lt,zt),f=f+Math.imul(gt,Rt)|0,C=Math.imul(gt,zt),b=b+Math.imul(at,Vt)|0,f=f+Math.imul(at,Qt)|0,f=f+Math.imul(J,Vt)|0,C=C+Math.imul(J,Qt)|0,b=b+Math.imul(At,Gt)|0,f=f+Math.imul(At,$t)|0,f=f+Math.imul(It,Gt)|0,C=C+Math.imul(It,$t)|0;var nr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(nr>>>26)|0,nr&=67108863,b=Math.imul(lt,Vt),f=Math.imul(lt,Qt),f=f+Math.imul(gt,Vt)|0,C=Math.imul(gt,Qt),b=b+Math.imul(at,Gt)|0,f=f+Math.imul(at,$t)|0,f=f+Math.imul(J,Gt)|0,C=C+Math.imul(J,$t)|0;var Ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,b=Math.imul(lt,Gt),f=Math.imul(lt,$t),f=f+Math.imul(gt,Gt)|0,C=Math.imul(gt,$t);var ar=(x+b|0)+((f&8191)<<13)|0;return x=(C+(f>>>13)|0)+(ar>>>26)|0,ar&=67108863,w[0]=pe,w[1]=de,w[2]=Ee,w[3]=xe,w[4]=Se,w[5]=Be,w[6]=Ne,w[7]=qe,w[8]=Xe,w[9]=Ge,w[10]=Je,w[11]=ze,w[12]=rr,w[13]=Qe,w[14]=Le,w[15]=ir,w[16]=nr,w[17]=Ze,w[18]=ar,x!==0&&(w[19]=x,d.length++),d};Math.imul||(S=A);function T(E,s,l){l.negative=s.negative^E.negative,l.length=E.length+s.length;for(var d=0,p=0,m=0;m<l.length-1;m++){var w=p;p=0;for(var x=d&67108863,b=Math.min(m,s.length-1),f=Math.max(0,m-E.length+1);f<=b;f++){var C=m-f,F=E.words[C]|0,z=s.words[f]|0,W=F*z,$=W&67108863;w=w+(W/67108864|0)|0,$=$+x|0,x=$&67108863,w=w+($>>>26)|0,p+=w>>>26,w&=67108863}l.words[m]=x,d=w,w=p}return d!==0?l.words[m]=d:l.length--,l.strip()}function B(E,s,l){var d=new M;return d.mulp(E,s,l)}n.prototype.mulTo=function(s,l){var d,p=this.length+s.length;return this.length===10&&s.length===10?d=S(this,s,l):p<63?d=A(this,s,l):p<1024?d=T(this,s,l):d=B(this,s,l),d};function M(E,s){this.x=E,this.y=s}M.prototype.makeRBT=function(s){for(var l=new Array(s),d=n.prototype._countBits(s)-1,p=0;p<s;p++)l[p]=this.revBin(p,d,s);return l},M.prototype.revBin=function(s,l,d){if(s===0||s===d-1)return s;for(var p=0,m=0;m<l;m++)p|=(s&1)<<l-m-1,s>>=1;return p},M.prototype.permute=function(s,l,d,p,m,w){for(var x=0;x<w;x++)p[x]=l[s[x]],m[x]=d[s[x]]},M.prototype.transform=function(s,l,d,p,m,w){this.permute(w,s,l,d,p,m);for(var x=1;x<m;x<<=1)for(var b=x<<1,f=Math.cos(2*Math.PI/b),C=Math.sin(2*Math.PI/b),F=0;F<m;F+=b)for(var z=f,W=C,$=0;$<x;$++){var I=d[F+$],K=p[F+$],N=d[F+$+x],X=p[F+$+x],Q=z*N-W*X;X=z*X+W*N,N=Q,d[F+$]=I+N,p[F+$]=K+X,d[F+$+x]=I-N,p[F+$+x]=K-X,$!==b&&(Q=f*z-C*W,W=f*W+C*z,z=Q)}},M.prototype.guessLen13b=function(s,l){var d=Math.max(l,s)|1,p=d&1,m=0;for(d=d/2|0;d;d=d>>>1)m++;return 1<<m+1+p},M.prototype.conjugate=function(s,l,d){if(!(d<=1))for(var p=0;p<d/2;p++){var m=s[p];s[p]=s[d-p-1],s[d-p-1]=m,m=l[p],l[p]=-l[d-p-1],l[d-p-1]=-m}},M.prototype.normalize13b=function(s,l){for(var d=0,p=0;p<l/2;p++){var m=Math.round(s[2*p+1]/l)*8192+Math.round(s[2*p]/l)+d;s[p]=m&67108863,m<67108864?d=0:d=m/67108864|0}return s},M.prototype.convert13b=function(s,l,d,p){for(var m=0,w=0;w<l;w++)m=m+(s[w]|0),d[2*w]=m&8191,m=m>>>13,d[2*w+1]=m&8191,m=m>>>13;for(w=2*l;w<p;++w)d[w]=0;t(m===0),t((m&-8192)===0)},M.prototype.stub=function(s){for(var l=new Array(s),d=0;d<s;d++)l[d]=0;return l},M.prototype.mulp=function(s,l,d){var p=2*this.guessLen13b(s.length,l.length),m=this.makeRBT(p),w=this.stub(p),x=new Array(p),b=new Array(p),f=new Array(p),C=new Array(p),F=new Array(p),z=new Array(p),W=d.words;W.length=p,this.convert13b(s.words,s.length,x,p),this.convert13b(l.words,l.length,C,p),this.transform(x,w,b,f,p,m),this.transform(C,w,F,z,p,m);for(var $=0;$<p;$++){var I=b[$]*F[$]-f[$]*z[$];f[$]=b[$]*z[$]+f[$]*F[$],b[$]=I}return this.conjugate(b,f,p),this.transform(b,f,W,w,p,m),this.conjugate(W,w,p),this.normalize13b(W,p),d.negative=s.negative^l.negative,d.length=s.length+l.length,d.strip()},n.prototype.mul=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),this.mulTo(s,l)},n.prototype.mulf=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),B(this,s,l)},n.prototype.imul=function(s){return this.clone().mulTo(s,this)},n.prototype.imuln=function(s){t(typeof s=="number"),t(s<67108864);for(var l=0,d=0;d<this.length;d++){var p=(this.words[d]|0)*s,m=(p&67108863)+(l&67108863);l>>=26,l+=p/67108864|0,l+=m>>>26,this.words[d]=m&67108863}return l!==0&&(this.words[d]=l,this.length++),this},n.prototype.muln=function(s){return this.clone().imuln(s)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(s){var l=_(s);if(l.length===0)return new n(1);for(var d=this,p=0;p<l.length&&l[p]===0;p++,d=d.sqr());if(++p<l.length)for(var m=d.sqr();p<l.length;p++,m=m.sqr())l[p]!==0&&(d=d.mul(m));return d},n.prototype.iushln=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=67108863>>>26-l<<26-l,m;if(l!==0){var w=0;for(m=0;m<this.length;m++){var x=this.words[m]&p,b=(this.words[m]|0)-x<<l;this.words[m]=b|w,w=x>>>26-l}w&&(this.words[m]=w,this.length++)}if(d!==0){for(m=this.length-1;m>=0;m--)this.words[m+d]=this.words[m];for(m=0;m<d;m++)this.words[m]=0;this.length+=d}return this.strip()},n.prototype.ishln=function(s){return t(this.negative===0),this.iushln(s)},n.prototype.iushrn=function(s,l,d){t(typeof s=="number"&&s>=0);var p;l?p=(l-l%26)/26:p=0;var m=s%26,w=Math.min((s-m)/26,this.length),x=67108863^67108863>>>m<<m,b=d;if(p-=w,p=Math.max(0,p),b){for(var f=0;f<w;f++)b.words[f]=this.words[f];b.length=w}if(w!==0)if(this.length>w)for(this.length-=w,f=0;f<this.length;f++)this.words[f]=this.words[f+w];else this.words[0]=0,this.length=1;var C=0;for(f=this.length-1;f>=0&&(C!==0||f>=p);f--){var F=this.words[f]|0;this.words[f]=C<<26-m|F>>>m,C=F&x}return b&&C!==0&&(b.words[b.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(s,l,d){return t(this.negative===0),this.iushrn(s,l,d)},n.prototype.shln=function(s){return this.clone().ishln(s)},n.prototype.ushln=function(s){return this.clone().iushln(s)},n.prototype.shrn=function(s){return this.clone().ishrn(s)},n.prototype.ushrn=function(s){return this.clone().iushrn(s)},n.prototype.testn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return!1;var m=this.words[d];return!!(m&p)},n.prototype.imaskn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=d)return this;if(l!==0&&d++,this.length=Math.min(d,this.length),l!==0){var p=67108863^67108863>>>l<<l;this.words[this.length-1]&=p}return this.strip()},n.prototype.maskn=function(s){return this.clone().imaskn(s)},n.prototype.iaddn=function(s){return t(typeof s=="number"),t(s<67108864),s<0?this.isubn(-s):this.negative!==0?this.length===1&&(this.words[0]|0)<s?(this.words[0]=s-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(s),this.negative=1,this):this._iaddn(s)},n.prototype._iaddn=function(s){this.words[0]+=s;for(var l=0;l<this.length&&this.words[l]>=67108864;l++)this.words[l]-=67108864,l===this.length-1?this.words[l+1]=1:this.words[l+1]++;return this.length=Math.max(this.length,l+1),this},n.prototype.isubn=function(s){if(t(typeof s=="number"),t(s<67108864),s<0)return this.iaddn(-s);if(this.negative!==0)return this.negative=0,this.iaddn(s),this.negative=1,this;if(this.words[0]-=s,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var l=0;l<this.length&&this.words[l]<0;l++)this.words[l]+=67108864,this.words[l+1]-=1;return this.strip()},n.prototype.addn=function(s){return this.clone().iaddn(s)},n.prototype.subn=function(s){return this.clone().isubn(s)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(s,l,d){var p=s.length+d,m;this._expand(p);var w,x=0;for(m=0;m<s.length;m++){w=(this.words[m+d]|0)+x;var b=(s.words[m]|0)*l;w-=b&67108863,x=(w>>26)-(b/67108864|0),this.words[m+d]=w&67108863}for(;m<this.length-d;m++)w=(this.words[m+d]|0)+x,x=w>>26,this.words[m+d]=w&67108863;if(x===0)return this.strip();for(t(x===-1),x=0,m=0;m<this.length;m++)w=-(this.words[m]|0)+x,x=w>>26,this.words[m]=w&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(s,l){var d=this.length-s.length,p=this.clone(),m=s,w=m.words[m.length-1]|0,x=this._countBits(w);d=26-x,d!==0&&(m=m.ushln(d),p.iushln(d),w=m.words[m.length-1]|0);var b=p.length-m.length,f;if(l!=="mod"){f=new n(null),f.length=b+1,f.words=new Array(f.length);for(var C=0;C<f.length;C++)f.words[C]=0}var F=p.clone()._ishlnsubmul(m,1,b);F.negative===0&&(p=F,f&&(f.words[b]=1));for(var z=b-1;z>=0;z--){var W=(p.words[m.length+z]|0)*67108864+(p.words[m.length+z-1]|0);for(W=Math.min(W/w|0,67108863),p._ishlnsubmul(m,W,z);p.negative!==0;)W--,p.negative=0,p._ishlnsubmul(m,1,z),p.isZero()||(p.negative^=1);f&&(f.words[z]=W)}return f&&f.strip(),p.strip(),l!=="div"&&d!==0&&p.iushrn(d),{div:f||null,mod:p}},n.prototype.divmod=function(s,l,d){if(t(!s.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var p,m,w;return this.negative!==0&&s.negative===0?(w=this.neg().divmod(s,l),l!=="mod"&&(p=w.div.neg()),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.iadd(s)),{div:p,mod:m}):this.negative===0&&s.negative!==0?(w=this.divmod(s.neg(),l),l!=="mod"&&(p=w.div.neg()),{div:p,mod:w.mod}):this.negative&s.negative?(w=this.neg().divmod(s.neg(),l),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.isub(s)),{div:w.div,mod:m}):s.length>this.length||this.cmp(s)<0?{div:new n(0),mod:this}:s.length===1?l==="div"?{div:this.divn(s.words[0]),mod:null}:l==="mod"?{div:null,mod:new n(this.modn(s.words[0]))}:{div:this.divn(s.words[0]),mod:new n(this.modn(s.words[0]))}:this._wordDiv(s,l)},n.prototype.div=function(s){return this.divmod(s,"div",!1).div},n.prototype.mod=function(s){return this.divmod(s,"mod",!1).mod},n.prototype.umod=function(s){return this.divmod(s,"mod",!0).mod},n.prototype.divRound=function(s){var l=this.divmod(s);if(l.mod.isZero())return l.div;var d=l.div.negative!==0?l.mod.isub(s):l.mod,p=s.ushrn(1),m=s.andln(1),w=d.cmp(p);return w<0||m===1&&w===0?l.div:l.div.negative!==0?l.div.isubn(1):l.div.iaddn(1)},n.prototype.modn=function(s){t(s<=67108863);for(var l=(1<<26)%s,d=0,p=this.length-1;p>=0;p--)d=(l*d+(this.words[p]|0))%s;return d},n.prototype.idivn=function(s){t(s<=67108863);for(var l=0,d=this.length-1;d>=0;d--){var p=(this.words[d]|0)+l*67108864;this.words[d]=p/s|0,l=p%s}return this.strip()},n.prototype.divn=function(s){return this.clone().idivn(s)},n.prototype.egcd=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=new n(0),x=new n(1),b=0;l.isEven()&&d.isEven();)l.iushrn(1),d.iushrn(1),++b;for(var f=d.clone(),C=l.clone();!l.isZero();){for(var F=0,z=1;!(l.words[0]&z)&&F<26;++F,z<<=1);if(F>0)for(l.iushrn(F);F-- >0;)(p.isOdd()||m.isOdd())&&(p.iadd(f),m.isub(C)),p.iushrn(1),m.iushrn(1);for(var W=0,$=1;!(d.words[0]&$)&&W<26;++W,$<<=1);if(W>0)for(d.iushrn(W);W-- >0;)(w.isOdd()||x.isOdd())&&(w.iadd(f),x.isub(C)),w.iushrn(1),x.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(w),m.isub(x)):(d.isub(l),w.isub(p),x.isub(m))}return{a:w,b:x,gcd:d.iushln(b)}},n.prototype._invmp=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=d.clone();l.cmpn(1)>0&&d.cmpn(1)>0;){for(var x=0,b=1;!(l.words[0]&b)&&x<26;++x,b<<=1);if(x>0)for(l.iushrn(x);x-- >0;)p.isOdd()&&p.iadd(w),p.iushrn(1);for(var f=0,C=1;!(d.words[0]&C)&&f<26;++f,C<<=1);if(f>0)for(d.iushrn(f);f-- >0;)m.isOdd()&&m.iadd(w),m.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(m)):(d.isub(l),m.isub(p))}var F;return l.cmpn(1)===0?F=p:F=m,F.cmpn(0)<0&&F.iadd(s),F},n.prototype.gcd=function(s){if(this.isZero())return s.abs();if(s.isZero())return this.abs();var l=this.clone(),d=s.clone();l.negative=0,d.negative=0;for(var p=0;l.isEven()&&d.isEven();p++)l.iushrn(1),d.iushrn(1);do{for(;l.isEven();)l.iushrn(1);for(;d.isEven();)d.iushrn(1);var m=l.cmp(d);if(m<0){var w=l;l=d,d=w}else if(m===0||d.cmpn(1)===0)break;l.isub(d)}while(!0);return d.iushln(p)},n.prototype.invm=function(s){return this.egcd(s).a.umod(s)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(s){return this.words[0]&s},n.prototype.bincn=function(s){t(typeof s=="number");var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return this._expand(d+1),this.words[d]|=p,this;for(var m=p,w=d;m!==0&&w<this.length;w++){var x=this.words[w]|0;x+=m,m=x>>>26,x&=67108863,this.words[w]=x}return m!==0&&(this.words[w]=m,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(s){var l=s<0;if(this.negative!==0&&!l)return-1;if(this.negative===0&&l)return 1;this.strip();var d;if(this.length>1)d=1;else{l&&(s=-s),t(s<=67108863,"Number is too big");var p=this.words[0]|0;d=p===s?0:p<s?-1:1}return this.negative!==0?-d|0:d},n.prototype.cmp=function(s){if(this.negative!==0&&s.negative===0)return-1;if(this.negative===0&&s.negative!==0)return 1;var l=this.ucmp(s);return this.negative!==0?-l|0:l},n.prototype.ucmp=function(s){if(this.length>s.length)return 1;if(this.length<s.length)return-1;for(var l=0,d=this.length-1;d>=0;d--){var p=this.words[d]|0,m=s.words[d]|0;if(p!==m){p<m?l=-1:p>m&&(l=1);break}}return l},n.prototype.gtn=function(s){return this.cmpn(s)===1},n.prototype.gt=function(s){return this.cmp(s)===1},n.prototype.gten=function(s){return this.cmpn(s)>=0},n.prototype.gte=function(s){return this.cmp(s)>=0},n.prototype.ltn=function(s){return this.cmpn(s)===-1},n.prototype.lt=function(s){return this.cmp(s)===-1},n.prototype.lten=function(s){return this.cmpn(s)<=0},n.prototype.lte=function(s){return this.cmp(s)<=0},n.prototype.eqn=function(s){return this.cmpn(s)===0},n.prototype.eq=function(s){return this.cmp(s)===0},n.red=function(s){return new O(s)},n.prototype.toRed=function(s){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),s.convertTo(this)._forceRed(s)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(s){return this.red=s,this},n.prototype.forceRed=function(s){return t(!this.red,"Already a number in reduction context"),this._forceRed(s)},n.prototype.redAdd=function(s){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,s)},n.prototype.redIAdd=function(s){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,s)},n.prototype.redSub=function(s){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,s)},n.prototype.redISub=function(s){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,s)},n.prototype.redShl=function(s){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,s)},n.prototype.redMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.mul(this,s)},n.prototype.redIMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.imul(this,s)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(s){return t(this.red&&!s.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,s)};var R={k256:null,p224:null,p192:null,p25519:null};function P(E,s){this.name=E,this.p=new n(s,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}P.prototype._tmp=function(){var s=new n(null);return s.words=new Array(Math.ceil(this.n/13)),s},P.prototype.ireduce=function(s){var l=s,d;do this.split(l,this.tmp),l=this.imulK(l),l=l.iadd(this.tmp),d=l.bitLength();while(d>this.n);var p=d<this.n?-1:l.ucmp(this.p);return p===0?(l.words[0]=0,l.length=1):p>0?l.isub(this.p):l.strip!==void 0?l.strip():l._strip(),l},P.prototype.split=function(s,l){s.iushrn(this.n,0,l)},P.prototype.imulK=function(s){return s.imul(this.k)};function D(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(D,P),D.prototype.split=function(s,l){for(var d=4194303,p=Math.min(s.length,9),m=0;m<p;m++)l.words[m]=s.words[m];if(l.length=p,s.length<=9){s.words[0]=0,s.length=1;return}var w=s.words[9];for(l.words[l.length++]=w&d,m=10;m<s.length;m++){var x=s.words[m]|0;s.words[m-10]=(x&d)<<4|w>>>22,w=x}w>>>=22,s.words[m-10]=w,w===0&&s.length>10?s.length-=10:s.length-=9},D.prototype.imulK=function(s){s.words[s.length]=0,s.words[s.length+1]=0,s.length+=2;for(var l=0,d=0;d<s.length;d++){var p=s.words[d]|0;l+=p*977,s.words[d]=l&67108863,l=p*64+(l/67108864|0)}return s.words[s.length-1]===0&&(s.length--,s.words[s.length-1]===0&&s.length--),s};function q(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(q,P);function k(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(k,P);function U(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(U,P),U.prototype.imulK=function(s){for(var l=0,d=0;d<s.length;d++){var p=(s.words[d]|0)*19+l,m=p&67108863;p>>>=26,s.words[d]=m,l=p}return l!==0&&(s.words[s.length++]=l),s},n._prime=function(s){if(R[s])return R[s];var l;if(s==="k256")l=new D;else if(s==="p224")l=new q;else if(s==="p192")l=new k;else if(s==="p25519")l=new U;else throw new Error("Unknown prime "+s);return R[s]=l,l};function O(E){if(typeof E=="string"){var s=n._prime(E);this.m=s.p,this.prime=s}else t(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}O.prototype._verify1=function(s){t(s.negative===0,"red works only with positives"),t(s.red,"red works only with red numbers")},O.prototype._verify2=function(s,l){t((s.negative|l.negative)===0,"red works only with positives"),t(s.red&&s.red===l.red,"red works only with red numbers")},O.prototype.imod=function(s){return this.prime?this.prime.ireduce(s)._forceRed(this):s.umod(this.m)._forceRed(this)},O.prototype.neg=function(s){return s.isZero()?s.clone():this.m.sub(s)._forceRed(this)},O.prototype.add=function(s,l){this._verify2(s,l);var d=s.add(l);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},O.prototype.iadd=function(s,l){this._verify2(s,l);var d=s.iadd(l);return d.cmp(this.m)>=0&&d.isub(this.m),d},O.prototype.sub=function(s,l){this._verify2(s,l);var d=s.sub(l);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},O.prototype.isub=function(s,l){this._verify2(s,l);var d=s.isub(l);return d.cmpn(0)<0&&d.iadd(this.m),d},O.prototype.shl=function(s,l){return this._verify1(s),this.imod(s.ushln(l))},O.prototype.imul=function(s,l){return this._verify2(s,l),this.imod(s.imul(l))},O.prototype.mul=function(s,l){return this._verify2(s,l),this.imod(s.mul(l))},O.prototype.isqr=function(s){return this.imul(s,s.clone())},O.prototype.sqr=function(s){return this.mul(s,s)},O.prototype.sqrt=function(s){if(s.isZero())return s.clone();var l=this.m.andln(3);if(t(l%2===1),l===3){var d=this.m.add(new n(1)).iushrn(2);return this.pow(s,d)}for(var p=this.m.subn(1),m=0;!p.isZero()&&p.andln(1)===0;)m++,p.iushrn(1);t(!p.isZero());var w=new n(1).toRed(this),x=w.redNeg(),b=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new n(2*f*f).toRed(this);this.pow(f,b).cmp(x)!==0;)f.redIAdd(x);for(var C=this.pow(f,p),F=this.pow(s,p.addn(1).iushrn(1)),z=this.pow(s,p),W=m;z.cmp(w)!==0;){for(var $=z,I=0;$.cmp(w)!==0;I++)$=$.redSqr();t(I<W);var K=this.pow(C,new n(1).iushln(W-I-1));F=F.redMul(K),C=K.redSqr(),z=z.redMul(C),W=I}return F},O.prototype.invm=function(s){var l=s._invmp(this.m);return l.negative!==0?(l.negative=0,this.imod(l).redNeg()):this.imod(l)},O.prototype.pow=function(s,l){if(l.isZero())return new n(1).toRed(this);if(l.cmpn(1)===0)return s.clone();var d=4,p=new Array(1<<d);p[0]=new n(1).toRed(this),p[1]=s;for(var m=2;m<p.length;m++)p[m]=this.mul(p[m-1],s);var w=p[0],x=0,b=0,f=l.bitLength()%26;for(f===0&&(f=26),m=l.length-1;m>=0;m--){for(var C=l.words[m],F=f-1;F>=0;F--){var z=C>>F&1;if(w!==p[0]&&(w=this.sqr(w)),z===0&&x===0){b=0;continue}x<<=1,x|=z,b++,!(b!==d&&(m!==0||F!==0))&&(w=this.mul(w,p[x]),b=0,x=0)}f=26}return w},O.prototype.convertTo=function(s){var l=s.umod(this.m);return l===s?l.clone():l},O.prototype.convertFrom=function(s){var l=s.clone();return l.red=null,l},n.mont=function(s){return new G(s)};function G(E){O.call(this,E),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(G,O),G.prototype.convertTo=function(s){return this.imod(s.ushln(this.shift))},G.prototype.convertFrom=function(s){var l=this.imod(s.mul(this.rinv));return l.red=null,l},G.prototype.imul=function(s,l){if(s.isZero()||l.isZero())return s.words[0]=0,s.length=1,s;var d=s.imul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.mul=function(s,l){if(s.isZero()||l.isZero())return new n(0)._forceRed(this);var d=s.mul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.invm=function(s){var l=this.imod(s._invmp(this.m).mul(this.r2));return l._forceRed(this)}})(i,di)}(zf)),zf.exports}var _f={exports:{}},V2;function zo(){if(V2)return _f.exports;V2=1;var i;_f.exports=function(a){return i||(i=new e(null)),i.generate(a)};function e(t){this.rand=t}if(_f.exports.Rand=e,e.prototype.generate=function(a){return this._rand(a)},e.prototype._rand=function(a){if(this.rand.getBytes)return this.rand.getBytes(a);for(var n=new Uint8Array(a),c=0;c<n.length;c++)n[c]=this.rand.getByte();return n},typeof self=="object")self.crypto&&self.crypto.getRandomValues?e.prototype._rand=function(a){var n=new Uint8Array(a);return self.crypto.getRandomValues(n),n}:self.msCrypto&&self.msCrypto.getRandomValues?e.prototype._rand=function(a){var n=new Uint8Array(a);return self.msCrypto.getRandomValues(n),n}:typeof window=="object"&&(e.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var r=ba();if(typeof r.randomBytes!="function")throw new Error("Not supported");e.prototype._rand=function(a){return r.randomBytes(a)}}catch{}return _f.exports}var Eu,G2;function Py(){if(G2)return Eu;G2=1;var i=H8(),e=zo();function r(t){this.rand=t||new e.Rand}return Eu=r,r.create=function(a){return new r(a)},r.prototype._randbelow=function(a){var n=a.bitLength(),c=Math.ceil(n/8);do var u=new i(this.rand.generate(c));while(u.cmp(a)>=0);return u},r.prototype._randrange=function(a,n){var c=n.sub(a);return a.add(this._randbelow(c))},r.prototype.test=function(a,n,c){var u=a.bitLength(),v=i.mont(a),o=new i(1).toRed(v);n||(n=Math.max(1,u/48|0));for(var h=a.subn(1),g=0;!h.testn(g);g++);for(var y=a.shrn(g),_=h.toRed(v),A=!0;n>0;n--){var S=this._randrange(new i(2),h);c&&c(S);var T=S.toRed(v).redPow(y);if(!(T.cmp(o)===0||T.cmp(_)===0)){for(var B=1;B<g;B++){if(T=T.redSqr(),T.cmp(o)===0)return!1;if(T.cmp(_)===0)break}if(B===g)return!1}}return A},r.prototype.getDivisor=function(a,n){var c=a.bitLength(),u=i.mont(a),v=new i(1).toRed(u);n||(n=Math.max(1,c/48|0));for(var o=a.subn(1),h=0;!o.testn(h);h++);for(var g=a.shrn(h),y=o.toRed(u);n>0;n--){var _=this._randrange(new i(2),o),A=a.gcd(_);if(A.cmpn(1)!==0)return A;var S=_.toRed(u).redPow(g);if(!(S.cmp(v)===0||S.cmp(y)===0)){for(var T=1;T<h;T++){if(S=S.redSqr(),S.cmp(v)===0)return S.fromRed().subn(1).gcd(a);if(S.cmp(y)===0)break}if(T===h)return S=S.redSqr(),S.fromRed().subn(1).gcd(a)}}return!1},Eu}var Au,K2;function Uy(){if(K2)return Au;K2=1;var i=Is();Au=T,T.simpleSieve=A,T.fermatTest=S;var e=ky(),r=new e(24),t=Py(),a=new t,n=new e(1),c=new e(2),u=new e(5);new e(16),new e(8);var v=new e(10),o=new e(3);new e(7);var h=new e(11),g=new e(4);new e(12);var y=null;function _(){if(y!==null)return y;var B=1048576,M=[];M[0]=2;for(var R=1,P=3;P<B;P+=2){for(var D=Math.ceil(Math.sqrt(P)),q=0;q<R&&M[q]<=D&&P%M[q]!==0;q++);R!==q&&M[q]<=D||(M[R++]=P)}return y=M,M}function A(B){for(var M=_(),R=0;R<M.length;R++)if(B.modn(M[R])===0)return B.cmpn(M[R])===0;return!0}function S(B){var M=e.mont(B);return c.toRed(M).redPow(B.subn(1)).fromRed().cmpn(1)===0}function T(B,M){if(B<16)return M===2||M===5?new e([140,123]):new e([140,39]);M=new e(M);for(var R,P;;){for(R=new e(i(Math.ceil(B/8)));R.bitLength()>B;)R.ishrn(1);if(R.isEven()&&R.iadd(n),R.testn(1)||R.iadd(c),M.cmp(c)){if(!M.cmp(u))for(;R.mod(v).cmp(o);)R.iadd(g)}else for(;R.mod(r).cmp(h);)R.iadd(g);if(P=R.shrn(1),A(P)&&A(R)&&S(P)&&S(R)&&a.test(P)&&a.test(R))return R}}return Au}const Q8={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},$8={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},Z8={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},j8={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},W8={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},Y8={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},X8={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},J8={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"},tw={modp1:Q8,modp2:$8,modp5:Z8,modp14:j8,modp15:W8,modp16:Y8,modp17:X8,modp18:J8};var Su,H2;function ew(){if(H2)return Su;H2=1;var i=ky(),e=Py(),r=new e,t=new i(24),a=new i(11),n=new i(10),c=new i(3),u=new i(7),v=Uy(),o=Is();Su=A;function h(T,B){return B=B||"utf8",Buffer.isBuffer(T)||(T=new Buffer(T,B)),this._pub=new i(T),this}function g(T,B){return B=B||"utf8",Buffer.isBuffer(T)||(T=new Buffer(T,B)),this._priv=new i(T),this}var y={};function _(T,B){var M=B.toString("hex"),R=[M,T.toString(16)].join("_");if(R in y)return y[R];var P=0;if(T.isEven()||!v.simpleSieve||!v.fermatTest(T)||!r.test(T))return P+=1,M==="02"||M==="05"?P+=8:P+=4,y[R]=P,P;r.test(T.shrn(1))||(P+=2);var D;switch(M){case"02":T.mod(t).cmp(a)&&(P+=8);break;case"05":D=T.mod(n),D.cmp(c)&&D.cmp(u)&&(P+=8);break;default:P+=4}return y[R]=P,P}function A(T,B,M){this.setGenerator(B),this.__prime=new i(T),this._prime=i.mont(this.__prime),this._primeLen=T.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,M?(this.setPublicKey=h,this.setPrivateKey=g):this._primeCode=8}Object.defineProperty(A.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=_(this.__prime,this.__gen)),this._primeCode}}),A.prototype.generateKeys=function(){return this._priv||(this._priv=new i(o(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},A.prototype.computeSecret=function(T){T=new i(T),T=T.toRed(this._prime);var B=T.redPow(this._priv).fromRed(),M=new Buffer(B.toArray()),R=this.getPrime();if(M.length<R.length){var P=new Buffer(R.length-M.length);P.fill(0),M=Buffer.concat([P,M])}return M},A.prototype.getPublicKey=function(B){return S(this._pub,B)},A.prototype.getPrivateKey=function(B){return S(this._priv,B)},A.prototype.getPrime=function(T){return S(this.__prime,T)},A.prototype.getGenerator=function(T){return S(this._gen,T)},A.prototype.setGenerator=function(T,B){return B=B||"utf8",Buffer.isBuffer(T)||(T=new Buffer(T,B)),this.__gen=T,this._gen=new i(T),this};function S(T,B){var M=new Buffer(T.toArray());return B?M.toString(B):M}return Su}var Q2;function rw(){if(Q2)return Sa;Q2=1;var i=Uy(),e=tw,r=ew();function t(c){var u=new Buffer(e[c].prime,"hex"),v=new Buffer(e[c].gen,"hex");return new r(u,v)}var a={binary:!0,hex:!0,base64:!0};function n(c,u,v,o){return Buffer.isBuffer(u)||a[u]===void 0?n(c,"binary",u,v):(u=u||"binary",o=o||"binary",v=v||new Buffer([2]),Buffer.isBuffer(v)||(v=new Buffer(v,o)),typeof c=="number"?new r(i(c,v),v,!0):(Buffer.isBuffer(c)||(c=new Buffer(c,u)),new r(c,v,!0)))}return Sa.DiffieHellmanGroup=Sa.createDiffieHellmanGroup=Sa.getDiffieHellman=t,Sa.createDiffieHellman=Sa.DiffieHellman=n,Sa}var wf={exports:{}},Cf={exports:{}},$2;function Il(){if($2)return Cf.exports;$2=1,typeof process>"u"||!process.version||process.version.indexOf("v0.")===0||process.version.indexOf("v1.")===0&&process.version.indexOf("v1.8.")!==0?Cf.exports={nextTick:i}:Cf.exports=process;function i(e,r,t,a){if(typeof e!="function")throw new TypeError('"callback" argument must be a function');var n=arguments.length,c,u;switch(n){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,r)});case 3:return process.nextTick(function(){e.call(null,r,t)});case 4:return process.nextTick(function(){e.call(null,r,t,a)});default:for(c=new Array(n-1),u=0;u<c.length;)c[u++]=arguments[u];return process.nextTick(function(){e.apply(null,c)})}}return Cf.exports}var xu,Z2;function iw(){if(Z2)return xu;Z2=1;var i={}.toString;return xu=Array.isArray||function(e){return i.call(e)=="[object Array]"},xu}var Iu,j2;function Dy(){return j2||(j2=1,Iu=Oo().EventEmitter),Iu}var Ef={exports:{}},W2;function l1(){return W2||(W2=1,function(i,e){var r=Ni(),t=r.Buffer;function a(c,u){for(var v in c)u[v]=c[v]}t.from&&t.alloc&&t.allocUnsafe&&t.allocUnsafeSlow?i.exports=r:(a(r,e),e.Buffer=n);function n(c,u,v){return t(c,u,v)}a(t,n),n.from=function(c,u,v){if(typeof c=="number")throw new TypeError("Argument must not be a number");return t(c,u,v)},n.alloc=function(c,u,v){if(typeof c!="number")throw new TypeError("Argument must be a number");var o=t(c);return u!==void 0?typeof v=="string"?o.fill(u,v):o.fill(u):o.fill(0),o},n.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return t(c)},n.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(c)}}(Ef,Ef.exports)),Ef.exports}var jr={},Y2;function Vo(){if(Y2)return jr;Y2=1;function i(S){return Array.isArray?Array.isArray(S):A(S)==="[object Array]"}jr.isArray=i;function e(S){return typeof S=="boolean"}jr.isBoolean=e;function r(S){return S===null}jr.isNull=r;function t(S){return S==null}jr.isNullOrUndefined=t;function a(S){return typeof S=="number"}jr.isNumber=a;function n(S){return typeof S=="string"}jr.isString=n;function c(S){return typeof S=="symbol"}jr.isSymbol=c;function u(S){return S===void 0}jr.isUndefined=u;function v(S){return A(S)==="[object RegExp]"}jr.isRegExp=v;function o(S){return typeof S=="object"&&S!==null}jr.isObject=o;function h(S){return A(S)==="[object Date]"}jr.isDate=h;function g(S){return A(S)==="[object Error]"||S instanceof Error}jr.isError=g;function y(S){return typeof S=="function"}jr.isFunction=y;function _(S){return S===null||typeof S=="boolean"||typeof S=="number"||typeof S=="string"||typeof S=="symbol"||typeof S>"u"}jr.isPrimitive=_,jr.isBuffer=Ni().Buffer.isBuffer;function A(S){return Object.prototype.toString.call(S)}return jr}var Mu={exports:{}},X2;function nw(){return X2||(X2=1,function(i){function e(n,c){if(!(n instanceof c))throw new TypeError("Cannot call a class as a function")}var r=l1().Buffer,t=$i;function a(n,c,u){n.copy(c,u)}i.exports=function(){function n(){e(this,n),this.head=null,this.tail=null,this.length=0}return n.prototype.push=function(u){var v={data:u,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length},n.prototype.unshift=function(u){var v={data:u,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length},n.prototype.shift=function(){if(this.length!==0){var u=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,u}},n.prototype.clear=function(){this.head=this.tail=null,this.length=0},n.prototype.join=function(u){if(this.length===0)return"";for(var v=this.head,o=""+v.data;v=v.next;)o+=u+v.data;return o},n.prototype.concat=function(u){if(this.length===0)return r.alloc(0);for(var v=r.allocUnsafe(u>>>0),o=this.head,h=0;o;)a(o.data,v,h),h+=o.data.length,o=o.next;return v},n}(),t&&t.inspect&&t.inspect.custom&&(i.exports.prototype[t.inspect.custom]=function(){var n=t.inspect({length:this.length});return this.constructor.name+" "+n})}(Mu)),Mu.exports}var Bu,J2;function Oy(){if(J2)return Bu;J2=1;var i=Il();function e(a,n){var c=this,u=this._readableState&&this._readableState.destroyed,v=this._writableState&&this._writableState.destroyed;return u||v?(n?n(a):a&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(t,this,a)):i.nextTick(t,this,a)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,function(o){!n&&o?c._writableState?c._writableState.errorEmitted||(c._writableState.errorEmitted=!0,i.nextTick(t,c,o)):i.nextTick(t,c,o):n&&n(o)}),this)}function r(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function t(a,n){a.emit("error",n)}return Bu={destroy:e,undestroy:r},Bu}var Lu,tv;function Fy(){if(tv)return Lu;tv=1;var i=Il();Lu=S;function e(w){var x=this;this.next=null,this.entry=null,this.finish=function(){m(x,w)}}var r=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:i.nextTick,t;S.WritableState=_;var a=Object.create(Vo());a.inherits=De();var n={deprecate:hy()},c=Dy(),u=l1().Buffer,v=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function o(w){return u.from(w)}function h(w){return u.isBuffer(w)||w instanceof v}var g=Oy();a.inherits(S,c);function y(){}function _(w,x){t=t||ms(),w=w||{};var b=x instanceof t;this.objectMode=!!w.objectMode,b&&(this.objectMode=this.objectMode||!!w.writableObjectMode);var f=w.highWaterMark,C=w.writableHighWaterMark,F=this.objectMode?16:16*1024;f||f===0?this.highWaterMark=f:b&&(C||C===0)?this.highWaterMark=C:this.highWaterMark=F,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var z=w.decodeStrings===!1;this.decodeStrings=!z,this.defaultEncoding=w.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(W){k(x,W)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new e(this)}_.prototype.getBuffer=function(){for(var x=this.bufferedRequest,b=[];x;)b.push(x),x=x.next;return b},function(){try{Object.defineProperty(_.prototype,"buffer",{get:n.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var A;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(A=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(w){return A.call(this,w)?!0:this!==S?!1:w&&w._writableState instanceof _}})):A=function(w){return w instanceof this};function S(w){if(t=t||ms(),!A.call(S,this)&&!(this instanceof t))return new S(w);this._writableState=new _(w,this),this.writable=!0,w&&(typeof w.write=="function"&&(this._write=w.write),typeof w.writev=="function"&&(this._writev=w.writev),typeof w.destroy=="function"&&(this._destroy=w.destroy),typeof w.final=="function"&&(this._final=w.final)),c.call(this)}S.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function T(w,x){var b=new Error("write after end");w.emit("error",b),i.nextTick(x,b)}function B(w,x,b,f){var C=!0,F=!1;return b===null?F=new TypeError("May not write null values to stream"):typeof b!="string"&&b!==void 0&&!x.objectMode&&(F=new TypeError("Invalid non-string/buffer chunk")),F&&(w.emit("error",F),i.nextTick(f,F),C=!1),C}S.prototype.write=function(w,x,b){var f=this._writableState,C=!1,F=!f.objectMode&&h(w);return F&&!u.isBuffer(w)&&(w=o(w)),typeof x=="function"&&(b=x,x=null),F?x="buffer":x||(x=f.defaultEncoding),typeof b!="function"&&(b=y),f.ended?T(this,b):(F||B(this,f,w,b))&&(f.pendingcb++,C=R(this,f,F,w,x,b)),C},S.prototype.cork=function(){var w=this._writableState;w.corked++},S.prototype.uncork=function(){var w=this._writableState;w.corked&&(w.corked--,!w.writing&&!w.corked&&!w.bufferProcessing&&w.bufferedRequest&&G(this,w))},S.prototype.setDefaultEncoding=function(x){if(typeof x=="string"&&(x=x.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((x+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+x);return this._writableState.defaultEncoding=x,this};function M(w,x,b){return!w.objectMode&&w.decodeStrings!==!1&&typeof x=="string"&&(x=u.from(x,b)),x}Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function R(w,x,b,f,C,F){if(!b){var z=M(x,f,C);f!==z&&(b=!0,C="buffer",f=z)}var W=x.objectMode?1:f.length;x.length+=W;var $=x.length<x.highWaterMark;if($||(x.needDrain=!0),x.writing||x.corked){var I=x.lastBufferedRequest;x.lastBufferedRequest={chunk:f,encoding:C,isBuf:b,callback:F,next:null},I?I.next=x.lastBufferedRequest:x.bufferedRequest=x.lastBufferedRequest,x.bufferedRequestCount+=1}else P(w,x,!1,W,f,C,F);return $}function P(w,x,b,f,C,F,z){x.writelen=f,x.writecb=z,x.writing=!0,x.sync=!0,b?w._writev(C,x.onwrite):w._write(C,F,x.onwrite),x.sync=!1}function D(w,x,b,f,C){--x.pendingcb,b?(i.nextTick(C,f),i.nextTick(d,w,x),w._writableState.errorEmitted=!0,w.emit("error",f)):(C(f),w._writableState.errorEmitted=!0,w.emit("error",f),d(w,x))}function q(w){w.writing=!1,w.writecb=null,w.length-=w.writelen,w.writelen=0}function k(w,x){var b=w._writableState,f=b.sync,C=b.writecb;if(q(b),x)D(w,b,f,x,C);else{var F=E(b);!F&&!b.corked&&!b.bufferProcessing&&b.bufferedRequest&&G(w,b),f?r(U,w,b,F,C):U(w,b,F,C)}}function U(w,x,b,f){b||O(w,x),x.pendingcb--,f(),d(w,x)}function O(w,x){x.length===0&&x.needDrain&&(x.needDrain=!1,w.emit("drain"))}function G(w,x){x.bufferProcessing=!0;var b=x.bufferedRequest;if(w._writev&&b&&b.next){var f=x.bufferedRequestCount,C=new Array(f),F=x.corkedRequestsFree;F.entry=b;for(var z=0,W=!0;b;)C[z]=b,b.isBuf||(W=!1),b=b.next,z+=1;C.allBuffers=W,P(w,x,!0,x.length,C,"",F.finish),x.pendingcb++,x.lastBufferedRequest=null,F.next?(x.corkedRequestsFree=F.next,F.next=null):x.corkedRequestsFree=new e(x),x.bufferedRequestCount=0}else{for(;b;){var $=b.chunk,I=b.encoding,K=b.callback,N=x.objectMode?1:$.length;if(P(w,x,!1,N,$,I,K),b=b.next,x.bufferedRequestCount--,x.writing)break}b===null&&(x.lastBufferedRequest=null)}x.bufferedRequest=b,x.bufferProcessing=!1}S.prototype._write=function(w,x,b){b(new Error("_write() is not implemented"))},S.prototype._writev=null,S.prototype.end=function(w,x,b){var f=this._writableState;typeof w=="function"?(b=w,w=null,x=null):typeof x=="function"&&(b=x,x=null),w!=null&&this.write(w,x),f.corked&&(f.corked=1,this.uncork()),f.ending||p(this,f,b)};function E(w){return w.ending&&w.length===0&&w.bufferedRequest===null&&!w.finished&&!w.writing}function s(w,x){w._final(function(b){x.pendingcb--,b&&w.emit("error",b),x.prefinished=!0,w.emit("prefinish"),d(w,x)})}function l(w,x){!x.prefinished&&!x.finalCalled&&(typeof w._final=="function"?(x.pendingcb++,x.finalCalled=!0,i.nextTick(s,w,x)):(x.prefinished=!0,w.emit("prefinish")))}function d(w,x){var b=E(x);return b&&(l(w,x),x.pendingcb===0&&(x.finished=!0,w.emit("finish"))),b}function p(w,x,b){x.ending=!0,d(w,x),b&&(x.finished?i.nextTick(b):w.once("finish",b)),x.ended=!0,w.writable=!1}function m(w,x,b){var f=w.entry;for(w.entry=null;f;){var C=f.callback;x.pendingcb--,C(b),f=f.next}x.corkedRequestsFree.next=w}return Object.defineProperty(S.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(w){this._writableState&&(this._writableState.destroyed=w)}}),S.prototype.destroy=g.destroy,S.prototype._undestroy=g.undestroy,S.prototype._destroy=function(w,x){this.end(),x(w)},Lu}var Tu,ev;function ms(){if(ev)return Tu;ev=1;var i=Il(),e=Object.keys||function(g){var y=[];for(var _ in g)y.push(_);return y};Tu=v;var r=Object.create(Vo());r.inherits=De();var t=qy(),a=Fy();r.inherits(v,t);for(var n=e(a.prototype),c=0;c<n.length;c++){var u=n[c];v.prototype[u]||(v.prototype[u]=a.prototype[u])}function v(g){if(!(this instanceof v))return new v(g);t.call(this,g),a.call(this,g),g&&g.readable===!1&&(this.readable=!1),g&&g.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,g&&g.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",o)}Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function o(){this.allowHalfOpen||this._writableState.ended||i.nextTick(h,this)}function h(g){g.end()}return Object.defineProperty(v.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=g,this._writableState.destroyed=g)}}),v.prototype._destroy=function(g,y){this.push(null),this.end(),i.nextTick(y,g)},Tu}var Ru={},Af={exports:{}},rv;function aw(){return rv||(rv=1,function(i,e){var r=Ni(),t=r.Buffer;function a(c,u){for(var v in c)u[v]=c[v]}t.from&&t.alloc&&t.allocUnsafe&&t.allocUnsafeSlow?i.exports=r:(a(r,e),e.Buffer=n);function n(c,u,v){return t(c,u,v)}a(t,n),n.from=function(c,u,v){if(typeof c=="number")throw new TypeError("Argument must not be a number");return t(c,u,v)},n.alloc=function(c,u,v){if(typeof c!="number")throw new TypeError("Argument must be a number");var o=t(c);return u!==void 0?typeof v=="string"?o.fill(u,v):o.fill(u):o.fill(0),o},n.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return t(c)},n.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(c)}}(Af,Af.exports)),Af.exports}var iv;function nv(){if(iv)return Ru;iv=1;var i=aw().Buffer,e=i.isEncoding||function(B){switch(B=""+B,B&&B.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(B){if(!B)return"utf8";for(var M;;)switch(B){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return B;default:if(M)return;B=(""+B).toLowerCase(),M=!0}}function t(B){var M=r(B);if(typeof M!="string"&&(i.isEncoding===e||!e(B)))throw new Error("Unknown encoding: "+B);return M||B}Ru.StringDecoder=a;function a(B){this.encoding=t(B);var M;switch(this.encoding){case"utf16le":this.text=g,this.end=y,M=4;break;case"utf8":this.fillLast=v,M=4;break;case"base64":this.text=_,this.end=A,M=3;break;default:this.write=S,this.end=T;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(M)}a.prototype.write=function(B){if(B.length===0)return"";var M,R;if(this.lastNeed){if(M=this.fillLast(B),M===void 0)return"";R=this.lastNeed,this.lastNeed=0}else R=0;return R<B.length?M?M+this.text(B,R):this.text(B,R):M||""},a.prototype.end=h,a.prototype.text=o,a.prototype.fillLast=function(B){if(this.lastNeed<=B.length)return B.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);B.copy(this.lastChar,this.lastTotal-this.lastNeed,0,B.length),this.lastNeed-=B.length};function n(B){return B<=127?0:B>>5===6?2:B>>4===14?3:B>>3===30?4:B>>6===2?-1:-2}function c(B,M,R){var P=M.length-1;if(P<R)return 0;var D=n(M[P]);return D>=0?(D>0&&(B.lastNeed=D-1),D):--P<R||D===-2?0:(D=n(M[P]),D>=0?(D>0&&(B.lastNeed=D-2),D):--P<R||D===-2?0:(D=n(M[P]),D>=0?(D>0&&(D===2?D=0:B.lastNeed=D-3),D):0))}function u(B,M,R){if((M[0]&192)!==128)return B.lastNeed=0,"";if(B.lastNeed>1&&M.length>1){if((M[1]&192)!==128)return B.lastNeed=1,"";if(B.lastNeed>2&&M.length>2&&(M[2]&192)!==128)return B.lastNeed=2,""}}function v(B){var M=this.lastTotal-this.lastNeed,R=u(this,B);if(R!==void 0)return R;if(this.lastNeed<=B.length)return B.copy(this.lastChar,M,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);B.copy(this.lastChar,M,0,B.length),this.lastNeed-=B.length}function o(B,M){var R=c(this,B,M);if(!this.lastNeed)return B.toString("utf8",M);this.lastTotal=R;var P=B.length-(R-this.lastNeed);return B.copy(this.lastChar,0,P),B.toString("utf8",M,P)}function h(B){var M=B&&B.length?this.write(B):"";return this.lastNeed?M+"":M}function g(B,M){if((B.length-M)%2===0){var R=B.toString("utf16le",M);if(R){var P=R.charCodeAt(R.length-1);if(P>=55296&&P<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=B[B.length-2],this.lastChar[1]=B[B.length-1],R.slice(0,-1)}return R}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=B[B.length-1],B.toString("utf16le",M,B.length-1)}function y(B){var M=B&&B.length?this.write(B):"";if(this.lastNeed){var R=this.lastTotal-this.lastNeed;return M+this.lastChar.toString("utf16le",0,R)}return M}function _(B,M){var R=(B.length-M)%3;return R===0?B.toString("base64",M):(this.lastNeed=3-R,this.lastTotal=3,R===1?this.lastChar[0]=B[B.length-1]:(this.lastChar[0]=B[B.length-2],this.lastChar[1]=B[B.length-1]),B.toString("base64",M,B.length-R))}function A(B){var M=B&&B.length?this.write(B):"";return this.lastNeed?M+this.lastChar.toString("base64",0,3-this.lastNeed):M}function S(B){return B.toString(this.encoding)}function T(B){return B&&B.length?this.write(B):""}return Ru}var Nu,av;function qy(){if(av)return Nu;av=1;var i=Il();Nu=M;var e=iw(),r;M.ReadableState=B,Oo().EventEmitter;var t=function(K,N){return K.listeners(N).length},a=Dy(),n=l1().Buffer,c=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function u(K){return n.from(K)}function v(K){return n.isBuffer(K)||K instanceof c}var o=Object.create(Vo());o.inherits=De();var h=$i,g=void 0;h&&h.debuglog?g=h.debuglog("stream"):g=function(){};var y=nw(),_=Oy(),A;o.inherits(M,a);var S=["error","close","destroy","pause","resume"];function T(K,N,X){if(typeof K.prependListener=="function")return K.prependListener(N,X);!K._events||!K._events[N]?K.on(N,X):e(K._events[N])?K._events[N].unshift(X):K._events[N]=[X,K._events[N]]}function B(K,N){r=r||ms(),K=K||{};var X=N instanceof r;this.objectMode=!!K.objectMode,X&&(this.objectMode=this.objectMode||!!K.readableObjectMode);var Q=K.highWaterMark,L=K.readableHighWaterMark,V=this.objectMode?16:16*1024;Q||Q===0?this.highWaterMark=Q:X&&(L||L===0)?this.highWaterMark=L:this.highWaterMark=V,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=K.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,K.encoding&&(A||(A=nv().StringDecoder),this.decoder=new A(K.encoding),this.encoding=K.encoding)}function M(K){if(r=r||ms(),!(this instanceof M))return new M(K);this._readableState=new B(K,this),this.readable=!0,K&&(typeof K.read=="function"&&(this._read=K.read),typeof K.destroy=="function"&&(this._destroy=K.destroy)),a.call(this)}Object.defineProperty(M.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(K){this._readableState&&(this._readableState.destroyed=K)}}),M.prototype.destroy=_.destroy,M.prototype._undestroy=_.undestroy,M.prototype._destroy=function(K,N){this.push(null),N(K)},M.prototype.push=function(K,N){var X=this._readableState,Q;return X.objectMode?Q=!0:typeof K=="string"&&(N=N||X.defaultEncoding,N!==X.encoding&&(K=n.from(K,N),N=""),Q=!0),R(this,K,N,!1,Q)},M.prototype.unshift=function(K){return R(this,K,null,!0,!1)};function R(K,N,X,Q,L){var V=K._readableState;if(N===null)V.reading=!1,G(K,V);else{var Z;L||(Z=D(V,N)),Z?K.emit("error",Z):V.objectMode||N&&N.length>0?(typeof N!="string"&&!V.objectMode&&Object.getPrototypeOf(N)!==n.prototype&&(N=u(N)),Q?V.endEmitted?K.emit("error",new Error("stream.unshift() after end event")):P(K,V,N,!0):V.ended?K.emit("error",new Error("stream.push() after EOF")):(V.reading=!1,V.decoder&&!X?(N=V.decoder.write(N),V.objectMode||N.length!==0?P(K,V,N,!1):l(K,V)):P(K,V,N,!1))):Q||(V.reading=!1)}return q(V)}function P(K,N,X,Q){N.flowing&&N.length===0&&!N.sync?(K.emit("data",X),K.read(0)):(N.length+=N.objectMode?1:X.length,Q?N.buffer.unshift(X):N.buffer.push(X),N.needReadable&&E(K)),l(K,N)}function D(K,N){var X;return!v(N)&&typeof N!="string"&&N!==void 0&&!K.objectMode&&(X=new TypeError("Invalid non-string/buffer chunk")),X}function q(K){return!K.ended&&(K.needReadable||K.length<K.highWaterMark||K.length===0)}M.prototype.isPaused=function(){return this._readableState.flowing===!1},M.prototype.setEncoding=function(K){return A||(A=nv().StringDecoder),this._readableState.decoder=new A(K),this._readableState.encoding=K,this};var k=8388608;function U(K){return K>=k?K=k:(K--,K|=K>>>1,K|=K>>>2,K|=K>>>4,K|=K>>>8,K|=K>>>16,K++),K}function O(K,N){return K<=0||N.length===0&&N.ended?0:N.objectMode?1:K!==K?N.flowing&&N.length?N.buffer.head.data.length:N.length:(K>N.highWaterMark&&(N.highWaterMark=U(K)),K<=N.length?K:N.ended?N.length:(N.needReadable=!0,0))}M.prototype.read=function(K){g("read",K),K=parseInt(K,10);var N=this._readableState,X=K;if(K!==0&&(N.emittedReadable=!1),K===0&&N.needReadable&&(N.length>=N.highWaterMark||N.ended))return g("read: emitReadable",N.length,N.ended),N.length===0&&N.ended?W(this):E(this),null;if(K=O(K,N),K===0&&N.ended)return N.length===0&&W(this),null;var Q=N.needReadable;g("need readable",Q),(N.length===0||N.length-K<N.highWaterMark)&&(Q=!0,g("length less than watermark",Q)),N.ended||N.reading?(Q=!1,g("reading or ended",Q)):Q&&(g("do read"),N.reading=!0,N.sync=!0,N.length===0&&(N.needReadable=!0),this._read(N.highWaterMark),N.sync=!1,N.reading||(K=O(X,N)));var L;return K>0?L=f(K,N):L=null,L===null?(N.needReadable=!0,K=0):N.length-=K,N.length===0&&(N.ended||(N.needReadable=!0),X!==K&&N.ended&&W(this)),L!==null&&this.emit("data",L),L};function G(K,N){if(!N.ended){if(N.decoder){var X=N.decoder.end();X&&X.length&&(N.buffer.push(X),N.length+=N.objectMode?1:X.length)}N.ended=!0,E(K)}}function E(K){var N=K._readableState;N.needReadable=!1,N.emittedReadable||(g("emitReadable",N.flowing),N.emittedReadable=!0,N.sync?i.nextTick(s,K):s(K))}function s(K){g("emit readable"),K.emit("readable"),b(K)}function l(K,N){N.readingMore||(N.readingMore=!0,i.nextTick(d,K,N))}function d(K,N){for(var X=N.length;!N.reading&&!N.flowing&&!N.ended&&N.length<N.highWaterMark&&(g("maybeReadMore read 0"),K.read(0),X!==N.length);)X=N.length;N.readingMore=!1}M.prototype._read=function(K){this.emit("error",new Error("_read() is not implemented"))},M.prototype.pipe=function(K,N){var X=this,Q=this._readableState;switch(Q.pipesCount){case 0:Q.pipes=K;break;case 1:Q.pipes=[Q.pipes,K];break;default:Q.pipes.push(K);break}Q.pipesCount+=1,g("pipe count=%d opts=%j",Q.pipesCount,N);var L=(!N||N.end!==!1)&&K!==process.stdout&&K!==process.stderr,V=L?H:Ut;Q.endEmitted?i.nextTick(V):X.once("end",V),K.on("unpipe",Z);function Z(At,It){g("onunpipe"),At===X&&It&&It.hasUnpiped===!1&&(It.hasUnpiped=!0,nt())}function H(){g("onend"),K.end()}var j=p(X);K.on("drain",j);var et=!1;function nt(){g("cleanup"),K.removeListener("close",ot),K.removeListener("finish",pt),K.removeListener("drain",j),K.removeListener("error",vt),K.removeListener("unpipe",Z),X.removeListener("end",H),X.removeListener("end",Ut),X.removeListener("data",ft),et=!0,Q.awaitDrain&&(!K._writableState||K._writableState.needDrain)&&j()}var st=!1;X.on("data",ft);function ft(At){g("ondata"),st=!1;var It=K.write(At);It===!1&&!st&&((Q.pipesCount===1&&Q.pipes===K||Q.pipesCount>1&&I(Q.pipes,K)!==-1)&&!et&&(g("false write response, pause",Q.awaitDrain),Q.awaitDrain++,st=!0),X.pause())}function vt(At){g("onerror",At),Ut(),K.removeListener("error",vt),t(K,"error")===0&&K.emit("error",At)}T(K,"error",vt);function ot(){K.removeListener("finish",pt),Ut()}K.once("close",ot);function pt(){g("onfinish"),K.removeListener("close",ot),Ut()}K.once("finish",pt);function Ut(){g("unpipe"),X.unpipe(K)}return K.emit("pipe",X),Q.flowing||(g("pipe resume"),X.resume()),K};function p(K){return function(){var N=K._readableState;g("pipeOnDrain",N.awaitDrain),N.awaitDrain&&N.awaitDrain--,N.awaitDrain===0&&t(K,"data")&&(N.flowing=!0,b(K))}}M.prototype.unpipe=function(K){var N=this._readableState,X={hasUnpiped:!1};if(N.pipesCount===0)return this;if(N.pipesCount===1)return K&&K!==N.pipes?this:(K||(K=N.pipes),N.pipes=null,N.pipesCount=0,N.flowing=!1,K&&K.emit("unpipe",this,X),this);if(!K){var Q=N.pipes,L=N.pipesCount;N.pipes=null,N.pipesCount=0,N.flowing=!1;for(var V=0;V<L;V++)Q[V].emit("unpipe",this,{hasUnpiped:!1});return this}var Z=I(N.pipes,K);return Z===-1?this:(N.pipes.splice(Z,1),N.pipesCount-=1,N.pipesCount===1&&(N.pipes=N.pipes[0]),K.emit("unpipe",this,X),this)},M.prototype.on=function(K,N){var X=a.prototype.on.call(this,K,N);if(K==="data")this._readableState.flowing!==!1&&this.resume();else if(K==="readable"){var Q=this._readableState;!Q.endEmitted&&!Q.readableListening&&(Q.readableListening=Q.needReadable=!0,Q.emittedReadable=!1,Q.reading?Q.length&&E(this):i.nextTick(m,this))}return X},M.prototype.addListener=M.prototype.on;function m(K){g("readable nexttick read 0"),K.read(0)}M.prototype.resume=function(){var K=this._readableState;return K.flowing||(g("resume"),K.flowing=!0,w(this,K)),this};function w(K,N){N.resumeScheduled||(N.resumeScheduled=!0,i.nextTick(x,K,N))}function x(K,N){N.reading||(g("resume read 0"),K.read(0)),N.resumeScheduled=!1,N.awaitDrain=0,K.emit("resume"),b(K),N.flowing&&!N.reading&&K.read(0)}M.prototype.pause=function(){return g("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(g("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function b(K){var N=K._readableState;for(g("flow",N.flowing);N.flowing&&K.read()!==null;);}M.prototype.wrap=function(K){var N=this,X=this._readableState,Q=!1;K.on("end",function(){if(g("wrapped end"),X.decoder&&!X.ended){var Z=X.decoder.end();Z&&Z.length&&N.push(Z)}N.push(null)}),K.on("data",function(Z){if(g("wrapped data"),X.decoder&&(Z=X.decoder.write(Z)),!(X.objectMode&&Z==null)&&!(!X.objectMode&&(!Z||!Z.length))){var H=N.push(Z);H||(Q=!0,K.pause())}});for(var L in K)this[L]===void 0&&typeof K[L]=="function"&&(this[L]=function(Z){return function(){return K[Z].apply(K,arguments)}}(L));for(var V=0;V<S.length;V++)K.on(S[V],this.emit.bind(this,S[V]));return this._read=function(Z){g("wrapped _read",Z),Q&&(Q=!1,K.resume())},this},Object.defineProperty(M.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),M._fromList=f;function f(K,N){if(N.length===0)return null;var X;return N.objectMode?X=N.buffer.shift():!K||K>=N.length?(N.decoder?X=N.buffer.join(""):N.buffer.length===1?X=N.buffer.head.data:X=N.buffer.concat(N.length),N.buffer.clear()):X=C(K,N.buffer,N.decoder),X}function C(K,N,X){var Q;return K<N.head.data.length?(Q=N.head.data.slice(0,K),N.head.data=N.head.data.slice(K)):K===N.head.data.length?Q=N.shift():Q=X?F(K,N):z(K,N),Q}function F(K,N){var X=N.head,Q=1,L=X.data;for(K-=L.length;X=X.next;){var V=X.data,Z=K>V.length?V.length:K;if(Z===V.length?L+=V:L+=V.slice(0,K),K-=Z,K===0){Z===V.length?(++Q,X.next?N.head=X.next:N.head=N.tail=null):(N.head=X,X.data=V.slice(Z));break}++Q}return N.length-=Q,L}function z(K,N){var X=n.allocUnsafe(K),Q=N.head,L=1;for(Q.data.copy(X),K-=Q.data.length;Q=Q.next;){var V=Q.data,Z=K>V.length?V.length:K;if(V.copy(X,X.length-K,0,Z),K-=Z,K===0){Z===V.length?(++L,Q.next?N.head=Q.next:N.head=N.tail=null):(N.head=Q,Q.data=V.slice(Z));break}++L}return N.length-=L,X}function W(K){var N=K._readableState;if(N.length>0)throw new Error('"endReadable()" called on non-empty stream');N.endEmitted||(N.ended=!0,i.nextTick($,N,K))}function $(K,N){!K.endEmitted&&K.length===0&&(K.endEmitted=!0,N.readable=!1,N.emit("end"))}function I(K,N){for(var X=0,Q=K.length;X<Q;X++)if(K[X]===N)return X;return-1}return Nu}var ku,sv;function zy(){if(sv)return ku;sv=1,ku=t;var i=ms(),e=Object.create(Vo());e.inherits=De(),e.inherits(t,i);function r(c,u){var v=this._transformState;v.transforming=!1;var o=v.writecb;if(!o)return this.emit("error",new Error("write callback called multiple times"));v.writechunk=null,v.writecb=null,u!=null&&this.push(u),o(c);var h=this._readableState;h.reading=!1,(h.needReadable||h.length<h.highWaterMark)&&this._read(h.highWaterMark)}function t(c){if(!(this instanceof t))return new t(c);i.call(this,c),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",a)}function a(){var c=this;typeof this._flush=="function"?this._flush(function(u,v){n(c,u,v)}):n(this,null,null)}t.prototype.push=function(c,u){return this._transformState.needTransform=!1,i.prototype.push.call(this,c,u)},t.prototype._transform=function(c,u,v){throw new Error("_transform() is not implemented")},t.prototype._write=function(c,u,v){var o=this._transformState;if(o.writecb=v,o.writechunk=c,o.writeencoding=u,!o.transforming){var h=this._readableState;(o.needTransform||h.needReadable||h.length<h.highWaterMark)&&this._read(h.highWaterMark)}},t.prototype._read=function(c){var u=this._transformState;u.writechunk!==null&&u.writecb&&!u.transforming?(u.transforming=!0,this._transform(u.writechunk,u.writeencoding,u.afterTransform)):u.needTransform=!0},t.prototype._destroy=function(c,u){var v=this;i.prototype._destroy.call(this,c,function(o){u(o),v.emit("close")})};function n(c,u,v){if(u)return c.emit("error",u);if(v!=null&&c.push(v),c._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(c._transformState.transforming)throw new Error("Calling transform done when still transforming");return c.push(null)}return ku}var Pu,ov;function sw(){if(ov)return Pu;ov=1,Pu=r;var i=zy(),e=Object.create(Vo());e.inherits=De(),e.inherits(r,i);function r(t){if(!(this instanceof r))return new r(t);i.call(this,t)}return r.prototype._transform=function(t,a,n){n(null,t)},Pu}var fv;function ow(){return fv||(fv=1,function(i,e){e=i.exports=qy(),e.Stream=e,e.Readable=e,e.Writable=Fy(),e.Duplex=ms(),e.Transform=zy(),e.PassThrough=sw()}(wf,wf.exports)),wf.exports}var Zs={exports:{}},Vf={exports:{}};Vf.exports;var lv;function c1(){return lv||(lv=1,function(i){(function(e,r){function t(l,d){if(!l)throw new Error(d||"Assertion failed")}function a(l,d){l.super_=d;var p=function(){};p.prototype=d.prototype,l.prototype=new p,l.prototype.constructor=l}function n(l,d,p){if(n.isBN(l))return l;this.negative=0,this.words=null,this.length=0,this.red=null,l!==null&&((d==="le"||d==="be")&&(p=d,d=10),this._init(l||0,d||10,p||"be"))}typeof e=="object"?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=$i.Buffer}catch{}n.isBN=function(d){return d instanceof n?!0:d!==null&&typeof d=="object"&&d.constructor.wordSize===n.wordSize&&Array.isArray(d.words)},n.max=function(d,p){return d.cmp(p)>0?d:p},n.min=function(d,p){return d.cmp(p)<0?d:p},n.prototype._init=function(d,p,m){if(typeof d=="number")return this._initNumber(d,p,m);if(typeof d=="object")return this._initArray(d,p,m);p==="hex"&&(p=16),t(p===(p|0)&&p>=2&&p<=36),d=d.toString().replace(/\s+/g,"");var w=0;d[0]==="-"&&(w++,this.negative=1),w<d.length&&(p===16?this._parseHex(d,w,m):(this._parseBase(d,p,w),m==="le"&&this._initArray(this.toArray(),p,m)))},n.prototype._initNumber=function(d,p,m){d<0&&(this.negative=1,d=-d),d<67108864?(this.words=[d&67108863],this.length=1):d<4503599627370496?(this.words=[d&67108863,d/67108864&67108863],this.length=2):(t(d<9007199254740992),this.words=[d&67108863,d/67108864&67108863,1],this.length=3),m==="le"&&this._initArray(this.toArray(),p,m)},n.prototype._initArray=function(d,p,m){if(t(typeof d.length=="number"),d.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(d.length/3),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var x,b,f=0;if(m==="be")for(w=d.length-1,x=0;w>=0;w-=3)b=d[w]|d[w-1]<<8|d[w-2]<<16,this.words[x]|=b<<f&67108863,this.words[x+1]=b>>>26-f&67108863,f+=24,f>=26&&(f-=26,x++);else if(m==="le")for(w=0,x=0;w<d.length;w+=3)b=d[w]|d[w+1]<<8|d[w+2]<<16,this.words[x]|=b<<f&67108863,this.words[x+1]=b>>>26-f&67108863,f+=24,f>=26&&(f-=26,x++);return this._strip()};function u(l,d){var p=l.charCodeAt(d);if(p>=48&&p<=57)return p-48;if(p>=65&&p<=70)return p-55;if(p>=97&&p<=102)return p-87;t(!1,"Invalid character in "+l)}function v(l,d,p){var m=u(l,p);return p-1>=d&&(m|=u(l,p-1)<<4),m}n.prototype._parseHex=function(d,p,m){this.length=Math.ceil((d.length-p)/6),this.words=new Array(this.length);for(var w=0;w<this.length;w++)this.words[w]=0;var x=0,b=0,f;if(m==="be")for(w=d.length-1;w>=p;w-=2)f=v(d,p,w)<<x,this.words[b]|=f&67108863,x>=18?(x-=18,b+=1,this.words[b]|=f>>>26):x+=8;else{var C=d.length-p;for(w=C%2===0?p+1:p;w<d.length;w+=2)f=v(d,p,w)<<x,this.words[b]|=f&67108863,x>=18?(x-=18,b+=1,this.words[b]|=f>>>26):x+=8}this._strip()};function o(l,d,p,m){for(var w=0,x=0,b=Math.min(l.length,p),f=d;f<b;f++){var C=l.charCodeAt(f)-48;w*=m,C>=49?x=C-49+10:C>=17?x=C-17+10:x=C,t(C>=0&&x<m,"Invalid character"),w+=x}return w}n.prototype._parseBase=function(d,p,m){this.words=[0],this.length=1;for(var w=0,x=1;x<=67108863;x*=p)w++;w--,x=x/p|0;for(var b=d.length-m,f=b%w,C=Math.min(b,b-f)+m,F=0,z=m;z<C;z+=w)F=o(d,z,z+w,p),this.imuln(x),this.words[0]+F<67108864?this.words[0]+=F:this._iaddn(F);if(f!==0){var W=1;for(F=o(d,z,d.length,p),z=0;z<f;z++)W*=p;this.imuln(W),this.words[0]+F<67108864?this.words[0]+=F:this._iaddn(F)}this._strip()},n.prototype.copy=function(d){d.words=new Array(this.length);for(var p=0;p<this.length;p++)d.words[p]=this.words[p];d.length=this.length,d.negative=this.negative,d.red=this.red};function h(l,d){l.words=d.words,l.length=d.length,l.negative=d.negative,l.red=d.red}if(n.prototype._move=function(d){h(d,this)},n.prototype.clone=function(){var d=new n(null);return this.copy(d),d},n.prototype._expand=function(d){for(;this.length<d;)this.words[this.length++]=0;return this},n.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{n.prototype[Symbol.for("nodejs.util.inspect.custom")]=g}catch{n.prototype.inspect=g}else n.prototype.inspect=g;function g(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var y=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],_=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],A=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(d,p){d=d||10,p=p|0||1;var m;if(d===16||d==="hex"){m="";for(var w=0,x=0,b=0;b<this.length;b++){var f=this.words[b],C=((f<<w|x)&16777215).toString(16);x=f>>>24-w&16777215,w+=2,w>=26&&(w-=26,b--),x!==0||b!==this.length-1?m=y[6-C.length]+C+m:m=C+m}for(x!==0&&(m=x.toString(16)+m);m.length%p!==0;)m="0"+m;return this.negative!==0&&(m="-"+m),m}if(d===(d|0)&&d>=2&&d<=36){var F=_[d],z=A[d];m="";var W=this.clone();for(W.negative=0;!W.isZero();){var $=W.modrn(z).toString(d);W=W.idivn(z),W.isZero()?m=$+m:m=y[F-$.length]+$+m}for(this.isZero()&&(m="0"+m);m.length%p!==0;)m="0"+m;return this.negative!==0&&(m="-"+m),m}t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var d=this.words[0];return this.length===2?d+=this.words[1]*67108864:this.length===3&&this.words[2]===1?d+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-d:d},n.prototype.toJSON=function(){return this.toString(16,2)},c&&(n.prototype.toBuffer=function(d,p){return this.toArrayLike(c,d,p)}),n.prototype.toArray=function(d,p){return this.toArrayLike(Array,d,p)};var S=function(d,p){return d.allocUnsafe?d.allocUnsafe(p):new d(p)};n.prototype.toArrayLike=function(d,p,m){this._strip();var w=this.byteLength(),x=m||Math.max(1,w);t(w<=x,"byte array longer than desired length"),t(x>0,"Requested array length <= 0");var b=S(d,x),f=p==="le"?"LE":"BE";return this["_toArrayLike"+f](b,w),b},n.prototype._toArrayLikeLE=function(d,p){for(var m=0,w=0,x=0,b=0;x<this.length;x++){var f=this.words[x]<<b|w;d[m++]=f&255,m<d.length&&(d[m++]=f>>8&255),m<d.length&&(d[m++]=f>>16&255),b===6?(m<d.length&&(d[m++]=f>>24&255),w=0,b=0):(w=f>>>24,b+=2)}if(m<d.length)for(d[m++]=w;m<d.length;)d[m++]=0},n.prototype._toArrayLikeBE=function(d,p){for(var m=d.length-1,w=0,x=0,b=0;x<this.length;x++){var f=this.words[x]<<b|w;d[m--]=f&255,m>=0&&(d[m--]=f>>8&255),m>=0&&(d[m--]=f>>16&255),b===6?(m>=0&&(d[m--]=f>>24&255),w=0,b=0):(w=f>>>24,b+=2)}if(m>=0)for(d[m--]=w;m>=0;)d[m--]=0},Math.clz32?n.prototype._countBits=function(d){return 32-Math.clz32(d)}:n.prototype._countBits=function(d){var p=d,m=0;return p>=4096&&(m+=13,p>>>=13),p>=64&&(m+=7,p>>>=7),p>=8&&(m+=4,p>>>=4),p>=2&&(m+=2,p>>>=2),m+p},n.prototype._zeroBits=function(d){if(d===0)return 26;var p=d,m=0;return p&8191||(m+=13,p>>>=13),p&127||(m+=7,p>>>=7),p&15||(m+=4,p>>>=4),p&3||(m+=2,p>>>=2),p&1||m++,m},n.prototype.bitLength=function(){var d=this.words[this.length-1],p=this._countBits(d);return(this.length-1)*26+p};function T(l){for(var d=new Array(l.bitLength()),p=0;p<d.length;p++){var m=p/26|0,w=p%26;d[p]=l.words[m]>>>w&1}return d}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var d=0,p=0;p<this.length;p++){var m=this._zeroBits(this.words[p]);if(d+=m,m!==26)break}return d},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(d){return this.negative!==0?this.abs().inotn(d).iaddn(1):this.clone()},n.prototype.fromTwos=function(d){return this.testn(d-1)?this.notn(d).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(d){for(;this.length<d.length;)this.words[this.length++]=0;for(var p=0;p<d.length;p++)this.words[p]=this.words[p]|d.words[p];return this._strip()},n.prototype.ior=function(d){return t((this.negative|d.negative)===0),this.iuor(d)},n.prototype.or=function(d){return this.length>d.length?this.clone().ior(d):d.clone().ior(this)},n.prototype.uor=function(d){return this.length>d.length?this.clone().iuor(d):d.clone().iuor(this)},n.prototype.iuand=function(d){var p;this.length>d.length?p=d:p=this;for(var m=0;m<p.length;m++)this.words[m]=this.words[m]&d.words[m];return this.length=p.length,this._strip()},n.prototype.iand=function(d){return t((this.negative|d.negative)===0),this.iuand(d)},n.prototype.and=function(d){return this.length>d.length?this.clone().iand(d):d.clone().iand(this)},n.prototype.uand=function(d){return this.length>d.length?this.clone().iuand(d):d.clone().iuand(this)},n.prototype.iuxor=function(d){var p,m;this.length>d.length?(p=this,m=d):(p=d,m=this);for(var w=0;w<m.length;w++)this.words[w]=p.words[w]^m.words[w];if(this!==p)for(;w<p.length;w++)this.words[w]=p.words[w];return this.length=p.length,this._strip()},n.prototype.ixor=function(d){return t((this.negative|d.negative)===0),this.iuxor(d)},n.prototype.xor=function(d){return this.length>d.length?this.clone().ixor(d):d.clone().ixor(this)},n.prototype.uxor=function(d){return this.length>d.length?this.clone().iuxor(d):d.clone().iuxor(this)},n.prototype.inotn=function(d){t(typeof d=="number"&&d>=0);var p=Math.ceil(d/26)|0,m=d%26;this._expand(p),m>0&&p--;for(var w=0;w<p;w++)this.words[w]=~this.words[w]&67108863;return m>0&&(this.words[w]=~this.words[w]&67108863>>26-m),this._strip()},n.prototype.notn=function(d){return this.clone().inotn(d)},n.prototype.setn=function(d,p){t(typeof d=="number"&&d>=0);var m=d/26|0,w=d%26;return this._expand(m+1),p?this.words[m]=this.words[m]|1<<w:this.words[m]=this.words[m]&~(1<<w),this._strip()},n.prototype.iadd=function(d){var p;if(this.negative!==0&&d.negative===0)return this.negative=0,p=this.isub(d),this.negative^=1,this._normSign();if(this.negative===0&&d.negative!==0)return d.negative=0,p=this.isub(d),d.negative=1,p._normSign();var m,w;this.length>d.length?(m=this,w=d):(m=d,w=this);for(var x=0,b=0;b<w.length;b++)p=(m.words[b]|0)+(w.words[b]|0)+x,this.words[b]=p&67108863,x=p>>>26;for(;x!==0&&b<m.length;b++)p=(m.words[b]|0)+x,this.words[b]=p&67108863,x=p>>>26;if(this.length=m.length,x!==0)this.words[this.length]=x,this.length++;else if(m!==this)for(;b<m.length;b++)this.words[b]=m.words[b];return this},n.prototype.add=function(d){var p;return d.negative!==0&&this.negative===0?(d.negative=0,p=this.sub(d),d.negative^=1,p):d.negative===0&&this.negative!==0?(this.negative=0,p=d.sub(this),this.negative=1,p):this.length>d.length?this.clone().iadd(d):d.clone().iadd(this)},n.prototype.isub=function(d){if(d.negative!==0){d.negative=0;var p=this.iadd(d);return d.negative=1,p._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(d),this.negative=1,this._normSign();var m=this.cmp(d);if(m===0)return this.negative=0,this.length=1,this.words[0]=0,this;var w,x;m>0?(w=this,x=d):(w=d,x=this);for(var b=0,f=0;f<x.length;f++)p=(w.words[f]|0)-(x.words[f]|0)+b,b=p>>26,this.words[f]=p&67108863;for(;b!==0&&f<w.length;f++)p=(w.words[f]|0)+b,b=p>>26,this.words[f]=p&67108863;if(b===0&&f<w.length&&w!==this)for(;f<w.length;f++)this.words[f]=w.words[f];return this.length=Math.max(this.length,f),w!==this&&(this.negative=1),this._strip()},n.prototype.sub=function(d){return this.clone().isub(d)};function B(l,d,p){p.negative=d.negative^l.negative;var m=l.length+d.length|0;p.length=m,m=m-1|0;var w=l.words[0]|0,x=d.words[0]|0,b=w*x,f=b&67108863,C=b/67108864|0;p.words[0]=f;for(var F=1;F<m;F++){for(var z=C>>>26,W=C&67108863,$=Math.min(F,d.length-1),I=Math.max(0,F-l.length+1);I<=$;I++){var K=F-I|0;w=l.words[K]|0,x=d.words[I]|0,b=w*x+W,z+=b/67108864|0,W=b&67108863}p.words[F]=W|0,C=z|0}return C!==0?p.words[F]=C|0:p.length--,p._strip()}var M=function(d,p,m){var w=d.words,x=p.words,b=m.words,f=0,C,F,z,W=w[0]|0,$=W&8191,I=W>>>13,K=w[1]|0,N=K&8191,X=K>>>13,Q=w[2]|0,L=Q&8191,V=Q>>>13,Z=w[3]|0,H=Z&8191,j=Z>>>13,et=w[4]|0,nt=et&8191,st=et>>>13,ft=w[5]|0,vt=ft&8191,ot=ft>>>13,pt=w[6]|0,Ut=pt&8191,At=pt>>>13,It=w[7]|0,Jt=It&8191,at=It>>>13,J=w[8]|0,rt=J&8191,lt=J>>>13,gt=w[9]|0,Dt=gt&8191,ut=gt>>>13,Y=x[0]|0,tt=Y&8191,dt=Y>>>13,mt=x[1]|0,xt=mt&8191,bt=mt>>>13,_t=x[2]|0,Ht=_t&8191,St=_t>>>13,Mt=x[3]|0,jt=Mt&8191,Lt=Mt>>>13,Ft=x[4]|0,te=Ft&8191,Bt=Ft>>>13,Ot=x[5]|0,ie=Ot&8191,kt=Ot>>>13,qt=x[6]|0,ae=qt&8191,Rt=qt>>>13,zt=x[7]|0,he=zt&8191,Vt=zt>>>13,Qt=x[8]|0,ge=Qt&8191,Gt=Qt>>>13,$t=x[9]|0,pe=$t&8191,de=$t>>>13;m.negative=d.negative^p.negative,m.length=19,C=Math.imul($,tt),F=Math.imul($,dt),F=F+Math.imul(I,tt)|0,z=Math.imul(I,dt);var Ee=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,C=Math.imul(N,tt),F=Math.imul(N,dt),F=F+Math.imul(X,tt)|0,z=Math.imul(X,dt),C=C+Math.imul($,xt)|0,F=F+Math.imul($,bt)|0,F=F+Math.imul(I,xt)|0,z=z+Math.imul(I,bt)|0;var xe=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(xe>>>26)|0,xe&=67108863,C=Math.imul(L,tt),F=Math.imul(L,dt),F=F+Math.imul(V,tt)|0,z=Math.imul(V,dt),C=C+Math.imul(N,xt)|0,F=F+Math.imul(N,bt)|0,F=F+Math.imul(X,xt)|0,z=z+Math.imul(X,bt)|0,C=C+Math.imul($,Ht)|0,F=F+Math.imul($,St)|0,F=F+Math.imul(I,Ht)|0,z=z+Math.imul(I,St)|0;var Se=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(Se>>>26)|0,Se&=67108863,C=Math.imul(H,tt),F=Math.imul(H,dt),F=F+Math.imul(j,tt)|0,z=Math.imul(j,dt),C=C+Math.imul(L,xt)|0,F=F+Math.imul(L,bt)|0,F=F+Math.imul(V,xt)|0,z=z+Math.imul(V,bt)|0,C=C+Math.imul(N,Ht)|0,F=F+Math.imul(N,St)|0,F=F+Math.imul(X,Ht)|0,z=z+Math.imul(X,St)|0,C=C+Math.imul($,jt)|0,F=F+Math.imul($,Lt)|0,F=F+Math.imul(I,jt)|0,z=z+Math.imul(I,Lt)|0;var Be=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(Be>>>26)|0,Be&=67108863,C=Math.imul(nt,tt),F=Math.imul(nt,dt),F=F+Math.imul(st,tt)|0,z=Math.imul(st,dt),C=C+Math.imul(H,xt)|0,F=F+Math.imul(H,bt)|0,F=F+Math.imul(j,xt)|0,z=z+Math.imul(j,bt)|0,C=C+Math.imul(L,Ht)|0,F=F+Math.imul(L,St)|0,F=F+Math.imul(V,Ht)|0,z=z+Math.imul(V,St)|0,C=C+Math.imul(N,jt)|0,F=F+Math.imul(N,Lt)|0,F=F+Math.imul(X,jt)|0,z=z+Math.imul(X,Lt)|0,C=C+Math.imul($,te)|0,F=F+Math.imul($,Bt)|0,F=F+Math.imul(I,te)|0,z=z+Math.imul(I,Bt)|0;var Ne=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,C=Math.imul(vt,tt),F=Math.imul(vt,dt),F=F+Math.imul(ot,tt)|0,z=Math.imul(ot,dt),C=C+Math.imul(nt,xt)|0,F=F+Math.imul(nt,bt)|0,F=F+Math.imul(st,xt)|0,z=z+Math.imul(st,bt)|0,C=C+Math.imul(H,Ht)|0,F=F+Math.imul(H,St)|0,F=F+Math.imul(j,Ht)|0,z=z+Math.imul(j,St)|0,C=C+Math.imul(L,jt)|0,F=F+Math.imul(L,Lt)|0,F=F+Math.imul(V,jt)|0,z=z+Math.imul(V,Lt)|0,C=C+Math.imul(N,te)|0,F=F+Math.imul(N,Bt)|0,F=F+Math.imul(X,te)|0,z=z+Math.imul(X,Bt)|0,C=C+Math.imul($,ie)|0,F=F+Math.imul($,kt)|0,F=F+Math.imul(I,ie)|0,z=z+Math.imul(I,kt)|0;var qe=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(qe>>>26)|0,qe&=67108863,C=Math.imul(Ut,tt),F=Math.imul(Ut,dt),F=F+Math.imul(At,tt)|0,z=Math.imul(At,dt),C=C+Math.imul(vt,xt)|0,F=F+Math.imul(vt,bt)|0,F=F+Math.imul(ot,xt)|0,z=z+Math.imul(ot,bt)|0,C=C+Math.imul(nt,Ht)|0,F=F+Math.imul(nt,St)|0,F=F+Math.imul(st,Ht)|0,z=z+Math.imul(st,St)|0,C=C+Math.imul(H,jt)|0,F=F+Math.imul(H,Lt)|0,F=F+Math.imul(j,jt)|0,z=z+Math.imul(j,Lt)|0,C=C+Math.imul(L,te)|0,F=F+Math.imul(L,Bt)|0,F=F+Math.imul(V,te)|0,z=z+Math.imul(V,Bt)|0,C=C+Math.imul(N,ie)|0,F=F+Math.imul(N,kt)|0,F=F+Math.imul(X,ie)|0,z=z+Math.imul(X,kt)|0,C=C+Math.imul($,ae)|0,F=F+Math.imul($,Rt)|0,F=F+Math.imul(I,ae)|0,z=z+Math.imul(I,Rt)|0;var Xe=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,C=Math.imul(Jt,tt),F=Math.imul(Jt,dt),F=F+Math.imul(at,tt)|0,z=Math.imul(at,dt),C=C+Math.imul(Ut,xt)|0,F=F+Math.imul(Ut,bt)|0,F=F+Math.imul(At,xt)|0,z=z+Math.imul(At,bt)|0,C=C+Math.imul(vt,Ht)|0,F=F+Math.imul(vt,St)|0,F=F+Math.imul(ot,Ht)|0,z=z+Math.imul(ot,St)|0,C=C+Math.imul(nt,jt)|0,F=F+Math.imul(nt,Lt)|0,F=F+Math.imul(st,jt)|0,z=z+Math.imul(st,Lt)|0,C=C+Math.imul(H,te)|0,F=F+Math.imul(H,Bt)|0,F=F+Math.imul(j,te)|0,z=z+Math.imul(j,Bt)|0,C=C+Math.imul(L,ie)|0,F=F+Math.imul(L,kt)|0,F=F+Math.imul(V,ie)|0,z=z+Math.imul(V,kt)|0,C=C+Math.imul(N,ae)|0,F=F+Math.imul(N,Rt)|0,F=F+Math.imul(X,ae)|0,z=z+Math.imul(X,Rt)|0,C=C+Math.imul($,he)|0,F=F+Math.imul($,Vt)|0,F=F+Math.imul(I,he)|0,z=z+Math.imul(I,Vt)|0;var Ge=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,C=Math.imul(rt,tt),F=Math.imul(rt,dt),F=F+Math.imul(lt,tt)|0,z=Math.imul(lt,dt),C=C+Math.imul(Jt,xt)|0,F=F+Math.imul(Jt,bt)|0,F=F+Math.imul(at,xt)|0,z=z+Math.imul(at,bt)|0,C=C+Math.imul(Ut,Ht)|0,F=F+Math.imul(Ut,St)|0,F=F+Math.imul(At,Ht)|0,z=z+Math.imul(At,St)|0,C=C+Math.imul(vt,jt)|0,F=F+Math.imul(vt,Lt)|0,F=F+Math.imul(ot,jt)|0,z=z+Math.imul(ot,Lt)|0,C=C+Math.imul(nt,te)|0,F=F+Math.imul(nt,Bt)|0,F=F+Math.imul(st,te)|0,z=z+Math.imul(st,Bt)|0,C=C+Math.imul(H,ie)|0,F=F+Math.imul(H,kt)|0,F=F+Math.imul(j,ie)|0,z=z+Math.imul(j,kt)|0,C=C+Math.imul(L,ae)|0,F=F+Math.imul(L,Rt)|0,F=F+Math.imul(V,ae)|0,z=z+Math.imul(V,Rt)|0,C=C+Math.imul(N,he)|0,F=F+Math.imul(N,Vt)|0,F=F+Math.imul(X,he)|0,z=z+Math.imul(X,Vt)|0,C=C+Math.imul($,ge)|0,F=F+Math.imul($,Gt)|0,F=F+Math.imul(I,ge)|0,z=z+Math.imul(I,Gt)|0;var Je=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(Je>>>26)|0,Je&=67108863,C=Math.imul(Dt,tt),F=Math.imul(Dt,dt),F=F+Math.imul(ut,tt)|0,z=Math.imul(ut,dt),C=C+Math.imul(rt,xt)|0,F=F+Math.imul(rt,bt)|0,F=F+Math.imul(lt,xt)|0,z=z+Math.imul(lt,bt)|0,C=C+Math.imul(Jt,Ht)|0,F=F+Math.imul(Jt,St)|0,F=F+Math.imul(at,Ht)|0,z=z+Math.imul(at,St)|0,C=C+Math.imul(Ut,jt)|0,F=F+Math.imul(Ut,Lt)|0,F=F+Math.imul(At,jt)|0,z=z+Math.imul(At,Lt)|0,C=C+Math.imul(vt,te)|0,F=F+Math.imul(vt,Bt)|0,F=F+Math.imul(ot,te)|0,z=z+Math.imul(ot,Bt)|0,C=C+Math.imul(nt,ie)|0,F=F+Math.imul(nt,kt)|0,F=F+Math.imul(st,ie)|0,z=z+Math.imul(st,kt)|0,C=C+Math.imul(H,ae)|0,F=F+Math.imul(H,Rt)|0,F=F+Math.imul(j,ae)|0,z=z+Math.imul(j,Rt)|0,C=C+Math.imul(L,he)|0,F=F+Math.imul(L,Vt)|0,F=F+Math.imul(V,he)|0,z=z+Math.imul(V,Vt)|0,C=C+Math.imul(N,ge)|0,F=F+Math.imul(N,Gt)|0,F=F+Math.imul(X,ge)|0,z=z+Math.imul(X,Gt)|0,C=C+Math.imul($,pe)|0,F=F+Math.imul($,de)|0,F=F+Math.imul(I,pe)|0,z=z+Math.imul(I,de)|0;var ze=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(ze>>>26)|0,ze&=67108863,C=Math.imul(Dt,xt),F=Math.imul(Dt,bt),F=F+Math.imul(ut,xt)|0,z=Math.imul(ut,bt),C=C+Math.imul(rt,Ht)|0,F=F+Math.imul(rt,St)|0,F=F+Math.imul(lt,Ht)|0,z=z+Math.imul(lt,St)|0,C=C+Math.imul(Jt,jt)|0,F=F+Math.imul(Jt,Lt)|0,F=F+Math.imul(at,jt)|0,z=z+Math.imul(at,Lt)|0,C=C+Math.imul(Ut,te)|0,F=F+Math.imul(Ut,Bt)|0,F=F+Math.imul(At,te)|0,z=z+Math.imul(At,Bt)|0,C=C+Math.imul(vt,ie)|0,F=F+Math.imul(vt,kt)|0,F=F+Math.imul(ot,ie)|0,z=z+Math.imul(ot,kt)|0,C=C+Math.imul(nt,ae)|0,F=F+Math.imul(nt,Rt)|0,F=F+Math.imul(st,ae)|0,z=z+Math.imul(st,Rt)|0,C=C+Math.imul(H,he)|0,F=F+Math.imul(H,Vt)|0,F=F+Math.imul(j,he)|0,z=z+Math.imul(j,Vt)|0,C=C+Math.imul(L,ge)|0,F=F+Math.imul(L,Gt)|0,F=F+Math.imul(V,ge)|0,z=z+Math.imul(V,Gt)|0,C=C+Math.imul(N,pe)|0,F=F+Math.imul(N,de)|0,F=F+Math.imul(X,pe)|0,z=z+Math.imul(X,de)|0;var rr=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(rr>>>26)|0,rr&=67108863,C=Math.imul(Dt,Ht),F=Math.imul(Dt,St),F=F+Math.imul(ut,Ht)|0,z=Math.imul(ut,St),C=C+Math.imul(rt,jt)|0,F=F+Math.imul(rt,Lt)|0,F=F+Math.imul(lt,jt)|0,z=z+Math.imul(lt,Lt)|0,C=C+Math.imul(Jt,te)|0,F=F+Math.imul(Jt,Bt)|0,F=F+Math.imul(at,te)|0,z=z+Math.imul(at,Bt)|0,C=C+Math.imul(Ut,ie)|0,F=F+Math.imul(Ut,kt)|0,F=F+Math.imul(At,ie)|0,z=z+Math.imul(At,kt)|0,C=C+Math.imul(vt,ae)|0,F=F+Math.imul(vt,Rt)|0,F=F+Math.imul(ot,ae)|0,z=z+Math.imul(ot,Rt)|0,C=C+Math.imul(nt,he)|0,F=F+Math.imul(nt,Vt)|0,F=F+Math.imul(st,he)|0,z=z+Math.imul(st,Vt)|0,C=C+Math.imul(H,ge)|0,F=F+Math.imul(H,Gt)|0,F=F+Math.imul(j,ge)|0,z=z+Math.imul(j,Gt)|0,C=C+Math.imul(L,pe)|0,F=F+Math.imul(L,de)|0,F=F+Math.imul(V,pe)|0,z=z+Math.imul(V,de)|0;var Qe=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,C=Math.imul(Dt,jt),F=Math.imul(Dt,Lt),F=F+Math.imul(ut,jt)|0,z=Math.imul(ut,Lt),C=C+Math.imul(rt,te)|0,F=F+Math.imul(rt,Bt)|0,F=F+Math.imul(lt,te)|0,z=z+Math.imul(lt,Bt)|0,C=C+Math.imul(Jt,ie)|0,F=F+Math.imul(Jt,kt)|0,F=F+Math.imul(at,ie)|0,z=z+Math.imul(at,kt)|0,C=C+Math.imul(Ut,ae)|0,F=F+Math.imul(Ut,Rt)|0,F=F+Math.imul(At,ae)|0,z=z+Math.imul(At,Rt)|0,C=C+Math.imul(vt,he)|0,F=F+Math.imul(vt,Vt)|0,F=F+Math.imul(ot,he)|0,z=z+Math.imul(ot,Vt)|0,C=C+Math.imul(nt,ge)|0,F=F+Math.imul(nt,Gt)|0,F=F+Math.imul(st,ge)|0,z=z+Math.imul(st,Gt)|0,C=C+Math.imul(H,pe)|0,F=F+Math.imul(H,de)|0,F=F+Math.imul(j,pe)|0,z=z+Math.imul(j,de)|0;var Le=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(Le>>>26)|0,Le&=67108863,C=Math.imul(Dt,te),F=Math.imul(Dt,Bt),F=F+Math.imul(ut,te)|0,z=Math.imul(ut,Bt),C=C+Math.imul(rt,ie)|0,F=F+Math.imul(rt,kt)|0,F=F+Math.imul(lt,ie)|0,z=z+Math.imul(lt,kt)|0,C=C+Math.imul(Jt,ae)|0,F=F+Math.imul(Jt,Rt)|0,F=F+Math.imul(at,ae)|0,z=z+Math.imul(at,Rt)|0,C=C+Math.imul(Ut,he)|0,F=F+Math.imul(Ut,Vt)|0,F=F+Math.imul(At,he)|0,z=z+Math.imul(At,Vt)|0,C=C+Math.imul(vt,ge)|0,F=F+Math.imul(vt,Gt)|0,F=F+Math.imul(ot,ge)|0,z=z+Math.imul(ot,Gt)|0,C=C+Math.imul(nt,pe)|0,F=F+Math.imul(nt,de)|0,F=F+Math.imul(st,pe)|0,z=z+Math.imul(st,de)|0;var ir=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(ir>>>26)|0,ir&=67108863,C=Math.imul(Dt,ie),F=Math.imul(Dt,kt),F=F+Math.imul(ut,ie)|0,z=Math.imul(ut,kt),C=C+Math.imul(rt,ae)|0,F=F+Math.imul(rt,Rt)|0,F=F+Math.imul(lt,ae)|0,z=z+Math.imul(lt,Rt)|0,C=C+Math.imul(Jt,he)|0,F=F+Math.imul(Jt,Vt)|0,F=F+Math.imul(at,he)|0,z=z+Math.imul(at,Vt)|0,C=C+Math.imul(Ut,ge)|0,F=F+Math.imul(Ut,Gt)|0,F=F+Math.imul(At,ge)|0,z=z+Math.imul(At,Gt)|0,C=C+Math.imul(vt,pe)|0,F=F+Math.imul(vt,de)|0,F=F+Math.imul(ot,pe)|0,z=z+Math.imul(ot,de)|0;var nr=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(nr>>>26)|0,nr&=67108863,C=Math.imul(Dt,ae),F=Math.imul(Dt,Rt),F=F+Math.imul(ut,ae)|0,z=Math.imul(ut,Rt),C=C+Math.imul(rt,he)|0,F=F+Math.imul(rt,Vt)|0,F=F+Math.imul(lt,he)|0,z=z+Math.imul(lt,Vt)|0,C=C+Math.imul(Jt,ge)|0,F=F+Math.imul(Jt,Gt)|0,F=F+Math.imul(at,ge)|0,z=z+Math.imul(at,Gt)|0,C=C+Math.imul(Ut,pe)|0,F=F+Math.imul(Ut,de)|0,F=F+Math.imul(At,pe)|0,z=z+Math.imul(At,de)|0;var Ze=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,C=Math.imul(Dt,he),F=Math.imul(Dt,Vt),F=F+Math.imul(ut,he)|0,z=Math.imul(ut,Vt),C=C+Math.imul(rt,ge)|0,F=F+Math.imul(rt,Gt)|0,F=F+Math.imul(lt,ge)|0,z=z+Math.imul(lt,Gt)|0,C=C+Math.imul(Jt,pe)|0,F=F+Math.imul(Jt,de)|0,F=F+Math.imul(at,pe)|0,z=z+Math.imul(at,de)|0;var ar=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(ar>>>26)|0,ar&=67108863,C=Math.imul(Dt,ge),F=Math.imul(Dt,Gt),F=F+Math.imul(ut,ge)|0,z=Math.imul(ut,Gt),C=C+Math.imul(rt,pe)|0,F=F+Math.imul(rt,de)|0,F=F+Math.imul(lt,pe)|0,z=z+Math.imul(lt,de)|0;var yt=(f+C|0)+((F&8191)<<13)|0;f=(z+(F>>>13)|0)+(yt>>>26)|0,yt&=67108863,C=Math.imul(Dt,pe),F=Math.imul(Dt,de),F=F+Math.imul(ut,pe)|0,z=Math.imul(ut,de);var it=(f+C|0)+((F&8191)<<13)|0;return f=(z+(F>>>13)|0)+(it>>>26)|0,it&=67108863,b[0]=Ee,b[1]=xe,b[2]=Se,b[3]=Be,b[4]=Ne,b[5]=qe,b[6]=Xe,b[7]=Ge,b[8]=Je,b[9]=ze,b[10]=rr,b[11]=Qe,b[12]=Le,b[13]=ir,b[14]=nr,b[15]=Ze,b[16]=ar,b[17]=yt,b[18]=it,f!==0&&(b[19]=f,m.length++),m};Math.imul||(M=B);function R(l,d,p){p.negative=d.negative^l.negative,p.length=l.length+d.length;for(var m=0,w=0,x=0;x<p.length-1;x++){var b=w;w=0;for(var f=m&67108863,C=Math.min(x,d.length-1),F=Math.max(0,x-l.length+1);F<=C;F++){var z=x-F,W=l.words[z]|0,$=d.words[F]|0,I=W*$,K=I&67108863;b=b+(I/67108864|0)|0,K=K+f|0,f=K&67108863,b=b+(K>>>26)|0,w+=b>>>26,b&=67108863}p.words[x]=f,m=b,b=w}return m!==0?p.words[x]=m:p.length--,p._strip()}function P(l,d,p){return R(l,d,p)}n.prototype.mulTo=function(d,p){var m,w=this.length+d.length;return this.length===10&&d.length===10?m=M(this,d,p):w<63?m=B(this,d,p):w<1024?m=R(this,d,p):m=P(this,d,p),m},n.prototype.mul=function(d){var p=new n(null);return p.words=new Array(this.length+d.length),this.mulTo(d,p)},n.prototype.mulf=function(d){var p=new n(null);return p.words=new Array(this.length+d.length),P(this,d,p)},n.prototype.imul=function(d){return this.clone().mulTo(d,this)},n.prototype.imuln=function(d){var p=d<0;p&&(d=-d),t(typeof d=="number"),t(d<67108864);for(var m=0,w=0;w<this.length;w++){var x=(this.words[w]|0)*d,b=(x&67108863)+(m&67108863);m>>=26,m+=x/67108864|0,m+=b>>>26,this.words[w]=b&67108863}return m!==0&&(this.words[w]=m,this.length++),p?this.ineg():this},n.prototype.muln=function(d){return this.clone().imuln(d)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(d){var p=T(d);if(p.length===0)return new n(1);for(var m=this,w=0;w<p.length&&p[w]===0;w++,m=m.sqr());if(++w<p.length)for(var x=m.sqr();w<p.length;w++,x=x.sqr())p[w]!==0&&(m=m.mul(x));return m},n.prototype.iushln=function(d){t(typeof d=="number"&&d>=0);var p=d%26,m=(d-p)/26,w=67108863>>>26-p<<26-p,x;if(p!==0){var b=0;for(x=0;x<this.length;x++){var f=this.words[x]&w,C=(this.words[x]|0)-f<<p;this.words[x]=C|b,b=f>>>26-p}b&&(this.words[x]=b,this.length++)}if(m!==0){for(x=this.length-1;x>=0;x--)this.words[x+m]=this.words[x];for(x=0;x<m;x++)this.words[x]=0;this.length+=m}return this._strip()},n.prototype.ishln=function(d){return t(this.negative===0),this.iushln(d)},n.prototype.iushrn=function(d,p,m){t(typeof d=="number"&&d>=0);var w;p?w=(p-p%26)/26:w=0;var x=d%26,b=Math.min((d-x)/26,this.length),f=67108863^67108863>>>x<<x,C=m;if(w-=b,w=Math.max(0,w),C){for(var F=0;F<b;F++)C.words[F]=this.words[F];C.length=b}if(b!==0)if(this.length>b)for(this.length-=b,F=0;F<this.length;F++)this.words[F]=this.words[F+b];else this.words[0]=0,this.length=1;var z=0;for(F=this.length-1;F>=0&&(z!==0||F>=w);F--){var W=this.words[F]|0;this.words[F]=z<<26-x|W>>>x,z=W&f}return C&&z!==0&&(C.words[C.length++]=z),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},n.prototype.ishrn=function(d,p,m){return t(this.negative===0),this.iushrn(d,p,m)},n.prototype.shln=function(d){return this.clone().ishln(d)},n.prototype.ushln=function(d){return this.clone().iushln(d)},n.prototype.shrn=function(d){return this.clone().ishrn(d)},n.prototype.ushrn=function(d){return this.clone().iushrn(d)},n.prototype.testn=function(d){t(typeof d=="number"&&d>=0);var p=d%26,m=(d-p)/26,w=1<<p;if(this.length<=m)return!1;var x=this.words[m];return!!(x&w)},n.prototype.imaskn=function(d){t(typeof d=="number"&&d>=0);var p=d%26,m=(d-p)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=m)return this;if(p!==0&&m++,this.length=Math.min(m,this.length),p!==0){var w=67108863^67108863>>>p<<p;this.words[this.length-1]&=w}return this._strip()},n.prototype.maskn=function(d){return this.clone().imaskn(d)},n.prototype.iaddn=function(d){return t(typeof d=="number"),t(d<67108864),d<0?this.isubn(-d):this.negative!==0?this.length===1&&(this.words[0]|0)<=d?(this.words[0]=d-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(d),this.negative=1,this):this._iaddn(d)},n.prototype._iaddn=function(d){this.words[0]+=d;for(var p=0;p<this.length&&this.words[p]>=67108864;p++)this.words[p]-=67108864,p===this.length-1?this.words[p+1]=1:this.words[p+1]++;return this.length=Math.max(this.length,p+1),this},n.prototype.isubn=function(d){if(t(typeof d=="number"),t(d<67108864),d<0)return this.iaddn(-d);if(this.negative!==0)return this.negative=0,this.iaddn(d),this.negative=1,this;if(this.words[0]-=d,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var p=0;p<this.length&&this.words[p]<0;p++)this.words[p]+=67108864,this.words[p+1]-=1;return this._strip()},n.prototype.addn=function(d){return this.clone().iaddn(d)},n.prototype.subn=function(d){return this.clone().isubn(d)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(d,p,m){var w=d.length+m,x;this._expand(w);var b,f=0;for(x=0;x<d.length;x++){b=(this.words[x+m]|0)+f;var C=(d.words[x]|0)*p;b-=C&67108863,f=(b>>26)-(C/67108864|0),this.words[x+m]=b&67108863}for(;x<this.length-m;x++)b=(this.words[x+m]|0)+f,f=b>>26,this.words[x+m]=b&67108863;if(f===0)return this._strip();for(t(f===-1),f=0,x=0;x<this.length;x++)b=-(this.words[x]|0)+f,f=b>>26,this.words[x]=b&67108863;return this.negative=1,this._strip()},n.prototype._wordDiv=function(d,p){var m=this.length-d.length,w=this.clone(),x=d,b=x.words[x.length-1]|0,f=this._countBits(b);m=26-f,m!==0&&(x=x.ushln(m),w.iushln(m),b=x.words[x.length-1]|0);var C=w.length-x.length,F;if(p!=="mod"){F=new n(null),F.length=C+1,F.words=new Array(F.length);for(var z=0;z<F.length;z++)F.words[z]=0}var W=w.clone()._ishlnsubmul(x,1,C);W.negative===0&&(w=W,F&&(F.words[C]=1));for(var $=C-1;$>=0;$--){var I=(w.words[x.length+$]|0)*67108864+(w.words[x.length+$-1]|0);for(I=Math.min(I/b|0,67108863),w._ishlnsubmul(x,I,$);w.negative!==0;)I--,w.negative=0,w._ishlnsubmul(x,1,$),w.isZero()||(w.negative^=1);F&&(F.words[$]=I)}return F&&F._strip(),w._strip(),p!=="div"&&m!==0&&w.iushrn(m),{div:F||null,mod:w}},n.prototype.divmod=function(d,p,m){if(t(!d.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var w,x,b;return this.negative!==0&&d.negative===0?(b=this.neg().divmod(d,p),p!=="mod"&&(w=b.div.neg()),p!=="div"&&(x=b.mod.neg(),m&&x.negative!==0&&x.iadd(d)),{div:w,mod:x}):this.negative===0&&d.negative!==0?(b=this.divmod(d.neg(),p),p!=="mod"&&(w=b.div.neg()),{div:w,mod:b.mod}):this.negative&d.negative?(b=this.neg().divmod(d.neg(),p),p!=="div"&&(x=b.mod.neg(),m&&x.negative!==0&&x.isub(d)),{div:b.div,mod:x}):d.length>this.length||this.cmp(d)<0?{div:new n(0),mod:this}:d.length===1?p==="div"?{div:this.divn(d.words[0]),mod:null}:p==="mod"?{div:null,mod:new n(this.modrn(d.words[0]))}:{div:this.divn(d.words[0]),mod:new n(this.modrn(d.words[0]))}:this._wordDiv(d,p)},n.prototype.div=function(d){return this.divmod(d,"div",!1).div},n.prototype.mod=function(d){return this.divmod(d,"mod",!1).mod},n.prototype.umod=function(d){return this.divmod(d,"mod",!0).mod},n.prototype.divRound=function(d){var p=this.divmod(d);if(p.mod.isZero())return p.div;var m=p.div.negative!==0?p.mod.isub(d):p.mod,w=d.ushrn(1),x=d.andln(1),b=m.cmp(w);return b<0||x===1&&b===0?p.div:p.div.negative!==0?p.div.isubn(1):p.div.iaddn(1)},n.prototype.modrn=function(d){var p=d<0;p&&(d=-d),t(d<=67108863);for(var m=(1<<26)%d,w=0,x=this.length-1;x>=0;x--)w=(m*w+(this.words[x]|0))%d;return p?-w:w},n.prototype.modn=function(d){return this.modrn(d)},n.prototype.idivn=function(d){var p=d<0;p&&(d=-d),t(d<=67108863);for(var m=0,w=this.length-1;w>=0;w--){var x=(this.words[w]|0)+m*67108864;this.words[w]=x/d|0,m=x%d}return this._strip(),p?this.ineg():this},n.prototype.divn=function(d){return this.clone().idivn(d)},n.prototype.egcd=function(d){t(d.negative===0),t(!d.isZero());var p=this,m=d.clone();p.negative!==0?p=p.umod(d):p=p.clone();for(var w=new n(1),x=new n(0),b=new n(0),f=new n(1),C=0;p.isEven()&&m.isEven();)p.iushrn(1),m.iushrn(1),++C;for(var F=m.clone(),z=p.clone();!p.isZero();){for(var W=0,$=1;!(p.words[0]&$)&&W<26;++W,$<<=1);if(W>0)for(p.iushrn(W);W-- >0;)(w.isOdd()||x.isOdd())&&(w.iadd(F),x.isub(z)),w.iushrn(1),x.iushrn(1);for(var I=0,K=1;!(m.words[0]&K)&&I<26;++I,K<<=1);if(I>0)for(m.iushrn(I);I-- >0;)(b.isOdd()||f.isOdd())&&(b.iadd(F),f.isub(z)),b.iushrn(1),f.iushrn(1);p.cmp(m)>=0?(p.isub(m),w.isub(b),x.isub(f)):(m.isub(p),b.isub(w),f.isub(x))}return{a:b,b:f,gcd:m.iushln(C)}},n.prototype._invmp=function(d){t(d.negative===0),t(!d.isZero());var p=this,m=d.clone();p.negative!==0?p=p.umod(d):p=p.clone();for(var w=new n(1),x=new n(0),b=m.clone();p.cmpn(1)>0&&m.cmpn(1)>0;){for(var f=0,C=1;!(p.words[0]&C)&&f<26;++f,C<<=1);if(f>0)for(p.iushrn(f);f-- >0;)w.isOdd()&&w.iadd(b),w.iushrn(1);for(var F=0,z=1;!(m.words[0]&z)&&F<26;++F,z<<=1);if(F>0)for(m.iushrn(F);F-- >0;)x.isOdd()&&x.iadd(b),x.iushrn(1);p.cmp(m)>=0?(p.isub(m),w.isub(x)):(m.isub(p),x.isub(w))}var W;return p.cmpn(1)===0?W=w:W=x,W.cmpn(0)<0&&W.iadd(d),W},n.prototype.gcd=function(d){if(this.isZero())return d.abs();if(d.isZero())return this.abs();var p=this.clone(),m=d.clone();p.negative=0,m.negative=0;for(var w=0;p.isEven()&&m.isEven();w++)p.iushrn(1),m.iushrn(1);do{for(;p.isEven();)p.iushrn(1);for(;m.isEven();)m.iushrn(1);var x=p.cmp(m);if(x<0){var b=p;p=m,m=b}else if(x===0||m.cmpn(1)===0)break;p.isub(m)}while(!0);return m.iushln(w)},n.prototype.invm=function(d){return this.egcd(d).a.umod(d)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(d){return this.words[0]&d},n.prototype.bincn=function(d){t(typeof d=="number");var p=d%26,m=(d-p)/26,w=1<<p;if(this.length<=m)return this._expand(m+1),this.words[m]|=w,this;for(var x=w,b=m;x!==0&&b<this.length;b++){var f=this.words[b]|0;f+=x,x=f>>>26,f&=67108863,this.words[b]=f}return x!==0&&(this.words[b]=x,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(d){var p=d<0;if(this.negative!==0&&!p)return-1;if(this.negative===0&&p)return 1;this._strip();var m;if(this.length>1)m=1;else{p&&(d=-d),t(d<=67108863,"Number is too big");var w=this.words[0]|0;m=w===d?0:w<d?-1:1}return this.negative!==0?-m|0:m},n.prototype.cmp=function(d){if(this.negative!==0&&d.negative===0)return-1;if(this.negative===0&&d.negative!==0)return 1;var p=this.ucmp(d);return this.negative!==0?-p|0:p},n.prototype.ucmp=function(d){if(this.length>d.length)return 1;if(this.length<d.length)return-1;for(var p=0,m=this.length-1;m>=0;m--){var w=this.words[m]|0,x=d.words[m]|0;if(w!==x){w<x?p=-1:w>x&&(p=1);break}}return p},n.prototype.gtn=function(d){return this.cmpn(d)===1},n.prototype.gt=function(d){return this.cmp(d)===1},n.prototype.gten=function(d){return this.cmpn(d)>=0},n.prototype.gte=function(d){return this.cmp(d)>=0},n.prototype.ltn=function(d){return this.cmpn(d)===-1},n.prototype.lt=function(d){return this.cmp(d)===-1},n.prototype.lten=function(d){return this.cmpn(d)<=0},n.prototype.lte=function(d){return this.cmp(d)<=0},n.prototype.eqn=function(d){return this.cmpn(d)===0},n.prototype.eq=function(d){return this.cmp(d)===0},n.red=function(d){return new E(d)},n.prototype.toRed=function(d){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),d.convertTo(this)._forceRed(d)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(d){return this.red=d,this},n.prototype.forceRed=function(d){return t(!this.red,"Already a number in reduction context"),this._forceRed(d)},n.prototype.redAdd=function(d){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,d)},n.prototype.redIAdd=function(d){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,d)},n.prototype.redSub=function(d){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,d)},n.prototype.redISub=function(d){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,d)},n.prototype.redShl=function(d){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,d)},n.prototype.redMul=function(d){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,d),this.red.mul(this,d)},n.prototype.redIMul=function(d){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,d),this.red.imul(this,d)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(d){return t(this.red&&!d.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,d)};var D={k256:null,p224:null,p192:null,p25519:null};function q(l,d){this.name=l,this.p=new n(d,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}q.prototype._tmp=function(){var d=new n(null);return d.words=new Array(Math.ceil(this.n/13)),d},q.prototype.ireduce=function(d){var p=d,m;do this.split(p,this.tmp),p=this.imulK(p),p=p.iadd(this.tmp),m=p.bitLength();while(m>this.n);var w=m<this.n?-1:p.ucmp(this.p);return w===0?(p.words[0]=0,p.length=1):w>0?p.isub(this.p):p.strip!==void 0?p.strip():p._strip(),p},q.prototype.split=function(d,p){d.iushrn(this.n,0,p)},q.prototype.imulK=function(d){return d.imul(this.k)};function k(){q.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(k,q),k.prototype.split=function(d,p){for(var m=4194303,w=Math.min(d.length,9),x=0;x<w;x++)p.words[x]=d.words[x];if(p.length=w,d.length<=9){d.words[0]=0,d.length=1;return}var b=d.words[9];for(p.words[p.length++]=b&m,x=10;x<d.length;x++){var f=d.words[x]|0;d.words[x-10]=(f&m)<<4|b>>>22,b=f}b>>>=22,d.words[x-10]=b,b===0&&d.length>10?d.length-=10:d.length-=9},k.prototype.imulK=function(d){d.words[d.length]=0,d.words[d.length+1]=0,d.length+=2;for(var p=0,m=0;m<d.length;m++){var w=d.words[m]|0;p+=w*977,d.words[m]=p&67108863,p=w*64+(p/67108864|0)}return d.words[d.length-1]===0&&(d.length--,d.words[d.length-1]===0&&d.length--),d};function U(){q.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(U,q);function O(){q.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(O,q);function G(){q.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(G,q),G.prototype.imulK=function(d){for(var p=0,m=0;m<d.length;m++){var w=(d.words[m]|0)*19+p,x=w&67108863;w>>>=26,d.words[m]=x,p=w}return p!==0&&(d.words[d.length++]=p),d},n._prime=function(d){if(D[d])return D[d];var p;if(d==="k256")p=new k;else if(d==="p224")p=new U;else if(d==="p192")p=new O;else if(d==="p25519")p=new G;else throw new Error("Unknown prime "+d);return D[d]=p,p};function E(l){if(typeof l=="string"){var d=n._prime(l);this.m=d.p,this.prime=d}else t(l.gtn(1),"modulus must be greater than 1"),this.m=l,this.prime=null}E.prototype._verify1=function(d){t(d.negative===0,"red works only with positives"),t(d.red,"red works only with red numbers")},E.prototype._verify2=function(d,p){t((d.negative|p.negative)===0,"red works only with positives"),t(d.red&&d.red===p.red,"red works only with red numbers")},E.prototype.imod=function(d){return this.prime?this.prime.ireduce(d)._forceRed(this):(h(d,d.umod(this.m)._forceRed(this)),d)},E.prototype.neg=function(d){return d.isZero()?d.clone():this.m.sub(d)._forceRed(this)},E.prototype.add=function(d,p){this._verify2(d,p);var m=d.add(p);return m.cmp(this.m)>=0&&m.isub(this.m),m._forceRed(this)},E.prototype.iadd=function(d,p){this._verify2(d,p);var m=d.iadd(p);return m.cmp(this.m)>=0&&m.isub(this.m),m},E.prototype.sub=function(d,p){this._verify2(d,p);var m=d.sub(p);return m.cmpn(0)<0&&m.iadd(this.m),m._forceRed(this)},E.prototype.isub=function(d,p){this._verify2(d,p);var m=d.isub(p);return m.cmpn(0)<0&&m.iadd(this.m),m},E.prototype.shl=function(d,p){return this._verify1(d),this.imod(d.ushln(p))},E.prototype.imul=function(d,p){return this._verify2(d,p),this.imod(d.imul(p))},E.prototype.mul=function(d,p){return this._verify2(d,p),this.imod(d.mul(p))},E.prototype.isqr=function(d){return this.imul(d,d.clone())},E.prototype.sqr=function(d){return this.mul(d,d)},E.prototype.sqrt=function(d){if(d.isZero())return d.clone();var p=this.m.andln(3);if(t(p%2===1),p===3){var m=this.m.add(new n(1)).iushrn(2);return this.pow(d,m)}for(var w=this.m.subn(1),x=0;!w.isZero()&&w.andln(1)===0;)x++,w.iushrn(1);t(!w.isZero());var b=new n(1).toRed(this),f=b.redNeg(),C=this.m.subn(1).iushrn(1),F=this.m.bitLength();for(F=new n(2*F*F).toRed(this);this.pow(F,C).cmp(f)!==0;)F.redIAdd(f);for(var z=this.pow(F,w),W=this.pow(d,w.addn(1).iushrn(1)),$=this.pow(d,w),I=x;$.cmp(b)!==0;){for(var K=$,N=0;K.cmp(b)!==0;N++)K=K.redSqr();t(N<I);var X=this.pow(z,new n(1).iushln(I-N-1));W=W.redMul(X),z=X.redSqr(),$=$.redMul(z),I=N}return W},E.prototype.invm=function(d){var p=d._invmp(this.m);return p.negative!==0?(p.negative=0,this.imod(p).redNeg()):this.imod(p)},E.prototype.pow=function(d,p){if(p.isZero())return new n(1).toRed(this);if(p.cmpn(1)===0)return d.clone();var m=4,w=new Array(1<<m);w[0]=new n(1).toRed(this),w[1]=d;for(var x=2;x<w.length;x++)w[x]=this.mul(w[x-1],d);var b=w[0],f=0,C=0,F=p.bitLength()%26;for(F===0&&(F=26),x=p.length-1;x>=0;x--){for(var z=p.words[x],W=F-1;W>=0;W--){var $=z>>W&1;if(b!==w[0]&&(b=this.sqr(b)),$===0&&f===0){C=0;continue}f<<=1,f|=$,C++,!(C!==m&&(x!==0||W!==0))&&(b=this.mul(b,w[f]),C=0,f=0)}F=26}return b},E.prototype.convertTo=function(d){var p=d.umod(this.m);return p===d?p.clone():p},E.prototype.convertFrom=function(d){var p=d.clone();return p.red=null,p},n.mont=function(d){return new s(d)};function s(l){E.call(this,l),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(s,E),s.prototype.convertTo=function(d){return this.imod(d.ushln(this.shift))},s.prototype.convertFrom=function(d){var p=this.imod(d.mul(this.rinv));return p.red=null,p},s.prototype.imul=function(d,p){if(d.isZero()||p.isZero())return d.words[0]=0,d.length=1,d;var m=d.imul(p),w=m.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=m.isub(w).iushrn(this.shift),b=x;return x.cmp(this.m)>=0?b=x.isub(this.m):x.cmpn(0)<0&&(b=x.iadd(this.m)),b._forceRed(this)},s.prototype.mul=function(d,p){if(d.isZero()||p.isZero())return new n(0)._forceRed(this);var m=d.mul(p),w=m.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),x=m.isub(w).iushrn(this.shift),b=x;return x.cmp(this.m)>=0?b=x.isub(this.m):x.cmpn(0)<0&&(b=x.iadd(this.m)),b._forceRed(this)},s.prototype.invm=function(d){var p=this.imod(d._invmp(this.m).mul(this.r2));return p._forceRed(this)}})(i,di)}(Vf)),Vf.exports}var Uu,cv;function u1(){if(cv)return Uu;cv=1;var i=c1(),e=Is(),r=er().Buffer;function t(c){var u=c.modulus.byteLength(),v;do v=new i(e(u));while(v.cmp(c.modulus)>=0||!v.umod(c.prime1)||!v.umod(c.prime2));return v}function a(c){var u=t(c),v=u.toRed(i.mont(c.modulus)).redPow(new i(c.publicExponent)).fromRed();return{blinder:v,unblinder:u.invm(c.modulus)}}function n(c,u){var v=a(u),o=u.modulus.byteLength(),h=new i(c).mul(v.blinder).umod(u.modulus),g=h.toRed(i.mont(u.prime1)),y=h.toRed(i.mont(u.prime2)),_=u.coefficient,A=u.prime1,S=u.prime2,T=g.redPow(u.exponent1).fromRed(),B=y.redPow(u.exponent2).fromRed(),M=T.isub(B).imul(_).umod(A).imul(S);return B.iadd(M).imul(v.unblinder).umod(u.modulus).toArrayLike(r,"be",o)}return n.getr=t,Uu=n,Uu}var Du={};const fw="elliptic",lw="6.6.1",cw="EC cryptography",uw="lib/elliptic.js",hw=["lib"],dw={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},pw={type:"git",url:"git@github.com:indutny/elliptic"},vw=["EC","Elliptic","curve","Cryptography"],gw="Fedor Indutny <fedor@indutny.com>",mw="MIT",yw={url:"https://github.com/indutny/elliptic/issues"},bw="https://github.com/indutny/elliptic",_w={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},ww={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},Cw={name:fw,version:lw,description:cw,main:uw,files:hw,scripts:dw,repository:pw,keywords:vw,author:gw,license:mw,bugs:yw,homepage:bw,devDependencies:_w,dependencies:ww};var Ou={},Gf={exports:{}};Gf.exports;var uv;function $n(){return uv||(uv=1,function(i){(function(e,r){function t(E,s){if(!E)throw new Error(s||"Assertion failed")}function a(E,s){E.super_=s;var l=function(){};l.prototype=s.prototype,E.prototype=new l,E.prototype.constructor=E}function n(E,s,l){if(n.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&((s==="le"||s==="be")&&(l=s,s=10),this._init(E||0,s||10,l||"be"))}typeof e=="object"?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=$i.Buffer}catch{}n.isBN=function(s){return s instanceof n?!0:s!==null&&typeof s=="object"&&s.constructor.wordSize===n.wordSize&&Array.isArray(s.words)},n.max=function(s,l){return s.cmp(l)>0?s:l},n.min=function(s,l){return s.cmp(l)<0?s:l},n.prototype._init=function(s,l,d){if(typeof s=="number")return this._initNumber(s,l,d);if(typeof s=="object")return this._initArray(s,l,d);l==="hex"&&(l=16),t(l===(l|0)&&l>=2&&l<=36),s=s.toString().replace(/\s+/g,"");var p=0;s[0]==="-"&&(p++,this.negative=1),p<s.length&&(l===16?this._parseHex(s,p,d):(this._parseBase(s,l,p),d==="le"&&this._initArray(this.toArray(),l,d)))},n.prototype._initNumber=function(s,l,d){s<0&&(this.negative=1,s=-s),s<67108864?(this.words=[s&67108863],this.length=1):s<4503599627370496?(this.words=[s&67108863,s/67108864&67108863],this.length=2):(t(s<9007199254740992),this.words=[s&67108863,s/67108864&67108863,1],this.length=3),d==="le"&&this._initArray(this.toArray(),l,d)},n.prototype._initArray=function(s,l,d){if(t(typeof s.length=="number"),s.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(s.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m,w,x=0;if(d==="be")for(p=s.length-1,m=0;p>=0;p-=3)w=s[p]|s[p-1]<<8|s[p-2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);else if(d==="le")for(p=0,m=0;p<s.length;p+=3)w=s[p]|s[p+1]<<8|s[p+2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);return this.strip()};function u(E,s){var l=E.charCodeAt(s);return l>=65&&l<=70?l-55:l>=97&&l<=102?l-87:l-48&15}function v(E,s,l){var d=u(E,l);return l-1>=s&&(d|=u(E,l-1)<<4),d}n.prototype._parseHex=function(s,l,d){this.length=Math.ceil((s.length-l)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m=0,w=0,x;if(d==="be")for(p=s.length-1;p>=l;p-=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8;else{var b=s.length-l;for(p=b%2===0?l+1:l;p<s.length;p+=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8}this.strip()};function o(E,s,l,d){for(var p=0,m=Math.min(E.length,l),w=s;w<m;w++){var x=E.charCodeAt(w)-48;p*=d,x>=49?p+=x-49+10:x>=17?p+=x-17+10:p+=x}return p}n.prototype._parseBase=function(s,l,d){this.words=[0],this.length=1;for(var p=0,m=1;m<=67108863;m*=l)p++;p--,m=m/l|0;for(var w=s.length-d,x=w%p,b=Math.min(w,w-x)+d,f=0,C=d;C<b;C+=p)f=o(s,C,C+p,l),this.imuln(m),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(x!==0){var F=1;for(f=o(s,C,s.length,l),C=0;C<x;C++)F*=l;this.imuln(F),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},n.prototype.copy=function(s){s.words=new Array(this.length);for(var l=0;l<this.length;l++)s.words[l]=this.words[l];s.length=this.length,s.negative=this.negative,s.red=this.red},n.prototype.clone=function(){var s=new n(null);return this.copy(s),s},n.prototype._expand=function(s){for(;this.length<s;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(s,l){s=s||10,l=l|0||1;var d;if(s===16||s==="hex"){d="";for(var p=0,m=0,w=0;w<this.length;w++){var x=this.words[w],b=((x<<p|m)&16777215).toString(16);m=x>>>24-p&16777215,p+=2,p>=26&&(p-=26,w--),m!==0||w!==this.length-1?d=h[6-b.length]+b+d:d=b+d}for(m!==0&&(d=m.toString(16)+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}if(s===(s|0)&&s>=2&&s<=36){var f=g[s],C=y[s];d="";var F=this.clone();for(F.negative=0;!F.isZero();){var z=F.modn(C).toString(s);F=F.idivn(C),F.isZero()?d=z+d:d=h[f-z.length]+z+d}for(this.isZero()&&(d="0"+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var s=this.words[0];return this.length===2?s+=this.words[1]*67108864:this.length===3&&this.words[2]===1?s+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-s:s},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(s,l){return t(typeof c<"u"),this.toArrayLike(c,s,l)},n.prototype.toArray=function(s,l){return this.toArrayLike(Array,s,l)},n.prototype.toArrayLike=function(s,l,d){var p=this.byteLength(),m=d||Math.max(1,p);t(p<=m,"byte array longer than desired length"),t(m>0,"Requested array length <= 0"),this.strip();var w=l==="le",x=new s(m),b,f,C=this.clone();if(w){for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[f]=b;for(;f<m;f++)x[f]=0}else{for(f=0;f<m-p;f++)x[f]=0;for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[m-f-1]=b}return x},Math.clz32?n.prototype._countBits=function(s){return 32-Math.clz32(s)}:n.prototype._countBits=function(s){var l=s,d=0;return l>=4096&&(d+=13,l>>>=13),l>=64&&(d+=7,l>>>=7),l>=8&&(d+=4,l>>>=4),l>=2&&(d+=2,l>>>=2),d+l},n.prototype._zeroBits=function(s){if(s===0)return 26;var l=s,d=0;return l&8191||(d+=13,l>>>=13),l&127||(d+=7,l>>>=7),l&15||(d+=4,l>>>=4),l&3||(d+=2,l>>>=2),l&1||d++,d},n.prototype.bitLength=function(){var s=this.words[this.length-1],l=this._countBits(s);return(this.length-1)*26+l};function _(E){for(var s=new Array(E.bitLength()),l=0;l<s.length;l++){var d=l/26|0,p=l%26;s[l]=(E.words[d]&1<<p)>>>p}return s}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var s=0,l=0;l<this.length;l++){var d=this._zeroBits(this.words[l]);if(s+=d,d!==26)break}return s},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(s){return this.negative!==0?this.abs().inotn(s).iaddn(1):this.clone()},n.prototype.fromTwos=function(s){return this.testn(s-1)?this.notn(s).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(s){for(;this.length<s.length;)this.words[this.length++]=0;for(var l=0;l<s.length;l++)this.words[l]=this.words[l]|s.words[l];return this.strip()},n.prototype.ior=function(s){return t((this.negative|s.negative)===0),this.iuor(s)},n.prototype.or=function(s){return this.length>s.length?this.clone().ior(s):s.clone().ior(this)},n.prototype.uor=function(s){return this.length>s.length?this.clone().iuor(s):s.clone().iuor(this)},n.prototype.iuand=function(s){var l;this.length>s.length?l=s:l=this;for(var d=0;d<l.length;d++)this.words[d]=this.words[d]&s.words[d];return this.length=l.length,this.strip()},n.prototype.iand=function(s){return t((this.negative|s.negative)===0),this.iuand(s)},n.prototype.and=function(s){return this.length>s.length?this.clone().iand(s):s.clone().iand(this)},n.prototype.uand=function(s){return this.length>s.length?this.clone().iuand(s):s.clone().iuand(this)},n.prototype.iuxor=function(s){var l,d;this.length>s.length?(l=this,d=s):(l=s,d=this);for(var p=0;p<d.length;p++)this.words[p]=l.words[p]^d.words[p];if(this!==l)for(;p<l.length;p++)this.words[p]=l.words[p];return this.length=l.length,this.strip()},n.prototype.ixor=function(s){return t((this.negative|s.negative)===0),this.iuxor(s)},n.prototype.xor=function(s){return this.length>s.length?this.clone().ixor(s):s.clone().ixor(this)},n.prototype.uxor=function(s){return this.length>s.length?this.clone().iuxor(s):s.clone().iuxor(this)},n.prototype.inotn=function(s){t(typeof s=="number"&&s>=0);var l=Math.ceil(s/26)|0,d=s%26;this._expand(l),d>0&&l--;for(var p=0;p<l;p++)this.words[p]=~this.words[p]&67108863;return d>0&&(this.words[p]=~this.words[p]&67108863>>26-d),this.strip()},n.prototype.notn=function(s){return this.clone().inotn(s)},n.prototype.setn=function(s,l){t(typeof s=="number"&&s>=0);var d=s/26|0,p=s%26;return this._expand(d+1),l?this.words[d]=this.words[d]|1<<p:this.words[d]=this.words[d]&~(1<<p),this.strip()},n.prototype.iadd=function(s){var l;if(this.negative!==0&&s.negative===0)return this.negative=0,l=this.isub(s),this.negative^=1,this._normSign();if(this.negative===0&&s.negative!==0)return s.negative=0,l=this.isub(s),s.negative=1,l._normSign();var d,p;this.length>s.length?(d=this,p=s):(d=s,p=this);for(var m=0,w=0;w<p.length;w++)l=(d.words[w]|0)+(p.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;for(;m!==0&&w<d.length;w++)l=(d.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;if(this.length=d.length,m!==0)this.words[this.length]=m,this.length++;else if(d!==this)for(;w<d.length;w++)this.words[w]=d.words[w];return this},n.prototype.add=function(s){var l;return s.negative!==0&&this.negative===0?(s.negative=0,l=this.sub(s),s.negative^=1,l):s.negative===0&&this.negative!==0?(this.negative=0,l=s.sub(this),this.negative=1,l):this.length>s.length?this.clone().iadd(s):s.clone().iadd(this)},n.prototype.isub=function(s){if(s.negative!==0){s.negative=0;var l=this.iadd(s);return s.negative=1,l._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(s),this.negative=1,this._normSign();var d=this.cmp(s);if(d===0)return this.negative=0,this.length=1,this.words[0]=0,this;var p,m;d>0?(p=this,m=s):(p=s,m=this);for(var w=0,x=0;x<m.length;x++)l=(p.words[x]|0)-(m.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;for(;w!==0&&x<p.length;x++)l=(p.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;if(w===0&&x<p.length&&p!==this)for(;x<p.length;x++)this.words[x]=p.words[x];return this.length=Math.max(this.length,x),p!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(s){return this.clone().isub(s)};function A(E,s,l){l.negative=s.negative^E.negative;var d=E.length+s.length|0;l.length=d,d=d-1|0;var p=E.words[0]|0,m=s.words[0]|0,w=p*m,x=w&67108863,b=w/67108864|0;l.words[0]=x;for(var f=1;f<d;f++){for(var C=b>>>26,F=b&67108863,z=Math.min(f,s.length-1),W=Math.max(0,f-E.length+1);W<=z;W++){var $=f-W|0;p=E.words[$]|0,m=s.words[W]|0,w=p*m+F,C+=w/67108864|0,F=w&67108863}l.words[f]=F|0,b=C|0}return b!==0?l.words[f]=b|0:l.length--,l.strip()}var S=function(s,l,d){var p=s.words,m=l.words,w=d.words,x=0,b,f,C,F=p[0]|0,z=F&8191,W=F>>>13,$=p[1]|0,I=$&8191,K=$>>>13,N=p[2]|0,X=N&8191,Q=N>>>13,L=p[3]|0,V=L&8191,Z=L>>>13,H=p[4]|0,j=H&8191,et=H>>>13,nt=p[5]|0,st=nt&8191,ft=nt>>>13,vt=p[6]|0,ot=vt&8191,pt=vt>>>13,Ut=p[7]|0,At=Ut&8191,It=Ut>>>13,Jt=p[8]|0,at=Jt&8191,J=Jt>>>13,rt=p[9]|0,lt=rt&8191,gt=rt>>>13,Dt=m[0]|0,ut=Dt&8191,Y=Dt>>>13,tt=m[1]|0,dt=tt&8191,mt=tt>>>13,xt=m[2]|0,bt=xt&8191,_t=xt>>>13,Ht=m[3]|0,St=Ht&8191,Mt=Ht>>>13,jt=m[4]|0,Lt=jt&8191,Ft=jt>>>13,te=m[5]|0,Bt=te&8191,Ot=te>>>13,ie=m[6]|0,kt=ie&8191,qt=ie>>>13,ae=m[7]|0,Rt=ae&8191,zt=ae>>>13,he=m[8]|0,Vt=he&8191,Qt=he>>>13,ge=m[9]|0,Gt=ge&8191,$t=ge>>>13;d.negative=s.negative^l.negative,d.length=19,b=Math.imul(z,ut),f=Math.imul(z,Y),f=f+Math.imul(W,ut)|0,C=Math.imul(W,Y);var pe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(pe>>>26)|0,pe&=67108863,b=Math.imul(I,ut),f=Math.imul(I,Y),f=f+Math.imul(K,ut)|0,C=Math.imul(K,Y),b=b+Math.imul(z,dt)|0,f=f+Math.imul(z,mt)|0,f=f+Math.imul(W,dt)|0,C=C+Math.imul(W,mt)|0;var de=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(de>>>26)|0,de&=67108863,b=Math.imul(X,ut),f=Math.imul(X,Y),f=f+Math.imul(Q,ut)|0,C=Math.imul(Q,Y),b=b+Math.imul(I,dt)|0,f=f+Math.imul(I,mt)|0,f=f+Math.imul(K,dt)|0,C=C+Math.imul(K,mt)|0,b=b+Math.imul(z,bt)|0,f=f+Math.imul(z,_t)|0,f=f+Math.imul(W,bt)|0,C=C+Math.imul(W,_t)|0;var Ee=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,b=Math.imul(V,ut),f=Math.imul(V,Y),f=f+Math.imul(Z,ut)|0,C=Math.imul(Z,Y),b=b+Math.imul(X,dt)|0,f=f+Math.imul(X,mt)|0,f=f+Math.imul(Q,dt)|0,C=C+Math.imul(Q,mt)|0,b=b+Math.imul(I,bt)|0,f=f+Math.imul(I,_t)|0,f=f+Math.imul(K,bt)|0,C=C+Math.imul(K,_t)|0,b=b+Math.imul(z,St)|0,f=f+Math.imul(z,Mt)|0,f=f+Math.imul(W,St)|0,C=C+Math.imul(W,Mt)|0;var xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(xe>>>26)|0,xe&=67108863,b=Math.imul(j,ut),f=Math.imul(j,Y),f=f+Math.imul(et,ut)|0,C=Math.imul(et,Y),b=b+Math.imul(V,dt)|0,f=f+Math.imul(V,mt)|0,f=f+Math.imul(Z,dt)|0,C=C+Math.imul(Z,mt)|0,b=b+Math.imul(X,bt)|0,f=f+Math.imul(X,_t)|0,f=f+Math.imul(Q,bt)|0,C=C+Math.imul(Q,_t)|0,b=b+Math.imul(I,St)|0,f=f+Math.imul(I,Mt)|0,f=f+Math.imul(K,St)|0,C=C+Math.imul(K,Mt)|0,b=b+Math.imul(z,Lt)|0,f=f+Math.imul(z,Ft)|0,f=f+Math.imul(W,Lt)|0,C=C+Math.imul(W,Ft)|0;var Se=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Se>>>26)|0,Se&=67108863,b=Math.imul(st,ut),f=Math.imul(st,Y),f=f+Math.imul(ft,ut)|0,C=Math.imul(ft,Y),b=b+Math.imul(j,dt)|0,f=f+Math.imul(j,mt)|0,f=f+Math.imul(et,dt)|0,C=C+Math.imul(et,mt)|0,b=b+Math.imul(V,bt)|0,f=f+Math.imul(V,_t)|0,f=f+Math.imul(Z,bt)|0,C=C+Math.imul(Z,_t)|0,b=b+Math.imul(X,St)|0,f=f+Math.imul(X,Mt)|0,f=f+Math.imul(Q,St)|0,C=C+Math.imul(Q,Mt)|0,b=b+Math.imul(I,Lt)|0,f=f+Math.imul(I,Ft)|0,f=f+Math.imul(K,Lt)|0,C=C+Math.imul(K,Ft)|0,b=b+Math.imul(z,Bt)|0,f=f+Math.imul(z,Ot)|0,f=f+Math.imul(W,Bt)|0,C=C+Math.imul(W,Ot)|0;var Be=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Be>>>26)|0,Be&=67108863,b=Math.imul(ot,ut),f=Math.imul(ot,Y),f=f+Math.imul(pt,ut)|0,C=Math.imul(pt,Y),b=b+Math.imul(st,dt)|0,f=f+Math.imul(st,mt)|0,f=f+Math.imul(ft,dt)|0,C=C+Math.imul(ft,mt)|0,b=b+Math.imul(j,bt)|0,f=f+Math.imul(j,_t)|0,f=f+Math.imul(et,bt)|0,C=C+Math.imul(et,_t)|0,b=b+Math.imul(V,St)|0,f=f+Math.imul(V,Mt)|0,f=f+Math.imul(Z,St)|0,C=C+Math.imul(Z,Mt)|0,b=b+Math.imul(X,Lt)|0,f=f+Math.imul(X,Ft)|0,f=f+Math.imul(Q,Lt)|0,C=C+Math.imul(Q,Ft)|0,b=b+Math.imul(I,Bt)|0,f=f+Math.imul(I,Ot)|0,f=f+Math.imul(K,Bt)|0,C=C+Math.imul(K,Ot)|0,b=b+Math.imul(z,kt)|0,f=f+Math.imul(z,qt)|0,f=f+Math.imul(W,kt)|0,C=C+Math.imul(W,qt)|0;var Ne=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,b=Math.imul(At,ut),f=Math.imul(At,Y),f=f+Math.imul(It,ut)|0,C=Math.imul(It,Y),b=b+Math.imul(ot,dt)|0,f=f+Math.imul(ot,mt)|0,f=f+Math.imul(pt,dt)|0,C=C+Math.imul(pt,mt)|0,b=b+Math.imul(st,bt)|0,f=f+Math.imul(st,_t)|0,f=f+Math.imul(ft,bt)|0,C=C+Math.imul(ft,_t)|0,b=b+Math.imul(j,St)|0,f=f+Math.imul(j,Mt)|0,f=f+Math.imul(et,St)|0,C=C+Math.imul(et,Mt)|0,b=b+Math.imul(V,Lt)|0,f=f+Math.imul(V,Ft)|0,f=f+Math.imul(Z,Lt)|0,C=C+Math.imul(Z,Ft)|0,b=b+Math.imul(X,Bt)|0,f=f+Math.imul(X,Ot)|0,f=f+Math.imul(Q,Bt)|0,C=C+Math.imul(Q,Ot)|0,b=b+Math.imul(I,kt)|0,f=f+Math.imul(I,qt)|0,f=f+Math.imul(K,kt)|0,C=C+Math.imul(K,qt)|0,b=b+Math.imul(z,Rt)|0,f=f+Math.imul(z,zt)|0,f=f+Math.imul(W,Rt)|0,C=C+Math.imul(W,zt)|0;var qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(qe>>>26)|0,qe&=67108863,b=Math.imul(at,ut),f=Math.imul(at,Y),f=f+Math.imul(J,ut)|0,C=Math.imul(J,Y),b=b+Math.imul(At,dt)|0,f=f+Math.imul(At,mt)|0,f=f+Math.imul(It,dt)|0,C=C+Math.imul(It,mt)|0,b=b+Math.imul(ot,bt)|0,f=f+Math.imul(ot,_t)|0,f=f+Math.imul(pt,bt)|0,C=C+Math.imul(pt,_t)|0,b=b+Math.imul(st,St)|0,f=f+Math.imul(st,Mt)|0,f=f+Math.imul(ft,St)|0,C=C+Math.imul(ft,Mt)|0,b=b+Math.imul(j,Lt)|0,f=f+Math.imul(j,Ft)|0,f=f+Math.imul(et,Lt)|0,C=C+Math.imul(et,Ft)|0,b=b+Math.imul(V,Bt)|0,f=f+Math.imul(V,Ot)|0,f=f+Math.imul(Z,Bt)|0,C=C+Math.imul(Z,Ot)|0,b=b+Math.imul(X,kt)|0,f=f+Math.imul(X,qt)|0,f=f+Math.imul(Q,kt)|0,C=C+Math.imul(Q,qt)|0,b=b+Math.imul(I,Rt)|0,f=f+Math.imul(I,zt)|0,f=f+Math.imul(K,Rt)|0,C=C+Math.imul(K,zt)|0,b=b+Math.imul(z,Vt)|0,f=f+Math.imul(z,Qt)|0,f=f+Math.imul(W,Vt)|0,C=C+Math.imul(W,Qt)|0;var Xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,b=Math.imul(lt,ut),f=Math.imul(lt,Y),f=f+Math.imul(gt,ut)|0,C=Math.imul(gt,Y),b=b+Math.imul(at,dt)|0,f=f+Math.imul(at,mt)|0,f=f+Math.imul(J,dt)|0,C=C+Math.imul(J,mt)|0,b=b+Math.imul(At,bt)|0,f=f+Math.imul(At,_t)|0,f=f+Math.imul(It,bt)|0,C=C+Math.imul(It,_t)|0,b=b+Math.imul(ot,St)|0,f=f+Math.imul(ot,Mt)|0,f=f+Math.imul(pt,St)|0,C=C+Math.imul(pt,Mt)|0,b=b+Math.imul(st,Lt)|0,f=f+Math.imul(st,Ft)|0,f=f+Math.imul(ft,Lt)|0,C=C+Math.imul(ft,Ft)|0,b=b+Math.imul(j,Bt)|0,f=f+Math.imul(j,Ot)|0,f=f+Math.imul(et,Bt)|0,C=C+Math.imul(et,Ot)|0,b=b+Math.imul(V,kt)|0,f=f+Math.imul(V,qt)|0,f=f+Math.imul(Z,kt)|0,C=C+Math.imul(Z,qt)|0,b=b+Math.imul(X,Rt)|0,f=f+Math.imul(X,zt)|0,f=f+Math.imul(Q,Rt)|0,C=C+Math.imul(Q,zt)|0,b=b+Math.imul(I,Vt)|0,f=f+Math.imul(I,Qt)|0,f=f+Math.imul(K,Vt)|0,C=C+Math.imul(K,Qt)|0,b=b+Math.imul(z,Gt)|0,f=f+Math.imul(z,$t)|0,f=f+Math.imul(W,Gt)|0,C=C+Math.imul(W,$t)|0;var Ge=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,b=Math.imul(lt,dt),f=Math.imul(lt,mt),f=f+Math.imul(gt,dt)|0,C=Math.imul(gt,mt),b=b+Math.imul(at,bt)|0,f=f+Math.imul(at,_t)|0,f=f+Math.imul(J,bt)|0,C=C+Math.imul(J,_t)|0,b=b+Math.imul(At,St)|0,f=f+Math.imul(At,Mt)|0,f=f+Math.imul(It,St)|0,C=C+Math.imul(It,Mt)|0,b=b+Math.imul(ot,Lt)|0,f=f+Math.imul(ot,Ft)|0,f=f+Math.imul(pt,Lt)|0,C=C+Math.imul(pt,Ft)|0,b=b+Math.imul(st,Bt)|0,f=f+Math.imul(st,Ot)|0,f=f+Math.imul(ft,Bt)|0,C=C+Math.imul(ft,Ot)|0,b=b+Math.imul(j,kt)|0,f=f+Math.imul(j,qt)|0,f=f+Math.imul(et,kt)|0,C=C+Math.imul(et,qt)|0,b=b+Math.imul(V,Rt)|0,f=f+Math.imul(V,zt)|0,f=f+Math.imul(Z,Rt)|0,C=C+Math.imul(Z,zt)|0,b=b+Math.imul(X,Vt)|0,f=f+Math.imul(X,Qt)|0,f=f+Math.imul(Q,Vt)|0,C=C+Math.imul(Q,Qt)|0,b=b+Math.imul(I,Gt)|0,f=f+Math.imul(I,$t)|0,f=f+Math.imul(K,Gt)|0,C=C+Math.imul(K,$t)|0;var Je=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Je>>>26)|0,Je&=67108863,b=Math.imul(lt,bt),f=Math.imul(lt,_t),f=f+Math.imul(gt,bt)|0,C=Math.imul(gt,_t),b=b+Math.imul(at,St)|0,f=f+Math.imul(at,Mt)|0,f=f+Math.imul(J,St)|0,C=C+Math.imul(J,Mt)|0,b=b+Math.imul(At,Lt)|0,f=f+Math.imul(At,Ft)|0,f=f+Math.imul(It,Lt)|0,C=C+Math.imul(It,Ft)|0,b=b+Math.imul(ot,Bt)|0,f=f+Math.imul(ot,Ot)|0,f=f+Math.imul(pt,Bt)|0,C=C+Math.imul(pt,Ot)|0,b=b+Math.imul(st,kt)|0,f=f+Math.imul(st,qt)|0,f=f+Math.imul(ft,kt)|0,C=C+Math.imul(ft,qt)|0,b=b+Math.imul(j,Rt)|0,f=f+Math.imul(j,zt)|0,f=f+Math.imul(et,Rt)|0,C=C+Math.imul(et,zt)|0,b=b+Math.imul(V,Vt)|0,f=f+Math.imul(V,Qt)|0,f=f+Math.imul(Z,Vt)|0,C=C+Math.imul(Z,Qt)|0,b=b+Math.imul(X,Gt)|0,f=f+Math.imul(X,$t)|0,f=f+Math.imul(Q,Gt)|0,C=C+Math.imul(Q,$t)|0;var ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ze>>>26)|0,ze&=67108863,b=Math.imul(lt,St),f=Math.imul(lt,Mt),f=f+Math.imul(gt,St)|0,C=Math.imul(gt,Mt),b=b+Math.imul(at,Lt)|0,f=f+Math.imul(at,Ft)|0,f=f+Math.imul(J,Lt)|0,C=C+Math.imul(J,Ft)|0,b=b+Math.imul(At,Bt)|0,f=f+Math.imul(At,Ot)|0,f=f+Math.imul(It,Bt)|0,C=C+Math.imul(It,Ot)|0,b=b+Math.imul(ot,kt)|0,f=f+Math.imul(ot,qt)|0,f=f+Math.imul(pt,kt)|0,C=C+Math.imul(pt,qt)|0,b=b+Math.imul(st,Rt)|0,f=f+Math.imul(st,zt)|0,f=f+Math.imul(ft,Rt)|0,C=C+Math.imul(ft,zt)|0,b=b+Math.imul(j,Vt)|0,f=f+Math.imul(j,Qt)|0,f=f+Math.imul(et,Vt)|0,C=C+Math.imul(et,Qt)|0,b=b+Math.imul(V,Gt)|0,f=f+Math.imul(V,$t)|0,f=f+Math.imul(Z,Gt)|0,C=C+Math.imul(Z,$t)|0;var rr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(rr>>>26)|0,rr&=67108863,b=Math.imul(lt,Lt),f=Math.imul(lt,Ft),f=f+Math.imul(gt,Lt)|0,C=Math.imul(gt,Ft),b=b+Math.imul(at,Bt)|0,f=f+Math.imul(at,Ot)|0,f=f+Math.imul(J,Bt)|0,C=C+Math.imul(J,Ot)|0,b=b+Math.imul(At,kt)|0,f=f+Math.imul(At,qt)|0,f=f+Math.imul(It,kt)|0,C=C+Math.imul(It,qt)|0,b=b+Math.imul(ot,Rt)|0,f=f+Math.imul(ot,zt)|0,f=f+Math.imul(pt,Rt)|0,C=C+Math.imul(pt,zt)|0,b=b+Math.imul(st,Vt)|0,f=f+Math.imul(st,Qt)|0,f=f+Math.imul(ft,Vt)|0,C=C+Math.imul(ft,Qt)|0,b=b+Math.imul(j,Gt)|0,f=f+Math.imul(j,$t)|0,f=f+Math.imul(et,Gt)|0,C=C+Math.imul(et,$t)|0;var Qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,b=Math.imul(lt,Bt),f=Math.imul(lt,Ot),f=f+Math.imul(gt,Bt)|0,C=Math.imul(gt,Ot),b=b+Math.imul(at,kt)|0,f=f+Math.imul(at,qt)|0,f=f+Math.imul(J,kt)|0,C=C+Math.imul(J,qt)|0,b=b+Math.imul(At,Rt)|0,f=f+Math.imul(At,zt)|0,f=f+Math.imul(It,Rt)|0,C=C+Math.imul(It,zt)|0,b=b+Math.imul(ot,Vt)|0,f=f+Math.imul(ot,Qt)|0,f=f+Math.imul(pt,Vt)|0,C=C+Math.imul(pt,Qt)|0,b=b+Math.imul(st,Gt)|0,f=f+Math.imul(st,$t)|0,f=f+Math.imul(ft,Gt)|0,C=C+Math.imul(ft,$t)|0;var Le=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Le>>>26)|0,Le&=67108863,b=Math.imul(lt,kt),f=Math.imul(lt,qt),f=f+Math.imul(gt,kt)|0,C=Math.imul(gt,qt),b=b+Math.imul(at,Rt)|0,f=f+Math.imul(at,zt)|0,f=f+Math.imul(J,Rt)|0,C=C+Math.imul(J,zt)|0,b=b+Math.imul(At,Vt)|0,f=f+Math.imul(At,Qt)|0,f=f+Math.imul(It,Vt)|0,C=C+Math.imul(It,Qt)|0,b=b+Math.imul(ot,Gt)|0,f=f+Math.imul(ot,$t)|0,f=f+Math.imul(pt,Gt)|0,C=C+Math.imul(pt,$t)|0;var ir=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ir>>>26)|0,ir&=67108863,b=Math.imul(lt,Rt),f=Math.imul(lt,zt),f=f+Math.imul(gt,Rt)|0,C=Math.imul(gt,zt),b=b+Math.imul(at,Vt)|0,f=f+Math.imul(at,Qt)|0,f=f+Math.imul(J,Vt)|0,C=C+Math.imul(J,Qt)|0,b=b+Math.imul(At,Gt)|0,f=f+Math.imul(At,$t)|0,f=f+Math.imul(It,Gt)|0,C=C+Math.imul(It,$t)|0;var nr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(nr>>>26)|0,nr&=67108863,b=Math.imul(lt,Vt),f=Math.imul(lt,Qt),f=f+Math.imul(gt,Vt)|0,C=Math.imul(gt,Qt),b=b+Math.imul(at,Gt)|0,f=f+Math.imul(at,$t)|0,f=f+Math.imul(J,Gt)|0,C=C+Math.imul(J,$t)|0;var Ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,b=Math.imul(lt,Gt),f=Math.imul(lt,$t),f=f+Math.imul(gt,Gt)|0,C=Math.imul(gt,$t);var ar=(x+b|0)+((f&8191)<<13)|0;return x=(C+(f>>>13)|0)+(ar>>>26)|0,ar&=67108863,w[0]=pe,w[1]=de,w[2]=Ee,w[3]=xe,w[4]=Se,w[5]=Be,w[6]=Ne,w[7]=qe,w[8]=Xe,w[9]=Ge,w[10]=Je,w[11]=ze,w[12]=rr,w[13]=Qe,w[14]=Le,w[15]=ir,w[16]=nr,w[17]=Ze,w[18]=ar,x!==0&&(w[19]=x,d.length++),d};Math.imul||(S=A);function T(E,s,l){l.negative=s.negative^E.negative,l.length=E.length+s.length;for(var d=0,p=0,m=0;m<l.length-1;m++){var w=p;p=0;for(var x=d&67108863,b=Math.min(m,s.length-1),f=Math.max(0,m-E.length+1);f<=b;f++){var C=m-f,F=E.words[C]|0,z=s.words[f]|0,W=F*z,$=W&67108863;w=w+(W/67108864|0)|0,$=$+x|0,x=$&67108863,w=w+($>>>26)|0,p+=w>>>26,w&=67108863}l.words[m]=x,d=w,w=p}return d!==0?l.words[m]=d:l.length--,l.strip()}function B(E,s,l){var d=new M;return d.mulp(E,s,l)}n.prototype.mulTo=function(s,l){var d,p=this.length+s.length;return this.length===10&&s.length===10?d=S(this,s,l):p<63?d=A(this,s,l):p<1024?d=T(this,s,l):d=B(this,s,l),d};function M(E,s){this.x=E,this.y=s}M.prototype.makeRBT=function(s){for(var l=new Array(s),d=n.prototype._countBits(s)-1,p=0;p<s;p++)l[p]=this.revBin(p,d,s);return l},M.prototype.revBin=function(s,l,d){if(s===0||s===d-1)return s;for(var p=0,m=0;m<l;m++)p|=(s&1)<<l-m-1,s>>=1;return p},M.prototype.permute=function(s,l,d,p,m,w){for(var x=0;x<w;x++)p[x]=l[s[x]],m[x]=d[s[x]]},M.prototype.transform=function(s,l,d,p,m,w){this.permute(w,s,l,d,p,m);for(var x=1;x<m;x<<=1)for(var b=x<<1,f=Math.cos(2*Math.PI/b),C=Math.sin(2*Math.PI/b),F=0;F<m;F+=b)for(var z=f,W=C,$=0;$<x;$++){var I=d[F+$],K=p[F+$],N=d[F+$+x],X=p[F+$+x],Q=z*N-W*X;X=z*X+W*N,N=Q,d[F+$]=I+N,p[F+$]=K+X,d[F+$+x]=I-N,p[F+$+x]=K-X,$!==b&&(Q=f*z-C*W,W=f*W+C*z,z=Q)}},M.prototype.guessLen13b=function(s,l){var d=Math.max(l,s)|1,p=d&1,m=0;for(d=d/2|0;d;d=d>>>1)m++;return 1<<m+1+p},M.prototype.conjugate=function(s,l,d){if(!(d<=1))for(var p=0;p<d/2;p++){var m=s[p];s[p]=s[d-p-1],s[d-p-1]=m,m=l[p],l[p]=-l[d-p-1],l[d-p-1]=-m}},M.prototype.normalize13b=function(s,l){for(var d=0,p=0;p<l/2;p++){var m=Math.round(s[2*p+1]/l)*8192+Math.round(s[2*p]/l)+d;s[p]=m&67108863,m<67108864?d=0:d=m/67108864|0}return s},M.prototype.convert13b=function(s,l,d,p){for(var m=0,w=0;w<l;w++)m=m+(s[w]|0),d[2*w]=m&8191,m=m>>>13,d[2*w+1]=m&8191,m=m>>>13;for(w=2*l;w<p;++w)d[w]=0;t(m===0),t((m&-8192)===0)},M.prototype.stub=function(s){for(var l=new Array(s),d=0;d<s;d++)l[d]=0;return l},M.prototype.mulp=function(s,l,d){var p=2*this.guessLen13b(s.length,l.length),m=this.makeRBT(p),w=this.stub(p),x=new Array(p),b=new Array(p),f=new Array(p),C=new Array(p),F=new Array(p),z=new Array(p),W=d.words;W.length=p,this.convert13b(s.words,s.length,x,p),this.convert13b(l.words,l.length,C,p),this.transform(x,w,b,f,p,m),this.transform(C,w,F,z,p,m);for(var $=0;$<p;$++){var I=b[$]*F[$]-f[$]*z[$];f[$]=b[$]*z[$]+f[$]*F[$],b[$]=I}return this.conjugate(b,f,p),this.transform(b,f,W,w,p,m),this.conjugate(W,w,p),this.normalize13b(W,p),d.negative=s.negative^l.negative,d.length=s.length+l.length,d.strip()},n.prototype.mul=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),this.mulTo(s,l)},n.prototype.mulf=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),B(this,s,l)},n.prototype.imul=function(s){return this.clone().mulTo(s,this)},n.prototype.imuln=function(s){t(typeof s=="number"),t(s<67108864);for(var l=0,d=0;d<this.length;d++){var p=(this.words[d]|0)*s,m=(p&67108863)+(l&67108863);l>>=26,l+=p/67108864|0,l+=m>>>26,this.words[d]=m&67108863}return l!==0&&(this.words[d]=l,this.length++),this},n.prototype.muln=function(s){return this.clone().imuln(s)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(s){var l=_(s);if(l.length===0)return new n(1);for(var d=this,p=0;p<l.length&&l[p]===0;p++,d=d.sqr());if(++p<l.length)for(var m=d.sqr();p<l.length;p++,m=m.sqr())l[p]!==0&&(d=d.mul(m));return d},n.prototype.iushln=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=67108863>>>26-l<<26-l,m;if(l!==0){var w=0;for(m=0;m<this.length;m++){var x=this.words[m]&p,b=(this.words[m]|0)-x<<l;this.words[m]=b|w,w=x>>>26-l}w&&(this.words[m]=w,this.length++)}if(d!==0){for(m=this.length-1;m>=0;m--)this.words[m+d]=this.words[m];for(m=0;m<d;m++)this.words[m]=0;this.length+=d}return this.strip()},n.prototype.ishln=function(s){return t(this.negative===0),this.iushln(s)},n.prototype.iushrn=function(s,l,d){t(typeof s=="number"&&s>=0);var p;l?p=(l-l%26)/26:p=0;var m=s%26,w=Math.min((s-m)/26,this.length),x=67108863^67108863>>>m<<m,b=d;if(p-=w,p=Math.max(0,p),b){for(var f=0;f<w;f++)b.words[f]=this.words[f];b.length=w}if(w!==0)if(this.length>w)for(this.length-=w,f=0;f<this.length;f++)this.words[f]=this.words[f+w];else this.words[0]=0,this.length=1;var C=0;for(f=this.length-1;f>=0&&(C!==0||f>=p);f--){var F=this.words[f]|0;this.words[f]=C<<26-m|F>>>m,C=F&x}return b&&C!==0&&(b.words[b.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(s,l,d){return t(this.negative===0),this.iushrn(s,l,d)},n.prototype.shln=function(s){return this.clone().ishln(s)},n.prototype.ushln=function(s){return this.clone().iushln(s)},n.prototype.shrn=function(s){return this.clone().ishrn(s)},n.prototype.ushrn=function(s){return this.clone().iushrn(s)},n.prototype.testn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return!1;var m=this.words[d];return!!(m&p)},n.prototype.imaskn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=d)return this;if(l!==0&&d++,this.length=Math.min(d,this.length),l!==0){var p=67108863^67108863>>>l<<l;this.words[this.length-1]&=p}return this.strip()},n.prototype.maskn=function(s){return this.clone().imaskn(s)},n.prototype.iaddn=function(s){return t(typeof s=="number"),t(s<67108864),s<0?this.isubn(-s):this.negative!==0?this.length===1&&(this.words[0]|0)<s?(this.words[0]=s-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(s),this.negative=1,this):this._iaddn(s)},n.prototype._iaddn=function(s){this.words[0]+=s;for(var l=0;l<this.length&&this.words[l]>=67108864;l++)this.words[l]-=67108864,l===this.length-1?this.words[l+1]=1:this.words[l+1]++;return this.length=Math.max(this.length,l+1),this},n.prototype.isubn=function(s){if(t(typeof s=="number"),t(s<67108864),s<0)return this.iaddn(-s);if(this.negative!==0)return this.negative=0,this.iaddn(s),this.negative=1,this;if(this.words[0]-=s,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var l=0;l<this.length&&this.words[l]<0;l++)this.words[l]+=67108864,this.words[l+1]-=1;return this.strip()},n.prototype.addn=function(s){return this.clone().iaddn(s)},n.prototype.subn=function(s){return this.clone().isubn(s)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(s,l,d){var p=s.length+d,m;this._expand(p);var w,x=0;for(m=0;m<s.length;m++){w=(this.words[m+d]|0)+x;var b=(s.words[m]|0)*l;w-=b&67108863,x=(w>>26)-(b/67108864|0),this.words[m+d]=w&67108863}for(;m<this.length-d;m++)w=(this.words[m+d]|0)+x,x=w>>26,this.words[m+d]=w&67108863;if(x===0)return this.strip();for(t(x===-1),x=0,m=0;m<this.length;m++)w=-(this.words[m]|0)+x,x=w>>26,this.words[m]=w&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(s,l){var d=this.length-s.length,p=this.clone(),m=s,w=m.words[m.length-1]|0,x=this._countBits(w);d=26-x,d!==0&&(m=m.ushln(d),p.iushln(d),w=m.words[m.length-1]|0);var b=p.length-m.length,f;if(l!=="mod"){f=new n(null),f.length=b+1,f.words=new Array(f.length);for(var C=0;C<f.length;C++)f.words[C]=0}var F=p.clone()._ishlnsubmul(m,1,b);F.negative===0&&(p=F,f&&(f.words[b]=1));for(var z=b-1;z>=0;z--){var W=(p.words[m.length+z]|0)*67108864+(p.words[m.length+z-1]|0);for(W=Math.min(W/w|0,67108863),p._ishlnsubmul(m,W,z);p.negative!==0;)W--,p.negative=0,p._ishlnsubmul(m,1,z),p.isZero()||(p.negative^=1);f&&(f.words[z]=W)}return f&&f.strip(),p.strip(),l!=="div"&&d!==0&&p.iushrn(d),{div:f||null,mod:p}},n.prototype.divmod=function(s,l,d){if(t(!s.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var p,m,w;return this.negative!==0&&s.negative===0?(w=this.neg().divmod(s,l),l!=="mod"&&(p=w.div.neg()),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.iadd(s)),{div:p,mod:m}):this.negative===0&&s.negative!==0?(w=this.divmod(s.neg(),l),l!=="mod"&&(p=w.div.neg()),{div:p,mod:w.mod}):this.negative&s.negative?(w=this.neg().divmod(s.neg(),l),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.isub(s)),{div:w.div,mod:m}):s.length>this.length||this.cmp(s)<0?{div:new n(0),mod:this}:s.length===1?l==="div"?{div:this.divn(s.words[0]),mod:null}:l==="mod"?{div:null,mod:new n(this.modn(s.words[0]))}:{div:this.divn(s.words[0]),mod:new n(this.modn(s.words[0]))}:this._wordDiv(s,l)},n.prototype.div=function(s){return this.divmod(s,"div",!1).div},n.prototype.mod=function(s){return this.divmod(s,"mod",!1).mod},n.prototype.umod=function(s){return this.divmod(s,"mod",!0).mod},n.prototype.divRound=function(s){var l=this.divmod(s);if(l.mod.isZero())return l.div;var d=l.div.negative!==0?l.mod.isub(s):l.mod,p=s.ushrn(1),m=s.andln(1),w=d.cmp(p);return w<0||m===1&&w===0?l.div:l.div.negative!==0?l.div.isubn(1):l.div.iaddn(1)},n.prototype.modn=function(s){t(s<=67108863);for(var l=(1<<26)%s,d=0,p=this.length-1;p>=0;p--)d=(l*d+(this.words[p]|0))%s;return d},n.prototype.idivn=function(s){t(s<=67108863);for(var l=0,d=this.length-1;d>=0;d--){var p=(this.words[d]|0)+l*67108864;this.words[d]=p/s|0,l=p%s}return this.strip()},n.prototype.divn=function(s){return this.clone().idivn(s)},n.prototype.egcd=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=new n(0),x=new n(1),b=0;l.isEven()&&d.isEven();)l.iushrn(1),d.iushrn(1),++b;for(var f=d.clone(),C=l.clone();!l.isZero();){for(var F=0,z=1;!(l.words[0]&z)&&F<26;++F,z<<=1);if(F>0)for(l.iushrn(F);F-- >0;)(p.isOdd()||m.isOdd())&&(p.iadd(f),m.isub(C)),p.iushrn(1),m.iushrn(1);for(var W=0,$=1;!(d.words[0]&$)&&W<26;++W,$<<=1);if(W>0)for(d.iushrn(W);W-- >0;)(w.isOdd()||x.isOdd())&&(w.iadd(f),x.isub(C)),w.iushrn(1),x.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(w),m.isub(x)):(d.isub(l),w.isub(p),x.isub(m))}return{a:w,b:x,gcd:d.iushln(b)}},n.prototype._invmp=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=d.clone();l.cmpn(1)>0&&d.cmpn(1)>0;){for(var x=0,b=1;!(l.words[0]&b)&&x<26;++x,b<<=1);if(x>0)for(l.iushrn(x);x-- >0;)p.isOdd()&&p.iadd(w),p.iushrn(1);for(var f=0,C=1;!(d.words[0]&C)&&f<26;++f,C<<=1);if(f>0)for(d.iushrn(f);f-- >0;)m.isOdd()&&m.iadd(w),m.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(m)):(d.isub(l),m.isub(p))}var F;return l.cmpn(1)===0?F=p:F=m,F.cmpn(0)<0&&F.iadd(s),F},n.prototype.gcd=function(s){if(this.isZero())return s.abs();if(s.isZero())return this.abs();var l=this.clone(),d=s.clone();l.negative=0,d.negative=0;for(var p=0;l.isEven()&&d.isEven();p++)l.iushrn(1),d.iushrn(1);do{for(;l.isEven();)l.iushrn(1);for(;d.isEven();)d.iushrn(1);var m=l.cmp(d);if(m<0){var w=l;l=d,d=w}else if(m===0||d.cmpn(1)===0)break;l.isub(d)}while(!0);return d.iushln(p)},n.prototype.invm=function(s){return this.egcd(s).a.umod(s)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(s){return this.words[0]&s},n.prototype.bincn=function(s){t(typeof s=="number");var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return this._expand(d+1),this.words[d]|=p,this;for(var m=p,w=d;m!==0&&w<this.length;w++){var x=this.words[w]|0;x+=m,m=x>>>26,x&=67108863,this.words[w]=x}return m!==0&&(this.words[w]=m,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(s){var l=s<0;if(this.negative!==0&&!l)return-1;if(this.negative===0&&l)return 1;this.strip();var d;if(this.length>1)d=1;else{l&&(s=-s),t(s<=67108863,"Number is too big");var p=this.words[0]|0;d=p===s?0:p<s?-1:1}return this.negative!==0?-d|0:d},n.prototype.cmp=function(s){if(this.negative!==0&&s.negative===0)return-1;if(this.negative===0&&s.negative!==0)return 1;var l=this.ucmp(s);return this.negative!==0?-l|0:l},n.prototype.ucmp=function(s){if(this.length>s.length)return 1;if(this.length<s.length)return-1;for(var l=0,d=this.length-1;d>=0;d--){var p=this.words[d]|0,m=s.words[d]|0;if(p!==m){p<m?l=-1:p>m&&(l=1);break}}return l},n.prototype.gtn=function(s){return this.cmpn(s)===1},n.prototype.gt=function(s){return this.cmp(s)===1},n.prototype.gten=function(s){return this.cmpn(s)>=0},n.prototype.gte=function(s){return this.cmp(s)>=0},n.prototype.ltn=function(s){return this.cmpn(s)===-1},n.prototype.lt=function(s){return this.cmp(s)===-1},n.prototype.lten=function(s){return this.cmpn(s)<=0},n.prototype.lte=function(s){return this.cmp(s)<=0},n.prototype.eqn=function(s){return this.cmpn(s)===0},n.prototype.eq=function(s){return this.cmp(s)===0},n.red=function(s){return new O(s)},n.prototype.toRed=function(s){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),s.convertTo(this)._forceRed(s)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(s){return this.red=s,this},n.prototype.forceRed=function(s){return t(!this.red,"Already a number in reduction context"),this._forceRed(s)},n.prototype.redAdd=function(s){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,s)},n.prototype.redIAdd=function(s){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,s)},n.prototype.redSub=function(s){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,s)},n.prototype.redISub=function(s){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,s)},n.prototype.redShl=function(s){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,s)},n.prototype.redMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.mul(this,s)},n.prototype.redIMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.imul(this,s)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(s){return t(this.red&&!s.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,s)};var R={k256:null,p224:null,p192:null,p25519:null};function P(E,s){this.name=E,this.p=new n(s,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}P.prototype._tmp=function(){var s=new n(null);return s.words=new Array(Math.ceil(this.n/13)),s},P.prototype.ireduce=function(s){var l=s,d;do this.split(l,this.tmp),l=this.imulK(l),l=l.iadd(this.tmp),d=l.bitLength();while(d>this.n);var p=d<this.n?-1:l.ucmp(this.p);return p===0?(l.words[0]=0,l.length=1):p>0?l.isub(this.p):l.strip!==void 0?l.strip():l._strip(),l},P.prototype.split=function(s,l){s.iushrn(this.n,0,l)},P.prototype.imulK=function(s){return s.imul(this.k)};function D(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(D,P),D.prototype.split=function(s,l){for(var d=4194303,p=Math.min(s.length,9),m=0;m<p;m++)l.words[m]=s.words[m];if(l.length=p,s.length<=9){s.words[0]=0,s.length=1;return}var w=s.words[9];for(l.words[l.length++]=w&d,m=10;m<s.length;m++){var x=s.words[m]|0;s.words[m-10]=(x&d)<<4|w>>>22,w=x}w>>>=22,s.words[m-10]=w,w===0&&s.length>10?s.length-=10:s.length-=9},D.prototype.imulK=function(s){s.words[s.length]=0,s.words[s.length+1]=0,s.length+=2;for(var l=0,d=0;d<s.length;d++){var p=s.words[d]|0;l+=p*977,s.words[d]=l&67108863,l=p*64+(l/67108864|0)}return s.words[s.length-1]===0&&(s.length--,s.words[s.length-1]===0&&s.length--),s};function q(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(q,P);function k(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(k,P);function U(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(U,P),U.prototype.imulK=function(s){for(var l=0,d=0;d<s.length;d++){var p=(s.words[d]|0)*19+l,m=p&67108863;p>>>=26,s.words[d]=m,l=p}return l!==0&&(s.words[s.length++]=l),s},n._prime=function(s){if(R[s])return R[s];var l;if(s==="k256")l=new D;else if(s==="p224")l=new q;else if(s==="p192")l=new k;else if(s==="p25519")l=new U;else throw new Error("Unknown prime "+s);return R[s]=l,l};function O(E){if(typeof E=="string"){var s=n._prime(E);this.m=s.p,this.prime=s}else t(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}O.prototype._verify1=function(s){t(s.negative===0,"red works only with positives"),t(s.red,"red works only with red numbers")},O.prototype._verify2=function(s,l){t((s.negative|l.negative)===0,"red works only with positives"),t(s.red&&s.red===l.red,"red works only with red numbers")},O.prototype.imod=function(s){return this.prime?this.prime.ireduce(s)._forceRed(this):s.umod(this.m)._forceRed(this)},O.prototype.neg=function(s){return s.isZero()?s.clone():this.m.sub(s)._forceRed(this)},O.prototype.add=function(s,l){this._verify2(s,l);var d=s.add(l);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},O.prototype.iadd=function(s,l){this._verify2(s,l);var d=s.iadd(l);return d.cmp(this.m)>=0&&d.isub(this.m),d},O.prototype.sub=function(s,l){this._verify2(s,l);var d=s.sub(l);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},O.prototype.isub=function(s,l){this._verify2(s,l);var d=s.isub(l);return d.cmpn(0)<0&&d.iadd(this.m),d},O.prototype.shl=function(s,l){return this._verify1(s),this.imod(s.ushln(l))},O.prototype.imul=function(s,l){return this._verify2(s,l),this.imod(s.imul(l))},O.prototype.mul=function(s,l){return this._verify2(s,l),this.imod(s.mul(l))},O.prototype.isqr=function(s){return this.imul(s,s.clone())},O.prototype.sqr=function(s){return this.mul(s,s)},O.prototype.sqrt=function(s){if(s.isZero())return s.clone();var l=this.m.andln(3);if(t(l%2===1),l===3){var d=this.m.add(new n(1)).iushrn(2);return this.pow(s,d)}for(var p=this.m.subn(1),m=0;!p.isZero()&&p.andln(1)===0;)m++,p.iushrn(1);t(!p.isZero());var w=new n(1).toRed(this),x=w.redNeg(),b=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new n(2*f*f).toRed(this);this.pow(f,b).cmp(x)!==0;)f.redIAdd(x);for(var C=this.pow(f,p),F=this.pow(s,p.addn(1).iushrn(1)),z=this.pow(s,p),W=m;z.cmp(w)!==0;){for(var $=z,I=0;$.cmp(w)!==0;I++)$=$.redSqr();t(I<W);var K=this.pow(C,new n(1).iushln(W-I-1));F=F.redMul(K),C=K.redSqr(),z=z.redMul(C),W=I}return F},O.prototype.invm=function(s){var l=s._invmp(this.m);return l.negative!==0?(l.negative=0,this.imod(l).redNeg()):this.imod(l)},O.prototype.pow=function(s,l){if(l.isZero())return new n(1).toRed(this);if(l.cmpn(1)===0)return s.clone();var d=4,p=new Array(1<<d);p[0]=new n(1).toRed(this),p[1]=s;for(var m=2;m<p.length;m++)p[m]=this.mul(p[m-1],s);var w=p[0],x=0,b=0,f=l.bitLength()%26;for(f===0&&(f=26),m=l.length-1;m>=0;m--){for(var C=l.words[m],F=f-1;F>=0;F--){var z=C>>F&1;if(w!==p[0]&&(w=this.sqr(w)),z===0&&x===0){b=0;continue}x<<=1,x|=z,b++,!(b!==d&&(m!==0||F!==0))&&(w=this.mul(w,p[x]),b=0,x=0)}f=26}return w},O.prototype.convertTo=function(s){var l=s.umod(this.m);return l===s?l.clone():l},O.prototype.convertFrom=function(s){var l=s.clone();return l.red=null,l},n.mont=function(s){return new G(s)};function G(E){O.call(this,E),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(G,O),G.prototype.convertTo=function(s){return this.imod(s.ushln(this.shift))},G.prototype.convertFrom=function(s){var l=this.imod(s.mul(this.rinv));return l.red=null,l},G.prototype.imul=function(s,l){if(s.isZero()||l.isZero())return s.words[0]=0,s.length=1,s;var d=s.imul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.mul=function(s,l){if(s.isZero()||l.isZero())return new n(0)._forceRed(this);var d=s.mul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.invm=function(s){var l=this.imod(s._invmp(this.m).mul(this.r2));return l._forceRed(this)}})(i,di)}(Gf)),Gf.exports}var Fu={},hv;function h1(){return hv||(hv=1,function(i){var e=i;function r(n,c){if(Array.isArray(n))return n.slice();if(!n)return[];var u=[];if(typeof n!="string"){for(var v=0;v<n.length;v++)u[v]=n[v]|0;return u}if(c==="hex"){n=n.replace(/[^a-z0-9]+/ig,""),n.length%2!==0&&(n="0"+n);for(var v=0;v<n.length;v+=2)u.push(parseInt(n[v]+n[v+1],16))}else for(var v=0;v<n.length;v++){var o=n.charCodeAt(v),h=o>>8,g=o&255;h?u.push(h,g):u.push(g)}return u}e.toArray=r;function t(n){return n.length===1?"0"+n:n}e.zero2=t;function a(n){for(var c="",u=0;u<n.length;u++)c+=t(n[u].toString(16));return c}e.toHex=a,e.encode=function(c,u){return u==="hex"?a(c):c}}(Fu)),Fu}var dv;function Zi(){return dv||(dv=1,function(i){var e=i,r=$n(),t=ki(),a=h1();e.assert=t,e.toArray=a.toArray,e.zero2=a.zero2,e.toHex=a.toHex,e.encode=a.encode;function n(h,g,y){var _=new Array(Math.max(h.bitLength(),y)+1),A;for(A=0;A<_.length;A+=1)_[A]=0;var S=1<<g+1,T=h.clone();for(A=0;A<_.length;A++){var B,M=T.andln(S-1);T.isOdd()?(M>(S>>1)-1?B=(S>>1)-M:B=M,T.isubn(B)):B=0,_[A]=B,T.iushrn(1)}return _}e.getNAF=n;function c(h,g){var y=[[],[]];h=h.clone(),g=g.clone();for(var _=0,A=0,S;h.cmpn(-_)>0||g.cmpn(-A)>0;){var T=h.andln(3)+_&3,B=g.andln(3)+A&3;T===3&&(T=-1),B===3&&(B=-1);var M;T&1?(S=h.andln(7)+_&7,(S===3||S===5)&&B===2?M=-T:M=T):M=0,y[0].push(M);var R;B&1?(S=g.andln(7)+A&7,(S===3||S===5)&&T===2?R=-B:R=B):R=0,y[1].push(R),2*_===M+1&&(_=1-_),2*A===R+1&&(A=1-A),h.iushrn(1),g.iushrn(1)}return y}e.getJSF=c;function u(h,g,y){var _="_"+g;h.prototype[g]=function(){return this[_]!==void 0?this[_]:this[_]=y.call(this)}}e.cachedProperty=u;function v(h){return typeof h=="string"?e.toArray(h,"hex"):h}e.parseBytes=v;function o(h){return new r(h,"hex","le")}e.intFromLE=o}(Ou)),Ou}var qu={},zu,pv;function Ml(){if(pv)return zu;pv=1;var i=$n(),e=Zi(),r=e.getNAF,t=e.getJSF,a=e.assert;function n(u,v){this.type=u,this.p=new i(v.p,16),this.red=v.prime?i.red(v.prime):i.mont(this.p),this.zero=new i(0).toRed(this.red),this.one=new i(1).toRed(this.red),this.two=new i(2).toRed(this.red),this.n=v.n&&new i(v.n,16),this.g=v.g&&this.pointFromJSON(v.g,v.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var o=this.n&&this.p.div(this.n);!o||o.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}zu=n,n.prototype.point=function(){throw new Error("Not implemented")},n.prototype.validate=function(){throw new Error("Not implemented")},n.prototype._fixedNafMul=function(v,o){a(v.precomputed);var h=v._getDoubles(),g=r(o,1,this._bitLength),y=(1<<h.step+1)-(h.step%2===0?2:1);y/=3;var _=[],A,S;for(A=0;A<g.length;A+=h.step){S=0;for(var T=A+h.step-1;T>=A;T--)S=(S<<1)+g[T];_.push(S)}for(var B=this.jpoint(null,null,null),M=this.jpoint(null,null,null),R=y;R>0;R--){for(A=0;A<_.length;A++)S=_[A],S===R?M=M.mixedAdd(h.points[A]):S===-R&&(M=M.mixedAdd(h.points[A].neg()));B=B.add(M)}return B.toP()},n.prototype._wnafMul=function(v,o){var h=4,g=v._getNAFPoints(h);h=g.wnd;for(var y=g.points,_=r(o,h,this._bitLength),A=this.jpoint(null,null,null),S=_.length-1;S>=0;S--){for(var T=0;S>=0&&_[S]===0;S--)T++;if(S>=0&&T++,A=A.dblp(T),S<0)break;var B=_[S];a(B!==0),v.type==="affine"?B>0?A=A.mixedAdd(y[B-1>>1]):A=A.mixedAdd(y[-B-1>>1].neg()):B>0?A=A.add(y[B-1>>1]):A=A.add(y[-B-1>>1].neg())}return v.type==="affine"?A.toP():A},n.prototype._wnafMulAdd=function(v,o,h,g,y){var _=this._wnafT1,A=this._wnafT2,S=this._wnafT3,T=0,B,M,R;for(B=0;B<g;B++){R=o[B];var P=R._getNAFPoints(v);_[B]=P.wnd,A[B]=P.points}for(B=g-1;B>=1;B-=2){var D=B-1,q=B;if(_[D]!==1||_[q]!==1){S[D]=r(h[D],_[D],this._bitLength),S[q]=r(h[q],_[q],this._bitLength),T=Math.max(S[D].length,T),T=Math.max(S[q].length,T);continue}var k=[o[D],null,null,o[q]];o[D].y.cmp(o[q].y)===0?(k[1]=o[D].add(o[q]),k[2]=o[D].toJ().mixedAdd(o[q].neg())):o[D].y.cmp(o[q].y.redNeg())===0?(k[1]=o[D].toJ().mixedAdd(o[q]),k[2]=o[D].add(o[q].neg())):(k[1]=o[D].toJ().mixedAdd(o[q]),k[2]=o[D].toJ().mixedAdd(o[q].neg()));var U=[-3,-1,-5,-7,0,7,5,1,3],O=t(h[D],h[q]);for(T=Math.max(O[0].length,T),S[D]=new Array(T),S[q]=new Array(T),M=0;M<T;M++){var G=O[0][M]|0,E=O[1][M]|0;S[D][M]=U[(G+1)*3+(E+1)],S[q][M]=0,A[D]=k}}var s=this.jpoint(null,null,null),l=this._wnafT4;for(B=T;B>=0;B--){for(var d=0;B>=0;){var p=!0;for(M=0;M<g;M++)l[M]=S[M][B]|0,l[M]!==0&&(p=!1);if(!p)break;d++,B--}if(B>=0&&d++,s=s.dblp(d),B<0)break;for(M=0;M<g;M++){var m=l[M];m!==0&&(m>0?R=A[M][m-1>>1]:m<0&&(R=A[M][-m-1>>1].neg()),R.type==="affine"?s=s.mixedAdd(R):s=s.add(R))}}for(B=0;B<g;B++)A[B]=null;return y?s:s.toP()};function c(u,v){this.curve=u,this.type=v,this.precomputed=null}return n.BasePoint=c,c.prototype.eq=function(){throw new Error("Not implemented")},c.prototype.validate=function(){return this.curve.validate(this)},n.prototype.decodePoint=function(v,o){v=e.toArray(v,o);var h=this.p.byteLength();if((v[0]===4||v[0]===6||v[0]===7)&&v.length-1===2*h){v[0]===6?a(v[v.length-1]%2===0):v[0]===7&&a(v[v.length-1]%2===1);var g=this.point(v.slice(1,1+h),v.slice(1+h,1+2*h));return g}else if((v[0]===2||v[0]===3)&&v.length-1===h)return this.pointFromX(v.slice(1,1+h),v[0]===3);throw new Error("Unknown point format")},c.prototype.encodeCompressed=function(v){return this.encode(v,!0)},c.prototype._encode=function(v){var o=this.curve.p.byteLength(),h=this.getX().toArray("be",o);return v?[this.getY().isEven()?2:3].concat(h):[4].concat(h,this.getY().toArray("be",o))},c.prototype.encode=function(v,o){return e.encode(this._encode(o),v)},c.prototype.precompute=function(v){if(this.precomputed)return this;var o={doubles:null,naf:null,beta:null};return o.naf=this._getNAFPoints(8),o.doubles=this._getDoubles(4,v),o.beta=this._getBeta(),this.precomputed=o,this},c.prototype._hasDoubles=function(v){if(!this.precomputed)return!1;var o=this.precomputed.doubles;return o?o.points.length>=Math.ceil((v.bitLength()+1)/o.step):!1},c.prototype._getDoubles=function(v,o){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var h=[this],g=this,y=0;y<o;y+=v){for(var _=0;_<v;_++)g=g.dbl();h.push(g)}return{step:v,points:h}},c.prototype._getNAFPoints=function(v){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var o=[this],h=(1<<v)-1,g=h===1?null:this.dbl(),y=1;y<h;y++)o[y]=o[y-1].add(g);return{wnd:v,points:o}},c.prototype._getBeta=function(){return null},c.prototype.dblp=function(v){for(var o=this,h=0;h<v;h++)o=o.dbl();return o},zu}var Vu,vv;function Ew(){if(vv)return Vu;vv=1;var i=Zi(),e=$n(),r=De(),t=Ml(),a=i.assert;function n(v){t.call(this,"short",v),this.a=new e(v.a,16).toRed(this.red),this.b=new e(v.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(v),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}r(n,t),Vu=n,n.prototype._getEndomorphism=function(o){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var h,g;if(o.beta)h=new e(o.beta,16).toRed(this.red);else{var y=this._getEndoRoots(this.p);h=y[0].cmp(y[1])<0?y[0]:y[1],h=h.toRed(this.red)}if(o.lambda)g=new e(o.lambda,16);else{var _=this._getEndoRoots(this.n);this.g.mul(_[0]).x.cmp(this.g.x.redMul(h))===0?g=_[0]:(g=_[1],a(this.g.mul(g).x.cmp(this.g.x.redMul(h))===0))}var A;return o.basis?A=o.basis.map(function(S){return{a:new e(S.a,16),b:new e(S.b,16)}}):A=this._getEndoBasis(g),{beta:h,lambda:g,basis:A}}},n.prototype._getEndoRoots=function(o){var h=o===this.p?this.red:e.mont(o),g=new e(2).toRed(h).redInvm(),y=g.redNeg(),_=new e(3).toRed(h).redNeg().redSqrt().redMul(g),A=y.redAdd(_).fromRed(),S=y.redSub(_).fromRed();return[A,S]},n.prototype._getEndoBasis=function(o){for(var h=this.n.ushrn(Math.floor(this.n.bitLength()/2)),g=o,y=this.n.clone(),_=new e(1),A=new e(0),S=new e(0),T=new e(1),B,M,R,P,D,q,k,U=0,O,G;g.cmpn(0)!==0;){var E=y.div(g);O=y.sub(E.mul(g)),G=S.sub(E.mul(_));var s=T.sub(E.mul(A));if(!R&&O.cmp(h)<0)B=k.neg(),M=_,R=O.neg(),P=G;else if(R&&++U===2)break;k=O,y=g,g=O,S=_,_=G,T=A,A=s}D=O.neg(),q=G;var l=R.sqr().add(P.sqr()),d=D.sqr().add(q.sqr());return d.cmp(l)>=0&&(D=B,q=M),R.negative&&(R=R.neg(),P=P.neg()),D.negative&&(D=D.neg(),q=q.neg()),[{a:R,b:P},{a:D,b:q}]},n.prototype._endoSplit=function(o){var h=this.endo.basis,g=h[0],y=h[1],_=y.b.mul(o).divRound(this.n),A=g.b.neg().mul(o).divRound(this.n),S=_.mul(g.a),T=A.mul(y.a),B=_.mul(g.b),M=A.mul(y.b),R=o.sub(S).sub(T),P=B.add(M).neg();return{k1:R,k2:P}},n.prototype.pointFromX=function(o,h){o=new e(o,16),o.red||(o=o.toRed(this.red));var g=o.redSqr().redMul(o).redIAdd(o.redMul(this.a)).redIAdd(this.b),y=g.redSqrt();if(y.redSqr().redSub(g).cmp(this.zero)!==0)throw new Error("invalid point");var _=y.fromRed().isOdd();return(h&&!_||!h&&_)&&(y=y.redNeg()),this.point(o,y)},n.prototype.validate=function(o){if(o.inf)return!0;var h=o.x,g=o.y,y=this.a.redMul(h),_=h.redSqr().redMul(h).redIAdd(y).redIAdd(this.b);return g.redSqr().redISub(_).cmpn(0)===0},n.prototype._endoWnafMulAdd=function(o,h,g){for(var y=this._endoWnafT1,_=this._endoWnafT2,A=0;A<o.length;A++){var S=this._endoSplit(h[A]),T=o[A],B=T._getBeta();S.k1.negative&&(S.k1.ineg(),T=T.neg(!0)),S.k2.negative&&(S.k2.ineg(),B=B.neg(!0)),y[A*2]=T,y[A*2+1]=B,_[A*2]=S.k1,_[A*2+1]=S.k2}for(var M=this._wnafMulAdd(1,y,_,A*2,g),R=0;R<A*2;R++)y[R]=null,_[R]=null;return M};function c(v,o,h,g){t.BasePoint.call(this,v,"affine"),o===null&&h===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new e(o,16),this.y=new e(h,16),g&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}r(c,t.BasePoint),n.prototype.point=function(o,h,g){return new c(this,o,h,g)},n.prototype.pointFromJSON=function(o,h){return c.fromJSON(this,o,h)},c.prototype._getBeta=function(){if(this.curve.endo){var o=this.precomputed;if(o&&o.beta)return o.beta;var h=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(o){var g=this.curve,y=function(_){return g.point(_.x.redMul(g.endo.beta),_.y)};o.beta=h,h.precomputed={beta:null,naf:o.naf&&{wnd:o.naf.wnd,points:o.naf.points.map(y)},doubles:o.doubles&&{step:o.doubles.step,points:o.doubles.points.map(y)}}}return h}},c.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},c.fromJSON=function(o,h,g){typeof h=="string"&&(h=JSON.parse(h));var y=o.point(h[0],h[1],g);if(!h[2])return y;function _(S){return o.point(S[0],S[1],g)}var A=h[2];return y.precomputed={beta:null,doubles:A.doubles&&{step:A.doubles.step,points:[y].concat(A.doubles.points.map(_))},naf:A.naf&&{wnd:A.naf.wnd,points:[y].concat(A.naf.points.map(_))}},y},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.inf},c.prototype.add=function(o){if(this.inf)return o;if(o.inf)return this;if(this.eq(o))return this.dbl();if(this.neg().eq(o))return this.curve.point(null,null);if(this.x.cmp(o.x)===0)return this.curve.point(null,null);var h=this.y.redSub(o.y);h.cmpn(0)!==0&&(h=h.redMul(this.x.redSub(o.x).redInvm()));var g=h.redSqr().redISub(this.x).redISub(o.x),y=h.redMul(this.x.redSub(g)).redISub(this.y);return this.curve.point(g,y)},c.prototype.dbl=function(){if(this.inf)return this;var o=this.y.redAdd(this.y);if(o.cmpn(0)===0)return this.curve.point(null,null);var h=this.curve.a,g=this.x.redSqr(),y=o.redInvm(),_=g.redAdd(g).redIAdd(g).redIAdd(h).redMul(y),A=_.redSqr().redISub(this.x.redAdd(this.x)),S=_.redMul(this.x.redSub(A)).redISub(this.y);return this.curve.point(A,S)},c.prototype.getX=function(){return this.x.fromRed()},c.prototype.getY=function(){return this.y.fromRed()},c.prototype.mul=function(o){return o=new e(o,16),this.isInfinity()?this:this._hasDoubles(o)?this.curve._fixedNafMul(this,o):this.curve.endo?this.curve._endoWnafMulAdd([this],[o]):this.curve._wnafMul(this,o)},c.prototype.mulAdd=function(o,h,g){var y=[this,h],_=[o,g];return this.curve.endo?this.curve._endoWnafMulAdd(y,_):this.curve._wnafMulAdd(1,y,_,2)},c.prototype.jmulAdd=function(o,h,g){var y=[this,h],_=[o,g];return this.curve.endo?this.curve._endoWnafMulAdd(y,_,!0):this.curve._wnafMulAdd(1,y,_,2,!0)},c.prototype.eq=function(o){return this===o||this.inf===o.inf&&(this.inf||this.x.cmp(o.x)===0&&this.y.cmp(o.y)===0)},c.prototype.neg=function(o){if(this.inf)return this;var h=this.curve.point(this.x,this.y.redNeg());if(o&&this.precomputed){var g=this.precomputed,y=function(_){return _.neg()};h.precomputed={naf:g.naf&&{wnd:g.naf.wnd,points:g.naf.points.map(y)},doubles:g.doubles&&{step:g.doubles.step,points:g.doubles.points.map(y)}}}return h},c.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var o=this.curve.jpoint(this.x,this.y,this.curve.one);return o};function u(v,o,h,g){t.BasePoint.call(this,v,"jacobian"),o===null&&h===null&&g===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new e(0)):(this.x=new e(o,16),this.y=new e(h,16),this.z=new e(g,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}return r(u,t.BasePoint),n.prototype.jpoint=function(o,h,g){return new u(this,o,h,g)},u.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var o=this.z.redInvm(),h=o.redSqr(),g=this.x.redMul(h),y=this.y.redMul(h).redMul(o);return this.curve.point(g,y)},u.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},u.prototype.add=function(o){if(this.isInfinity())return o;if(o.isInfinity())return this;var h=o.z.redSqr(),g=this.z.redSqr(),y=this.x.redMul(h),_=o.x.redMul(g),A=this.y.redMul(h.redMul(o.z)),S=o.y.redMul(g.redMul(this.z)),T=y.redSub(_),B=A.redSub(S);if(T.cmpn(0)===0)return B.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var M=T.redSqr(),R=M.redMul(T),P=y.redMul(M),D=B.redSqr().redIAdd(R).redISub(P).redISub(P),q=B.redMul(P.redISub(D)).redISub(A.redMul(R)),k=this.z.redMul(o.z).redMul(T);return this.curve.jpoint(D,q,k)},u.prototype.mixedAdd=function(o){if(this.isInfinity())return o.toJ();if(o.isInfinity())return this;var h=this.z.redSqr(),g=this.x,y=o.x.redMul(h),_=this.y,A=o.y.redMul(h).redMul(this.z),S=g.redSub(y),T=_.redSub(A);if(S.cmpn(0)===0)return T.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var B=S.redSqr(),M=B.redMul(S),R=g.redMul(B),P=T.redSqr().redIAdd(M).redISub(R).redISub(R),D=T.redMul(R.redISub(P)).redISub(_.redMul(M)),q=this.z.redMul(S);return this.curve.jpoint(P,D,q)},u.prototype.dblp=function(o){if(o===0)return this;if(this.isInfinity())return this;if(!o)return this.dbl();var h;if(this.curve.zeroA||this.curve.threeA){var g=this;for(h=0;h<o;h++)g=g.dbl();return g}var y=this.curve.a,_=this.curve.tinv,A=this.x,S=this.y,T=this.z,B=T.redSqr().redSqr(),M=S.redAdd(S);for(h=0;h<o;h++){var R=A.redSqr(),P=M.redSqr(),D=P.redSqr(),q=R.redAdd(R).redIAdd(R).redIAdd(y.redMul(B)),k=A.redMul(P),U=q.redSqr().redISub(k.redAdd(k)),O=k.redISub(U),G=q.redMul(O);G=G.redIAdd(G).redISub(D);var E=M.redMul(T);h+1<o&&(B=B.redMul(D)),A=U,T=E,M=G}return this.curve.jpoint(A,M.redMul(_),T)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},u.prototype._zeroDbl=function(){var o,h,g;if(this.zOne){var y=this.x.redSqr(),_=this.y.redSqr(),A=_.redSqr(),S=this.x.redAdd(_).redSqr().redISub(y).redISub(A);S=S.redIAdd(S);var T=y.redAdd(y).redIAdd(y),B=T.redSqr().redISub(S).redISub(S),M=A.redIAdd(A);M=M.redIAdd(M),M=M.redIAdd(M),o=B,h=T.redMul(S.redISub(B)).redISub(M),g=this.y.redAdd(this.y)}else{var R=this.x.redSqr(),P=this.y.redSqr(),D=P.redSqr(),q=this.x.redAdd(P).redSqr().redISub(R).redISub(D);q=q.redIAdd(q);var k=R.redAdd(R).redIAdd(R),U=k.redSqr(),O=D.redIAdd(D);O=O.redIAdd(O),O=O.redIAdd(O),o=U.redISub(q).redISub(q),h=k.redMul(q.redISub(o)).redISub(O),g=this.y.redMul(this.z),g=g.redIAdd(g)}return this.curve.jpoint(o,h,g)},u.prototype._threeDbl=function(){var o,h,g;if(this.zOne){var y=this.x.redSqr(),_=this.y.redSqr(),A=_.redSqr(),S=this.x.redAdd(_).redSqr().redISub(y).redISub(A);S=S.redIAdd(S);var T=y.redAdd(y).redIAdd(y).redIAdd(this.curve.a),B=T.redSqr().redISub(S).redISub(S);o=B;var M=A.redIAdd(A);M=M.redIAdd(M),M=M.redIAdd(M),h=T.redMul(S.redISub(B)).redISub(M),g=this.y.redAdd(this.y)}else{var R=this.z.redSqr(),P=this.y.redSqr(),D=this.x.redMul(P),q=this.x.redSub(R).redMul(this.x.redAdd(R));q=q.redAdd(q).redIAdd(q);var k=D.redIAdd(D);k=k.redIAdd(k);var U=k.redAdd(k);o=q.redSqr().redISub(U),g=this.y.redAdd(this.z).redSqr().redISub(P).redISub(R);var O=P.redSqr();O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O),h=q.redMul(k.redISub(o)).redISub(O)}return this.curve.jpoint(o,h,g)},u.prototype._dbl=function(){var o=this.curve.a,h=this.x,g=this.y,y=this.z,_=y.redSqr().redSqr(),A=h.redSqr(),S=g.redSqr(),T=A.redAdd(A).redIAdd(A).redIAdd(o.redMul(_)),B=h.redAdd(h);B=B.redIAdd(B);var M=B.redMul(S),R=T.redSqr().redISub(M.redAdd(M)),P=M.redISub(R),D=S.redSqr();D=D.redIAdd(D),D=D.redIAdd(D),D=D.redIAdd(D);var q=T.redMul(P).redISub(D),k=g.redAdd(g).redMul(y);return this.curve.jpoint(R,q,k)},u.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var o=this.x.redSqr(),h=this.y.redSqr(),g=this.z.redSqr(),y=h.redSqr(),_=o.redAdd(o).redIAdd(o),A=_.redSqr(),S=this.x.redAdd(h).redSqr().redISub(o).redISub(y);S=S.redIAdd(S),S=S.redAdd(S).redIAdd(S),S=S.redISub(A);var T=S.redSqr(),B=y.redIAdd(y);B=B.redIAdd(B),B=B.redIAdd(B),B=B.redIAdd(B);var M=_.redIAdd(S).redSqr().redISub(A).redISub(T).redISub(B),R=h.redMul(M);R=R.redIAdd(R),R=R.redIAdd(R);var P=this.x.redMul(T).redISub(R);P=P.redIAdd(P),P=P.redIAdd(P);var D=this.y.redMul(M.redMul(B.redISub(M)).redISub(S.redMul(T)));D=D.redIAdd(D),D=D.redIAdd(D),D=D.redIAdd(D);var q=this.z.redAdd(S).redSqr().redISub(g).redISub(T);return this.curve.jpoint(P,D,q)},u.prototype.mul=function(o,h){return o=new e(o,h),this.curve._wnafMul(this,o)},u.prototype.eq=function(o){if(o.type==="affine")return this.eq(o.toJ());if(this===o)return!0;var h=this.z.redSqr(),g=o.z.redSqr();if(this.x.redMul(g).redISub(o.x.redMul(h)).cmpn(0)!==0)return!1;var y=h.redMul(this.z),_=g.redMul(o.z);return this.y.redMul(_).redISub(o.y.redMul(y)).cmpn(0)===0},u.prototype.eqXToP=function(o){var h=this.z.redSqr(),g=o.toRed(this.curve.red).redMul(h);if(this.x.cmp(g)===0)return!0;for(var y=o.clone(),_=this.curve.redN.redMul(h);;){if(y.iadd(this.curve.n),y.cmp(this.curve.p)>=0)return!1;if(g.redIAdd(_),this.x.cmp(g)===0)return!0}},u.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},u.prototype.isInfinity=function(){return this.z.cmpn(0)===0},Vu}var Gu,gv;function Aw(){if(gv)return Gu;gv=1;var i=$n(),e=De(),r=Ml(),t=Zi();function a(c){r.call(this,"mont",c),this.a=new i(c.a,16).toRed(this.red),this.b=new i(c.b,16).toRed(this.red),this.i4=new i(4).toRed(this.red).redInvm(),this.two=new i(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}e(a,r),Gu=a,a.prototype.validate=function(u){var v=u.normalize().x,o=v.redSqr(),h=o.redMul(v).redAdd(o.redMul(this.a)).redAdd(v),g=h.redSqrt();return g.redSqr().cmp(h)===0};function n(c,u,v){r.BasePoint.call(this,c,"projective"),u===null&&v===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new i(u,16),this.z=new i(v,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}return e(n,r.BasePoint),a.prototype.decodePoint=function(u,v){return this.point(t.toArray(u,v),1)},a.prototype.point=function(u,v){return new n(this,u,v)},a.prototype.pointFromJSON=function(u){return n.fromJSON(this,u)},n.prototype.precompute=function(){},n.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},n.fromJSON=function(u,v){return new n(u,v[0],v[1]||u.one)},n.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},n.prototype.isInfinity=function(){return this.z.cmpn(0)===0},n.prototype.dbl=function(){var u=this.x.redAdd(this.z),v=u.redSqr(),o=this.x.redSub(this.z),h=o.redSqr(),g=v.redSub(h),y=v.redMul(h),_=g.redMul(h.redAdd(this.curve.a24.redMul(g)));return this.curve.point(y,_)},n.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},n.prototype.diffAdd=function(u,v){var o=this.x.redAdd(this.z),h=this.x.redSub(this.z),g=u.x.redAdd(u.z),y=u.x.redSub(u.z),_=y.redMul(o),A=g.redMul(h),S=v.z.redMul(_.redAdd(A).redSqr()),T=v.x.redMul(_.redISub(A).redSqr());return this.curve.point(S,T)},n.prototype.mul=function(u){for(var v=u.clone(),o=this,h=this.curve.point(null,null),g=this,y=[];v.cmpn(0)!==0;v.iushrn(1))y.push(v.andln(1));for(var _=y.length-1;_>=0;_--)y[_]===0?(o=o.diffAdd(h,g),h=h.dbl()):(h=o.diffAdd(h,g),o=o.dbl());return h},n.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},n.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},n.prototype.eq=function(u){return this.getX().cmp(u.getX())===0},n.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},n.prototype.getX=function(){return this.normalize(),this.x.fromRed()},Gu}var Ku,mv;function Sw(){if(mv)return Ku;mv=1;var i=Zi(),e=$n(),r=De(),t=Ml(),a=i.assert;function n(u){this.twisted=(u.a|0)!==1,this.mOneA=this.twisted&&(u.a|0)===-1,this.extended=this.mOneA,t.call(this,"edwards",u),this.a=new e(u.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new e(u.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new e(u.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(u.c|0)===1}r(n,t),Ku=n,n.prototype._mulA=function(v){return this.mOneA?v.redNeg():this.a.redMul(v)},n.prototype._mulC=function(v){return this.oneC?v:this.c.redMul(v)},n.prototype.jpoint=function(v,o,h,g){return this.point(v,o,h,g)},n.prototype.pointFromX=function(v,o){v=new e(v,16),v.red||(v=v.toRed(this.red));var h=v.redSqr(),g=this.c2.redSub(this.a.redMul(h)),y=this.one.redSub(this.c2.redMul(this.d).redMul(h)),_=g.redMul(y.redInvm()),A=_.redSqrt();if(A.redSqr().redSub(_).cmp(this.zero)!==0)throw new Error("invalid point");var S=A.fromRed().isOdd();return(o&&!S||!o&&S)&&(A=A.redNeg()),this.point(v,A)},n.prototype.pointFromY=function(v,o){v=new e(v,16),v.red||(v=v.toRed(this.red));var h=v.redSqr(),g=h.redSub(this.c2),y=h.redMul(this.d).redMul(this.c2).redSub(this.a),_=g.redMul(y.redInvm());if(_.cmp(this.zero)===0){if(o)throw new Error("invalid point");return this.point(this.zero,v)}var A=_.redSqrt();if(A.redSqr().redSub(_).cmp(this.zero)!==0)throw new Error("invalid point");return A.fromRed().isOdd()!==o&&(A=A.redNeg()),this.point(A,v)},n.prototype.validate=function(v){if(v.isInfinity())return!0;v.normalize();var o=v.x.redSqr(),h=v.y.redSqr(),g=o.redMul(this.a).redAdd(h),y=this.c2.redMul(this.one.redAdd(this.d.redMul(o).redMul(h)));return g.cmp(y)===0};function c(u,v,o,h,g){t.BasePoint.call(this,u,"projective"),v===null&&o===null&&h===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new e(v,16),this.y=new e(o,16),this.z=h?new e(h,16):this.curve.one,this.t=g&&new e(g,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}return r(c,t.BasePoint),n.prototype.pointFromJSON=function(v){return c.fromJSON(this,v)},n.prototype.point=function(v,o,h,g){return new c(this,v,o,h,g)},c.fromJSON=function(v,o){return new c(v,o[0],o[1],o[2])},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},c.prototype._extDbl=function(){var v=this.x.redSqr(),o=this.y.redSqr(),h=this.z.redSqr();h=h.redIAdd(h);var g=this.curve._mulA(v),y=this.x.redAdd(this.y).redSqr().redISub(v).redISub(o),_=g.redAdd(o),A=_.redSub(h),S=g.redSub(o),T=y.redMul(A),B=_.redMul(S),M=y.redMul(S),R=A.redMul(_);return this.curve.point(T,B,R,M)},c.prototype._projDbl=function(){var v=this.x.redAdd(this.y).redSqr(),o=this.x.redSqr(),h=this.y.redSqr(),g,y,_,A,S,T;if(this.curve.twisted){A=this.curve._mulA(o);var B=A.redAdd(h);this.zOne?(g=v.redSub(o).redSub(h).redMul(B.redSub(this.curve.two)),y=B.redMul(A.redSub(h)),_=B.redSqr().redSub(B).redSub(B)):(S=this.z.redSqr(),T=B.redSub(S).redISub(S),g=v.redSub(o).redISub(h).redMul(T),y=B.redMul(A.redSub(h)),_=B.redMul(T))}else A=o.redAdd(h),S=this.curve._mulC(this.z).redSqr(),T=A.redSub(S).redSub(S),g=this.curve._mulC(v.redISub(A)).redMul(T),y=this.curve._mulC(A).redMul(o.redISub(h)),_=A.redMul(T);return this.curve.point(g,y,_)},c.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},c.prototype._extAdd=function(v){var o=this.y.redSub(this.x).redMul(v.y.redSub(v.x)),h=this.y.redAdd(this.x).redMul(v.y.redAdd(v.x)),g=this.t.redMul(this.curve.dd).redMul(v.t),y=this.z.redMul(v.z.redAdd(v.z)),_=h.redSub(o),A=y.redSub(g),S=y.redAdd(g),T=h.redAdd(o),B=_.redMul(A),M=S.redMul(T),R=_.redMul(T),P=A.redMul(S);return this.curve.point(B,M,P,R)},c.prototype._projAdd=function(v){var o=this.z.redMul(v.z),h=o.redSqr(),g=this.x.redMul(v.x),y=this.y.redMul(v.y),_=this.curve.d.redMul(g).redMul(y),A=h.redSub(_),S=h.redAdd(_),T=this.x.redAdd(this.y).redMul(v.x.redAdd(v.y)).redISub(g).redISub(y),B=o.redMul(A).redMul(T),M,R;return this.curve.twisted?(M=o.redMul(S).redMul(y.redSub(this.curve._mulA(g))),R=A.redMul(S)):(M=o.redMul(S).redMul(y.redSub(g)),R=this.curve._mulC(A).redMul(S)),this.curve.point(B,M,R)},c.prototype.add=function(v){return this.isInfinity()?v:v.isInfinity()?this:this.curve.extended?this._extAdd(v):this._projAdd(v)},c.prototype.mul=function(v){return this._hasDoubles(v)?this.curve._fixedNafMul(this,v):this.curve._wnafMul(this,v)},c.prototype.mulAdd=function(v,o,h){return this.curve._wnafMulAdd(1,[this,o],[v,h],2,!1)},c.prototype.jmulAdd=function(v,o,h){return this.curve._wnafMulAdd(1,[this,o],[v,h],2,!0)},c.prototype.normalize=function(){if(this.zOne)return this;var v=this.z.redInvm();return this.x=this.x.redMul(v),this.y=this.y.redMul(v),this.t&&(this.t=this.t.redMul(v)),this.z=this.curve.one,this.zOne=!0,this},c.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()},c.prototype.getY=function(){return this.normalize(),this.y.fromRed()},c.prototype.eq=function(v){return this===v||this.getX().cmp(v.getX())===0&&this.getY().cmp(v.getY())===0},c.prototype.eqXToP=function(v){var o=v.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(o)===0)return!0;for(var h=v.clone(),g=this.curve.redN.redMul(this.z);;){if(h.iadd(this.curve.n),h.cmp(this.curve.p)>=0)return!1;if(o.redIAdd(g),this.x.cmp(o)===0)return!0}},c.prototype.toP=c.prototype.normalize,c.prototype.mixedAdd=c.prototype.add,Ku}var yv;function Vy(){return yv||(yv=1,function(i){var e=i;e.base=Ml(),e.short=Ew(),e.mont=Aw(),e.edwards=Sw()}(qu)),qu}var Hu={},Qu={},xr={},bv;function xn(){if(bv)return xr;bv=1;var i=ki(),e=De();xr.inherits=e;function r(s,l){return(s.charCodeAt(l)&64512)!==55296||l<0||l+1>=s.length?!1:(s.charCodeAt(l+1)&64512)===56320}function t(s,l){if(Array.isArray(s))return s.slice();if(!s)return[];var d=[];if(typeof s=="string")if(l){if(l==="hex")for(s=s.replace(/[^a-z0-9]+/ig,""),s.length%2!==0&&(s="0"+s),m=0;m<s.length;m+=2)d.push(parseInt(s[m]+s[m+1],16))}else for(var p=0,m=0;m<s.length;m++){var w=s.charCodeAt(m);w<128?d[p++]=w:w<2048?(d[p++]=w>>6|192,d[p++]=w&63|128):r(s,m)?(w=65536+((w&1023)<<10)+(s.charCodeAt(++m)&1023),d[p++]=w>>18|240,d[p++]=w>>12&63|128,d[p++]=w>>6&63|128,d[p++]=w&63|128):(d[p++]=w>>12|224,d[p++]=w>>6&63|128,d[p++]=w&63|128)}else for(m=0;m<s.length;m++)d[m]=s[m]|0;return d}xr.toArray=t;function a(s){for(var l="",d=0;d<s.length;d++)l+=u(s[d].toString(16));return l}xr.toHex=a;function n(s){var l=s>>>24|s>>>8&65280|s<<8&16711680|(s&255)<<24;return l>>>0}xr.htonl=n;function c(s,l){for(var d="",p=0;p<s.length;p++){var m=s[p];l==="little"&&(m=n(m)),d+=v(m.toString(16))}return d}xr.toHex32=c;function u(s){return s.length===1?"0"+s:s}xr.zero2=u;function v(s){return s.length===7?"0"+s:s.length===6?"00"+s:s.length===5?"000"+s:s.length===4?"0000"+s:s.length===3?"00000"+s:s.length===2?"000000"+s:s.length===1?"0000000"+s:s}xr.zero8=v;function o(s,l,d,p){var m=d-l;i(m%4===0);for(var w=new Array(m/4),x=0,b=l;x<w.length;x++,b+=4){var f;p==="big"?f=s[b]<<24|s[b+1]<<16|s[b+2]<<8|s[b+3]:f=s[b+3]<<24|s[b+2]<<16|s[b+1]<<8|s[b],w[x]=f>>>0}return w}xr.join32=o;function h(s,l){for(var d=new Array(s.length*4),p=0,m=0;p<s.length;p++,m+=4){var w=s[p];l==="big"?(d[m]=w>>>24,d[m+1]=w>>>16&255,d[m+2]=w>>>8&255,d[m+3]=w&255):(d[m+3]=w>>>24,d[m+2]=w>>>16&255,d[m+1]=w>>>8&255,d[m]=w&255)}return d}xr.split32=h;function g(s,l){return s>>>l|s<<32-l}xr.rotr32=g;function y(s,l){return s<<l|s>>>32-l}xr.rotl32=y;function _(s,l){return s+l>>>0}xr.sum32=_;function A(s,l,d){return s+l+d>>>0}xr.sum32_3=A;function S(s,l,d,p){return s+l+d+p>>>0}xr.sum32_4=S;function T(s,l,d,p,m){return s+l+d+p+m>>>0}xr.sum32_5=T;function B(s,l,d,p){var m=s[l],w=s[l+1],x=p+w>>>0,b=(x<p?1:0)+d+m;s[l]=b>>>0,s[l+1]=x}xr.sum64=B;function M(s,l,d,p){var m=l+p>>>0,w=(m<l?1:0)+s+d;return w>>>0}xr.sum64_hi=M;function R(s,l,d,p){var m=l+p;return m>>>0}xr.sum64_lo=R;function P(s,l,d,p,m,w,x,b){var f=0,C=l;C=C+p>>>0,f+=C<l?1:0,C=C+w>>>0,f+=C<w?1:0,C=C+b>>>0,f+=C<b?1:0;var F=s+d+m+x+f;return F>>>0}xr.sum64_4_hi=P;function D(s,l,d,p,m,w,x,b){var f=l+p+w+b;return f>>>0}xr.sum64_4_lo=D;function q(s,l,d,p,m,w,x,b,f,C){var F=0,z=l;z=z+p>>>0,F+=z<l?1:0,z=z+w>>>0,F+=z<w?1:0,z=z+b>>>0,F+=z<b?1:0,z=z+C>>>0,F+=z<C?1:0;var W=s+d+m+x+f+F;return W>>>0}xr.sum64_5_hi=q;function k(s,l,d,p,m,w,x,b,f,C){var F=l+p+w+b+C;return F>>>0}xr.sum64_5_lo=k;function U(s,l,d){var p=l<<32-d|s>>>d;return p>>>0}xr.rotr64_hi=U;function O(s,l,d){var p=s<<32-d|l>>>d;return p>>>0}xr.rotr64_lo=O;function G(s,l,d){return s>>>d}xr.shr64_hi=G;function E(s,l,d){var p=s<<32-d|l>>>d;return p>>>0}return xr.shr64_lo=E,xr}var $u={},_v;function Go(){if(_v)return $u;_v=1;var i=xn(),e=ki();function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return $u.BlockHash=r,r.prototype.update=function(a,n){if(a=i.toArray(a,n),this.pending?this.pending=this.pending.concat(a):this.pending=a,this.pendingTotal+=a.length,this.pending.length>=this._delta8){a=this.pending;var c=a.length%this._delta8;this.pending=a.slice(a.length-c,a.length),this.pending.length===0&&(this.pending=null),a=i.join32(a,0,a.length-c,this.endian);for(var u=0;u<a.length;u+=this._delta32)this._update(a,u,u+this._delta32)}return this},r.prototype.digest=function(a){return this.update(this._pad()),e(this.pending===null),this._digest(a)},r.prototype._pad=function(){var a=this.pendingTotal,n=this._delta8,c=n-(a+this.padLength)%n,u=new Array(c+this.padLength);u[0]=128;for(var v=1;v<c;v++)u[v]=0;if(a<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)u[v++]=0;u[v++]=0,u[v++]=0,u[v++]=0,u[v++]=0,u[v++]=a>>>24&255,u[v++]=a>>>16&255,u[v++]=a>>>8&255,u[v++]=a&255}else for(u[v++]=a&255,u[v++]=a>>>8&255,u[v++]=a>>>16&255,u[v++]=a>>>24&255,u[v++]=0,u[v++]=0,u[v++]=0,u[v++]=0,o=8;o<this.padLength;o++)u[v++]=0;return u},$u}var xa={},ln={},wv;function Gy(){if(wv)return ln;wv=1;var i=xn(),e=i.rotr32;function r(h,g,y,_){if(h===0)return t(g,y,_);if(h===1||h===3)return n(g,y,_);if(h===2)return a(g,y,_)}ln.ft_1=r;function t(h,g,y){return h&g^~h&y}ln.ch32=t;function a(h,g,y){return h&g^h&y^g&y}ln.maj32=a;function n(h,g,y){return h^g^y}ln.p32=n;function c(h){return e(h,2)^e(h,13)^e(h,22)}ln.s0_256=c;function u(h){return e(h,6)^e(h,11)^e(h,25)}ln.s1_256=u;function v(h){return e(h,7)^e(h,18)^h>>>3}ln.g0_256=v;function o(h){return e(h,17)^e(h,19)^h>>>10}return ln.g1_256=o,ln}var Zu,Cv;function xw(){if(Cv)return Zu;Cv=1;var i=xn(),e=Go(),r=Gy(),t=i.rotl32,a=i.sum32,n=i.sum32_5,c=r.ft_1,u=e.BlockHash,v=[1518500249,1859775393,2400959708,3395469782];function o(){if(!(this instanceof o))return new o;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return i.inherits(o,u),Zu=o,o.blockSize=512,o.outSize=160,o.hmacStrength=80,o.padLength=64,o.prototype._update=function(g,y){for(var _=this.W,A=0;A<16;A++)_[A]=g[y+A];for(;A<_.length;A++)_[A]=t(_[A-3]^_[A-8]^_[A-14]^_[A-16],1);var S=this.h[0],T=this.h[1],B=this.h[2],M=this.h[3],R=this.h[4];for(A=0;A<_.length;A++){var P=~~(A/20),D=n(t(S,5),c(P,T,B,M),R,_[A],v[P]);R=M,M=B,B=t(T,30),T=S,S=D}this.h[0]=a(this.h[0],S),this.h[1]=a(this.h[1],T),this.h[2]=a(this.h[2],B),this.h[3]=a(this.h[3],M),this.h[4]=a(this.h[4],R)},o.prototype._digest=function(g){return g==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")},Zu}var ju,Ev;function Ky(){if(Ev)return ju;Ev=1;var i=xn(),e=Go(),r=Gy(),t=ki(),a=i.sum32,n=i.sum32_4,c=i.sum32_5,u=r.ch32,v=r.maj32,o=r.s0_256,h=r.s1_256,g=r.g0_256,y=r.g1_256,_=e.BlockHash,A=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function S(){if(!(this instanceof S))return new S;_.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=A,this.W=new Array(64)}return i.inherits(S,_),ju=S,S.blockSize=512,S.outSize=256,S.hmacStrength=192,S.padLength=64,S.prototype._update=function(B,M){for(var R=this.W,P=0;P<16;P++)R[P]=B[M+P];for(;P<R.length;P++)R[P]=n(y(R[P-2]),R[P-7],g(R[P-15]),R[P-16]);var D=this.h[0],q=this.h[1],k=this.h[2],U=this.h[3],O=this.h[4],G=this.h[5],E=this.h[6],s=this.h[7];for(t(this.k.length===R.length),P=0;P<R.length;P++){var l=c(s,h(O),u(O,G,E),this.k[P],R[P]),d=a(o(D),v(D,q,k));s=E,E=G,G=O,O=a(U,l),U=k,k=q,q=D,D=a(l,d)}this.h[0]=a(this.h[0],D),this.h[1]=a(this.h[1],q),this.h[2]=a(this.h[2],k),this.h[3]=a(this.h[3],U),this.h[4]=a(this.h[4],O),this.h[5]=a(this.h[5],G),this.h[6]=a(this.h[6],E),this.h[7]=a(this.h[7],s)},S.prototype._digest=function(B){return B==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")},ju}var Wu,Av;function Iw(){if(Av)return Wu;Av=1;var i=xn(),e=Ky();function r(){if(!(this instanceof r))return new r;e.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return i.inherits(r,e),Wu=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(a){return a==="hex"?i.toHex32(this.h.slice(0,7),"big"):i.split32(this.h.slice(0,7),"big")},Wu}var Yu,Sv;function Hy(){if(Sv)return Yu;Sv=1;var i=xn(),e=Go(),r=ki(),t=i.rotr64_hi,a=i.rotr64_lo,n=i.shr64_hi,c=i.shr64_lo,u=i.sum64,v=i.sum64_hi,o=i.sum64_lo,h=i.sum64_4_hi,g=i.sum64_4_lo,y=i.sum64_5_hi,_=i.sum64_5_lo,A=e.BlockHash,S=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function T(){if(!(this instanceof T))return new T;A.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=S,this.W=new Array(160)}i.inherits(T,A),Yu=T,T.blockSize=1024,T.outSize=512,T.hmacStrength=192,T.padLength=128,T.prototype._prepareBlock=function(d,p){for(var m=this.W,w=0;w<32;w++)m[w]=d[p+w];for(;w<m.length;w+=2){var x=E(m[w-4],m[w-3]),b=s(m[w-4],m[w-3]),f=m[w-14],C=m[w-13],F=O(m[w-30],m[w-29]),z=G(m[w-30],m[w-29]),W=m[w-32],$=m[w-31];m[w]=h(x,b,f,C,F,z,W,$),m[w+1]=g(x,b,f,C,F,z,W,$)}},T.prototype._update=function(d,p){this._prepareBlock(d,p);var m=this.W,w=this.h[0],x=this.h[1],b=this.h[2],f=this.h[3],C=this.h[4],F=this.h[5],z=this.h[6],W=this.h[7],$=this.h[8],I=this.h[9],K=this.h[10],N=this.h[11],X=this.h[12],Q=this.h[13],L=this.h[14],V=this.h[15];r(this.k.length===m.length);for(var Z=0;Z<m.length;Z+=2){var H=L,j=V,et=k($,I),nt=U($,I),st=B($,I,K,N,X),ft=M($,I,K,N,X,Q),vt=this.k[Z],ot=this.k[Z+1],pt=m[Z],Ut=m[Z+1],At=y(H,j,et,nt,st,ft,vt,ot,pt,Ut),It=_(H,j,et,nt,st,ft,vt,ot,pt,Ut);H=D(w,x),j=q(w,x),et=R(w,x,b,f,C),nt=P(w,x,b,f,C,F);var Jt=v(H,j,et,nt),at=o(H,j,et,nt);L=X,V=Q,X=K,Q=N,K=$,N=I,$=v(z,W,At,It),I=o(W,W,At,It),z=C,W=F,C=b,F=f,b=w,f=x,w=v(At,It,Jt,at),x=o(At,It,Jt,at)}u(this.h,0,w,x),u(this.h,2,b,f),u(this.h,4,C,F),u(this.h,6,z,W),u(this.h,8,$,I),u(this.h,10,K,N),u(this.h,12,X,Q),u(this.h,14,L,V)},T.prototype._digest=function(d){return d==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")};function B(l,d,p,m,w){var x=l&p^~l&w;return x<0&&(x+=4294967296),x}function M(l,d,p,m,w,x){var b=d&m^~d&x;return b<0&&(b+=4294967296),b}function R(l,d,p,m,w){var x=l&p^l&w^p&w;return x<0&&(x+=4294967296),x}function P(l,d,p,m,w,x){var b=d&m^d&x^m&x;return b<0&&(b+=4294967296),b}function D(l,d){var p=t(l,d,28),m=t(d,l,2),w=t(d,l,7),x=p^m^w;return x<0&&(x+=4294967296),x}function q(l,d){var p=a(l,d,28),m=a(d,l,2),w=a(d,l,7),x=p^m^w;return x<0&&(x+=4294967296),x}function k(l,d){var p=t(l,d,14),m=t(l,d,18),w=t(d,l,9),x=p^m^w;return x<0&&(x+=4294967296),x}function U(l,d){var p=a(l,d,14),m=a(l,d,18),w=a(d,l,9),x=p^m^w;return x<0&&(x+=4294967296),x}function O(l,d){var p=t(l,d,1),m=t(l,d,8),w=n(l,d,7),x=p^m^w;return x<0&&(x+=4294967296),x}function G(l,d){var p=a(l,d,1),m=a(l,d,8),w=c(l,d,7),x=p^m^w;return x<0&&(x+=4294967296),x}function E(l,d){var p=t(l,d,19),m=t(d,l,29),w=n(l,d,6),x=p^m^w;return x<0&&(x+=4294967296),x}function s(l,d){var p=a(l,d,19),m=a(d,l,29),w=c(l,d,6),x=p^m^w;return x<0&&(x+=4294967296),x}return Yu}var Xu,xv;function Mw(){if(xv)return Xu;xv=1;var i=xn(),e=Hy();function r(){if(!(this instanceof r))return new r;e.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return i.inherits(r,e),Xu=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(a){return a==="hex"?i.toHex32(this.h.slice(0,12),"big"):i.split32(this.h.slice(0,12),"big")},Xu}var Iv;function Bw(){return Iv||(Iv=1,xa.sha1=xw(),xa.sha224=Iw(),xa.sha256=Ky(),xa.sha384=Mw(),xa.sha512=Hy()),xa}var Ju={},Mv;function Lw(){if(Mv)return Ju;Mv=1;var i=xn(),e=Go(),r=i.rotl32,t=i.sum32,a=i.sum32_3,n=i.sum32_4,c=e.BlockHash;function u(){if(!(this instanceof u))return new u;c.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}i.inherits(u,c),Ju.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(T,B){for(var M=this.h[0],R=this.h[1],P=this.h[2],D=this.h[3],q=this.h[4],k=M,U=R,O=P,G=D,E=q,s=0;s<80;s++){var l=t(r(n(M,v(s,R,P,D),T[g[s]+B],o(s)),_[s]),q);M=q,q=D,D=r(P,10),P=R,R=l,l=t(r(n(k,v(79-s,U,O,G),T[y[s]+B],h(s)),A[s]),E),k=E,E=G,G=r(O,10),O=U,U=l}l=a(this.h[1],P,G),this.h[1]=a(this.h[2],D,E),this.h[2]=a(this.h[3],q,k),this.h[3]=a(this.h[4],M,U),this.h[4]=a(this.h[0],R,O),this.h[0]=l},u.prototype._digest=function(T){return T==="hex"?i.toHex32(this.h,"little"):i.split32(this.h,"little")};function v(S,T,B,M){return S<=15?T^B^M:S<=31?T&B|~T&M:S<=47?(T|~B)^M:S<=63?T&M|B&~M:T^(B|~M)}function o(S){return S<=15?0:S<=31?1518500249:S<=47?1859775393:S<=63?2400959708:2840853838}function h(S){return S<=15?1352829926:S<=31?1548603684:S<=47?1836072691:S<=63?2053994217:0}var g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],y=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],_=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],A=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return Ju}var t0,Bv;function Tw(){if(Bv)return t0;Bv=1;var i=xn(),e=ki();function r(t,a,n){if(!(this instanceof r))return new r(t,a,n);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(i.toArray(a,n))}return t0=r,r.prototype._init=function(a){a.length>this.blockSize&&(a=new this.Hash().update(a).digest()),e(a.length<=this.blockSize);for(var n=a.length;n<this.blockSize;n++)a.push(0);for(n=0;n<a.length;n++)a[n]^=54;for(this.inner=new this.Hash().update(a),n=0;n<a.length;n++)a[n]^=106;this.outer=new this.Hash().update(a)},r.prototype.update=function(a,n){return this.inner.update(a,n),this},r.prototype.digest=function(a){return this.outer.update(this.inner.digest()),this.outer.digest(a)},t0}var Lv;function Ko(){return Lv||(Lv=1,function(i){var e=i;e.utils=xn(),e.common=Go(),e.sha=Bw(),e.ripemd=Lw(),e.hmac=Tw(),e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160}(Qu)),Qu}var e0,Tv;function Rw(){return Tv||(Tv=1,e0={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),e0}var Rv;function d1(){return Rv||(Rv=1,function(i){var e=i,r=Ko(),t=Vy(),a=Zi(),n=a.assert;function c(o){o.type==="short"?this.curve=new t.short(o):o.type==="edwards"?this.curve=new t.edwards(o):this.curve=new t.mont(o),this.g=this.curve.g,this.n=this.curve.n,this.hash=o.hash,n(this.g.validate(),"Invalid curve"),n(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=c;function u(o,h){Object.defineProperty(e,o,{configurable:!0,enumerable:!0,get:function(){var g=new c(h);return Object.defineProperty(e,o,{configurable:!0,enumerable:!0,value:g}),g}})}u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var v;try{v=Rw()}catch{v=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",v]})}(Hu)),Hu}var r0,Nv;function Qy(){if(Nv)return r0;Nv=1;var i=Ko(),e=h1(),r=ki();function t(a){if(!(this instanceof t))return new t(a);this.hash=a.hash,this.predResist=!!a.predResist,this.outLen=this.hash.outSize,this.minEntropy=a.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var n=e.toArray(a.entropy,a.entropyEnc||"hex"),c=e.toArray(a.nonce,a.nonceEnc||"hex"),u=e.toArray(a.pers,a.persEnc||"hex");r(n.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(n,c,u)}return r0=t,t.prototype._init=function(n,c,u){var v=n.concat(c).concat(u);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var o=0;o<this.V.length;o++)this.K[o]=0,this.V[o]=1;this._update(v),this._reseed=1,this.reseedInterval=281474976710656},t.prototype._hmac=function(){return new i.hmac(this.hash,this.K)},t.prototype._update=function(n){var c=this._hmac().update(this.V).update([0]);n&&(c=c.update(n)),this.K=c.digest(),this.V=this._hmac().update(this.V).digest(),n&&(this.K=this._hmac().update(this.V).update([1]).update(n).digest(),this.V=this._hmac().update(this.V).digest())},t.prototype.reseed=function(n,c,u,v){typeof c!="string"&&(v=u,u=c,c=null),n=e.toArray(n,c),u=e.toArray(u,v),r(n.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(n.concat(u||[])),this._reseed=1},t.prototype.generate=function(n,c,u,v){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof c!="string"&&(v=u,u=c,c=null),u&&(u=e.toArray(u,v||"hex"),this._update(u));for(var o=[];o.length<n;)this.V=this._hmac().update(this.V).digest(),o=o.concat(this.V);var h=o.slice(0,n);return this._update(u),this._reseed++,e.encode(h,c)},r0}var i0,kv;function Nw(){if(kv)return i0;kv=1;var i=$n(),e=Zi(),r=e.assert;function t(a,n){this.ec=a,this.priv=null,this.pub=null,n.priv&&this._importPrivate(n.priv,n.privEnc),n.pub&&this._importPublic(n.pub,n.pubEnc)}return i0=t,t.fromPublic=function(n,c,u){return c instanceof t?c:new t(n,{pub:c,pubEnc:u})},t.fromPrivate=function(n,c,u){return c instanceof t?c:new t(n,{priv:c,privEnc:u})},t.prototype.validate=function(){var n=this.getPublic();return n.isInfinity()?{result:!1,reason:"Invalid public key"}:n.validate()?n.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},t.prototype.getPublic=function(n,c){return typeof n=="string"&&(c=n,n=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),c?this.pub.encode(c,n):this.pub},t.prototype.getPrivate=function(n){return n==="hex"?this.priv.toString(16,2):this.priv},t.prototype._importPrivate=function(n,c){this.priv=new i(n,c||16),this.priv=this.priv.umod(this.ec.curve.n)},t.prototype._importPublic=function(n,c){if(n.x||n.y){this.ec.curve.type==="mont"?r(n.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&r(n.x&&n.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(n.x,n.y);return}this.pub=this.ec.curve.decodePoint(n,c)},t.prototype.derive=function(n){return n.validate()||r(n.validate(),"public point not validated"),n.mul(this.priv).getX()},t.prototype.sign=function(n,c,u){return this.ec.sign(n,this,c,u)},t.prototype.verify=function(n,c,u){return this.ec.verify(n,c,this,void 0,u)},t.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"},i0}var n0,Pv;function kw(){if(Pv)return n0;Pv=1;var i=$n(),e=Zi(),r=e.assert;function t(v,o){if(v instanceof t)return v;this._importDER(v,o)||(r(v.r&&v.s,"Signature without r or s"),this.r=new i(v.r,16),this.s=new i(v.s,16),v.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=v.recoveryParam)}n0=t;function a(){this.place=0}function n(v,o){var h=v[o.place++];if(!(h&128))return h;var g=h&15;if(g===0||g>4||v[o.place]===0)return!1;for(var y=0,_=0,A=o.place;_<g;_++,A++)y<<=8,y|=v[A],y>>>=0;return y<=127?!1:(o.place=A,y)}function c(v){for(var o=0,h=v.length-1;!v[o]&&!(v[o+1]&128)&&o<h;)o++;return o===0?v:v.slice(o)}t.prototype._importDER=function(o,h){o=e.toArray(o,h);var g=new a;if(o[g.place++]!==48)return!1;var y=n(o,g);if(y===!1||y+g.place!==o.length||o[g.place++]!==2)return!1;var _=n(o,g);if(_===!1||o[g.place]&128)return!1;var A=o.slice(g.place,_+g.place);if(g.place+=_,o[g.place++]!==2)return!1;var S=n(o,g);if(S===!1||o.length!==S+g.place||o[g.place]&128)return!1;var T=o.slice(g.place,S+g.place);if(A[0]===0)if(A[1]&128)A=A.slice(1);else return!1;if(T[0]===0)if(T[1]&128)T=T.slice(1);else return!1;return this.r=new i(A),this.s=new i(T),this.recoveryParam=null,!0};function u(v,o){if(o<128){v.push(o);return}var h=1+(Math.log(o)/Math.LN2>>>3);for(v.push(h|128);--h;)v.push(o>>>(h<<3)&255);v.push(o)}return t.prototype.toDER=function(o){var h=this.r.toArray(),g=this.s.toArray();for(h[0]&128&&(h=[0].concat(h)),g[0]&128&&(g=[0].concat(g)),h=c(h),g=c(g);!g[0]&&!(g[1]&128);)g=g.slice(1);var y=[2];u(y,h.length),y=y.concat(h),y.push(2),u(y,g.length);var _=y.concat(g),A=[48];return u(A,_.length),A=A.concat(_),e.encode(A,o)},n0}var a0,Uv;function Pw(){if(Uv)return a0;Uv=1;var i=$n(),e=Qy(),r=Zi(),t=d1(),a=zo(),n=r.assert,c=Nw(),u=kw();function v(o){if(!(this instanceof v))return new v(o);typeof o=="string"&&(n(Object.prototype.hasOwnProperty.call(t,o),"Unknown curve "+o),o=t[o]),o instanceof t.PresetCurve&&(o={curve:o}),this.curve=o.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=o.curve.g,this.g.precompute(o.curve.n.bitLength()+1),this.hash=o.hash||o.curve.hash}return a0=v,v.prototype.keyPair=function(h){return new c(this,h)},v.prototype.keyFromPrivate=function(h,g){return c.fromPrivate(this,h,g)},v.prototype.keyFromPublic=function(h,g){return c.fromPublic(this,h,g)},v.prototype.genKeyPair=function(h){h||(h={});for(var g=new e({hash:this.hash,pers:h.pers,persEnc:h.persEnc||"utf8",entropy:h.entropy||a(this.hash.hmacStrength),entropyEnc:h.entropy&&h.entropyEnc||"utf8",nonce:this.n.toArray()}),y=this.n.byteLength(),_=this.n.sub(new i(2));;){var A=new i(g.generate(y));if(!(A.cmp(_)>0))return A.iaddn(1),this.keyFromPrivate(A)}},v.prototype._truncateToN=function(h,g,y){var _;if(i.isBN(h)||typeof h=="number")h=new i(h,16),_=h.byteLength();else if(typeof h=="object")_=h.length,h=new i(h,16);else{var A=h.toString();_=A.length+1>>>1,h=new i(A,16)}typeof y!="number"&&(y=_*8);var S=y-this.n.bitLength();return S>0&&(h=h.ushrn(S)),!g&&h.cmp(this.n)>=0?h.sub(this.n):h},v.prototype.sign=function(h,g,y,_){if(typeof y=="object"&&(_=y,y=null),_||(_={}),typeof h!="string"&&typeof h!="number"&&!i.isBN(h)){n(typeof h=="object"&&h&&typeof h.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),n(h.length>>>0===h.length);for(var A=0;A<h.length;A++)n((h[A]&255)===h[A])}g=this.keyFromPrivate(g,y),h=this._truncateToN(h,!1,_.msgBitLength),n(!h.isNeg(),"Can not sign a negative message");var S=this.n.byteLength(),T=g.getPrivate().toArray("be",S),B=h.toArray("be",S);n(new i(B).eq(h),"Can not sign message");for(var M=new e({hash:this.hash,entropy:T,nonce:B,pers:_.pers,persEnc:_.persEnc||"utf8"}),R=this.n.sub(new i(1)),P=0;;P++){var D=_.k?_.k(P):new i(M.generate(this.n.byteLength()));if(D=this._truncateToN(D,!0),!(D.cmpn(1)<=0||D.cmp(R)>=0)){var q=this.g.mul(D);if(!q.isInfinity()){var k=q.getX(),U=k.umod(this.n);if(U.cmpn(0)!==0){var O=D.invm(this.n).mul(U.mul(g.getPrivate()).iadd(h));if(O=O.umod(this.n),O.cmpn(0)!==0){var G=(q.getY().isOdd()?1:0)|(k.cmp(U)!==0?2:0);return _.canonical&&O.cmp(this.nh)>0&&(O=this.n.sub(O),G^=1),new u({r:U,s:O,recoveryParam:G})}}}}}},v.prototype.verify=function(h,g,y,_,A){A||(A={}),h=this._truncateToN(h,!1,A.msgBitLength),y=this.keyFromPublic(y,_),g=new u(g,"hex");var S=g.r,T=g.s;if(S.cmpn(1)<0||S.cmp(this.n)>=0||T.cmpn(1)<0||T.cmp(this.n)>=0)return!1;var B=T.invm(this.n),M=B.mul(h).umod(this.n),R=B.mul(S).umod(this.n),P;return this.curve._maxwellTrick?(P=this.g.jmulAdd(M,y.getPublic(),R),P.isInfinity()?!1:P.eqXToP(S)):(P=this.g.mulAdd(M,y.getPublic(),R),P.isInfinity()?!1:P.getX().umod(this.n).cmp(S)===0)},v.prototype.recoverPubKey=function(o,h,g,y){n((3&g)===g,"The recovery param is more than two bits"),h=new u(h,y);var _=this.n,A=new i(o),S=h.r,T=h.s,B=g&1,M=g>>1;if(S.cmp(this.curve.p.umod(this.curve.n))>=0&&M)throw new Error("Unable to find sencond key candinate");M?S=this.curve.pointFromX(S.add(this.curve.n),B):S=this.curve.pointFromX(S,B);var R=h.r.invm(_),P=_.sub(A).mul(R).umod(_),D=T.mul(R).umod(_);return this.g.mulAdd(P,S,D)},v.prototype.getKeyRecoveryParam=function(o,h,g,y){if(h=new u(h,y),h.recoveryParam!==null)return h.recoveryParam;for(var _=0;_<4;_++){var A;try{A=this.recoverPubKey(o,h,_)}catch{continue}if(A.eq(g))return _}throw new Error("Unable to find valid recovery factor")},a0}var s0,Dv;function Uw(){if(Dv)return s0;Dv=1;var i=Zi(),e=i.assert,r=i.parseBytes,t=i.cachedProperty;function a(n,c){this.eddsa=n,this._secret=r(c.secret),n.isPoint(c.pub)?this._pub=c.pub:this._pubBytes=r(c.pub)}return a.fromPublic=function(c,u){return u instanceof a?u:new a(c,{pub:u})},a.fromSecret=function(c,u){return u instanceof a?u:new a(c,{secret:u})},a.prototype.secret=function(){return this._secret},t(a,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),t(a,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),t(a,"privBytes",function(){var c=this.eddsa,u=this.hash(),v=c.encodingLength-1,o=u.slice(0,c.encodingLength);return o[0]&=248,o[v]&=127,o[v]|=64,o}),t(a,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),t(a,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),t(a,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),a.prototype.sign=function(c){return e(this._secret,"KeyPair can only verify"),this.eddsa.sign(c,this)},a.prototype.verify=function(c,u){return this.eddsa.verify(c,u,this)},a.prototype.getSecret=function(c){return e(this._secret,"KeyPair is public only"),i.encode(this.secret(),c)},a.prototype.getPublic=function(c){return i.encode(this.pubBytes(),c)},s0=a,s0}var o0,Ov;function Dw(){if(Ov)return o0;Ov=1;var i=$n(),e=Zi(),r=e.assert,t=e.cachedProperty,a=e.parseBytes;function n(c,u){this.eddsa=c,typeof u!="object"&&(u=a(u)),Array.isArray(u)&&(r(u.length===c.encodingLength*2,"Signature has invalid size"),u={R:u.slice(0,c.encodingLength),S:u.slice(c.encodingLength)}),r(u.R&&u.S,"Signature without R or S"),c.isPoint(u.R)&&(this._R=u.R),u.S instanceof i&&(this._S=u.S),this._Rencoded=Array.isArray(u.R)?u.R:u.Rencoded,this._Sencoded=Array.isArray(u.S)?u.S:u.Sencoded}return t(n,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),t(n,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),t(n,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),t(n,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),n.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},n.prototype.toHex=function(){return e.encode(this.toBytes(),"hex").toUpperCase()},o0=n,o0}var f0,Fv;function Ow(){if(Fv)return f0;Fv=1;var i=Ko(),e=d1(),r=Zi(),t=r.assert,a=r.parseBytes,n=Uw(),c=Dw();function u(v){if(t(v==="ed25519","only tested with ed25519 so far"),!(this instanceof u))return new u(v);v=e[v].curve,this.curve=v,this.g=v.g,this.g.precompute(v.n.bitLength()+1),this.pointClass=v.point().constructor,this.encodingLength=Math.ceil(v.n.bitLength()/8),this.hash=i.sha512}return f0=u,u.prototype.sign=function(o,h){o=a(o);var g=this.keyFromSecret(h),y=this.hashInt(g.messagePrefix(),o),_=this.g.mul(y),A=this.encodePoint(_),S=this.hashInt(A,g.pubBytes(),o).mul(g.priv()),T=y.add(S).umod(this.curve.n);return this.makeSignature({R:_,S:T,Rencoded:A})},u.prototype.verify=function(o,h,g){if(o=a(o),h=this.makeSignature(h),h.S().gte(h.eddsa.curve.n)||h.S().isNeg())return!1;var y=this.keyFromPublic(g),_=this.hashInt(h.Rencoded(),y.pubBytes(),o),A=this.g.mul(h.S()),S=h.R().add(y.pub().mul(_));return S.eq(A)},u.prototype.hashInt=function(){for(var o=this.hash(),h=0;h<arguments.length;h++)o.update(arguments[h]);return r.intFromLE(o.digest()).umod(this.curve.n)},u.prototype.keyFromPublic=function(o){return n.fromPublic(this,o)},u.prototype.keyFromSecret=function(o){return n.fromSecret(this,o)},u.prototype.makeSignature=function(o){return o instanceof c?o:new c(this,o)},u.prototype.encodePoint=function(o){var h=o.getY().toArray("le",this.encodingLength);return h[this.encodingLength-1]|=o.getX().isOdd()?128:0,h},u.prototype.decodePoint=function(o){o=r.parseBytes(o);var h=o.length-1,g=o.slice(0,h).concat(o[h]&-129),y=(o[h]&128)!==0,_=r.intFromLE(g);return this.curve.pointFromY(_,y)},u.prototype.encodeInt=function(o){return o.toArray("le",this.encodingLength)},u.prototype.decodeInt=function(o){return r.intFromLE(o)},u.prototype.isPoint=function(o){return o instanceof this.pointClass},f0}var qv;function $y(){return qv||(qv=1,function(i){var e=i;e.version=Cw.version,e.utils=Zi(),e.rand=zo(),e.curve=Vy(),e.curves=d1(),e.ec=Pw(),e.eddsa=Ow()}(Du)),Du}var Di={},l0={},Kf={exports:{}};Kf.exports;var zv;function Fw(){return zv||(zv=1,function(i){(function(e,r){function t(E,s){if(!E)throw new Error(s||"Assertion failed")}function a(E,s){E.super_=s;var l=function(){};l.prototype=s.prototype,E.prototype=new l,E.prototype.constructor=E}function n(E,s,l){if(n.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&((s==="le"||s==="be")&&(l=s,s=10),this._init(E||0,s||10,l||"be"))}typeof e=="object"?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=$i.Buffer}catch{}n.isBN=function(s){return s instanceof n?!0:s!==null&&typeof s=="object"&&s.constructor.wordSize===n.wordSize&&Array.isArray(s.words)},n.max=function(s,l){return s.cmp(l)>0?s:l},n.min=function(s,l){return s.cmp(l)<0?s:l},n.prototype._init=function(s,l,d){if(typeof s=="number")return this._initNumber(s,l,d);if(typeof s=="object")return this._initArray(s,l,d);l==="hex"&&(l=16),t(l===(l|0)&&l>=2&&l<=36),s=s.toString().replace(/\s+/g,"");var p=0;s[0]==="-"&&(p++,this.negative=1),p<s.length&&(l===16?this._parseHex(s,p,d):(this._parseBase(s,l,p),d==="le"&&this._initArray(this.toArray(),l,d)))},n.prototype._initNumber=function(s,l,d){s<0&&(this.negative=1,s=-s),s<67108864?(this.words=[s&67108863],this.length=1):s<4503599627370496?(this.words=[s&67108863,s/67108864&67108863],this.length=2):(t(s<9007199254740992),this.words=[s&67108863,s/67108864&67108863,1],this.length=3),d==="le"&&this._initArray(this.toArray(),l,d)},n.prototype._initArray=function(s,l,d){if(t(typeof s.length=="number"),s.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(s.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m,w,x=0;if(d==="be")for(p=s.length-1,m=0;p>=0;p-=3)w=s[p]|s[p-1]<<8|s[p-2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);else if(d==="le")for(p=0,m=0;p<s.length;p+=3)w=s[p]|s[p+1]<<8|s[p+2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);return this.strip()};function u(E,s){var l=E.charCodeAt(s);return l>=65&&l<=70?l-55:l>=97&&l<=102?l-87:l-48&15}function v(E,s,l){var d=u(E,l);return l-1>=s&&(d|=u(E,l-1)<<4),d}n.prototype._parseHex=function(s,l,d){this.length=Math.ceil((s.length-l)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m=0,w=0,x;if(d==="be")for(p=s.length-1;p>=l;p-=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8;else{var b=s.length-l;for(p=b%2===0?l+1:l;p<s.length;p+=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8}this.strip()};function o(E,s,l,d){for(var p=0,m=Math.min(E.length,l),w=s;w<m;w++){var x=E.charCodeAt(w)-48;p*=d,x>=49?p+=x-49+10:x>=17?p+=x-17+10:p+=x}return p}n.prototype._parseBase=function(s,l,d){this.words=[0],this.length=1;for(var p=0,m=1;m<=67108863;m*=l)p++;p--,m=m/l|0;for(var w=s.length-d,x=w%p,b=Math.min(w,w-x)+d,f=0,C=d;C<b;C+=p)f=o(s,C,C+p,l),this.imuln(m),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(x!==0){var F=1;for(f=o(s,C,s.length,l),C=0;C<x;C++)F*=l;this.imuln(F),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},n.prototype.copy=function(s){s.words=new Array(this.length);for(var l=0;l<this.length;l++)s.words[l]=this.words[l];s.length=this.length,s.negative=this.negative,s.red=this.red},n.prototype.clone=function(){var s=new n(null);return this.copy(s),s},n.prototype._expand=function(s){for(;this.length<s;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(s,l){s=s||10,l=l|0||1;var d;if(s===16||s==="hex"){d="";for(var p=0,m=0,w=0;w<this.length;w++){var x=this.words[w],b=((x<<p|m)&16777215).toString(16);m=x>>>24-p&16777215,p+=2,p>=26&&(p-=26,w--),m!==0||w!==this.length-1?d=h[6-b.length]+b+d:d=b+d}for(m!==0&&(d=m.toString(16)+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}if(s===(s|0)&&s>=2&&s<=36){var f=g[s],C=y[s];d="";var F=this.clone();for(F.negative=0;!F.isZero();){var z=F.modn(C).toString(s);F=F.idivn(C),F.isZero()?d=z+d:d=h[f-z.length]+z+d}for(this.isZero()&&(d="0"+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var s=this.words[0];return this.length===2?s+=this.words[1]*67108864:this.length===3&&this.words[2]===1?s+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-s:s},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(s,l){return t(typeof c<"u"),this.toArrayLike(c,s,l)},n.prototype.toArray=function(s,l){return this.toArrayLike(Array,s,l)},n.prototype.toArrayLike=function(s,l,d){var p=this.byteLength(),m=d||Math.max(1,p);t(p<=m,"byte array longer than desired length"),t(m>0,"Requested array length <= 0"),this.strip();var w=l==="le",x=new s(m),b,f,C=this.clone();if(w){for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[f]=b;for(;f<m;f++)x[f]=0}else{for(f=0;f<m-p;f++)x[f]=0;for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[m-f-1]=b}return x},Math.clz32?n.prototype._countBits=function(s){return 32-Math.clz32(s)}:n.prototype._countBits=function(s){var l=s,d=0;return l>=4096&&(d+=13,l>>>=13),l>=64&&(d+=7,l>>>=7),l>=8&&(d+=4,l>>>=4),l>=2&&(d+=2,l>>>=2),d+l},n.prototype._zeroBits=function(s){if(s===0)return 26;var l=s,d=0;return l&8191||(d+=13,l>>>=13),l&127||(d+=7,l>>>=7),l&15||(d+=4,l>>>=4),l&3||(d+=2,l>>>=2),l&1||d++,d},n.prototype.bitLength=function(){var s=this.words[this.length-1],l=this._countBits(s);return(this.length-1)*26+l};function _(E){for(var s=new Array(E.bitLength()),l=0;l<s.length;l++){var d=l/26|0,p=l%26;s[l]=(E.words[d]&1<<p)>>>p}return s}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var s=0,l=0;l<this.length;l++){var d=this._zeroBits(this.words[l]);if(s+=d,d!==26)break}return s},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(s){return this.negative!==0?this.abs().inotn(s).iaddn(1):this.clone()},n.prototype.fromTwos=function(s){return this.testn(s-1)?this.notn(s).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(s){for(;this.length<s.length;)this.words[this.length++]=0;for(var l=0;l<s.length;l++)this.words[l]=this.words[l]|s.words[l];return this.strip()},n.prototype.ior=function(s){return t((this.negative|s.negative)===0),this.iuor(s)},n.prototype.or=function(s){return this.length>s.length?this.clone().ior(s):s.clone().ior(this)},n.prototype.uor=function(s){return this.length>s.length?this.clone().iuor(s):s.clone().iuor(this)},n.prototype.iuand=function(s){var l;this.length>s.length?l=s:l=this;for(var d=0;d<l.length;d++)this.words[d]=this.words[d]&s.words[d];return this.length=l.length,this.strip()},n.prototype.iand=function(s){return t((this.negative|s.negative)===0),this.iuand(s)},n.prototype.and=function(s){return this.length>s.length?this.clone().iand(s):s.clone().iand(this)},n.prototype.uand=function(s){return this.length>s.length?this.clone().iuand(s):s.clone().iuand(this)},n.prototype.iuxor=function(s){var l,d;this.length>s.length?(l=this,d=s):(l=s,d=this);for(var p=0;p<d.length;p++)this.words[p]=l.words[p]^d.words[p];if(this!==l)for(;p<l.length;p++)this.words[p]=l.words[p];return this.length=l.length,this.strip()},n.prototype.ixor=function(s){return t((this.negative|s.negative)===0),this.iuxor(s)},n.prototype.xor=function(s){return this.length>s.length?this.clone().ixor(s):s.clone().ixor(this)},n.prototype.uxor=function(s){return this.length>s.length?this.clone().iuxor(s):s.clone().iuxor(this)},n.prototype.inotn=function(s){t(typeof s=="number"&&s>=0);var l=Math.ceil(s/26)|0,d=s%26;this._expand(l),d>0&&l--;for(var p=0;p<l;p++)this.words[p]=~this.words[p]&67108863;return d>0&&(this.words[p]=~this.words[p]&67108863>>26-d),this.strip()},n.prototype.notn=function(s){return this.clone().inotn(s)},n.prototype.setn=function(s,l){t(typeof s=="number"&&s>=0);var d=s/26|0,p=s%26;return this._expand(d+1),l?this.words[d]=this.words[d]|1<<p:this.words[d]=this.words[d]&~(1<<p),this.strip()},n.prototype.iadd=function(s){var l;if(this.negative!==0&&s.negative===0)return this.negative=0,l=this.isub(s),this.negative^=1,this._normSign();if(this.negative===0&&s.negative!==0)return s.negative=0,l=this.isub(s),s.negative=1,l._normSign();var d,p;this.length>s.length?(d=this,p=s):(d=s,p=this);for(var m=0,w=0;w<p.length;w++)l=(d.words[w]|0)+(p.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;for(;m!==0&&w<d.length;w++)l=(d.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;if(this.length=d.length,m!==0)this.words[this.length]=m,this.length++;else if(d!==this)for(;w<d.length;w++)this.words[w]=d.words[w];return this},n.prototype.add=function(s){var l;return s.negative!==0&&this.negative===0?(s.negative=0,l=this.sub(s),s.negative^=1,l):s.negative===0&&this.negative!==0?(this.negative=0,l=s.sub(this),this.negative=1,l):this.length>s.length?this.clone().iadd(s):s.clone().iadd(this)},n.prototype.isub=function(s){if(s.negative!==0){s.negative=0;var l=this.iadd(s);return s.negative=1,l._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(s),this.negative=1,this._normSign();var d=this.cmp(s);if(d===0)return this.negative=0,this.length=1,this.words[0]=0,this;var p,m;d>0?(p=this,m=s):(p=s,m=this);for(var w=0,x=0;x<m.length;x++)l=(p.words[x]|0)-(m.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;for(;w!==0&&x<p.length;x++)l=(p.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;if(w===0&&x<p.length&&p!==this)for(;x<p.length;x++)this.words[x]=p.words[x];return this.length=Math.max(this.length,x),p!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(s){return this.clone().isub(s)};function A(E,s,l){l.negative=s.negative^E.negative;var d=E.length+s.length|0;l.length=d,d=d-1|0;var p=E.words[0]|0,m=s.words[0]|0,w=p*m,x=w&67108863,b=w/67108864|0;l.words[0]=x;for(var f=1;f<d;f++){for(var C=b>>>26,F=b&67108863,z=Math.min(f,s.length-1),W=Math.max(0,f-E.length+1);W<=z;W++){var $=f-W|0;p=E.words[$]|0,m=s.words[W]|0,w=p*m+F,C+=w/67108864|0,F=w&67108863}l.words[f]=F|0,b=C|0}return b!==0?l.words[f]=b|0:l.length--,l.strip()}var S=function(s,l,d){var p=s.words,m=l.words,w=d.words,x=0,b,f,C,F=p[0]|0,z=F&8191,W=F>>>13,$=p[1]|0,I=$&8191,K=$>>>13,N=p[2]|0,X=N&8191,Q=N>>>13,L=p[3]|0,V=L&8191,Z=L>>>13,H=p[4]|0,j=H&8191,et=H>>>13,nt=p[5]|0,st=nt&8191,ft=nt>>>13,vt=p[6]|0,ot=vt&8191,pt=vt>>>13,Ut=p[7]|0,At=Ut&8191,It=Ut>>>13,Jt=p[8]|0,at=Jt&8191,J=Jt>>>13,rt=p[9]|0,lt=rt&8191,gt=rt>>>13,Dt=m[0]|0,ut=Dt&8191,Y=Dt>>>13,tt=m[1]|0,dt=tt&8191,mt=tt>>>13,xt=m[2]|0,bt=xt&8191,_t=xt>>>13,Ht=m[3]|0,St=Ht&8191,Mt=Ht>>>13,jt=m[4]|0,Lt=jt&8191,Ft=jt>>>13,te=m[5]|0,Bt=te&8191,Ot=te>>>13,ie=m[6]|0,kt=ie&8191,qt=ie>>>13,ae=m[7]|0,Rt=ae&8191,zt=ae>>>13,he=m[8]|0,Vt=he&8191,Qt=he>>>13,ge=m[9]|0,Gt=ge&8191,$t=ge>>>13;d.negative=s.negative^l.negative,d.length=19,b=Math.imul(z,ut),f=Math.imul(z,Y),f=f+Math.imul(W,ut)|0,C=Math.imul(W,Y);var pe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(pe>>>26)|0,pe&=67108863,b=Math.imul(I,ut),f=Math.imul(I,Y),f=f+Math.imul(K,ut)|0,C=Math.imul(K,Y),b=b+Math.imul(z,dt)|0,f=f+Math.imul(z,mt)|0,f=f+Math.imul(W,dt)|0,C=C+Math.imul(W,mt)|0;var de=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(de>>>26)|0,de&=67108863,b=Math.imul(X,ut),f=Math.imul(X,Y),f=f+Math.imul(Q,ut)|0,C=Math.imul(Q,Y),b=b+Math.imul(I,dt)|0,f=f+Math.imul(I,mt)|0,f=f+Math.imul(K,dt)|0,C=C+Math.imul(K,mt)|0,b=b+Math.imul(z,bt)|0,f=f+Math.imul(z,_t)|0,f=f+Math.imul(W,bt)|0,C=C+Math.imul(W,_t)|0;var Ee=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,b=Math.imul(V,ut),f=Math.imul(V,Y),f=f+Math.imul(Z,ut)|0,C=Math.imul(Z,Y),b=b+Math.imul(X,dt)|0,f=f+Math.imul(X,mt)|0,f=f+Math.imul(Q,dt)|0,C=C+Math.imul(Q,mt)|0,b=b+Math.imul(I,bt)|0,f=f+Math.imul(I,_t)|0,f=f+Math.imul(K,bt)|0,C=C+Math.imul(K,_t)|0,b=b+Math.imul(z,St)|0,f=f+Math.imul(z,Mt)|0,f=f+Math.imul(W,St)|0,C=C+Math.imul(W,Mt)|0;var xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(xe>>>26)|0,xe&=67108863,b=Math.imul(j,ut),f=Math.imul(j,Y),f=f+Math.imul(et,ut)|0,C=Math.imul(et,Y),b=b+Math.imul(V,dt)|0,f=f+Math.imul(V,mt)|0,f=f+Math.imul(Z,dt)|0,C=C+Math.imul(Z,mt)|0,b=b+Math.imul(X,bt)|0,f=f+Math.imul(X,_t)|0,f=f+Math.imul(Q,bt)|0,C=C+Math.imul(Q,_t)|0,b=b+Math.imul(I,St)|0,f=f+Math.imul(I,Mt)|0,f=f+Math.imul(K,St)|0,C=C+Math.imul(K,Mt)|0,b=b+Math.imul(z,Lt)|0,f=f+Math.imul(z,Ft)|0,f=f+Math.imul(W,Lt)|0,C=C+Math.imul(W,Ft)|0;var Se=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Se>>>26)|0,Se&=67108863,b=Math.imul(st,ut),f=Math.imul(st,Y),f=f+Math.imul(ft,ut)|0,C=Math.imul(ft,Y),b=b+Math.imul(j,dt)|0,f=f+Math.imul(j,mt)|0,f=f+Math.imul(et,dt)|0,C=C+Math.imul(et,mt)|0,b=b+Math.imul(V,bt)|0,f=f+Math.imul(V,_t)|0,f=f+Math.imul(Z,bt)|0,C=C+Math.imul(Z,_t)|0,b=b+Math.imul(X,St)|0,f=f+Math.imul(X,Mt)|0,f=f+Math.imul(Q,St)|0,C=C+Math.imul(Q,Mt)|0,b=b+Math.imul(I,Lt)|0,f=f+Math.imul(I,Ft)|0,f=f+Math.imul(K,Lt)|0,C=C+Math.imul(K,Ft)|0,b=b+Math.imul(z,Bt)|0,f=f+Math.imul(z,Ot)|0,f=f+Math.imul(W,Bt)|0,C=C+Math.imul(W,Ot)|0;var Be=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Be>>>26)|0,Be&=67108863,b=Math.imul(ot,ut),f=Math.imul(ot,Y),f=f+Math.imul(pt,ut)|0,C=Math.imul(pt,Y),b=b+Math.imul(st,dt)|0,f=f+Math.imul(st,mt)|0,f=f+Math.imul(ft,dt)|0,C=C+Math.imul(ft,mt)|0,b=b+Math.imul(j,bt)|0,f=f+Math.imul(j,_t)|0,f=f+Math.imul(et,bt)|0,C=C+Math.imul(et,_t)|0,b=b+Math.imul(V,St)|0,f=f+Math.imul(V,Mt)|0,f=f+Math.imul(Z,St)|0,C=C+Math.imul(Z,Mt)|0,b=b+Math.imul(X,Lt)|0,f=f+Math.imul(X,Ft)|0,f=f+Math.imul(Q,Lt)|0,C=C+Math.imul(Q,Ft)|0,b=b+Math.imul(I,Bt)|0,f=f+Math.imul(I,Ot)|0,f=f+Math.imul(K,Bt)|0,C=C+Math.imul(K,Ot)|0,b=b+Math.imul(z,kt)|0,f=f+Math.imul(z,qt)|0,f=f+Math.imul(W,kt)|0,C=C+Math.imul(W,qt)|0;var Ne=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,b=Math.imul(At,ut),f=Math.imul(At,Y),f=f+Math.imul(It,ut)|0,C=Math.imul(It,Y),b=b+Math.imul(ot,dt)|0,f=f+Math.imul(ot,mt)|0,f=f+Math.imul(pt,dt)|0,C=C+Math.imul(pt,mt)|0,b=b+Math.imul(st,bt)|0,f=f+Math.imul(st,_t)|0,f=f+Math.imul(ft,bt)|0,C=C+Math.imul(ft,_t)|0,b=b+Math.imul(j,St)|0,f=f+Math.imul(j,Mt)|0,f=f+Math.imul(et,St)|0,C=C+Math.imul(et,Mt)|0,b=b+Math.imul(V,Lt)|0,f=f+Math.imul(V,Ft)|0,f=f+Math.imul(Z,Lt)|0,C=C+Math.imul(Z,Ft)|0,b=b+Math.imul(X,Bt)|0,f=f+Math.imul(X,Ot)|0,f=f+Math.imul(Q,Bt)|0,C=C+Math.imul(Q,Ot)|0,b=b+Math.imul(I,kt)|0,f=f+Math.imul(I,qt)|0,f=f+Math.imul(K,kt)|0,C=C+Math.imul(K,qt)|0,b=b+Math.imul(z,Rt)|0,f=f+Math.imul(z,zt)|0,f=f+Math.imul(W,Rt)|0,C=C+Math.imul(W,zt)|0;var qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(qe>>>26)|0,qe&=67108863,b=Math.imul(at,ut),f=Math.imul(at,Y),f=f+Math.imul(J,ut)|0,C=Math.imul(J,Y),b=b+Math.imul(At,dt)|0,f=f+Math.imul(At,mt)|0,f=f+Math.imul(It,dt)|0,C=C+Math.imul(It,mt)|0,b=b+Math.imul(ot,bt)|0,f=f+Math.imul(ot,_t)|0,f=f+Math.imul(pt,bt)|0,C=C+Math.imul(pt,_t)|0,b=b+Math.imul(st,St)|0,f=f+Math.imul(st,Mt)|0,f=f+Math.imul(ft,St)|0,C=C+Math.imul(ft,Mt)|0,b=b+Math.imul(j,Lt)|0,f=f+Math.imul(j,Ft)|0,f=f+Math.imul(et,Lt)|0,C=C+Math.imul(et,Ft)|0,b=b+Math.imul(V,Bt)|0,f=f+Math.imul(V,Ot)|0,f=f+Math.imul(Z,Bt)|0,C=C+Math.imul(Z,Ot)|0,b=b+Math.imul(X,kt)|0,f=f+Math.imul(X,qt)|0,f=f+Math.imul(Q,kt)|0,C=C+Math.imul(Q,qt)|0,b=b+Math.imul(I,Rt)|0,f=f+Math.imul(I,zt)|0,f=f+Math.imul(K,Rt)|0,C=C+Math.imul(K,zt)|0,b=b+Math.imul(z,Vt)|0,f=f+Math.imul(z,Qt)|0,f=f+Math.imul(W,Vt)|0,C=C+Math.imul(W,Qt)|0;var Xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,b=Math.imul(lt,ut),f=Math.imul(lt,Y),f=f+Math.imul(gt,ut)|0,C=Math.imul(gt,Y),b=b+Math.imul(at,dt)|0,f=f+Math.imul(at,mt)|0,f=f+Math.imul(J,dt)|0,C=C+Math.imul(J,mt)|0,b=b+Math.imul(At,bt)|0,f=f+Math.imul(At,_t)|0,f=f+Math.imul(It,bt)|0,C=C+Math.imul(It,_t)|0,b=b+Math.imul(ot,St)|0,f=f+Math.imul(ot,Mt)|0,f=f+Math.imul(pt,St)|0,C=C+Math.imul(pt,Mt)|0,b=b+Math.imul(st,Lt)|0,f=f+Math.imul(st,Ft)|0,f=f+Math.imul(ft,Lt)|0,C=C+Math.imul(ft,Ft)|0,b=b+Math.imul(j,Bt)|0,f=f+Math.imul(j,Ot)|0,f=f+Math.imul(et,Bt)|0,C=C+Math.imul(et,Ot)|0,b=b+Math.imul(V,kt)|0,f=f+Math.imul(V,qt)|0,f=f+Math.imul(Z,kt)|0,C=C+Math.imul(Z,qt)|0,b=b+Math.imul(X,Rt)|0,f=f+Math.imul(X,zt)|0,f=f+Math.imul(Q,Rt)|0,C=C+Math.imul(Q,zt)|0,b=b+Math.imul(I,Vt)|0,f=f+Math.imul(I,Qt)|0,f=f+Math.imul(K,Vt)|0,C=C+Math.imul(K,Qt)|0,b=b+Math.imul(z,Gt)|0,f=f+Math.imul(z,$t)|0,f=f+Math.imul(W,Gt)|0,C=C+Math.imul(W,$t)|0;var Ge=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,b=Math.imul(lt,dt),f=Math.imul(lt,mt),f=f+Math.imul(gt,dt)|0,C=Math.imul(gt,mt),b=b+Math.imul(at,bt)|0,f=f+Math.imul(at,_t)|0,f=f+Math.imul(J,bt)|0,C=C+Math.imul(J,_t)|0,b=b+Math.imul(At,St)|0,f=f+Math.imul(At,Mt)|0,f=f+Math.imul(It,St)|0,C=C+Math.imul(It,Mt)|0,b=b+Math.imul(ot,Lt)|0,f=f+Math.imul(ot,Ft)|0,f=f+Math.imul(pt,Lt)|0,C=C+Math.imul(pt,Ft)|0,b=b+Math.imul(st,Bt)|0,f=f+Math.imul(st,Ot)|0,f=f+Math.imul(ft,Bt)|0,C=C+Math.imul(ft,Ot)|0,b=b+Math.imul(j,kt)|0,f=f+Math.imul(j,qt)|0,f=f+Math.imul(et,kt)|0,C=C+Math.imul(et,qt)|0,b=b+Math.imul(V,Rt)|0,f=f+Math.imul(V,zt)|0,f=f+Math.imul(Z,Rt)|0,C=C+Math.imul(Z,zt)|0,b=b+Math.imul(X,Vt)|0,f=f+Math.imul(X,Qt)|0,f=f+Math.imul(Q,Vt)|0,C=C+Math.imul(Q,Qt)|0,b=b+Math.imul(I,Gt)|0,f=f+Math.imul(I,$t)|0,f=f+Math.imul(K,Gt)|0,C=C+Math.imul(K,$t)|0;var Je=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Je>>>26)|0,Je&=67108863,b=Math.imul(lt,bt),f=Math.imul(lt,_t),f=f+Math.imul(gt,bt)|0,C=Math.imul(gt,_t),b=b+Math.imul(at,St)|0,f=f+Math.imul(at,Mt)|0,f=f+Math.imul(J,St)|0,C=C+Math.imul(J,Mt)|0,b=b+Math.imul(At,Lt)|0,f=f+Math.imul(At,Ft)|0,f=f+Math.imul(It,Lt)|0,C=C+Math.imul(It,Ft)|0,b=b+Math.imul(ot,Bt)|0,f=f+Math.imul(ot,Ot)|0,f=f+Math.imul(pt,Bt)|0,C=C+Math.imul(pt,Ot)|0,b=b+Math.imul(st,kt)|0,f=f+Math.imul(st,qt)|0,f=f+Math.imul(ft,kt)|0,C=C+Math.imul(ft,qt)|0,b=b+Math.imul(j,Rt)|0,f=f+Math.imul(j,zt)|0,f=f+Math.imul(et,Rt)|0,C=C+Math.imul(et,zt)|0,b=b+Math.imul(V,Vt)|0,f=f+Math.imul(V,Qt)|0,f=f+Math.imul(Z,Vt)|0,C=C+Math.imul(Z,Qt)|0,b=b+Math.imul(X,Gt)|0,f=f+Math.imul(X,$t)|0,f=f+Math.imul(Q,Gt)|0,C=C+Math.imul(Q,$t)|0;var ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ze>>>26)|0,ze&=67108863,b=Math.imul(lt,St),f=Math.imul(lt,Mt),f=f+Math.imul(gt,St)|0,C=Math.imul(gt,Mt),b=b+Math.imul(at,Lt)|0,f=f+Math.imul(at,Ft)|0,f=f+Math.imul(J,Lt)|0,C=C+Math.imul(J,Ft)|0,b=b+Math.imul(At,Bt)|0,f=f+Math.imul(At,Ot)|0,f=f+Math.imul(It,Bt)|0,C=C+Math.imul(It,Ot)|0,b=b+Math.imul(ot,kt)|0,f=f+Math.imul(ot,qt)|0,f=f+Math.imul(pt,kt)|0,C=C+Math.imul(pt,qt)|0,b=b+Math.imul(st,Rt)|0,f=f+Math.imul(st,zt)|0,f=f+Math.imul(ft,Rt)|0,C=C+Math.imul(ft,zt)|0,b=b+Math.imul(j,Vt)|0,f=f+Math.imul(j,Qt)|0,f=f+Math.imul(et,Vt)|0,C=C+Math.imul(et,Qt)|0,b=b+Math.imul(V,Gt)|0,f=f+Math.imul(V,$t)|0,f=f+Math.imul(Z,Gt)|0,C=C+Math.imul(Z,$t)|0;var rr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(rr>>>26)|0,rr&=67108863,b=Math.imul(lt,Lt),f=Math.imul(lt,Ft),f=f+Math.imul(gt,Lt)|0,C=Math.imul(gt,Ft),b=b+Math.imul(at,Bt)|0,f=f+Math.imul(at,Ot)|0,f=f+Math.imul(J,Bt)|0,C=C+Math.imul(J,Ot)|0,b=b+Math.imul(At,kt)|0,f=f+Math.imul(At,qt)|0,f=f+Math.imul(It,kt)|0,C=C+Math.imul(It,qt)|0,b=b+Math.imul(ot,Rt)|0,f=f+Math.imul(ot,zt)|0,f=f+Math.imul(pt,Rt)|0,C=C+Math.imul(pt,zt)|0,b=b+Math.imul(st,Vt)|0,f=f+Math.imul(st,Qt)|0,f=f+Math.imul(ft,Vt)|0,C=C+Math.imul(ft,Qt)|0,b=b+Math.imul(j,Gt)|0,f=f+Math.imul(j,$t)|0,f=f+Math.imul(et,Gt)|0,C=C+Math.imul(et,$t)|0;var Qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,b=Math.imul(lt,Bt),f=Math.imul(lt,Ot),f=f+Math.imul(gt,Bt)|0,C=Math.imul(gt,Ot),b=b+Math.imul(at,kt)|0,f=f+Math.imul(at,qt)|0,f=f+Math.imul(J,kt)|0,C=C+Math.imul(J,qt)|0,b=b+Math.imul(At,Rt)|0,f=f+Math.imul(At,zt)|0,f=f+Math.imul(It,Rt)|0,C=C+Math.imul(It,zt)|0,b=b+Math.imul(ot,Vt)|0,f=f+Math.imul(ot,Qt)|0,f=f+Math.imul(pt,Vt)|0,C=C+Math.imul(pt,Qt)|0,b=b+Math.imul(st,Gt)|0,f=f+Math.imul(st,$t)|0,f=f+Math.imul(ft,Gt)|0,C=C+Math.imul(ft,$t)|0;var Le=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Le>>>26)|0,Le&=67108863,b=Math.imul(lt,kt),f=Math.imul(lt,qt),f=f+Math.imul(gt,kt)|0,C=Math.imul(gt,qt),b=b+Math.imul(at,Rt)|0,f=f+Math.imul(at,zt)|0,f=f+Math.imul(J,Rt)|0,C=C+Math.imul(J,zt)|0,b=b+Math.imul(At,Vt)|0,f=f+Math.imul(At,Qt)|0,f=f+Math.imul(It,Vt)|0,C=C+Math.imul(It,Qt)|0,b=b+Math.imul(ot,Gt)|0,f=f+Math.imul(ot,$t)|0,f=f+Math.imul(pt,Gt)|0,C=C+Math.imul(pt,$t)|0;var ir=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ir>>>26)|0,ir&=67108863,b=Math.imul(lt,Rt),f=Math.imul(lt,zt),f=f+Math.imul(gt,Rt)|0,C=Math.imul(gt,zt),b=b+Math.imul(at,Vt)|0,f=f+Math.imul(at,Qt)|0,f=f+Math.imul(J,Vt)|0,C=C+Math.imul(J,Qt)|0,b=b+Math.imul(At,Gt)|0,f=f+Math.imul(At,$t)|0,f=f+Math.imul(It,Gt)|0,C=C+Math.imul(It,$t)|0;var nr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(nr>>>26)|0,nr&=67108863,b=Math.imul(lt,Vt),f=Math.imul(lt,Qt),f=f+Math.imul(gt,Vt)|0,C=Math.imul(gt,Qt),b=b+Math.imul(at,Gt)|0,f=f+Math.imul(at,$t)|0,f=f+Math.imul(J,Gt)|0,C=C+Math.imul(J,$t)|0;var Ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,b=Math.imul(lt,Gt),f=Math.imul(lt,$t),f=f+Math.imul(gt,Gt)|0,C=Math.imul(gt,$t);var ar=(x+b|0)+((f&8191)<<13)|0;return x=(C+(f>>>13)|0)+(ar>>>26)|0,ar&=67108863,w[0]=pe,w[1]=de,w[2]=Ee,w[3]=xe,w[4]=Se,w[5]=Be,w[6]=Ne,w[7]=qe,w[8]=Xe,w[9]=Ge,w[10]=Je,w[11]=ze,w[12]=rr,w[13]=Qe,w[14]=Le,w[15]=ir,w[16]=nr,w[17]=Ze,w[18]=ar,x!==0&&(w[19]=x,d.length++),d};Math.imul||(S=A);function T(E,s,l){l.negative=s.negative^E.negative,l.length=E.length+s.length;for(var d=0,p=0,m=0;m<l.length-1;m++){var w=p;p=0;for(var x=d&67108863,b=Math.min(m,s.length-1),f=Math.max(0,m-E.length+1);f<=b;f++){var C=m-f,F=E.words[C]|0,z=s.words[f]|0,W=F*z,$=W&67108863;w=w+(W/67108864|0)|0,$=$+x|0,x=$&67108863,w=w+($>>>26)|0,p+=w>>>26,w&=67108863}l.words[m]=x,d=w,w=p}return d!==0?l.words[m]=d:l.length--,l.strip()}function B(E,s,l){var d=new M;return d.mulp(E,s,l)}n.prototype.mulTo=function(s,l){var d,p=this.length+s.length;return this.length===10&&s.length===10?d=S(this,s,l):p<63?d=A(this,s,l):p<1024?d=T(this,s,l):d=B(this,s,l),d};function M(E,s){this.x=E,this.y=s}M.prototype.makeRBT=function(s){for(var l=new Array(s),d=n.prototype._countBits(s)-1,p=0;p<s;p++)l[p]=this.revBin(p,d,s);return l},M.prototype.revBin=function(s,l,d){if(s===0||s===d-1)return s;for(var p=0,m=0;m<l;m++)p|=(s&1)<<l-m-1,s>>=1;return p},M.prototype.permute=function(s,l,d,p,m,w){for(var x=0;x<w;x++)p[x]=l[s[x]],m[x]=d[s[x]]},M.prototype.transform=function(s,l,d,p,m,w){this.permute(w,s,l,d,p,m);for(var x=1;x<m;x<<=1)for(var b=x<<1,f=Math.cos(2*Math.PI/b),C=Math.sin(2*Math.PI/b),F=0;F<m;F+=b)for(var z=f,W=C,$=0;$<x;$++){var I=d[F+$],K=p[F+$],N=d[F+$+x],X=p[F+$+x],Q=z*N-W*X;X=z*X+W*N,N=Q,d[F+$]=I+N,p[F+$]=K+X,d[F+$+x]=I-N,p[F+$+x]=K-X,$!==b&&(Q=f*z-C*W,W=f*W+C*z,z=Q)}},M.prototype.guessLen13b=function(s,l){var d=Math.max(l,s)|1,p=d&1,m=0;for(d=d/2|0;d;d=d>>>1)m++;return 1<<m+1+p},M.prototype.conjugate=function(s,l,d){if(!(d<=1))for(var p=0;p<d/2;p++){var m=s[p];s[p]=s[d-p-1],s[d-p-1]=m,m=l[p],l[p]=-l[d-p-1],l[d-p-1]=-m}},M.prototype.normalize13b=function(s,l){for(var d=0,p=0;p<l/2;p++){var m=Math.round(s[2*p+1]/l)*8192+Math.round(s[2*p]/l)+d;s[p]=m&67108863,m<67108864?d=0:d=m/67108864|0}return s},M.prototype.convert13b=function(s,l,d,p){for(var m=0,w=0;w<l;w++)m=m+(s[w]|0),d[2*w]=m&8191,m=m>>>13,d[2*w+1]=m&8191,m=m>>>13;for(w=2*l;w<p;++w)d[w]=0;t(m===0),t((m&-8192)===0)},M.prototype.stub=function(s){for(var l=new Array(s),d=0;d<s;d++)l[d]=0;return l},M.prototype.mulp=function(s,l,d){var p=2*this.guessLen13b(s.length,l.length),m=this.makeRBT(p),w=this.stub(p),x=new Array(p),b=new Array(p),f=new Array(p),C=new Array(p),F=new Array(p),z=new Array(p),W=d.words;W.length=p,this.convert13b(s.words,s.length,x,p),this.convert13b(l.words,l.length,C,p),this.transform(x,w,b,f,p,m),this.transform(C,w,F,z,p,m);for(var $=0;$<p;$++){var I=b[$]*F[$]-f[$]*z[$];f[$]=b[$]*z[$]+f[$]*F[$],b[$]=I}return this.conjugate(b,f,p),this.transform(b,f,W,w,p,m),this.conjugate(W,w,p),this.normalize13b(W,p),d.negative=s.negative^l.negative,d.length=s.length+l.length,d.strip()},n.prototype.mul=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),this.mulTo(s,l)},n.prototype.mulf=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),B(this,s,l)},n.prototype.imul=function(s){return this.clone().mulTo(s,this)},n.prototype.imuln=function(s){t(typeof s=="number"),t(s<67108864);for(var l=0,d=0;d<this.length;d++){var p=(this.words[d]|0)*s,m=(p&67108863)+(l&67108863);l>>=26,l+=p/67108864|0,l+=m>>>26,this.words[d]=m&67108863}return l!==0&&(this.words[d]=l,this.length++),this},n.prototype.muln=function(s){return this.clone().imuln(s)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(s){var l=_(s);if(l.length===0)return new n(1);for(var d=this,p=0;p<l.length&&l[p]===0;p++,d=d.sqr());if(++p<l.length)for(var m=d.sqr();p<l.length;p++,m=m.sqr())l[p]!==0&&(d=d.mul(m));return d},n.prototype.iushln=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=67108863>>>26-l<<26-l,m;if(l!==0){var w=0;for(m=0;m<this.length;m++){var x=this.words[m]&p,b=(this.words[m]|0)-x<<l;this.words[m]=b|w,w=x>>>26-l}w&&(this.words[m]=w,this.length++)}if(d!==0){for(m=this.length-1;m>=0;m--)this.words[m+d]=this.words[m];for(m=0;m<d;m++)this.words[m]=0;this.length+=d}return this.strip()},n.prototype.ishln=function(s){return t(this.negative===0),this.iushln(s)},n.prototype.iushrn=function(s,l,d){t(typeof s=="number"&&s>=0);var p;l?p=(l-l%26)/26:p=0;var m=s%26,w=Math.min((s-m)/26,this.length),x=67108863^67108863>>>m<<m,b=d;if(p-=w,p=Math.max(0,p),b){for(var f=0;f<w;f++)b.words[f]=this.words[f];b.length=w}if(w!==0)if(this.length>w)for(this.length-=w,f=0;f<this.length;f++)this.words[f]=this.words[f+w];else this.words[0]=0,this.length=1;var C=0;for(f=this.length-1;f>=0&&(C!==0||f>=p);f--){var F=this.words[f]|0;this.words[f]=C<<26-m|F>>>m,C=F&x}return b&&C!==0&&(b.words[b.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(s,l,d){return t(this.negative===0),this.iushrn(s,l,d)},n.prototype.shln=function(s){return this.clone().ishln(s)},n.prototype.ushln=function(s){return this.clone().iushln(s)},n.prototype.shrn=function(s){return this.clone().ishrn(s)},n.prototype.ushrn=function(s){return this.clone().iushrn(s)},n.prototype.testn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return!1;var m=this.words[d];return!!(m&p)},n.prototype.imaskn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=d)return this;if(l!==0&&d++,this.length=Math.min(d,this.length),l!==0){var p=67108863^67108863>>>l<<l;this.words[this.length-1]&=p}return this.strip()},n.prototype.maskn=function(s){return this.clone().imaskn(s)},n.prototype.iaddn=function(s){return t(typeof s=="number"),t(s<67108864),s<0?this.isubn(-s):this.negative!==0?this.length===1&&(this.words[0]|0)<s?(this.words[0]=s-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(s),this.negative=1,this):this._iaddn(s)},n.prototype._iaddn=function(s){this.words[0]+=s;for(var l=0;l<this.length&&this.words[l]>=67108864;l++)this.words[l]-=67108864,l===this.length-1?this.words[l+1]=1:this.words[l+1]++;return this.length=Math.max(this.length,l+1),this},n.prototype.isubn=function(s){if(t(typeof s=="number"),t(s<67108864),s<0)return this.iaddn(-s);if(this.negative!==0)return this.negative=0,this.iaddn(s),this.negative=1,this;if(this.words[0]-=s,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var l=0;l<this.length&&this.words[l]<0;l++)this.words[l]+=67108864,this.words[l+1]-=1;return this.strip()},n.prototype.addn=function(s){return this.clone().iaddn(s)},n.prototype.subn=function(s){return this.clone().isubn(s)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(s,l,d){var p=s.length+d,m;this._expand(p);var w,x=0;for(m=0;m<s.length;m++){w=(this.words[m+d]|0)+x;var b=(s.words[m]|0)*l;w-=b&67108863,x=(w>>26)-(b/67108864|0),this.words[m+d]=w&67108863}for(;m<this.length-d;m++)w=(this.words[m+d]|0)+x,x=w>>26,this.words[m+d]=w&67108863;if(x===0)return this.strip();for(t(x===-1),x=0,m=0;m<this.length;m++)w=-(this.words[m]|0)+x,x=w>>26,this.words[m]=w&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(s,l){var d=this.length-s.length,p=this.clone(),m=s,w=m.words[m.length-1]|0,x=this._countBits(w);d=26-x,d!==0&&(m=m.ushln(d),p.iushln(d),w=m.words[m.length-1]|0);var b=p.length-m.length,f;if(l!=="mod"){f=new n(null),f.length=b+1,f.words=new Array(f.length);for(var C=0;C<f.length;C++)f.words[C]=0}var F=p.clone()._ishlnsubmul(m,1,b);F.negative===0&&(p=F,f&&(f.words[b]=1));for(var z=b-1;z>=0;z--){var W=(p.words[m.length+z]|0)*67108864+(p.words[m.length+z-1]|0);for(W=Math.min(W/w|0,67108863),p._ishlnsubmul(m,W,z);p.negative!==0;)W--,p.negative=0,p._ishlnsubmul(m,1,z),p.isZero()||(p.negative^=1);f&&(f.words[z]=W)}return f&&f.strip(),p.strip(),l!=="div"&&d!==0&&p.iushrn(d),{div:f||null,mod:p}},n.prototype.divmod=function(s,l,d){if(t(!s.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var p,m,w;return this.negative!==0&&s.negative===0?(w=this.neg().divmod(s,l),l!=="mod"&&(p=w.div.neg()),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.iadd(s)),{div:p,mod:m}):this.negative===0&&s.negative!==0?(w=this.divmod(s.neg(),l),l!=="mod"&&(p=w.div.neg()),{div:p,mod:w.mod}):this.negative&s.negative?(w=this.neg().divmod(s.neg(),l),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.isub(s)),{div:w.div,mod:m}):s.length>this.length||this.cmp(s)<0?{div:new n(0),mod:this}:s.length===1?l==="div"?{div:this.divn(s.words[0]),mod:null}:l==="mod"?{div:null,mod:new n(this.modn(s.words[0]))}:{div:this.divn(s.words[0]),mod:new n(this.modn(s.words[0]))}:this._wordDiv(s,l)},n.prototype.div=function(s){return this.divmod(s,"div",!1).div},n.prototype.mod=function(s){return this.divmod(s,"mod",!1).mod},n.prototype.umod=function(s){return this.divmod(s,"mod",!0).mod},n.prototype.divRound=function(s){var l=this.divmod(s);if(l.mod.isZero())return l.div;var d=l.div.negative!==0?l.mod.isub(s):l.mod,p=s.ushrn(1),m=s.andln(1),w=d.cmp(p);return w<0||m===1&&w===0?l.div:l.div.negative!==0?l.div.isubn(1):l.div.iaddn(1)},n.prototype.modn=function(s){t(s<=67108863);for(var l=(1<<26)%s,d=0,p=this.length-1;p>=0;p--)d=(l*d+(this.words[p]|0))%s;return d},n.prototype.idivn=function(s){t(s<=67108863);for(var l=0,d=this.length-1;d>=0;d--){var p=(this.words[d]|0)+l*67108864;this.words[d]=p/s|0,l=p%s}return this.strip()},n.prototype.divn=function(s){return this.clone().idivn(s)},n.prototype.egcd=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=new n(0),x=new n(1),b=0;l.isEven()&&d.isEven();)l.iushrn(1),d.iushrn(1),++b;for(var f=d.clone(),C=l.clone();!l.isZero();){for(var F=0,z=1;!(l.words[0]&z)&&F<26;++F,z<<=1);if(F>0)for(l.iushrn(F);F-- >0;)(p.isOdd()||m.isOdd())&&(p.iadd(f),m.isub(C)),p.iushrn(1),m.iushrn(1);for(var W=0,$=1;!(d.words[0]&$)&&W<26;++W,$<<=1);if(W>0)for(d.iushrn(W);W-- >0;)(w.isOdd()||x.isOdd())&&(w.iadd(f),x.isub(C)),w.iushrn(1),x.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(w),m.isub(x)):(d.isub(l),w.isub(p),x.isub(m))}return{a:w,b:x,gcd:d.iushln(b)}},n.prototype._invmp=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=d.clone();l.cmpn(1)>0&&d.cmpn(1)>0;){for(var x=0,b=1;!(l.words[0]&b)&&x<26;++x,b<<=1);if(x>0)for(l.iushrn(x);x-- >0;)p.isOdd()&&p.iadd(w),p.iushrn(1);for(var f=0,C=1;!(d.words[0]&C)&&f<26;++f,C<<=1);if(f>0)for(d.iushrn(f);f-- >0;)m.isOdd()&&m.iadd(w),m.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(m)):(d.isub(l),m.isub(p))}var F;return l.cmpn(1)===0?F=p:F=m,F.cmpn(0)<0&&F.iadd(s),F},n.prototype.gcd=function(s){if(this.isZero())return s.abs();if(s.isZero())return this.abs();var l=this.clone(),d=s.clone();l.negative=0,d.negative=0;for(var p=0;l.isEven()&&d.isEven();p++)l.iushrn(1),d.iushrn(1);do{for(;l.isEven();)l.iushrn(1);for(;d.isEven();)d.iushrn(1);var m=l.cmp(d);if(m<0){var w=l;l=d,d=w}else if(m===0||d.cmpn(1)===0)break;l.isub(d)}while(!0);return d.iushln(p)},n.prototype.invm=function(s){return this.egcd(s).a.umod(s)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(s){return this.words[0]&s},n.prototype.bincn=function(s){t(typeof s=="number");var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return this._expand(d+1),this.words[d]|=p,this;for(var m=p,w=d;m!==0&&w<this.length;w++){var x=this.words[w]|0;x+=m,m=x>>>26,x&=67108863,this.words[w]=x}return m!==0&&(this.words[w]=m,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(s){var l=s<0;if(this.negative!==0&&!l)return-1;if(this.negative===0&&l)return 1;this.strip();var d;if(this.length>1)d=1;else{l&&(s=-s),t(s<=67108863,"Number is too big");var p=this.words[0]|0;d=p===s?0:p<s?-1:1}return this.negative!==0?-d|0:d},n.prototype.cmp=function(s){if(this.negative!==0&&s.negative===0)return-1;if(this.negative===0&&s.negative!==0)return 1;var l=this.ucmp(s);return this.negative!==0?-l|0:l},n.prototype.ucmp=function(s){if(this.length>s.length)return 1;if(this.length<s.length)return-1;for(var l=0,d=this.length-1;d>=0;d--){var p=this.words[d]|0,m=s.words[d]|0;if(p!==m){p<m?l=-1:p>m&&(l=1);break}}return l},n.prototype.gtn=function(s){return this.cmpn(s)===1},n.prototype.gt=function(s){return this.cmp(s)===1},n.prototype.gten=function(s){return this.cmpn(s)>=0},n.prototype.gte=function(s){return this.cmp(s)>=0},n.prototype.ltn=function(s){return this.cmpn(s)===-1},n.prototype.lt=function(s){return this.cmp(s)===-1},n.prototype.lten=function(s){return this.cmpn(s)<=0},n.prototype.lte=function(s){return this.cmp(s)<=0},n.prototype.eqn=function(s){return this.cmpn(s)===0},n.prototype.eq=function(s){return this.cmp(s)===0},n.red=function(s){return new O(s)},n.prototype.toRed=function(s){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),s.convertTo(this)._forceRed(s)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(s){return this.red=s,this},n.prototype.forceRed=function(s){return t(!this.red,"Already a number in reduction context"),this._forceRed(s)},n.prototype.redAdd=function(s){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,s)},n.prototype.redIAdd=function(s){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,s)},n.prototype.redSub=function(s){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,s)},n.prototype.redISub=function(s){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,s)},n.prototype.redShl=function(s){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,s)},n.prototype.redMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.mul(this,s)},n.prototype.redIMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.imul(this,s)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(s){return t(this.red&&!s.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,s)};var R={k256:null,p224:null,p192:null,p25519:null};function P(E,s){this.name=E,this.p=new n(s,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}P.prototype._tmp=function(){var s=new n(null);return s.words=new Array(Math.ceil(this.n/13)),s},P.prototype.ireduce=function(s){var l=s,d;do this.split(l,this.tmp),l=this.imulK(l),l=l.iadd(this.tmp),d=l.bitLength();while(d>this.n);var p=d<this.n?-1:l.ucmp(this.p);return p===0?(l.words[0]=0,l.length=1):p>0?l.isub(this.p):l.strip!==void 0?l.strip():l._strip(),l},P.prototype.split=function(s,l){s.iushrn(this.n,0,l)},P.prototype.imulK=function(s){return s.imul(this.k)};function D(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(D,P),D.prototype.split=function(s,l){for(var d=4194303,p=Math.min(s.length,9),m=0;m<p;m++)l.words[m]=s.words[m];if(l.length=p,s.length<=9){s.words[0]=0,s.length=1;return}var w=s.words[9];for(l.words[l.length++]=w&d,m=10;m<s.length;m++){var x=s.words[m]|0;s.words[m-10]=(x&d)<<4|w>>>22,w=x}w>>>=22,s.words[m-10]=w,w===0&&s.length>10?s.length-=10:s.length-=9},D.prototype.imulK=function(s){s.words[s.length]=0,s.words[s.length+1]=0,s.length+=2;for(var l=0,d=0;d<s.length;d++){var p=s.words[d]|0;l+=p*977,s.words[d]=l&67108863,l=p*64+(l/67108864|0)}return s.words[s.length-1]===0&&(s.length--,s.words[s.length-1]===0&&s.length--),s};function q(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(q,P);function k(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(k,P);function U(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(U,P),U.prototype.imulK=function(s){for(var l=0,d=0;d<s.length;d++){var p=(s.words[d]|0)*19+l,m=p&67108863;p>>>=26,s.words[d]=m,l=p}return l!==0&&(s.words[s.length++]=l),s},n._prime=function(s){if(R[s])return R[s];var l;if(s==="k256")l=new D;else if(s==="p224")l=new q;else if(s==="p192")l=new k;else if(s==="p25519")l=new U;else throw new Error("Unknown prime "+s);return R[s]=l,l};function O(E){if(typeof E=="string"){var s=n._prime(E);this.m=s.p,this.prime=s}else t(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}O.prototype._verify1=function(s){t(s.negative===0,"red works only with positives"),t(s.red,"red works only with red numbers")},O.prototype._verify2=function(s,l){t((s.negative|l.negative)===0,"red works only with positives"),t(s.red&&s.red===l.red,"red works only with red numbers")},O.prototype.imod=function(s){return this.prime?this.prime.ireduce(s)._forceRed(this):s.umod(this.m)._forceRed(this)},O.prototype.neg=function(s){return s.isZero()?s.clone():this.m.sub(s)._forceRed(this)},O.prototype.add=function(s,l){this._verify2(s,l);var d=s.add(l);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},O.prototype.iadd=function(s,l){this._verify2(s,l);var d=s.iadd(l);return d.cmp(this.m)>=0&&d.isub(this.m),d},O.prototype.sub=function(s,l){this._verify2(s,l);var d=s.sub(l);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},O.prototype.isub=function(s,l){this._verify2(s,l);var d=s.isub(l);return d.cmpn(0)<0&&d.iadd(this.m),d},O.prototype.shl=function(s,l){return this._verify1(s),this.imod(s.ushln(l))},O.prototype.imul=function(s,l){return this._verify2(s,l),this.imod(s.imul(l))},O.prototype.mul=function(s,l){return this._verify2(s,l),this.imod(s.mul(l))},O.prototype.isqr=function(s){return this.imul(s,s.clone())},O.prototype.sqr=function(s){return this.mul(s,s)},O.prototype.sqrt=function(s){if(s.isZero())return s.clone();var l=this.m.andln(3);if(t(l%2===1),l===3){var d=this.m.add(new n(1)).iushrn(2);return this.pow(s,d)}for(var p=this.m.subn(1),m=0;!p.isZero()&&p.andln(1)===0;)m++,p.iushrn(1);t(!p.isZero());var w=new n(1).toRed(this),x=w.redNeg(),b=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new n(2*f*f).toRed(this);this.pow(f,b).cmp(x)!==0;)f.redIAdd(x);for(var C=this.pow(f,p),F=this.pow(s,p.addn(1).iushrn(1)),z=this.pow(s,p),W=m;z.cmp(w)!==0;){for(var $=z,I=0;$.cmp(w)!==0;I++)$=$.redSqr();t(I<W);var K=this.pow(C,new n(1).iushln(W-I-1));F=F.redMul(K),C=K.redSqr(),z=z.redMul(C),W=I}return F},O.prototype.invm=function(s){var l=s._invmp(this.m);return l.negative!==0?(l.negative=0,this.imod(l).redNeg()):this.imod(l)},O.prototype.pow=function(s,l){if(l.isZero())return new n(1).toRed(this);if(l.cmpn(1)===0)return s.clone();var d=4,p=new Array(1<<d);p[0]=new n(1).toRed(this),p[1]=s;for(var m=2;m<p.length;m++)p[m]=this.mul(p[m-1],s);var w=p[0],x=0,b=0,f=l.bitLength()%26;for(f===0&&(f=26),m=l.length-1;m>=0;m--){for(var C=l.words[m],F=f-1;F>=0;F--){var z=C>>F&1;if(w!==p[0]&&(w=this.sqr(w)),z===0&&x===0){b=0;continue}x<<=1,x|=z,b++,!(b!==d&&(m!==0||F!==0))&&(w=this.mul(w,p[x]),b=0,x=0)}f=26}return w},O.prototype.convertTo=function(s){var l=s.umod(this.m);return l===s?l.clone():l},O.prototype.convertFrom=function(s){var l=s.clone();return l.red=null,l},n.mont=function(s){return new G(s)};function G(E){O.call(this,E),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(G,O),G.prototype.convertTo=function(s){return this.imod(s.ushln(this.shift))},G.prototype.convertFrom=function(s){var l=this.imod(s.mul(this.rinv));return l.red=null,l},G.prototype.imul=function(s,l){if(s.isZero()||l.isZero())return s.words[0]=0,s.length=1,s;var d=s.imul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.mul=function(s,l){if(s.isZero()||l.isZero())return new n(0)._forceRed(this);var d=s.mul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.invm=function(s){var l=this.imod(s._invmp(this.m).mul(this.r2));return l._forceRed(this)}})(i,di)}(Kf)),Kf.exports}var c0={};const qw={runInNewContext:(i,e)=>new Function("context",`with(context){return ${i}}`)(e)},zw=Object.freeze(Object.defineProperty({__proto__:null,default:qw},Symbol.toStringTag,{value:"Module"})),Vw=e1(zw);var Vv;function Gw(){return Vv||(Vv=1,function(i){var e=Ho(),r=De(),t=i;t.define=function(c,u){return new a(c,u)};function a(n,c){this.name=n,this.body=c,this.decoders={},this.encoders={}}a.prototype._createNamed=function(c){var u;try{u=Vw.runInThisContext("(function "+this.name+`(entity) {
  this._initNamed(entity);
})`)}catch{u=function(o){this._initNamed(o)}}return r(u,c),u.prototype._initNamed=function(o){c.call(this,o)},new u(this)},a.prototype._getDecoder=function(c){return c=c||"der",this.decoders.hasOwnProperty(c)||(this.decoders[c]=this._createNamed(e.decoders[c])),this.decoders[c]},a.prototype.decode=function(c,u,v){return this._getDecoder(u).decode(c,v)},a.prototype._getEncoder=function(c){return c=c||"der",this.encoders.hasOwnProperty(c)||(this.encoders[c]=this._createNamed(e.encoders[c])),this.encoders[c]},a.prototype.encode=function(c,u,v){return this._getEncoder(u).encode(c,v)}}(c0)),c0}var u0={},h0={},Gv;function Kw(){if(Gv)return h0;Gv=1;var i=De();function e(t){this._reporterState={obj:null,path:[],options:t||{},errors:[]}}h0.Reporter=e,e.prototype.isError=function(a){return a instanceof r},e.prototype.save=function(){var a=this._reporterState;return{obj:a.obj,pathLen:a.path.length}},e.prototype.restore=function(a){var n=this._reporterState;n.obj=a.obj,n.path=n.path.slice(0,a.pathLen)},e.prototype.enterKey=function(a){return this._reporterState.path.push(a)},e.prototype.exitKey=function(a){var n=this._reporterState;n.path=n.path.slice(0,a-1)},e.prototype.leaveKey=function(a,n,c){var u=this._reporterState;this.exitKey(a),u.obj!==null&&(u.obj[n]=c)},e.prototype.path=function(){return this._reporterState.path.join("/")},e.prototype.enterObject=function(){var a=this._reporterState,n=a.obj;return a.obj={},n},e.prototype.leaveObject=function(a){var n=this._reporterState,c=n.obj;return n.obj=a,c},e.prototype.error=function(a){var n,c=this._reporterState,u=a instanceof r;if(u?n=a:n=new r(c.path.map(function(v){return"["+JSON.stringify(v)+"]"}).join(""),a.message||a,a.stack),!c.options.partial)throw n;return u||c.errors.push(n),n},e.prototype.wrapResult=function(a){var n=this._reporterState;return n.options.partial?{result:this.isError(a)?null:a,errors:n.errors}:a};function r(t,a){this.path=t,this.rethrow(a)}return i(r,Error),r.prototype.rethrow=function(a){if(this.message=a+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,r),!this.stack)try{throw new Error(this.message)}catch(n){this.stack=n.stack}return this},h0}var Sf={},Kv;function Hv(){if(Kv)return Sf;Kv=1;var i=De(),e=uo().Reporter,r=Ni().Buffer;function t(n,c){if(e.call(this,c),!r.isBuffer(n)){this.error("Input not Buffer");return}this.base=n,this.offset=0,this.length=n.length}i(t,e),Sf.DecoderBuffer=t,t.prototype.save=function(){return{offset:this.offset,reporter:e.prototype.save.call(this)}},t.prototype.restore=function(c){var u=new t(this.base);return u.offset=c.offset,u.length=this.offset,this.offset=c.offset,e.prototype.restore.call(this,c.reporter),u},t.prototype.isEmpty=function(){return this.offset===this.length},t.prototype.readUInt8=function(c){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(c||"DecoderBuffer overrun")},t.prototype.skip=function(c,u){if(!(this.offset+c<=this.length))return this.error(u||"DecoderBuffer overrun");var v=new t(this.base);return v._reporterState=this._reporterState,v.offset=this.offset,v.length=this.offset+c,this.offset+=c,v},t.prototype.raw=function(c){return this.base.slice(c?c.offset:this.offset,this.length)};function a(n,c){if(Array.isArray(n))this.length=0,this.value=n.map(function(u){return u instanceof a||(u=new a(u,c)),this.length+=u.length,u},this);else if(typeof n=="number"){if(!(0<=n&&n<=255))return c.error("non-byte EncoderBuffer value");this.value=n,this.length=1}else if(typeof n=="string")this.value=n,this.length=r.byteLength(n);else if(r.isBuffer(n))this.value=n,this.length=n.length;else return c.error("Unsupported type: "+typeof n)}return Sf.EncoderBuffer=a,a.prototype.join=function(c,u){return c||(c=new r(this.length)),u||(u=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(v){v.join(c,u),u+=v.length}):(typeof this.value=="number"?c[u]=this.value:typeof this.value=="string"?c.write(this.value,u):r.isBuffer(this.value)&&this.value.copy(c,u),u+=this.length)),c},Sf}var d0,Qv;function Hw(){if(Qv)return d0;Qv=1;var i=uo().Reporter,e=uo().EncoderBuffer,r=uo().DecoderBuffer,t=ki(),a=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],n=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(a),c=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function u(o,h){var g={};this._baseState=g,g.enc=o,g.parent=h||null,g.children=null,g.tag=null,g.args=null,g.reverseArgs=null,g.choice=null,g.optional=!1,g.any=!1,g.obj=!1,g.use=null,g.useDecoder=null,g.key=null,g.default=null,g.explicit=null,g.implicit=null,g.contains=null,g.parent||(g.children=[],this._wrap())}d0=u;var v=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];return u.prototype.clone=function(){var h=this._baseState,g={};v.forEach(function(_){g[_]=h[_]});var y=new this.constructor(g.parent);return y._baseState=g,y},u.prototype._wrap=function(){var h=this._baseState;n.forEach(function(g){this[g]=function(){var _=new this.constructor(this);return h.children.push(_),_[g].apply(_,arguments)}},this)},u.prototype._init=function(h){var g=this._baseState;t(g.parent===null),h.call(this),g.children=g.children.filter(function(y){return y._baseState.parent===this},this),t.equal(g.children.length,1,"Root node can have only one child")},u.prototype._useArgs=function(h){var g=this._baseState,y=h.filter(function(_){return _ instanceof this.constructor},this);h=h.filter(function(_){return!(_ instanceof this.constructor)},this),y.length!==0&&(t(g.children===null),g.children=y,y.forEach(function(_){_._baseState.parent=this},this)),h.length!==0&&(t(g.args===null),g.args=h,g.reverseArgs=h.map(function(_){if(typeof _!="object"||_.constructor!==Object)return _;var A={};return Object.keys(_).forEach(function(S){S==(S|0)&&(S|=0);var T=_[S];A[T]=S}),A}))},c.forEach(function(o){u.prototype[o]=function(){var g=this._baseState;throw new Error(o+" not implemented for encoding: "+g.enc)}}),a.forEach(function(o){u.prototype[o]=function(){var g=this._baseState,y=Array.prototype.slice.call(arguments);return t(g.tag===null),g.tag=o,this._useArgs(y),this}}),u.prototype.use=function(h){t(h);var g=this._baseState;return t(g.use===null),g.use=h,this},u.prototype.optional=function(){var h=this._baseState;return h.optional=!0,this},u.prototype.def=function(h){var g=this._baseState;return t(g.default===null),g.default=h,g.optional=!0,this},u.prototype.explicit=function(h){var g=this._baseState;return t(g.explicit===null&&g.implicit===null),g.explicit=h,this},u.prototype.implicit=function(h){var g=this._baseState;return t(g.explicit===null&&g.implicit===null),g.implicit=h,this},u.prototype.obj=function(){var h=this._baseState,g=Array.prototype.slice.call(arguments);return h.obj=!0,g.length!==0&&this._useArgs(g),this},u.prototype.key=function(h){var g=this._baseState;return t(g.key===null),g.key=h,this},u.prototype.any=function(){var h=this._baseState;return h.any=!0,this},u.prototype.choice=function(h){var g=this._baseState;return t(g.choice===null),g.choice=h,this._useArgs(Object.keys(h).map(function(y){return h[y]})),this},u.prototype.contains=function(h){var g=this._baseState;return t(g.use===null),g.contains=h,this},u.prototype._decode=function(h,g){var y=this._baseState;if(y.parent===null)return h.wrapResult(y.children[0]._decode(h,g));var _=y.default,A=!0,S=null;if(y.key!==null&&(S=h.enterKey(y.key)),y.optional){var T=null;if(y.explicit!==null?T=y.explicit:y.implicit!==null?T=y.implicit:y.tag!==null&&(T=y.tag),T===null&&!y.any){var B=h.save();try{y.choice===null?this._decodeGeneric(y.tag,h,g):this._decodeChoice(h,g),A=!0}catch{A=!1}h.restore(B)}else if(A=this._peekTag(h,T,y.any),h.isError(A))return A}var M;if(y.obj&&A&&(M=h.enterObject()),A){if(y.explicit!==null){var R=this._decodeTag(h,y.explicit);if(h.isError(R))return R;h=R}var P=h.offset;if(y.use===null&&y.choice===null){if(y.any)var B=h.save();var D=this._decodeTag(h,y.implicit!==null?y.implicit:y.tag,y.any);if(h.isError(D))return D;y.any?_=h.raw(B):h=D}if(g&&g.track&&y.tag!==null&&g.track(h.path(),P,h.length,"tagged"),g&&g.track&&y.tag!==null&&g.track(h.path(),h.offset,h.length,"content"),y.any?_=_:y.choice===null?_=this._decodeGeneric(y.tag,h,g):_=this._decodeChoice(h,g),h.isError(_))return _;if(!y.any&&y.choice===null&&y.children!==null&&y.children.forEach(function(U){U._decode(h,g)}),y.contains&&(y.tag==="octstr"||y.tag==="bitstr")){var q=new r(_);_=this._getUse(y.contains,h._reporterState.obj)._decode(q,g)}}return y.obj&&A&&(_=h.leaveObject(M)),y.key!==null&&(_!==null||A===!0)?h.leaveKey(S,y.key,_):S!==null&&h.exitKey(S),_},u.prototype._decodeGeneric=function(h,g,y){var _=this._baseState;return h==="seq"||h==="set"?null:h==="seqof"||h==="setof"?this._decodeList(g,h,_.args[0],y):/str$/.test(h)?this._decodeStr(g,h,y):h==="objid"&&_.args?this._decodeObjid(g,_.args[0],_.args[1],y):h==="objid"?this._decodeObjid(g,null,null,y):h==="gentime"||h==="utctime"?this._decodeTime(g,h,y):h==="null_"?this._decodeNull(g,y):h==="bool"?this._decodeBool(g,y):h==="objDesc"?this._decodeStr(g,h,y):h==="int"||h==="enum"?this._decodeInt(g,_.args&&_.args[0],y):_.use!==null?this._getUse(_.use,g._reporterState.obj)._decode(g,y):g.error("unknown tag: "+h)},u.prototype._getUse=function(h,g){var y=this._baseState;return y.useDecoder=this._use(h,g),t(y.useDecoder._baseState.parent===null),y.useDecoder=y.useDecoder._baseState.children[0],y.implicit!==y.useDecoder._baseState.implicit&&(y.useDecoder=y.useDecoder.clone(),y.useDecoder._baseState.implicit=y.implicit),y.useDecoder},u.prototype._decodeChoice=function(h,g){var y=this._baseState,_=null,A=!1;return Object.keys(y.choice).some(function(S){var T=h.save(),B=y.choice[S];try{var M=B._decode(h,g);if(h.isError(M))return!1;_={type:S,value:M},A=!0}catch{return h.restore(T),!1}return!0},this),A?_:h.error("Choice not matched")},u.prototype._createEncoderBuffer=function(h){return new e(h,this.reporter)},u.prototype._encode=function(h,g,y){var _=this._baseState;if(!(_.default!==null&&_.default===h)){var A=this._encodeValue(h,g,y);if(A!==void 0&&!this._skipDefault(A,g,y))return A}},u.prototype._encodeValue=function(h,g,y){var _=this._baseState;if(_.parent===null)return _.children[0]._encode(h,g||new i);var B=null;if(this.reporter=g,_.optional&&h===void 0)if(_.default!==null)h=_.default;else return;var A=null,S=!1;if(_.any)B=this._createEncoderBuffer(h);else if(_.choice)B=this._encodeChoice(h,g);else if(_.contains)A=this._getUse(_.contains,y)._encode(h,g),S=!0;else if(_.children)A=_.children.map(function(P){if(P._baseState.tag==="null_")return P._encode(null,g,h);if(P._baseState.key===null)return g.error("Child should have a key");var D=g.enterKey(P._baseState.key);if(typeof h!="object")return g.error("Child expected, but input is not object");var q=P._encode(h[P._baseState.key],g,h);return g.leaveKey(D),q},this).filter(function(P){return P}),A=this._createEncoderBuffer(A);else if(_.tag==="seqof"||_.tag==="setof"){if(!(_.args&&_.args.length===1))return g.error("Too many args for : "+_.tag);if(!Array.isArray(h))return g.error("seqof/setof, but data is not Array");var T=this.clone();T._baseState.implicit=null,A=this._createEncoderBuffer(h.map(function(P){var D=this._baseState;return this._getUse(D.args[0],h)._encode(P,g)},T))}else _.use!==null?B=this._getUse(_.use,y)._encode(h,g):(A=this._encodePrimitive(_.tag,h),S=!0);var B;if(!_.any&&_.choice===null){var M=_.implicit!==null?_.implicit:_.tag,R=_.implicit===null?"universal":"context";M===null?_.use===null&&g.error("Tag could be omitted only for .use()"):_.use===null&&(B=this._encodeComposite(M,S,R,A))}return _.explicit!==null&&(B=this._encodeComposite(_.explicit,!1,"context",B)),B},u.prototype._encodeChoice=function(h,g){var y=this._baseState,_=y.choice[h.type];return _||t(!1,h.type+" not found in "+JSON.stringify(Object.keys(y.choice))),_._encode(h.value,g)},u.prototype._encodePrimitive=function(h,g){var y=this._baseState;if(/str$/.test(h))return this._encodeStr(g,h);if(h==="objid"&&y.args)return this._encodeObjid(g,y.reverseArgs[0],y.args[1]);if(h==="objid")return this._encodeObjid(g,null,null);if(h==="gentime"||h==="utctime")return this._encodeTime(g,h);if(h==="null_")return this._encodeNull();if(h==="int"||h==="enum")return this._encodeInt(g,y.args&&y.reverseArgs[0]);if(h==="bool")return this._encodeBool(g);if(h==="objDesc")return this._encodeStr(g,h);throw new Error("Unsupported tag: "+h)},u.prototype._isNumstr=function(h){return/^[0-9 ]*$/.test(h)},u.prototype._isPrintstr=function(h){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(h)},d0}var $v;function uo(){return $v||($v=1,function(i){var e=i;e.Reporter=Kw().Reporter,e.DecoderBuffer=Hv().DecoderBuffer,e.EncoderBuffer=Hv().EncoderBuffer,e.Node=Hw()}(u0)),u0}var p0={},v0={},Zv;function Qw(){return Zv||(Zv=1,function(i){var e=Zy();i.tagClass={0:"universal",1:"application",2:"context",3:"private"},i.tagClassByName=e._reverse(i.tagClass),i.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},i.tagByName=e._reverse(i.tag)}(v0)),v0}var jv;function Zy(){return jv||(jv=1,function(i){var e=i;e._reverse=function(t){var a={};return Object.keys(t).forEach(function(n){(n|0)==n&&(n=n|0);var c=t[n];a[c]=n}),a},e.der=Qw()}(p0)),p0}var g0={},m0,Wv;function jy(){if(Wv)return m0;Wv=1;var i=De(),e=Ho(),r=e.base,t=e.bignum,a=e.constants.der;function n(o){this.enc="der",this.name=o.name,this.entity=o,this.tree=new c,this.tree._init(o.body)}m0=n,n.prototype.decode=function(h,g){return h instanceof r.DecoderBuffer||(h=new r.DecoderBuffer(h,g)),this.tree._decode(h,g)};function c(o){r.Node.call(this,"der",o)}i(c,r.Node),c.prototype._peekTag=function(h,g,y){if(h.isEmpty())return!1;var _=h.save(),A=u(h,'Failed to peek tag: "'+g+'"');return h.isError(A)?A:(h.restore(_),A.tag===g||A.tagStr===g||A.tagStr+"of"===g||y)},c.prototype._decodeTag=function(h,g,y){var _=u(h,'Failed to decode tag of "'+g+'"');if(h.isError(_))return _;var A=v(h,_.primitive,'Failed to get length of "'+g+'"');if(h.isError(A))return A;if(!y&&_.tag!==g&&_.tagStr!==g&&_.tagStr+"of"!==g)return h.error('Failed to match tag: "'+g+'"');if(_.primitive||A!==null)return h.skip(A,'Failed to match body of: "'+g+'"');var S=h.save(),T=this._skipUntilEnd(h,'Failed to skip indefinite length body: "'+this.tag+'"');return h.isError(T)?T:(A=h.offset-S.offset,h.restore(S),h.skip(A,'Failed to match body of: "'+g+'"'))},c.prototype._skipUntilEnd=function(h,g){for(;;){var y=u(h,g);if(h.isError(y))return y;var _=v(h,y.primitive,g);if(h.isError(_))return _;var A;if(y.primitive||_!==null?A=h.skip(_):A=this._skipUntilEnd(h,g),h.isError(A))return A;if(y.tagStr==="end")break}},c.prototype._decodeList=function(h,g,y,_){for(var A=[];!h.isEmpty();){var S=this._peekTag(h,"end");if(h.isError(S))return S;var T=y.decode(h,"der",_);if(h.isError(T)&&S)break;A.push(T)}return A},c.prototype._decodeStr=function(h,g){if(g==="bitstr"){var y=h.readUInt8();return h.isError(y)?y:{unused:y,data:h.raw()}}else if(g==="bmpstr"){var _=h.raw();if(_.length%2===1)return h.error("Decoding of string type: bmpstr length mismatch");for(var A="",S=0;S<_.length/2;S++)A+=String.fromCharCode(_.readUInt16BE(S*2));return A}else if(g==="numstr"){var T=h.raw().toString("ascii");return this._isNumstr(T)?T:h.error("Decoding of string type: numstr unsupported characters")}else{if(g==="octstr")return h.raw();if(g==="objDesc")return h.raw();if(g==="printstr"){var B=h.raw().toString("ascii");return this._isPrintstr(B)?B:h.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(g)?h.raw().toString():h.error("Decoding of string type: "+g+" unsupported")}},c.prototype._decodeObjid=function(h,g,y){for(var _,A=[],S=0;!h.isEmpty();){var T=h.readUInt8();S<<=7,S|=T&127,T&128||(A.push(S),S=0)}T&128&&A.push(S);var B=A[0]/40|0,M=A[0]%40;if(y?_=A:_=[B,M].concat(A.slice(1)),g){var R=g[_.join(" ")];R===void 0&&(R=g[_.join(".")]),R!==void 0&&(_=R)}return _},c.prototype._decodeTime=function(h,g){var y=h.raw().toString();if(g==="gentime")var _=y.slice(0,4)|0,A=y.slice(4,6)|0,S=y.slice(6,8)|0,T=y.slice(8,10)|0,B=y.slice(10,12)|0,M=y.slice(12,14)|0;else if(g==="utctime"){var _=y.slice(0,2)|0,A=y.slice(2,4)|0,S=y.slice(4,6)|0,T=y.slice(6,8)|0,B=y.slice(8,10)|0,M=y.slice(10,12)|0;_<70?_=2e3+_:_=1900+_}else return h.error("Decoding "+g+" time is not supported yet");return Date.UTC(_,A-1,S,T,B,M,0)},c.prototype._decodeNull=function(h){return null},c.prototype._decodeBool=function(h){var g=h.readUInt8();return h.isError(g)?g:g!==0},c.prototype._decodeInt=function(h,g){var y=h.raw(),_=new t(y);return g&&(_=g[_.toString(10)]||_),_},c.prototype._use=function(h,g){return typeof h=="function"&&(h=h(g)),h._getDecoder("der").tree};function u(o,h){var g=o.readUInt8(h);if(o.isError(g))return g;var y=a.tagClass[g>>6],_=(g&32)===0;if((g&31)===31){var A=g;for(g=0;(A&128)===128;){if(A=o.readUInt8(h),o.isError(A))return A;g<<=7,g|=A&127}}else g&=31;var S=a.tag[g];return{cls:y,primitive:_,tag:g,tagStr:S}}function v(o,h,g){var y=o.readUInt8(g);if(o.isError(y))return y;if(!h&&y===128)return null;if(!(y&128))return y;var _=y&127;if(_>4)return o.error("length octect is too long");y=0;for(var A=0;A<_;A++){y<<=8;var S=o.readUInt8(g);if(o.isError(S))return S;y|=S}return y}return m0}var y0,Yv;function $w(){if(Yv)return y0;Yv=1;var i=De(),e=Ni().Buffer,r=jy();function t(a){r.call(this,a),this.enc="pem"}return i(t,r),y0=t,t.prototype.decode=function(n,c){for(var u=n.toString().split(/[\r\n]+/g),v=c.label.toUpperCase(),o=/^-----(BEGIN|END) ([^-]+)-----$/,h=-1,g=-1,y=0;y<u.length;y++){var _=u[y].match(o);if(_!==null&&_[2]===v)if(h===-1){if(_[1]!=="BEGIN")break;h=y}else{if(_[1]!=="END")break;g=y;break}}if(h===-1||g===-1)throw new Error("PEM section not found for: "+v);var A=u.slice(h+1,g).join("");A.replace(/[^a-z0-9\+\/=]+/gi,"");var S=new e(A,"base64");return r.prototype.decode.call(this,S,c)},y0}var Xv;function Zw(){return Xv||(Xv=1,function(i){var e=i;e.der=jy(),e.pem=$w()}(g0)),g0}var b0={},_0,Jv;function Wy(){if(Jv)return _0;Jv=1;var i=De(),e=Ni().Buffer,r=Ho(),t=r.base,a=r.constants.der;function n(o){this.enc="der",this.name=o.name,this.entity=o,this.tree=new c,this.tree._init(o.body)}_0=n,n.prototype.encode=function(h,g){return this.tree._encode(h,g).join()};function c(o){t.Node.call(this,"der",o)}i(c,t.Node),c.prototype._encodeComposite=function(h,g,y,_){var A=v(h,g,y,this.reporter);if(_.length<128){var B=new e(2);return B[0]=A,B[1]=_.length,this._createEncoderBuffer([B,_])}for(var S=1,T=_.length;T>=256;T>>=8)S++;var B=new e(2+S);B[0]=A,B[1]=128|S;for(var T=1+S,M=_.length;M>0;T--,M>>=8)B[T]=M&255;return this._createEncoderBuffer([B,_])},c.prototype._encodeStr=function(h,g){if(g==="bitstr")return this._createEncoderBuffer([h.unused|0,h.data]);if(g==="bmpstr"){for(var y=new e(h.length*2),_=0;_<h.length;_++)y.writeUInt16BE(h.charCodeAt(_),_*2);return this._createEncoderBuffer(y)}else return g==="numstr"?this._isNumstr(h)?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: numstr supports only digits and space"):g==="printstr"?this._isPrintstr(h)?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(g)?this._createEncoderBuffer(h):g==="objDesc"?this._createEncoderBuffer(h):this.reporter.error("Encoding of string type: "+g+" unsupported")},c.prototype._encodeObjid=function(h,g,y){if(typeof h=="string"){if(!g)return this.reporter.error("string objid given, but no values map found");if(!g.hasOwnProperty(h))return this.reporter.error("objid not found in values map");h=g[h].split(/[\s\.]+/g);for(var _=0;_<h.length;_++)h[_]|=0}else if(Array.isArray(h)){h=h.slice();for(var _=0;_<h.length;_++)h[_]|=0}if(!Array.isArray(h))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(h));if(!y){if(h[1]>=40)return this.reporter.error("Second objid identifier OOB");h.splice(0,2,h[0]*40+h[1])}for(var A=0,_=0;_<h.length;_++){var S=h[_];for(A++;S>=128;S>>=7)A++}for(var T=new e(A),B=T.length-1,_=h.length-1;_>=0;_--){var S=h[_];for(T[B--]=S&127;(S>>=7)>0;)T[B--]=128|S&127}return this._createEncoderBuffer(T)};function u(o){return o<10?"0"+o:o}c.prototype._encodeTime=function(h,g){var y,_=new Date(h);return g==="gentime"?y=[u(_.getFullYear()),u(_.getUTCMonth()+1),u(_.getUTCDate()),u(_.getUTCHours()),u(_.getUTCMinutes()),u(_.getUTCSeconds()),"Z"].join(""):g==="utctime"?y=[u(_.getFullYear()%100),u(_.getUTCMonth()+1),u(_.getUTCDate()),u(_.getUTCHours()),u(_.getUTCMinutes()),u(_.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+g+" time is not supported yet"),this._encodeStr(y,"octstr")},c.prototype._encodeNull=function(){return this._createEncoderBuffer("")},c.prototype._encodeInt=function(h,g){if(typeof h=="string"){if(!g)return this.reporter.error("String int or enum given, but no values map");if(!g.hasOwnProperty(h))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(h));h=g[h]}if(typeof h!="number"&&!e.isBuffer(h)){var y=h.toArray();!h.sign&&y[0]&128&&y.unshift(0),h=new e(y)}if(e.isBuffer(h)){var _=h.length;h.length===0&&_++;var S=new e(_);return h.copy(S),h.length===0&&(S[0]=0),this._createEncoderBuffer(S)}if(h<128)return this._createEncoderBuffer(h);if(h<256)return this._createEncoderBuffer([0,h]);for(var _=1,A=h;A>=256;A>>=8)_++;for(var S=new Array(_),A=S.length-1;A>=0;A--)S[A]=h&255,h>>=8;return S[0]&128&&S.unshift(0),this._createEncoderBuffer(new e(S))},c.prototype._encodeBool=function(h){return this._createEncoderBuffer(h?255:0)},c.prototype._use=function(h,g){return typeof h=="function"&&(h=h(g)),h._getEncoder("der").tree},c.prototype._skipDefault=function(h,g,y){var _=this._baseState,A;if(_.default===null)return!1;var S=h.join();if(_.defaultBuffer===void 0&&(_.defaultBuffer=this._encodeValue(_.default,g,y).join()),S.length!==_.defaultBuffer.length)return!1;for(A=0;A<S.length;A++)if(S[A]!==_.defaultBuffer[A])return!1;return!0};function v(o,h,g,y){var _;if(o==="seqof"?o="seq":o==="setof"&&(o="set"),a.tagByName.hasOwnProperty(o))_=a.tagByName[o];else if(typeof o=="number"&&(o|0)===o)_=o;else return y.error("Unknown tag: "+o);return _>=31?y.error("Multi-octet tag encoding unsupported"):(h||(_|=32),_|=a.tagClassByName[g||"universal"]<<6,_)}return _0}var w0,tg;function jw(){if(tg)return w0;tg=1;var i=De(),e=Wy();function r(t){e.call(this,t),this.enc="pem"}return i(r,e),w0=r,r.prototype.encode=function(a,n){for(var c=e.prototype.encode.call(this,a),u=c.toString("base64"),v=["-----BEGIN "+n.label+"-----"],o=0;o<u.length;o+=64)v.push(u.slice(o,o+64));return v.push("-----END "+n.label+"-----"),v.join(`
`)},w0}var eg;function Ww(){return eg||(eg=1,function(i){var e=i;e.der=Wy(),e.pem=jw()}(b0)),b0}var rg;function Ho(){return rg||(rg=1,function(i){var e=i;e.bignum=Fw(),e.define=Gw().define,e.base=uo(),e.constants=Zy(),e.decoders=Zw(),e.encoders=Ww()}(l0)),l0}var C0,ig;function Yw(){if(ig)return C0;ig=1;var i=Ho(),e=i.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),r=i.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),t=i.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),a=i.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(t),this.key("subjectPublicKey").bitstr())}),n=i.define("RelativeDistinguishedName",function(){this.setof(r)}),c=i.define("RDNSequence",function(){this.seqof(n)}),u=i.define("Name",function(){this.choice({rdnSequence:this.use(c)})}),v=i.define("Validity",function(){this.seq().obj(this.key("notBefore").use(e),this.key("notAfter").use(e))}),o=i.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),h=i.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(t),this.key("issuer").use(u),this.key("validity").use(v),this.key("subject").use(u),this.key("subjectPublicKeyInfo").use(a),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(o).optional())}),g=i.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(h),this.key("signatureAlgorithm").use(t),this.key("signatureValue").bitstr())});return C0=g,C0}var ng;function Xw(){if(ng)return Di;ng=1;var i=Ho();Di.certificate=Yw();var e=i.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});Di.RSAPrivateKey=e;var r=i.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});Di.RSAPublicKey=r;var t=i.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),a=i.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(t),this.key("subjectPublicKey").bitstr())});Di.PublicKey=a;var n=i.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(t),this.key("subjectPrivateKey").octstr())});Di.PrivateKey=n;var c=i.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});Di.EncryptedPrivateKey=c;var u=i.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});Di.DSAPrivateKey=u,Di.DSAparam=i.define("DSAparam",function(){this.int()});var v=i.define("ECParameters",function(){this.choice({namedCurve:this.objid()})}),o=i.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(v),this.key("publicKey").optional().explicit(1).bitstr())});return Di.ECPrivateKey=o,Di.signature=i.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())}),Di}const Jw={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"};var E0,ag;function t5(){if(ag)return E0;ag=1;var i=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,e=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,r=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,t=xl(),a=f1(),n=er().Buffer;return E0=function(c,u){var v=c.toString(),o=v.match(i),h;if(o){var y="aes"+o[1],_=n.from(o[2],"hex"),A=n.from(o[3].replace(/[\r\n]/g,""),"base64"),S=t(u,_.slice(0,8),parseInt(o[1],10)).key,T=[],B=a.createDecipheriv(y,S,_);T.push(B.update(A)),T.push(B.final()),h=n.concat(T)}else{var g=v.match(r);h=n.from(g[2].replace(/[\r\n]/g,""),"base64")}var M=v.match(e)[1];return{tag:M,data:h}},E0}var A0,sg;function Bl(){if(sg)return A0;sg=1;var i=Xw(),e=Jw,r=t5(),t=f1(),a=Iy(),n=er().Buffer;function c(v,o){var h=v.algorithm.decrypt.kde.kdeparams.salt,g=parseInt(v.algorithm.decrypt.kde.kdeparams.iters.toString(),10),y=e[v.algorithm.decrypt.cipher.algo.join(".")],_=v.algorithm.decrypt.cipher.iv,A=v.subjectPrivateKey,S=parseInt(y.split("-")[1],10)/8,T=a.pbkdf2Sync(o,h,g,S,"sha1"),B=t.createDecipheriv(y,T,_),M=[];return M.push(B.update(A)),M.push(B.final()),n.concat(M)}function u(v){var o;typeof v=="object"&&!n.isBuffer(v)&&(o=v.passphrase,v=v.key),typeof v=="string"&&(v=n.from(v));var h=r(v,o),g=h.tag,y=h.data,_,A;switch(g){case"CERTIFICATE":A=i.certificate.decode(y,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(A||(A=i.PublicKey.decode(y,"der")),_=A.algorithm.algorithm.join("."),_){case"1.2.840.113549.1.1.1":return i.RSAPublicKey.decode(A.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return A.subjectPrivateKey=A.subjectPublicKey,{type:"ec",data:A};case"1.2.840.10040.4.1":return A.algorithm.params.pub_key=i.DSAparam.decode(A.subjectPublicKey.data,"der"),{type:"dsa",data:A.algorithm.params};default:throw new Error("unknown key id "+_)}case"ENCRYPTED PRIVATE KEY":y=i.EncryptedPrivateKey.decode(y,"der"),y=c(y,o);case"PRIVATE KEY":switch(A=i.PrivateKey.decode(y,"der"),_=A.algorithm.algorithm.join("."),_){case"1.2.840.113549.1.1.1":return i.RSAPrivateKey.decode(A.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:A.algorithm.curve,privateKey:i.ECPrivateKey.decode(A.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return A.algorithm.params.priv_key=i.DSAparam.decode(A.subjectPrivateKey,"der"),{type:"dsa",params:A.algorithm.params};default:throw new Error("unknown key id "+_)}case"RSA PUBLIC KEY":return i.RSAPublicKey.decode(y,"der");case"RSA PRIVATE KEY":return i.RSAPrivateKey.decode(y,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:i.DSAPrivateKey.decode(y,"der")};case"EC PRIVATE KEY":return y=i.ECPrivateKey.decode(y,"der"),{curve:y.parameters.value,privateKey:y.privateKey};default:throw new Error("unknown key type "+g)}}return u.signature=i.signature,A0=u,A0}const Yy={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"};var og;function e5(){if(og)return Zs.exports;og=1;var i=er().Buffer,e=wy(),r=u1(),t=$y().ec,a=c1(),n=Bl(),c=Yy,u=1;function v(B,M,R,P,D){var q=n(M);if(q.curve){if(P!=="ecdsa"&&P!=="ecdsa/rsa")throw new Error("wrong private key type");return o(B,q)}else if(q.type==="dsa"){if(P!=="dsa")throw new Error("wrong private key type");return h(B,q,R)}if(P!=="rsa"&&P!=="ecdsa/rsa")throw new Error("wrong private key type");if(M.padding!==void 0&&M.padding!==u)throw new Error("illegal or unsupported padding mode");B=i.concat([D,B]);for(var k=q.modulus.byteLength(),U=[0,1];B.length+U.length+1<k;)U.push(255);U.push(0);for(var O=-1;++O<B.length;)U.push(B[O]);var G=r(U,q);return G}function o(B,M){var R=c[M.curve.join(".")];if(!R)throw new Error("unknown curve "+M.curve.join("."));var P=new t(R),D=P.keyFromPrivate(M.privateKey),q=D.sign(B);return i.from(q.toDER())}function h(B,M,R){for(var P=M.params.priv_key,D=M.params.p,q=M.params.q,k=M.params.g,U=new a(0),O,G=_(B,q).mod(q),E=!1,s=y(P,q,B,R);E===!1;)O=S(q,s,R),U=T(k,O,D,q),E=O.invm(q).imul(G.add(P.mul(U))).mod(q),E.cmpn(0)===0&&(E=!1,U=new a(0));return g(U,E)}function g(B,M){B=B.toArray(),M=M.toArray(),B[0]&128&&(B=[0].concat(B)),M[0]&128&&(M=[0].concat(M));var R=B.length+M.length+4,P=[48,R,2,B.length];return P=P.concat(B,[2,M.length],M),i.from(P)}function y(B,M,R,P){if(B=i.from(B.toArray()),B.length<M.byteLength()){var D=i.alloc(M.byteLength()-B.length);B=i.concat([D,B])}var q=R.length,k=A(R,M),U=i.alloc(q);U.fill(1);var O=i.alloc(q);return O=e(P,O).update(U).update(i.from([0])).update(B).update(k).digest(),U=e(P,O).update(U).digest(),O=e(P,O).update(U).update(i.from([1])).update(B).update(k).digest(),U=e(P,O).update(U).digest(),{k:O,v:U}}function _(B,M){var R=new a(B),P=(B.length<<3)-M.bitLength();return P>0&&R.ishrn(P),R}function A(B,M){B=_(B,M),B=B.mod(M);var R=i.from(B.toArray());if(R.length<M.byteLength()){var P=i.alloc(M.byteLength()-R.length);R=i.concat([P,R])}return R}function S(B,M,R){var P,D;do{for(P=i.alloc(0);P.length*8<B.bitLength();)M.v=e(R,M.k).update(M.v).digest(),P=i.concat([P,M.v]);D=_(P,B),M.k=e(R,M.k).update(M.v).update(i.from([0])).digest(),M.v=e(R,M.k).update(M.v).digest()}while(D.cmp(B)!==-1);return D}function T(B,M,R,P){return B.toRed(a.mont(R)).redPow(M).fromRed().mod(P)}return Zs.exports=v,Zs.exports.getKey=y,Zs.exports.makeKey=S,Zs.exports}var S0,fg;function r5(){if(fg)return S0;fg=1;var i=er().Buffer,e=c1(),r=$y().ec,t=Bl(),a=Yy;function n(o,h,g,y,_){var A=t(g);if(A.type==="ec"){if(y!=="ecdsa"&&y!=="ecdsa/rsa")throw new Error("wrong public key type");return c(o,h,A)}else if(A.type==="dsa"){if(y!=="dsa")throw new Error("wrong public key type");return u(o,h,A)}if(y!=="rsa"&&y!=="ecdsa/rsa")throw new Error("wrong public key type");h=i.concat([_,h]);for(var S=A.modulus.byteLength(),T=[1],B=0;h.length+T.length+2<S;)T.push(255),B+=1;T.push(0);for(var M=-1;++M<h.length;)T.push(h[M]);T=i.from(T);var R=e.mont(A.modulus);o=new e(o).toRed(R),o=o.redPow(new e(A.publicExponent)),o=i.from(o.fromRed().toArray());var P=B<8?1:0;for(S=Math.min(o.length,T.length),o.length!==T.length&&(P=1),M=-1;++M<S;)P|=o[M]^T[M];return P===0}function c(o,h,g){var y=a[g.data.algorithm.curve.join(".")];if(!y)throw new Error("unknown curve "+g.data.algorithm.curve.join("."));var _=new r(y),A=g.data.subjectPrivateKey.data;return _.verify(h,o,A)}function u(o,h,g){var y=g.data.p,_=g.data.q,A=g.data.g,S=g.data.pub_key,T=t.signature.decode(o,"der"),B=T.s,M=T.r;v(B,_),v(M,_);var R=e.mont(y),P=B.invm(_),D=A.toRed(R).redPow(new e(h).mul(P).mod(_)).fromRed().mul(S.toRed(R).redPow(M.mul(P).mod(_)).fromRed()).mod(y).mod(_);return D.cmp(M)===0}function v(o,h){if(o.cmpn(0)<=0)throw new Error("invalid sig");if(o.cmp(h)>=0)throw new Error("invalid sig")}return S0=n,S0}var x0,lg;function i5(){if(lg)return x0;lg=1;var i=er().Buffer,e=Fo(),r=ow(),t=De(),a=e5(),n=r5(),c=Cy;Object.keys(c).forEach(function(g){c[g].id=i.from(c[g].id,"hex"),c[g.toLowerCase()]=c[g]});function u(g){r.Writable.call(this);var y=c[g];if(!y)throw new Error("Unknown message digest");this._hashType=y.hash,this._hash=e(y.hash),this._tag=y.id,this._signType=y.sign}t(u,r.Writable),u.prototype._write=function(y,_,A){this._hash.update(y),A()},u.prototype.update=function(y,_){return this._hash.update(typeof y=="string"?i.from(y,_):y),this},u.prototype.sign=function(y,_){this.end();var A=this._hash.digest(),S=a(A,y,this._hashType,this._signType,this._tag);return _?S.toString(_):S};function v(g){r.Writable.call(this);var y=c[g];if(!y)throw new Error("Unknown message digest");this._hash=e(y.hash),this._tag=y.id,this._signType=y.sign}t(v,r.Writable),v.prototype._write=function(y,_,A){this._hash.update(y),A()},v.prototype.update=function(y,_){return this._hash.update(typeof y=="string"?i.from(y,_):y),this},v.prototype.verify=function(y,_,A){var S=typeof _=="string"?i.from(_,A):_;this.end();var T=this._hash.digest();return n(S,T,y,this._signType,this._tag)};function o(g){return new u(g)}function h(g){return new v(g)}return x0={Sign:o,Verify:h,createSign:o,createVerify:h},x0}var I0={};const n5="elliptic",a5="6.5.4",s5="EC cryptography",o5="lib/elliptic.js",f5=["lib"],l5={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},c5={type:"git",url:"git@github.com:indutny/elliptic"},u5=["EC","Elliptic","curve","Cryptography"],h5="Fedor Indutny <fedor@indutny.com>",d5="MIT",p5={url:"https://github.com/indutny/elliptic/issues"},v5="https://github.com/indutny/elliptic",g5={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},m5={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},y5={name:n5,version:a5,description:s5,main:o5,files:f5,scripts:l5,repository:c5,keywords:u5,author:h5,license:d5,bugs:p5,homepage:v5,devDependencies:g5,dependencies:m5};var M0={},Hf={exports:{}};Hf.exports;var cg;function Zn(){return cg||(cg=1,function(i){(function(e,r){function t(E,s){if(!E)throw new Error(s||"Assertion failed")}function a(E,s){E.super_=s;var l=function(){};l.prototype=s.prototype,E.prototype=new l,E.prototype.constructor=E}function n(E,s,l){if(n.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&((s==="le"||s==="be")&&(l=s,s=10),this._init(E||0,s||10,l||"be"))}typeof e=="object"?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=$i.Buffer}catch{}n.isBN=function(s){return s instanceof n?!0:s!==null&&typeof s=="object"&&s.constructor.wordSize===n.wordSize&&Array.isArray(s.words)},n.max=function(s,l){return s.cmp(l)>0?s:l},n.min=function(s,l){return s.cmp(l)<0?s:l},n.prototype._init=function(s,l,d){if(typeof s=="number")return this._initNumber(s,l,d);if(typeof s=="object")return this._initArray(s,l,d);l==="hex"&&(l=16),t(l===(l|0)&&l>=2&&l<=36),s=s.toString().replace(/\s+/g,"");var p=0;s[0]==="-"&&(p++,this.negative=1),p<s.length&&(l===16?this._parseHex(s,p,d):(this._parseBase(s,l,p),d==="le"&&this._initArray(this.toArray(),l,d)))},n.prototype._initNumber=function(s,l,d){s<0&&(this.negative=1,s=-s),s<67108864?(this.words=[s&67108863],this.length=1):s<4503599627370496?(this.words=[s&67108863,s/67108864&67108863],this.length=2):(t(s<9007199254740992),this.words=[s&67108863,s/67108864&67108863,1],this.length=3),d==="le"&&this._initArray(this.toArray(),l,d)},n.prototype._initArray=function(s,l,d){if(t(typeof s.length=="number"),s.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(s.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m,w,x=0;if(d==="be")for(p=s.length-1,m=0;p>=0;p-=3)w=s[p]|s[p-1]<<8|s[p-2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);else if(d==="le")for(p=0,m=0;p<s.length;p+=3)w=s[p]|s[p+1]<<8|s[p+2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);return this.strip()};function u(E,s){var l=E.charCodeAt(s);return l>=65&&l<=70?l-55:l>=97&&l<=102?l-87:l-48&15}function v(E,s,l){var d=u(E,l);return l-1>=s&&(d|=u(E,l-1)<<4),d}n.prototype._parseHex=function(s,l,d){this.length=Math.ceil((s.length-l)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m=0,w=0,x;if(d==="be")for(p=s.length-1;p>=l;p-=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8;else{var b=s.length-l;for(p=b%2===0?l+1:l;p<s.length;p+=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8}this.strip()};function o(E,s,l,d){for(var p=0,m=Math.min(E.length,l),w=s;w<m;w++){var x=E.charCodeAt(w)-48;p*=d,x>=49?p+=x-49+10:x>=17?p+=x-17+10:p+=x}return p}n.prototype._parseBase=function(s,l,d){this.words=[0],this.length=1;for(var p=0,m=1;m<=67108863;m*=l)p++;p--,m=m/l|0;for(var w=s.length-d,x=w%p,b=Math.min(w,w-x)+d,f=0,C=d;C<b;C+=p)f=o(s,C,C+p,l),this.imuln(m),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(x!==0){var F=1;for(f=o(s,C,s.length,l),C=0;C<x;C++)F*=l;this.imuln(F),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},n.prototype.copy=function(s){s.words=new Array(this.length);for(var l=0;l<this.length;l++)s.words[l]=this.words[l];s.length=this.length,s.negative=this.negative,s.red=this.red},n.prototype.clone=function(){var s=new n(null);return this.copy(s),s},n.prototype._expand=function(s){for(;this.length<s;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(s,l){s=s||10,l=l|0||1;var d;if(s===16||s==="hex"){d="";for(var p=0,m=0,w=0;w<this.length;w++){var x=this.words[w],b=((x<<p|m)&16777215).toString(16);m=x>>>24-p&16777215,p+=2,p>=26&&(p-=26,w--),m!==0||w!==this.length-1?d=h[6-b.length]+b+d:d=b+d}for(m!==0&&(d=m.toString(16)+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}if(s===(s|0)&&s>=2&&s<=36){var f=g[s],C=y[s];d="";var F=this.clone();for(F.negative=0;!F.isZero();){var z=F.modn(C).toString(s);F=F.idivn(C),F.isZero()?d=z+d:d=h[f-z.length]+z+d}for(this.isZero()&&(d="0"+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var s=this.words[0];return this.length===2?s+=this.words[1]*67108864:this.length===3&&this.words[2]===1?s+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-s:s},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(s,l){return t(typeof c<"u"),this.toArrayLike(c,s,l)},n.prototype.toArray=function(s,l){return this.toArrayLike(Array,s,l)},n.prototype.toArrayLike=function(s,l,d){var p=this.byteLength(),m=d||Math.max(1,p);t(p<=m,"byte array longer than desired length"),t(m>0,"Requested array length <= 0"),this.strip();var w=l==="le",x=new s(m),b,f,C=this.clone();if(w){for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[f]=b;for(;f<m;f++)x[f]=0}else{for(f=0;f<m-p;f++)x[f]=0;for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[m-f-1]=b}return x},Math.clz32?n.prototype._countBits=function(s){return 32-Math.clz32(s)}:n.prototype._countBits=function(s){var l=s,d=0;return l>=4096&&(d+=13,l>>>=13),l>=64&&(d+=7,l>>>=7),l>=8&&(d+=4,l>>>=4),l>=2&&(d+=2,l>>>=2),d+l},n.prototype._zeroBits=function(s){if(s===0)return 26;var l=s,d=0;return l&8191||(d+=13,l>>>=13),l&127||(d+=7,l>>>=7),l&15||(d+=4,l>>>=4),l&3||(d+=2,l>>>=2),l&1||d++,d},n.prototype.bitLength=function(){var s=this.words[this.length-1],l=this._countBits(s);return(this.length-1)*26+l};function _(E){for(var s=new Array(E.bitLength()),l=0;l<s.length;l++){var d=l/26|0,p=l%26;s[l]=(E.words[d]&1<<p)>>>p}return s}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var s=0,l=0;l<this.length;l++){var d=this._zeroBits(this.words[l]);if(s+=d,d!==26)break}return s},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(s){return this.negative!==0?this.abs().inotn(s).iaddn(1):this.clone()},n.prototype.fromTwos=function(s){return this.testn(s-1)?this.notn(s).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(s){for(;this.length<s.length;)this.words[this.length++]=0;for(var l=0;l<s.length;l++)this.words[l]=this.words[l]|s.words[l];return this.strip()},n.prototype.ior=function(s){return t((this.negative|s.negative)===0),this.iuor(s)},n.prototype.or=function(s){return this.length>s.length?this.clone().ior(s):s.clone().ior(this)},n.prototype.uor=function(s){return this.length>s.length?this.clone().iuor(s):s.clone().iuor(this)},n.prototype.iuand=function(s){var l;this.length>s.length?l=s:l=this;for(var d=0;d<l.length;d++)this.words[d]=this.words[d]&s.words[d];return this.length=l.length,this.strip()},n.prototype.iand=function(s){return t((this.negative|s.negative)===0),this.iuand(s)},n.prototype.and=function(s){return this.length>s.length?this.clone().iand(s):s.clone().iand(this)},n.prototype.uand=function(s){return this.length>s.length?this.clone().iuand(s):s.clone().iuand(this)},n.prototype.iuxor=function(s){var l,d;this.length>s.length?(l=this,d=s):(l=s,d=this);for(var p=0;p<d.length;p++)this.words[p]=l.words[p]^d.words[p];if(this!==l)for(;p<l.length;p++)this.words[p]=l.words[p];return this.length=l.length,this.strip()},n.prototype.ixor=function(s){return t((this.negative|s.negative)===0),this.iuxor(s)},n.prototype.xor=function(s){return this.length>s.length?this.clone().ixor(s):s.clone().ixor(this)},n.prototype.uxor=function(s){return this.length>s.length?this.clone().iuxor(s):s.clone().iuxor(this)},n.prototype.inotn=function(s){t(typeof s=="number"&&s>=0);var l=Math.ceil(s/26)|0,d=s%26;this._expand(l),d>0&&l--;for(var p=0;p<l;p++)this.words[p]=~this.words[p]&67108863;return d>0&&(this.words[p]=~this.words[p]&67108863>>26-d),this.strip()},n.prototype.notn=function(s){return this.clone().inotn(s)},n.prototype.setn=function(s,l){t(typeof s=="number"&&s>=0);var d=s/26|0,p=s%26;return this._expand(d+1),l?this.words[d]=this.words[d]|1<<p:this.words[d]=this.words[d]&~(1<<p),this.strip()},n.prototype.iadd=function(s){var l;if(this.negative!==0&&s.negative===0)return this.negative=0,l=this.isub(s),this.negative^=1,this._normSign();if(this.negative===0&&s.negative!==0)return s.negative=0,l=this.isub(s),s.negative=1,l._normSign();var d,p;this.length>s.length?(d=this,p=s):(d=s,p=this);for(var m=0,w=0;w<p.length;w++)l=(d.words[w]|0)+(p.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;for(;m!==0&&w<d.length;w++)l=(d.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;if(this.length=d.length,m!==0)this.words[this.length]=m,this.length++;else if(d!==this)for(;w<d.length;w++)this.words[w]=d.words[w];return this},n.prototype.add=function(s){var l;return s.negative!==0&&this.negative===0?(s.negative=0,l=this.sub(s),s.negative^=1,l):s.negative===0&&this.negative!==0?(this.negative=0,l=s.sub(this),this.negative=1,l):this.length>s.length?this.clone().iadd(s):s.clone().iadd(this)},n.prototype.isub=function(s){if(s.negative!==0){s.negative=0;var l=this.iadd(s);return s.negative=1,l._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(s),this.negative=1,this._normSign();var d=this.cmp(s);if(d===0)return this.negative=0,this.length=1,this.words[0]=0,this;var p,m;d>0?(p=this,m=s):(p=s,m=this);for(var w=0,x=0;x<m.length;x++)l=(p.words[x]|0)-(m.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;for(;w!==0&&x<p.length;x++)l=(p.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;if(w===0&&x<p.length&&p!==this)for(;x<p.length;x++)this.words[x]=p.words[x];return this.length=Math.max(this.length,x),p!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(s){return this.clone().isub(s)};function A(E,s,l){l.negative=s.negative^E.negative;var d=E.length+s.length|0;l.length=d,d=d-1|0;var p=E.words[0]|0,m=s.words[0]|0,w=p*m,x=w&67108863,b=w/67108864|0;l.words[0]=x;for(var f=1;f<d;f++){for(var C=b>>>26,F=b&67108863,z=Math.min(f,s.length-1),W=Math.max(0,f-E.length+1);W<=z;W++){var $=f-W|0;p=E.words[$]|0,m=s.words[W]|0,w=p*m+F,C+=w/67108864|0,F=w&67108863}l.words[f]=F|0,b=C|0}return b!==0?l.words[f]=b|0:l.length--,l.strip()}var S=function(s,l,d){var p=s.words,m=l.words,w=d.words,x=0,b,f,C,F=p[0]|0,z=F&8191,W=F>>>13,$=p[1]|0,I=$&8191,K=$>>>13,N=p[2]|0,X=N&8191,Q=N>>>13,L=p[3]|0,V=L&8191,Z=L>>>13,H=p[4]|0,j=H&8191,et=H>>>13,nt=p[5]|0,st=nt&8191,ft=nt>>>13,vt=p[6]|0,ot=vt&8191,pt=vt>>>13,Ut=p[7]|0,At=Ut&8191,It=Ut>>>13,Jt=p[8]|0,at=Jt&8191,J=Jt>>>13,rt=p[9]|0,lt=rt&8191,gt=rt>>>13,Dt=m[0]|0,ut=Dt&8191,Y=Dt>>>13,tt=m[1]|0,dt=tt&8191,mt=tt>>>13,xt=m[2]|0,bt=xt&8191,_t=xt>>>13,Ht=m[3]|0,St=Ht&8191,Mt=Ht>>>13,jt=m[4]|0,Lt=jt&8191,Ft=jt>>>13,te=m[5]|0,Bt=te&8191,Ot=te>>>13,ie=m[6]|0,kt=ie&8191,qt=ie>>>13,ae=m[7]|0,Rt=ae&8191,zt=ae>>>13,he=m[8]|0,Vt=he&8191,Qt=he>>>13,ge=m[9]|0,Gt=ge&8191,$t=ge>>>13;d.negative=s.negative^l.negative,d.length=19,b=Math.imul(z,ut),f=Math.imul(z,Y),f=f+Math.imul(W,ut)|0,C=Math.imul(W,Y);var pe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(pe>>>26)|0,pe&=67108863,b=Math.imul(I,ut),f=Math.imul(I,Y),f=f+Math.imul(K,ut)|0,C=Math.imul(K,Y),b=b+Math.imul(z,dt)|0,f=f+Math.imul(z,mt)|0,f=f+Math.imul(W,dt)|0,C=C+Math.imul(W,mt)|0;var de=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(de>>>26)|0,de&=67108863,b=Math.imul(X,ut),f=Math.imul(X,Y),f=f+Math.imul(Q,ut)|0,C=Math.imul(Q,Y),b=b+Math.imul(I,dt)|0,f=f+Math.imul(I,mt)|0,f=f+Math.imul(K,dt)|0,C=C+Math.imul(K,mt)|0,b=b+Math.imul(z,bt)|0,f=f+Math.imul(z,_t)|0,f=f+Math.imul(W,bt)|0,C=C+Math.imul(W,_t)|0;var Ee=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,b=Math.imul(V,ut),f=Math.imul(V,Y),f=f+Math.imul(Z,ut)|0,C=Math.imul(Z,Y),b=b+Math.imul(X,dt)|0,f=f+Math.imul(X,mt)|0,f=f+Math.imul(Q,dt)|0,C=C+Math.imul(Q,mt)|0,b=b+Math.imul(I,bt)|0,f=f+Math.imul(I,_t)|0,f=f+Math.imul(K,bt)|0,C=C+Math.imul(K,_t)|0,b=b+Math.imul(z,St)|0,f=f+Math.imul(z,Mt)|0,f=f+Math.imul(W,St)|0,C=C+Math.imul(W,Mt)|0;var xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(xe>>>26)|0,xe&=67108863,b=Math.imul(j,ut),f=Math.imul(j,Y),f=f+Math.imul(et,ut)|0,C=Math.imul(et,Y),b=b+Math.imul(V,dt)|0,f=f+Math.imul(V,mt)|0,f=f+Math.imul(Z,dt)|0,C=C+Math.imul(Z,mt)|0,b=b+Math.imul(X,bt)|0,f=f+Math.imul(X,_t)|0,f=f+Math.imul(Q,bt)|0,C=C+Math.imul(Q,_t)|0,b=b+Math.imul(I,St)|0,f=f+Math.imul(I,Mt)|0,f=f+Math.imul(K,St)|0,C=C+Math.imul(K,Mt)|0,b=b+Math.imul(z,Lt)|0,f=f+Math.imul(z,Ft)|0,f=f+Math.imul(W,Lt)|0,C=C+Math.imul(W,Ft)|0;var Se=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Se>>>26)|0,Se&=67108863,b=Math.imul(st,ut),f=Math.imul(st,Y),f=f+Math.imul(ft,ut)|0,C=Math.imul(ft,Y),b=b+Math.imul(j,dt)|0,f=f+Math.imul(j,mt)|0,f=f+Math.imul(et,dt)|0,C=C+Math.imul(et,mt)|0,b=b+Math.imul(V,bt)|0,f=f+Math.imul(V,_t)|0,f=f+Math.imul(Z,bt)|0,C=C+Math.imul(Z,_t)|0,b=b+Math.imul(X,St)|0,f=f+Math.imul(X,Mt)|0,f=f+Math.imul(Q,St)|0,C=C+Math.imul(Q,Mt)|0,b=b+Math.imul(I,Lt)|0,f=f+Math.imul(I,Ft)|0,f=f+Math.imul(K,Lt)|0,C=C+Math.imul(K,Ft)|0,b=b+Math.imul(z,Bt)|0,f=f+Math.imul(z,Ot)|0,f=f+Math.imul(W,Bt)|0,C=C+Math.imul(W,Ot)|0;var Be=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Be>>>26)|0,Be&=67108863,b=Math.imul(ot,ut),f=Math.imul(ot,Y),f=f+Math.imul(pt,ut)|0,C=Math.imul(pt,Y),b=b+Math.imul(st,dt)|0,f=f+Math.imul(st,mt)|0,f=f+Math.imul(ft,dt)|0,C=C+Math.imul(ft,mt)|0,b=b+Math.imul(j,bt)|0,f=f+Math.imul(j,_t)|0,f=f+Math.imul(et,bt)|0,C=C+Math.imul(et,_t)|0,b=b+Math.imul(V,St)|0,f=f+Math.imul(V,Mt)|0,f=f+Math.imul(Z,St)|0,C=C+Math.imul(Z,Mt)|0,b=b+Math.imul(X,Lt)|0,f=f+Math.imul(X,Ft)|0,f=f+Math.imul(Q,Lt)|0,C=C+Math.imul(Q,Ft)|0,b=b+Math.imul(I,Bt)|0,f=f+Math.imul(I,Ot)|0,f=f+Math.imul(K,Bt)|0,C=C+Math.imul(K,Ot)|0,b=b+Math.imul(z,kt)|0,f=f+Math.imul(z,qt)|0,f=f+Math.imul(W,kt)|0,C=C+Math.imul(W,qt)|0;var Ne=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,b=Math.imul(At,ut),f=Math.imul(At,Y),f=f+Math.imul(It,ut)|0,C=Math.imul(It,Y),b=b+Math.imul(ot,dt)|0,f=f+Math.imul(ot,mt)|0,f=f+Math.imul(pt,dt)|0,C=C+Math.imul(pt,mt)|0,b=b+Math.imul(st,bt)|0,f=f+Math.imul(st,_t)|0,f=f+Math.imul(ft,bt)|0,C=C+Math.imul(ft,_t)|0,b=b+Math.imul(j,St)|0,f=f+Math.imul(j,Mt)|0,f=f+Math.imul(et,St)|0,C=C+Math.imul(et,Mt)|0,b=b+Math.imul(V,Lt)|0,f=f+Math.imul(V,Ft)|0,f=f+Math.imul(Z,Lt)|0,C=C+Math.imul(Z,Ft)|0,b=b+Math.imul(X,Bt)|0,f=f+Math.imul(X,Ot)|0,f=f+Math.imul(Q,Bt)|0,C=C+Math.imul(Q,Ot)|0,b=b+Math.imul(I,kt)|0,f=f+Math.imul(I,qt)|0,f=f+Math.imul(K,kt)|0,C=C+Math.imul(K,qt)|0,b=b+Math.imul(z,Rt)|0,f=f+Math.imul(z,zt)|0,f=f+Math.imul(W,Rt)|0,C=C+Math.imul(W,zt)|0;var qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(qe>>>26)|0,qe&=67108863,b=Math.imul(at,ut),f=Math.imul(at,Y),f=f+Math.imul(J,ut)|0,C=Math.imul(J,Y),b=b+Math.imul(At,dt)|0,f=f+Math.imul(At,mt)|0,f=f+Math.imul(It,dt)|0,C=C+Math.imul(It,mt)|0,b=b+Math.imul(ot,bt)|0,f=f+Math.imul(ot,_t)|0,f=f+Math.imul(pt,bt)|0,C=C+Math.imul(pt,_t)|0,b=b+Math.imul(st,St)|0,f=f+Math.imul(st,Mt)|0,f=f+Math.imul(ft,St)|0,C=C+Math.imul(ft,Mt)|0,b=b+Math.imul(j,Lt)|0,f=f+Math.imul(j,Ft)|0,f=f+Math.imul(et,Lt)|0,C=C+Math.imul(et,Ft)|0,b=b+Math.imul(V,Bt)|0,f=f+Math.imul(V,Ot)|0,f=f+Math.imul(Z,Bt)|0,C=C+Math.imul(Z,Ot)|0,b=b+Math.imul(X,kt)|0,f=f+Math.imul(X,qt)|0,f=f+Math.imul(Q,kt)|0,C=C+Math.imul(Q,qt)|0,b=b+Math.imul(I,Rt)|0,f=f+Math.imul(I,zt)|0,f=f+Math.imul(K,Rt)|0,C=C+Math.imul(K,zt)|0,b=b+Math.imul(z,Vt)|0,f=f+Math.imul(z,Qt)|0,f=f+Math.imul(W,Vt)|0,C=C+Math.imul(W,Qt)|0;var Xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,b=Math.imul(lt,ut),f=Math.imul(lt,Y),f=f+Math.imul(gt,ut)|0,C=Math.imul(gt,Y),b=b+Math.imul(at,dt)|0,f=f+Math.imul(at,mt)|0,f=f+Math.imul(J,dt)|0,C=C+Math.imul(J,mt)|0,b=b+Math.imul(At,bt)|0,f=f+Math.imul(At,_t)|0,f=f+Math.imul(It,bt)|0,C=C+Math.imul(It,_t)|0,b=b+Math.imul(ot,St)|0,f=f+Math.imul(ot,Mt)|0,f=f+Math.imul(pt,St)|0,C=C+Math.imul(pt,Mt)|0,b=b+Math.imul(st,Lt)|0,f=f+Math.imul(st,Ft)|0,f=f+Math.imul(ft,Lt)|0,C=C+Math.imul(ft,Ft)|0,b=b+Math.imul(j,Bt)|0,f=f+Math.imul(j,Ot)|0,f=f+Math.imul(et,Bt)|0,C=C+Math.imul(et,Ot)|0,b=b+Math.imul(V,kt)|0,f=f+Math.imul(V,qt)|0,f=f+Math.imul(Z,kt)|0,C=C+Math.imul(Z,qt)|0,b=b+Math.imul(X,Rt)|0,f=f+Math.imul(X,zt)|0,f=f+Math.imul(Q,Rt)|0,C=C+Math.imul(Q,zt)|0,b=b+Math.imul(I,Vt)|0,f=f+Math.imul(I,Qt)|0,f=f+Math.imul(K,Vt)|0,C=C+Math.imul(K,Qt)|0,b=b+Math.imul(z,Gt)|0,f=f+Math.imul(z,$t)|0,f=f+Math.imul(W,Gt)|0,C=C+Math.imul(W,$t)|0;var Ge=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,b=Math.imul(lt,dt),f=Math.imul(lt,mt),f=f+Math.imul(gt,dt)|0,C=Math.imul(gt,mt),b=b+Math.imul(at,bt)|0,f=f+Math.imul(at,_t)|0,f=f+Math.imul(J,bt)|0,C=C+Math.imul(J,_t)|0,b=b+Math.imul(At,St)|0,f=f+Math.imul(At,Mt)|0,f=f+Math.imul(It,St)|0,C=C+Math.imul(It,Mt)|0,b=b+Math.imul(ot,Lt)|0,f=f+Math.imul(ot,Ft)|0,f=f+Math.imul(pt,Lt)|0,C=C+Math.imul(pt,Ft)|0,b=b+Math.imul(st,Bt)|0,f=f+Math.imul(st,Ot)|0,f=f+Math.imul(ft,Bt)|0,C=C+Math.imul(ft,Ot)|0,b=b+Math.imul(j,kt)|0,f=f+Math.imul(j,qt)|0,f=f+Math.imul(et,kt)|0,C=C+Math.imul(et,qt)|0,b=b+Math.imul(V,Rt)|0,f=f+Math.imul(V,zt)|0,f=f+Math.imul(Z,Rt)|0,C=C+Math.imul(Z,zt)|0,b=b+Math.imul(X,Vt)|0,f=f+Math.imul(X,Qt)|0,f=f+Math.imul(Q,Vt)|0,C=C+Math.imul(Q,Qt)|0,b=b+Math.imul(I,Gt)|0,f=f+Math.imul(I,$t)|0,f=f+Math.imul(K,Gt)|0,C=C+Math.imul(K,$t)|0;var Je=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Je>>>26)|0,Je&=67108863,b=Math.imul(lt,bt),f=Math.imul(lt,_t),f=f+Math.imul(gt,bt)|0,C=Math.imul(gt,_t),b=b+Math.imul(at,St)|0,f=f+Math.imul(at,Mt)|0,f=f+Math.imul(J,St)|0,C=C+Math.imul(J,Mt)|0,b=b+Math.imul(At,Lt)|0,f=f+Math.imul(At,Ft)|0,f=f+Math.imul(It,Lt)|0,C=C+Math.imul(It,Ft)|0,b=b+Math.imul(ot,Bt)|0,f=f+Math.imul(ot,Ot)|0,f=f+Math.imul(pt,Bt)|0,C=C+Math.imul(pt,Ot)|0,b=b+Math.imul(st,kt)|0,f=f+Math.imul(st,qt)|0,f=f+Math.imul(ft,kt)|0,C=C+Math.imul(ft,qt)|0,b=b+Math.imul(j,Rt)|0,f=f+Math.imul(j,zt)|0,f=f+Math.imul(et,Rt)|0,C=C+Math.imul(et,zt)|0,b=b+Math.imul(V,Vt)|0,f=f+Math.imul(V,Qt)|0,f=f+Math.imul(Z,Vt)|0,C=C+Math.imul(Z,Qt)|0,b=b+Math.imul(X,Gt)|0,f=f+Math.imul(X,$t)|0,f=f+Math.imul(Q,Gt)|0,C=C+Math.imul(Q,$t)|0;var ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ze>>>26)|0,ze&=67108863,b=Math.imul(lt,St),f=Math.imul(lt,Mt),f=f+Math.imul(gt,St)|0,C=Math.imul(gt,Mt),b=b+Math.imul(at,Lt)|0,f=f+Math.imul(at,Ft)|0,f=f+Math.imul(J,Lt)|0,C=C+Math.imul(J,Ft)|0,b=b+Math.imul(At,Bt)|0,f=f+Math.imul(At,Ot)|0,f=f+Math.imul(It,Bt)|0,C=C+Math.imul(It,Ot)|0,b=b+Math.imul(ot,kt)|0,f=f+Math.imul(ot,qt)|0,f=f+Math.imul(pt,kt)|0,C=C+Math.imul(pt,qt)|0,b=b+Math.imul(st,Rt)|0,f=f+Math.imul(st,zt)|0,f=f+Math.imul(ft,Rt)|0,C=C+Math.imul(ft,zt)|0,b=b+Math.imul(j,Vt)|0,f=f+Math.imul(j,Qt)|0,f=f+Math.imul(et,Vt)|0,C=C+Math.imul(et,Qt)|0,b=b+Math.imul(V,Gt)|0,f=f+Math.imul(V,$t)|0,f=f+Math.imul(Z,Gt)|0,C=C+Math.imul(Z,$t)|0;var rr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(rr>>>26)|0,rr&=67108863,b=Math.imul(lt,Lt),f=Math.imul(lt,Ft),f=f+Math.imul(gt,Lt)|0,C=Math.imul(gt,Ft),b=b+Math.imul(at,Bt)|0,f=f+Math.imul(at,Ot)|0,f=f+Math.imul(J,Bt)|0,C=C+Math.imul(J,Ot)|0,b=b+Math.imul(At,kt)|0,f=f+Math.imul(At,qt)|0,f=f+Math.imul(It,kt)|0,C=C+Math.imul(It,qt)|0,b=b+Math.imul(ot,Rt)|0,f=f+Math.imul(ot,zt)|0,f=f+Math.imul(pt,Rt)|0,C=C+Math.imul(pt,zt)|0,b=b+Math.imul(st,Vt)|0,f=f+Math.imul(st,Qt)|0,f=f+Math.imul(ft,Vt)|0,C=C+Math.imul(ft,Qt)|0,b=b+Math.imul(j,Gt)|0,f=f+Math.imul(j,$t)|0,f=f+Math.imul(et,Gt)|0,C=C+Math.imul(et,$t)|0;var Qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,b=Math.imul(lt,Bt),f=Math.imul(lt,Ot),f=f+Math.imul(gt,Bt)|0,C=Math.imul(gt,Ot),b=b+Math.imul(at,kt)|0,f=f+Math.imul(at,qt)|0,f=f+Math.imul(J,kt)|0,C=C+Math.imul(J,qt)|0,b=b+Math.imul(At,Rt)|0,f=f+Math.imul(At,zt)|0,f=f+Math.imul(It,Rt)|0,C=C+Math.imul(It,zt)|0,b=b+Math.imul(ot,Vt)|0,f=f+Math.imul(ot,Qt)|0,f=f+Math.imul(pt,Vt)|0,C=C+Math.imul(pt,Qt)|0,b=b+Math.imul(st,Gt)|0,f=f+Math.imul(st,$t)|0,f=f+Math.imul(ft,Gt)|0,C=C+Math.imul(ft,$t)|0;var Le=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Le>>>26)|0,Le&=67108863,b=Math.imul(lt,kt),f=Math.imul(lt,qt),f=f+Math.imul(gt,kt)|0,C=Math.imul(gt,qt),b=b+Math.imul(at,Rt)|0,f=f+Math.imul(at,zt)|0,f=f+Math.imul(J,Rt)|0,C=C+Math.imul(J,zt)|0,b=b+Math.imul(At,Vt)|0,f=f+Math.imul(At,Qt)|0,f=f+Math.imul(It,Vt)|0,C=C+Math.imul(It,Qt)|0,b=b+Math.imul(ot,Gt)|0,f=f+Math.imul(ot,$t)|0,f=f+Math.imul(pt,Gt)|0,C=C+Math.imul(pt,$t)|0;var ir=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ir>>>26)|0,ir&=67108863,b=Math.imul(lt,Rt),f=Math.imul(lt,zt),f=f+Math.imul(gt,Rt)|0,C=Math.imul(gt,zt),b=b+Math.imul(at,Vt)|0,f=f+Math.imul(at,Qt)|0,f=f+Math.imul(J,Vt)|0,C=C+Math.imul(J,Qt)|0,b=b+Math.imul(At,Gt)|0,f=f+Math.imul(At,$t)|0,f=f+Math.imul(It,Gt)|0,C=C+Math.imul(It,$t)|0;var nr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(nr>>>26)|0,nr&=67108863,b=Math.imul(lt,Vt),f=Math.imul(lt,Qt),f=f+Math.imul(gt,Vt)|0,C=Math.imul(gt,Qt),b=b+Math.imul(at,Gt)|0,f=f+Math.imul(at,$t)|0,f=f+Math.imul(J,Gt)|0,C=C+Math.imul(J,$t)|0;var Ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,b=Math.imul(lt,Gt),f=Math.imul(lt,$t),f=f+Math.imul(gt,Gt)|0,C=Math.imul(gt,$t);var ar=(x+b|0)+((f&8191)<<13)|0;return x=(C+(f>>>13)|0)+(ar>>>26)|0,ar&=67108863,w[0]=pe,w[1]=de,w[2]=Ee,w[3]=xe,w[4]=Se,w[5]=Be,w[6]=Ne,w[7]=qe,w[8]=Xe,w[9]=Ge,w[10]=Je,w[11]=ze,w[12]=rr,w[13]=Qe,w[14]=Le,w[15]=ir,w[16]=nr,w[17]=Ze,w[18]=ar,x!==0&&(w[19]=x,d.length++),d};Math.imul||(S=A);function T(E,s,l){l.negative=s.negative^E.negative,l.length=E.length+s.length;for(var d=0,p=0,m=0;m<l.length-1;m++){var w=p;p=0;for(var x=d&67108863,b=Math.min(m,s.length-1),f=Math.max(0,m-E.length+1);f<=b;f++){var C=m-f,F=E.words[C]|0,z=s.words[f]|0,W=F*z,$=W&67108863;w=w+(W/67108864|0)|0,$=$+x|0,x=$&67108863,w=w+($>>>26)|0,p+=w>>>26,w&=67108863}l.words[m]=x,d=w,w=p}return d!==0?l.words[m]=d:l.length--,l.strip()}function B(E,s,l){var d=new M;return d.mulp(E,s,l)}n.prototype.mulTo=function(s,l){var d,p=this.length+s.length;return this.length===10&&s.length===10?d=S(this,s,l):p<63?d=A(this,s,l):p<1024?d=T(this,s,l):d=B(this,s,l),d};function M(E,s){this.x=E,this.y=s}M.prototype.makeRBT=function(s){for(var l=new Array(s),d=n.prototype._countBits(s)-1,p=0;p<s;p++)l[p]=this.revBin(p,d,s);return l},M.prototype.revBin=function(s,l,d){if(s===0||s===d-1)return s;for(var p=0,m=0;m<l;m++)p|=(s&1)<<l-m-1,s>>=1;return p},M.prototype.permute=function(s,l,d,p,m,w){for(var x=0;x<w;x++)p[x]=l[s[x]],m[x]=d[s[x]]},M.prototype.transform=function(s,l,d,p,m,w){this.permute(w,s,l,d,p,m);for(var x=1;x<m;x<<=1)for(var b=x<<1,f=Math.cos(2*Math.PI/b),C=Math.sin(2*Math.PI/b),F=0;F<m;F+=b)for(var z=f,W=C,$=0;$<x;$++){var I=d[F+$],K=p[F+$],N=d[F+$+x],X=p[F+$+x],Q=z*N-W*X;X=z*X+W*N,N=Q,d[F+$]=I+N,p[F+$]=K+X,d[F+$+x]=I-N,p[F+$+x]=K-X,$!==b&&(Q=f*z-C*W,W=f*W+C*z,z=Q)}},M.prototype.guessLen13b=function(s,l){var d=Math.max(l,s)|1,p=d&1,m=0;for(d=d/2|0;d;d=d>>>1)m++;return 1<<m+1+p},M.prototype.conjugate=function(s,l,d){if(!(d<=1))for(var p=0;p<d/2;p++){var m=s[p];s[p]=s[d-p-1],s[d-p-1]=m,m=l[p],l[p]=-l[d-p-1],l[d-p-1]=-m}},M.prototype.normalize13b=function(s,l){for(var d=0,p=0;p<l/2;p++){var m=Math.round(s[2*p+1]/l)*8192+Math.round(s[2*p]/l)+d;s[p]=m&67108863,m<67108864?d=0:d=m/67108864|0}return s},M.prototype.convert13b=function(s,l,d,p){for(var m=0,w=0;w<l;w++)m=m+(s[w]|0),d[2*w]=m&8191,m=m>>>13,d[2*w+1]=m&8191,m=m>>>13;for(w=2*l;w<p;++w)d[w]=0;t(m===0),t((m&-8192)===0)},M.prototype.stub=function(s){for(var l=new Array(s),d=0;d<s;d++)l[d]=0;return l},M.prototype.mulp=function(s,l,d){var p=2*this.guessLen13b(s.length,l.length),m=this.makeRBT(p),w=this.stub(p),x=new Array(p),b=new Array(p),f=new Array(p),C=new Array(p),F=new Array(p),z=new Array(p),W=d.words;W.length=p,this.convert13b(s.words,s.length,x,p),this.convert13b(l.words,l.length,C,p),this.transform(x,w,b,f,p,m),this.transform(C,w,F,z,p,m);for(var $=0;$<p;$++){var I=b[$]*F[$]-f[$]*z[$];f[$]=b[$]*z[$]+f[$]*F[$],b[$]=I}return this.conjugate(b,f,p),this.transform(b,f,W,w,p,m),this.conjugate(W,w,p),this.normalize13b(W,p),d.negative=s.negative^l.negative,d.length=s.length+l.length,d.strip()},n.prototype.mul=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),this.mulTo(s,l)},n.prototype.mulf=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),B(this,s,l)},n.prototype.imul=function(s){return this.clone().mulTo(s,this)},n.prototype.imuln=function(s){t(typeof s=="number"),t(s<67108864);for(var l=0,d=0;d<this.length;d++){var p=(this.words[d]|0)*s,m=(p&67108863)+(l&67108863);l>>=26,l+=p/67108864|0,l+=m>>>26,this.words[d]=m&67108863}return l!==0&&(this.words[d]=l,this.length++),this},n.prototype.muln=function(s){return this.clone().imuln(s)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(s){var l=_(s);if(l.length===0)return new n(1);for(var d=this,p=0;p<l.length&&l[p]===0;p++,d=d.sqr());if(++p<l.length)for(var m=d.sqr();p<l.length;p++,m=m.sqr())l[p]!==0&&(d=d.mul(m));return d},n.prototype.iushln=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=67108863>>>26-l<<26-l,m;if(l!==0){var w=0;for(m=0;m<this.length;m++){var x=this.words[m]&p,b=(this.words[m]|0)-x<<l;this.words[m]=b|w,w=x>>>26-l}w&&(this.words[m]=w,this.length++)}if(d!==0){for(m=this.length-1;m>=0;m--)this.words[m+d]=this.words[m];for(m=0;m<d;m++)this.words[m]=0;this.length+=d}return this.strip()},n.prototype.ishln=function(s){return t(this.negative===0),this.iushln(s)},n.prototype.iushrn=function(s,l,d){t(typeof s=="number"&&s>=0);var p;l?p=(l-l%26)/26:p=0;var m=s%26,w=Math.min((s-m)/26,this.length),x=67108863^67108863>>>m<<m,b=d;if(p-=w,p=Math.max(0,p),b){for(var f=0;f<w;f++)b.words[f]=this.words[f];b.length=w}if(w!==0)if(this.length>w)for(this.length-=w,f=0;f<this.length;f++)this.words[f]=this.words[f+w];else this.words[0]=0,this.length=1;var C=0;for(f=this.length-1;f>=0&&(C!==0||f>=p);f--){var F=this.words[f]|0;this.words[f]=C<<26-m|F>>>m,C=F&x}return b&&C!==0&&(b.words[b.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(s,l,d){return t(this.negative===0),this.iushrn(s,l,d)},n.prototype.shln=function(s){return this.clone().ishln(s)},n.prototype.ushln=function(s){return this.clone().iushln(s)},n.prototype.shrn=function(s){return this.clone().ishrn(s)},n.prototype.ushrn=function(s){return this.clone().iushrn(s)},n.prototype.testn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return!1;var m=this.words[d];return!!(m&p)},n.prototype.imaskn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=d)return this;if(l!==0&&d++,this.length=Math.min(d,this.length),l!==0){var p=67108863^67108863>>>l<<l;this.words[this.length-1]&=p}return this.strip()},n.prototype.maskn=function(s){return this.clone().imaskn(s)},n.prototype.iaddn=function(s){return t(typeof s=="number"),t(s<67108864),s<0?this.isubn(-s):this.negative!==0?this.length===1&&(this.words[0]|0)<s?(this.words[0]=s-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(s),this.negative=1,this):this._iaddn(s)},n.prototype._iaddn=function(s){this.words[0]+=s;for(var l=0;l<this.length&&this.words[l]>=67108864;l++)this.words[l]-=67108864,l===this.length-1?this.words[l+1]=1:this.words[l+1]++;return this.length=Math.max(this.length,l+1),this},n.prototype.isubn=function(s){if(t(typeof s=="number"),t(s<67108864),s<0)return this.iaddn(-s);if(this.negative!==0)return this.negative=0,this.iaddn(s),this.negative=1,this;if(this.words[0]-=s,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var l=0;l<this.length&&this.words[l]<0;l++)this.words[l]+=67108864,this.words[l+1]-=1;return this.strip()},n.prototype.addn=function(s){return this.clone().iaddn(s)},n.prototype.subn=function(s){return this.clone().isubn(s)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(s,l,d){var p=s.length+d,m;this._expand(p);var w,x=0;for(m=0;m<s.length;m++){w=(this.words[m+d]|0)+x;var b=(s.words[m]|0)*l;w-=b&67108863,x=(w>>26)-(b/67108864|0),this.words[m+d]=w&67108863}for(;m<this.length-d;m++)w=(this.words[m+d]|0)+x,x=w>>26,this.words[m+d]=w&67108863;if(x===0)return this.strip();for(t(x===-1),x=0,m=0;m<this.length;m++)w=-(this.words[m]|0)+x,x=w>>26,this.words[m]=w&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(s,l){var d=this.length-s.length,p=this.clone(),m=s,w=m.words[m.length-1]|0,x=this._countBits(w);d=26-x,d!==0&&(m=m.ushln(d),p.iushln(d),w=m.words[m.length-1]|0);var b=p.length-m.length,f;if(l!=="mod"){f=new n(null),f.length=b+1,f.words=new Array(f.length);for(var C=0;C<f.length;C++)f.words[C]=0}var F=p.clone()._ishlnsubmul(m,1,b);F.negative===0&&(p=F,f&&(f.words[b]=1));for(var z=b-1;z>=0;z--){var W=(p.words[m.length+z]|0)*67108864+(p.words[m.length+z-1]|0);for(W=Math.min(W/w|0,67108863),p._ishlnsubmul(m,W,z);p.negative!==0;)W--,p.negative=0,p._ishlnsubmul(m,1,z),p.isZero()||(p.negative^=1);f&&(f.words[z]=W)}return f&&f.strip(),p.strip(),l!=="div"&&d!==0&&p.iushrn(d),{div:f||null,mod:p}},n.prototype.divmod=function(s,l,d){if(t(!s.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var p,m,w;return this.negative!==0&&s.negative===0?(w=this.neg().divmod(s,l),l!=="mod"&&(p=w.div.neg()),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.iadd(s)),{div:p,mod:m}):this.negative===0&&s.negative!==0?(w=this.divmod(s.neg(),l),l!=="mod"&&(p=w.div.neg()),{div:p,mod:w.mod}):this.negative&s.negative?(w=this.neg().divmod(s.neg(),l),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.isub(s)),{div:w.div,mod:m}):s.length>this.length||this.cmp(s)<0?{div:new n(0),mod:this}:s.length===1?l==="div"?{div:this.divn(s.words[0]),mod:null}:l==="mod"?{div:null,mod:new n(this.modn(s.words[0]))}:{div:this.divn(s.words[0]),mod:new n(this.modn(s.words[0]))}:this._wordDiv(s,l)},n.prototype.div=function(s){return this.divmod(s,"div",!1).div},n.prototype.mod=function(s){return this.divmod(s,"mod",!1).mod},n.prototype.umod=function(s){return this.divmod(s,"mod",!0).mod},n.prototype.divRound=function(s){var l=this.divmod(s);if(l.mod.isZero())return l.div;var d=l.div.negative!==0?l.mod.isub(s):l.mod,p=s.ushrn(1),m=s.andln(1),w=d.cmp(p);return w<0||m===1&&w===0?l.div:l.div.negative!==0?l.div.isubn(1):l.div.iaddn(1)},n.prototype.modn=function(s){t(s<=67108863);for(var l=(1<<26)%s,d=0,p=this.length-1;p>=0;p--)d=(l*d+(this.words[p]|0))%s;return d},n.prototype.idivn=function(s){t(s<=67108863);for(var l=0,d=this.length-1;d>=0;d--){var p=(this.words[d]|0)+l*67108864;this.words[d]=p/s|0,l=p%s}return this.strip()},n.prototype.divn=function(s){return this.clone().idivn(s)},n.prototype.egcd=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=new n(0),x=new n(1),b=0;l.isEven()&&d.isEven();)l.iushrn(1),d.iushrn(1),++b;for(var f=d.clone(),C=l.clone();!l.isZero();){for(var F=0,z=1;!(l.words[0]&z)&&F<26;++F,z<<=1);if(F>0)for(l.iushrn(F);F-- >0;)(p.isOdd()||m.isOdd())&&(p.iadd(f),m.isub(C)),p.iushrn(1),m.iushrn(1);for(var W=0,$=1;!(d.words[0]&$)&&W<26;++W,$<<=1);if(W>0)for(d.iushrn(W);W-- >0;)(w.isOdd()||x.isOdd())&&(w.iadd(f),x.isub(C)),w.iushrn(1),x.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(w),m.isub(x)):(d.isub(l),w.isub(p),x.isub(m))}return{a:w,b:x,gcd:d.iushln(b)}},n.prototype._invmp=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=d.clone();l.cmpn(1)>0&&d.cmpn(1)>0;){for(var x=0,b=1;!(l.words[0]&b)&&x<26;++x,b<<=1);if(x>0)for(l.iushrn(x);x-- >0;)p.isOdd()&&p.iadd(w),p.iushrn(1);for(var f=0,C=1;!(d.words[0]&C)&&f<26;++f,C<<=1);if(f>0)for(d.iushrn(f);f-- >0;)m.isOdd()&&m.iadd(w),m.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(m)):(d.isub(l),m.isub(p))}var F;return l.cmpn(1)===0?F=p:F=m,F.cmpn(0)<0&&F.iadd(s),F},n.prototype.gcd=function(s){if(this.isZero())return s.abs();if(s.isZero())return this.abs();var l=this.clone(),d=s.clone();l.negative=0,d.negative=0;for(var p=0;l.isEven()&&d.isEven();p++)l.iushrn(1),d.iushrn(1);do{for(;l.isEven();)l.iushrn(1);for(;d.isEven();)d.iushrn(1);var m=l.cmp(d);if(m<0){var w=l;l=d,d=w}else if(m===0||d.cmpn(1)===0)break;l.isub(d)}while(!0);return d.iushln(p)},n.prototype.invm=function(s){return this.egcd(s).a.umod(s)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(s){return this.words[0]&s},n.prototype.bincn=function(s){t(typeof s=="number");var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return this._expand(d+1),this.words[d]|=p,this;for(var m=p,w=d;m!==0&&w<this.length;w++){var x=this.words[w]|0;x+=m,m=x>>>26,x&=67108863,this.words[w]=x}return m!==0&&(this.words[w]=m,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(s){var l=s<0;if(this.negative!==0&&!l)return-1;if(this.negative===0&&l)return 1;this.strip();var d;if(this.length>1)d=1;else{l&&(s=-s),t(s<=67108863,"Number is too big");var p=this.words[0]|0;d=p===s?0:p<s?-1:1}return this.negative!==0?-d|0:d},n.prototype.cmp=function(s){if(this.negative!==0&&s.negative===0)return-1;if(this.negative===0&&s.negative!==0)return 1;var l=this.ucmp(s);return this.negative!==0?-l|0:l},n.prototype.ucmp=function(s){if(this.length>s.length)return 1;if(this.length<s.length)return-1;for(var l=0,d=this.length-1;d>=0;d--){var p=this.words[d]|0,m=s.words[d]|0;if(p!==m){p<m?l=-1:p>m&&(l=1);break}}return l},n.prototype.gtn=function(s){return this.cmpn(s)===1},n.prototype.gt=function(s){return this.cmp(s)===1},n.prototype.gten=function(s){return this.cmpn(s)>=0},n.prototype.gte=function(s){return this.cmp(s)>=0},n.prototype.ltn=function(s){return this.cmpn(s)===-1},n.prototype.lt=function(s){return this.cmp(s)===-1},n.prototype.lten=function(s){return this.cmpn(s)<=0},n.prototype.lte=function(s){return this.cmp(s)<=0},n.prototype.eqn=function(s){return this.cmpn(s)===0},n.prototype.eq=function(s){return this.cmp(s)===0},n.red=function(s){return new O(s)},n.prototype.toRed=function(s){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),s.convertTo(this)._forceRed(s)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(s){return this.red=s,this},n.prototype.forceRed=function(s){return t(!this.red,"Already a number in reduction context"),this._forceRed(s)},n.prototype.redAdd=function(s){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,s)},n.prototype.redIAdd=function(s){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,s)},n.prototype.redSub=function(s){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,s)},n.prototype.redISub=function(s){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,s)},n.prototype.redShl=function(s){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,s)},n.prototype.redMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.mul(this,s)},n.prototype.redIMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.imul(this,s)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(s){return t(this.red&&!s.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,s)};var R={k256:null,p224:null,p192:null,p25519:null};function P(E,s){this.name=E,this.p=new n(s,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}P.prototype._tmp=function(){var s=new n(null);return s.words=new Array(Math.ceil(this.n/13)),s},P.prototype.ireduce=function(s){var l=s,d;do this.split(l,this.tmp),l=this.imulK(l),l=l.iadd(this.tmp),d=l.bitLength();while(d>this.n);var p=d<this.n?-1:l.ucmp(this.p);return p===0?(l.words[0]=0,l.length=1):p>0?l.isub(this.p):l.strip!==void 0?l.strip():l._strip(),l},P.prototype.split=function(s,l){s.iushrn(this.n,0,l)},P.prototype.imulK=function(s){return s.imul(this.k)};function D(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(D,P),D.prototype.split=function(s,l){for(var d=4194303,p=Math.min(s.length,9),m=0;m<p;m++)l.words[m]=s.words[m];if(l.length=p,s.length<=9){s.words[0]=0,s.length=1;return}var w=s.words[9];for(l.words[l.length++]=w&d,m=10;m<s.length;m++){var x=s.words[m]|0;s.words[m-10]=(x&d)<<4|w>>>22,w=x}w>>>=22,s.words[m-10]=w,w===0&&s.length>10?s.length-=10:s.length-=9},D.prototype.imulK=function(s){s.words[s.length]=0,s.words[s.length+1]=0,s.length+=2;for(var l=0,d=0;d<s.length;d++){var p=s.words[d]|0;l+=p*977,s.words[d]=l&67108863,l=p*64+(l/67108864|0)}return s.words[s.length-1]===0&&(s.length--,s.words[s.length-1]===0&&s.length--),s};function q(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(q,P);function k(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(k,P);function U(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(U,P),U.prototype.imulK=function(s){for(var l=0,d=0;d<s.length;d++){var p=(s.words[d]|0)*19+l,m=p&67108863;p>>>=26,s.words[d]=m,l=p}return l!==0&&(s.words[s.length++]=l),s},n._prime=function(s){if(R[s])return R[s];var l;if(s==="k256")l=new D;else if(s==="p224")l=new q;else if(s==="p192")l=new k;else if(s==="p25519")l=new U;else throw new Error("Unknown prime "+s);return R[s]=l,l};function O(E){if(typeof E=="string"){var s=n._prime(E);this.m=s.p,this.prime=s}else t(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}O.prototype._verify1=function(s){t(s.negative===0,"red works only with positives"),t(s.red,"red works only with red numbers")},O.prototype._verify2=function(s,l){t((s.negative|l.negative)===0,"red works only with positives"),t(s.red&&s.red===l.red,"red works only with red numbers")},O.prototype.imod=function(s){return this.prime?this.prime.ireduce(s)._forceRed(this):s.umod(this.m)._forceRed(this)},O.prototype.neg=function(s){return s.isZero()?s.clone():this.m.sub(s)._forceRed(this)},O.prototype.add=function(s,l){this._verify2(s,l);var d=s.add(l);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},O.prototype.iadd=function(s,l){this._verify2(s,l);var d=s.iadd(l);return d.cmp(this.m)>=0&&d.isub(this.m),d},O.prototype.sub=function(s,l){this._verify2(s,l);var d=s.sub(l);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},O.prototype.isub=function(s,l){this._verify2(s,l);var d=s.isub(l);return d.cmpn(0)<0&&d.iadd(this.m),d},O.prototype.shl=function(s,l){return this._verify1(s),this.imod(s.ushln(l))},O.prototype.imul=function(s,l){return this._verify2(s,l),this.imod(s.imul(l))},O.prototype.mul=function(s,l){return this._verify2(s,l),this.imod(s.mul(l))},O.prototype.isqr=function(s){return this.imul(s,s.clone())},O.prototype.sqr=function(s){return this.mul(s,s)},O.prototype.sqrt=function(s){if(s.isZero())return s.clone();var l=this.m.andln(3);if(t(l%2===1),l===3){var d=this.m.add(new n(1)).iushrn(2);return this.pow(s,d)}for(var p=this.m.subn(1),m=0;!p.isZero()&&p.andln(1)===0;)m++,p.iushrn(1);t(!p.isZero());var w=new n(1).toRed(this),x=w.redNeg(),b=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new n(2*f*f).toRed(this);this.pow(f,b).cmp(x)!==0;)f.redIAdd(x);for(var C=this.pow(f,p),F=this.pow(s,p.addn(1).iushrn(1)),z=this.pow(s,p),W=m;z.cmp(w)!==0;){for(var $=z,I=0;$.cmp(w)!==0;I++)$=$.redSqr();t(I<W);var K=this.pow(C,new n(1).iushln(W-I-1));F=F.redMul(K),C=K.redSqr(),z=z.redMul(C),W=I}return F},O.prototype.invm=function(s){var l=s._invmp(this.m);return l.negative!==0?(l.negative=0,this.imod(l).redNeg()):this.imod(l)},O.prototype.pow=function(s,l){if(l.isZero())return new n(1).toRed(this);if(l.cmpn(1)===0)return s.clone();var d=4,p=new Array(1<<d);p[0]=new n(1).toRed(this),p[1]=s;for(var m=2;m<p.length;m++)p[m]=this.mul(p[m-1],s);var w=p[0],x=0,b=0,f=l.bitLength()%26;for(f===0&&(f=26),m=l.length-1;m>=0;m--){for(var C=l.words[m],F=f-1;F>=0;F--){var z=C>>F&1;if(w!==p[0]&&(w=this.sqr(w)),z===0&&x===0){b=0;continue}x<<=1,x|=z,b++,!(b!==d&&(m!==0||F!==0))&&(w=this.mul(w,p[x]),b=0,x=0)}f=26}return w},O.prototype.convertTo=function(s){var l=s.umod(this.m);return l===s?l.clone():l},O.prototype.convertFrom=function(s){var l=s.clone();return l.red=null,l},n.mont=function(s){return new G(s)};function G(E){O.call(this,E),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(G,O),G.prototype.convertTo=function(s){return this.imod(s.ushln(this.shift))},G.prototype.convertFrom=function(s){var l=this.imod(s.mul(this.rinv));return l.red=null,l},G.prototype.imul=function(s,l){if(s.isZero()||l.isZero())return s.words[0]=0,s.length=1,s;var d=s.imul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.mul=function(s,l){if(s.isZero()||l.isZero())return new n(0)._forceRed(this);var d=s.mul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.invm=function(s){var l=this.imod(s._invmp(this.m).mul(this.r2));return l._forceRed(this)}})(i,di)}(Hf)),Hf.exports}var ug;function ji(){return ug||(ug=1,function(i){var e=i,r=Zn(),t=ki(),a=h1();e.assert=t,e.toArray=a.toArray,e.zero2=a.zero2,e.toHex=a.toHex,e.encode=a.encode;function n(h,g,y){var _=new Array(Math.max(h.bitLength(),y)+1);_.fill(0);for(var A=1<<g+1,S=h.clone(),T=0;T<_.length;T++){var B,M=S.andln(A-1);S.isOdd()?(M>(A>>1)-1?B=(A>>1)-M:B=M,S.isubn(B)):B=0,_[T]=B,S.iushrn(1)}return _}e.getNAF=n;function c(h,g){var y=[[],[]];h=h.clone(),g=g.clone();for(var _=0,A=0,S;h.cmpn(-_)>0||g.cmpn(-A)>0;){var T=h.andln(3)+_&3,B=g.andln(3)+A&3;T===3&&(T=-1),B===3&&(B=-1);var M;T&1?(S=h.andln(7)+_&7,(S===3||S===5)&&B===2?M=-T:M=T):M=0,y[0].push(M);var R;B&1?(S=g.andln(7)+A&7,(S===3||S===5)&&T===2?R=-B:R=B):R=0,y[1].push(R),2*_===M+1&&(_=1-_),2*A===R+1&&(A=1-A),h.iushrn(1),g.iushrn(1)}return y}e.getJSF=c;function u(h,g,y){var _="_"+g;h.prototype[g]=function(){return this[_]!==void 0?this[_]:this[_]=y.call(this)}}e.cachedProperty=u;function v(h){return typeof h=="string"?e.toArray(h,"hex"):h}e.parseBytes=v;function o(h){return new r(h,"hex","le")}e.intFromLE=o}(M0)),M0}var B0={},L0,hg;function Ll(){if(hg)return L0;hg=1;var i=Zn(),e=ji(),r=e.getNAF,t=e.getJSF,a=e.assert;function n(u,v){this.type=u,this.p=new i(v.p,16),this.red=v.prime?i.red(v.prime):i.mont(this.p),this.zero=new i(0).toRed(this.red),this.one=new i(1).toRed(this.red),this.two=new i(2).toRed(this.red),this.n=v.n&&new i(v.n,16),this.g=v.g&&this.pointFromJSON(v.g,v.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var o=this.n&&this.p.div(this.n);!o||o.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}L0=n,n.prototype.point=function(){throw new Error("Not implemented")},n.prototype.validate=function(){throw new Error("Not implemented")},n.prototype._fixedNafMul=function(v,o){a(v.precomputed);var h=v._getDoubles(),g=r(o,1,this._bitLength),y=(1<<h.step+1)-(h.step%2===0?2:1);y/=3;var _=[],A,S;for(A=0;A<g.length;A+=h.step){S=0;for(var T=A+h.step-1;T>=A;T--)S=(S<<1)+g[T];_.push(S)}for(var B=this.jpoint(null,null,null),M=this.jpoint(null,null,null),R=y;R>0;R--){for(A=0;A<_.length;A++)S=_[A],S===R?M=M.mixedAdd(h.points[A]):S===-R&&(M=M.mixedAdd(h.points[A].neg()));B=B.add(M)}return B.toP()},n.prototype._wnafMul=function(v,o){var h=4,g=v._getNAFPoints(h);h=g.wnd;for(var y=g.points,_=r(o,h,this._bitLength),A=this.jpoint(null,null,null),S=_.length-1;S>=0;S--){for(var T=0;S>=0&&_[S]===0;S--)T++;if(S>=0&&T++,A=A.dblp(T),S<0)break;var B=_[S];a(B!==0),v.type==="affine"?B>0?A=A.mixedAdd(y[B-1>>1]):A=A.mixedAdd(y[-B-1>>1].neg()):B>0?A=A.add(y[B-1>>1]):A=A.add(y[-B-1>>1].neg())}return v.type==="affine"?A.toP():A},n.prototype._wnafMulAdd=function(v,o,h,g,y){var _=this._wnafT1,A=this._wnafT2,S=this._wnafT3,T=0,B,M,R;for(B=0;B<g;B++){R=o[B];var P=R._getNAFPoints(v);_[B]=P.wnd,A[B]=P.points}for(B=g-1;B>=1;B-=2){var D=B-1,q=B;if(_[D]!==1||_[q]!==1){S[D]=r(h[D],_[D],this._bitLength),S[q]=r(h[q],_[q],this._bitLength),T=Math.max(S[D].length,T),T=Math.max(S[q].length,T);continue}var k=[o[D],null,null,o[q]];o[D].y.cmp(o[q].y)===0?(k[1]=o[D].add(o[q]),k[2]=o[D].toJ().mixedAdd(o[q].neg())):o[D].y.cmp(o[q].y.redNeg())===0?(k[1]=o[D].toJ().mixedAdd(o[q]),k[2]=o[D].add(o[q].neg())):(k[1]=o[D].toJ().mixedAdd(o[q]),k[2]=o[D].toJ().mixedAdd(o[q].neg()));var U=[-3,-1,-5,-7,0,7,5,1,3],O=t(h[D],h[q]);for(T=Math.max(O[0].length,T),S[D]=new Array(T),S[q]=new Array(T),M=0;M<T;M++){var G=O[0][M]|0,E=O[1][M]|0;S[D][M]=U[(G+1)*3+(E+1)],S[q][M]=0,A[D]=k}}var s=this.jpoint(null,null,null),l=this._wnafT4;for(B=T;B>=0;B--){for(var d=0;B>=0;){var p=!0;for(M=0;M<g;M++)l[M]=S[M][B]|0,l[M]!==0&&(p=!1);if(!p)break;d++,B--}if(B>=0&&d++,s=s.dblp(d),B<0)break;for(M=0;M<g;M++){var m=l[M];m!==0&&(m>0?R=A[M][m-1>>1]:m<0&&(R=A[M][-m-1>>1].neg()),R.type==="affine"?s=s.mixedAdd(R):s=s.add(R))}}for(B=0;B<g;B++)A[B]=null;return y?s:s.toP()};function c(u,v){this.curve=u,this.type=v,this.precomputed=null}return n.BasePoint=c,c.prototype.eq=function(){throw new Error("Not implemented")},c.prototype.validate=function(){return this.curve.validate(this)},n.prototype.decodePoint=function(v,o){v=e.toArray(v,o);var h=this.p.byteLength();if((v[0]===4||v[0]===6||v[0]===7)&&v.length-1===2*h){v[0]===6?a(v[v.length-1]%2===0):v[0]===7&&a(v[v.length-1]%2===1);var g=this.point(v.slice(1,1+h),v.slice(1+h,1+2*h));return g}else if((v[0]===2||v[0]===3)&&v.length-1===h)return this.pointFromX(v.slice(1,1+h),v[0]===3);throw new Error("Unknown point format")},c.prototype.encodeCompressed=function(v){return this.encode(v,!0)},c.prototype._encode=function(v){var o=this.curve.p.byteLength(),h=this.getX().toArray("be",o);return v?[this.getY().isEven()?2:3].concat(h):[4].concat(h,this.getY().toArray("be",o))},c.prototype.encode=function(v,o){return e.encode(this._encode(o),v)},c.prototype.precompute=function(v){if(this.precomputed)return this;var o={doubles:null,naf:null,beta:null};return o.naf=this._getNAFPoints(8),o.doubles=this._getDoubles(4,v),o.beta=this._getBeta(),this.precomputed=o,this},c.prototype._hasDoubles=function(v){if(!this.precomputed)return!1;var o=this.precomputed.doubles;return o?o.points.length>=Math.ceil((v.bitLength()+1)/o.step):!1},c.prototype._getDoubles=function(v,o){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var h=[this],g=this,y=0;y<o;y+=v){for(var _=0;_<v;_++)g=g.dbl();h.push(g)}return{step:v,points:h}},c.prototype._getNAFPoints=function(v){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var o=[this],h=(1<<v)-1,g=h===1?null:this.dbl(),y=1;y<h;y++)o[y]=o[y-1].add(g);return{wnd:v,points:o}},c.prototype._getBeta=function(){return null},c.prototype.dblp=function(v){for(var o=this,h=0;h<v;h++)o=o.dbl();return o},L0}var T0,dg;function b5(){if(dg)return T0;dg=1;var i=ji(),e=Zn(),r=De(),t=Ll(),a=i.assert;function n(v){t.call(this,"short",v),this.a=new e(v.a,16).toRed(this.red),this.b=new e(v.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(v),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}r(n,t),T0=n,n.prototype._getEndomorphism=function(o){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var h,g;if(o.beta)h=new e(o.beta,16).toRed(this.red);else{var y=this._getEndoRoots(this.p);h=y[0].cmp(y[1])<0?y[0]:y[1],h=h.toRed(this.red)}if(o.lambda)g=new e(o.lambda,16);else{var _=this._getEndoRoots(this.n);this.g.mul(_[0]).x.cmp(this.g.x.redMul(h))===0?g=_[0]:(g=_[1],a(this.g.mul(g).x.cmp(this.g.x.redMul(h))===0))}var A;return o.basis?A=o.basis.map(function(S){return{a:new e(S.a,16),b:new e(S.b,16)}}):A=this._getEndoBasis(g),{beta:h,lambda:g,basis:A}}},n.prototype._getEndoRoots=function(o){var h=o===this.p?this.red:e.mont(o),g=new e(2).toRed(h).redInvm(),y=g.redNeg(),_=new e(3).toRed(h).redNeg().redSqrt().redMul(g),A=y.redAdd(_).fromRed(),S=y.redSub(_).fromRed();return[A,S]},n.prototype._getEndoBasis=function(o){for(var h=this.n.ushrn(Math.floor(this.n.bitLength()/2)),g=o,y=this.n.clone(),_=new e(1),A=new e(0),S=new e(0),T=new e(1),B,M,R,P,D,q,k,U=0,O,G;g.cmpn(0)!==0;){var E=y.div(g);O=y.sub(E.mul(g)),G=S.sub(E.mul(_));var s=T.sub(E.mul(A));if(!R&&O.cmp(h)<0)B=k.neg(),M=_,R=O.neg(),P=G;else if(R&&++U===2)break;k=O,y=g,g=O,S=_,_=G,T=A,A=s}D=O.neg(),q=G;var l=R.sqr().add(P.sqr()),d=D.sqr().add(q.sqr());return d.cmp(l)>=0&&(D=B,q=M),R.negative&&(R=R.neg(),P=P.neg()),D.negative&&(D=D.neg(),q=q.neg()),[{a:R,b:P},{a:D,b:q}]},n.prototype._endoSplit=function(o){var h=this.endo.basis,g=h[0],y=h[1],_=y.b.mul(o).divRound(this.n),A=g.b.neg().mul(o).divRound(this.n),S=_.mul(g.a),T=A.mul(y.a),B=_.mul(g.b),M=A.mul(y.b),R=o.sub(S).sub(T),P=B.add(M).neg();return{k1:R,k2:P}},n.prototype.pointFromX=function(o,h){o=new e(o,16),o.red||(o=o.toRed(this.red));var g=o.redSqr().redMul(o).redIAdd(o.redMul(this.a)).redIAdd(this.b),y=g.redSqrt();if(y.redSqr().redSub(g).cmp(this.zero)!==0)throw new Error("invalid point");var _=y.fromRed().isOdd();return(h&&!_||!h&&_)&&(y=y.redNeg()),this.point(o,y)},n.prototype.validate=function(o){if(o.inf)return!0;var h=o.x,g=o.y,y=this.a.redMul(h),_=h.redSqr().redMul(h).redIAdd(y).redIAdd(this.b);return g.redSqr().redISub(_).cmpn(0)===0},n.prototype._endoWnafMulAdd=function(o,h,g){for(var y=this._endoWnafT1,_=this._endoWnafT2,A=0;A<o.length;A++){var S=this._endoSplit(h[A]),T=o[A],B=T._getBeta();S.k1.negative&&(S.k1.ineg(),T=T.neg(!0)),S.k2.negative&&(S.k2.ineg(),B=B.neg(!0)),y[A*2]=T,y[A*2+1]=B,_[A*2]=S.k1,_[A*2+1]=S.k2}for(var M=this._wnafMulAdd(1,y,_,A*2,g),R=0;R<A*2;R++)y[R]=null,_[R]=null;return M};function c(v,o,h,g){t.BasePoint.call(this,v,"affine"),o===null&&h===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new e(o,16),this.y=new e(h,16),g&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}r(c,t.BasePoint),n.prototype.point=function(o,h,g){return new c(this,o,h,g)},n.prototype.pointFromJSON=function(o,h){return c.fromJSON(this,o,h)},c.prototype._getBeta=function(){if(this.curve.endo){var o=this.precomputed;if(o&&o.beta)return o.beta;var h=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(o){var g=this.curve,y=function(_){return g.point(_.x.redMul(g.endo.beta),_.y)};o.beta=h,h.precomputed={beta:null,naf:o.naf&&{wnd:o.naf.wnd,points:o.naf.points.map(y)},doubles:o.doubles&&{step:o.doubles.step,points:o.doubles.points.map(y)}}}return h}},c.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},c.fromJSON=function(o,h,g){typeof h=="string"&&(h=JSON.parse(h));var y=o.point(h[0],h[1],g);if(!h[2])return y;function _(S){return o.point(S[0],S[1],g)}var A=h[2];return y.precomputed={beta:null,doubles:A.doubles&&{step:A.doubles.step,points:[y].concat(A.doubles.points.map(_))},naf:A.naf&&{wnd:A.naf.wnd,points:[y].concat(A.naf.points.map(_))}},y},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.inf},c.prototype.add=function(o){if(this.inf)return o;if(o.inf)return this;if(this.eq(o))return this.dbl();if(this.neg().eq(o))return this.curve.point(null,null);if(this.x.cmp(o.x)===0)return this.curve.point(null,null);var h=this.y.redSub(o.y);h.cmpn(0)!==0&&(h=h.redMul(this.x.redSub(o.x).redInvm()));var g=h.redSqr().redISub(this.x).redISub(o.x),y=h.redMul(this.x.redSub(g)).redISub(this.y);return this.curve.point(g,y)},c.prototype.dbl=function(){if(this.inf)return this;var o=this.y.redAdd(this.y);if(o.cmpn(0)===0)return this.curve.point(null,null);var h=this.curve.a,g=this.x.redSqr(),y=o.redInvm(),_=g.redAdd(g).redIAdd(g).redIAdd(h).redMul(y),A=_.redSqr().redISub(this.x.redAdd(this.x)),S=_.redMul(this.x.redSub(A)).redISub(this.y);return this.curve.point(A,S)},c.prototype.getX=function(){return this.x.fromRed()},c.prototype.getY=function(){return this.y.fromRed()},c.prototype.mul=function(o){return o=new e(o,16),this.isInfinity()?this:this._hasDoubles(o)?this.curve._fixedNafMul(this,o):this.curve.endo?this.curve._endoWnafMulAdd([this],[o]):this.curve._wnafMul(this,o)},c.prototype.mulAdd=function(o,h,g){var y=[this,h],_=[o,g];return this.curve.endo?this.curve._endoWnafMulAdd(y,_):this.curve._wnafMulAdd(1,y,_,2)},c.prototype.jmulAdd=function(o,h,g){var y=[this,h],_=[o,g];return this.curve.endo?this.curve._endoWnafMulAdd(y,_,!0):this.curve._wnafMulAdd(1,y,_,2,!0)},c.prototype.eq=function(o){return this===o||this.inf===o.inf&&(this.inf||this.x.cmp(o.x)===0&&this.y.cmp(o.y)===0)},c.prototype.neg=function(o){if(this.inf)return this;var h=this.curve.point(this.x,this.y.redNeg());if(o&&this.precomputed){var g=this.precomputed,y=function(_){return _.neg()};h.precomputed={naf:g.naf&&{wnd:g.naf.wnd,points:g.naf.points.map(y)},doubles:g.doubles&&{step:g.doubles.step,points:g.doubles.points.map(y)}}}return h},c.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var o=this.curve.jpoint(this.x,this.y,this.curve.one);return o};function u(v,o,h,g){t.BasePoint.call(this,v,"jacobian"),o===null&&h===null&&g===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new e(0)):(this.x=new e(o,16),this.y=new e(h,16),this.z=new e(g,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}return r(u,t.BasePoint),n.prototype.jpoint=function(o,h,g){return new u(this,o,h,g)},u.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var o=this.z.redInvm(),h=o.redSqr(),g=this.x.redMul(h),y=this.y.redMul(h).redMul(o);return this.curve.point(g,y)},u.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},u.prototype.add=function(o){if(this.isInfinity())return o;if(o.isInfinity())return this;var h=o.z.redSqr(),g=this.z.redSqr(),y=this.x.redMul(h),_=o.x.redMul(g),A=this.y.redMul(h.redMul(o.z)),S=o.y.redMul(g.redMul(this.z)),T=y.redSub(_),B=A.redSub(S);if(T.cmpn(0)===0)return B.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var M=T.redSqr(),R=M.redMul(T),P=y.redMul(M),D=B.redSqr().redIAdd(R).redISub(P).redISub(P),q=B.redMul(P.redISub(D)).redISub(A.redMul(R)),k=this.z.redMul(o.z).redMul(T);return this.curve.jpoint(D,q,k)},u.prototype.mixedAdd=function(o){if(this.isInfinity())return o.toJ();if(o.isInfinity())return this;var h=this.z.redSqr(),g=this.x,y=o.x.redMul(h),_=this.y,A=o.y.redMul(h).redMul(this.z),S=g.redSub(y),T=_.redSub(A);if(S.cmpn(0)===0)return T.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var B=S.redSqr(),M=B.redMul(S),R=g.redMul(B),P=T.redSqr().redIAdd(M).redISub(R).redISub(R),D=T.redMul(R.redISub(P)).redISub(_.redMul(M)),q=this.z.redMul(S);return this.curve.jpoint(P,D,q)},u.prototype.dblp=function(o){if(o===0)return this;if(this.isInfinity())return this;if(!o)return this.dbl();var h;if(this.curve.zeroA||this.curve.threeA){var g=this;for(h=0;h<o;h++)g=g.dbl();return g}var y=this.curve.a,_=this.curve.tinv,A=this.x,S=this.y,T=this.z,B=T.redSqr().redSqr(),M=S.redAdd(S);for(h=0;h<o;h++){var R=A.redSqr(),P=M.redSqr(),D=P.redSqr(),q=R.redAdd(R).redIAdd(R).redIAdd(y.redMul(B)),k=A.redMul(P),U=q.redSqr().redISub(k.redAdd(k)),O=k.redISub(U),G=q.redMul(O);G=G.redIAdd(G).redISub(D);var E=M.redMul(T);h+1<o&&(B=B.redMul(D)),A=U,T=E,M=G}return this.curve.jpoint(A,M.redMul(_),T)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},u.prototype._zeroDbl=function(){var o,h,g;if(this.zOne){var y=this.x.redSqr(),_=this.y.redSqr(),A=_.redSqr(),S=this.x.redAdd(_).redSqr().redISub(y).redISub(A);S=S.redIAdd(S);var T=y.redAdd(y).redIAdd(y),B=T.redSqr().redISub(S).redISub(S),M=A.redIAdd(A);M=M.redIAdd(M),M=M.redIAdd(M),o=B,h=T.redMul(S.redISub(B)).redISub(M),g=this.y.redAdd(this.y)}else{var R=this.x.redSqr(),P=this.y.redSqr(),D=P.redSqr(),q=this.x.redAdd(P).redSqr().redISub(R).redISub(D);q=q.redIAdd(q);var k=R.redAdd(R).redIAdd(R),U=k.redSqr(),O=D.redIAdd(D);O=O.redIAdd(O),O=O.redIAdd(O),o=U.redISub(q).redISub(q),h=k.redMul(q.redISub(o)).redISub(O),g=this.y.redMul(this.z),g=g.redIAdd(g)}return this.curve.jpoint(o,h,g)},u.prototype._threeDbl=function(){var o,h,g;if(this.zOne){var y=this.x.redSqr(),_=this.y.redSqr(),A=_.redSqr(),S=this.x.redAdd(_).redSqr().redISub(y).redISub(A);S=S.redIAdd(S);var T=y.redAdd(y).redIAdd(y).redIAdd(this.curve.a),B=T.redSqr().redISub(S).redISub(S);o=B;var M=A.redIAdd(A);M=M.redIAdd(M),M=M.redIAdd(M),h=T.redMul(S.redISub(B)).redISub(M),g=this.y.redAdd(this.y)}else{var R=this.z.redSqr(),P=this.y.redSqr(),D=this.x.redMul(P),q=this.x.redSub(R).redMul(this.x.redAdd(R));q=q.redAdd(q).redIAdd(q);var k=D.redIAdd(D);k=k.redIAdd(k);var U=k.redAdd(k);o=q.redSqr().redISub(U),g=this.y.redAdd(this.z).redSqr().redISub(P).redISub(R);var O=P.redSqr();O=O.redIAdd(O),O=O.redIAdd(O),O=O.redIAdd(O),h=q.redMul(k.redISub(o)).redISub(O)}return this.curve.jpoint(o,h,g)},u.prototype._dbl=function(){var o=this.curve.a,h=this.x,g=this.y,y=this.z,_=y.redSqr().redSqr(),A=h.redSqr(),S=g.redSqr(),T=A.redAdd(A).redIAdd(A).redIAdd(o.redMul(_)),B=h.redAdd(h);B=B.redIAdd(B);var M=B.redMul(S),R=T.redSqr().redISub(M.redAdd(M)),P=M.redISub(R),D=S.redSqr();D=D.redIAdd(D),D=D.redIAdd(D),D=D.redIAdd(D);var q=T.redMul(P).redISub(D),k=g.redAdd(g).redMul(y);return this.curve.jpoint(R,q,k)},u.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var o=this.x.redSqr(),h=this.y.redSqr(),g=this.z.redSqr(),y=h.redSqr(),_=o.redAdd(o).redIAdd(o),A=_.redSqr(),S=this.x.redAdd(h).redSqr().redISub(o).redISub(y);S=S.redIAdd(S),S=S.redAdd(S).redIAdd(S),S=S.redISub(A);var T=S.redSqr(),B=y.redIAdd(y);B=B.redIAdd(B),B=B.redIAdd(B),B=B.redIAdd(B);var M=_.redIAdd(S).redSqr().redISub(A).redISub(T).redISub(B),R=h.redMul(M);R=R.redIAdd(R),R=R.redIAdd(R);var P=this.x.redMul(T).redISub(R);P=P.redIAdd(P),P=P.redIAdd(P);var D=this.y.redMul(M.redMul(B.redISub(M)).redISub(S.redMul(T)));D=D.redIAdd(D),D=D.redIAdd(D),D=D.redIAdd(D);var q=this.z.redAdd(S).redSqr().redISub(g).redISub(T);return this.curve.jpoint(P,D,q)},u.prototype.mul=function(o,h){return o=new e(o,h),this.curve._wnafMul(this,o)},u.prototype.eq=function(o){if(o.type==="affine")return this.eq(o.toJ());if(this===o)return!0;var h=this.z.redSqr(),g=o.z.redSqr();if(this.x.redMul(g).redISub(o.x.redMul(h)).cmpn(0)!==0)return!1;var y=h.redMul(this.z),_=g.redMul(o.z);return this.y.redMul(_).redISub(o.y.redMul(y)).cmpn(0)===0},u.prototype.eqXToP=function(o){var h=this.z.redSqr(),g=o.toRed(this.curve.red).redMul(h);if(this.x.cmp(g)===0)return!0;for(var y=o.clone(),_=this.curve.redN.redMul(h);;){if(y.iadd(this.curve.n),y.cmp(this.curve.p)>=0)return!1;if(g.redIAdd(_),this.x.cmp(g)===0)return!0}},u.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},u.prototype.isInfinity=function(){return this.z.cmpn(0)===0},T0}var R0,pg;function _5(){if(pg)return R0;pg=1;var i=Zn(),e=De(),r=Ll(),t=ji();function a(c){r.call(this,"mont",c),this.a=new i(c.a,16).toRed(this.red),this.b=new i(c.b,16).toRed(this.red),this.i4=new i(4).toRed(this.red).redInvm(),this.two=new i(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}e(a,r),R0=a,a.prototype.validate=function(u){var v=u.normalize().x,o=v.redSqr(),h=o.redMul(v).redAdd(o.redMul(this.a)).redAdd(v),g=h.redSqrt();return g.redSqr().cmp(h)===0};function n(c,u,v){r.BasePoint.call(this,c,"projective"),u===null&&v===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new i(u,16),this.z=new i(v,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}return e(n,r.BasePoint),a.prototype.decodePoint=function(u,v){return this.point(t.toArray(u,v),1)},a.prototype.point=function(u,v){return new n(this,u,v)},a.prototype.pointFromJSON=function(u){return n.fromJSON(this,u)},n.prototype.precompute=function(){},n.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},n.fromJSON=function(u,v){return new n(u,v[0],v[1]||u.one)},n.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},n.prototype.isInfinity=function(){return this.z.cmpn(0)===0},n.prototype.dbl=function(){var u=this.x.redAdd(this.z),v=u.redSqr(),o=this.x.redSub(this.z),h=o.redSqr(),g=v.redSub(h),y=v.redMul(h),_=g.redMul(h.redAdd(this.curve.a24.redMul(g)));return this.curve.point(y,_)},n.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},n.prototype.diffAdd=function(u,v){var o=this.x.redAdd(this.z),h=this.x.redSub(this.z),g=u.x.redAdd(u.z),y=u.x.redSub(u.z),_=y.redMul(o),A=g.redMul(h),S=v.z.redMul(_.redAdd(A).redSqr()),T=v.x.redMul(_.redISub(A).redSqr());return this.curve.point(S,T)},n.prototype.mul=function(u){for(var v=u.clone(),o=this,h=this.curve.point(null,null),g=this,y=[];v.cmpn(0)!==0;v.iushrn(1))y.push(v.andln(1));for(var _=y.length-1;_>=0;_--)y[_]===0?(o=o.diffAdd(h,g),h=h.dbl()):(h=o.diffAdd(h,g),o=o.dbl());return h},n.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},n.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},n.prototype.eq=function(u){return this.getX().cmp(u.getX())===0},n.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},n.prototype.getX=function(){return this.normalize(),this.x.fromRed()},R0}var N0,vg;function w5(){if(vg)return N0;vg=1;var i=ji(),e=Zn(),r=De(),t=Ll(),a=i.assert;function n(u){this.twisted=(u.a|0)!==1,this.mOneA=this.twisted&&(u.a|0)===-1,this.extended=this.mOneA,t.call(this,"edwards",u),this.a=new e(u.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new e(u.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new e(u.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(u.c|0)===1}r(n,t),N0=n,n.prototype._mulA=function(v){return this.mOneA?v.redNeg():this.a.redMul(v)},n.prototype._mulC=function(v){return this.oneC?v:this.c.redMul(v)},n.prototype.jpoint=function(v,o,h,g){return this.point(v,o,h,g)},n.prototype.pointFromX=function(v,o){v=new e(v,16),v.red||(v=v.toRed(this.red));var h=v.redSqr(),g=this.c2.redSub(this.a.redMul(h)),y=this.one.redSub(this.c2.redMul(this.d).redMul(h)),_=g.redMul(y.redInvm()),A=_.redSqrt();if(A.redSqr().redSub(_).cmp(this.zero)!==0)throw new Error("invalid point");var S=A.fromRed().isOdd();return(o&&!S||!o&&S)&&(A=A.redNeg()),this.point(v,A)},n.prototype.pointFromY=function(v,o){v=new e(v,16),v.red||(v=v.toRed(this.red));var h=v.redSqr(),g=h.redSub(this.c2),y=h.redMul(this.d).redMul(this.c2).redSub(this.a),_=g.redMul(y.redInvm());if(_.cmp(this.zero)===0){if(o)throw new Error("invalid point");return this.point(this.zero,v)}var A=_.redSqrt();if(A.redSqr().redSub(_).cmp(this.zero)!==0)throw new Error("invalid point");return A.fromRed().isOdd()!==o&&(A=A.redNeg()),this.point(A,v)},n.prototype.validate=function(v){if(v.isInfinity())return!0;v.normalize();var o=v.x.redSqr(),h=v.y.redSqr(),g=o.redMul(this.a).redAdd(h),y=this.c2.redMul(this.one.redAdd(this.d.redMul(o).redMul(h)));return g.cmp(y)===0};function c(u,v,o,h,g){t.BasePoint.call(this,u,"projective"),v===null&&o===null&&h===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new e(v,16),this.y=new e(o,16),this.z=h?new e(h,16):this.curve.one,this.t=g&&new e(g,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}return r(c,t.BasePoint),n.prototype.pointFromJSON=function(v){return c.fromJSON(this,v)},n.prototype.point=function(v,o,h,g){return new c(this,v,o,h,g)},c.fromJSON=function(v,o){return new c(v,o[0],o[1],o[2])},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},c.prototype._extDbl=function(){var v=this.x.redSqr(),o=this.y.redSqr(),h=this.z.redSqr();h=h.redIAdd(h);var g=this.curve._mulA(v),y=this.x.redAdd(this.y).redSqr().redISub(v).redISub(o),_=g.redAdd(o),A=_.redSub(h),S=g.redSub(o),T=y.redMul(A),B=_.redMul(S),M=y.redMul(S),R=A.redMul(_);return this.curve.point(T,B,R,M)},c.prototype._projDbl=function(){var v=this.x.redAdd(this.y).redSqr(),o=this.x.redSqr(),h=this.y.redSqr(),g,y,_,A,S,T;if(this.curve.twisted){A=this.curve._mulA(o);var B=A.redAdd(h);this.zOne?(g=v.redSub(o).redSub(h).redMul(B.redSub(this.curve.two)),y=B.redMul(A.redSub(h)),_=B.redSqr().redSub(B).redSub(B)):(S=this.z.redSqr(),T=B.redSub(S).redISub(S),g=v.redSub(o).redISub(h).redMul(T),y=B.redMul(A.redSub(h)),_=B.redMul(T))}else A=o.redAdd(h),S=this.curve._mulC(this.z).redSqr(),T=A.redSub(S).redSub(S),g=this.curve._mulC(v.redISub(A)).redMul(T),y=this.curve._mulC(A).redMul(o.redISub(h)),_=A.redMul(T);return this.curve.point(g,y,_)},c.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},c.prototype._extAdd=function(v){var o=this.y.redSub(this.x).redMul(v.y.redSub(v.x)),h=this.y.redAdd(this.x).redMul(v.y.redAdd(v.x)),g=this.t.redMul(this.curve.dd).redMul(v.t),y=this.z.redMul(v.z.redAdd(v.z)),_=h.redSub(o),A=y.redSub(g),S=y.redAdd(g),T=h.redAdd(o),B=_.redMul(A),M=S.redMul(T),R=_.redMul(T),P=A.redMul(S);return this.curve.point(B,M,P,R)},c.prototype._projAdd=function(v){var o=this.z.redMul(v.z),h=o.redSqr(),g=this.x.redMul(v.x),y=this.y.redMul(v.y),_=this.curve.d.redMul(g).redMul(y),A=h.redSub(_),S=h.redAdd(_),T=this.x.redAdd(this.y).redMul(v.x.redAdd(v.y)).redISub(g).redISub(y),B=o.redMul(A).redMul(T),M,R;return this.curve.twisted?(M=o.redMul(S).redMul(y.redSub(this.curve._mulA(g))),R=A.redMul(S)):(M=o.redMul(S).redMul(y.redSub(g)),R=this.curve._mulC(A).redMul(S)),this.curve.point(B,M,R)},c.prototype.add=function(v){return this.isInfinity()?v:v.isInfinity()?this:this.curve.extended?this._extAdd(v):this._projAdd(v)},c.prototype.mul=function(v){return this._hasDoubles(v)?this.curve._fixedNafMul(this,v):this.curve._wnafMul(this,v)},c.prototype.mulAdd=function(v,o,h){return this.curve._wnafMulAdd(1,[this,o],[v,h],2,!1)},c.prototype.jmulAdd=function(v,o,h){return this.curve._wnafMulAdd(1,[this,o],[v,h],2,!0)},c.prototype.normalize=function(){if(this.zOne)return this;var v=this.z.redInvm();return this.x=this.x.redMul(v),this.y=this.y.redMul(v),this.t&&(this.t=this.t.redMul(v)),this.z=this.curve.one,this.zOne=!0,this},c.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()},c.prototype.getY=function(){return this.normalize(),this.y.fromRed()},c.prototype.eq=function(v){return this===v||this.getX().cmp(v.getX())===0&&this.getY().cmp(v.getY())===0},c.prototype.eqXToP=function(v){var o=v.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(o)===0)return!0;for(var h=v.clone(),g=this.curve.redN.redMul(this.z);;){if(h.iadd(this.curve.n),h.cmp(this.curve.p)>=0)return!1;if(o.redIAdd(g),this.x.cmp(o)===0)return!0}},c.prototype.toP=c.prototype.normalize,c.prototype.mixedAdd=c.prototype.add,N0}var gg;function Xy(){return gg||(gg=1,function(i){var e=i;e.base=Ll(),e.short=b5(),e.mont=_5(),e.edwards=w5()}(B0)),B0}var k0={},P0,mg;function C5(){return mg||(mg=1,P0={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),P0}var yg;function p1(){return yg||(yg=1,function(i){var e=i,r=Ko(),t=Xy(),a=ji(),n=a.assert;function c(o){o.type==="short"?this.curve=new t.short(o):o.type==="edwards"?this.curve=new t.edwards(o):this.curve=new t.mont(o),this.g=this.curve.g,this.n=this.curve.n,this.hash=o.hash,n(this.g.validate(),"Invalid curve"),n(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=c;function u(o,h){Object.defineProperty(e,o,{configurable:!0,enumerable:!0,get:function(){var g=new c(h);return Object.defineProperty(e,o,{configurable:!0,enumerable:!0,value:g}),g}})}u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var v;try{v=C5()}catch{v=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",v]})}(k0)),k0}var U0,bg;function E5(){if(bg)return U0;bg=1;var i=Zn(),e=ji(),r=e.assert;function t(a,n){this.ec=a,this.priv=null,this.pub=null,n.priv&&this._importPrivate(n.priv,n.privEnc),n.pub&&this._importPublic(n.pub,n.pubEnc)}return U0=t,t.fromPublic=function(n,c,u){return c instanceof t?c:new t(n,{pub:c,pubEnc:u})},t.fromPrivate=function(n,c,u){return c instanceof t?c:new t(n,{priv:c,privEnc:u})},t.prototype.validate=function(){var n=this.getPublic();return n.isInfinity()?{result:!1,reason:"Invalid public key"}:n.validate()?n.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},t.prototype.getPublic=function(n,c){return typeof n=="string"&&(c=n,n=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),c?this.pub.encode(c,n):this.pub},t.prototype.getPrivate=function(n){return n==="hex"?this.priv.toString(16,2):this.priv},t.prototype._importPrivate=function(n,c){this.priv=new i(n,c||16),this.priv=this.priv.umod(this.ec.curve.n)},t.prototype._importPublic=function(n,c){if(n.x||n.y){this.ec.curve.type==="mont"?r(n.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&r(n.x&&n.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(n.x,n.y);return}this.pub=this.ec.curve.decodePoint(n,c)},t.prototype.derive=function(n){return n.validate()||r(n.validate(),"public point not validated"),n.mul(this.priv).getX()},t.prototype.sign=function(n,c,u){return this.ec.sign(n,this,c,u)},t.prototype.verify=function(n,c){return this.ec.verify(n,c,this)},t.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"},U0}var D0,_g;function A5(){if(_g)return D0;_g=1;var i=Zn(),e=ji(),r=e.assert;function t(v,o){if(v instanceof t)return v;this._importDER(v,o)||(r(v.r&&v.s,"Signature without r or s"),this.r=new i(v.r,16),this.s=new i(v.s,16),v.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=v.recoveryParam)}D0=t;function a(){this.place=0}function n(v,o){var h=v[o.place++];if(!(h&128))return h;var g=h&15;if(g===0||g>4)return!1;for(var y=0,_=0,A=o.place;_<g;_++,A++)y<<=8,y|=v[A],y>>>=0;return y<=127?!1:(o.place=A,y)}function c(v){for(var o=0,h=v.length-1;!v[o]&&!(v[o+1]&128)&&o<h;)o++;return o===0?v:v.slice(o)}t.prototype._importDER=function(o,h){o=e.toArray(o,h);var g=new a;if(o[g.place++]!==48)return!1;var y=n(o,g);if(y===!1||y+g.place!==o.length||o[g.place++]!==2)return!1;var _=n(o,g);if(_===!1)return!1;var A=o.slice(g.place,_+g.place);if(g.place+=_,o[g.place++]!==2)return!1;var S=n(o,g);if(S===!1||o.length!==S+g.place)return!1;var T=o.slice(g.place,S+g.place);if(A[0]===0)if(A[1]&128)A=A.slice(1);else return!1;if(T[0]===0)if(T[1]&128)T=T.slice(1);else return!1;return this.r=new i(A),this.s=new i(T),this.recoveryParam=null,!0};function u(v,o){if(o<128){v.push(o);return}var h=1+(Math.log(o)/Math.LN2>>>3);for(v.push(h|128);--h;)v.push(o>>>(h<<3)&255);v.push(o)}return t.prototype.toDER=function(o){var h=this.r.toArray(),g=this.s.toArray();for(h[0]&128&&(h=[0].concat(h)),g[0]&128&&(g=[0].concat(g)),h=c(h),g=c(g);!g[0]&&!(g[1]&128);)g=g.slice(1);var y=[2];u(y,h.length),y=y.concat(h),y.push(2),u(y,g.length);var _=y.concat(g),A=[48];return u(A,_.length),A=A.concat(_),e.encode(A,o)},D0}var O0,wg;function S5(){if(wg)return O0;wg=1;var i=Zn(),e=Qy(),r=ji(),t=p1(),a=zo(),n=r.assert,c=E5(),u=A5();function v(o){if(!(this instanceof v))return new v(o);typeof o=="string"&&(n(Object.prototype.hasOwnProperty.call(t,o),"Unknown curve "+o),o=t[o]),o instanceof t.PresetCurve&&(o={curve:o}),this.curve=o.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=o.curve.g,this.g.precompute(o.curve.n.bitLength()+1),this.hash=o.hash||o.curve.hash}return O0=v,v.prototype.keyPair=function(h){return new c(this,h)},v.prototype.keyFromPrivate=function(h,g){return c.fromPrivate(this,h,g)},v.prototype.keyFromPublic=function(h,g){return c.fromPublic(this,h,g)},v.prototype.genKeyPair=function(h){h||(h={});for(var g=new e({hash:this.hash,pers:h.pers,persEnc:h.persEnc||"utf8",entropy:h.entropy||a(this.hash.hmacStrength),entropyEnc:h.entropy&&h.entropyEnc||"utf8",nonce:this.n.toArray()}),y=this.n.byteLength(),_=this.n.sub(new i(2));;){var A=new i(g.generate(y));if(!(A.cmp(_)>0))return A.iaddn(1),this.keyFromPrivate(A)}},v.prototype._truncateToN=function(h,g){var y=h.byteLength()*8-this.n.bitLength();return y>0&&(h=h.ushrn(y)),!g&&h.cmp(this.n)>=0?h.sub(this.n):h},v.prototype.sign=function(h,g,y,_){typeof y=="object"&&(_=y,y=null),_||(_={}),g=this.keyFromPrivate(g,y),h=this._truncateToN(new i(h,16));for(var A=this.n.byteLength(),S=g.getPrivate().toArray("be",A),T=h.toArray("be",A),B=new e({hash:this.hash,entropy:S,nonce:T,pers:_.pers,persEnc:_.persEnc||"utf8"}),M=this.n.sub(new i(1)),R=0;;R++){var P=_.k?_.k(R):new i(B.generate(this.n.byteLength()));if(P=this._truncateToN(P,!0),!(P.cmpn(1)<=0||P.cmp(M)>=0)){var D=this.g.mul(P);if(!D.isInfinity()){var q=D.getX(),k=q.umod(this.n);if(k.cmpn(0)!==0){var U=P.invm(this.n).mul(k.mul(g.getPrivate()).iadd(h));if(U=U.umod(this.n),U.cmpn(0)!==0){var O=(D.getY().isOdd()?1:0)|(q.cmp(k)!==0?2:0);return _.canonical&&U.cmp(this.nh)>0&&(U=this.n.sub(U),O^=1),new u({r:k,s:U,recoveryParam:O})}}}}}},v.prototype.verify=function(h,g,y,_){h=this._truncateToN(new i(h,16)),y=this.keyFromPublic(y,_),g=new u(g,"hex");var A=g.r,S=g.s;if(A.cmpn(1)<0||A.cmp(this.n)>=0||S.cmpn(1)<0||S.cmp(this.n)>=0)return!1;var T=S.invm(this.n),B=T.mul(h).umod(this.n),M=T.mul(A).umod(this.n),R;return this.curve._maxwellTrick?(R=this.g.jmulAdd(B,y.getPublic(),M),R.isInfinity()?!1:R.eqXToP(A)):(R=this.g.mulAdd(B,y.getPublic(),M),R.isInfinity()?!1:R.getX().umod(this.n).cmp(A)===0)},v.prototype.recoverPubKey=function(o,h,g,y){n((3&g)===g,"The recovery param is more than two bits"),h=new u(h,y);var _=this.n,A=new i(o),S=h.r,T=h.s,B=g&1,M=g>>1;if(S.cmp(this.curve.p.umod(this.curve.n))>=0&&M)throw new Error("Unable to find sencond key candinate");M?S=this.curve.pointFromX(S.add(this.curve.n),B):S=this.curve.pointFromX(S,B);var R=h.r.invm(_),P=_.sub(A).mul(R).umod(_),D=T.mul(R).umod(_);return this.g.mulAdd(P,S,D)},v.prototype.getKeyRecoveryParam=function(o,h,g,y){if(h=new u(h,y),h.recoveryParam!==null)return h.recoveryParam;for(var _=0;_<4;_++){var A;try{A=this.recoverPubKey(o,h,_)}catch{continue}if(A.eq(g))return _}throw new Error("Unable to find valid recovery factor")},O0}var F0,Cg;function x5(){if(Cg)return F0;Cg=1;var i=ji(),e=i.assert,r=i.parseBytes,t=i.cachedProperty;function a(n,c){this.eddsa=n,this._secret=r(c.secret),n.isPoint(c.pub)?this._pub=c.pub:this._pubBytes=r(c.pub)}return a.fromPublic=function(c,u){return u instanceof a?u:new a(c,{pub:u})},a.fromSecret=function(c,u){return u instanceof a?u:new a(c,{secret:u})},a.prototype.secret=function(){return this._secret},t(a,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),t(a,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),t(a,"privBytes",function(){var c=this.eddsa,u=this.hash(),v=c.encodingLength-1,o=u.slice(0,c.encodingLength);return o[0]&=248,o[v]&=127,o[v]|=64,o}),t(a,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),t(a,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),t(a,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),a.prototype.sign=function(c){return e(this._secret,"KeyPair can only verify"),this.eddsa.sign(c,this)},a.prototype.verify=function(c,u){return this.eddsa.verify(c,u,this)},a.prototype.getSecret=function(c){return e(this._secret,"KeyPair is public only"),i.encode(this.secret(),c)},a.prototype.getPublic=function(c){return i.encode(this.pubBytes(),c)},F0=a,F0}var q0,Eg;function I5(){if(Eg)return q0;Eg=1;var i=Zn(),e=ji(),r=e.assert,t=e.cachedProperty,a=e.parseBytes;function n(c,u){this.eddsa=c,typeof u!="object"&&(u=a(u)),Array.isArray(u)&&(u={R:u.slice(0,c.encodingLength),S:u.slice(c.encodingLength)}),r(u.R&&u.S,"Signature without R or S"),c.isPoint(u.R)&&(this._R=u.R),u.S instanceof i&&(this._S=u.S),this._Rencoded=Array.isArray(u.R)?u.R:u.Rencoded,this._Sencoded=Array.isArray(u.S)?u.S:u.Sencoded}return t(n,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),t(n,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),t(n,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),t(n,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),n.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},n.prototype.toHex=function(){return e.encode(this.toBytes(),"hex").toUpperCase()},q0=n,q0}var z0,Ag;function M5(){if(Ag)return z0;Ag=1;var i=Ko(),e=p1(),r=ji(),t=r.assert,a=r.parseBytes,n=x5(),c=I5();function u(v){if(t(v==="ed25519","only tested with ed25519 so far"),!(this instanceof u))return new u(v);v=e[v].curve,this.curve=v,this.g=v.g,this.g.precompute(v.n.bitLength()+1),this.pointClass=v.point().constructor,this.encodingLength=Math.ceil(v.n.bitLength()/8),this.hash=i.sha512}return z0=u,u.prototype.sign=function(o,h){o=a(o);var g=this.keyFromSecret(h),y=this.hashInt(g.messagePrefix(),o),_=this.g.mul(y),A=this.encodePoint(_),S=this.hashInt(A,g.pubBytes(),o).mul(g.priv()),T=y.add(S).umod(this.curve.n);return this.makeSignature({R:_,S:T,Rencoded:A})},u.prototype.verify=function(o,h,g){o=a(o),h=this.makeSignature(h);var y=this.keyFromPublic(g),_=this.hashInt(h.Rencoded(),y.pubBytes(),o),A=this.g.mul(h.S()),S=h.R().add(y.pub().mul(_));return S.eq(A)},u.prototype.hashInt=function(){for(var o=this.hash(),h=0;h<arguments.length;h++)o.update(arguments[h]);return r.intFromLE(o.digest()).umod(this.curve.n)},u.prototype.keyFromPublic=function(o){return n.fromPublic(this,o)},u.prototype.keyFromSecret=function(o){return n.fromSecret(this,o)},u.prototype.makeSignature=function(o){return o instanceof c?o:new c(this,o)},u.prototype.encodePoint=function(o){var h=o.getY().toArray("le",this.encodingLength);return h[this.encodingLength-1]|=o.getX().isOdd()?128:0,h},u.prototype.decodePoint=function(o){o=r.parseBytes(o);var h=o.length-1,g=o.slice(0,h).concat(o[h]&-129),y=(o[h]&128)!==0,_=r.intFromLE(g);return this.curve.pointFromY(_,y)},u.prototype.encodeInt=function(o){return o.toArray("le",this.encodingLength)},u.prototype.decodeInt=function(o){return r.intFromLE(o)},u.prototype.isPoint=function(o){return o instanceof this.pointClass},z0}var Sg;function B5(){return Sg||(Sg=1,function(i){var e=i;e.version=y5.version,e.utils=ji(),e.rand=zo(),e.curve=Xy(),e.curves=p1(),e.ec=S5(),e.eddsa=M5()}(I0)),I0}var Qf={exports:{}};Qf.exports;var xg;function L5(){return xg||(xg=1,function(i){(function(e,r){function t(E,s){if(!E)throw new Error(s||"Assertion failed")}function a(E,s){E.super_=s;var l=function(){};l.prototype=s.prototype,E.prototype=new l,E.prototype.constructor=E}function n(E,s,l){if(n.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&((s==="le"||s==="be")&&(l=s,s=10),this._init(E||0,s||10,l||"be"))}typeof e=="object"?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=$i.Buffer}catch{}n.isBN=function(s){return s instanceof n?!0:s!==null&&typeof s=="object"&&s.constructor.wordSize===n.wordSize&&Array.isArray(s.words)},n.max=function(s,l){return s.cmp(l)>0?s:l},n.min=function(s,l){return s.cmp(l)<0?s:l},n.prototype._init=function(s,l,d){if(typeof s=="number")return this._initNumber(s,l,d);if(typeof s=="object")return this._initArray(s,l,d);l==="hex"&&(l=16),t(l===(l|0)&&l>=2&&l<=36),s=s.toString().replace(/\s+/g,"");var p=0;s[0]==="-"&&(p++,this.negative=1),p<s.length&&(l===16?this._parseHex(s,p,d):(this._parseBase(s,l,p),d==="le"&&this._initArray(this.toArray(),l,d)))},n.prototype._initNumber=function(s,l,d){s<0&&(this.negative=1,s=-s),s<67108864?(this.words=[s&67108863],this.length=1):s<4503599627370496?(this.words=[s&67108863,s/67108864&67108863],this.length=2):(t(s<9007199254740992),this.words=[s&67108863,s/67108864&67108863,1],this.length=3),d==="le"&&this._initArray(this.toArray(),l,d)},n.prototype._initArray=function(s,l,d){if(t(typeof s.length=="number"),s.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(s.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m,w,x=0;if(d==="be")for(p=s.length-1,m=0;p>=0;p-=3)w=s[p]|s[p-1]<<8|s[p-2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);else if(d==="le")for(p=0,m=0;p<s.length;p+=3)w=s[p]|s[p+1]<<8|s[p+2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);return this.strip()};function u(E,s){var l=E.charCodeAt(s);return l>=65&&l<=70?l-55:l>=97&&l<=102?l-87:l-48&15}function v(E,s,l){var d=u(E,l);return l-1>=s&&(d|=u(E,l-1)<<4),d}n.prototype._parseHex=function(s,l,d){this.length=Math.ceil((s.length-l)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m=0,w=0,x;if(d==="be")for(p=s.length-1;p>=l;p-=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8;else{var b=s.length-l;for(p=b%2===0?l+1:l;p<s.length;p+=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8}this.strip()};function o(E,s,l,d){for(var p=0,m=Math.min(E.length,l),w=s;w<m;w++){var x=E.charCodeAt(w)-48;p*=d,x>=49?p+=x-49+10:x>=17?p+=x-17+10:p+=x}return p}n.prototype._parseBase=function(s,l,d){this.words=[0],this.length=1;for(var p=0,m=1;m<=67108863;m*=l)p++;p--,m=m/l|0;for(var w=s.length-d,x=w%p,b=Math.min(w,w-x)+d,f=0,C=d;C<b;C+=p)f=o(s,C,C+p,l),this.imuln(m),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(x!==0){var F=1;for(f=o(s,C,s.length,l),C=0;C<x;C++)F*=l;this.imuln(F),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},n.prototype.copy=function(s){s.words=new Array(this.length);for(var l=0;l<this.length;l++)s.words[l]=this.words[l];s.length=this.length,s.negative=this.negative,s.red=this.red},n.prototype.clone=function(){var s=new n(null);return this.copy(s),s},n.prototype._expand=function(s){for(;this.length<s;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(s,l){s=s||10,l=l|0||1;var d;if(s===16||s==="hex"){d="";for(var p=0,m=0,w=0;w<this.length;w++){var x=this.words[w],b=((x<<p|m)&16777215).toString(16);m=x>>>24-p&16777215,p+=2,p>=26&&(p-=26,w--),m!==0||w!==this.length-1?d=h[6-b.length]+b+d:d=b+d}for(m!==0&&(d=m.toString(16)+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}if(s===(s|0)&&s>=2&&s<=36){var f=g[s],C=y[s];d="";var F=this.clone();for(F.negative=0;!F.isZero();){var z=F.modn(C).toString(s);F=F.idivn(C),F.isZero()?d=z+d:d=h[f-z.length]+z+d}for(this.isZero()&&(d="0"+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var s=this.words[0];return this.length===2?s+=this.words[1]*67108864:this.length===3&&this.words[2]===1?s+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-s:s},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(s,l){return t(typeof c<"u"),this.toArrayLike(c,s,l)},n.prototype.toArray=function(s,l){return this.toArrayLike(Array,s,l)},n.prototype.toArrayLike=function(s,l,d){var p=this.byteLength(),m=d||Math.max(1,p);t(p<=m,"byte array longer than desired length"),t(m>0,"Requested array length <= 0"),this.strip();var w=l==="le",x=new s(m),b,f,C=this.clone();if(w){for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[f]=b;for(;f<m;f++)x[f]=0}else{for(f=0;f<m-p;f++)x[f]=0;for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[m-f-1]=b}return x},Math.clz32?n.prototype._countBits=function(s){return 32-Math.clz32(s)}:n.prototype._countBits=function(s){var l=s,d=0;return l>=4096&&(d+=13,l>>>=13),l>=64&&(d+=7,l>>>=7),l>=8&&(d+=4,l>>>=4),l>=2&&(d+=2,l>>>=2),d+l},n.prototype._zeroBits=function(s){if(s===0)return 26;var l=s,d=0;return l&8191||(d+=13,l>>>=13),l&127||(d+=7,l>>>=7),l&15||(d+=4,l>>>=4),l&3||(d+=2,l>>>=2),l&1||d++,d},n.prototype.bitLength=function(){var s=this.words[this.length-1],l=this._countBits(s);return(this.length-1)*26+l};function _(E){for(var s=new Array(E.bitLength()),l=0;l<s.length;l++){var d=l/26|0,p=l%26;s[l]=(E.words[d]&1<<p)>>>p}return s}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var s=0,l=0;l<this.length;l++){var d=this._zeroBits(this.words[l]);if(s+=d,d!==26)break}return s},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(s){return this.negative!==0?this.abs().inotn(s).iaddn(1):this.clone()},n.prototype.fromTwos=function(s){return this.testn(s-1)?this.notn(s).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(s){for(;this.length<s.length;)this.words[this.length++]=0;for(var l=0;l<s.length;l++)this.words[l]=this.words[l]|s.words[l];return this.strip()},n.prototype.ior=function(s){return t((this.negative|s.negative)===0),this.iuor(s)},n.prototype.or=function(s){return this.length>s.length?this.clone().ior(s):s.clone().ior(this)},n.prototype.uor=function(s){return this.length>s.length?this.clone().iuor(s):s.clone().iuor(this)},n.prototype.iuand=function(s){var l;this.length>s.length?l=s:l=this;for(var d=0;d<l.length;d++)this.words[d]=this.words[d]&s.words[d];return this.length=l.length,this.strip()},n.prototype.iand=function(s){return t((this.negative|s.negative)===0),this.iuand(s)},n.prototype.and=function(s){return this.length>s.length?this.clone().iand(s):s.clone().iand(this)},n.prototype.uand=function(s){return this.length>s.length?this.clone().iuand(s):s.clone().iuand(this)},n.prototype.iuxor=function(s){var l,d;this.length>s.length?(l=this,d=s):(l=s,d=this);for(var p=0;p<d.length;p++)this.words[p]=l.words[p]^d.words[p];if(this!==l)for(;p<l.length;p++)this.words[p]=l.words[p];return this.length=l.length,this.strip()},n.prototype.ixor=function(s){return t((this.negative|s.negative)===0),this.iuxor(s)},n.prototype.xor=function(s){return this.length>s.length?this.clone().ixor(s):s.clone().ixor(this)},n.prototype.uxor=function(s){return this.length>s.length?this.clone().iuxor(s):s.clone().iuxor(this)},n.prototype.inotn=function(s){t(typeof s=="number"&&s>=0);var l=Math.ceil(s/26)|0,d=s%26;this._expand(l),d>0&&l--;for(var p=0;p<l;p++)this.words[p]=~this.words[p]&67108863;return d>0&&(this.words[p]=~this.words[p]&67108863>>26-d),this.strip()},n.prototype.notn=function(s){return this.clone().inotn(s)},n.prototype.setn=function(s,l){t(typeof s=="number"&&s>=0);var d=s/26|0,p=s%26;return this._expand(d+1),l?this.words[d]=this.words[d]|1<<p:this.words[d]=this.words[d]&~(1<<p),this.strip()},n.prototype.iadd=function(s){var l;if(this.negative!==0&&s.negative===0)return this.negative=0,l=this.isub(s),this.negative^=1,this._normSign();if(this.negative===0&&s.negative!==0)return s.negative=0,l=this.isub(s),s.negative=1,l._normSign();var d,p;this.length>s.length?(d=this,p=s):(d=s,p=this);for(var m=0,w=0;w<p.length;w++)l=(d.words[w]|0)+(p.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;for(;m!==0&&w<d.length;w++)l=(d.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;if(this.length=d.length,m!==0)this.words[this.length]=m,this.length++;else if(d!==this)for(;w<d.length;w++)this.words[w]=d.words[w];return this},n.prototype.add=function(s){var l;return s.negative!==0&&this.negative===0?(s.negative=0,l=this.sub(s),s.negative^=1,l):s.negative===0&&this.negative!==0?(this.negative=0,l=s.sub(this),this.negative=1,l):this.length>s.length?this.clone().iadd(s):s.clone().iadd(this)},n.prototype.isub=function(s){if(s.negative!==0){s.negative=0;var l=this.iadd(s);return s.negative=1,l._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(s),this.negative=1,this._normSign();var d=this.cmp(s);if(d===0)return this.negative=0,this.length=1,this.words[0]=0,this;var p,m;d>0?(p=this,m=s):(p=s,m=this);for(var w=0,x=0;x<m.length;x++)l=(p.words[x]|0)-(m.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;for(;w!==0&&x<p.length;x++)l=(p.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;if(w===0&&x<p.length&&p!==this)for(;x<p.length;x++)this.words[x]=p.words[x];return this.length=Math.max(this.length,x),p!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(s){return this.clone().isub(s)};function A(E,s,l){l.negative=s.negative^E.negative;var d=E.length+s.length|0;l.length=d,d=d-1|0;var p=E.words[0]|0,m=s.words[0]|0,w=p*m,x=w&67108863,b=w/67108864|0;l.words[0]=x;for(var f=1;f<d;f++){for(var C=b>>>26,F=b&67108863,z=Math.min(f,s.length-1),W=Math.max(0,f-E.length+1);W<=z;W++){var $=f-W|0;p=E.words[$]|0,m=s.words[W]|0,w=p*m+F,C+=w/67108864|0,F=w&67108863}l.words[f]=F|0,b=C|0}return b!==0?l.words[f]=b|0:l.length--,l.strip()}var S=function(s,l,d){var p=s.words,m=l.words,w=d.words,x=0,b,f,C,F=p[0]|0,z=F&8191,W=F>>>13,$=p[1]|0,I=$&8191,K=$>>>13,N=p[2]|0,X=N&8191,Q=N>>>13,L=p[3]|0,V=L&8191,Z=L>>>13,H=p[4]|0,j=H&8191,et=H>>>13,nt=p[5]|0,st=nt&8191,ft=nt>>>13,vt=p[6]|0,ot=vt&8191,pt=vt>>>13,Ut=p[7]|0,At=Ut&8191,It=Ut>>>13,Jt=p[8]|0,at=Jt&8191,J=Jt>>>13,rt=p[9]|0,lt=rt&8191,gt=rt>>>13,Dt=m[0]|0,ut=Dt&8191,Y=Dt>>>13,tt=m[1]|0,dt=tt&8191,mt=tt>>>13,xt=m[2]|0,bt=xt&8191,_t=xt>>>13,Ht=m[3]|0,St=Ht&8191,Mt=Ht>>>13,jt=m[4]|0,Lt=jt&8191,Ft=jt>>>13,te=m[5]|0,Bt=te&8191,Ot=te>>>13,ie=m[6]|0,kt=ie&8191,qt=ie>>>13,ae=m[7]|0,Rt=ae&8191,zt=ae>>>13,he=m[8]|0,Vt=he&8191,Qt=he>>>13,ge=m[9]|0,Gt=ge&8191,$t=ge>>>13;d.negative=s.negative^l.negative,d.length=19,b=Math.imul(z,ut),f=Math.imul(z,Y),f=f+Math.imul(W,ut)|0,C=Math.imul(W,Y);var pe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(pe>>>26)|0,pe&=67108863,b=Math.imul(I,ut),f=Math.imul(I,Y),f=f+Math.imul(K,ut)|0,C=Math.imul(K,Y),b=b+Math.imul(z,dt)|0,f=f+Math.imul(z,mt)|0,f=f+Math.imul(W,dt)|0,C=C+Math.imul(W,mt)|0;var de=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(de>>>26)|0,de&=67108863,b=Math.imul(X,ut),f=Math.imul(X,Y),f=f+Math.imul(Q,ut)|0,C=Math.imul(Q,Y),b=b+Math.imul(I,dt)|0,f=f+Math.imul(I,mt)|0,f=f+Math.imul(K,dt)|0,C=C+Math.imul(K,mt)|0,b=b+Math.imul(z,bt)|0,f=f+Math.imul(z,_t)|0,f=f+Math.imul(W,bt)|0,C=C+Math.imul(W,_t)|0;var Ee=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,b=Math.imul(V,ut),f=Math.imul(V,Y),f=f+Math.imul(Z,ut)|0,C=Math.imul(Z,Y),b=b+Math.imul(X,dt)|0,f=f+Math.imul(X,mt)|0,f=f+Math.imul(Q,dt)|0,C=C+Math.imul(Q,mt)|0,b=b+Math.imul(I,bt)|0,f=f+Math.imul(I,_t)|0,f=f+Math.imul(K,bt)|0,C=C+Math.imul(K,_t)|0,b=b+Math.imul(z,St)|0,f=f+Math.imul(z,Mt)|0,f=f+Math.imul(W,St)|0,C=C+Math.imul(W,Mt)|0;var xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(xe>>>26)|0,xe&=67108863,b=Math.imul(j,ut),f=Math.imul(j,Y),f=f+Math.imul(et,ut)|0,C=Math.imul(et,Y),b=b+Math.imul(V,dt)|0,f=f+Math.imul(V,mt)|0,f=f+Math.imul(Z,dt)|0,C=C+Math.imul(Z,mt)|0,b=b+Math.imul(X,bt)|0,f=f+Math.imul(X,_t)|0,f=f+Math.imul(Q,bt)|0,C=C+Math.imul(Q,_t)|0,b=b+Math.imul(I,St)|0,f=f+Math.imul(I,Mt)|0,f=f+Math.imul(K,St)|0,C=C+Math.imul(K,Mt)|0,b=b+Math.imul(z,Lt)|0,f=f+Math.imul(z,Ft)|0,f=f+Math.imul(W,Lt)|0,C=C+Math.imul(W,Ft)|0;var Se=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Se>>>26)|0,Se&=67108863,b=Math.imul(st,ut),f=Math.imul(st,Y),f=f+Math.imul(ft,ut)|0,C=Math.imul(ft,Y),b=b+Math.imul(j,dt)|0,f=f+Math.imul(j,mt)|0,f=f+Math.imul(et,dt)|0,C=C+Math.imul(et,mt)|0,b=b+Math.imul(V,bt)|0,f=f+Math.imul(V,_t)|0,f=f+Math.imul(Z,bt)|0,C=C+Math.imul(Z,_t)|0,b=b+Math.imul(X,St)|0,f=f+Math.imul(X,Mt)|0,f=f+Math.imul(Q,St)|0,C=C+Math.imul(Q,Mt)|0,b=b+Math.imul(I,Lt)|0,f=f+Math.imul(I,Ft)|0,f=f+Math.imul(K,Lt)|0,C=C+Math.imul(K,Ft)|0,b=b+Math.imul(z,Bt)|0,f=f+Math.imul(z,Ot)|0,f=f+Math.imul(W,Bt)|0,C=C+Math.imul(W,Ot)|0;var Be=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Be>>>26)|0,Be&=67108863,b=Math.imul(ot,ut),f=Math.imul(ot,Y),f=f+Math.imul(pt,ut)|0,C=Math.imul(pt,Y),b=b+Math.imul(st,dt)|0,f=f+Math.imul(st,mt)|0,f=f+Math.imul(ft,dt)|0,C=C+Math.imul(ft,mt)|0,b=b+Math.imul(j,bt)|0,f=f+Math.imul(j,_t)|0,f=f+Math.imul(et,bt)|0,C=C+Math.imul(et,_t)|0,b=b+Math.imul(V,St)|0,f=f+Math.imul(V,Mt)|0,f=f+Math.imul(Z,St)|0,C=C+Math.imul(Z,Mt)|0,b=b+Math.imul(X,Lt)|0,f=f+Math.imul(X,Ft)|0,f=f+Math.imul(Q,Lt)|0,C=C+Math.imul(Q,Ft)|0,b=b+Math.imul(I,Bt)|0,f=f+Math.imul(I,Ot)|0,f=f+Math.imul(K,Bt)|0,C=C+Math.imul(K,Ot)|0,b=b+Math.imul(z,kt)|0,f=f+Math.imul(z,qt)|0,f=f+Math.imul(W,kt)|0,C=C+Math.imul(W,qt)|0;var Ne=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,b=Math.imul(At,ut),f=Math.imul(At,Y),f=f+Math.imul(It,ut)|0,C=Math.imul(It,Y),b=b+Math.imul(ot,dt)|0,f=f+Math.imul(ot,mt)|0,f=f+Math.imul(pt,dt)|0,C=C+Math.imul(pt,mt)|0,b=b+Math.imul(st,bt)|0,f=f+Math.imul(st,_t)|0,f=f+Math.imul(ft,bt)|0,C=C+Math.imul(ft,_t)|0,b=b+Math.imul(j,St)|0,f=f+Math.imul(j,Mt)|0,f=f+Math.imul(et,St)|0,C=C+Math.imul(et,Mt)|0,b=b+Math.imul(V,Lt)|0,f=f+Math.imul(V,Ft)|0,f=f+Math.imul(Z,Lt)|0,C=C+Math.imul(Z,Ft)|0,b=b+Math.imul(X,Bt)|0,f=f+Math.imul(X,Ot)|0,f=f+Math.imul(Q,Bt)|0,C=C+Math.imul(Q,Ot)|0,b=b+Math.imul(I,kt)|0,f=f+Math.imul(I,qt)|0,f=f+Math.imul(K,kt)|0,C=C+Math.imul(K,qt)|0,b=b+Math.imul(z,Rt)|0,f=f+Math.imul(z,zt)|0,f=f+Math.imul(W,Rt)|0,C=C+Math.imul(W,zt)|0;var qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(qe>>>26)|0,qe&=67108863,b=Math.imul(at,ut),f=Math.imul(at,Y),f=f+Math.imul(J,ut)|0,C=Math.imul(J,Y),b=b+Math.imul(At,dt)|0,f=f+Math.imul(At,mt)|0,f=f+Math.imul(It,dt)|0,C=C+Math.imul(It,mt)|0,b=b+Math.imul(ot,bt)|0,f=f+Math.imul(ot,_t)|0,f=f+Math.imul(pt,bt)|0,C=C+Math.imul(pt,_t)|0,b=b+Math.imul(st,St)|0,f=f+Math.imul(st,Mt)|0,f=f+Math.imul(ft,St)|0,C=C+Math.imul(ft,Mt)|0,b=b+Math.imul(j,Lt)|0,f=f+Math.imul(j,Ft)|0,f=f+Math.imul(et,Lt)|0,C=C+Math.imul(et,Ft)|0,b=b+Math.imul(V,Bt)|0,f=f+Math.imul(V,Ot)|0,f=f+Math.imul(Z,Bt)|0,C=C+Math.imul(Z,Ot)|0,b=b+Math.imul(X,kt)|0,f=f+Math.imul(X,qt)|0,f=f+Math.imul(Q,kt)|0,C=C+Math.imul(Q,qt)|0,b=b+Math.imul(I,Rt)|0,f=f+Math.imul(I,zt)|0,f=f+Math.imul(K,Rt)|0,C=C+Math.imul(K,zt)|0,b=b+Math.imul(z,Vt)|0,f=f+Math.imul(z,Qt)|0,f=f+Math.imul(W,Vt)|0,C=C+Math.imul(W,Qt)|0;var Xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,b=Math.imul(lt,ut),f=Math.imul(lt,Y),f=f+Math.imul(gt,ut)|0,C=Math.imul(gt,Y),b=b+Math.imul(at,dt)|0,f=f+Math.imul(at,mt)|0,f=f+Math.imul(J,dt)|0,C=C+Math.imul(J,mt)|0,b=b+Math.imul(At,bt)|0,f=f+Math.imul(At,_t)|0,f=f+Math.imul(It,bt)|0,C=C+Math.imul(It,_t)|0,b=b+Math.imul(ot,St)|0,f=f+Math.imul(ot,Mt)|0,f=f+Math.imul(pt,St)|0,C=C+Math.imul(pt,Mt)|0,b=b+Math.imul(st,Lt)|0,f=f+Math.imul(st,Ft)|0,f=f+Math.imul(ft,Lt)|0,C=C+Math.imul(ft,Ft)|0,b=b+Math.imul(j,Bt)|0,f=f+Math.imul(j,Ot)|0,f=f+Math.imul(et,Bt)|0,C=C+Math.imul(et,Ot)|0,b=b+Math.imul(V,kt)|0,f=f+Math.imul(V,qt)|0,f=f+Math.imul(Z,kt)|0,C=C+Math.imul(Z,qt)|0,b=b+Math.imul(X,Rt)|0,f=f+Math.imul(X,zt)|0,f=f+Math.imul(Q,Rt)|0,C=C+Math.imul(Q,zt)|0,b=b+Math.imul(I,Vt)|0,f=f+Math.imul(I,Qt)|0,f=f+Math.imul(K,Vt)|0,C=C+Math.imul(K,Qt)|0,b=b+Math.imul(z,Gt)|0,f=f+Math.imul(z,$t)|0,f=f+Math.imul(W,Gt)|0,C=C+Math.imul(W,$t)|0;var Ge=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,b=Math.imul(lt,dt),f=Math.imul(lt,mt),f=f+Math.imul(gt,dt)|0,C=Math.imul(gt,mt),b=b+Math.imul(at,bt)|0,f=f+Math.imul(at,_t)|0,f=f+Math.imul(J,bt)|0,C=C+Math.imul(J,_t)|0,b=b+Math.imul(At,St)|0,f=f+Math.imul(At,Mt)|0,f=f+Math.imul(It,St)|0,C=C+Math.imul(It,Mt)|0,b=b+Math.imul(ot,Lt)|0,f=f+Math.imul(ot,Ft)|0,f=f+Math.imul(pt,Lt)|0,C=C+Math.imul(pt,Ft)|0,b=b+Math.imul(st,Bt)|0,f=f+Math.imul(st,Ot)|0,f=f+Math.imul(ft,Bt)|0,C=C+Math.imul(ft,Ot)|0,b=b+Math.imul(j,kt)|0,f=f+Math.imul(j,qt)|0,f=f+Math.imul(et,kt)|0,C=C+Math.imul(et,qt)|0,b=b+Math.imul(V,Rt)|0,f=f+Math.imul(V,zt)|0,f=f+Math.imul(Z,Rt)|0,C=C+Math.imul(Z,zt)|0,b=b+Math.imul(X,Vt)|0,f=f+Math.imul(X,Qt)|0,f=f+Math.imul(Q,Vt)|0,C=C+Math.imul(Q,Qt)|0,b=b+Math.imul(I,Gt)|0,f=f+Math.imul(I,$t)|0,f=f+Math.imul(K,Gt)|0,C=C+Math.imul(K,$t)|0;var Je=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Je>>>26)|0,Je&=67108863,b=Math.imul(lt,bt),f=Math.imul(lt,_t),f=f+Math.imul(gt,bt)|0,C=Math.imul(gt,_t),b=b+Math.imul(at,St)|0,f=f+Math.imul(at,Mt)|0,f=f+Math.imul(J,St)|0,C=C+Math.imul(J,Mt)|0,b=b+Math.imul(At,Lt)|0,f=f+Math.imul(At,Ft)|0,f=f+Math.imul(It,Lt)|0,C=C+Math.imul(It,Ft)|0,b=b+Math.imul(ot,Bt)|0,f=f+Math.imul(ot,Ot)|0,f=f+Math.imul(pt,Bt)|0,C=C+Math.imul(pt,Ot)|0,b=b+Math.imul(st,kt)|0,f=f+Math.imul(st,qt)|0,f=f+Math.imul(ft,kt)|0,C=C+Math.imul(ft,qt)|0,b=b+Math.imul(j,Rt)|0,f=f+Math.imul(j,zt)|0,f=f+Math.imul(et,Rt)|0,C=C+Math.imul(et,zt)|0,b=b+Math.imul(V,Vt)|0,f=f+Math.imul(V,Qt)|0,f=f+Math.imul(Z,Vt)|0,C=C+Math.imul(Z,Qt)|0,b=b+Math.imul(X,Gt)|0,f=f+Math.imul(X,$t)|0,f=f+Math.imul(Q,Gt)|0,C=C+Math.imul(Q,$t)|0;var ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ze>>>26)|0,ze&=67108863,b=Math.imul(lt,St),f=Math.imul(lt,Mt),f=f+Math.imul(gt,St)|0,C=Math.imul(gt,Mt),b=b+Math.imul(at,Lt)|0,f=f+Math.imul(at,Ft)|0,f=f+Math.imul(J,Lt)|0,C=C+Math.imul(J,Ft)|0,b=b+Math.imul(At,Bt)|0,f=f+Math.imul(At,Ot)|0,f=f+Math.imul(It,Bt)|0,C=C+Math.imul(It,Ot)|0,b=b+Math.imul(ot,kt)|0,f=f+Math.imul(ot,qt)|0,f=f+Math.imul(pt,kt)|0,C=C+Math.imul(pt,qt)|0,b=b+Math.imul(st,Rt)|0,f=f+Math.imul(st,zt)|0,f=f+Math.imul(ft,Rt)|0,C=C+Math.imul(ft,zt)|0,b=b+Math.imul(j,Vt)|0,f=f+Math.imul(j,Qt)|0,f=f+Math.imul(et,Vt)|0,C=C+Math.imul(et,Qt)|0,b=b+Math.imul(V,Gt)|0,f=f+Math.imul(V,$t)|0,f=f+Math.imul(Z,Gt)|0,C=C+Math.imul(Z,$t)|0;var rr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(rr>>>26)|0,rr&=67108863,b=Math.imul(lt,Lt),f=Math.imul(lt,Ft),f=f+Math.imul(gt,Lt)|0,C=Math.imul(gt,Ft),b=b+Math.imul(at,Bt)|0,f=f+Math.imul(at,Ot)|0,f=f+Math.imul(J,Bt)|0,C=C+Math.imul(J,Ot)|0,b=b+Math.imul(At,kt)|0,f=f+Math.imul(At,qt)|0,f=f+Math.imul(It,kt)|0,C=C+Math.imul(It,qt)|0,b=b+Math.imul(ot,Rt)|0,f=f+Math.imul(ot,zt)|0,f=f+Math.imul(pt,Rt)|0,C=C+Math.imul(pt,zt)|0,b=b+Math.imul(st,Vt)|0,f=f+Math.imul(st,Qt)|0,f=f+Math.imul(ft,Vt)|0,C=C+Math.imul(ft,Qt)|0,b=b+Math.imul(j,Gt)|0,f=f+Math.imul(j,$t)|0,f=f+Math.imul(et,Gt)|0,C=C+Math.imul(et,$t)|0;var Qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,b=Math.imul(lt,Bt),f=Math.imul(lt,Ot),f=f+Math.imul(gt,Bt)|0,C=Math.imul(gt,Ot),b=b+Math.imul(at,kt)|0,f=f+Math.imul(at,qt)|0,f=f+Math.imul(J,kt)|0,C=C+Math.imul(J,qt)|0,b=b+Math.imul(At,Rt)|0,f=f+Math.imul(At,zt)|0,f=f+Math.imul(It,Rt)|0,C=C+Math.imul(It,zt)|0,b=b+Math.imul(ot,Vt)|0,f=f+Math.imul(ot,Qt)|0,f=f+Math.imul(pt,Vt)|0,C=C+Math.imul(pt,Qt)|0,b=b+Math.imul(st,Gt)|0,f=f+Math.imul(st,$t)|0,f=f+Math.imul(ft,Gt)|0,C=C+Math.imul(ft,$t)|0;var Le=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Le>>>26)|0,Le&=67108863,b=Math.imul(lt,kt),f=Math.imul(lt,qt),f=f+Math.imul(gt,kt)|0,C=Math.imul(gt,qt),b=b+Math.imul(at,Rt)|0,f=f+Math.imul(at,zt)|0,f=f+Math.imul(J,Rt)|0,C=C+Math.imul(J,zt)|0,b=b+Math.imul(At,Vt)|0,f=f+Math.imul(At,Qt)|0,f=f+Math.imul(It,Vt)|0,C=C+Math.imul(It,Qt)|0,b=b+Math.imul(ot,Gt)|0,f=f+Math.imul(ot,$t)|0,f=f+Math.imul(pt,Gt)|0,C=C+Math.imul(pt,$t)|0;var ir=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ir>>>26)|0,ir&=67108863,b=Math.imul(lt,Rt),f=Math.imul(lt,zt),f=f+Math.imul(gt,Rt)|0,C=Math.imul(gt,zt),b=b+Math.imul(at,Vt)|0,f=f+Math.imul(at,Qt)|0,f=f+Math.imul(J,Vt)|0,C=C+Math.imul(J,Qt)|0,b=b+Math.imul(At,Gt)|0,f=f+Math.imul(At,$t)|0,f=f+Math.imul(It,Gt)|0,C=C+Math.imul(It,$t)|0;var nr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(nr>>>26)|0,nr&=67108863,b=Math.imul(lt,Vt),f=Math.imul(lt,Qt),f=f+Math.imul(gt,Vt)|0,C=Math.imul(gt,Qt),b=b+Math.imul(at,Gt)|0,f=f+Math.imul(at,$t)|0,f=f+Math.imul(J,Gt)|0,C=C+Math.imul(J,$t)|0;var Ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,b=Math.imul(lt,Gt),f=Math.imul(lt,$t),f=f+Math.imul(gt,Gt)|0,C=Math.imul(gt,$t);var ar=(x+b|0)+((f&8191)<<13)|0;return x=(C+(f>>>13)|0)+(ar>>>26)|0,ar&=67108863,w[0]=pe,w[1]=de,w[2]=Ee,w[3]=xe,w[4]=Se,w[5]=Be,w[6]=Ne,w[7]=qe,w[8]=Xe,w[9]=Ge,w[10]=Je,w[11]=ze,w[12]=rr,w[13]=Qe,w[14]=Le,w[15]=ir,w[16]=nr,w[17]=Ze,w[18]=ar,x!==0&&(w[19]=x,d.length++),d};Math.imul||(S=A);function T(E,s,l){l.negative=s.negative^E.negative,l.length=E.length+s.length;for(var d=0,p=0,m=0;m<l.length-1;m++){var w=p;p=0;for(var x=d&67108863,b=Math.min(m,s.length-1),f=Math.max(0,m-E.length+1);f<=b;f++){var C=m-f,F=E.words[C]|0,z=s.words[f]|0,W=F*z,$=W&67108863;w=w+(W/67108864|0)|0,$=$+x|0,x=$&67108863,w=w+($>>>26)|0,p+=w>>>26,w&=67108863}l.words[m]=x,d=w,w=p}return d!==0?l.words[m]=d:l.length--,l.strip()}function B(E,s,l){var d=new M;return d.mulp(E,s,l)}n.prototype.mulTo=function(s,l){var d,p=this.length+s.length;return this.length===10&&s.length===10?d=S(this,s,l):p<63?d=A(this,s,l):p<1024?d=T(this,s,l):d=B(this,s,l),d};function M(E,s){this.x=E,this.y=s}M.prototype.makeRBT=function(s){for(var l=new Array(s),d=n.prototype._countBits(s)-1,p=0;p<s;p++)l[p]=this.revBin(p,d,s);return l},M.prototype.revBin=function(s,l,d){if(s===0||s===d-1)return s;for(var p=0,m=0;m<l;m++)p|=(s&1)<<l-m-1,s>>=1;return p},M.prototype.permute=function(s,l,d,p,m,w){for(var x=0;x<w;x++)p[x]=l[s[x]],m[x]=d[s[x]]},M.prototype.transform=function(s,l,d,p,m,w){this.permute(w,s,l,d,p,m);for(var x=1;x<m;x<<=1)for(var b=x<<1,f=Math.cos(2*Math.PI/b),C=Math.sin(2*Math.PI/b),F=0;F<m;F+=b)for(var z=f,W=C,$=0;$<x;$++){var I=d[F+$],K=p[F+$],N=d[F+$+x],X=p[F+$+x],Q=z*N-W*X;X=z*X+W*N,N=Q,d[F+$]=I+N,p[F+$]=K+X,d[F+$+x]=I-N,p[F+$+x]=K-X,$!==b&&(Q=f*z-C*W,W=f*W+C*z,z=Q)}},M.prototype.guessLen13b=function(s,l){var d=Math.max(l,s)|1,p=d&1,m=0;for(d=d/2|0;d;d=d>>>1)m++;return 1<<m+1+p},M.prototype.conjugate=function(s,l,d){if(!(d<=1))for(var p=0;p<d/2;p++){var m=s[p];s[p]=s[d-p-1],s[d-p-1]=m,m=l[p],l[p]=-l[d-p-1],l[d-p-1]=-m}},M.prototype.normalize13b=function(s,l){for(var d=0,p=0;p<l/2;p++){var m=Math.round(s[2*p+1]/l)*8192+Math.round(s[2*p]/l)+d;s[p]=m&67108863,m<67108864?d=0:d=m/67108864|0}return s},M.prototype.convert13b=function(s,l,d,p){for(var m=0,w=0;w<l;w++)m=m+(s[w]|0),d[2*w]=m&8191,m=m>>>13,d[2*w+1]=m&8191,m=m>>>13;for(w=2*l;w<p;++w)d[w]=0;t(m===0),t((m&-8192)===0)},M.prototype.stub=function(s){for(var l=new Array(s),d=0;d<s;d++)l[d]=0;return l},M.prototype.mulp=function(s,l,d){var p=2*this.guessLen13b(s.length,l.length),m=this.makeRBT(p),w=this.stub(p),x=new Array(p),b=new Array(p),f=new Array(p),C=new Array(p),F=new Array(p),z=new Array(p),W=d.words;W.length=p,this.convert13b(s.words,s.length,x,p),this.convert13b(l.words,l.length,C,p),this.transform(x,w,b,f,p,m),this.transform(C,w,F,z,p,m);for(var $=0;$<p;$++){var I=b[$]*F[$]-f[$]*z[$];f[$]=b[$]*z[$]+f[$]*F[$],b[$]=I}return this.conjugate(b,f,p),this.transform(b,f,W,w,p,m),this.conjugate(W,w,p),this.normalize13b(W,p),d.negative=s.negative^l.negative,d.length=s.length+l.length,d.strip()},n.prototype.mul=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),this.mulTo(s,l)},n.prototype.mulf=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),B(this,s,l)},n.prototype.imul=function(s){return this.clone().mulTo(s,this)},n.prototype.imuln=function(s){t(typeof s=="number"),t(s<67108864);for(var l=0,d=0;d<this.length;d++){var p=(this.words[d]|0)*s,m=(p&67108863)+(l&67108863);l>>=26,l+=p/67108864|0,l+=m>>>26,this.words[d]=m&67108863}return l!==0&&(this.words[d]=l,this.length++),this},n.prototype.muln=function(s){return this.clone().imuln(s)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(s){var l=_(s);if(l.length===0)return new n(1);for(var d=this,p=0;p<l.length&&l[p]===0;p++,d=d.sqr());if(++p<l.length)for(var m=d.sqr();p<l.length;p++,m=m.sqr())l[p]!==0&&(d=d.mul(m));return d},n.prototype.iushln=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=67108863>>>26-l<<26-l,m;if(l!==0){var w=0;for(m=0;m<this.length;m++){var x=this.words[m]&p,b=(this.words[m]|0)-x<<l;this.words[m]=b|w,w=x>>>26-l}w&&(this.words[m]=w,this.length++)}if(d!==0){for(m=this.length-1;m>=0;m--)this.words[m+d]=this.words[m];for(m=0;m<d;m++)this.words[m]=0;this.length+=d}return this.strip()},n.prototype.ishln=function(s){return t(this.negative===0),this.iushln(s)},n.prototype.iushrn=function(s,l,d){t(typeof s=="number"&&s>=0);var p;l?p=(l-l%26)/26:p=0;var m=s%26,w=Math.min((s-m)/26,this.length),x=67108863^67108863>>>m<<m,b=d;if(p-=w,p=Math.max(0,p),b){for(var f=0;f<w;f++)b.words[f]=this.words[f];b.length=w}if(w!==0)if(this.length>w)for(this.length-=w,f=0;f<this.length;f++)this.words[f]=this.words[f+w];else this.words[0]=0,this.length=1;var C=0;for(f=this.length-1;f>=0&&(C!==0||f>=p);f--){var F=this.words[f]|0;this.words[f]=C<<26-m|F>>>m,C=F&x}return b&&C!==0&&(b.words[b.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(s,l,d){return t(this.negative===0),this.iushrn(s,l,d)},n.prototype.shln=function(s){return this.clone().ishln(s)},n.prototype.ushln=function(s){return this.clone().iushln(s)},n.prototype.shrn=function(s){return this.clone().ishrn(s)},n.prototype.ushrn=function(s){return this.clone().iushrn(s)},n.prototype.testn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return!1;var m=this.words[d];return!!(m&p)},n.prototype.imaskn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=d)return this;if(l!==0&&d++,this.length=Math.min(d,this.length),l!==0){var p=67108863^67108863>>>l<<l;this.words[this.length-1]&=p}return this.strip()},n.prototype.maskn=function(s){return this.clone().imaskn(s)},n.prototype.iaddn=function(s){return t(typeof s=="number"),t(s<67108864),s<0?this.isubn(-s):this.negative!==0?this.length===1&&(this.words[0]|0)<s?(this.words[0]=s-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(s),this.negative=1,this):this._iaddn(s)},n.prototype._iaddn=function(s){this.words[0]+=s;for(var l=0;l<this.length&&this.words[l]>=67108864;l++)this.words[l]-=67108864,l===this.length-1?this.words[l+1]=1:this.words[l+1]++;return this.length=Math.max(this.length,l+1),this},n.prototype.isubn=function(s){if(t(typeof s=="number"),t(s<67108864),s<0)return this.iaddn(-s);if(this.negative!==0)return this.negative=0,this.iaddn(s),this.negative=1,this;if(this.words[0]-=s,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var l=0;l<this.length&&this.words[l]<0;l++)this.words[l]+=67108864,this.words[l+1]-=1;return this.strip()},n.prototype.addn=function(s){return this.clone().iaddn(s)},n.prototype.subn=function(s){return this.clone().isubn(s)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(s,l,d){var p=s.length+d,m;this._expand(p);var w,x=0;for(m=0;m<s.length;m++){w=(this.words[m+d]|0)+x;var b=(s.words[m]|0)*l;w-=b&67108863,x=(w>>26)-(b/67108864|0),this.words[m+d]=w&67108863}for(;m<this.length-d;m++)w=(this.words[m+d]|0)+x,x=w>>26,this.words[m+d]=w&67108863;if(x===0)return this.strip();for(t(x===-1),x=0,m=0;m<this.length;m++)w=-(this.words[m]|0)+x,x=w>>26,this.words[m]=w&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(s,l){var d=this.length-s.length,p=this.clone(),m=s,w=m.words[m.length-1]|0,x=this._countBits(w);d=26-x,d!==0&&(m=m.ushln(d),p.iushln(d),w=m.words[m.length-1]|0);var b=p.length-m.length,f;if(l!=="mod"){f=new n(null),f.length=b+1,f.words=new Array(f.length);for(var C=0;C<f.length;C++)f.words[C]=0}var F=p.clone()._ishlnsubmul(m,1,b);F.negative===0&&(p=F,f&&(f.words[b]=1));for(var z=b-1;z>=0;z--){var W=(p.words[m.length+z]|0)*67108864+(p.words[m.length+z-1]|0);for(W=Math.min(W/w|0,67108863),p._ishlnsubmul(m,W,z);p.negative!==0;)W--,p.negative=0,p._ishlnsubmul(m,1,z),p.isZero()||(p.negative^=1);f&&(f.words[z]=W)}return f&&f.strip(),p.strip(),l!=="div"&&d!==0&&p.iushrn(d),{div:f||null,mod:p}},n.prototype.divmod=function(s,l,d){if(t(!s.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var p,m,w;return this.negative!==0&&s.negative===0?(w=this.neg().divmod(s,l),l!=="mod"&&(p=w.div.neg()),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.iadd(s)),{div:p,mod:m}):this.negative===0&&s.negative!==0?(w=this.divmod(s.neg(),l),l!=="mod"&&(p=w.div.neg()),{div:p,mod:w.mod}):this.negative&s.negative?(w=this.neg().divmod(s.neg(),l),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.isub(s)),{div:w.div,mod:m}):s.length>this.length||this.cmp(s)<0?{div:new n(0),mod:this}:s.length===1?l==="div"?{div:this.divn(s.words[0]),mod:null}:l==="mod"?{div:null,mod:new n(this.modn(s.words[0]))}:{div:this.divn(s.words[0]),mod:new n(this.modn(s.words[0]))}:this._wordDiv(s,l)},n.prototype.div=function(s){return this.divmod(s,"div",!1).div},n.prototype.mod=function(s){return this.divmod(s,"mod",!1).mod},n.prototype.umod=function(s){return this.divmod(s,"mod",!0).mod},n.prototype.divRound=function(s){var l=this.divmod(s);if(l.mod.isZero())return l.div;var d=l.div.negative!==0?l.mod.isub(s):l.mod,p=s.ushrn(1),m=s.andln(1),w=d.cmp(p);return w<0||m===1&&w===0?l.div:l.div.negative!==0?l.div.isubn(1):l.div.iaddn(1)},n.prototype.modn=function(s){t(s<=67108863);for(var l=(1<<26)%s,d=0,p=this.length-1;p>=0;p--)d=(l*d+(this.words[p]|0))%s;return d},n.prototype.idivn=function(s){t(s<=67108863);for(var l=0,d=this.length-1;d>=0;d--){var p=(this.words[d]|0)+l*67108864;this.words[d]=p/s|0,l=p%s}return this.strip()},n.prototype.divn=function(s){return this.clone().idivn(s)},n.prototype.egcd=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=new n(0),x=new n(1),b=0;l.isEven()&&d.isEven();)l.iushrn(1),d.iushrn(1),++b;for(var f=d.clone(),C=l.clone();!l.isZero();){for(var F=0,z=1;!(l.words[0]&z)&&F<26;++F,z<<=1);if(F>0)for(l.iushrn(F);F-- >0;)(p.isOdd()||m.isOdd())&&(p.iadd(f),m.isub(C)),p.iushrn(1),m.iushrn(1);for(var W=0,$=1;!(d.words[0]&$)&&W<26;++W,$<<=1);if(W>0)for(d.iushrn(W);W-- >0;)(w.isOdd()||x.isOdd())&&(w.iadd(f),x.isub(C)),w.iushrn(1),x.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(w),m.isub(x)):(d.isub(l),w.isub(p),x.isub(m))}return{a:w,b:x,gcd:d.iushln(b)}},n.prototype._invmp=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=d.clone();l.cmpn(1)>0&&d.cmpn(1)>0;){for(var x=0,b=1;!(l.words[0]&b)&&x<26;++x,b<<=1);if(x>0)for(l.iushrn(x);x-- >0;)p.isOdd()&&p.iadd(w),p.iushrn(1);for(var f=0,C=1;!(d.words[0]&C)&&f<26;++f,C<<=1);if(f>0)for(d.iushrn(f);f-- >0;)m.isOdd()&&m.iadd(w),m.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(m)):(d.isub(l),m.isub(p))}var F;return l.cmpn(1)===0?F=p:F=m,F.cmpn(0)<0&&F.iadd(s),F},n.prototype.gcd=function(s){if(this.isZero())return s.abs();if(s.isZero())return this.abs();var l=this.clone(),d=s.clone();l.negative=0,d.negative=0;for(var p=0;l.isEven()&&d.isEven();p++)l.iushrn(1),d.iushrn(1);do{for(;l.isEven();)l.iushrn(1);for(;d.isEven();)d.iushrn(1);var m=l.cmp(d);if(m<0){var w=l;l=d,d=w}else if(m===0||d.cmpn(1)===0)break;l.isub(d)}while(!0);return d.iushln(p)},n.prototype.invm=function(s){return this.egcd(s).a.umod(s)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(s){return this.words[0]&s},n.prototype.bincn=function(s){t(typeof s=="number");var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return this._expand(d+1),this.words[d]|=p,this;for(var m=p,w=d;m!==0&&w<this.length;w++){var x=this.words[w]|0;x+=m,m=x>>>26,x&=67108863,this.words[w]=x}return m!==0&&(this.words[w]=m,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(s){var l=s<0;if(this.negative!==0&&!l)return-1;if(this.negative===0&&l)return 1;this.strip();var d;if(this.length>1)d=1;else{l&&(s=-s),t(s<=67108863,"Number is too big");var p=this.words[0]|0;d=p===s?0:p<s?-1:1}return this.negative!==0?-d|0:d},n.prototype.cmp=function(s){if(this.negative!==0&&s.negative===0)return-1;if(this.negative===0&&s.negative!==0)return 1;var l=this.ucmp(s);return this.negative!==0?-l|0:l},n.prototype.ucmp=function(s){if(this.length>s.length)return 1;if(this.length<s.length)return-1;for(var l=0,d=this.length-1;d>=0;d--){var p=this.words[d]|0,m=s.words[d]|0;if(p!==m){p<m?l=-1:p>m&&(l=1);break}}return l},n.prototype.gtn=function(s){return this.cmpn(s)===1},n.prototype.gt=function(s){return this.cmp(s)===1},n.prototype.gten=function(s){return this.cmpn(s)>=0},n.prototype.gte=function(s){return this.cmp(s)>=0},n.prototype.ltn=function(s){return this.cmpn(s)===-1},n.prototype.lt=function(s){return this.cmp(s)===-1},n.prototype.lten=function(s){return this.cmpn(s)<=0},n.prototype.lte=function(s){return this.cmp(s)<=0},n.prototype.eqn=function(s){return this.cmpn(s)===0},n.prototype.eq=function(s){return this.cmp(s)===0},n.red=function(s){return new O(s)},n.prototype.toRed=function(s){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),s.convertTo(this)._forceRed(s)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(s){return this.red=s,this},n.prototype.forceRed=function(s){return t(!this.red,"Already a number in reduction context"),this._forceRed(s)},n.prototype.redAdd=function(s){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,s)},n.prototype.redIAdd=function(s){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,s)},n.prototype.redSub=function(s){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,s)},n.prototype.redISub=function(s){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,s)},n.prototype.redShl=function(s){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,s)},n.prototype.redMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.mul(this,s)},n.prototype.redIMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.imul(this,s)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(s){return t(this.red&&!s.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,s)};var R={k256:null,p224:null,p192:null,p25519:null};function P(E,s){this.name=E,this.p=new n(s,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}P.prototype._tmp=function(){var s=new n(null);return s.words=new Array(Math.ceil(this.n/13)),s},P.prototype.ireduce=function(s){var l=s,d;do this.split(l,this.tmp),l=this.imulK(l),l=l.iadd(this.tmp),d=l.bitLength();while(d>this.n);var p=d<this.n?-1:l.ucmp(this.p);return p===0?(l.words[0]=0,l.length=1):p>0?l.isub(this.p):l.strip!==void 0?l.strip():l._strip(),l},P.prototype.split=function(s,l){s.iushrn(this.n,0,l)},P.prototype.imulK=function(s){return s.imul(this.k)};function D(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(D,P),D.prototype.split=function(s,l){for(var d=4194303,p=Math.min(s.length,9),m=0;m<p;m++)l.words[m]=s.words[m];if(l.length=p,s.length<=9){s.words[0]=0,s.length=1;return}var w=s.words[9];for(l.words[l.length++]=w&d,m=10;m<s.length;m++){var x=s.words[m]|0;s.words[m-10]=(x&d)<<4|w>>>22,w=x}w>>>=22,s.words[m-10]=w,w===0&&s.length>10?s.length-=10:s.length-=9},D.prototype.imulK=function(s){s.words[s.length]=0,s.words[s.length+1]=0,s.length+=2;for(var l=0,d=0;d<s.length;d++){var p=s.words[d]|0;l+=p*977,s.words[d]=l&67108863,l=p*64+(l/67108864|0)}return s.words[s.length-1]===0&&(s.length--,s.words[s.length-1]===0&&s.length--),s};function q(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(q,P);function k(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(k,P);function U(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(U,P),U.prototype.imulK=function(s){for(var l=0,d=0;d<s.length;d++){var p=(s.words[d]|0)*19+l,m=p&67108863;p>>>=26,s.words[d]=m,l=p}return l!==0&&(s.words[s.length++]=l),s},n._prime=function(s){if(R[s])return R[s];var l;if(s==="k256")l=new D;else if(s==="p224")l=new q;else if(s==="p192")l=new k;else if(s==="p25519")l=new U;else throw new Error("Unknown prime "+s);return R[s]=l,l};function O(E){if(typeof E=="string"){var s=n._prime(E);this.m=s.p,this.prime=s}else t(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}O.prototype._verify1=function(s){t(s.negative===0,"red works only with positives"),t(s.red,"red works only with red numbers")},O.prototype._verify2=function(s,l){t((s.negative|l.negative)===0,"red works only with positives"),t(s.red&&s.red===l.red,"red works only with red numbers")},O.prototype.imod=function(s){return this.prime?this.prime.ireduce(s)._forceRed(this):s.umod(this.m)._forceRed(this)},O.prototype.neg=function(s){return s.isZero()?s.clone():this.m.sub(s)._forceRed(this)},O.prototype.add=function(s,l){this._verify2(s,l);var d=s.add(l);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},O.prototype.iadd=function(s,l){this._verify2(s,l);var d=s.iadd(l);return d.cmp(this.m)>=0&&d.isub(this.m),d},O.prototype.sub=function(s,l){this._verify2(s,l);var d=s.sub(l);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},O.prototype.isub=function(s,l){this._verify2(s,l);var d=s.isub(l);return d.cmpn(0)<0&&d.iadd(this.m),d},O.prototype.shl=function(s,l){return this._verify1(s),this.imod(s.ushln(l))},O.prototype.imul=function(s,l){return this._verify2(s,l),this.imod(s.imul(l))},O.prototype.mul=function(s,l){return this._verify2(s,l),this.imod(s.mul(l))},O.prototype.isqr=function(s){return this.imul(s,s.clone())},O.prototype.sqr=function(s){return this.mul(s,s)},O.prototype.sqrt=function(s){if(s.isZero())return s.clone();var l=this.m.andln(3);if(t(l%2===1),l===3){var d=this.m.add(new n(1)).iushrn(2);return this.pow(s,d)}for(var p=this.m.subn(1),m=0;!p.isZero()&&p.andln(1)===0;)m++,p.iushrn(1);t(!p.isZero());var w=new n(1).toRed(this),x=w.redNeg(),b=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new n(2*f*f).toRed(this);this.pow(f,b).cmp(x)!==0;)f.redIAdd(x);for(var C=this.pow(f,p),F=this.pow(s,p.addn(1).iushrn(1)),z=this.pow(s,p),W=m;z.cmp(w)!==0;){for(var $=z,I=0;$.cmp(w)!==0;I++)$=$.redSqr();t(I<W);var K=this.pow(C,new n(1).iushln(W-I-1));F=F.redMul(K),C=K.redSqr(),z=z.redMul(C),W=I}return F},O.prototype.invm=function(s){var l=s._invmp(this.m);return l.negative!==0?(l.negative=0,this.imod(l).redNeg()):this.imod(l)},O.prototype.pow=function(s,l){if(l.isZero())return new n(1).toRed(this);if(l.cmpn(1)===0)return s.clone();var d=4,p=new Array(1<<d);p[0]=new n(1).toRed(this),p[1]=s;for(var m=2;m<p.length;m++)p[m]=this.mul(p[m-1],s);var w=p[0],x=0,b=0,f=l.bitLength()%26;for(f===0&&(f=26),m=l.length-1;m>=0;m--){for(var C=l.words[m],F=f-1;F>=0;F--){var z=C>>F&1;if(w!==p[0]&&(w=this.sqr(w)),z===0&&x===0){b=0;continue}x<<=1,x|=z,b++,!(b!==d&&(m!==0||F!==0))&&(w=this.mul(w,p[x]),b=0,x=0)}f=26}return w},O.prototype.convertTo=function(s){var l=s.umod(this.m);return l===s?l.clone():l},O.prototype.convertFrom=function(s){var l=s.clone();return l.red=null,l},n.mont=function(s){return new G(s)};function G(E){O.call(this,E),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(G,O),G.prototype.convertTo=function(s){return this.imod(s.ushln(this.shift))},G.prototype.convertFrom=function(s){var l=this.imod(s.mul(this.rinv));return l.red=null,l},G.prototype.imul=function(s,l){if(s.isZero()||l.isZero())return s.words[0]=0,s.length=1,s;var d=s.imul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.mul=function(s,l){if(s.isZero()||l.isZero())return new n(0)._forceRed(this);var d=s.mul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.invm=function(s){var l=this.imod(s._invmp(this.m).mul(this.r2));return l._forceRed(this)}})(i,di)}(Qf)),Qf.exports}var V0,Ig;function T5(){if(Ig)return V0;Ig=1;var i=B5(),e=L5();V0=function(c){return new t(c)};var r={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};r.p224=r.secp224r1,r.p256=r.secp256r1=r.prime256v1,r.p192=r.secp192r1=r.prime192v1,r.p384=r.secp384r1,r.p521=r.secp521r1;function t(n){this.curveType=r[n],this.curveType||(this.curveType={name:n}),this.curve=new i.ec(this.curveType.name),this.keys=void 0}t.prototype.generateKeys=function(n,c){return this.keys=this.curve.genKeyPair(),this.getPublicKey(n,c)},t.prototype.computeSecret=function(n,c,u){c=c||"utf8",Buffer.isBuffer(n)||(n=new Buffer(n,c));var v=this.curve.keyFromPublic(n).getPublic(),o=v.mul(this.keys.getPrivate()).getX();return a(o,u,this.curveType.byteLength)},t.prototype.getPublicKey=function(n,c){var u=this.keys.getPublic(c==="compressed",!0);return c==="hybrid"&&(u[u.length-1]%2?u[0]=7:u[0]=6),a(u,n)},t.prototype.getPrivateKey=function(n){return a(this.keys.getPrivate(),n)},t.prototype.setPublicKey=function(n,c){return c=c||"utf8",Buffer.isBuffer(n)||(n=new Buffer(n,c)),this.keys._importPublic(n),this},t.prototype.setPrivateKey=function(n,c){c=c||"utf8",Buffer.isBuffer(n)||(n=new Buffer(n,c));var u=new e(n);return u=u.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(u),this};function a(n,c,u){Array.isArray(n)||(n=n.toArray());var v=new Buffer(n);if(u&&v.length<u){var o=new Buffer(u-v.length);o.fill(0),v=Buffer.concat([o,v])}return c?v.toString(c):v}return V0}var G0={},K0,Mg;function Jy(){if(Mg)return K0;Mg=1;var i=Fo(),e=er().Buffer;K0=function(t,a){for(var n=e.alloc(0),c=0,u;n.length<a;)u=r(c++),n=e.concat([n,i("sha1").update(t).update(u).digest()]);return n.slice(0,a)};function r(t){var a=e.allocUnsafe(4);return a.writeUInt32BE(t,0),a}return K0}var H0,Bg;function tb(){return Bg||(Bg=1,H0=function(e,r){for(var t=e.length,a=-1;++a<t;)e[a]^=r[a];return e}),H0}var $f={exports:{}};$f.exports;var Lg;function v1(){return Lg||(Lg=1,function(i){(function(e,r){function t(E,s){if(!E)throw new Error(s||"Assertion failed")}function a(E,s){E.super_=s;var l=function(){};l.prototype=s.prototype,E.prototype=new l,E.prototype.constructor=E}function n(E,s,l){if(n.isBN(E))return E;this.negative=0,this.words=null,this.length=0,this.red=null,E!==null&&((s==="le"||s==="be")&&(l=s,s=10),this._init(E||0,s||10,l||"be"))}typeof e=="object"?e.exports=n:r.BN=n,n.BN=n,n.wordSize=26;var c;try{typeof window<"u"&&typeof window.Buffer<"u"?c=window.Buffer:c=$i.Buffer}catch{}n.isBN=function(s){return s instanceof n?!0:s!==null&&typeof s=="object"&&s.constructor.wordSize===n.wordSize&&Array.isArray(s.words)},n.max=function(s,l){return s.cmp(l)>0?s:l},n.min=function(s,l){return s.cmp(l)<0?s:l},n.prototype._init=function(s,l,d){if(typeof s=="number")return this._initNumber(s,l,d);if(typeof s=="object")return this._initArray(s,l,d);l==="hex"&&(l=16),t(l===(l|0)&&l>=2&&l<=36),s=s.toString().replace(/\s+/g,"");var p=0;s[0]==="-"&&(p++,this.negative=1),p<s.length&&(l===16?this._parseHex(s,p,d):(this._parseBase(s,l,p),d==="le"&&this._initArray(this.toArray(),l,d)))},n.prototype._initNumber=function(s,l,d){s<0&&(this.negative=1,s=-s),s<67108864?(this.words=[s&67108863],this.length=1):s<4503599627370496?(this.words=[s&67108863,s/67108864&67108863],this.length=2):(t(s<9007199254740992),this.words=[s&67108863,s/67108864&67108863,1],this.length=3),d==="le"&&this._initArray(this.toArray(),l,d)},n.prototype._initArray=function(s,l,d){if(t(typeof s.length=="number"),s.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(s.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m,w,x=0;if(d==="be")for(p=s.length-1,m=0;p>=0;p-=3)w=s[p]|s[p-1]<<8|s[p-2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);else if(d==="le")for(p=0,m=0;p<s.length;p+=3)w=s[p]|s[p+1]<<8|s[p+2]<<16,this.words[m]|=w<<x&67108863,this.words[m+1]=w>>>26-x&67108863,x+=24,x>=26&&(x-=26,m++);return this.strip()};function u(E,s){var l=E.charCodeAt(s);return l>=65&&l<=70?l-55:l>=97&&l<=102?l-87:l-48&15}function v(E,s,l){var d=u(E,l);return l-1>=s&&(d|=u(E,l-1)<<4),d}n.prototype._parseHex=function(s,l,d){this.length=Math.ceil((s.length-l)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m=0,w=0,x;if(d==="be")for(p=s.length-1;p>=l;p-=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8;else{var b=s.length-l;for(p=b%2===0?l+1:l;p<s.length;p+=2)x=v(s,l,p)<<m,this.words[w]|=x&67108863,m>=18?(m-=18,w+=1,this.words[w]|=x>>>26):m+=8}this.strip()};function o(E,s,l,d){for(var p=0,m=Math.min(E.length,l),w=s;w<m;w++){var x=E.charCodeAt(w)-48;p*=d,x>=49?p+=x-49+10:x>=17?p+=x-17+10:p+=x}return p}n.prototype._parseBase=function(s,l,d){this.words=[0],this.length=1;for(var p=0,m=1;m<=67108863;m*=l)p++;p--,m=m/l|0;for(var w=s.length-d,x=w%p,b=Math.min(w,w-x)+d,f=0,C=d;C<b;C+=p)f=o(s,C,C+p,l),this.imuln(m),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(x!==0){var F=1;for(f=o(s,C,s.length,l),C=0;C<x;C++)F*=l;this.imuln(F),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},n.prototype.copy=function(s){s.words=new Array(this.length);for(var l=0;l<this.length;l++)s.words[l]=this.words[l];s.length=this.length,s.negative=this.negative,s.red=this.red},n.prototype.clone=function(){var s=new n(null);return this.copy(s),s},n.prototype._expand=function(s){for(;this.length<s;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(s,l){s=s||10,l=l|0||1;var d;if(s===16||s==="hex"){d="";for(var p=0,m=0,w=0;w<this.length;w++){var x=this.words[w],b=((x<<p|m)&16777215).toString(16);m=x>>>24-p&16777215,p+=2,p>=26&&(p-=26,w--),m!==0||w!==this.length-1?d=h[6-b.length]+b+d:d=b+d}for(m!==0&&(d=m.toString(16)+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}if(s===(s|0)&&s>=2&&s<=36){var f=g[s],C=y[s];d="";var F=this.clone();for(F.negative=0;!F.isZero();){var z=F.modn(C).toString(s);F=F.idivn(C),F.isZero()?d=z+d:d=h[f-z.length]+z+d}for(this.isZero()&&(d="0"+d);d.length%l!==0;)d="0"+d;return this.negative!==0&&(d="-"+d),d}t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var s=this.words[0];return this.length===2?s+=this.words[1]*67108864:this.length===3&&this.words[2]===1?s+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-s:s},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(s,l){return t(typeof c<"u"),this.toArrayLike(c,s,l)},n.prototype.toArray=function(s,l){return this.toArrayLike(Array,s,l)},n.prototype.toArrayLike=function(s,l,d){var p=this.byteLength(),m=d||Math.max(1,p);t(p<=m,"byte array longer than desired length"),t(m>0,"Requested array length <= 0"),this.strip();var w=l==="le",x=new s(m),b,f,C=this.clone();if(w){for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[f]=b;for(;f<m;f++)x[f]=0}else{for(f=0;f<m-p;f++)x[f]=0;for(f=0;!C.isZero();f++)b=C.andln(255),C.iushrn(8),x[m-f-1]=b}return x},Math.clz32?n.prototype._countBits=function(s){return 32-Math.clz32(s)}:n.prototype._countBits=function(s){var l=s,d=0;return l>=4096&&(d+=13,l>>>=13),l>=64&&(d+=7,l>>>=7),l>=8&&(d+=4,l>>>=4),l>=2&&(d+=2,l>>>=2),d+l},n.prototype._zeroBits=function(s){if(s===0)return 26;var l=s,d=0;return l&8191||(d+=13,l>>>=13),l&127||(d+=7,l>>>=7),l&15||(d+=4,l>>>=4),l&3||(d+=2,l>>>=2),l&1||d++,d},n.prototype.bitLength=function(){var s=this.words[this.length-1],l=this._countBits(s);return(this.length-1)*26+l};function _(E){for(var s=new Array(E.bitLength()),l=0;l<s.length;l++){var d=l/26|0,p=l%26;s[l]=(E.words[d]&1<<p)>>>p}return s}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var s=0,l=0;l<this.length;l++){var d=this._zeroBits(this.words[l]);if(s+=d,d!==26)break}return s},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(s){return this.negative!==0?this.abs().inotn(s).iaddn(1):this.clone()},n.prototype.fromTwos=function(s){return this.testn(s-1)?this.notn(s).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(s){for(;this.length<s.length;)this.words[this.length++]=0;for(var l=0;l<s.length;l++)this.words[l]=this.words[l]|s.words[l];return this.strip()},n.prototype.ior=function(s){return t((this.negative|s.negative)===0),this.iuor(s)},n.prototype.or=function(s){return this.length>s.length?this.clone().ior(s):s.clone().ior(this)},n.prototype.uor=function(s){return this.length>s.length?this.clone().iuor(s):s.clone().iuor(this)},n.prototype.iuand=function(s){var l;this.length>s.length?l=s:l=this;for(var d=0;d<l.length;d++)this.words[d]=this.words[d]&s.words[d];return this.length=l.length,this.strip()},n.prototype.iand=function(s){return t((this.negative|s.negative)===0),this.iuand(s)},n.prototype.and=function(s){return this.length>s.length?this.clone().iand(s):s.clone().iand(this)},n.prototype.uand=function(s){return this.length>s.length?this.clone().iuand(s):s.clone().iuand(this)},n.prototype.iuxor=function(s){var l,d;this.length>s.length?(l=this,d=s):(l=s,d=this);for(var p=0;p<d.length;p++)this.words[p]=l.words[p]^d.words[p];if(this!==l)for(;p<l.length;p++)this.words[p]=l.words[p];return this.length=l.length,this.strip()},n.prototype.ixor=function(s){return t((this.negative|s.negative)===0),this.iuxor(s)},n.prototype.xor=function(s){return this.length>s.length?this.clone().ixor(s):s.clone().ixor(this)},n.prototype.uxor=function(s){return this.length>s.length?this.clone().iuxor(s):s.clone().iuxor(this)},n.prototype.inotn=function(s){t(typeof s=="number"&&s>=0);var l=Math.ceil(s/26)|0,d=s%26;this._expand(l),d>0&&l--;for(var p=0;p<l;p++)this.words[p]=~this.words[p]&67108863;return d>0&&(this.words[p]=~this.words[p]&67108863>>26-d),this.strip()},n.prototype.notn=function(s){return this.clone().inotn(s)},n.prototype.setn=function(s,l){t(typeof s=="number"&&s>=0);var d=s/26|0,p=s%26;return this._expand(d+1),l?this.words[d]=this.words[d]|1<<p:this.words[d]=this.words[d]&~(1<<p),this.strip()},n.prototype.iadd=function(s){var l;if(this.negative!==0&&s.negative===0)return this.negative=0,l=this.isub(s),this.negative^=1,this._normSign();if(this.negative===0&&s.negative!==0)return s.negative=0,l=this.isub(s),s.negative=1,l._normSign();var d,p;this.length>s.length?(d=this,p=s):(d=s,p=this);for(var m=0,w=0;w<p.length;w++)l=(d.words[w]|0)+(p.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;for(;m!==0&&w<d.length;w++)l=(d.words[w]|0)+m,this.words[w]=l&67108863,m=l>>>26;if(this.length=d.length,m!==0)this.words[this.length]=m,this.length++;else if(d!==this)for(;w<d.length;w++)this.words[w]=d.words[w];return this},n.prototype.add=function(s){var l;return s.negative!==0&&this.negative===0?(s.negative=0,l=this.sub(s),s.negative^=1,l):s.negative===0&&this.negative!==0?(this.negative=0,l=s.sub(this),this.negative=1,l):this.length>s.length?this.clone().iadd(s):s.clone().iadd(this)},n.prototype.isub=function(s){if(s.negative!==0){s.negative=0;var l=this.iadd(s);return s.negative=1,l._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(s),this.negative=1,this._normSign();var d=this.cmp(s);if(d===0)return this.negative=0,this.length=1,this.words[0]=0,this;var p,m;d>0?(p=this,m=s):(p=s,m=this);for(var w=0,x=0;x<m.length;x++)l=(p.words[x]|0)-(m.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;for(;w!==0&&x<p.length;x++)l=(p.words[x]|0)+w,w=l>>26,this.words[x]=l&67108863;if(w===0&&x<p.length&&p!==this)for(;x<p.length;x++)this.words[x]=p.words[x];return this.length=Math.max(this.length,x),p!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(s){return this.clone().isub(s)};function A(E,s,l){l.negative=s.negative^E.negative;var d=E.length+s.length|0;l.length=d,d=d-1|0;var p=E.words[0]|0,m=s.words[0]|0,w=p*m,x=w&67108863,b=w/67108864|0;l.words[0]=x;for(var f=1;f<d;f++){for(var C=b>>>26,F=b&67108863,z=Math.min(f,s.length-1),W=Math.max(0,f-E.length+1);W<=z;W++){var $=f-W|0;p=E.words[$]|0,m=s.words[W]|0,w=p*m+F,C+=w/67108864|0,F=w&67108863}l.words[f]=F|0,b=C|0}return b!==0?l.words[f]=b|0:l.length--,l.strip()}var S=function(s,l,d){var p=s.words,m=l.words,w=d.words,x=0,b,f,C,F=p[0]|0,z=F&8191,W=F>>>13,$=p[1]|0,I=$&8191,K=$>>>13,N=p[2]|0,X=N&8191,Q=N>>>13,L=p[3]|0,V=L&8191,Z=L>>>13,H=p[4]|0,j=H&8191,et=H>>>13,nt=p[5]|0,st=nt&8191,ft=nt>>>13,vt=p[6]|0,ot=vt&8191,pt=vt>>>13,Ut=p[7]|0,At=Ut&8191,It=Ut>>>13,Jt=p[8]|0,at=Jt&8191,J=Jt>>>13,rt=p[9]|0,lt=rt&8191,gt=rt>>>13,Dt=m[0]|0,ut=Dt&8191,Y=Dt>>>13,tt=m[1]|0,dt=tt&8191,mt=tt>>>13,xt=m[2]|0,bt=xt&8191,_t=xt>>>13,Ht=m[3]|0,St=Ht&8191,Mt=Ht>>>13,jt=m[4]|0,Lt=jt&8191,Ft=jt>>>13,te=m[5]|0,Bt=te&8191,Ot=te>>>13,ie=m[6]|0,kt=ie&8191,qt=ie>>>13,ae=m[7]|0,Rt=ae&8191,zt=ae>>>13,he=m[8]|0,Vt=he&8191,Qt=he>>>13,ge=m[9]|0,Gt=ge&8191,$t=ge>>>13;d.negative=s.negative^l.negative,d.length=19,b=Math.imul(z,ut),f=Math.imul(z,Y),f=f+Math.imul(W,ut)|0,C=Math.imul(W,Y);var pe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(pe>>>26)|0,pe&=67108863,b=Math.imul(I,ut),f=Math.imul(I,Y),f=f+Math.imul(K,ut)|0,C=Math.imul(K,Y),b=b+Math.imul(z,dt)|0,f=f+Math.imul(z,mt)|0,f=f+Math.imul(W,dt)|0,C=C+Math.imul(W,mt)|0;var de=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(de>>>26)|0,de&=67108863,b=Math.imul(X,ut),f=Math.imul(X,Y),f=f+Math.imul(Q,ut)|0,C=Math.imul(Q,Y),b=b+Math.imul(I,dt)|0,f=f+Math.imul(I,mt)|0,f=f+Math.imul(K,dt)|0,C=C+Math.imul(K,mt)|0,b=b+Math.imul(z,bt)|0,f=f+Math.imul(z,_t)|0,f=f+Math.imul(W,bt)|0,C=C+Math.imul(W,_t)|0;var Ee=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,b=Math.imul(V,ut),f=Math.imul(V,Y),f=f+Math.imul(Z,ut)|0,C=Math.imul(Z,Y),b=b+Math.imul(X,dt)|0,f=f+Math.imul(X,mt)|0,f=f+Math.imul(Q,dt)|0,C=C+Math.imul(Q,mt)|0,b=b+Math.imul(I,bt)|0,f=f+Math.imul(I,_t)|0,f=f+Math.imul(K,bt)|0,C=C+Math.imul(K,_t)|0,b=b+Math.imul(z,St)|0,f=f+Math.imul(z,Mt)|0,f=f+Math.imul(W,St)|0,C=C+Math.imul(W,Mt)|0;var xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(xe>>>26)|0,xe&=67108863,b=Math.imul(j,ut),f=Math.imul(j,Y),f=f+Math.imul(et,ut)|0,C=Math.imul(et,Y),b=b+Math.imul(V,dt)|0,f=f+Math.imul(V,mt)|0,f=f+Math.imul(Z,dt)|0,C=C+Math.imul(Z,mt)|0,b=b+Math.imul(X,bt)|0,f=f+Math.imul(X,_t)|0,f=f+Math.imul(Q,bt)|0,C=C+Math.imul(Q,_t)|0,b=b+Math.imul(I,St)|0,f=f+Math.imul(I,Mt)|0,f=f+Math.imul(K,St)|0,C=C+Math.imul(K,Mt)|0,b=b+Math.imul(z,Lt)|0,f=f+Math.imul(z,Ft)|0,f=f+Math.imul(W,Lt)|0,C=C+Math.imul(W,Ft)|0;var Se=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Se>>>26)|0,Se&=67108863,b=Math.imul(st,ut),f=Math.imul(st,Y),f=f+Math.imul(ft,ut)|0,C=Math.imul(ft,Y),b=b+Math.imul(j,dt)|0,f=f+Math.imul(j,mt)|0,f=f+Math.imul(et,dt)|0,C=C+Math.imul(et,mt)|0,b=b+Math.imul(V,bt)|0,f=f+Math.imul(V,_t)|0,f=f+Math.imul(Z,bt)|0,C=C+Math.imul(Z,_t)|0,b=b+Math.imul(X,St)|0,f=f+Math.imul(X,Mt)|0,f=f+Math.imul(Q,St)|0,C=C+Math.imul(Q,Mt)|0,b=b+Math.imul(I,Lt)|0,f=f+Math.imul(I,Ft)|0,f=f+Math.imul(K,Lt)|0,C=C+Math.imul(K,Ft)|0,b=b+Math.imul(z,Bt)|0,f=f+Math.imul(z,Ot)|0,f=f+Math.imul(W,Bt)|0,C=C+Math.imul(W,Ot)|0;var Be=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Be>>>26)|0,Be&=67108863,b=Math.imul(ot,ut),f=Math.imul(ot,Y),f=f+Math.imul(pt,ut)|0,C=Math.imul(pt,Y),b=b+Math.imul(st,dt)|0,f=f+Math.imul(st,mt)|0,f=f+Math.imul(ft,dt)|0,C=C+Math.imul(ft,mt)|0,b=b+Math.imul(j,bt)|0,f=f+Math.imul(j,_t)|0,f=f+Math.imul(et,bt)|0,C=C+Math.imul(et,_t)|0,b=b+Math.imul(V,St)|0,f=f+Math.imul(V,Mt)|0,f=f+Math.imul(Z,St)|0,C=C+Math.imul(Z,Mt)|0,b=b+Math.imul(X,Lt)|0,f=f+Math.imul(X,Ft)|0,f=f+Math.imul(Q,Lt)|0,C=C+Math.imul(Q,Ft)|0,b=b+Math.imul(I,Bt)|0,f=f+Math.imul(I,Ot)|0,f=f+Math.imul(K,Bt)|0,C=C+Math.imul(K,Ot)|0,b=b+Math.imul(z,kt)|0,f=f+Math.imul(z,qt)|0,f=f+Math.imul(W,kt)|0,C=C+Math.imul(W,qt)|0;var Ne=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,b=Math.imul(At,ut),f=Math.imul(At,Y),f=f+Math.imul(It,ut)|0,C=Math.imul(It,Y),b=b+Math.imul(ot,dt)|0,f=f+Math.imul(ot,mt)|0,f=f+Math.imul(pt,dt)|0,C=C+Math.imul(pt,mt)|0,b=b+Math.imul(st,bt)|0,f=f+Math.imul(st,_t)|0,f=f+Math.imul(ft,bt)|0,C=C+Math.imul(ft,_t)|0,b=b+Math.imul(j,St)|0,f=f+Math.imul(j,Mt)|0,f=f+Math.imul(et,St)|0,C=C+Math.imul(et,Mt)|0,b=b+Math.imul(V,Lt)|0,f=f+Math.imul(V,Ft)|0,f=f+Math.imul(Z,Lt)|0,C=C+Math.imul(Z,Ft)|0,b=b+Math.imul(X,Bt)|0,f=f+Math.imul(X,Ot)|0,f=f+Math.imul(Q,Bt)|0,C=C+Math.imul(Q,Ot)|0,b=b+Math.imul(I,kt)|0,f=f+Math.imul(I,qt)|0,f=f+Math.imul(K,kt)|0,C=C+Math.imul(K,qt)|0,b=b+Math.imul(z,Rt)|0,f=f+Math.imul(z,zt)|0,f=f+Math.imul(W,Rt)|0,C=C+Math.imul(W,zt)|0;var qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(qe>>>26)|0,qe&=67108863,b=Math.imul(at,ut),f=Math.imul(at,Y),f=f+Math.imul(J,ut)|0,C=Math.imul(J,Y),b=b+Math.imul(At,dt)|0,f=f+Math.imul(At,mt)|0,f=f+Math.imul(It,dt)|0,C=C+Math.imul(It,mt)|0,b=b+Math.imul(ot,bt)|0,f=f+Math.imul(ot,_t)|0,f=f+Math.imul(pt,bt)|0,C=C+Math.imul(pt,_t)|0,b=b+Math.imul(st,St)|0,f=f+Math.imul(st,Mt)|0,f=f+Math.imul(ft,St)|0,C=C+Math.imul(ft,Mt)|0,b=b+Math.imul(j,Lt)|0,f=f+Math.imul(j,Ft)|0,f=f+Math.imul(et,Lt)|0,C=C+Math.imul(et,Ft)|0,b=b+Math.imul(V,Bt)|0,f=f+Math.imul(V,Ot)|0,f=f+Math.imul(Z,Bt)|0,C=C+Math.imul(Z,Ot)|0,b=b+Math.imul(X,kt)|0,f=f+Math.imul(X,qt)|0,f=f+Math.imul(Q,kt)|0,C=C+Math.imul(Q,qt)|0,b=b+Math.imul(I,Rt)|0,f=f+Math.imul(I,zt)|0,f=f+Math.imul(K,Rt)|0,C=C+Math.imul(K,zt)|0,b=b+Math.imul(z,Vt)|0,f=f+Math.imul(z,Qt)|0,f=f+Math.imul(W,Vt)|0,C=C+Math.imul(W,Qt)|0;var Xe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,b=Math.imul(lt,ut),f=Math.imul(lt,Y),f=f+Math.imul(gt,ut)|0,C=Math.imul(gt,Y),b=b+Math.imul(at,dt)|0,f=f+Math.imul(at,mt)|0,f=f+Math.imul(J,dt)|0,C=C+Math.imul(J,mt)|0,b=b+Math.imul(At,bt)|0,f=f+Math.imul(At,_t)|0,f=f+Math.imul(It,bt)|0,C=C+Math.imul(It,_t)|0,b=b+Math.imul(ot,St)|0,f=f+Math.imul(ot,Mt)|0,f=f+Math.imul(pt,St)|0,C=C+Math.imul(pt,Mt)|0,b=b+Math.imul(st,Lt)|0,f=f+Math.imul(st,Ft)|0,f=f+Math.imul(ft,Lt)|0,C=C+Math.imul(ft,Ft)|0,b=b+Math.imul(j,Bt)|0,f=f+Math.imul(j,Ot)|0,f=f+Math.imul(et,Bt)|0,C=C+Math.imul(et,Ot)|0,b=b+Math.imul(V,kt)|0,f=f+Math.imul(V,qt)|0,f=f+Math.imul(Z,kt)|0,C=C+Math.imul(Z,qt)|0,b=b+Math.imul(X,Rt)|0,f=f+Math.imul(X,zt)|0,f=f+Math.imul(Q,Rt)|0,C=C+Math.imul(Q,zt)|0,b=b+Math.imul(I,Vt)|0,f=f+Math.imul(I,Qt)|0,f=f+Math.imul(K,Vt)|0,C=C+Math.imul(K,Qt)|0,b=b+Math.imul(z,Gt)|0,f=f+Math.imul(z,$t)|0,f=f+Math.imul(W,Gt)|0,C=C+Math.imul(W,$t)|0;var Ge=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,b=Math.imul(lt,dt),f=Math.imul(lt,mt),f=f+Math.imul(gt,dt)|0,C=Math.imul(gt,mt),b=b+Math.imul(at,bt)|0,f=f+Math.imul(at,_t)|0,f=f+Math.imul(J,bt)|0,C=C+Math.imul(J,_t)|0,b=b+Math.imul(At,St)|0,f=f+Math.imul(At,Mt)|0,f=f+Math.imul(It,St)|0,C=C+Math.imul(It,Mt)|0,b=b+Math.imul(ot,Lt)|0,f=f+Math.imul(ot,Ft)|0,f=f+Math.imul(pt,Lt)|0,C=C+Math.imul(pt,Ft)|0,b=b+Math.imul(st,Bt)|0,f=f+Math.imul(st,Ot)|0,f=f+Math.imul(ft,Bt)|0,C=C+Math.imul(ft,Ot)|0,b=b+Math.imul(j,kt)|0,f=f+Math.imul(j,qt)|0,f=f+Math.imul(et,kt)|0,C=C+Math.imul(et,qt)|0,b=b+Math.imul(V,Rt)|0,f=f+Math.imul(V,zt)|0,f=f+Math.imul(Z,Rt)|0,C=C+Math.imul(Z,zt)|0,b=b+Math.imul(X,Vt)|0,f=f+Math.imul(X,Qt)|0,f=f+Math.imul(Q,Vt)|0,C=C+Math.imul(Q,Qt)|0,b=b+Math.imul(I,Gt)|0,f=f+Math.imul(I,$t)|0,f=f+Math.imul(K,Gt)|0,C=C+Math.imul(K,$t)|0;var Je=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Je>>>26)|0,Je&=67108863,b=Math.imul(lt,bt),f=Math.imul(lt,_t),f=f+Math.imul(gt,bt)|0,C=Math.imul(gt,_t),b=b+Math.imul(at,St)|0,f=f+Math.imul(at,Mt)|0,f=f+Math.imul(J,St)|0,C=C+Math.imul(J,Mt)|0,b=b+Math.imul(At,Lt)|0,f=f+Math.imul(At,Ft)|0,f=f+Math.imul(It,Lt)|0,C=C+Math.imul(It,Ft)|0,b=b+Math.imul(ot,Bt)|0,f=f+Math.imul(ot,Ot)|0,f=f+Math.imul(pt,Bt)|0,C=C+Math.imul(pt,Ot)|0,b=b+Math.imul(st,kt)|0,f=f+Math.imul(st,qt)|0,f=f+Math.imul(ft,kt)|0,C=C+Math.imul(ft,qt)|0,b=b+Math.imul(j,Rt)|0,f=f+Math.imul(j,zt)|0,f=f+Math.imul(et,Rt)|0,C=C+Math.imul(et,zt)|0,b=b+Math.imul(V,Vt)|0,f=f+Math.imul(V,Qt)|0,f=f+Math.imul(Z,Vt)|0,C=C+Math.imul(Z,Qt)|0,b=b+Math.imul(X,Gt)|0,f=f+Math.imul(X,$t)|0,f=f+Math.imul(Q,Gt)|0,C=C+Math.imul(Q,$t)|0;var ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ze>>>26)|0,ze&=67108863,b=Math.imul(lt,St),f=Math.imul(lt,Mt),f=f+Math.imul(gt,St)|0,C=Math.imul(gt,Mt),b=b+Math.imul(at,Lt)|0,f=f+Math.imul(at,Ft)|0,f=f+Math.imul(J,Lt)|0,C=C+Math.imul(J,Ft)|0,b=b+Math.imul(At,Bt)|0,f=f+Math.imul(At,Ot)|0,f=f+Math.imul(It,Bt)|0,C=C+Math.imul(It,Ot)|0,b=b+Math.imul(ot,kt)|0,f=f+Math.imul(ot,qt)|0,f=f+Math.imul(pt,kt)|0,C=C+Math.imul(pt,qt)|0,b=b+Math.imul(st,Rt)|0,f=f+Math.imul(st,zt)|0,f=f+Math.imul(ft,Rt)|0,C=C+Math.imul(ft,zt)|0,b=b+Math.imul(j,Vt)|0,f=f+Math.imul(j,Qt)|0,f=f+Math.imul(et,Vt)|0,C=C+Math.imul(et,Qt)|0,b=b+Math.imul(V,Gt)|0,f=f+Math.imul(V,$t)|0,f=f+Math.imul(Z,Gt)|0,C=C+Math.imul(Z,$t)|0;var rr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(rr>>>26)|0,rr&=67108863,b=Math.imul(lt,Lt),f=Math.imul(lt,Ft),f=f+Math.imul(gt,Lt)|0,C=Math.imul(gt,Ft),b=b+Math.imul(at,Bt)|0,f=f+Math.imul(at,Ot)|0,f=f+Math.imul(J,Bt)|0,C=C+Math.imul(J,Ot)|0,b=b+Math.imul(At,kt)|0,f=f+Math.imul(At,qt)|0,f=f+Math.imul(It,kt)|0,C=C+Math.imul(It,qt)|0,b=b+Math.imul(ot,Rt)|0,f=f+Math.imul(ot,zt)|0,f=f+Math.imul(pt,Rt)|0,C=C+Math.imul(pt,zt)|0,b=b+Math.imul(st,Vt)|0,f=f+Math.imul(st,Qt)|0,f=f+Math.imul(ft,Vt)|0,C=C+Math.imul(ft,Qt)|0,b=b+Math.imul(j,Gt)|0,f=f+Math.imul(j,$t)|0,f=f+Math.imul(et,Gt)|0,C=C+Math.imul(et,$t)|0;var Qe=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,b=Math.imul(lt,Bt),f=Math.imul(lt,Ot),f=f+Math.imul(gt,Bt)|0,C=Math.imul(gt,Ot),b=b+Math.imul(at,kt)|0,f=f+Math.imul(at,qt)|0,f=f+Math.imul(J,kt)|0,C=C+Math.imul(J,qt)|0,b=b+Math.imul(At,Rt)|0,f=f+Math.imul(At,zt)|0,f=f+Math.imul(It,Rt)|0,C=C+Math.imul(It,zt)|0,b=b+Math.imul(ot,Vt)|0,f=f+Math.imul(ot,Qt)|0,f=f+Math.imul(pt,Vt)|0,C=C+Math.imul(pt,Qt)|0,b=b+Math.imul(st,Gt)|0,f=f+Math.imul(st,$t)|0,f=f+Math.imul(ft,Gt)|0,C=C+Math.imul(ft,$t)|0;var Le=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Le>>>26)|0,Le&=67108863,b=Math.imul(lt,kt),f=Math.imul(lt,qt),f=f+Math.imul(gt,kt)|0,C=Math.imul(gt,qt),b=b+Math.imul(at,Rt)|0,f=f+Math.imul(at,zt)|0,f=f+Math.imul(J,Rt)|0,C=C+Math.imul(J,zt)|0,b=b+Math.imul(At,Vt)|0,f=f+Math.imul(At,Qt)|0,f=f+Math.imul(It,Vt)|0,C=C+Math.imul(It,Qt)|0,b=b+Math.imul(ot,Gt)|0,f=f+Math.imul(ot,$t)|0,f=f+Math.imul(pt,Gt)|0,C=C+Math.imul(pt,$t)|0;var ir=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(ir>>>26)|0,ir&=67108863,b=Math.imul(lt,Rt),f=Math.imul(lt,zt),f=f+Math.imul(gt,Rt)|0,C=Math.imul(gt,zt),b=b+Math.imul(at,Vt)|0,f=f+Math.imul(at,Qt)|0,f=f+Math.imul(J,Vt)|0,C=C+Math.imul(J,Qt)|0,b=b+Math.imul(At,Gt)|0,f=f+Math.imul(At,$t)|0,f=f+Math.imul(It,Gt)|0,C=C+Math.imul(It,$t)|0;var nr=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(nr>>>26)|0,nr&=67108863,b=Math.imul(lt,Vt),f=Math.imul(lt,Qt),f=f+Math.imul(gt,Vt)|0,C=Math.imul(gt,Qt),b=b+Math.imul(at,Gt)|0,f=f+Math.imul(at,$t)|0,f=f+Math.imul(J,Gt)|0,C=C+Math.imul(J,$t)|0;var Ze=(x+b|0)+((f&8191)<<13)|0;x=(C+(f>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,b=Math.imul(lt,Gt),f=Math.imul(lt,$t),f=f+Math.imul(gt,Gt)|0,C=Math.imul(gt,$t);var ar=(x+b|0)+((f&8191)<<13)|0;return x=(C+(f>>>13)|0)+(ar>>>26)|0,ar&=67108863,w[0]=pe,w[1]=de,w[2]=Ee,w[3]=xe,w[4]=Se,w[5]=Be,w[6]=Ne,w[7]=qe,w[8]=Xe,w[9]=Ge,w[10]=Je,w[11]=ze,w[12]=rr,w[13]=Qe,w[14]=Le,w[15]=ir,w[16]=nr,w[17]=Ze,w[18]=ar,x!==0&&(w[19]=x,d.length++),d};Math.imul||(S=A);function T(E,s,l){l.negative=s.negative^E.negative,l.length=E.length+s.length;for(var d=0,p=0,m=0;m<l.length-1;m++){var w=p;p=0;for(var x=d&67108863,b=Math.min(m,s.length-1),f=Math.max(0,m-E.length+1);f<=b;f++){var C=m-f,F=E.words[C]|0,z=s.words[f]|0,W=F*z,$=W&67108863;w=w+(W/67108864|0)|0,$=$+x|0,x=$&67108863,w=w+($>>>26)|0,p+=w>>>26,w&=67108863}l.words[m]=x,d=w,w=p}return d!==0?l.words[m]=d:l.length--,l.strip()}function B(E,s,l){var d=new M;return d.mulp(E,s,l)}n.prototype.mulTo=function(s,l){var d,p=this.length+s.length;return this.length===10&&s.length===10?d=S(this,s,l):p<63?d=A(this,s,l):p<1024?d=T(this,s,l):d=B(this,s,l),d};function M(E,s){this.x=E,this.y=s}M.prototype.makeRBT=function(s){for(var l=new Array(s),d=n.prototype._countBits(s)-1,p=0;p<s;p++)l[p]=this.revBin(p,d,s);return l},M.prototype.revBin=function(s,l,d){if(s===0||s===d-1)return s;for(var p=0,m=0;m<l;m++)p|=(s&1)<<l-m-1,s>>=1;return p},M.prototype.permute=function(s,l,d,p,m,w){for(var x=0;x<w;x++)p[x]=l[s[x]],m[x]=d[s[x]]},M.prototype.transform=function(s,l,d,p,m,w){this.permute(w,s,l,d,p,m);for(var x=1;x<m;x<<=1)for(var b=x<<1,f=Math.cos(2*Math.PI/b),C=Math.sin(2*Math.PI/b),F=0;F<m;F+=b)for(var z=f,W=C,$=0;$<x;$++){var I=d[F+$],K=p[F+$],N=d[F+$+x],X=p[F+$+x],Q=z*N-W*X;X=z*X+W*N,N=Q,d[F+$]=I+N,p[F+$]=K+X,d[F+$+x]=I-N,p[F+$+x]=K-X,$!==b&&(Q=f*z-C*W,W=f*W+C*z,z=Q)}},M.prototype.guessLen13b=function(s,l){var d=Math.max(l,s)|1,p=d&1,m=0;for(d=d/2|0;d;d=d>>>1)m++;return 1<<m+1+p},M.prototype.conjugate=function(s,l,d){if(!(d<=1))for(var p=0;p<d/2;p++){var m=s[p];s[p]=s[d-p-1],s[d-p-1]=m,m=l[p],l[p]=-l[d-p-1],l[d-p-1]=-m}},M.prototype.normalize13b=function(s,l){for(var d=0,p=0;p<l/2;p++){var m=Math.round(s[2*p+1]/l)*8192+Math.round(s[2*p]/l)+d;s[p]=m&67108863,m<67108864?d=0:d=m/67108864|0}return s},M.prototype.convert13b=function(s,l,d,p){for(var m=0,w=0;w<l;w++)m=m+(s[w]|0),d[2*w]=m&8191,m=m>>>13,d[2*w+1]=m&8191,m=m>>>13;for(w=2*l;w<p;++w)d[w]=0;t(m===0),t((m&-8192)===0)},M.prototype.stub=function(s){for(var l=new Array(s),d=0;d<s;d++)l[d]=0;return l},M.prototype.mulp=function(s,l,d){var p=2*this.guessLen13b(s.length,l.length),m=this.makeRBT(p),w=this.stub(p),x=new Array(p),b=new Array(p),f=new Array(p),C=new Array(p),F=new Array(p),z=new Array(p),W=d.words;W.length=p,this.convert13b(s.words,s.length,x,p),this.convert13b(l.words,l.length,C,p),this.transform(x,w,b,f,p,m),this.transform(C,w,F,z,p,m);for(var $=0;$<p;$++){var I=b[$]*F[$]-f[$]*z[$];f[$]=b[$]*z[$]+f[$]*F[$],b[$]=I}return this.conjugate(b,f,p),this.transform(b,f,W,w,p,m),this.conjugate(W,w,p),this.normalize13b(W,p),d.negative=s.negative^l.negative,d.length=s.length+l.length,d.strip()},n.prototype.mul=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),this.mulTo(s,l)},n.prototype.mulf=function(s){var l=new n(null);return l.words=new Array(this.length+s.length),B(this,s,l)},n.prototype.imul=function(s){return this.clone().mulTo(s,this)},n.prototype.imuln=function(s){t(typeof s=="number"),t(s<67108864);for(var l=0,d=0;d<this.length;d++){var p=(this.words[d]|0)*s,m=(p&67108863)+(l&67108863);l>>=26,l+=p/67108864|0,l+=m>>>26,this.words[d]=m&67108863}return l!==0&&(this.words[d]=l,this.length++),this},n.prototype.muln=function(s){return this.clone().imuln(s)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(s){var l=_(s);if(l.length===0)return new n(1);for(var d=this,p=0;p<l.length&&l[p]===0;p++,d=d.sqr());if(++p<l.length)for(var m=d.sqr();p<l.length;p++,m=m.sqr())l[p]!==0&&(d=d.mul(m));return d},n.prototype.iushln=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=67108863>>>26-l<<26-l,m;if(l!==0){var w=0;for(m=0;m<this.length;m++){var x=this.words[m]&p,b=(this.words[m]|0)-x<<l;this.words[m]=b|w,w=x>>>26-l}w&&(this.words[m]=w,this.length++)}if(d!==0){for(m=this.length-1;m>=0;m--)this.words[m+d]=this.words[m];for(m=0;m<d;m++)this.words[m]=0;this.length+=d}return this.strip()},n.prototype.ishln=function(s){return t(this.negative===0),this.iushln(s)},n.prototype.iushrn=function(s,l,d){t(typeof s=="number"&&s>=0);var p;l?p=(l-l%26)/26:p=0;var m=s%26,w=Math.min((s-m)/26,this.length),x=67108863^67108863>>>m<<m,b=d;if(p-=w,p=Math.max(0,p),b){for(var f=0;f<w;f++)b.words[f]=this.words[f];b.length=w}if(w!==0)if(this.length>w)for(this.length-=w,f=0;f<this.length;f++)this.words[f]=this.words[f+w];else this.words[0]=0,this.length=1;var C=0;for(f=this.length-1;f>=0&&(C!==0||f>=p);f--){var F=this.words[f]|0;this.words[f]=C<<26-m|F>>>m,C=F&x}return b&&C!==0&&(b.words[b.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(s,l,d){return t(this.negative===0),this.iushrn(s,l,d)},n.prototype.shln=function(s){return this.clone().ishln(s)},n.prototype.ushln=function(s){return this.clone().iushln(s)},n.prototype.shrn=function(s){return this.clone().ishrn(s)},n.prototype.ushrn=function(s){return this.clone().iushrn(s)},n.prototype.testn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return!1;var m=this.words[d];return!!(m&p)},n.prototype.imaskn=function(s){t(typeof s=="number"&&s>=0);var l=s%26,d=(s-l)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=d)return this;if(l!==0&&d++,this.length=Math.min(d,this.length),l!==0){var p=67108863^67108863>>>l<<l;this.words[this.length-1]&=p}return this.strip()},n.prototype.maskn=function(s){return this.clone().imaskn(s)},n.prototype.iaddn=function(s){return t(typeof s=="number"),t(s<67108864),s<0?this.isubn(-s):this.negative!==0?this.length===1&&(this.words[0]|0)<s?(this.words[0]=s-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(s),this.negative=1,this):this._iaddn(s)},n.prototype._iaddn=function(s){this.words[0]+=s;for(var l=0;l<this.length&&this.words[l]>=67108864;l++)this.words[l]-=67108864,l===this.length-1?this.words[l+1]=1:this.words[l+1]++;return this.length=Math.max(this.length,l+1),this},n.prototype.isubn=function(s){if(t(typeof s=="number"),t(s<67108864),s<0)return this.iaddn(-s);if(this.negative!==0)return this.negative=0,this.iaddn(s),this.negative=1,this;if(this.words[0]-=s,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var l=0;l<this.length&&this.words[l]<0;l++)this.words[l]+=67108864,this.words[l+1]-=1;return this.strip()},n.prototype.addn=function(s){return this.clone().iaddn(s)},n.prototype.subn=function(s){return this.clone().isubn(s)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(s,l,d){var p=s.length+d,m;this._expand(p);var w,x=0;for(m=0;m<s.length;m++){w=(this.words[m+d]|0)+x;var b=(s.words[m]|0)*l;w-=b&67108863,x=(w>>26)-(b/67108864|0),this.words[m+d]=w&67108863}for(;m<this.length-d;m++)w=(this.words[m+d]|0)+x,x=w>>26,this.words[m+d]=w&67108863;if(x===0)return this.strip();for(t(x===-1),x=0,m=0;m<this.length;m++)w=-(this.words[m]|0)+x,x=w>>26,this.words[m]=w&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(s,l){var d=this.length-s.length,p=this.clone(),m=s,w=m.words[m.length-1]|0,x=this._countBits(w);d=26-x,d!==0&&(m=m.ushln(d),p.iushln(d),w=m.words[m.length-1]|0);var b=p.length-m.length,f;if(l!=="mod"){f=new n(null),f.length=b+1,f.words=new Array(f.length);for(var C=0;C<f.length;C++)f.words[C]=0}var F=p.clone()._ishlnsubmul(m,1,b);F.negative===0&&(p=F,f&&(f.words[b]=1));for(var z=b-1;z>=0;z--){var W=(p.words[m.length+z]|0)*67108864+(p.words[m.length+z-1]|0);for(W=Math.min(W/w|0,67108863),p._ishlnsubmul(m,W,z);p.negative!==0;)W--,p.negative=0,p._ishlnsubmul(m,1,z),p.isZero()||(p.negative^=1);f&&(f.words[z]=W)}return f&&f.strip(),p.strip(),l!=="div"&&d!==0&&p.iushrn(d),{div:f||null,mod:p}},n.prototype.divmod=function(s,l,d){if(t(!s.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var p,m,w;return this.negative!==0&&s.negative===0?(w=this.neg().divmod(s,l),l!=="mod"&&(p=w.div.neg()),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.iadd(s)),{div:p,mod:m}):this.negative===0&&s.negative!==0?(w=this.divmod(s.neg(),l),l!=="mod"&&(p=w.div.neg()),{div:p,mod:w.mod}):this.negative&s.negative?(w=this.neg().divmod(s.neg(),l),l!=="div"&&(m=w.mod.neg(),d&&m.negative!==0&&m.isub(s)),{div:w.div,mod:m}):s.length>this.length||this.cmp(s)<0?{div:new n(0),mod:this}:s.length===1?l==="div"?{div:this.divn(s.words[0]),mod:null}:l==="mod"?{div:null,mod:new n(this.modn(s.words[0]))}:{div:this.divn(s.words[0]),mod:new n(this.modn(s.words[0]))}:this._wordDiv(s,l)},n.prototype.div=function(s){return this.divmod(s,"div",!1).div},n.prototype.mod=function(s){return this.divmod(s,"mod",!1).mod},n.prototype.umod=function(s){return this.divmod(s,"mod",!0).mod},n.prototype.divRound=function(s){var l=this.divmod(s);if(l.mod.isZero())return l.div;var d=l.div.negative!==0?l.mod.isub(s):l.mod,p=s.ushrn(1),m=s.andln(1),w=d.cmp(p);return w<0||m===1&&w===0?l.div:l.div.negative!==0?l.div.isubn(1):l.div.iaddn(1)},n.prototype.modn=function(s){t(s<=67108863);for(var l=(1<<26)%s,d=0,p=this.length-1;p>=0;p--)d=(l*d+(this.words[p]|0))%s;return d},n.prototype.idivn=function(s){t(s<=67108863);for(var l=0,d=this.length-1;d>=0;d--){var p=(this.words[d]|0)+l*67108864;this.words[d]=p/s|0,l=p%s}return this.strip()},n.prototype.divn=function(s){return this.clone().idivn(s)},n.prototype.egcd=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=new n(0),x=new n(1),b=0;l.isEven()&&d.isEven();)l.iushrn(1),d.iushrn(1),++b;for(var f=d.clone(),C=l.clone();!l.isZero();){for(var F=0,z=1;!(l.words[0]&z)&&F<26;++F,z<<=1);if(F>0)for(l.iushrn(F);F-- >0;)(p.isOdd()||m.isOdd())&&(p.iadd(f),m.isub(C)),p.iushrn(1),m.iushrn(1);for(var W=0,$=1;!(d.words[0]&$)&&W<26;++W,$<<=1);if(W>0)for(d.iushrn(W);W-- >0;)(w.isOdd()||x.isOdd())&&(w.iadd(f),x.isub(C)),w.iushrn(1),x.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(w),m.isub(x)):(d.isub(l),w.isub(p),x.isub(m))}return{a:w,b:x,gcd:d.iushln(b)}},n.prototype._invmp=function(s){t(s.negative===0),t(!s.isZero());var l=this,d=s.clone();l.negative!==0?l=l.umod(s):l=l.clone();for(var p=new n(1),m=new n(0),w=d.clone();l.cmpn(1)>0&&d.cmpn(1)>0;){for(var x=0,b=1;!(l.words[0]&b)&&x<26;++x,b<<=1);if(x>0)for(l.iushrn(x);x-- >0;)p.isOdd()&&p.iadd(w),p.iushrn(1);for(var f=0,C=1;!(d.words[0]&C)&&f<26;++f,C<<=1);if(f>0)for(d.iushrn(f);f-- >0;)m.isOdd()&&m.iadd(w),m.iushrn(1);l.cmp(d)>=0?(l.isub(d),p.isub(m)):(d.isub(l),m.isub(p))}var F;return l.cmpn(1)===0?F=p:F=m,F.cmpn(0)<0&&F.iadd(s),F},n.prototype.gcd=function(s){if(this.isZero())return s.abs();if(s.isZero())return this.abs();var l=this.clone(),d=s.clone();l.negative=0,d.negative=0;for(var p=0;l.isEven()&&d.isEven();p++)l.iushrn(1),d.iushrn(1);do{for(;l.isEven();)l.iushrn(1);for(;d.isEven();)d.iushrn(1);var m=l.cmp(d);if(m<0){var w=l;l=d,d=w}else if(m===0||d.cmpn(1)===0)break;l.isub(d)}while(!0);return d.iushln(p)},n.prototype.invm=function(s){return this.egcd(s).a.umod(s)},n.prototype.isEven=function(){return(this.words[0]&1)===0},n.prototype.isOdd=function(){return(this.words[0]&1)===1},n.prototype.andln=function(s){return this.words[0]&s},n.prototype.bincn=function(s){t(typeof s=="number");var l=s%26,d=(s-l)/26,p=1<<l;if(this.length<=d)return this._expand(d+1),this.words[d]|=p,this;for(var m=p,w=d;m!==0&&w<this.length;w++){var x=this.words[w]|0;x+=m,m=x>>>26,x&=67108863,this.words[w]=x}return m!==0&&(this.words[w]=m,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(s){var l=s<0;if(this.negative!==0&&!l)return-1;if(this.negative===0&&l)return 1;this.strip();var d;if(this.length>1)d=1;else{l&&(s=-s),t(s<=67108863,"Number is too big");var p=this.words[0]|0;d=p===s?0:p<s?-1:1}return this.negative!==0?-d|0:d},n.prototype.cmp=function(s){if(this.negative!==0&&s.negative===0)return-1;if(this.negative===0&&s.negative!==0)return 1;var l=this.ucmp(s);return this.negative!==0?-l|0:l},n.prototype.ucmp=function(s){if(this.length>s.length)return 1;if(this.length<s.length)return-1;for(var l=0,d=this.length-1;d>=0;d--){var p=this.words[d]|0,m=s.words[d]|0;if(p!==m){p<m?l=-1:p>m&&(l=1);break}}return l},n.prototype.gtn=function(s){return this.cmpn(s)===1},n.prototype.gt=function(s){return this.cmp(s)===1},n.prototype.gten=function(s){return this.cmpn(s)>=0},n.prototype.gte=function(s){return this.cmp(s)>=0},n.prototype.ltn=function(s){return this.cmpn(s)===-1},n.prototype.lt=function(s){return this.cmp(s)===-1},n.prototype.lten=function(s){return this.cmpn(s)<=0},n.prototype.lte=function(s){return this.cmp(s)<=0},n.prototype.eqn=function(s){return this.cmpn(s)===0},n.prototype.eq=function(s){return this.cmp(s)===0},n.red=function(s){return new O(s)},n.prototype.toRed=function(s){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),s.convertTo(this)._forceRed(s)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(s){return this.red=s,this},n.prototype.forceRed=function(s){return t(!this.red,"Already a number in reduction context"),this._forceRed(s)},n.prototype.redAdd=function(s){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,s)},n.prototype.redIAdd=function(s){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,s)},n.prototype.redSub=function(s){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,s)},n.prototype.redISub=function(s){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,s)},n.prototype.redShl=function(s){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,s)},n.prototype.redMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.mul(this,s)},n.prototype.redIMul=function(s){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,s),this.red.imul(this,s)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(s){return t(this.red&&!s.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,s)};var R={k256:null,p224:null,p192:null,p25519:null};function P(E,s){this.name=E,this.p=new n(s,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}P.prototype._tmp=function(){var s=new n(null);return s.words=new Array(Math.ceil(this.n/13)),s},P.prototype.ireduce=function(s){var l=s,d;do this.split(l,this.tmp),l=this.imulK(l),l=l.iadd(this.tmp),d=l.bitLength();while(d>this.n);var p=d<this.n?-1:l.ucmp(this.p);return p===0?(l.words[0]=0,l.length=1):p>0?l.isub(this.p):l.strip!==void 0?l.strip():l._strip(),l},P.prototype.split=function(s,l){s.iushrn(this.n,0,l)},P.prototype.imulK=function(s){return s.imul(this.k)};function D(){P.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(D,P),D.prototype.split=function(s,l){for(var d=4194303,p=Math.min(s.length,9),m=0;m<p;m++)l.words[m]=s.words[m];if(l.length=p,s.length<=9){s.words[0]=0,s.length=1;return}var w=s.words[9];for(l.words[l.length++]=w&d,m=10;m<s.length;m++){var x=s.words[m]|0;s.words[m-10]=(x&d)<<4|w>>>22,w=x}w>>>=22,s.words[m-10]=w,w===0&&s.length>10?s.length-=10:s.length-=9},D.prototype.imulK=function(s){s.words[s.length]=0,s.words[s.length+1]=0,s.length+=2;for(var l=0,d=0;d<s.length;d++){var p=s.words[d]|0;l+=p*977,s.words[d]=l&67108863,l=p*64+(l/67108864|0)}return s.words[s.length-1]===0&&(s.length--,s.words[s.length-1]===0&&s.length--),s};function q(){P.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(q,P);function k(){P.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(k,P);function U(){P.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(U,P),U.prototype.imulK=function(s){for(var l=0,d=0;d<s.length;d++){var p=(s.words[d]|0)*19+l,m=p&67108863;p>>>=26,s.words[d]=m,l=p}return l!==0&&(s.words[s.length++]=l),s},n._prime=function(s){if(R[s])return R[s];var l;if(s==="k256")l=new D;else if(s==="p224")l=new q;else if(s==="p192")l=new k;else if(s==="p25519")l=new U;else throw new Error("Unknown prime "+s);return R[s]=l,l};function O(E){if(typeof E=="string"){var s=n._prime(E);this.m=s.p,this.prime=s}else t(E.gtn(1),"modulus must be greater than 1"),this.m=E,this.prime=null}O.prototype._verify1=function(s){t(s.negative===0,"red works only with positives"),t(s.red,"red works only with red numbers")},O.prototype._verify2=function(s,l){t((s.negative|l.negative)===0,"red works only with positives"),t(s.red&&s.red===l.red,"red works only with red numbers")},O.prototype.imod=function(s){return this.prime?this.prime.ireduce(s)._forceRed(this):s.umod(this.m)._forceRed(this)},O.prototype.neg=function(s){return s.isZero()?s.clone():this.m.sub(s)._forceRed(this)},O.prototype.add=function(s,l){this._verify2(s,l);var d=s.add(l);return d.cmp(this.m)>=0&&d.isub(this.m),d._forceRed(this)},O.prototype.iadd=function(s,l){this._verify2(s,l);var d=s.iadd(l);return d.cmp(this.m)>=0&&d.isub(this.m),d},O.prototype.sub=function(s,l){this._verify2(s,l);var d=s.sub(l);return d.cmpn(0)<0&&d.iadd(this.m),d._forceRed(this)},O.prototype.isub=function(s,l){this._verify2(s,l);var d=s.isub(l);return d.cmpn(0)<0&&d.iadd(this.m),d},O.prototype.shl=function(s,l){return this._verify1(s),this.imod(s.ushln(l))},O.prototype.imul=function(s,l){return this._verify2(s,l),this.imod(s.imul(l))},O.prototype.mul=function(s,l){return this._verify2(s,l),this.imod(s.mul(l))},O.prototype.isqr=function(s){return this.imul(s,s.clone())},O.prototype.sqr=function(s){return this.mul(s,s)},O.prototype.sqrt=function(s){if(s.isZero())return s.clone();var l=this.m.andln(3);if(t(l%2===1),l===3){var d=this.m.add(new n(1)).iushrn(2);return this.pow(s,d)}for(var p=this.m.subn(1),m=0;!p.isZero()&&p.andln(1)===0;)m++,p.iushrn(1);t(!p.isZero());var w=new n(1).toRed(this),x=w.redNeg(),b=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new n(2*f*f).toRed(this);this.pow(f,b).cmp(x)!==0;)f.redIAdd(x);for(var C=this.pow(f,p),F=this.pow(s,p.addn(1).iushrn(1)),z=this.pow(s,p),W=m;z.cmp(w)!==0;){for(var $=z,I=0;$.cmp(w)!==0;I++)$=$.redSqr();t(I<W);var K=this.pow(C,new n(1).iushln(W-I-1));F=F.redMul(K),C=K.redSqr(),z=z.redMul(C),W=I}return F},O.prototype.invm=function(s){var l=s._invmp(this.m);return l.negative!==0?(l.negative=0,this.imod(l).redNeg()):this.imod(l)},O.prototype.pow=function(s,l){if(l.isZero())return new n(1).toRed(this);if(l.cmpn(1)===0)return s.clone();var d=4,p=new Array(1<<d);p[0]=new n(1).toRed(this),p[1]=s;for(var m=2;m<p.length;m++)p[m]=this.mul(p[m-1],s);var w=p[0],x=0,b=0,f=l.bitLength()%26;for(f===0&&(f=26),m=l.length-1;m>=0;m--){for(var C=l.words[m],F=f-1;F>=0;F--){var z=C>>F&1;if(w!==p[0]&&(w=this.sqr(w)),z===0&&x===0){b=0;continue}x<<=1,x|=z,b++,!(b!==d&&(m!==0||F!==0))&&(w=this.mul(w,p[x]),b=0,x=0)}f=26}return w},O.prototype.convertTo=function(s){var l=s.umod(this.m);return l===s?l.clone():l},O.prototype.convertFrom=function(s){var l=s.clone();return l.red=null,l},n.mont=function(s){return new G(s)};function G(E){O.call(this,E),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(G,O),G.prototype.convertTo=function(s){return this.imod(s.ushln(this.shift))},G.prototype.convertFrom=function(s){var l=this.imod(s.mul(this.rinv));return l.red=null,l},G.prototype.imul=function(s,l){if(s.isZero()||l.isZero())return s.words[0]=0,s.length=1,s;var d=s.imul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.mul=function(s,l){if(s.isZero()||l.isZero())return new n(0)._forceRed(this);var d=s.mul(l),p=d.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=d.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},G.prototype.invm=function(s){var l=this.imod(s._invmp(this.m).mul(this.r2));return l._forceRed(this)}})(i,di)}($f)),$f.exports}var Q0,Tg;function eb(){if(Tg)return Q0;Tg=1;var i=v1(),e=er().Buffer;function r(t,a){return e.from(t.toRed(i.mont(a.modulus)).redPow(new i(a.publicExponent)).fromRed().toArray())}return Q0=r,Q0}var $0,Rg;function R5(){if(Rg)return $0;Rg=1;var i=Bl(),e=Is(),r=Fo(),t=Jy(),a=tb(),n=v1(),c=eb(),u=u1(),v=er().Buffer;$0=function(_,A,S){var T;_.padding?T=_.padding:S?T=1:T=4;var B=i(_),M;if(T===4)M=o(B,A);else if(T===1)M=h(B,A,S);else if(T===3){if(M=new n(A),M.cmp(B.modulus)>=0)throw new Error("data too long for modulus")}else throw new Error("unknown padding");return S?u(M,B):c(M,B)};function o(y,_){var A=y.modulus.byteLength(),S=_.length,T=r("sha1").update(v.alloc(0)).digest(),B=T.length,M=2*B;if(S>A-M-2)throw new Error("message too long");var R=v.alloc(A-S-M-2),P=A-B-1,D=e(B),q=a(v.concat([T,R,v.alloc(1,1),_],P),t(D,P)),k=a(D,t(q,B));return new n(v.concat([v.alloc(1),k,q],A))}function h(y,_,A){var S=_.length,T=y.modulus.byteLength();if(S>T-11)throw new Error("message too long");var B;return A?B=v.alloc(T-S-3,255):B=g(T-S-3),new n(v.concat([v.from([0,A?1:2]),B,v.alloc(1),_],T))}function g(y){for(var _=v.allocUnsafe(y),A=0,S=e(y*2),T=0,B;A<y;)T===S.length&&(S=e(y*2),T=0),B=S[T++],B&&(_[A++]=B);return _}return $0}var Z0,Ng;function N5(){if(Ng)return Z0;Ng=1;var i=Bl(),e=Jy(),r=tb(),t=v1(),a=u1(),n=Fo(),c=eb(),u=er().Buffer;Z0=function(y,_,A){var S;y.padding?S=y.padding:A?S=1:S=4;var T=i(y),B=T.modulus.byteLength();if(_.length>B||new t(_).cmp(T.modulus)>=0)throw new Error("decryption error");var M;A?M=c(new t(_),T):M=a(_,T);var R=u.alloc(B-M.length);if(M=u.concat([R,M],B),S===4)return v(T,M);if(S===1)return o(T,M,A);if(S===3)return M;throw new Error("unknown padding")};function v(g,y){var _=g.modulus.byteLength(),A=n("sha1").update(u.alloc(0)).digest(),S=A.length;if(y[0]!==0)throw new Error("decryption error");var T=y.slice(1,S+1),B=y.slice(S+1),M=r(T,e(B,S)),R=r(B,e(M,_-S-1));if(h(A,R.slice(0,S)))throw new Error("decryption error");for(var P=S;R[P]===0;)P++;if(R[P++]!==1)throw new Error("decryption error");return R.slice(P)}function o(g,y,_){for(var A=y.slice(0,2),S=2,T=0;y[S++]!==0;)if(S>=y.length){T++;break}var B=y.slice(2,S-1);if((A.toString("hex")!=="0002"&&!_||A.toString("hex")!=="0001"&&_)&&T++,B.length<8&&T++,T)throw new Error("decryption error");return y.slice(S)}function h(g,y){g=u.from(g),y=u.from(y);var _=0,A=g.length;g.length!==y.length&&(_++,A=Math.min(g.length,y.length));for(var S=-1;++S<A;)_+=g[S]^y[S];return _}return Z0}var kg;function k5(){return kg||(kg=1,function(i){i.publicEncrypt=R5(),i.privateDecrypt=N5(),i.privateEncrypt=function(r,t){return i.publicEncrypt(r,t,!0)},i.publicDecrypt=function(r,t){return i.privateDecrypt(r,t,!0)}}(G0)),G0}var is={},Pg;function P5(){if(Pg)return is;Pg=1;function i(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var e=er(),r=Is(),t=e.Buffer,a=e.kMaxLength,n=globalThis.crypto||globalThis.msCrypto,c=Math.pow(2,32)-1;function u(y,_){if(typeof y!="number"||y!==y)throw new TypeError("offset must be a number");if(y>c||y<0)throw new TypeError("offset must be a uint32");if(y>a||y>_)throw new RangeError("offset out of range")}function v(y,_,A){if(typeof y!="number"||y!==y)throw new TypeError("size must be a number");if(y>c||y<0)throw new TypeError("size must be a uint32");if(y+_>A||y>a)throw new RangeError("buffer too small")}n&&n.getRandomValues||!process.browser?(is.randomFill=o,is.randomFillSync=g):(is.randomFill=i,is.randomFillSync=i);function o(y,_,A,S){if(!t.isBuffer(y)&&!(y instanceof globalThis.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof _=="function")S=_,_=0,A=y.length;else if(typeof A=="function")S=A,A=y.length-_;else if(typeof S!="function")throw new TypeError('"cb" argument must be a function');return u(_,y.length),v(A,_,y.length),h(y,_,A,S)}function h(y,_,A,S){if(process.browser){var T=y.buffer,B=new Uint8Array(T,_,A);if(n.getRandomValues(B),S){process.nextTick(function(){S(null,y)});return}return y}if(S){r(A,function(R,P){if(R)return S(R);P.copy(y,_),S(null,y)});return}var M=r(A);return M.copy(y,_),y}function g(y,_,A){if(typeof _>"u"&&(_=0),!t.isBuffer(y)&&!(y instanceof globalThis.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return u(_,y.length),A===void 0&&(A=y.length-_),v(A,_,y.length),h(y,_,A)}return is}var Ug;function ba(){if(Ug)return We;Ug=1,We.randomBytes=We.rng=We.pseudoRandomBytes=We.prng=Is(),We.createHash=We.Hash=Fo(),We.createHmac=We.Hmac=wy();var i=S8(),e=Object.keys(i),r=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(e);We.getHashes=function(){return r};var t=Iy();We.pbkdf2=t.pbkdf2,We.pbkdf2Sync=t.pbkdf2Sync;var a=K8();We.Cipher=a.Cipher,We.createCipher=a.createCipher,We.Cipheriv=a.Cipheriv,We.createCipheriv=a.createCipheriv,We.Decipher=a.Decipher,We.createDecipher=a.createDecipher,We.Decipheriv=a.Decipheriv,We.createDecipheriv=a.createDecipheriv,We.getCiphers=a.getCiphers,We.listCiphers=a.listCiphers;var n=rw();We.DiffieHellmanGroup=n.DiffieHellmanGroup,We.createDiffieHellmanGroup=n.createDiffieHellmanGroup,We.getDiffieHellman=n.getDiffieHellman,We.createDiffieHellman=n.createDiffieHellman,We.DiffieHellman=n.DiffieHellman;var c=i5();We.createSign=c.createSign,We.Sign=c.Sign,We.createVerify=c.createVerify,We.Verify=c.Verify,We.createECDH=T5();var u=k5();We.publicEncrypt=u.publicEncrypt,We.privateEncrypt=u.privateEncrypt,We.publicDecrypt=u.publicDecrypt,We.privateDecrypt=u.privateDecrypt;var v=P5();return We.randomFill=v.randomFill,We.randomFillSync=v.randomFillSync,We.createCredentials=function(){throw new Error(`sorry, createCredentials is not implemented yet
we accept pull requests
https://github.com/browserify/crypto-browserify`)},We.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6},We}var rb={},Tl={},Rl={};Object.defineProperty(Rl,"__esModule",{value:!0});Rl.default=D5;let xf;const U5=new Uint8Array(16);function D5(){if(!xf&&(xf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!xf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return xf(U5)}var _a={},$a={},Nl={};Object.defineProperty(Nl,"__esModule",{value:!0});Nl.default=void 0;var O5=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;Nl.default=O5;Object.defineProperty($a,"__esModule",{value:!0});$a.default=void 0;var F5=q5(Nl);function q5(i){return i&&i.__esModule?i:{default:i}}function z5(i){return typeof i=="string"&&F5.default.test(i)}var V5=z5;$a.default=V5;Object.defineProperty(_a,"__esModule",{value:!0});_a.default=void 0;_a.unsafeStringify=ib;var G5=K5($a);function K5(i){return i&&i.__esModule?i:{default:i}}const Yr=[];for(let i=0;i<256;++i)Yr.push((i+256).toString(16).slice(1));function ib(i,e=0){return Yr[i[e+0]]+Yr[i[e+1]]+Yr[i[e+2]]+Yr[i[e+3]]+"-"+Yr[i[e+4]]+Yr[i[e+5]]+"-"+Yr[i[e+6]]+Yr[i[e+7]]+"-"+Yr[i[e+8]]+Yr[i[e+9]]+"-"+Yr[i[e+10]]+Yr[i[e+11]]+Yr[i[e+12]]+Yr[i[e+13]]+Yr[i[e+14]]+Yr[i[e+15]]}function H5(i,e=0){const r=ib(i,e);if(!(0,G5.default)(r))throw TypeError("Stringified UUID is invalid");return r}var Q5=H5;_a.default=Q5;Object.defineProperty(Tl,"__esModule",{value:!0});Tl.default=void 0;var $5=j5(Rl),Z5=_a;function j5(i){return i&&i.__esModule?i:{default:i}}let Dg,j0,W0=0,Y0=0;function W5(i,e,r){let t=e&&r||0;const a=e||new Array(16);i=i||{};let n=i.node||Dg,c=i.clockseq!==void 0?i.clockseq:j0;if(n==null||c==null){const y=i.random||(i.rng||$5.default)();n==null&&(n=Dg=[y[0]|1,y[1],y[2],y[3],y[4],y[5]]),c==null&&(c=j0=(y[6]<<8|y[7])&16383)}let u=i.msecs!==void 0?i.msecs:Date.now(),v=i.nsecs!==void 0?i.nsecs:Y0+1;const o=u-W0+(v-Y0)/1e4;if(o<0&&i.clockseq===void 0&&(c=c+1&16383),(o<0||u>W0)&&i.nsecs===void 0&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");W0=u,Y0=v,j0=c,u+=122192928e5;const h=((u&268435455)*1e4+v)%4294967296;a[t++]=h>>>24&255,a[t++]=h>>>16&255,a[t++]=h>>>8&255,a[t++]=h&255;const g=u/4294967296*1e4&268435455;a[t++]=g>>>8&255,a[t++]=g&255,a[t++]=g>>>24&15|16,a[t++]=g>>>16&255,a[t++]=c>>>8|128,a[t++]=c&255;for(let y=0;y<6;++y)a[t+y]=n[y];return e||(0,Z5.unsafeStringify)(a)}var Y5=W5;Tl.default=Y5;var kl={},da={},Qo={};Object.defineProperty(Qo,"__esModule",{value:!0});Qo.default=void 0;var X5=J5($a);function J5(i){return i&&i.__esModule?i:{default:i}}function t7(i){if(!(0,X5.default)(i))throw TypeError("Invalid UUID");let e;const r=new Uint8Array(16);return r[0]=(e=parseInt(i.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(i.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(i.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(i.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(i.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var e7=t7;Qo.default=e7;Object.defineProperty(da,"__esModule",{value:!0});da.URL=da.DNS=void 0;da.default=s7;var r7=_a,i7=n7(Qo);function n7(i){return i&&i.__esModule?i:{default:i}}function a7(i){i=unescape(encodeURIComponent(i));const e=[];for(let r=0;r<i.length;++r)e.push(i.charCodeAt(r));return e}const nb="6ba7b810-9dad-11d1-80b4-00c04fd430c8";da.DNS=nb;const ab="6ba7b811-9dad-11d1-80b4-00c04fd430c8";da.URL=ab;function s7(i,e,r){function t(a,n,c,u){var v;if(typeof a=="string"&&(a=a7(a)),typeof n=="string"&&(n=(0,i7.default)(n)),((v=n)===null||v===void 0?void 0:v.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let o=new Uint8Array(16+a.length);if(o.set(n),o.set(a,n.length),o=r(o),o[6]=o[6]&15|e,o[8]=o[8]&63|128,c){u=u||0;for(let h=0;h<16;++h)c[u+h]=o[h];return c}return(0,r7.unsafeStringify)(o)}try{t.name=i}catch{}return t.DNS=nb,t.URL=ab,t}var Pl={};Object.defineProperty(Pl,"__esModule",{value:!0});Pl.default=void 0;function o7(i){if(typeof i=="string"){const e=unescape(encodeURIComponent(i));i=new Uint8Array(e.length);for(let r=0;r<e.length;++r)i[r]=e.charCodeAt(r)}return f7(l7(c7(i),i.length*8))}function f7(i){const e=[],r=i.length*32,t="0123456789abcdef";for(let a=0;a<r;a+=8){const n=i[a>>5]>>>a%32&255,c=parseInt(t.charAt(n>>>4&15)+t.charAt(n&15),16);e.push(c)}return e}function sb(i){return(i+64>>>9<<4)+14+1}function l7(i,e){i[e>>5]|=128<<e%32,i[sb(e)-1]=e;let r=1732584193,t=-271733879,a=-1732584194,n=271733878;for(let c=0;c<i.length;c+=16){const u=r,v=t,o=a,h=n;r=ni(r,t,a,n,i[c],7,-680876936),n=ni(n,r,t,a,i[c+1],12,-389564586),a=ni(a,n,r,t,i[c+2],17,606105819),t=ni(t,a,n,r,i[c+3],22,-1044525330),r=ni(r,t,a,n,i[c+4],7,-176418897),n=ni(n,r,t,a,i[c+5],12,1200080426),a=ni(a,n,r,t,i[c+6],17,-1473231341),t=ni(t,a,n,r,i[c+7],22,-45705983),r=ni(r,t,a,n,i[c+8],7,1770035416),n=ni(n,r,t,a,i[c+9],12,-1958414417),a=ni(a,n,r,t,i[c+10],17,-42063),t=ni(t,a,n,r,i[c+11],22,-1990404162),r=ni(r,t,a,n,i[c+12],7,1804603682),n=ni(n,r,t,a,i[c+13],12,-40341101),a=ni(a,n,r,t,i[c+14],17,-1502002290),t=ni(t,a,n,r,i[c+15],22,1236535329),r=ai(r,t,a,n,i[c+1],5,-165796510),n=ai(n,r,t,a,i[c+6],9,-1069501632),a=ai(a,n,r,t,i[c+11],14,643717713),t=ai(t,a,n,r,i[c],20,-373897302),r=ai(r,t,a,n,i[c+5],5,-701558691),n=ai(n,r,t,a,i[c+10],9,38016083),a=ai(a,n,r,t,i[c+15],14,-660478335),t=ai(t,a,n,r,i[c+4],20,-405537848),r=ai(r,t,a,n,i[c+9],5,568446438),n=ai(n,r,t,a,i[c+14],9,-1019803690),a=ai(a,n,r,t,i[c+3],14,-187363961),t=ai(t,a,n,r,i[c+8],20,1163531501),r=ai(r,t,a,n,i[c+13],5,-1444681467),n=ai(n,r,t,a,i[c+2],9,-51403784),a=ai(a,n,r,t,i[c+7],14,1735328473),t=ai(t,a,n,r,i[c+12],20,-1926607734),r=si(r,t,a,n,i[c+5],4,-378558),n=si(n,r,t,a,i[c+8],11,-2022574463),a=si(a,n,r,t,i[c+11],16,1839030562),t=si(t,a,n,r,i[c+14],23,-35309556),r=si(r,t,a,n,i[c+1],4,-1530992060),n=si(n,r,t,a,i[c+4],11,1272893353),a=si(a,n,r,t,i[c+7],16,-155497632),t=si(t,a,n,r,i[c+10],23,-1094730640),r=si(r,t,a,n,i[c+13],4,681279174),n=si(n,r,t,a,i[c],11,-358537222),a=si(a,n,r,t,i[c+3],16,-722521979),t=si(t,a,n,r,i[c+6],23,76029189),r=si(r,t,a,n,i[c+9],4,-640364487),n=si(n,r,t,a,i[c+12],11,-421815835),a=si(a,n,r,t,i[c+15],16,530742520),t=si(t,a,n,r,i[c+2],23,-995338651),r=oi(r,t,a,n,i[c],6,-198630844),n=oi(n,r,t,a,i[c+7],10,1126891415),a=oi(a,n,r,t,i[c+14],15,-1416354905),t=oi(t,a,n,r,i[c+5],21,-57434055),r=oi(r,t,a,n,i[c+12],6,1700485571),n=oi(n,r,t,a,i[c+3],10,-1894986606),a=oi(a,n,r,t,i[c+10],15,-1051523),t=oi(t,a,n,r,i[c+1],21,-2054922799),r=oi(r,t,a,n,i[c+8],6,1873313359),n=oi(n,r,t,a,i[c+15],10,-30611744),a=oi(a,n,r,t,i[c+6],15,-1560198380),t=oi(t,a,n,r,i[c+13],21,1309151649),r=oi(r,t,a,n,i[c+4],6,-145523070),n=oi(n,r,t,a,i[c+11],10,-1120210379),a=oi(a,n,r,t,i[c+2],15,718787259),t=oi(t,a,n,r,i[c+9],21,-343485551),r=ra(r,u),t=ra(t,v),a=ra(a,o),n=ra(n,h)}return[r,t,a,n]}function c7(i){if(i.length===0)return[];const e=i.length*8,r=new Uint32Array(sb(e));for(let t=0;t<e;t+=8)r[t>>5]|=(i[t/8]&255)<<t%32;return r}function ra(i,e){const r=(i&65535)+(e&65535);return(i>>16)+(e>>16)+(r>>16)<<16|r&65535}function u7(i,e){return i<<e|i>>>32-e}function Ul(i,e,r,t,a,n){return ra(u7(ra(ra(e,i),ra(t,n)),a),r)}function ni(i,e,r,t,a,n,c){return Ul(e&r|~e&t,i,e,a,n,c)}function ai(i,e,r,t,a,n,c){return Ul(e&t|r&~t,i,e,a,n,c)}function si(i,e,r,t,a,n,c){return Ul(e^r^t,i,e,a,n,c)}function oi(i,e,r,t,a,n,c){return Ul(r^(e|~t),i,e,a,n,c)}var h7=o7;Pl.default=h7;Object.defineProperty(kl,"__esModule",{value:!0});kl.default=void 0;var d7=ob(da),p7=ob(Pl);function ob(i){return i&&i.__esModule?i:{default:i}}const v7=(0,d7.default)("v3",48,p7.default);var g7=v7;kl.default=g7;var Dl={},Ol={};Object.defineProperty(Ol,"__esModule",{value:!0});Ol.default=void 0;const m7=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var y7={randomUUID:m7};Ol.default=y7;Object.defineProperty(Dl,"__esModule",{value:!0});Dl.default=void 0;var Og=fb(Ol),b7=fb(Rl),_7=_a;function fb(i){return i&&i.__esModule?i:{default:i}}function w7(i,e,r){if(Og.default.randomUUID&&!e&&!i)return Og.default.randomUUID();i=i||{};const t=i.random||(i.rng||b7.default)();if(t[6]=t[6]&15|64,t[8]=t[8]&63|128,e){r=r||0;for(let a=0;a<16;++a)e[r+a]=t[a];return e}return(0,_7.unsafeStringify)(t)}var C7=w7;Dl.default=C7;var Fl={},ql={};Object.defineProperty(ql,"__esModule",{value:!0});ql.default=void 0;function E7(i,e,r,t){switch(i){case 0:return e&r^~e&t;case 1:return e^r^t;case 2:return e&r^e&t^r&t;case 3:return e^r^t}}function X0(i,e){return i<<e|i>>>32-e}function A7(i){const e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof i=="string"){const c=unescape(encodeURIComponent(i));i=[];for(let u=0;u<c.length;++u)i.push(c.charCodeAt(u))}else Array.isArray(i)||(i=Array.prototype.slice.call(i));i.push(128);const t=i.length/4+2,a=Math.ceil(t/16),n=new Array(a);for(let c=0;c<a;++c){const u=new Uint32Array(16);for(let v=0;v<16;++v)u[v]=i[c*64+v*4]<<24|i[c*64+v*4+1]<<16|i[c*64+v*4+2]<<8|i[c*64+v*4+3];n[c]=u}n[a-1][14]=(i.length-1)*8/Math.pow(2,32),n[a-1][14]=Math.floor(n[a-1][14]),n[a-1][15]=(i.length-1)*8&4294967295;for(let c=0;c<a;++c){const u=new Uint32Array(80);for(let _=0;_<16;++_)u[_]=n[c][_];for(let _=16;_<80;++_)u[_]=X0(u[_-3]^u[_-8]^u[_-14]^u[_-16],1);let v=r[0],o=r[1],h=r[2],g=r[3],y=r[4];for(let _=0;_<80;++_){const A=Math.floor(_/20),S=X0(v,5)+E7(A,o,h,g)+y+e[A]+u[_]>>>0;y=g,g=h,h=X0(o,30)>>>0,o=v,v=S}r[0]=r[0]+v>>>0,r[1]=r[1]+o>>>0,r[2]=r[2]+h>>>0,r[3]=r[3]+g>>>0,r[4]=r[4]+y>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var S7=A7;ql.default=S7;Object.defineProperty(Fl,"__esModule",{value:!0});Fl.default=void 0;var x7=lb(da),I7=lb(ql);function lb(i){return i&&i.__esModule?i:{default:i}}const M7=(0,x7.default)("v5",80,I7.default);var B7=M7;Fl.default=B7;var zl={};Object.defineProperty(zl,"__esModule",{value:!0});zl.default=void 0;var L7="00000000-0000-0000-0000-000000000000";zl.default=L7;var Vl={};Object.defineProperty(Vl,"__esModule",{value:!0});Vl.default=void 0;var T7=R7($a);function R7(i){return i&&i.__esModule?i:{default:i}}function N7(i){if(!(0,T7.default)(i))throw TypeError("Invalid UUID");return parseInt(i.slice(14,15),16)}var k7=N7;Vl.default=k7;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"NIL",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"stringify",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(i,"v1",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(i,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(i,"v4",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(i,"v5",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"validate",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"version",{enumerable:!0,get:function(){return c.default}});var e=h(Tl),r=h(kl),t=h(Dl),a=h(Fl),n=h(zl),c=h(Vl),u=h($a),v=h(_a),o=h(Qo);function h(g){return g&&g.__esModule?g:{default:g}}})(rb);const P7=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function Gl(i,e){if(!e||e==10)return BigInt(i);if(e==16)return i.slice(0,2)=="0x"?BigInt(i):BigInt("0x"+i)}const qr=Gl;function U7(i,e){let r=BigInt(0);e=BigInt(e);for(let t=0;t<i.length;t++)r=r*e+BigInt(i[t]);return r}function $o(i){const e=i.toString(16);return(e.length-1)*4+P7[parseInt(e[0],16)]}function cb(i){return BigInt(i)<BigInt(0)}function ub(i){return!i}function rl(i,e){return BigInt(i)<<BigInt(e)}function hs(i,e){return BigInt(i)>>BigInt(e)}const D7=rl,O7=hs;function g1(i){return(BigInt(i)&BigInt(1))==BigInt(1)}function F7(i){let e=BigInt(i);const r=[];for(;e;){if(e&BigInt(1)){const t=2-Number(e%BigInt(4));r.push(t),e=e-BigInt(t)}else r.push(0);e=e>>BigInt(1)}return r}function hb(i){let e=BigInt(i);const r=[];for(;e;)e&BigInt(1)?r.push(1):r.push(0),e=e>>BigInt(1);return r}function db(i){if(i>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(i)}function q7(i,e){const r=[];let t=BigInt(i);for(e=BigInt(e);t;)r.unshift(Number(t%e)),t=t/e;return r}function m1(i,e){return BigInt(i)+BigInt(e)}function Kn(i,e){return BigInt(i)-BigInt(e)}function pb(i){return-BigInt(i)}function vb(i,e){return BigInt(i)*BigInt(e)}function z7(i){return BigInt(i)*BigInt(i)}function Zo(i,e){return BigInt(i)**BigInt(e)}function V7(i,e){return BigInt(i)**BigInt(e)}function G7(i){return BigInt(i)>=0?BigInt(i):-BigInt(i)}function ys(i,e){return BigInt(i)/BigInt(e)}function vn(i,e){return BigInt(i)%BigInt(e)}function Dn(i,e){return BigInt(i)==BigInt(e)}function K7(i,e){return BigInt(i)!=BigInt(e)}function H7(i,e){return BigInt(i)<BigInt(e)}function Wh(i,e){return BigInt(i)>BigInt(e)}function Q7(i,e){return BigInt(i)<=BigInt(e)}function gb(i,e){return BigInt(i)>=BigInt(e)}function y1(i,e){return BigInt(i)&BigInt(e)}function $7(i,e){return BigInt(i)|BigInt(e)}function Z7(i,e){return BigInt(i)^BigInt(e)}function j7(i,e){return BigInt(i)&&BigInt(e)}function W7(i,e){return BigInt(i)||BigInt(e)}function Y7(i){return!BigInt(i)}function Mo(i,e,r,t){const a="0000000"+r.toString(16),n=new Uint32Array(i.buffer,i.byteOffset+e,t/4),c=((a.length-7)*4-1>>5)+1;for(let u=0;u<c;u++)n[u]=parseInt(a.substring(a.length-8*u-8,a.length-8*u),16);for(let u=c;u<n.length;u++)n[u]=0;for(let u=n.length*4;u<t;u++)i[u]=db(y1(hs(r,u*8),255))}function mb(i,e,r,t){const a="0000000"+r.toString(16),n=new DataView(i.buffer,i.byteOffset+e,t),c=((a.length-7)*4-1>>5)+1;for(let u=0;u<c;u++)n.setUint32(t-u*4-4,parseInt(a.substring(a.length-8*u-8,a.length-8*u),16),!1);for(let u=0;u<t/4-c;u++)n[u]=0}function Bo(i,e,r){r=r||i.byteLength,e=e||0;const t=new Uint32Array(i.buffer,i.byteOffset+e,r/4),a=new Array(r/4);return t.forEach((n,c)=>a[a.length-c-1]=n.toString(16).padStart(8,"0")),Gl(a.join(""),16)}function yb(i,e,r){r=r||i.byteLength,e=e||0;const t=new DataView(i.buffer,i.byteOffset+e,r),a=new Array(r/4);for(let n=0;n<r/4;n++)a[n]=t.getUint32(n*4,!1).toString(16).padStart(8,"0");return Gl(a.join(""),16)}function b1(i,e){return i.toString(e)}function bs(i){const e=new Uint8Array(Math.floor(($o(i)-1)/8)+1);return Mo(e,0,i,e.byteLength),e}const bb=qr(0),Ba=qr(1);var X7=Object.freeze({__proto__:null,abs:G7,add:m1,band:y1,bitLength:$o,bits:hb,bor:$7,bxor:Z7,div:ys,e:qr,eq:Dn,exp:V7,fromArray:U7,fromRprBE:yb,fromRprLE:Bo,fromString:Gl,geq:gb,gt:Wh,isNegative:cb,isOdd:g1,isZero:ub,land:j7,leq:Q7,lnot:Y7,lor:W7,lt:H7,mod:vn,mul:vb,naf:F7,neg:pb,neq:K7,one:Ba,pow:Zo,shiftLeft:rl,shiftRight:hs,shl:D7,shr:O7,square:z7,sub:Kn,toArray:q7,toLEBuff:bs,toNumber:db,toRprBE:mb,toRprLE:Mo,toString:b1,zero:bb});function Fg(i,e,r){if(ub(r))return i.one;const t=hb(r);if(t.length==0)return i.one;let a=e;for(let n=t.length-2;n>=0;n--)a=i.square(a),t[n]&&(a=i.mul(a,e));return a}function J7(i){if(i.m%2==1)if(Dn(vn(i.p,4),1))if(Dn(vn(i.p,8),1))if(Dn(vn(i.p,16),1))tC(i);else if(Dn(vn(i.p,16),9))eC(i);else throw new Error("Field withot sqrt");else if(Dn(vn(i.p,8),5))rC(i);else throw new Error("Field withot sqrt");else Dn(vn(i.p,4),3)&&iC(i);else{const e=vn(Zo(i.p,i.m/2),4);e==1?nC(i):e==3?aC(i):sC(i)}}function tC(i){for(i.sqrt_q=Zo(i.p,i.m),i.sqrt_s=0,i.sqrt_t=Kn(i.sqrt_q,1);!g1(i.sqrt_t);)i.sqrt_s=i.sqrt_s+1,i.sqrt_t=ys(i.sqrt_t,2);let e=i.one;for(;i.eq(e,i.one);){const r=i.random();i.sqrt_z=i.pow(r,i.sqrt_t),e=i.pow(i.sqrt_z,2**(i.sqrt_s-1))}i.sqrt_tm1d2=ys(Kn(i.sqrt_t,1),2),i.sqrt=function(r){const t=this;if(t.isZero(r))return t.zero;let a=t.pow(r,t.sqrt_tm1d2);const n=t.pow(t.mul(t.square(a),r),2**(t.sqrt_s-1));if(t.eq(n,t.negone))return null;let c=t.sqrt_s,u=t.mul(r,a),v=t.mul(u,a),o=t.sqrt_z;for(;!t.eq(v,t.one);){let h=t.square(v),g=1;for(;!t.eq(h,t.one);)h=t.square(h),g++;a=o;for(let y=0;y<c-g-1;y++)a=t.square(a);o=t.square(a),v=t.mul(v,o),u=t.mul(u,a),c=g}return t.geq(u,t.zero)?u:t.neg(u)}}function eC(i){i.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}function rC(i){i.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}function iC(i){i.sqrt_q=Zo(i.p,i.m),i.sqrt_e1=ys(Kn(i.sqrt_q,3),4),i.sqrt=function(e){if(this.isZero(e))return this.zero;const r=this.pow(e,this.sqrt_e1),t=this.mul(this.square(r),e);if(this.eq(t,this.negone))return null;const a=this.mul(r,e);return i.geq(a,i.zero)?a:i.neg(a)}}function nC(i){i.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}function aC(i){i.sqrt_q=Zo(i.p,i.m/2),i.sqrt_e34=ys(Kn(i.sqrt_q,3),4),i.sqrt_e12=ys(Kn(i.sqrt_q,1),2),i.frobenius=function(e,r){return e%2==1?i.conjugate(r):r},i.sqrt=function(e){const r=this,t=r.pow(e,r.sqrt_e34),a=r.mul(r.square(t),e),n=r.mul(r.frobenius(1,a),a);if(r.eq(n,r.negone))return null;const c=r.mul(t,e);let u;if(r.eq(a,r.negone))u=r.mul(c,[r.F.zero,r.F.one]);else{const v=r.pow(r.add(r.one,a),r.sqrt_e12);u=r.mul(v,c)}return r.geq(u,r.zero)?u:r.neg(u)}}function sC(i){i.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}function Wn(i,e,r,t,a){i[e]=i[e]+i[r]>>>0,i[a]=(i[a]^i[e])>>>0,i[a]=(i[a]<<16|i[a]>>>16&65535)>>>0,i[t]=i[t]+i[a]>>>0,i[r]=(i[r]^i[t])>>>0,i[r]=(i[r]<<12|i[r]>>>20&4095)>>>0,i[e]=i[e]+i[r]>>>0,i[a]=(i[a]^i[e])>>>0,i[a]=(i[a]<<8|i[a]>>>24&255)>>>0,i[t]=i[t]+i[a]>>>0,i[r]=(i[r]^i[t])>>>0,i[r]=(i[r]<<7|i[r]>>>25&127)>>>0}function oC(i){Wn(i,0,4,8,12),Wn(i,1,5,9,13),Wn(i,2,6,10,14),Wn(i,3,7,11,15),Wn(i,0,5,10,15),Wn(i,1,6,11,12),Wn(i,2,7,8,13),Wn(i,3,4,9,14)}class Ka{constructor(e){e=e||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return this.idx==16&&this.update(),this.buff[this.idx++]}nextU64(){return m1(vb(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(this.nextU32()&1)==1}update(){for(let e=0;e<16;e++)this.buff[e]=this.state[e];for(let e=0;e<10;e++)oC(this.buff);for(let e=0;e<16;e++)this.buff[e]=this.buff[e]+this.state[e]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,this.state[12]==0&&(this.state[13]=this.state[13]+1>>>0,this.state[13]==0&&(this.state[14]=this.state[14]+1>>>0,this.state[14]==0&&(this.state[15]=this.state[15]+1>>>0)))}}function _b(i){let e=new Uint8Array(i);if(typeof globalThis.crypto<"u")globalThis.crypto.getRandomValues(e);else for(let r=0;r<i;r++)e[r]=Math.random()*4294967296>>>0;return e}function fC(){const i=_b(32),e=new Uint32Array(i.buffer),r=[];for(let t=0;t<8;t++)r.push(e[t]);return r}let If=null;function _1(){return If||(If=new Ka(fC()),If)}class lC{constructor(e,r,t){this.F=r,this.G=e,this.opMulGF=t;let a=r.sqrt_t||r.t,n=r.sqrt_s||r.s,c=r.one;for(;r.eq(r.pow(c,r.half),r.one);)c=r.add(c,r.one);this.w=new Array(n+1),this.wi=new Array(n+1),this.w[n]=this.F.pow(c,a),this.wi[n]=this.F.inv(this.w[n]);let u=n-1;for(;u>=0;)this.w[u]=this.F.square(this.w[u+1]),this.wi[u]=this.F.square(this.wi[u+1]),u--;this.roots=[],this._setRoots(Math.min(n,15))}_setRoots(e){for(let r=e;r>=0&&!this.roots[r];r--){let t=this.F.one;const a=1<<r,n=new Array(a);for(let c=0;c<a;c++)n[c]=t,t=this.F.mul(t,this.w[r]);this.roots[r]=n}}fft(e){if(e.length<=1)return e;const r=qg(e.length-1)+1;this._setRoots(r);const t=1<<r;if(e.length!=t)throw new Error("Size must be multiple of 2");return il(this,e,r,0,1)}ifft(e){if(e.length<=1)return e;const r=qg(e.length-1)+1;this._setRoots(r);const t=1<<r;if(e.length!=t)throw new Error("Size must be multiple of 2");const a=il(this,e,r,0,1),n=this.F.inv(this.F.mulScalar(this.F.one,t)),c=new Array(t);for(let u=0;u<t;u++)c[u]=this.opMulGF(a[(t-u)%t],n);return c}}function qg(i){return(i&4294901760?(i&=4294901760,16):0)|(i&4278255360?(i&=4278255360,8):0)|(i&4042322160?(i&=4042322160,4):0)|(i&3435973836?(i&=3435973836,2):0)|(i&2863311530)!==0}function il(i,e,r,t,a){const n=1<<r;if(n==1)return[e[t]];if(n==2)return[i.G.add(e[t],e[t+a]),i.G.sub(e[t],e[t+a])];const c=n>>1,u=il(i,e,r-1,t,a*2),v=il(i,e,r-1,t+a,a*2),o=new Array(n);for(let h=0;h<c;h++)o[h]=i.G.add(u[h],i.opMulGF(v[h],i.roots[r][h])),o[h+c]=i.G.sub(u[h],i.opMulGF(v[h],i.roots[r][h]));return o}class w1{constructor(e){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(e),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=$o(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=this.n64*2,this.n8=this.n64*8,this.R=this.e(this.one<<BigInt(this.n64*64)),this.Ri=this.inv(this.R);const r=this.negone>>this.one;this.nqr=this.two;let t=this.pow(this.nqr,r);for(;!this.eq(t,this.negone);)this.nqr=this.nqr+this.one,t=this.pow(this.nqr,r);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),J7(this),this.FFT=new lC(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(e,r){let t;if(r?r==16&&(t=BigInt("0x"+e)):t=BigInt(e),t<0){let a=-t;return a>=this.p&&(a=a%this.p),this.p-a}else return t>=this.p?t%this.p:t}add(e,r){const t=e+r;return t>=this.p?t-this.p:t}sub(e,r){return e>=r?e-r:this.p-r+e}neg(e){return e&&this.p-e}mul(e,r){return e*r%this.p}mulScalar(e,r){return e*this.e(r)%this.p}square(e){return e*e%this.p}eq(e,r){return e==r}neq(e,r){return e!=r}lt(e,r){const t=e>this.half?e-this.p:e,a=r>this.half?r-this.p:r;return t<a}gt(e,r){const t=e>this.half?e-this.p:e,a=r>this.half?r-this.p:r;return t>a}leq(e,r){const t=e>this.half?e-this.p:e,a=r>this.half?r-this.p:r;return t<=a}geq(e,r){const t=e>this.half?e-this.p:e,a=r>this.half?r-this.p:r;return t>=a}div(e,r){return this.mul(e,this.inv(r))}idiv(e,r){if(!r)throw new Error("Division by zero");return e/r}inv(e){if(!e)throw new Error("Division by zero");let r=this.zero,t=this.p,a=this.one,n=e%this.p;for(;n;){let c=t/n;[r,a]=[a,r-c*a],[t,n]=[n,t-c*n]}return r<this.zero&&(r+=this.p),r}mod(e,r){return e%r}pow(e,r){return Fg(this,e,r)}exp(e,r){return Fg(this,e,r)}band(e,r){const t=e&r&this.mask;return t>=this.p?t-this.p:t}bor(e,r){const t=(e|r)&this.mask;return t>=this.p?t-this.p:t}bxor(e,r){const t=(e^r)&this.mask;return t>=this.p?t-this.p:t}bnot(e){const r=e^this.mask;return r>=this.p?r-this.p:r}shl(e,r){if(Number(r)<this.bitLength){const t=e<<r&this.mask;return t>=this.p?t-this.p:t}else{const t=this.p-r;return Number(t)<this.bitLength?e>>t:this.zero}}shr(e,r){if(Number(r)<this.bitLength)return e>>r;{const t=this.p-r;if(Number(t)<this.bitLength){const a=e<<t&this.mask;return a>=this.p?a-this.p:a}else return 0}}land(e,r){return e&&r?this.one:this.zero}lor(e,r){return e||r?this.one:this.zero}lnot(e){return e?this.zero:this.one}sqrt_old(e){if(e==this.zero)return this.zero;if(this.pow(e,this.negone>>this.one)!=this.one)return null;let t=this.s,a=this.nqr_to_t,n=this.pow(e,this.t),c=this.pow(e,this.add(this.t,this.one)>>this.one);for(;n!=this.one;){let u=this.square(n),v=1;for(;u!=this.one;)v++,u=this.square(u);let o=a;for(let h=0;h<t-v-1;h++)o=this.square(o);t=v,a=this.square(o),n=this.mul(n,a),c=this.mul(c,o)}return c>this.p>>this.one&&(c=this.neg(c)),c}normalize(e,r){if(e=BigInt(e,r),e<0){let t=-e;return t>=this.p&&(t=t%this.p),this.p-t}else return e>=this.p?e%this.p:e}random(){const e=this.bitLength*2/8;let r=this.zero;for(let t=0;t<e;t++)r=(r<<BigInt(8))+BigInt(_b(1)[0]);return r%this.p}toString(e,r){r=r||10;let t;return e>this.half&&r==10?t="-"+(this.p-e).toString(r):t=e.toString(r),t}isZero(e){return e==this.zero}fromRng(e){let r;do{r=this.zero;for(let t=0;t<this.n64;t++)r+=e.nextU64()<<BigInt(64*t);r&=this.mask}while(r>=this.p);return r=r*this.Ri%this.p,r}fft(e){return this.FFT.fft(e)}ifft(e){return this.FFT.ifft(e)}toRprLE(e,r,t){Mo(e,r,t,this.n64*8)}toRprBE(e,r,t){mb(e,r,t,this.n64*8)}toRprBEM(e,r,t){return this.toRprBE(e,r,this.mul(this.R,t))}toRprLEM(e,r,t){return this.toRprLE(e,r,this.mul(this.R,t))}fromRprLE(e,r){return Bo(e,r,this.n8)}fromRprBE(e,r){return yb(e,r,this.n8)}fromRprLEM(e,r){return this.mul(this.fromRprLE(e,r),this.Ri)}fromRprBEM(e,r){return this.mul(this.fromRprBE(e,r),this.Ri)}toObject(e){return e}}var wa={};wa.bigInt2BytesLE=function(e,r){const t=Array(r);let a=BigInt(e);for(let n=0;n<r;n++)t[n]=Number(a&0xFFn),a=a>>8n;return t};wa.bigInt2U32LE=function(e,r){const t=Array(r);let a=BigInt(e);for(let n=0;n<r;n++)t[n]=Number(a&0xFFFFFFFFn),a=a>>32n;return t};wa.isOcamNum=function(i){return!(!Array.isArray(i)||i.length!=3||typeof i[0]!="number"||typeof i[1]!="number"||!Array.isArray(i[2]))};var cC=function(e,r,t){const a=t||"int";if(e.modules[a])return a;e.modules[a]={};const n=r*2,c=r*8;function u(){const q=e.addFunction(a+"_copy");q.addParam("px","i32"),q.addParam("pr","i32");const k=q.getCodeBuilder();for(let U=0;U<r;U++)q.addCode(k.i64_store(k.getLocal("pr"),U*8,k.i64_load(k.getLocal("px"),U*8)))}function v(){const q=e.addFunction(a+"_zero");q.addParam("pr","i32");const k=q.getCodeBuilder();for(let U=0;U<r;U++)q.addCode(k.i64_store(k.getLocal("pr"),U*8,k.i64_const(0)))}function o(){const q=e.addFunction(a+"_one");q.addParam("pr","i32");const k=q.getCodeBuilder();q.addCode(k.i64_store(k.getLocal("pr"),0,k.i64_const(1)));for(let U=1;U<r;U++)q.addCode(k.i64_store(k.getLocal("pr"),U*8,k.i64_const(0)))}function h(){const q=e.addFunction(a+"_isZero");q.addParam("px","i32"),q.setReturnType("i32");const k=q.getCodeBuilder();function U(O){return O==0?k.ret(k.i64_eqz(k.i64_load(k.getLocal("px")))):k.if(k.i64_eqz(k.i64_load(k.getLocal("px"),O*8)),U(O-1),k.ret(k.i32_const(0)))}q.addCode(U(r-1)),q.addCode(k.ret(k.i32_const(0)))}function g(){const q=e.addFunction(a+"_eq");q.addParam("px","i32"),q.addParam("py","i32"),q.setReturnType("i32");const k=q.getCodeBuilder();function U(O){return O==0?k.ret(k.i64_eq(k.i64_load(k.getLocal("px")),k.i64_load(k.getLocal("py")))):k.if(k.i64_eq(k.i64_load(k.getLocal("px"),O*8),k.i64_load(k.getLocal("py"),O*8)),U(O-1),k.ret(k.i32_const(0)))}q.addCode(U(r-1)),q.addCode(k.ret(k.i32_const(0)))}function y(){const q=e.addFunction(a+"_gte");q.addParam("px","i32"),q.addParam("py","i32"),q.setReturnType("i32");const k=q.getCodeBuilder();function U(O){return O==0?k.ret(k.i64_ge_u(k.i64_load(k.getLocal("px")),k.i64_load(k.getLocal("py")))):k.if(k.i64_lt_u(k.i64_load(k.getLocal("px"),O*8),k.i64_load(k.getLocal("py"),O*8)),k.ret(k.i32_const(0)),k.if(k.i64_gt_u(k.i64_load(k.getLocal("px"),O*8),k.i64_load(k.getLocal("py"),O*8)),k.ret(k.i32_const(1)),U(O-1)))}q.addCode(U(r-1)),q.addCode(k.ret(k.i32_const(0)))}function _(){const q=e.addFunction(a+"_add");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32"),q.setReturnType("i32"),q.addLocal("c","i64");const k=q.getCodeBuilder();q.addCode(k.setLocal("c",k.i64_add(k.i64_load32_u(k.getLocal("x")),k.i64_load32_u(k.getLocal("y"))))),q.addCode(k.i64_store32(k.getLocal("r"),k.getLocal("c")));for(let U=1;U<n;U++)q.addCode(k.setLocal("c",k.i64_add(k.i64_add(k.i64_load32_u(k.getLocal("x"),4*U),k.i64_load32_u(k.getLocal("y"),4*U)),k.i64_shr_u(k.getLocal("c"),k.i64_const(32))))),q.addCode(k.i64_store32(k.getLocal("r"),U*4,k.getLocal("c")));q.addCode(k.i32_wrap_i64(k.i64_shr_u(k.getLocal("c"),k.i64_const(32))))}function A(){const q=e.addFunction(a+"_sub");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32"),q.setReturnType("i32"),q.addLocal("c","i64");const k=q.getCodeBuilder();q.addCode(k.setLocal("c",k.i64_sub(k.i64_load32_u(k.getLocal("x")),k.i64_load32_u(k.getLocal("y"))))),q.addCode(k.i64_store32(k.getLocal("r"),k.i64_and(k.getLocal("c"),k.i64_const("0xFFFFFFFF"))));for(let U=1;U<n;U++)q.addCode(k.setLocal("c",k.i64_add(k.i64_sub(k.i64_load32_u(k.getLocal("x"),4*U),k.i64_load32_u(k.getLocal("y"),4*U)),k.i64_shr_s(k.getLocal("c"),k.i64_const(32))))),q.addCode(k.i64_store32(k.getLocal("r"),U*4,k.i64_and(k.getLocal("c"),k.i64_const("0xFFFFFFFF"))));q.addCode(k.i32_wrap_i64(k.i64_shr_s(k.getLocal("c"),k.i64_const(32))))}function S(){const q=e.addFunction(a+"_mul");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32"),q.addLocal("c0","i64"),q.addLocal("c1","i64");for(let l=0;l<n;l++)q.addLocal("x"+l,"i64"),q.addLocal("y"+l,"i64");const k=q.getCodeBuilder(),U=[],O=[];function G(l,d){let p,m;return U[l]?p=k.getLocal("x"+l):(p=k.teeLocal("x"+l,k.i64_load32_u(k.getLocal("x"),l*4)),U[l]=!0),O[d]?m=k.getLocal("y"+d):(m=k.teeLocal("y"+d,k.i64_load32_u(k.getLocal("y"),d*4)),O[d]=!0),k.i64_mul(p,m)}let E="c0",s="c1";for(let l=0;l<n*2-1;l++){for(let d=Math.max(0,l-n+1);d<=l&&d<n;d++){const p=l-d;q.addCode(k.setLocal(E,k.i64_add(k.i64_and(k.getLocal(E),k.i64_const(4294967295)),G(d,p)))),q.addCode(k.setLocal(s,k.i64_add(k.getLocal(s),k.i64_shr_u(k.getLocal(E),k.i64_const(32)))))}q.addCode(k.i64_store32(k.getLocal("r"),l*4,k.getLocal(E))),[E,s]=[s,E],q.addCode(k.setLocal(s,k.i64_shr_u(k.getLocal(E),k.i64_const(32))))}q.addCode(k.i64_store32(k.getLocal("r"),n*4*2-4,k.getLocal(E)))}function T(){const q=e.addFunction(a+"_square");q.addParam("x","i32"),q.addParam("r","i32"),q.addLocal("c0","i64"),q.addLocal("c1","i64"),q.addLocal("c0_old","i64"),q.addLocal("c1_old","i64");for(let d=0;d<n;d++)q.addLocal("x"+d,"i64");const k=q.getCodeBuilder(),U=[];function O(d,p){let m,w;return U[d]?m=k.getLocal("x"+d):(m=k.teeLocal("x"+d,k.i64_load32_u(k.getLocal("x"),d*4)),U[d]=!0),U[p]?w=k.getLocal("x"+p):(w=k.teeLocal("x"+p,k.i64_load32_u(k.getLocal("x"),p*4)),U[p]=!0),k.i64_mul(m,w)}let G="c0",E="c1",s="c0_old",l="c1_old";for(let d=0;d<n*2-1;d++){q.addCode(k.setLocal(G,k.i64_const(0)),k.setLocal(E,k.i64_const(0)));for(let p=Math.max(0,d-n+1);p<d+1>>1&&p<n;p++){const m=d-p;q.addCode(k.setLocal(G,k.i64_add(k.i64_and(k.getLocal(G),k.i64_const(4294967295)),O(p,m)))),q.addCode(k.setLocal(E,k.i64_add(k.getLocal(E),k.i64_shr_u(k.getLocal(G),k.i64_const(32)))))}q.addCode(k.setLocal(G,k.i64_shl(k.i64_and(k.getLocal(G),k.i64_const(4294967295)),k.i64_const(1)))),q.addCode(k.setLocal(E,k.i64_add(k.i64_shl(k.getLocal(E),k.i64_const(1)),k.i64_shr_u(k.getLocal(G),k.i64_const(32))))),d%2==0&&(q.addCode(k.setLocal(G,k.i64_add(k.i64_and(k.getLocal(G),k.i64_const(4294967295)),O(d>>1,d>>1)))),q.addCode(k.setLocal(E,k.i64_add(k.getLocal(E),k.i64_shr_u(k.getLocal(G),k.i64_const(32)))))),d>0&&(q.addCode(k.setLocal(G,k.i64_add(k.i64_and(k.getLocal(G),k.i64_const(4294967295)),k.i64_and(k.getLocal(s),k.i64_const(4294967295))))),q.addCode(k.setLocal(E,k.i64_add(k.i64_add(k.getLocal(E),k.i64_shr_u(k.getLocal(G),k.i64_const(32))),k.getLocal(l))))),q.addCode(k.i64_store32(k.getLocal("r"),d*4,k.getLocal(G))),q.addCode(k.setLocal(s,k.getLocal(E)),k.setLocal(l,k.i64_shr_u(k.getLocal(s),k.i64_const(32))))}q.addCode(k.i64_store32(k.getLocal("r"),n*4*2-4,k.getLocal(s)))}function B(){const q=e.addFunction(a+"_squareOld");q.addParam("x","i32"),q.addParam("r","i32");const k=q.getCodeBuilder();q.addCode(k.call(a+"_mul",k.getLocal("x"),k.getLocal("x"),k.getLocal("r")))}function M(){const q=e.addFunction(a+"__mul1");q.addParam("px","i32"),q.addParam("y","i64"),q.addParam("pr","i32"),q.addLocal("c","i64");const k=q.getCodeBuilder();q.addCode(k.setLocal("c",k.i64_mul(k.i64_load32_u(k.getLocal("px"),0,0),k.getLocal("y")))),q.addCode(k.i64_store32(k.getLocal("pr"),0,0,k.getLocal("c")));for(let U=1;U<n;U++)q.addCode(k.setLocal("c",k.i64_add(k.i64_mul(k.i64_load32_u(k.getLocal("px"),4*U,0),k.getLocal("y")),k.i64_shr_u(k.getLocal("c"),k.i64_const(32))))),q.addCode(k.i64_store32(k.getLocal("pr"),U*4,0,k.getLocal("c")))}function R(){const q=e.addFunction(a+"__add1");q.addParam("x","i32"),q.addParam("y","i64"),q.addLocal("c","i64"),q.addLocal("px","i32");const k=q.getCodeBuilder();q.addCode(k.setLocal("px",k.getLocal("x"))),q.addCode(k.setLocal("c",k.i64_add(k.i64_load32_u(k.getLocal("px"),0,0),k.getLocal("y")))),q.addCode(k.i64_store32(k.getLocal("px"),0,0,k.getLocal("c"))),q.addCode(k.setLocal("c",k.i64_shr_u(k.getLocal("c"),k.i64_const(32)))),q.addCode(k.block(k.loop(k.br_if(1,k.i64_eqz(k.getLocal("c"))),k.setLocal("px",k.i32_add(k.getLocal("px"),k.i32_const(4))),k.setLocal("c",k.i64_add(k.i64_load32_u(k.getLocal("px"),0,0),k.getLocal("c"))),k.i64_store32(k.getLocal("px"),0,0,k.getLocal("c")),k.setLocal("c",k.i64_shr_u(k.getLocal("c"),k.i64_const(32))),k.br(0))))}function P(){M(),R();const q=e.addFunction(a+"_div");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("c","i32"),q.addParam("r","i32"),q.addLocal("rr","i32"),q.addLocal("cc","i32"),q.addLocal("eX","i32"),q.addLocal("eY","i32"),q.addLocal("sy","i64"),q.addLocal("sx","i64"),q.addLocal("ec","i32");const k=q.getCodeBuilder(),U=k.i32_const(e.alloc(c)),O=k.i32_const(e.alloc(c)),G=k.i32_const(e.alloc(c)),E=k.getLocal("cc"),s=k.getLocal("rr"),l=e.alloc(c*2),d=k.i32_const(l),p=k.i32_const(l+c);q.addCode(k.if(k.getLocal("c"),k.setLocal("cc",k.getLocal("c")),k.setLocal("cc",O))),q.addCode(k.if(k.getLocal("r"),k.setLocal("rr",k.getLocal("r")),k.setLocal("rr",G))),q.addCode(k.call(a+"_copy",k.getLocal("x"),s)),q.addCode(k.call(a+"_copy",k.getLocal("y"),U)),q.addCode(k.call(a+"_zero",E)),q.addCode(k.call(a+"_zero",d)),q.addCode(k.setLocal("eX",k.i32_const(c-1))),q.addCode(k.setLocal("eY",k.i32_const(c-1))),q.addCode(k.block(k.loop(k.br_if(1,k.i32_or(k.i32_load8_u(k.i32_add(U,k.getLocal("eY")),0,0),k.i32_eq(k.getLocal("eY"),k.i32_const(3)))),k.setLocal("eY",k.i32_sub(k.getLocal("eY"),k.i32_const(1))),k.br(0)))),q.addCode(k.setLocal("sy",k.i64_add(k.i64_load32_u(k.i32_sub(k.i32_add(U,k.getLocal("eY")),k.i32_const(3)),0,0),k.i64_const(1)))),q.addCode(k.if(k.i64_eq(k.getLocal("sy"),k.i64_const(1)),k.drop(k.i64_div_u(k.i64_const(0),k.i64_const(0))))),q.addCode(k.block(k.loop(k.block(k.loop(k.br_if(1,k.i32_or(k.i32_load8_u(k.i32_add(s,k.getLocal("eX")),0,0),k.i32_eq(k.getLocal("eX"),k.i32_const(7)))),k.setLocal("eX",k.i32_sub(k.getLocal("eX"),k.i32_const(1))),k.br(0))),k.setLocal("sx",k.i64_load(k.i32_sub(k.i32_add(s,k.getLocal("eX")),k.i32_const(7)),0,0)),k.setLocal("sx",k.i64_div_u(k.getLocal("sx"),k.getLocal("sy"))),k.setLocal("ec",k.i32_sub(k.i32_sub(k.getLocal("eX"),k.getLocal("eY")),k.i32_const(4))),k.block(k.loop(k.br_if(1,k.i32_and(k.i64_eqz(k.i64_and(k.getLocal("sx"),k.i64_const("0xFFFFFFFF00000000"))),k.i32_ge_s(k.getLocal("ec"),k.i32_const(0)))),k.setLocal("sx",k.i64_shr_u(k.getLocal("sx"),k.i64_const(8))),k.setLocal("ec",k.i32_add(k.getLocal("ec"),k.i32_const(1))),k.br(0))),k.if(k.i64_eqz(k.getLocal("sx")),[...k.br_if(2,k.i32_eqz(k.call(a+"_gte",s,U))),...k.setLocal("sx",k.i64_const(1)),...k.setLocal("ec",k.i32_const(0))]),k.call(a+"__mul1",U,k.getLocal("sx"),p),k.drop(k.call(a+"_sub",s,k.i32_sub(p,k.getLocal("ec")),s)),k.call(a+"__add1",k.i32_add(E,k.getLocal("ec")),k.getLocal("sx")),k.br(0))))}function D(){const q=e.addFunction(a+"_inverseMod");q.addParam("px","i32"),q.addParam("pm","i32"),q.addParam("pr","i32"),q.addLocal("t","i32"),q.addLocal("newt","i32"),q.addLocal("r","i32"),q.addLocal("qq","i32"),q.addLocal("qr","i32"),q.addLocal("newr","i32"),q.addLocal("swp","i32"),q.addLocal("x","i32"),q.addLocal("signt","i32"),q.addLocal("signnewt","i32"),q.addLocal("signx","i32");const k=q.getCodeBuilder(),U=k.i32_const(e.alloc(c)),O=k.i32_const(e.alloc(c)),G=k.i32_const(e.alloc(c)),E=k.i32_const(e.alloc(c)),s=k.i32_const(e.alloc(c)),l=k.i32_const(e.alloc(c)),d=k.i32_const(e.alloc(c*2)),p=k.i32_const(e.alloc(c));q.addCode(k.setLocal("t",U),k.call(a+"_zero",U),k.setLocal("signt",k.i32_const(0))),q.addCode(k.setLocal("r",O),k.call(a+"_copy",k.getLocal("pm"),O)),q.addCode(k.setLocal("newt",G),k.call(a+"_one",G),k.setLocal("signnewt",k.i32_const(0))),q.addCode(k.setLocal("newr",E),k.call(a+"_copy",k.getLocal("px"),E)),q.addCode(k.setLocal("qq",s)),q.addCode(k.setLocal("qr",l)),q.addCode(k.setLocal("x",p)),q.addCode(k.block(k.loop(k.br_if(1,k.call(a+"_isZero",k.getLocal("newr"))),k.call(a+"_div",k.getLocal("r"),k.getLocal("newr"),k.getLocal("qq"),k.getLocal("qr")),k.call(a+"_mul",k.getLocal("qq"),k.getLocal("newt"),d),k.if(k.getLocal("signt"),k.if(k.getLocal("signnewt"),k.if(k.call(a+"_gte",d,k.getLocal("t")),[...k.drop(k.call(a+"_sub",d,k.getLocal("t"),k.getLocal("x"))),...k.setLocal("signx",k.i32_const(0))],[...k.drop(k.call(a+"_sub",k.getLocal("t"),d,k.getLocal("x"))),...k.setLocal("signx",k.i32_const(1))]),[...k.drop(k.call(a+"_add",d,k.getLocal("t"),k.getLocal("x"))),...k.setLocal("signx",k.i32_const(1))]),k.if(k.getLocal("signnewt"),[...k.drop(k.call(a+"_add",d,k.getLocal("t"),k.getLocal("x"))),...k.setLocal("signx",k.i32_const(0))],k.if(k.call(a+"_gte",k.getLocal("t"),d),[...k.drop(k.call(a+"_sub",k.getLocal("t"),d,k.getLocal("x"))),...k.setLocal("signx",k.i32_const(0))],[...k.drop(k.call(a+"_sub",d,k.getLocal("t"),k.getLocal("x"))),...k.setLocal("signx",k.i32_const(1))]))),k.setLocal("swp",k.getLocal("t")),k.setLocal("t",k.getLocal("newt")),k.setLocal("newt",k.getLocal("x")),k.setLocal("x",k.getLocal("swp")),k.setLocal("signt",k.getLocal("signnewt")),k.setLocal("signnewt",k.getLocal("signx")),k.setLocal("swp",k.getLocal("r")),k.setLocal("r",k.getLocal("newr")),k.setLocal("newr",k.getLocal("qr")),k.setLocal("qr",k.getLocal("swp")),k.br(0)))),q.addCode(k.if(k.getLocal("signt"),k.drop(k.call(a+"_sub",k.getLocal("pm"),k.getLocal("t"),k.getLocal("pr"))),k.call(a+"_copy",k.getLocal("t"),k.getLocal("pr"))))}return u(),v(),h(),o(),g(),y(),_(),A(),S(),T(),B(),P(),D(),e.exportFunction(a+"_copy"),e.exportFunction(a+"_zero"),e.exportFunction(a+"_one"),e.exportFunction(a+"_isZero"),e.exportFunction(a+"_eq"),e.exportFunction(a+"_gte"),e.exportFunction(a+"_add"),e.exportFunction(a+"_sub"),e.exportFunction(a+"_mul"),e.exportFunction(a+"_square"),e.exportFunction(a+"_squareOld"),e.exportFunction(a+"_div"),e.exportFunction(a+"_inverseMod"),a},C1=function(e,r,t,a,n,c,u){const v=e.addFunction(r);v.addParam("base","i32"),v.addParam("scalar","i32"),v.addParam("scalarLength","i32"),v.addParam("r","i32"),v.addLocal("i","i32"),v.addLocal("b","i32");const o=v.getCodeBuilder(),h=o.i32_const(e.alloc(t));v.addCode(o.if(o.i32_eqz(o.getLocal("scalarLength")),[...o.call(u,o.getLocal("r")),...o.ret([])])),v.addCode(o.call(c,o.getLocal("base"),h)),v.addCode(o.call(u,o.getLocal("r"))),v.addCode(o.setLocal("i",o.getLocal("scalarLength"))),v.addCode(o.block(o.loop(o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.setLocal("b",o.i32_load8_u(o.i32_add(o.getLocal("scalar"),o.getLocal("i")))),...g(),o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.br(0))));function g(){const y=[];for(let _=0;_<8;_++)y.push(...o.call(n,o.getLocal("r"),o.getLocal("r")),...o.if(o.i32_ge_u(o.getLocal("b"),o.i32_const(128>>_)),[...o.setLocal("b",o.i32_sub(o.getLocal("b"),o.i32_const(128>>_))),...o.call(a,o.getLocal("r"),h,o.getLocal("r"))]));return y}},E1=uC;function uC(i,e){const r=i.modules[e].n64*8,t=i.addFunction(e+"_batchInverse");t.addParam("pIn","i32"),t.addParam("inStep","i32"),t.addParam("n","i32"),t.addParam("pOut","i32"),t.addParam("outStep","i32"),t.addLocal("itAux","i32"),t.addLocal("itIn","i32"),t.addLocal("itOut","i32"),t.addLocal("i","i32");const a=t.getCodeBuilder(),n=a.i32_const(i.alloc(r));t.addCode(a.setLocal("itAux",a.i32_load(a.i32_const(0))),a.i32_store(a.i32_const(0),a.i32_add(a.getLocal("itAux"),a.i32_mul(a.i32_add(a.getLocal("n"),a.i32_const(1)),a.i32_const(r))))),t.addCode(a.call(e+"_one",a.getLocal("itAux")),a.setLocal("itIn",a.getLocal("pIn")),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(r))),a.setLocal("i",a.i32_const(0)),a.block(a.loop(a.br_if(1,a.i32_eq(a.getLocal("i"),a.getLocal("n"))),a.if(a.call(e+"_isZero",a.getLocal("itIn")),a.call(e+"_copy",a.i32_sub(a.getLocal("itAux"),a.i32_const(r)),a.getLocal("itAux")),a.call(e+"_mul",a.getLocal("itIn"),a.i32_sub(a.getLocal("itAux"),a.i32_const(r)),a.getLocal("itAux"))),a.setLocal("itIn",a.i32_add(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itAux",a.i32_add(a.getLocal("itAux"),a.i32_const(r))),a.setLocal("i",a.i32_add(a.getLocal("i"),a.i32_const(1))),a.br(0))),a.setLocal("itIn",a.i32_sub(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itAux",a.i32_sub(a.getLocal("itAux"),a.i32_const(r))),a.setLocal("itOut",a.i32_add(a.getLocal("pOut"),a.i32_mul(a.i32_sub(a.getLocal("n"),a.i32_const(1)),a.getLocal("outStep")))),a.call(e+"_inverse",a.getLocal("itAux"),a.getLocal("itAux")),a.block(a.loop(a.br_if(1,a.i32_eqz(a.getLocal("i"))),a.if(a.call(e+"_isZero",a.getLocal("itIn")),[...a.call(e+"_copy",a.getLocal("itAux"),a.i32_sub(a.getLocal("itAux"),a.i32_const(r))),...a.call(e+"_zero",a.getLocal("itOut"))],[...a.call(e+"_copy",a.i32_sub(a.getLocal("itAux"),a.i32_const(r)),n),...a.call(e+"_mul",a.getLocal("itAux"),a.getLocal("itIn"),a.i32_sub(a.getLocal("itAux"),a.i32_const(r))),...a.call(e+"_mul",a.getLocal("itAux"),n,a.getLocal("itOut"))]),a.setLocal("itIn",a.i32_sub(a.getLocal("itIn"),a.getLocal("inStep"))),a.setLocal("itOut",a.i32_sub(a.getLocal("itOut"),a.getLocal("outStep"))),a.setLocal("itAux",a.i32_sub(a.getLocal("itAux"),a.i32_const(r))),a.setLocal("i",a.i32_sub(a.getLocal("i"),a.i32_const(1))),a.br(0)))),t.addCode(a.i32_store(a.i32_const(0),a.getLocal("itAux")))}var wb=hC;function hC(i,e,r,t,a,n){typeof n>"u"&&(t<a?n=!0:n=!1);const c=i.addFunction(e);c.addParam("pIn","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn","i32"),c.addLocal("itOut","i32");const u=c.getCodeBuilder();n?c.addCode(u.setLocal("itIn",u.i32_add(u.getLocal("pIn"),u.i32_mul(u.i32_sub(u.getLocal("n"),u.i32_const(1)),u.i32_const(t)))),u.setLocal("itOut",u.i32_add(u.getLocal("pOut"),u.i32_mul(u.i32_sub(u.getLocal("n"),u.i32_const(1)),u.i32_const(a)))),u.setLocal("i",u.i32_const(0)),u.block(u.loop(u.br_if(1,u.i32_eq(u.getLocal("i"),u.getLocal("n"))),u.call(r,u.getLocal("itIn"),u.getLocal("itOut")),u.setLocal("itIn",u.i32_sub(u.getLocal("itIn"),u.i32_const(t))),u.setLocal("itOut",u.i32_sub(u.getLocal("itOut"),u.i32_const(a))),u.setLocal("i",u.i32_add(u.getLocal("i"),u.i32_const(1))),u.br(0)))):c.addCode(u.setLocal("itIn",u.getLocal("pIn")),u.setLocal("itOut",u.getLocal("pOut")),u.setLocal("i",u.i32_const(0)),u.block(u.loop(u.br_if(1,u.i32_eq(u.getLocal("i"),u.getLocal("n"))),u.call(r,u.getLocal("itIn"),u.getLocal("itOut")),u.setLocal("itIn",u.i32_add(u.getLocal("itIn"),u.i32_const(t))),u.setLocal("itOut",u.i32_add(u.getLocal("itOut"),u.i32_const(a))),u.setLocal("i",u.i32_add(u.getLocal("i"),u.i32_const(1))),u.br(0))))}var dC=pC;function pC(i,e,r,t,a,n){typeof n>"u"&&(t<a?n=!0:n=!1);const c=i.addFunction(e);c.addParam("pIn1","i32"),c.addParam("pIn2","i32"),c.addParam("n","i32"),c.addParam("pOut","i32"),c.addLocal("i","i32"),c.addLocal("itIn1","i32"),c.addLocal("itIn2","i32"),c.addLocal("itOut","i32");const u=c.getCodeBuilder();n?c.addCode(u.setLocal("itIn1",u.i32_add(u.getLocal("pIn1"),u.i32_mul(u.i32_sub(u.getLocal("n"),u.i32_const(1)),u.i32_const(t)))),u.setLocal("itIn2",u.i32_add(u.getLocal("pIn2"),u.i32_mul(u.i32_sub(u.getLocal("n"),u.i32_const(1)),u.i32_const(t)))),u.setLocal("itOut",u.i32_add(u.getLocal("pOut"),u.i32_mul(u.i32_sub(u.getLocal("n"),u.i32_const(1)),u.i32_const(a)))),u.setLocal("i",u.i32_const(0)),u.block(u.loop(u.br_if(1,u.i32_eq(u.getLocal("i"),u.getLocal("n"))),u.call(r,u.getLocal("itIn1"),u.getLocal("itIn2"),u.getLocal("itOut")),u.setLocal("itIn1",u.i32_sub(u.getLocal("itIn1"),u.i32_const(t))),u.setLocal("itIn2",u.i32_sub(u.getLocal("itIn2"),u.i32_const(t))),u.setLocal("itOut",u.i32_sub(u.getLocal("itOut"),u.i32_const(a))),u.setLocal("i",u.i32_add(u.getLocal("i"),u.i32_const(1))),u.br(0)))):c.addCode(u.setLocal("itIn1",u.getLocal("pIn1")),u.setLocal("itIn2",u.getLocal("pIn2")),u.setLocal("itOut",u.getLocal("pOut")),u.setLocal("i",u.i32_const(0)),u.block(u.loop(u.br_if(1,u.i32_eq(u.getLocal("i"),u.getLocal("n"))),u.call(r,u.getLocal("itIn1"),u.getLocal("itIn2"),u.getLocal("itOut")),u.setLocal("itIn1",u.i32_add(u.getLocal("itIn1"),u.i32_const(t))),u.setLocal("itIn2",u.i32_add(u.getLocal("itIn2"),u.i32_const(t))),u.setLocal("itOut",u.i32_add(u.getLocal("itOut"),u.i32_const(a))),u.setLocal("i",u.i32_add(u.getLocal("i"),u.i32_const(1))),u.br(0))))}var yi={};function Cb(i,e){return i===e?0:i>e?1:-1}function A1(i){return i*i}function Eb(i){return i%2n!==0n}function S1(i){return i%2n===0n}function Kl(i){return i<0n}function vC(i){return i>0n}function Ab(i){return Kl(i)?i.toString(2).length-1:i.toString(2).length}function jo(i){return i<0n?-i:i}function _s(i){return jo(i)===1n}function Sb(i,e){for(var r=0n,t=1n,a=e,n=jo(i),c,u,v;n!==0n;)c=a/n,u=r,v=a,r=t,a=n,t=u-c*t,n=v-c*n;if(!_s(a))throw new Error(i.toString()+" and "+e.toString()+" are not co-prime");return Cb(r,0n)===-1&&(r=r+e),Kl(i)?-r:r}function xb(i,e,r){if(r===0n)throw new Error("Cannot take modPow with modulus 0");var t=1n,a=i%r;for(Kl(e)&&(e=e*-1n,a=Sb(a,r));vC(e);){if(a===0n)return 0n;Eb(e)&&(t=t*a%r),e=e/2n,a=A1(a)%r}return t}function gC(i,e){return i=i>=0n?i:-i,e=e>=0n?e:-e,i===e?0:i>e?1:-1}function zg(i,e){return e===0n?!1:_s(e)?!0:gC(e,2n)===0?S1(i):i%e===0n}function mC(i){var e=jo(i);if(_s(e))return!1;if(e===2n||e===3n||e===5n)return!0;if(S1(e)||zg(e,3n)||zg(e,5n))return!1;if(e<49n)return!0}function yC(i){return i-1n}function Vg(i,e){for(var r=yC(i),t=r,a=0,n,c,u;S1(t);)t=t/2n,a++;t:for(c=0;c<e.length;c++)if(!(i<e[c])&&(u=xb(BigInt(e[c]),t,i),!(_s(u)||u===r))){for(n=a-1;n!=0;n--){if(u=A1(u)%i,_s(u))return!1;if(u===r)continue t}return!1}return!0}function bC(i){var e=mC(i);if(e!==void 0)return e;var r=jo(i),t=Ab(r);if(t<=64)return Vg(r,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var a=Math.log(2)*Number(t),n=Math.ceil(a),c=[],u=0;u<n;u++)c.push(BigInt(u+2));return Vg(r,c)}yi.bitLength=Ab;yi.isOdd=Eb;yi.isNegative=Kl;yi.abs=jo;yi.isUnit=_s;yi.compare=Cb;yi.modInv=Sb;yi.modPow=xb;yi.isPrime=bC;yi.square=A1;const _C=cC,Ln=wa,wC=C1,CC=E1,J0=wb,th=dC,{bitLength:EC,modInv:eh,modPow:Gg,isPrime:Kg,isOdd:AC,square:SC}=yi;var x1=function(e,r,t,a){const n=BigInt(r),c=Math.floor((EC(n-1n)-1)/64)+1,u=c*2,v=c*8,o=t||"f1m";if(e.modules[o])return o;const h=_C(e,c,a),g=e.alloc(v,Ln.bigInt2BytesLE(n,v)),y=e.alloc(Ln.bigInt2BytesLE(SC(1n<<BigInt(c*64))%n,v)),_=e.alloc(Ln.bigInt2BytesLE((1n<<BigInt(c*64))%n,v)),A=e.alloc(Ln.bigInt2BytesLE(0n,v)),S=n-1n,T=S>>1n,B=e.alloc(v,Ln.bigInt2BytesLE(T,v)),M=T+1n,R=e.alloc(v,Ln.bigInt2BytesLE(M,v));e.modules[o]={pq:g,pR2:y,n64:c,q:n,pOne:_,pZero:A,pePlusOne:R};function P(){const Q=e.addFunction(o+"_one");Q.addParam("pr","i32");const L=Q.getCodeBuilder();Q.addCode(L.call(h+"_copy",L.i32_const(_),L.getLocal("pr")))}function D(){const Q=e.addFunction(o+"_add");Q.addParam("x","i32"),Q.addParam("y","i32"),Q.addParam("r","i32");const L=Q.getCodeBuilder();Q.addCode(L.if(L.call(h+"_add",L.getLocal("x"),L.getLocal("y"),L.getLocal("r")),L.drop(L.call(h+"_sub",L.getLocal("r"),L.i32_const(g),L.getLocal("r"))),L.if(L.call(h+"_gte",L.getLocal("r"),L.i32_const(g)),L.drop(L.call(h+"_sub",L.getLocal("r"),L.i32_const(g),L.getLocal("r"))))))}function q(){const Q=e.addFunction(o+"_sub");Q.addParam("x","i32"),Q.addParam("y","i32"),Q.addParam("r","i32");const L=Q.getCodeBuilder();Q.addCode(L.if(L.call(h+"_sub",L.getLocal("x"),L.getLocal("y"),L.getLocal("r")),L.drop(L.call(h+"_add",L.getLocal("r"),L.i32_const(g),L.getLocal("r")))))}function k(){const Q=e.addFunction(o+"_neg");Q.addParam("x","i32"),Q.addParam("r","i32");const L=Q.getCodeBuilder();Q.addCode(L.call(o+"_sub",L.i32_const(A),L.getLocal("x"),L.getLocal("r")))}function U(){const Q=e.addFunction(o+"_isNegative");Q.addParam("x","i32"),Q.setReturnType("i32");const L=Q.getCodeBuilder(),V=L.i32_const(e.alloc(v));Q.addCode(L.call(o+"_fromMontgomery",L.getLocal("x"),V),L.call(h+"_gte",V,L.i32_const(R)))}function O(){const Q=e.addFunction(o+"_sign");Q.addParam("x","i32"),Q.setReturnType("i32");const L=Q.getCodeBuilder(),V=L.i32_const(e.alloc(v));Q.addCode(L.if(L.call(h+"_isZero",L.getLocal("x")),L.ret(L.i32_const(0))),L.call(o+"_fromMontgomery",L.getLocal("x"),V),L.if(L.call(h+"_gte",V,L.i32_const(R)),L.ret(L.i32_const(-1))),L.ret(L.i32_const(1)))}function G(){const Q=e.alloc(u*u*8),L=e.addFunction(o+"_mReduct");L.addParam("t","i32"),L.addParam("r","i32"),L.addLocal("np32","i64"),L.addLocal("c","i64"),L.addLocal("m","i64");const V=L.getCodeBuilder(),Z=Number(0x100000000n-eh(n,0x100000000n));L.addCode(V.setLocal("np32",V.i64_const(Z)));for(let H=0;H<u;H++){L.addCode(V.setLocal("c",V.i64_const(0))),L.addCode(V.setLocal("m",V.i64_and(V.i64_mul(V.i64_load32_u(V.getLocal("t"),H*4),V.getLocal("np32")),V.i64_const("0xFFFFFFFF"))));for(let j=0;j<u;j++)L.addCode(V.setLocal("c",V.i64_add(V.i64_add(V.i64_load32_u(V.getLocal("t"),(H+j)*4),V.i64_shr_u(V.getLocal("c"),V.i64_const(32))),V.i64_mul(V.i64_load32_u(V.i32_const(g),j*4),V.getLocal("m"))))),L.addCode(V.i64_store32(V.getLocal("t"),(H+j)*4,V.getLocal("c")));L.addCode(V.i64_store32(V.i32_const(Q),H*4,V.i64_shr_u(V.getLocal("c"),V.i64_const(32))))}L.addCode(V.call(o+"_add",V.i32_const(Q),V.i32_add(V.getLocal("t"),V.i32_const(u*4)),V.getLocal("r")))}function E(){const Q=e.addFunction(o+"_mul");Q.addParam("x","i32"),Q.addParam("y","i32"),Q.addParam("r","i32"),Q.addLocal("c0","i64"),Q.addLocal("c1","i64"),Q.addLocal("np32","i64");for(let vt=0;vt<u;vt++)Q.addLocal("x"+vt,"i64"),Q.addLocal("y"+vt,"i64"),Q.addLocal("m"+vt,"i64"),Q.addLocal("q"+vt,"i64");const L=Q.getCodeBuilder(),V=Number(0x100000000n-eh(n,0x100000000n));Q.addCode(L.setLocal("np32",L.i64_const(V)));const Z=[],H=[],j=[];function et(vt,ot){let pt,Ut;return Z[vt]?pt=L.getLocal("x"+vt):(pt=L.teeLocal("x"+vt,L.i64_load32_u(L.getLocal("x"),vt*4)),Z[vt]=!0),H[ot]?Ut=L.getLocal("y"+ot):(Ut=L.teeLocal("y"+ot,L.i64_load32_u(L.getLocal("y"),ot*4)),H[ot]=!0),L.i64_mul(pt,Ut)}function nt(vt,ot){let pt,Ut;return j[vt]?pt=L.getLocal("q"+vt):(pt=L.teeLocal("q"+vt,L.i64_load32_u(L.i32_const(0),g+vt*4)),j[vt]=!0),Ut=L.getLocal("m"+ot),L.i64_mul(pt,Ut)}let st="c0",ft="c1";for(let vt=0;vt<u*2-1;vt++){for(let ot=Math.max(0,vt-u+1);ot<=vt&&ot<u;ot++){const pt=vt-ot;Q.addCode(L.setLocal(st,L.i64_add(L.i64_and(L.getLocal(st),L.i64_const(4294967295)),et(ot,pt)))),Q.addCode(L.setLocal(ft,L.i64_add(L.getLocal(ft),L.i64_shr_u(L.getLocal(st),L.i64_const(32)))))}for(let ot=Math.max(1,vt-u+1);ot<=vt&&ot<u;ot++){const pt=vt-ot;Q.addCode(L.setLocal(st,L.i64_add(L.i64_and(L.getLocal(st),L.i64_const(4294967295)),nt(ot,pt)))),Q.addCode(L.setLocal(ft,L.i64_add(L.getLocal(ft),L.i64_shr_u(L.getLocal(st),L.i64_const(32)))))}vt<u&&(Q.addCode(L.setLocal("m"+vt,L.i64_and(L.i64_mul(L.i64_and(L.getLocal(st),L.i64_const(4294967295)),L.getLocal("np32")),L.i64_const("0xFFFFFFFF")))),Q.addCode(L.setLocal(st,L.i64_add(L.i64_and(L.getLocal(st),L.i64_const(4294967295)),nt(0,vt)))),Q.addCode(L.setLocal(ft,L.i64_add(L.getLocal(ft),L.i64_shr_u(L.getLocal(st),L.i64_const(32)))))),vt>=u&&Q.addCode(L.i64_store32(L.getLocal("r"),(vt-u)*4,L.getLocal(st))),[st,ft]=[ft,st],Q.addCode(L.setLocal(ft,L.i64_shr_u(L.getLocal(st),L.i64_const(32))))}Q.addCode(L.i64_store32(L.getLocal("r"),u*4-4,L.getLocal(st))),Q.addCode(L.if(L.i32_wrap_i64(L.getLocal(ft)),L.drop(L.call(h+"_sub",L.getLocal("r"),L.i32_const(g),L.getLocal("r"))),L.if(L.call(h+"_gte",L.getLocal("r"),L.i32_const(g)),L.drop(L.call(h+"_sub",L.getLocal("r"),L.i32_const(g),L.getLocal("r"))))))}function s(){const Q=e.addFunction(o+"_square");Q.addParam("x","i32"),Q.addParam("r","i32"),Q.addLocal("c0","i64"),Q.addLocal("c1","i64"),Q.addLocal("c0_old","i64"),Q.addLocal("c1_old","i64"),Q.addLocal("np32","i64");for(let ot=0;ot<u;ot++)Q.addLocal("x"+ot,"i64"),Q.addLocal("m"+ot,"i64"),Q.addLocal("q"+ot,"i64");const L=Q.getCodeBuilder(),V=Number(0x100000000n-eh(n,0x100000000n));Q.addCode(L.setLocal("np32",L.i64_const(V)));const Z=[],H=[];function j(ot,pt){let Ut,At;return Z[ot]?Ut=L.getLocal("x"+ot):(Ut=L.teeLocal("x"+ot,L.i64_load32_u(L.getLocal("x"),ot*4)),Z[ot]=!0),Z[pt]?At=L.getLocal("x"+pt):(At=L.teeLocal("x"+pt,L.i64_load32_u(L.getLocal("x"),pt*4)),Z[pt]=!0),L.i64_mul(Ut,At)}function et(ot,pt){let Ut,At;return H[ot]?Ut=L.getLocal("q"+ot):(Ut=L.teeLocal("q"+ot,L.i64_load32_u(L.i32_const(0),g+ot*4)),H[ot]=!0),At=L.getLocal("m"+pt),L.i64_mul(Ut,At)}let nt="c0",st="c1",ft="c0_old",vt="c1_old";for(let ot=0;ot<u*2-1;ot++){Q.addCode(L.setLocal(nt,L.i64_const(0)),L.setLocal(st,L.i64_const(0)));for(let pt=Math.max(0,ot-u+1);pt<ot+1>>1&&pt<u;pt++){const Ut=ot-pt;Q.addCode(L.setLocal(nt,L.i64_add(L.i64_and(L.getLocal(nt),L.i64_const(4294967295)),j(pt,Ut)))),Q.addCode(L.setLocal(st,L.i64_add(L.getLocal(st),L.i64_shr_u(L.getLocal(nt),L.i64_const(32)))))}Q.addCode(L.setLocal(nt,L.i64_shl(L.i64_and(L.getLocal(nt),L.i64_const(4294967295)),L.i64_const(1)))),Q.addCode(L.setLocal(st,L.i64_add(L.i64_shl(L.getLocal(st),L.i64_const(1)),L.i64_shr_u(L.getLocal(nt),L.i64_const(32))))),ot%2==0&&(Q.addCode(L.setLocal(nt,L.i64_add(L.i64_and(L.getLocal(nt),L.i64_const(4294967295)),j(ot>>1,ot>>1)))),Q.addCode(L.setLocal(st,L.i64_add(L.getLocal(st),L.i64_shr_u(L.getLocal(nt),L.i64_const(32)))))),ot>0&&(Q.addCode(L.setLocal(nt,L.i64_add(L.i64_and(L.getLocal(nt),L.i64_const(4294967295)),L.i64_and(L.getLocal(ft),L.i64_const(4294967295))))),Q.addCode(L.setLocal(st,L.i64_add(L.i64_add(L.getLocal(st),L.i64_shr_u(L.getLocal(nt),L.i64_const(32))),L.getLocal(vt)))));for(let pt=Math.max(1,ot-u+1);pt<=ot&&pt<u;pt++){const Ut=ot-pt;Q.addCode(L.setLocal(nt,L.i64_add(L.i64_and(L.getLocal(nt),L.i64_const(4294967295)),et(pt,Ut)))),Q.addCode(L.setLocal(st,L.i64_add(L.getLocal(st),L.i64_shr_u(L.getLocal(nt),L.i64_const(32)))))}ot<u&&(Q.addCode(L.setLocal("m"+ot,L.i64_and(L.i64_mul(L.i64_and(L.getLocal(nt),L.i64_const(4294967295)),L.getLocal("np32")),L.i64_const("0xFFFFFFFF")))),Q.addCode(L.setLocal(nt,L.i64_add(L.i64_and(L.getLocal(nt),L.i64_const(4294967295)),et(0,ot)))),Q.addCode(L.setLocal(st,L.i64_add(L.getLocal(st),L.i64_shr_u(L.getLocal(nt),L.i64_const(32)))))),ot>=u&&Q.addCode(L.i64_store32(L.getLocal("r"),(ot-u)*4,L.getLocal(nt))),Q.addCode(L.setLocal(ft,L.getLocal(st)),L.setLocal(vt,L.i64_shr_u(L.getLocal(ft),L.i64_const(32))))}Q.addCode(L.i64_store32(L.getLocal("r"),u*4-4,L.getLocal(ft))),Q.addCode(L.if(L.i32_wrap_i64(L.getLocal(vt)),L.drop(L.call(h+"_sub",L.getLocal("r"),L.i32_const(g),L.getLocal("r"))),L.if(L.call(h+"_gte",L.getLocal("r"),L.i32_const(g)),L.drop(L.call(h+"_sub",L.getLocal("r"),L.i32_const(g),L.getLocal("r"))))))}function l(){const Q=e.addFunction(o+"_squareOld");Q.addParam("x","i32"),Q.addParam("r","i32");const L=Q.getCodeBuilder();Q.addCode(L.call(o+"_mul",L.getLocal("x"),L.getLocal("x"),L.getLocal("r")))}function d(){const Q=e.addFunction(o+"_toMontgomery");Q.addParam("x","i32"),Q.addParam("r","i32");const L=Q.getCodeBuilder();Q.addCode(L.call(o+"_mul",L.getLocal("x"),L.i32_const(y),L.getLocal("r")))}function p(){const Q=e.alloc(v*2),L=e.addFunction(o+"_fromMontgomery");L.addParam("x","i32"),L.addParam("r","i32");const V=L.getCodeBuilder();L.addCode(V.call(h+"_copy",V.getLocal("x"),V.i32_const(Q))),L.addCode(V.call(h+"_zero",V.i32_const(Q+v))),L.addCode(V.call(o+"_mReduct",V.i32_const(Q),V.getLocal("r")))}function m(){const Q=e.addFunction(o+"_inverse");Q.addParam("x","i32"),Q.addParam("r","i32");const L=Q.getCodeBuilder();Q.addCode(L.call(o+"_fromMontgomery",L.getLocal("x"),L.getLocal("r"))),Q.addCode(L.call(h+"_inverseMod",L.getLocal("r"),L.i32_const(g),L.getLocal("r"))),Q.addCode(L.call(o+"_toMontgomery",L.getLocal("r"),L.getLocal("r")))}let w=2n;if(Kg(n))for(;Gg(w,T,n)!==S;)w=w+1n;let x=0,b=S;for(;!AC(b)&&b!==0n;)x++,b=b>>1n;const f=e.alloc(v,Ln.bigInt2BytesLE(b,v)),C=Gg(w,b,n),F=e.alloc(Ln.bigInt2BytesLE((C<<BigInt(c*64))%n,v)),z=b+1n>>1n,W=e.alloc(v,Ln.bigInt2BytesLE(z,v));function $(){const Q=e.addFunction(o+"_sqrt");Q.addParam("n","i32"),Q.addParam("r","i32"),Q.addLocal("m","i32"),Q.addLocal("i","i32"),Q.addLocal("j","i32");const L=Q.getCodeBuilder(),V=L.i32_const(_),Z=L.i32_const(e.alloc(v)),H=L.i32_const(e.alloc(v)),j=L.i32_const(e.alloc(v)),et=L.i32_const(e.alloc(v)),nt=L.i32_const(e.alloc(v));Q.addCode(L.if(L.call(o+"_isZero",L.getLocal("n")),L.ret(L.call(o+"_zero",L.getLocal("r")))),L.setLocal("m",L.i32_const(x)),L.call(o+"_copy",L.i32_const(F),Z),L.call(o+"_exp",L.getLocal("n"),L.i32_const(f),L.i32_const(v),H),L.call(o+"_exp",L.getLocal("n"),L.i32_const(W),L.i32_const(v),j),L.block(L.loop(L.br_if(1,L.call(o+"_eq",H,V)),L.call(o+"_square",H,et),L.setLocal("i",L.i32_const(1)),L.block(L.loop(L.br_if(1,L.call(o+"_eq",et,V)),L.call(o+"_square",et,et),L.setLocal("i",L.i32_add(L.getLocal("i"),L.i32_const(1))),L.br(0))),L.call(o+"_copy",Z,nt),L.setLocal("j",L.i32_sub(L.i32_sub(L.getLocal("m"),L.getLocal("i")),L.i32_const(1))),L.block(L.loop(L.br_if(1,L.i32_eqz(L.getLocal("j"))),L.call(o+"_square",nt,nt),L.setLocal("j",L.i32_sub(L.getLocal("j"),L.i32_const(1))),L.br(0))),L.setLocal("m",L.getLocal("i")),L.call(o+"_square",nt,Z),L.call(o+"_mul",H,Z,H),L.call(o+"_mul",j,nt,j),L.br(0))),L.if(L.call(o+"_isNegative",j),L.call(o+"_neg",j,L.getLocal("r")),L.call(o+"_copy",j,L.getLocal("r"))))}function I(){const Q=e.addFunction(o+"_isSquare");Q.addParam("n","i32"),Q.setReturnType("i32");const L=Q.getCodeBuilder(),V=L.i32_const(_),Z=L.i32_const(e.alloc(v));Q.addCode(L.if(L.call(o+"_isZero",L.getLocal("n")),L.ret(L.i32_const(1))),L.call(o+"_exp",L.getLocal("n"),L.i32_const(B),L.i32_const(v),Z),L.call(o+"_eq",Z,V))}function K(){const Q=e.addFunction(o+"_load");Q.addParam("scalar","i32"),Q.addParam("scalarLen","i32"),Q.addParam("r","i32"),Q.addLocal("p","i32"),Q.addLocal("l","i32"),Q.addLocal("i","i32"),Q.addLocal("j","i32");const L=Q.getCodeBuilder(),V=L.i32_const(e.alloc(v)),Z=e.alloc(v),H=L.i32_const(Z);Q.addCode(L.call(h+"_zero",L.getLocal("r")),L.setLocal("i",L.i32_const(v)),L.setLocal("p",L.getLocal("scalar")),L.block(L.loop(L.br_if(1,L.i32_gt_u(L.getLocal("i"),L.getLocal("scalarLen"))),L.if(L.i32_eq(L.getLocal("i"),L.i32_const(v)),L.call(o+"_one",V),L.call(o+"_mul",V,L.i32_const(y),V)),L.call(o+"_mul",L.getLocal("p"),V,H),L.call(o+"_add",L.getLocal("r"),H,L.getLocal("r")),L.setLocal("p",L.i32_add(L.getLocal("p"),L.i32_const(v))),L.setLocal("i",L.i32_add(L.getLocal("i"),L.i32_const(v))),L.br(0))),L.setLocal("l",L.i32_rem_u(L.getLocal("scalarLen"),L.i32_const(v))),L.if(L.i32_eqz(L.getLocal("l")),L.ret([])),L.call(h+"_zero",H),L.setLocal("j",L.i32_const(0)),L.block(L.loop(L.br_if(1,L.i32_eq(L.getLocal("j"),L.getLocal("l"))),L.i32_store8(L.getLocal("j"),Z,L.i32_load8_u(L.getLocal("p"))),L.setLocal("p",L.i32_add(L.getLocal("p"),L.i32_const(1))),L.setLocal("j",L.i32_add(L.getLocal("j"),L.i32_const(1))),L.br(0))),L.if(L.i32_eq(L.getLocal("i"),L.i32_const(v)),L.call(o+"_one",V),L.call(o+"_mul",V,L.i32_const(y),V)),L.call(o+"_mul",H,V,H),L.call(o+"_add",L.getLocal("r"),H,L.getLocal("r")))}function N(){const Q=e.addFunction(o+"_timesScalar");Q.addParam("x","i32"),Q.addParam("scalar","i32"),Q.addParam("scalarLen","i32"),Q.addParam("r","i32");const L=Q.getCodeBuilder(),V=L.i32_const(e.alloc(v));Q.addCode(L.call(o+"_load",L.getLocal("scalar"),L.getLocal("scalarLen"),V),L.call(o+"_toMontgomery",V,V),L.call(o+"_mul",L.getLocal("x"),V,L.getLocal("r")))}function X(){const Q=e.addFunction(o+"_isOne");Q.addParam("x","i32"),Q.setReturnType("i32");const L=Q.getCodeBuilder();Q.addCode(L.ret(L.call(h+"_eq",L.getLocal("x"),L.i32_const(_))))}return e.exportFunction(h+"_copy",o+"_copy"),e.exportFunction(h+"_zero",o+"_zero"),e.exportFunction(h+"_isZero",o+"_isZero"),e.exportFunction(h+"_eq",o+"_eq"),X(),D(),q(),k(),G(),E(),s(),l(),d(),p(),U(),O(),m(),P(),K(),N(),CC(e,o),J0(e,o+"_batchToMontgomery",o+"_toMontgomery",v,v),J0(e,o+"_batchFromMontgomery",o+"_fromMontgomery",v,v),J0(e,o+"_batchNeg",o+"_neg",v,v),th(e,o+"_batchAdd",o+"_add",v,v),th(e,o+"_batchSub",o+"_sub",v,v),th(e,o+"_batchMul",o+"_mul",v,v),e.exportFunction(o+"_add"),e.exportFunction(o+"_sub"),e.exportFunction(o+"_neg"),e.exportFunction(o+"_isNegative"),e.exportFunction(o+"_isOne"),e.exportFunction(o+"_sign"),e.exportFunction(o+"_mReduct"),e.exportFunction(o+"_mul"),e.exportFunction(o+"_square"),e.exportFunction(o+"_squareOld"),e.exportFunction(o+"_fromMontgomery"),e.exportFunction(o+"_toMontgomery"),e.exportFunction(o+"_inverse"),e.exportFunction(o+"_one"),e.exportFunction(o+"_load"),e.exportFunction(o+"_timesScalar"),wC(e,o+"_exp",v,o+"_mul",o+"_square",h+"_copy",o+"_one"),e.exportFunction(o+"_exp"),e.exportFunction(o+"_batchInverse"),Kg(n)&&($(),I(),e.exportFunction(o+"_sqrt"),e.exportFunction(o+"_isSquare")),e.exportFunction(o+"_batchToMontgomery"),e.exportFunction(o+"_batchFromMontgomery"),o};const xC=x1,{bitLength:IC}=yi;var Ib=function(e,r,t,a,n){const c=BigInt(r),u=Math.floor((IC(c-1n)-1)/64)+1,v=u*8,o=t||"f1";if(e.modules[o])return o;e.modules[o]={n64:u};const h=n||"int",g=xC(e,c,a,h),y=e.modules[g].pR2,_=e.modules[g].pq,A=e.modules[g].pePlusOne;function S(){const R=e.alloc(v),P=e.addFunction(o+"_mul");P.addParam("x","i32"),P.addParam("y","i32"),P.addParam("r","i32");const D=P.getCodeBuilder();P.addCode(D.call(g+"_mul",D.getLocal("x"),D.getLocal("y"),D.i32_const(R))),P.addCode(D.call(g+"_mul",D.i32_const(R),D.i32_const(y),D.getLocal("r")))}function T(){const R=e.addFunction(o+"_square");R.addParam("x","i32"),R.addParam("r","i32");const P=R.getCodeBuilder();R.addCode(P.call(o+"_mul",P.getLocal("x"),P.getLocal("x"),P.getLocal("r")))}function B(){const R=e.addFunction(o+"_inverse");R.addParam("x","i32"),R.addParam("r","i32");const P=R.getCodeBuilder();R.addCode(P.call(h+"_inverseMod",P.getLocal("x"),P.i32_const(_),P.getLocal("r")))}function M(){const R=e.addFunction(o+"_isNegative");R.addParam("x","i32"),R.setReturnType("i32");const P=R.getCodeBuilder();R.addCode(P.call(h+"_gte",P.getLocal("x"),P.i32_const(A)))}return S(),T(),B(),M(),e.exportFunction(g+"_add",o+"_add"),e.exportFunction(g+"_sub",o+"_sub"),e.exportFunction(g+"_neg",o+"_neg"),e.exportFunction(o+"_mul"),e.exportFunction(o+"_square"),e.exportFunction(o+"_inverse"),e.exportFunction(o+"_isNegative"),e.exportFunction(g+"_copy",o+"_copy"),e.exportFunction(g+"_zero",o+"_zero"),e.exportFunction(g+"_one",o+"_one"),e.exportFunction(g+"_isZero",o+"_isZero"),e.exportFunction(g+"_eq",o+"_eq"),o};const MC=C1,BC=E1,rh=wa;var Mb=function(e,r,t,a){if(e.modules[t])return t;const n=e.modules[a].n64*8,c=e.modules[a].q;e.modules[t]={n64:e.modules[a].n64*2};function u(){const s=e.addFunction(t+"_add");s.addParam("x","i32"),s.addParam("y","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("y"),w=l.i32_add(l.getLocal("y"),l.i32_const(n)),x=l.getLocal("r"),b=l.i32_add(l.getLocal("r"),l.i32_const(n));s.addCode(l.call(a+"_add",d,m,x),l.call(a+"_add",p,w,b))}function v(){const s=e.addFunction(t+"_timesScalar");s.addParam("x","i32"),s.addParam("scalar","i32"),s.addParam("scalarLen","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("r"),w=l.i32_add(l.getLocal("r"),l.i32_const(n));s.addCode(l.call(a+"_timesScalar",d,l.getLocal("scalar"),l.getLocal("scalarLen"),m),l.call(a+"_timesScalar",p,l.getLocal("scalar"),l.getLocal("scalarLen"),w))}function o(){const s=e.addFunction(t+"_sub");s.addParam("x","i32"),s.addParam("y","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("y"),w=l.i32_add(l.getLocal("y"),l.i32_const(n)),x=l.getLocal("r"),b=l.i32_add(l.getLocal("r"),l.i32_const(n));s.addCode(l.call(a+"_sub",d,m,x),l.call(a+"_sub",p,w,b))}function h(){const s=e.addFunction(t+"_neg");s.addParam("x","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("r"),w=l.i32_add(l.getLocal("r"),l.i32_const(n));s.addCode(l.call(a+"_neg",d,m),l.call(a+"_neg",p,w))}function g(){const s=e.addFunction(t+"_conjugate");s.addParam("x","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("r"),w=l.i32_add(l.getLocal("r"),l.i32_const(n));s.addCode(l.call(a+"_copy",d,m),l.call(a+"_neg",p,w))}function y(){const s=e.addFunction(t+"_isNegative");s.addParam("x","i32"),s.setReturnType("i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n));s.addCode(l.if(l.call(a+"_isZero",p),l.ret(l.call(a+"_isNegative",d))),l.ret(l.call(a+"_isNegative",p)))}function _(){const s=e.addFunction(t+"_mul");s.addParam("x","i32"),s.addParam("y","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("y"),w=l.i32_add(l.getLocal("y"),l.i32_const(n)),x=l.getLocal("r"),b=l.i32_add(l.getLocal("r"),l.i32_const(n)),f=l.i32_const(e.alloc(n)),C=l.i32_const(e.alloc(n)),F=l.i32_const(e.alloc(n)),z=l.i32_const(e.alloc(n));s.addCode(l.call(a+"_mul",d,m,f),l.call(a+"_mul",p,w,C),l.call(a+"_add",d,p,F),l.call(a+"_add",m,w,z),l.call(a+"_mul",F,z,F),l.call(r,C,x),l.call(a+"_add",f,x,x),l.call(a+"_add",f,C,b),l.call(a+"_sub",F,b,b))}function A(){const s=e.addFunction(t+"_mul1");s.addParam("x","i32"),s.addParam("y","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("y"),w=l.getLocal("r"),x=l.i32_add(l.getLocal("r"),l.i32_const(n));s.addCode(l.call(a+"_mul",d,m,w),l.call(a+"_mul",p,m,x))}function S(){const s=e.addFunction(t+"_square");s.addParam("x","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("r"),w=l.i32_add(l.getLocal("r"),l.i32_const(n)),x=l.i32_const(e.alloc(n)),b=l.i32_const(e.alloc(n)),f=l.i32_const(e.alloc(n)),C=l.i32_const(e.alloc(n));s.addCode(l.call(a+"_mul",d,p,x),l.call(a+"_add",d,p,b),l.call(r,p,f),l.call(a+"_add",d,f,f),l.call(r,x,C),l.call(a+"_add",C,x,C),l.call(a+"_mul",b,f,m),l.call(a+"_sub",m,C,m),l.call(a+"_add",x,x,w))}function T(){const s=e.addFunction(t+"_toMontgomery");s.addParam("x","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("r"),w=l.i32_add(l.getLocal("r"),l.i32_const(n));s.addCode(l.call(a+"_toMontgomery",d,m),l.call(a+"_toMontgomery",p,w))}function B(){const s=e.addFunction(t+"_fromMontgomery");s.addParam("x","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("r"),w=l.i32_add(l.getLocal("r"),l.i32_const(n));s.addCode(l.call(a+"_fromMontgomery",d,m),l.call(a+"_fromMontgomery",p,w))}function M(){const s=e.addFunction(t+"_copy");s.addParam("x","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("r"),w=l.i32_add(l.getLocal("r"),l.i32_const(n));s.addCode(l.call(a+"_copy",d,m),l.call(a+"_copy",p,w))}function R(){const s=e.addFunction(t+"_zero");s.addParam("x","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n));s.addCode(l.call(a+"_zero",d),l.call(a+"_zero",p))}function P(){const s=e.addFunction(t+"_one");s.addParam("x","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n));s.addCode(l.call(a+"_one",d),l.call(a+"_zero",p))}function D(){const s=e.addFunction(t+"_eq");s.addParam("x","i32"),s.addParam("y","i32"),s.setReturnType("i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("y"),w=l.i32_add(l.getLocal("y"),l.i32_const(n));s.addCode(l.i32_and(l.call(a+"_eq",d,m),l.call(a+"_eq",p,w)))}function q(){const s=e.addFunction(t+"_isZero");s.addParam("x","i32"),s.setReturnType("i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n));s.addCode(l.i32_and(l.call(a+"_isZero",d),l.call(a+"_isZero",p)))}function k(){const s=e.addFunction(t+"_inverse");s.addParam("x","i32"),s.addParam("r","i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n)),m=l.getLocal("r"),w=l.i32_add(l.getLocal("r"),l.i32_const(n)),x=l.i32_const(e.alloc(n)),b=l.i32_const(e.alloc(n)),f=l.i32_const(e.alloc(n)),C=l.i32_const(e.alloc(n));s.addCode(l.call(a+"_square",d,x),l.call(a+"_square",p,b),l.call(r,b,f),l.call(a+"_sub",x,f,f),l.call(a+"_inverse",f,C),l.call(a+"_mul",d,C,m),l.call(a+"_mul",p,C,w),l.call(a+"_neg",w,w))}function U(){const s=e.addFunction(t+"_sign");s.addParam("x","i32"),s.addLocal("s","i32"),s.setReturnType("i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n));s.addCode(l.setLocal("s",l.call(a+"_sign",p)),l.if(l.getLocal("s"),l.ret(l.getLocal("s"))),l.ret(l.call(a+"_sign",d)))}function O(){const s=e.addFunction(t+"_isOne");s.addParam("x","i32"),s.setReturnType("i32");const l=s.getCodeBuilder(),d=l.getLocal("x"),p=l.i32_add(l.getLocal("x"),l.i32_const(n));s.addCode(l.ret(l.i32_and(l.call(a+"_isOne",d),l.call(a+"_isZero",p))))}function G(){const s=e.addFunction(t+"_sqrt");s.addParam("a","i32"),s.addParam("pr","i32");const l=s.getCodeBuilder(),d=l.i32_const(e.alloc(rh.bigInt2BytesLE((BigInt(c||0)-3n)/4n,n))),p=l.i32_const(e.alloc(rh.bigInt2BytesLE((BigInt(c||0)-1n)/2n,n))),m=l.getLocal("a"),w=l.i32_const(e.alloc(n*2)),x=l.i32_const(e.alloc(n*2)),b=l.i32_const(e.alloc(n*2)),f=e.alloc(n*2),C=l.i32_const(f),F=l.i32_const(f),z=l.i32_const(f+n),W=l.i32_const(e.alloc(n*2)),$=l.i32_const(e.alloc(n*2));s.addCode(l.call(t+"_one",C),l.call(t+"_neg",C,C),l.call(t+"_exp",m,d,l.i32_const(n),w),l.call(t+"_square",w,x),l.call(t+"_mul",m,x,x),l.call(t+"_conjugate",x,b),l.call(t+"_mul",b,x,b),l.if(l.call(t+"_eq",b,C),l.unreachable()),l.call(t+"_mul",w,m,W),l.if(l.call(t+"_eq",x,C),[...l.call(a+"_zero",F),...l.call(a+"_one",z),...l.call(t+"_mul",C,W,l.getLocal("pr"))],[...l.call(t+"_one",$),...l.call(t+"_add",$,x,$),...l.call(t+"_exp",$,p,l.i32_const(n),$),...l.call(t+"_mul",$,W,l.getLocal("pr"))]))}function E(){const s=e.addFunction(t+"_isSquare");s.addParam("a","i32"),s.setReturnType("i32");const l=s.getCodeBuilder(),d=l.i32_const(e.alloc(rh.bigInt2BytesLE((BigInt(c||0)-3n)/4n,n))),p=l.getLocal("a"),m=l.i32_const(e.alloc(n*2)),w=l.i32_const(e.alloc(n*2)),x=l.i32_const(e.alloc(n*2)),b=e.alloc(n*2),f=l.i32_const(b);s.addCode(l.call(t+"_one",f),l.call(t+"_neg",f,f),l.call(t+"_exp",p,d,l.i32_const(n),m),l.call(t+"_square",m,w),l.call(t+"_mul",p,w,w),l.call(t+"_conjugate",w,x),l.call(t+"_mul",x,w,x),l.if(l.call(t+"_eq",x,f),l.ret(l.i32_const(0))),l.ret(l.i32_const(1)))}return q(),O(),R(),P(),M(),_(),A(),S(),u(),o(),h(),g(),T(),B(),D(),k(),v(),U(),y(),e.exportFunction(t+"_isZero"),e.exportFunction(t+"_isOne"),e.exportFunction(t+"_zero"),e.exportFunction(t+"_one"),e.exportFunction(t+"_copy"),e.exportFunction(t+"_mul"),e.exportFunction(t+"_mul1"),e.exportFunction(t+"_square"),e.exportFunction(t+"_add"),e.exportFunction(t+"_sub"),e.exportFunction(t+"_neg"),e.exportFunction(t+"_sign"),e.exportFunction(t+"_conjugate"),e.exportFunction(t+"_fromMontgomery"),e.exportFunction(t+"_toMontgomery"),e.exportFunction(t+"_eq"),e.exportFunction(t+"_inverse"),BC(e,t),MC(e,t+"_exp",n*2,t+"_mul",t+"_square",t+"_copy",t+"_one"),G(),E(),e.exportFunction(t+"_exp"),e.exportFunction(t+"_timesScalar"),e.exportFunction(t+"_batchInverse"),e.exportFunction(t+"_sqrt"),e.exportFunction(t+"_isSquare"),e.exportFunction(t+"_isNegative"),t};const LC=C1,TC=E1;var Bb=function(e,r,t,a){if(e.modules[t])return t;const n=e.modules[a].n64*8;e.modules[t]={n64:e.modules[a].n64*3};function c(){const k=e.addFunction(t+"_add");k.addParam("x","i32"),k.addParam("y","i32"),k.addParam("r","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n)),s=U.getLocal("y"),l=U.i32_add(U.getLocal("y"),U.i32_const(n)),d=U.i32_add(U.getLocal("y"),U.i32_const(2*n)),p=U.getLocal("r"),m=U.i32_add(U.getLocal("r"),U.i32_const(n)),w=U.i32_add(U.getLocal("r"),U.i32_const(2*n));k.addCode(U.call(a+"_add",O,s,p),U.call(a+"_add",G,l,m),U.call(a+"_add",E,d,w))}function u(){const k=e.addFunction(t+"_timesScalar");k.addParam("x","i32"),k.addParam("scalar","i32"),k.addParam("scalarLen","i32"),k.addParam("r","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n)),s=U.getLocal("r"),l=U.i32_add(U.getLocal("r"),U.i32_const(n)),d=U.i32_add(U.getLocal("r"),U.i32_const(2*n));k.addCode(U.call(a+"_timesScalar",O,U.getLocal("scalar"),U.getLocal("scalarLen"),s),U.call(a+"_timesScalar",G,U.getLocal("scalar"),U.getLocal("scalarLen"),l),U.call(a+"_timesScalar",E,U.getLocal("scalar"),U.getLocal("scalarLen"),d))}function v(){const k=e.addFunction(t+"_sub");k.addParam("x","i32"),k.addParam("y","i32"),k.addParam("r","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n)),s=U.getLocal("y"),l=U.i32_add(U.getLocal("y"),U.i32_const(n)),d=U.i32_add(U.getLocal("y"),U.i32_const(2*n)),p=U.getLocal("r"),m=U.i32_add(U.getLocal("r"),U.i32_const(n)),w=U.i32_add(U.getLocal("r"),U.i32_const(2*n));k.addCode(U.call(a+"_sub",O,s,p),U.call(a+"_sub",G,l,m),U.call(a+"_sub",E,d,w))}function o(){const k=e.addFunction(t+"_neg");k.addParam("x","i32"),k.addParam("r","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n)),s=U.getLocal("r"),l=U.i32_add(U.getLocal("r"),U.i32_const(n)),d=U.i32_add(U.getLocal("r"),U.i32_const(2*n));k.addCode(U.call(a+"_neg",O,s),U.call(a+"_neg",G,l),U.call(a+"_neg",E,d))}function h(){const k=e.addFunction(t+"_isNegative");k.addParam("x","i32"),k.setReturnType("i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n));k.addCode(U.if(U.call(a+"_isZero",E),U.if(U.call(a+"_isZero",G),U.ret(U.call(a+"_isNegative",O)),U.ret(U.call(a+"_isNegative",G)))),U.ret(U.call(a+"_isNegative",E)))}function g(){const k=e.addFunction(t+"_mul");k.addParam("x","i32"),k.addParam("y","i32"),k.addParam("r","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n)),s=U.getLocal("y"),l=U.i32_add(U.getLocal("y"),U.i32_const(n)),d=U.i32_add(U.getLocal("y"),U.i32_const(2*n)),p=U.getLocal("r"),m=U.i32_add(U.getLocal("r"),U.i32_const(n)),w=U.i32_add(U.getLocal("r"),U.i32_const(2*n)),x=U.i32_const(e.alloc(n)),b=U.i32_const(e.alloc(n)),f=U.i32_const(e.alloc(n)),C=U.i32_const(e.alloc(n)),F=U.i32_const(e.alloc(n)),z=U.i32_const(e.alloc(n)),W=U.i32_const(e.alloc(n)),$=U.i32_const(e.alloc(n)),I=U.i32_const(e.alloc(n)),K=U.i32_const(e.alloc(n)),N=U.i32_const(e.alloc(n)),X=U.i32_const(e.alloc(n)),Q=U.i32_const(e.alloc(n));k.addCode(U.call(a+"_mul",O,s,x),U.call(a+"_mul",G,l,b),U.call(a+"_mul",E,d,f),U.call(a+"_add",O,G,C),U.call(a+"_add",s,l,F),U.call(a+"_add",O,E,z),U.call(a+"_add",s,d,W),U.call(a+"_add",G,E,$),U.call(a+"_add",l,d,I),U.call(a+"_add",x,b,K),U.call(a+"_add",x,f,N),U.call(a+"_add",b,f,X),U.call(a+"_mul",$,I,p),U.call(a+"_sub",p,X,p),U.call(r,p,p),U.call(a+"_add",x,p,p),U.call(a+"_mul",C,F,m),U.call(a+"_sub",m,K,m),U.call(r,f,Q),U.call(a+"_add",m,Q,m),U.call(a+"_mul",z,W,w),U.call(a+"_sub",w,N,w),U.call(a+"_add",w,b,w))}function y(){const k=e.addFunction(t+"_square");k.addParam("x","i32"),k.addParam("r","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n)),s=U.getLocal("r"),l=U.i32_add(U.getLocal("r"),U.i32_const(n)),d=U.i32_add(U.getLocal("r"),U.i32_const(2*n)),p=U.i32_const(e.alloc(n)),m=U.i32_const(e.alloc(n)),w=U.i32_const(e.alloc(n)),x=U.i32_const(e.alloc(n)),b=U.i32_const(e.alloc(n)),f=U.i32_const(e.alloc(n)),C=U.i32_const(e.alloc(n));k.addCode(U.call(a+"_square",O,p),U.call(a+"_mul",O,G,m),U.call(a+"_add",m,m,w),U.call(a+"_sub",O,G,x),U.call(a+"_add",x,E,x),U.call(a+"_square",x,x),U.call(a+"_mul",G,E,b),U.call(a+"_add",b,b,f),U.call(a+"_square",E,C),U.call(r,f,s),U.call(a+"_add",p,s,s),U.call(r,C,l),U.call(a+"_add",w,l,l),U.call(a+"_add",p,C,d),U.call(a+"_sub",f,d,d),U.call(a+"_add",x,d,d),U.call(a+"_add",w,d,d))}function _(){const k=e.addFunction(t+"_toMontgomery");k.addParam("x","i32"),k.addParam("r","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n)),s=U.getLocal("r"),l=U.i32_add(U.getLocal("r"),U.i32_const(n)),d=U.i32_add(U.getLocal("r"),U.i32_const(2*n));k.addCode(U.call(a+"_toMontgomery",O,s),U.call(a+"_toMontgomery",G,l),U.call(a+"_toMontgomery",E,d))}function A(){const k=e.addFunction(t+"_fromMontgomery");k.addParam("x","i32"),k.addParam("r","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n)),s=U.getLocal("r"),l=U.i32_add(U.getLocal("r"),U.i32_const(n)),d=U.i32_add(U.getLocal("r"),U.i32_const(2*n));k.addCode(U.call(a+"_fromMontgomery",O,s),U.call(a+"_fromMontgomery",G,l),U.call(a+"_fromMontgomery",E,d))}function S(){const k=e.addFunction(t+"_copy");k.addParam("x","i32"),k.addParam("r","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n)),s=U.getLocal("r"),l=U.i32_add(U.getLocal("r"),U.i32_const(n)),d=U.i32_add(U.getLocal("r"),U.i32_const(2*n));k.addCode(U.call(a+"_copy",O,s),U.call(a+"_copy",G,l),U.call(a+"_copy",E,d))}function T(){const k=e.addFunction(t+"_zero");k.addParam("x","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n));k.addCode(U.call(a+"_zero",O),U.call(a+"_zero",G),U.call(a+"_zero",E))}function B(){const k=e.addFunction(t+"_one");k.addParam("x","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n));k.addCode(U.call(a+"_one",O),U.call(a+"_zero",G),U.call(a+"_zero",E))}function M(){const k=e.addFunction(t+"_eq");k.addParam("x","i32"),k.addParam("y","i32"),k.setReturnType("i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n)),s=U.getLocal("y"),l=U.i32_add(U.getLocal("y"),U.i32_const(n)),d=U.i32_add(U.getLocal("y"),U.i32_const(2*n));k.addCode(U.i32_and(U.i32_and(U.call(a+"_eq",O,s),U.call(a+"_eq",G,l)),U.call(a+"_eq",E,d)))}function R(){const k=e.addFunction(t+"_isZero");k.addParam("x","i32"),k.setReturnType("i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n));k.addCode(U.i32_and(U.i32_and(U.call(a+"_isZero",O),U.call(a+"_isZero",G)),U.call(a+"_isZero",E)))}function P(){const k=e.addFunction(t+"_inverse");k.addParam("x","i32"),k.addParam("r","i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n)),s=U.getLocal("r"),l=U.i32_add(U.getLocal("r"),U.i32_const(n)),d=U.i32_add(U.getLocal("r"),U.i32_const(2*n)),p=U.i32_const(e.alloc(n)),m=U.i32_const(e.alloc(n)),w=U.i32_const(e.alloc(n)),x=U.i32_const(e.alloc(n)),b=U.i32_const(e.alloc(n)),f=U.i32_const(e.alloc(n)),C=U.i32_const(e.alloc(n)),F=U.i32_const(e.alloc(n)),z=U.i32_const(e.alloc(n)),W=U.i32_const(e.alloc(n)),$=U.i32_const(e.alloc(n));k.addCode(U.call(a+"_square",O,p),U.call(a+"_square",G,m),U.call(a+"_square",E,w),U.call(a+"_mul",O,G,x),U.call(a+"_mul",O,E,b),U.call(a+"_mul",G,E,f),U.call(r,f,C),U.call(a+"_sub",p,C,C),U.call(r,w,F),U.call(a+"_sub",F,x,F),U.call(a+"_sub",m,b,z),U.call(a+"_mul",E,F,W),U.call(a+"_mul",G,z,$),U.call(a+"_add",W,$,W),U.call(r,W,W),U.call(a+"_mul",O,C,$),U.call(a+"_add",$,W,W),U.call(a+"_inverse",W,W),U.call(a+"_mul",W,C,s),U.call(a+"_mul",W,F,l),U.call(a+"_mul",W,z,d))}function D(){const k=e.addFunction(t+"_sign");k.addParam("x","i32"),k.addLocal("s","i32"),k.setReturnType("i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(2*n));k.addCode(U.setLocal("s",U.call(a+"_sign",E)),U.if(U.getLocal("s"),U.ret(U.getLocal("s"))),U.setLocal("s",U.call(a+"_sign",G)),U.if(U.getLocal("s"),U.ret(U.getLocal("s"))),U.ret(U.call(a+"_sign",O)))}function q(){const k=e.addFunction(t+"_isOne");k.addParam("x","i32"),k.setReturnType("i32");const U=k.getCodeBuilder(),O=U.getLocal("x"),G=U.i32_add(U.getLocal("x"),U.i32_const(n)),E=U.i32_add(U.getLocal("x"),U.i32_const(n*2));k.addCode(U.ret(U.i32_and(U.i32_and(U.call(a+"_isOne",O),U.call(a+"_isZero",G)),U.call(a+"_isZero",E))))}return R(),q(),T(),B(),S(),g(),y(),c(),v(),o(),D(),_(),A(),M(),P(),u(),h(),e.exportFunction(t+"_isZero"),e.exportFunction(t+"_isOne"),e.exportFunction(t+"_zero"),e.exportFunction(t+"_one"),e.exportFunction(t+"_copy"),e.exportFunction(t+"_mul"),e.exportFunction(t+"_square"),e.exportFunction(t+"_add"),e.exportFunction(t+"_sub"),e.exportFunction(t+"_neg"),e.exportFunction(t+"_sign"),e.exportFunction(t+"_fromMontgomery"),e.exportFunction(t+"_toMontgomery"),e.exportFunction(t+"_eq"),e.exportFunction(t+"_inverse"),TC(e,t),LC(e,t+"_exp",n*3,t+"_mul",t+"_square",t+"_copy",t+"_one"),e.exportFunction(t+"_exp"),e.exportFunction(t+"_timesScalar"),e.exportFunction(t+"_batchInverse"),e.exportFunction(t+"_isNegative"),t},RC=function(e,r,t,a,n,c,u,v){const o=e.addFunction(r);o.addParam("base","i32"),o.addParam("scalar","i32"),o.addParam("scalarLength","i32"),o.addParam("r","i32"),o.addLocal("old0","i32"),o.addLocal("nbits","i32"),o.addLocal("i","i32"),o.addLocal("last","i32"),o.addLocal("cur","i32"),o.addLocal("carry","i32"),o.addLocal("p","i32");const h=o.getCodeBuilder(),g=h.i32_const(e.alloc(t));function y(A){return h.i32_and(h.i32_shr_u(h.i32_load(h.i32_add(h.getLocal("scalar"),h.i32_and(h.i32_shr_u(A,h.i32_const(3)),h.i32_const(4294967292)))),h.i32_and(A,h.i32_const(31))),h.i32_const(1))}function _(A){return[...h.i32_store8(h.getLocal("p"),h.i32_const(A)),...h.setLocal("p",h.i32_add(h.getLocal("p"),h.i32_const(1)))]}o.addCode(h.if(h.i32_eqz(h.getLocal("scalarLength")),[...h.call(v,h.getLocal("r")),...h.ret([])]),h.setLocal("nbits",h.i32_shl(h.getLocal("scalarLength"),h.i32_const(3))),h.setLocal("old0",h.i32_load(h.i32_const(0))),h.setLocal("p",h.getLocal("old0")),h.i32_store(h.i32_const(0),h.i32_and(h.i32_add(h.i32_add(h.getLocal("old0"),h.i32_const(32)),h.getLocal("nbits")),h.i32_const(4294967288))),h.setLocal("i",h.i32_const(1)),h.setLocal("last",y(h.i32_const(0))),h.setLocal("carry",h.i32_const(0)),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("i"),h.getLocal("nbits"))),h.setLocal("cur",y(h.getLocal("i"))),h.if(h.getLocal("last"),h.if(h.getLocal("cur"),h.if(h.getLocal("carry"),[...h.setLocal("last",h.i32_const(0)),...h.setLocal("carry",h.i32_const(1)),..._(1)],[...h.setLocal("last",h.i32_const(0)),...h.setLocal("carry",h.i32_const(1)),..._(255)]),h.if(h.getLocal("carry"),[...h.setLocal("last",h.i32_const(0)),...h.setLocal("carry",h.i32_const(1)),..._(255)],[...h.setLocal("last",h.i32_const(0)),...h.setLocal("carry",h.i32_const(0)),..._(1)])),h.if(h.getLocal("cur"),h.if(h.getLocal("carry"),[...h.setLocal("last",h.i32_const(0)),...h.setLocal("carry",h.i32_const(1)),..._(0)],[...h.setLocal("last",h.i32_const(1)),...h.setLocal("carry",h.i32_const(0)),..._(0)]),h.if(h.getLocal("carry"),[...h.setLocal("last",h.i32_const(1)),...h.setLocal("carry",h.i32_const(0)),..._(0)],[...h.setLocal("last",h.i32_const(0)),...h.setLocal("carry",h.i32_const(0)),..._(0)]))),h.setLocal("i",h.i32_add(h.getLocal("i"),h.i32_const(1))),h.br(0))),h.if(h.getLocal("last"),h.if(h.getLocal("carry"),[..._(255),..._(0),..._(1)],[..._(1)]),h.if(h.getLocal("carry"),[..._(0),..._(1)])),h.setLocal("p",h.i32_sub(h.getLocal("p"),h.i32_const(1))),h.call(u,h.getLocal("base"),g),h.call(v,h.getLocal("r")),h.block(h.loop(h.call(n,h.getLocal("r"),h.getLocal("r")),h.setLocal("cur",h.i32_load8_u(h.getLocal("p"))),h.if(h.getLocal("cur"),h.if(h.i32_eq(h.getLocal("cur"),h.i32_const(1)),h.call(a,h.getLocal("r"),g,h.getLocal("r")),h.call(c,h.getLocal("r"),g,h.getLocal("r")))),h.br_if(1,h.i32_eq(h.getLocal("old0"),h.getLocal("p"))),h.setLocal("p",h.i32_sub(h.getLocal("p"),h.i32_const(1))),h.br(0))),h.i32_store(h.i32_const(0),h.getLocal("old0")))},NC=function(e,r,t,a,n){const u=e.modules[r].n64*8;function v(){const y=e.addFunction(t+"_getChunk");y.addParam("pScalar","i32"),y.addParam("scalarSize","i32"),y.addParam("startBit","i32"),y.addParam("chunkSize","i32"),y.addLocal("bitsToEnd","i32"),y.addLocal("mask","i32"),y.setReturnType("i32");const _=y.getCodeBuilder();y.addCode(_.setLocal("bitsToEnd",_.i32_sub(_.i32_mul(_.getLocal("scalarSize"),_.i32_const(8)),_.getLocal("startBit"))),_.if(_.i32_gt_s(_.getLocal("chunkSize"),_.getLocal("bitsToEnd")),_.setLocal("mask",_.i32_sub(_.i32_shl(_.i32_const(1),_.getLocal("bitsToEnd")),_.i32_const(1))),_.setLocal("mask",_.i32_sub(_.i32_shl(_.i32_const(1),_.getLocal("chunkSize")),_.i32_const(1)))),_.i32_and(_.i32_shr_u(_.i32_load(_.i32_add(_.getLocal("pScalar"),_.i32_shr_u(_.getLocal("startBit"),_.i32_const(3))),0,0),_.i32_and(_.getLocal("startBit"),_.i32_const(7))),_.getLocal("mask")))}function o(){const y=e.addFunction(t+"_chunk");y.addParam("pBases","i32"),y.addParam("pScalars","i32"),y.addParam("scalarSize","i32"),y.addParam("n","i32"),y.addParam("startBit","i32"),y.addParam("chunkSize","i32"),y.addParam("pr","i32"),y.addLocal("nChunks","i32"),y.addLocal("itScalar","i32"),y.addLocal("endScalar","i32"),y.addLocal("itBase","i32"),y.addLocal("i","i32"),y.addLocal("j","i32"),y.addLocal("nTable","i32"),y.addLocal("pTable","i32"),y.addLocal("idx","i32"),y.addLocal("pIdxTable","i32");const _=y.getCodeBuilder();y.addCode(_.if(_.i32_eqz(_.getLocal("n")),[..._.call(r+"_zero",_.getLocal("pr")),..._.ret([])]),_.setLocal("nTable",_.i32_shl(_.i32_const(1),_.getLocal("chunkSize"))),_.setLocal("pTable",_.i32_load(_.i32_const(0))),_.i32_store(_.i32_const(0),_.i32_add(_.getLocal("pTable"),_.i32_mul(_.getLocal("nTable"),_.i32_const(u)))),_.setLocal("j",_.i32_const(0)),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("j"),_.getLocal("nTable"))),_.call(r+"_zero",_.i32_add(_.getLocal("pTable"),_.i32_mul(_.getLocal("j"),_.i32_const(u)))),_.setLocal("j",_.i32_add(_.getLocal("j"),_.i32_const(1))),_.br(0))),_.setLocal("itBase",_.getLocal("pBases")),_.setLocal("itScalar",_.getLocal("pScalars")),_.setLocal("endScalar",_.i32_add(_.getLocal("pScalars"),_.i32_mul(_.getLocal("n"),_.getLocal("scalarSize")))),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("itScalar"),_.getLocal("endScalar"))),_.setLocal("idx",_.call(t+"_getChunk",_.getLocal("itScalar"),_.getLocal("scalarSize"),_.getLocal("startBit"),_.getLocal("chunkSize"))),_.if(_.getLocal("idx"),[..._.setLocal("pIdxTable",_.i32_add(_.getLocal("pTable"),_.i32_mul(_.i32_sub(_.getLocal("idx"),_.i32_const(1)),_.i32_const(u)))),..._.call(a,_.getLocal("pIdxTable"),_.getLocal("itBase"),_.getLocal("pIdxTable"))]),_.setLocal("itScalar",_.i32_add(_.getLocal("itScalar"),_.getLocal("scalarSize"))),_.setLocal("itBase",_.i32_add(_.getLocal("itBase"),_.i32_const(n))),_.br(0))),_.call(t+"_reduceTable",_.getLocal("pTable"),_.getLocal("chunkSize")),_.call(r+"_copy",_.getLocal("pTable"),_.getLocal("pr")),_.i32_store(_.i32_const(0),_.getLocal("pTable")))}function h(){const y=e.addFunction(t);y.addParam("pBases","i32"),y.addParam("pScalars","i32"),y.addParam("scalarSize","i32"),y.addParam("n","i32"),y.addParam("pr","i32"),y.addLocal("chunkSize","i32"),y.addLocal("nChunks","i32"),y.addLocal("itScalar","i32"),y.addLocal("endScalar","i32"),y.addLocal("itBase","i32"),y.addLocal("itBit","i32"),y.addLocal("i","i32"),y.addLocal("j","i32"),y.addLocal("nTable","i32"),y.addLocal("pTable","i32"),y.addLocal("idx","i32"),y.addLocal("pIdxTable","i32");const _=y.getCodeBuilder(),A=_.i32_const(e.alloc(u)),S=e.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);y.addCode(_.call(r+"_zero",_.getLocal("pr")),_.if(_.i32_eqz(_.getLocal("n")),_.ret([])),_.setLocal("chunkSize",_.i32_load8_u(_.i32_clz(_.getLocal("n")),S)),_.setLocal("nChunks",_.i32_add(_.i32_div_u(_.i32_sub(_.i32_shl(_.getLocal("scalarSize"),_.i32_const(3)),_.i32_const(1)),_.getLocal("chunkSize")),_.i32_const(1))),_.setLocal("itBit",_.i32_mul(_.i32_sub(_.getLocal("nChunks"),_.i32_const(1)),_.getLocal("chunkSize"))),_.block(_.loop(_.br_if(1,_.i32_lt_s(_.getLocal("itBit"),_.i32_const(0))),_.if(_.i32_eqz(_.call(r+"_isZero",_.getLocal("pr"))),[..._.setLocal("j",_.i32_const(0)),..._.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("j"),_.getLocal("chunkSize"))),_.call(r+"_double",_.getLocal("pr"),_.getLocal("pr")),_.setLocal("j",_.i32_add(_.getLocal("j"),_.i32_const(1))),_.br(0)))]),_.call(t+"_chunk",_.getLocal("pBases"),_.getLocal("pScalars"),_.getLocal("scalarSize"),_.getLocal("n"),_.getLocal("itBit"),_.getLocal("chunkSize"),A),_.call(r+"_add",_.getLocal("pr"),A,_.getLocal("pr")),_.setLocal("itBit",_.i32_sub(_.getLocal("itBit"),_.getLocal("chunkSize"))),_.br(0))))}function g(){const y=e.addFunction(t+"_reduceTable");y.addParam("pTable","i32"),y.addParam("p","i32"),y.addLocal("half","i32"),y.addLocal("it1","i32"),y.addLocal("it2","i32"),y.addLocal("pAcc","i32");const _=y.getCodeBuilder();y.addCode(_.if(_.i32_eq(_.getLocal("p"),_.i32_const(1)),_.ret([])),_.setLocal("half",_.i32_shl(_.i32_const(1),_.i32_sub(_.getLocal("p"),_.i32_const(1)))),_.setLocal("it1",_.getLocal("pTable")),_.setLocal("it2",_.i32_add(_.getLocal("pTable"),_.i32_mul(_.getLocal("half"),_.i32_const(u)))),_.setLocal("pAcc",_.i32_sub(_.getLocal("it2"),_.i32_const(u))),_.block(_.loop(_.br_if(1,_.i32_eq(_.getLocal("it1"),_.getLocal("pAcc"))),_.call(r+"_add",_.getLocal("it1"),_.getLocal("it2"),_.getLocal("it1")),_.call(r+"_add",_.getLocal("pAcc"),_.getLocal("it2"),_.getLocal("pAcc")),_.setLocal("it1",_.i32_add(_.getLocal("it1"),_.i32_const(u))),_.setLocal("it2",_.i32_add(_.getLocal("it2"),_.i32_const(u))),_.br(0))),_.call(t+"_reduceTable",_.getLocal("pTable"),_.i32_sub(_.getLocal("p"),_.i32_const(1))),_.setLocal("p",_.i32_sub(_.getLocal("p"),_.i32_const(1))),_.block(_.loop(_.br_if(1,_.i32_eqz(_.getLocal("p"))),_.call(r+"_double",_.getLocal("pAcc"),_.getLocal("pAcc")),_.setLocal("p",_.i32_sub(_.getLocal("p"),_.i32_const(1))),_.br(0))),_.call(r+"_add",_.getLocal("pTable"),_.getLocal("pAcc"),_.getLocal("pTable")))}v(),g(),o(),h(),e.exportFunction(t),e.exportFunction(t+"_chunk")};const Hg=RC,js=wb,Qg=NC;var Lb=function(e,r,t,a){const n=e.modules[t].n64,c=n*8;if(e.modules[r])return r;e.modules[r]={n64:n*3};function u(){const $=e.addFunction(r+"_isZero");$.addParam("p1","i32"),$.setReturnType("i32");const I=$.getCodeBuilder();$.addCode(I.call(t+"_isZero",I.i32_add(I.getLocal("p1"),I.i32_const(c*2))))}function v(){const $=e.addFunction(r+"_isZeroAffine");$.addParam("p1","i32"),$.setReturnType("i32");const I=$.getCodeBuilder();$.addCode(I.i32_and(I.call(t+"_isZero",I.getLocal("p1")),I.call(t+"_isZero",I.i32_add(I.getLocal("p1"),I.i32_const(c)))))}function o(){const $=e.addFunction(r+"_copy");$.addParam("ps","i32"),$.addParam("pd","i32");const I=$.getCodeBuilder();for(let K=0;K<n*3;K++)$.addCode(I.i64_store(I.getLocal("pd"),K*8,I.i64_load(I.getLocal("ps"),K*8)))}function h(){const $=e.addFunction(r+"_copyAffine");$.addParam("ps","i32"),$.addParam("pd","i32");const I=$.getCodeBuilder();for(let K=0;K<n*2;K++)$.addCode(I.i64_store(I.getLocal("pd"),K*8,I.i64_load(I.getLocal("ps"),K*8)))}function g(){const $=e.addFunction(r+"_zero");$.addParam("pr","i32");const I=$.getCodeBuilder();$.addCode(I.call(t+"_zero",I.getLocal("pr"))),$.addCode(I.call(t+"_one",I.i32_add(I.getLocal("pr"),I.i32_const(c)))),$.addCode(I.call(t+"_zero",I.i32_add(I.getLocal("pr"),I.i32_const(c*2))))}function y(){const $=e.addFunction(r+"_zeroAffine");$.addParam("pr","i32");const I=$.getCodeBuilder();$.addCode(I.call(t+"_zero",I.getLocal("pr"))),$.addCode(I.call(t+"_zero",I.i32_add(I.getLocal("pr"),I.i32_const(c))))}function _(){const $=e.addFunction(r+"_eq");$.addParam("p1","i32"),$.addParam("p2","i32"),$.setReturnType("i32"),$.addLocal("z1","i32"),$.addLocal("z2","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c));$.addCode(I.setLocal("z1",I.i32_add(I.getLocal("p1"),I.i32_const(c*2))));const X=I.getLocal("z1"),Q=I.getLocal("p2"),L=I.i32_add(I.getLocal("p2"),I.i32_const(c));$.addCode(I.setLocal("z2",I.i32_add(I.getLocal("p2"),I.i32_const(c*2))));const V=I.getLocal("z2"),Z=I.i32_const(e.alloc(c)),H=I.i32_const(e.alloc(c)),j=I.i32_const(e.alloc(c)),et=I.i32_const(e.alloc(c)),nt=I.i32_const(e.alloc(c)),st=I.i32_const(e.alloc(c)),ft=I.i32_const(e.alloc(c)),vt=I.i32_const(e.alloc(c));$.addCode(I.if(I.call(r+"_isZero",I.getLocal("p1")),I.ret(I.call(r+"_isZero",I.getLocal("p2")))),I.if(I.call(r+"_isZero",I.getLocal("p2")),I.ret(I.i32_const(0))),I.if(I.call(t+"_isOne",X),I.ret(I.call(r+"_eqMixed",I.getLocal("p2"),I.getLocal("p1")))),I.if(I.call(t+"_isOne",V),I.ret(I.call(r+"_eqMixed",I.getLocal("p1"),I.getLocal("p2")))),I.call(t+"_square",X,Z),I.call(t+"_square",V,H),I.call(t+"_mul",K,H,j),I.call(t+"_mul",Q,Z,et),I.call(t+"_mul",X,Z,nt),I.call(t+"_mul",V,H,st),I.call(t+"_mul",N,st,ft),I.call(t+"_mul",L,nt,vt),I.if(I.call(t+"_eq",j,et),I.if(I.call(t+"_eq",ft,vt),I.ret(I.i32_const(1)))),I.ret(I.i32_const(0)))}function A(){const $=e.addFunction(r+"_eqMixed");$.addParam("p1","i32"),$.addParam("p2","i32"),$.setReturnType("i32"),$.addLocal("z1","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c));$.addCode(I.setLocal("z1",I.i32_add(I.getLocal("p1"),I.i32_const(c*2))));const X=I.getLocal("z1"),Q=I.getLocal("p2"),L=I.i32_add(I.getLocal("p2"),I.i32_const(c)),V=I.i32_const(e.alloc(c)),Z=I.i32_const(e.alloc(c)),H=I.i32_const(e.alloc(c)),j=I.i32_const(e.alloc(c));$.addCode(I.if(I.call(r+"_isZero",I.getLocal("p1")),I.ret(I.call(r+"_isZeroAffine",I.getLocal("p2")))),I.if(I.call(r+"_isZeroAffine",I.getLocal("p2")),I.ret(I.i32_const(0))),I.if(I.call(t+"_isOne",X),I.ret(I.call(r+"_eqAffine",I.getLocal("p1"),I.getLocal("p2")))),I.call(t+"_square",X,V),I.call(t+"_mul",Q,V,Z),I.call(t+"_mul",X,V,H),I.call(t+"_mul",L,H,j),I.if(I.call(t+"_eq",K,Z),I.if(I.call(t+"_eq",N,j),I.ret(I.i32_const(1)))),I.ret(I.i32_const(0)))}function S(){const $=e.addFunction(r+"_double");$.addParam("p1","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c)),X=I.i32_add(I.getLocal("p1"),I.i32_const(c*2)),Q=I.getLocal("pr"),L=I.i32_add(I.getLocal("pr"),I.i32_const(c)),V=I.i32_add(I.getLocal("pr"),I.i32_const(c*2)),Z=I.i32_const(e.alloc(c)),H=I.i32_const(e.alloc(c)),j=I.i32_const(e.alloc(c)),et=I.i32_const(e.alloc(c)),nt=I.i32_const(e.alloc(c)),st=I.i32_const(e.alloc(c)),ft=I.i32_const(e.alloc(c)),vt=I.i32_const(e.alloc(c));$.addCode(I.if(I.call(r+"_isZero",I.getLocal("p1")),[...I.call(r+"_copy",I.getLocal("p1"),I.getLocal("pr")),...I.ret([])]),I.if(I.call(t+"_isOne",X),[...I.ret(I.call(r+"_doubleAffine",I.getLocal("p1"),I.getLocal("pr"))),...I.ret([])]),I.call(t+"_square",K,Z),I.call(t+"_square",N,H),I.call(t+"_square",H,j),I.call(t+"_add",K,H,et),I.call(t+"_square",et,et),I.call(t+"_sub",et,Z,et),I.call(t+"_sub",et,j,et),I.call(t+"_add",et,et,et),I.call(t+"_add",Z,Z,nt),I.call(t+"_add",nt,Z,nt),I.call(t+"_square",nt,st),I.call(t+"_mul",N,X,ft),I.call(t+"_add",et,et,Q),I.call(t+"_sub",st,Q,Q),I.call(t+"_add",j,j,vt),I.call(t+"_add",vt,vt,vt),I.call(t+"_add",vt,vt,vt),I.call(t+"_sub",et,Q,L),I.call(t+"_mul",L,nt,L),I.call(t+"_sub",L,vt,L),I.call(t+"_add",ft,ft,V))}function T(){const $=e.addFunction(r+"_doubleAffine");$.addParam("p1","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c)),X=I.getLocal("pr"),Q=I.i32_add(I.getLocal("pr"),I.i32_const(c)),L=I.i32_add(I.getLocal("pr"),I.i32_const(c*2)),V=I.i32_const(e.alloc(c)),Z=I.i32_const(e.alloc(c)),H=I.i32_const(e.alloc(c)),j=I.i32_const(e.alloc(c)),et=I.i32_const(e.alloc(c)),nt=I.i32_const(e.alloc(c));$.addCode(I.if(I.call(r+"_isZeroAffine",I.getLocal("p1")),[...I.call(r+"_toJacobian",I.getLocal("p1"),I.getLocal("pr")),...I.ret([])]),I.call(t+"_square",K,V),I.call(t+"_square",N,Z),I.call(t+"_square",Z,H),I.call(t+"_add",K,Z,j),I.call(t+"_square",j,j),I.call(t+"_sub",j,V,j),I.call(t+"_sub",j,H,j),I.call(t+"_add",j,j,j),I.call(t+"_add",V,V,et),I.call(t+"_add",et,V,et),I.call(t+"_add",N,N,L),I.call(t+"_square",et,X),I.call(t+"_sub",X,j,X),I.call(t+"_sub",X,j,X),I.call(t+"_add",H,H,nt),I.call(t+"_add",nt,nt,nt),I.call(t+"_add",nt,nt,nt),I.call(t+"_sub",j,X,Q),I.call(t+"_mul",Q,et,Q),I.call(t+"_sub",Q,nt,Q))}function B(){const $=e.addFunction(r+"_eqAffine");$.addParam("p1","i32"),$.addParam("p2","i32"),$.setReturnType("i32"),$.addLocal("z1","i32");const I=$.getCodeBuilder();$.addCode(I.ret(I.i32_and(I.call(t+"_eq",I.getLocal("p1"),I.getLocal("p2")),I.call(t+"_eq",I.i32_add(I.getLocal("p1"),I.i32_const(c)),I.i32_add(I.getLocal("p2"),I.i32_const(c))))))}function M(){const $=e.addFunction(r+"_toMontgomery");$.addParam("p1","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder();$.addCode(I.call(t+"_toMontgomery",I.getLocal("p1"),I.getLocal("pr")));for(let K=1;K<3;K++)$.addCode(I.call(t+"_toMontgomery",I.i32_add(I.getLocal("p1"),I.i32_const(K*c)),I.i32_add(I.getLocal("pr"),I.i32_const(K*c))))}function R(){const $=e.addFunction(r+"_toMontgomeryAffine");$.addParam("p1","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder();$.addCode(I.call(t+"_toMontgomery",I.getLocal("p1"),I.getLocal("pr")));for(let K=1;K<2;K++)$.addCode(I.call(t+"_toMontgomery",I.i32_add(I.getLocal("p1"),I.i32_const(K*c)),I.i32_add(I.getLocal("pr"),I.i32_const(K*c))))}function P(){const $=e.addFunction(r+"_fromMontgomery");$.addParam("p1","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder();$.addCode(I.call(t+"_fromMontgomery",I.getLocal("p1"),I.getLocal("pr")));for(let K=1;K<3;K++)$.addCode(I.call(t+"_fromMontgomery",I.i32_add(I.getLocal("p1"),I.i32_const(K*c)),I.i32_add(I.getLocal("pr"),I.i32_const(K*c))))}function D(){const $=e.addFunction(r+"_fromMontgomeryAffine");$.addParam("p1","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder();$.addCode(I.call(t+"_fromMontgomery",I.getLocal("p1"),I.getLocal("pr")));for(let K=1;K<2;K++)$.addCode(I.call(t+"_fromMontgomery",I.i32_add(I.getLocal("p1"),I.i32_const(K*c)),I.i32_add(I.getLocal("pr"),I.i32_const(K*c))))}function q(){const $=e.addFunction(r+"_add");$.addParam("p1","i32"),$.addParam("p2","i32"),$.addParam("pr","i32"),$.addLocal("z1","i32"),$.addLocal("z2","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c));$.addCode(I.setLocal("z1",I.i32_add(I.getLocal("p1"),I.i32_const(c*2))));const X=I.getLocal("z1"),Q=I.getLocal("p2"),L=I.i32_add(I.getLocal("p2"),I.i32_const(c));$.addCode(I.setLocal("z2",I.i32_add(I.getLocal("p2"),I.i32_const(c*2))));const V=I.getLocal("z2"),Z=I.getLocal("pr"),H=I.i32_add(I.getLocal("pr"),I.i32_const(c)),j=I.i32_add(I.getLocal("pr"),I.i32_const(c*2)),et=I.i32_const(e.alloc(c)),nt=I.i32_const(e.alloc(c)),st=I.i32_const(e.alloc(c)),ft=I.i32_const(e.alloc(c)),vt=I.i32_const(e.alloc(c)),ot=I.i32_const(e.alloc(c)),pt=I.i32_const(e.alloc(c)),Ut=I.i32_const(e.alloc(c)),At=I.i32_const(e.alloc(c)),It=I.i32_const(e.alloc(c)),Jt=I.i32_const(e.alloc(c)),at=I.i32_const(e.alloc(c)),J=I.i32_const(e.alloc(c)),rt=I.i32_const(e.alloc(c)),lt=I.i32_const(e.alloc(c)),gt=I.i32_const(e.alloc(c)),Dt=I.i32_const(e.alloc(c));$.addCode(I.if(I.call(r+"_isZero",I.getLocal("p1")),[...I.call(r+"_copy",I.getLocal("p2"),I.getLocal("pr")),...I.ret([])]),I.if(I.call(r+"_isZero",I.getLocal("p2")),[...I.call(r+"_copy",I.getLocal("p1"),I.getLocal("pr")),...I.ret([])]),I.if(I.call(t+"_isOne",X),[...I.call(r+"_addMixed",Q,K,Z),...I.ret([])]),I.if(I.call(t+"_isOne",V),[...I.call(r+"_addMixed",K,Q,Z),...I.ret([])]),I.call(t+"_square",X,et),I.call(t+"_square",V,nt),I.call(t+"_mul",K,nt,st),I.call(t+"_mul",Q,et,ft),I.call(t+"_mul",X,et,vt),I.call(t+"_mul",V,nt,ot),I.call(t+"_mul",N,ot,pt),I.call(t+"_mul",L,vt,Ut),I.if(I.call(t+"_eq",st,ft),I.if(I.call(t+"_eq",pt,Ut),[...I.call(r+"_double",I.getLocal("p1"),I.getLocal("pr")),...I.ret([])])),I.call(t+"_sub",ft,st,At),I.call(t+"_sub",Ut,pt,It),I.call(t+"_add",At,At,Jt),I.call(t+"_square",Jt,Jt),I.call(t+"_mul",At,Jt,at),I.call(t+"_add",It,It,J),I.call(t+"_mul",st,Jt,lt),I.call(t+"_square",J,rt),I.call(t+"_add",lt,lt,gt),I.call(t+"_sub",rt,at,Z),I.call(t+"_sub",Z,gt,Z),I.call(t+"_mul",pt,at,Dt),I.call(t+"_add",Dt,Dt,Dt),I.call(t+"_sub",lt,Z,H),I.call(t+"_mul",H,J,H),I.call(t+"_sub",H,Dt,H),I.call(t+"_add",X,V,j),I.call(t+"_square",j,j),I.call(t+"_sub",j,et,j),I.call(t+"_sub",j,nt,j),I.call(t+"_mul",j,At,j))}function k(){const $=e.addFunction(r+"_addMixed");$.addParam("p1","i32"),$.addParam("p2","i32"),$.addParam("pr","i32"),$.addLocal("z1","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c));$.addCode(I.setLocal("z1",I.i32_add(I.getLocal("p1"),I.i32_const(c*2))));const X=I.getLocal("z1"),Q=I.getLocal("p2"),L=I.i32_add(I.getLocal("p2"),I.i32_const(c)),V=I.getLocal("pr"),Z=I.i32_add(I.getLocal("pr"),I.i32_const(c)),H=I.i32_add(I.getLocal("pr"),I.i32_const(c*2)),j=I.i32_const(e.alloc(c)),et=I.i32_const(e.alloc(c)),nt=I.i32_const(e.alloc(c)),st=I.i32_const(e.alloc(c)),ft=I.i32_const(e.alloc(c)),vt=I.i32_const(e.alloc(c)),ot=I.i32_const(e.alloc(c)),pt=I.i32_const(e.alloc(c)),Ut=I.i32_const(e.alloc(c)),At=I.i32_const(e.alloc(c)),It=I.i32_const(e.alloc(c)),Jt=I.i32_const(e.alloc(c)),at=I.i32_const(e.alloc(c)),J=I.i32_const(e.alloc(c));$.addCode(I.if(I.call(r+"_isZero",I.getLocal("p1")),[...I.call(r+"_copyAffine",I.getLocal("p2"),I.getLocal("pr")),...I.call(t+"_one",I.i32_add(I.getLocal("pr"),I.i32_const(c*2))),...I.ret([])]),I.if(I.call(r+"_isZeroAffine",I.getLocal("p2")),[...I.call(r+"_copy",I.getLocal("p1"),I.getLocal("pr")),...I.ret([])]),I.if(I.call(t+"_isOne",X),[...I.call(r+"_addAffine",K,Q,V),...I.ret([])]),I.call(t+"_square",X,j),I.call(t+"_mul",Q,j,et),I.call(t+"_mul",X,j,nt),I.call(t+"_mul",L,nt,st),I.if(I.call(t+"_eq",K,et),I.if(I.call(t+"_eq",N,st),[...I.call(r+"_doubleAffine",I.getLocal("p2"),I.getLocal("pr")),...I.ret([])])),I.call(t+"_sub",et,K,ft),I.call(t+"_sub",st,N,ot),I.call(t+"_square",ft,vt),I.call(t+"_add",vt,vt,pt),I.call(t+"_add",pt,pt,pt),I.call(t+"_mul",ft,pt,Ut),I.call(t+"_add",ot,ot,At),I.call(t+"_mul",K,pt,Jt),I.call(t+"_square",At,It),I.call(t+"_add",Jt,Jt,at),I.call(t+"_sub",It,Ut,V),I.call(t+"_sub",V,at,V),I.call(t+"_mul",N,Ut,J),I.call(t+"_add",J,J,J),I.call(t+"_sub",Jt,V,Z),I.call(t+"_mul",Z,At,Z),I.call(t+"_sub",Z,J,Z),I.call(t+"_add",X,ft,H),I.call(t+"_square",H,H),I.call(t+"_sub",H,j,H),I.call(t+"_sub",H,vt,H))}function U(){const $=e.addFunction(r+"_addAffine");$.addParam("p1","i32"),$.addParam("p2","i32"),$.addParam("pr","i32"),$.addLocal("z1","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c));$.addCode(I.setLocal("z1",I.i32_add(I.getLocal("p1"),I.i32_const(c*2))));const X=I.getLocal("p2"),Q=I.i32_add(I.getLocal("p2"),I.i32_const(c)),L=I.getLocal("pr"),V=I.i32_add(I.getLocal("pr"),I.i32_const(c)),Z=I.i32_add(I.getLocal("pr"),I.i32_const(c*2)),H=I.i32_const(e.alloc(c)),j=I.i32_const(e.alloc(c)),et=I.i32_const(e.alloc(c)),nt=I.i32_const(e.alloc(c)),st=I.i32_const(e.alloc(c)),ft=I.i32_const(e.alloc(c)),vt=I.i32_const(e.alloc(c)),ot=I.i32_const(e.alloc(c)),pt=I.i32_const(e.alloc(c)),Ut=I.i32_const(e.alloc(c));$.addCode(I.if(I.call(r+"_isZeroAffine",I.getLocal("p1")),[...I.call(r+"_copyAffine",I.getLocal("p2"),I.getLocal("pr")),...I.call(t+"_one",I.i32_add(I.getLocal("pr"),I.i32_const(c*2))),...I.ret([])]),I.if(I.call(r+"_isZeroAffine",I.getLocal("p2")),[...I.call(r+"_copyAffine",I.getLocal("p1"),I.getLocal("pr")),...I.call(t+"_one",I.i32_add(I.getLocal("pr"),I.i32_const(c*2))),...I.ret([])]),I.if(I.call(t+"_eq",K,X),I.if(I.call(t+"_eq",N,Q),[...I.call(r+"_doubleAffine",I.getLocal("p2"),I.getLocal("pr")),...I.ret([])])),I.call(t+"_sub",X,K,H),I.call(t+"_sub",Q,N,et),I.call(t+"_square",H,j),I.call(t+"_add",j,j,nt),I.call(t+"_add",nt,nt,nt),I.call(t+"_mul",H,nt,st),I.call(t+"_add",et,et,ft),I.call(t+"_mul",K,nt,ot),I.call(t+"_square",ft,vt),I.call(t+"_add",ot,ot,pt),I.call(t+"_sub",vt,st,L),I.call(t+"_sub",L,pt,L),I.call(t+"_mul",N,st,Ut),I.call(t+"_add",Ut,Ut,Ut),I.call(t+"_sub",ot,L,V),I.call(t+"_mul",V,ft,V),I.call(t+"_sub",V,Ut,V),I.call(t+"_add",H,H,Z))}function O(){const $=e.addFunction(r+"_neg");$.addParam("p1","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c)),X=I.i32_add(I.getLocal("p1"),I.i32_const(c*2)),Q=I.getLocal("pr"),L=I.i32_add(I.getLocal("pr"),I.i32_const(c)),V=I.i32_add(I.getLocal("pr"),I.i32_const(c*2));$.addCode(I.call(t+"_copy",K,Q),I.call(t+"_neg",N,L),I.call(t+"_copy",X,V))}function G(){const $=e.addFunction(r+"_negAffine");$.addParam("p1","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c)),X=I.getLocal("pr"),Q=I.i32_add(I.getLocal("pr"),I.i32_const(c));$.addCode(I.call(t+"_copy",K,X),I.call(t+"_neg",N,Q))}function E(){const $=e.addFunction(r+"_sub");$.addParam("p1","i32"),$.addParam("p2","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder(),K=I.i32_const(e.alloc(c*3));$.addCode(I.call(r+"_neg",I.getLocal("p2"),K),I.call(r+"_add",I.getLocal("p1"),K,I.getLocal("pr")))}function s(){const $=e.addFunction(r+"_subMixed");$.addParam("p1","i32"),$.addParam("p2","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder(),K=I.i32_const(e.alloc(c*3));$.addCode(I.call(r+"_negAffine",I.getLocal("p2"),K),I.call(r+"_addMixed",I.getLocal("p1"),K,I.getLocal("pr")))}function l(){const $=e.addFunction(r+"_subAffine");$.addParam("p1","i32"),$.addParam("p2","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder(),K=I.i32_const(e.alloc(c*3));$.addCode(I.call(r+"_negAffine",I.getLocal("p2"),K),I.call(r+"_addAffine",I.getLocal("p1"),K,I.getLocal("pr")))}function d(){const $=e.addFunction(r+"_normalize");$.addParam("p1","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c)),X=I.i32_add(I.getLocal("p1"),I.i32_const(c*2)),Q=I.getLocal("pr"),L=I.i32_add(I.getLocal("pr"),I.i32_const(c)),V=I.i32_add(I.getLocal("pr"),I.i32_const(c*2)),Z=I.i32_const(e.alloc(c)),H=I.i32_const(e.alloc(c)),j=I.i32_const(e.alloc(c));$.addCode(I.if(I.call(r+"_isZero",I.getLocal("p1")),I.call(r+"_zero",I.getLocal("pr")),[...I.call(t+"_inverse",X,Z),...I.call(t+"_square",Z,H),...I.call(t+"_mul",Z,H,j),...I.call(t+"_mul",K,H,Q),...I.call(t+"_mul",N,j,L),...I.call(t+"_one",V)]))}function p(){const $=e.addFunction(r+"_toAffine");$.addParam("p1","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c)),X=I.i32_add(I.getLocal("p1"),I.i32_const(c*2)),Q=I.getLocal("pr"),L=I.i32_add(I.getLocal("pr"),I.i32_const(c)),V=I.i32_const(e.alloc(c)),Z=I.i32_const(e.alloc(c)),H=I.i32_const(e.alloc(c));$.addCode(I.if(I.call(r+"_isZero",I.getLocal("p1")),[...I.call(t+"_zero",Q),...I.call(t+"_zero",L)],[...I.call(t+"_inverse",X,V),...I.call(t+"_square",V,Z),...I.call(t+"_mul",V,Z,H),...I.call(t+"_mul",K,Z,Q),...I.call(t+"_mul",N,H,L)]))}function m(){const $=e.addFunction(r+"_toJacobian");$.addParam("p1","i32"),$.addParam("pr","i32");const I=$.getCodeBuilder(),K=I.getLocal("p1"),N=I.i32_add(I.getLocal("p1"),I.i32_const(c)),X=I.getLocal("pr"),Q=I.i32_add(I.getLocal("pr"),I.i32_const(c)),L=I.i32_add(I.getLocal("pr"),I.i32_const(c*2));$.addCode(I.if(I.call(r+"_isZeroAffine",I.getLocal("p1")),I.call(r+"_zero",I.getLocal("pr")),[...I.call(t+"_one",L),...I.call(t+"_copy",N,Q),...I.call(t+"_copy",K,X)]))}function w(){const $=e.addFunction(r+"_batchToAffine");$.addParam("pIn","i32"),$.addParam("n","i32"),$.addParam("pOut","i32"),$.addLocal("pAux","i32"),$.addLocal("itIn","i32"),$.addLocal("itAux","i32"),$.addLocal("itOut","i32"),$.addLocal("i","i32");const I=$.getCodeBuilder(),K=I.i32_const(e.alloc(c));$.addCode(I.setLocal("pAux",I.i32_load(I.i32_const(0))),I.i32_store(I.i32_const(0),I.i32_add(I.getLocal("pAux"),I.i32_mul(I.getLocal("n"),I.i32_const(c)))),I.call(t+"_batchInverse",I.i32_add(I.getLocal("pIn"),I.i32_const(c*2)),I.i32_const(c*3),I.getLocal("n"),I.getLocal("pAux"),I.i32_const(c)),I.setLocal("itIn",I.getLocal("pIn")),I.setLocal("itAux",I.getLocal("pAux")),I.setLocal("itOut",I.getLocal("pOut")),I.setLocal("i",I.i32_const(0)),I.block(I.loop(I.br_if(1,I.i32_eq(I.getLocal("i"),I.getLocal("n"))),I.if(I.call(t+"_isZero",I.getLocal("itAux")),[...I.call(t+"_zero",I.getLocal("itOut")),...I.call(t+"_zero",I.i32_add(I.getLocal("itOut"),I.i32_const(c)))],[...I.call(t+"_mul",I.getLocal("itAux"),I.i32_add(I.getLocal("itIn"),I.i32_const(c)),K),...I.call(t+"_square",I.getLocal("itAux"),I.getLocal("itAux")),...I.call(t+"_mul",I.getLocal("itAux"),I.getLocal("itIn"),I.getLocal("itOut")),...I.call(t+"_mul",I.getLocal("itAux"),K,I.i32_add(I.getLocal("itOut"),I.i32_const(c)))]),I.setLocal("itIn",I.i32_add(I.getLocal("itIn"),I.i32_const(c*3))),I.setLocal("itOut",I.i32_add(I.getLocal("itOut"),I.i32_const(c*2))),I.setLocal("itAux",I.i32_add(I.getLocal("itAux"),I.i32_const(c))),I.setLocal("i",I.i32_add(I.getLocal("i"),I.i32_const(1))),I.br(0))),I.i32_store(I.i32_const(0),I.getLocal("pAux")))}function x(){const $=e.addFunction(r+"__reverseBytes");$.addParam("pIn","i32"),$.addParam("n","i32"),$.addParam("pOut","i32"),$.addLocal("itOut","i32"),$.addLocal("itIn","i32");const I=$.getCodeBuilder();$.addCode(I.setLocal("itOut",I.i32_sub(I.i32_add(I.getLocal("pOut"),I.getLocal("n")),I.i32_const(1))),I.setLocal("itIn",I.getLocal("pIn")),I.block(I.loop(I.br_if(1,I.i32_lt_s(I.getLocal("itOut"),I.getLocal("pOut"))),I.i32_store8(I.getLocal("itOut"),I.i32_load8_u(I.getLocal("itIn"))),I.setLocal("itOut",I.i32_sub(I.getLocal("itOut"),I.i32_const(1))),I.setLocal("itIn",I.i32_add(I.getLocal("itIn"),I.i32_const(1))),I.br(0))))}function b(){const $=e.addFunction(r+"_LEMtoC");$.addParam("pIn","i32"),$.addParam("pOut","i32");const I=$.getCodeBuilder(),K=I.i32_const(e.alloc(c));$.addCode(I.if(I.call(r+"_isZeroAffine",I.getLocal("pIn")),[...I.call(t+"_zero",I.getLocal("pOut")),...I.i32_store8(I.getLocal("pOut"),I.i32_const(64)),...I.ret([])]),I.call(t+"_fromMontgomery",I.getLocal("pIn"),K),I.call(r+"__reverseBytes",K,I.i32_const(c),I.getLocal("pOut")),I.if(I.i32_eq(I.call(t+"_sign",I.i32_add(I.getLocal("pIn"),I.i32_const(c))),I.i32_const(-1)),I.i32_store8(I.getLocal("pOut"),I.i32_or(I.i32_load8_u(I.getLocal("pOut")),I.i32_const(128)))))}function f(){const $=e.addFunction(r+"_LEMtoU");$.addParam("pIn","i32"),$.addParam("pOut","i32");const I=$.getCodeBuilder(),K=e.alloc(c*2),N=I.i32_const(K),X=I.i32_const(K),Q=I.i32_const(K+c);$.addCode(I.if(I.call(r+"_isZeroAffine",I.getLocal("pIn")),[...I.call(r+"_zeroAffine",I.getLocal("pOut")),...I.ret([])]),I.call(r+"_fromMontgomeryAffine",I.getLocal("pIn"),N),I.call(r+"__reverseBytes",X,I.i32_const(c),I.getLocal("pOut")),I.call(r+"__reverseBytes",Q,I.i32_const(c),I.i32_add(I.getLocal("pOut"),I.i32_const(c))))}function C(){const $=e.addFunction(r+"_UtoLEM");$.addParam("pIn","i32"),$.addParam("pOut","i32");const I=$.getCodeBuilder(),K=e.alloc(c*2),N=I.i32_const(K),X=I.i32_const(K),Q=I.i32_const(K+c);$.addCode(I.if(I.i32_and(I.i32_load8_u(I.getLocal("pIn")),I.i32_const(64)),[...I.call(r+"_zeroAffine",I.getLocal("pOut")),...I.ret([])]),I.call(r+"__reverseBytes",I.getLocal("pIn"),I.i32_const(c),X),I.call(r+"__reverseBytes",I.i32_add(I.getLocal("pIn"),I.i32_const(c)),I.i32_const(c),Q),I.call(r+"_toMontgomeryAffine",N,I.getLocal("pOut")))}function F(){const $=e.addFunction(r+"_CtoLEM");$.addParam("pIn","i32"),$.addParam("pOut","i32"),$.addLocal("firstByte","i32"),$.addLocal("greatest","i32");const I=$.getCodeBuilder(),K=e.alloc(c*2),N=I.i32_const(K),X=I.i32_const(K+c);$.addCode(I.setLocal("firstByte",I.i32_load8_u(I.getLocal("pIn"))),I.if(I.i32_and(I.getLocal("firstByte"),I.i32_const(64)),[...I.call(r+"_zeroAffine",I.getLocal("pOut")),...I.ret([])]),I.setLocal("greatest",I.i32_and(I.getLocal("firstByte"),I.i32_const(128))),I.call(t+"_copy",I.getLocal("pIn"),X),I.i32_store8(X,I.i32_and(I.getLocal("firstByte"),I.i32_const(63))),I.call(r+"__reverseBytes",X,I.i32_const(c),N),I.call(t+"_toMontgomery",N,I.getLocal("pOut")),I.call(t+"_square",I.getLocal("pOut"),X),I.call(t+"_mul",I.getLocal("pOut"),X,X),I.call(t+"_add",X,I.i32_const(a),X),I.call(t+"_sqrt",X,X),I.call(t+"_neg",X,N),I.if(I.i32_eq(I.call(t+"_sign",X),I.i32_const(-1)),I.if(I.getLocal("greatest"),I.call(t+"_copy",X,I.i32_add(I.getLocal("pOut"),I.i32_const(c))),I.call(t+"_neg",X,I.i32_add(I.getLocal("pOut"),I.i32_const(c)))),I.if(I.getLocal("greatest"),I.call(t+"_neg",X,I.i32_add(I.getLocal("pOut"),I.i32_const(c))),I.call(t+"_copy",X,I.i32_add(I.getLocal("pOut"),I.i32_const(c))))))}function z(){const $=e.addFunction(r+"_inCurveAffine");$.addParam("pIn","i32"),$.setReturnType("i32");const I=$.getCodeBuilder(),K=I.getLocal("pIn"),N=I.i32_add(I.getLocal("pIn"),I.i32_const(c)),X=I.i32_const(e.alloc(c)),Q=I.i32_const(e.alloc(c));$.addCode(I.call(t+"_square",N,X),I.call(t+"_square",K,Q),I.call(t+"_mul",K,Q,Q),I.call(t+"_add",Q,I.i32_const(a),Q),I.ret(I.call(t+"_eq",X,Q)))}function W(){const $=e.addFunction(r+"_inCurve");$.addParam("pIn","i32"),$.setReturnType("i32");const I=$.getCodeBuilder(),K=I.i32_const(e.alloc(c*2));$.addCode(I.call(r+"_toAffine",I.getLocal("pIn"),K),I.ret(I.call(r+"_inCurveAffine",K)))}return v(),u(),y(),g(),h(),o(),m(),B(),A(),_(),T(),S(),U(),k(),q(),G(),O(),l(),s(),E(),D(),P(),R(),M(),p(),z(),W(),w(),d(),x(),f(),b(),C(),F(),js(e,r+"_batchLEMtoU",r+"_LEMtoU",c*2,c*2),js(e,r+"_batchLEMtoC",r+"_LEMtoC",c*2,c),js(e,r+"_batchUtoLEM",r+"_UtoLEM",c*2,c*2),js(e,r+"_batchCtoLEM",r+"_CtoLEM",c,c*2,!0),js(e,r+"_batchToJacobian",r+"_toJacobian",c*2,c*3,!0),Qg(e,r,r+"_multiexp",r+"_add",c*3),Qg(e,r,r+"_multiexpAffine",r+"_addMixed",c*2),Hg(e,r+"_timesScalar",c*3,r+"_add",r+"_double",r+"_sub",r+"_copy",r+"_zero"),Hg(e,r+"_timesScalarAffine",c*2,r+"_addMixed",r+"_double",r+"_subMixed",r+"_copyAffine",r+"_zero"),e.exportFunction(r+"_isZero"),e.exportFunction(r+"_isZeroAffine"),e.exportFunction(r+"_eq"),e.exportFunction(r+"_eqMixed"),e.exportFunction(r+"_eqAffine"),e.exportFunction(r+"_copy"),e.exportFunction(r+"_copyAffine"),e.exportFunction(r+"_zero"),e.exportFunction(r+"_zeroAffine"),e.exportFunction(r+"_double"),e.exportFunction(r+"_doubleAffine"),e.exportFunction(r+"_add"),e.exportFunction(r+"_addMixed"),e.exportFunction(r+"_addAffine"),e.exportFunction(r+"_neg"),e.exportFunction(r+"_negAffine"),e.exportFunction(r+"_sub"),e.exportFunction(r+"_subMixed"),e.exportFunction(r+"_subAffine"),e.exportFunction(r+"_fromMontgomery"),e.exportFunction(r+"_fromMontgomeryAffine"),e.exportFunction(r+"_toMontgomery"),e.exportFunction(r+"_toMontgomeryAffine"),e.exportFunction(r+"_timesScalar"),e.exportFunction(r+"_timesScalarAffine"),e.exportFunction(r+"_normalize"),e.exportFunction(r+"_LEMtoU"),e.exportFunction(r+"_LEMtoC"),e.exportFunction(r+"_UtoLEM"),e.exportFunction(r+"_CtoLEM"),e.exportFunction(r+"_batchLEMtoU"),e.exportFunction(r+"_batchLEMtoC"),e.exportFunction(r+"_batchUtoLEM"),e.exportFunction(r+"_batchCtoLEM"),e.exportFunction(r+"_toAffine"),e.exportFunction(r+"_toJacobian"),e.exportFunction(r+"_batchToAffine"),e.exportFunction(r+"_batchToJacobian"),e.exportFunction(r+"_inCurve"),e.exportFunction(r+"_inCurveAffine"),r};const{isOdd:kC,modInv:$g,modPow:Ws}=yi,Mf=wa;var Tb=function(e,r,t,a,n){const u=e.modules[a].n64*8,o=e.modules[t].n64*8,h=e.modules[a].q;let g=h-1n,y=0;for(;!kC(g);)y++,g=g>>1n;let _=2n;for(;Ws(_,h>>1n,h)===1n;)_=_+1n;const A=new Array(y+1);A[y]=Ws(_,g,h);let S=y-1;for(;S>=0;)A[S]=Ws(A[S+1],2n,h),S--;const T=[],B=(1n<<BigInt(u*8))%h;for(let K=0;K<A.length;K++){const N=A[K]*B%h;T.push(...Mf.bigInt2BytesLE(N,u))}const M=e.alloc(T),R=new Array(y+1);R[0]=1n;for(let K=1;K<=y;K++)R[K]=R[K-1]*2n;const P=[];for(let K=0;K<=y;K++){const N=$g(R[K],h)*B%h;P.push(...Mf.bigInt2BytesLE(N,u))}const D=e.alloc(P),q=Ws(_,2n,h),k=[],U=[];for(let K=0;K<=y;K++){const N=Ws(q,2n**BigInt(K),h),X=$g(h+1n-N,h);k.push(...Mf.bigInt2BytesLE(N*B%h,u)),U.push(...Mf.bigInt2BytesLE(X*B%h,u))}const O=e.alloc(k),G=e.alloc(U);function E(K){let N=0;for(let X=0;X<8;X++)K&1<<X&&(N=N|128>>X);return N}const s=Array(256);for(let K=0;K<256;K++)s[K]=E(K);const l=e.alloc(s);function d(){const K=e.addFunction(r+"__log2");K.addParam("n","i32"),K.setReturnType("i32"),K.addLocal("bits","i32"),K.addLocal("aux","i32");const N=K.getCodeBuilder();K.addCode(N.setLocal("aux",N.i32_shr_u(N.getLocal("n"),N.i32_const(1)))),K.addCode(N.setLocal("bits",N.i32_const(0))),K.addCode(N.block(N.loop(N.br_if(1,N.i32_eqz(N.getLocal("aux"))),N.setLocal("aux",N.i32_shr_u(N.getLocal("aux"),N.i32_const(1))),N.setLocal("bits",N.i32_add(N.getLocal("bits"),N.i32_const(1))),N.br(0)))),K.addCode(N.if(N.i32_ne(N.getLocal("n"),N.i32_shl(N.i32_const(1),N.getLocal("bits"))),N.unreachable())),K.addCode(N.if(N.i32_gt_u(N.getLocal("bits"),N.i32_const(y)),N.unreachable())),K.addCode(N.getLocal("bits"))}function p(){const K=e.addFunction(r+"_fft");K.addParam("px","i32"),K.addParam("n","i32"),K.addLocal("bits","i32");const N=K.getCodeBuilder(),X=N.i32_const(e.alloc(u));K.addCode(N.setLocal("bits",N.call(r+"__log2",N.getLocal("n"))),N.call(a+"_one",X),N.call(r+"_rawfft",N.getLocal("px"),N.getLocal("bits"),N.i32_const(0),X))}function m(){const K=e.addFunction(r+"_ifft");K.addParam("px","i32"),K.addParam("n","i32"),K.addLocal("bits","i32"),K.addLocal("pInv2","i32");const N=K.getCodeBuilder();K.addCode(N.setLocal("bits",N.call(r+"__log2",N.getLocal("n"))),N.setLocal("pInv2",N.i32_add(N.i32_const(D),N.i32_mul(N.getLocal("bits"),N.i32_const(u)))),N.call(r+"_rawfft",N.getLocal("px"),N.getLocal("bits"),N.i32_const(1),N.getLocal("pInv2")))}function w(){const K=e.addFunction(r+"_rawfft");K.addParam("px","i32"),K.addParam("bits","i32"),K.addParam("reverse","i32"),K.addParam("mulFactor","i32"),K.addLocal("s","i32"),K.addLocal("k","i32"),K.addLocal("j","i32"),K.addLocal("m","i32"),K.addLocal("mdiv2","i32"),K.addLocal("n","i32"),K.addLocal("pwm","i32"),K.addLocal("idx1","i32"),K.addLocal("idx2","i32");const N=K.getCodeBuilder(),X=N.i32_const(e.alloc(u)),Q=N.i32_const(e.alloc(o)),L=N.i32_const(e.alloc(o));K.addCode(N.call(r+"__reversePermutation",N.getLocal("px"),N.getLocal("bits")),N.setLocal("n",N.i32_shl(N.i32_const(1),N.getLocal("bits"))),N.setLocal("s",N.i32_const(1)),N.block(N.loop(N.br_if(1,N.i32_gt_u(N.getLocal("s"),N.getLocal("bits"))),N.setLocal("m",N.i32_shl(N.i32_const(1),N.getLocal("s"))),N.setLocal("pwm",N.i32_add(N.i32_const(M),N.i32_mul(N.getLocal("s"),N.i32_const(u)))),N.setLocal("k",N.i32_const(0)),N.block(N.loop(N.br_if(1,N.i32_ge_u(N.getLocal("k"),N.getLocal("n"))),N.call(a+"_one",X),N.setLocal("mdiv2",N.i32_shr_u(N.getLocal("m"),N.i32_const(1))),N.setLocal("j",N.i32_const(0)),N.block(N.loop(N.br_if(1,N.i32_ge_u(N.getLocal("j"),N.getLocal("mdiv2"))),N.setLocal("idx1",N.i32_add(N.getLocal("px"),N.i32_mul(N.i32_add(N.getLocal("k"),N.getLocal("j")),N.i32_const(o)))),N.setLocal("idx2",N.i32_add(N.getLocal("idx1"),N.i32_mul(N.getLocal("mdiv2"),N.i32_const(o)))),N.call(n,N.getLocal("idx2"),X,Q),N.call(t+"_copy",N.getLocal("idx1"),L),N.call(t+"_add",L,Q,N.getLocal("idx1")),N.call(t+"_sub",L,Q,N.getLocal("idx2")),N.call(a+"_mul",X,N.getLocal("pwm"),X),N.setLocal("j",N.i32_add(N.getLocal("j"),N.i32_const(1))),N.br(0))),N.setLocal("k",N.i32_add(N.getLocal("k"),N.getLocal("m"))),N.br(0))),N.setLocal("s",N.i32_add(N.getLocal("s"),N.i32_const(1))),N.br(0))),N.call(r+"__fftFinal",N.getLocal("px"),N.getLocal("bits"),N.getLocal("reverse"),N.getLocal("mulFactor")))}function x(){const K=e.addFunction(r+"__fftFinal");K.addParam("px","i32"),K.addParam("bits","i32"),K.addParam("reverse","i32"),K.addParam("mulFactor","i32"),K.addLocal("n","i32"),K.addLocal("ndiv2","i32"),K.addLocal("pInv2","i32"),K.addLocal("i","i32"),K.addLocal("mask","i32"),K.addLocal("idx1","i32"),K.addLocal("idx2","i32");const N=K.getCodeBuilder(),X=N.i32_const(e.alloc(o));K.addCode(N.if(N.i32_and(N.i32_eqz(N.getLocal("reverse")),N.call(a+"_isOne",N.getLocal("mulFactor"))),N.ret([])),N.setLocal("n",N.i32_shl(N.i32_const(1),N.getLocal("bits"))),N.setLocal("mask",N.i32_sub(N.getLocal("n"),N.i32_const(1))),N.setLocal("i",N.i32_const(1)),N.setLocal("ndiv2",N.i32_shr_u(N.getLocal("n"),N.i32_const(1))),N.block(N.loop(N.br_if(1,N.i32_ge_u(N.getLocal("i"),N.getLocal("ndiv2"))),N.setLocal("idx1",N.i32_add(N.getLocal("px"),N.i32_mul(N.getLocal("i"),N.i32_const(o)))),N.setLocal("idx2",N.i32_add(N.getLocal("px"),N.i32_mul(N.i32_sub(N.getLocal("n"),N.getLocal("i")),N.i32_const(o)))),N.if(N.getLocal("reverse"),N.if(N.call(a+"_isOne",N.getLocal("mulFactor")),[...N.call(t+"_copy",N.getLocal("idx1"),X),...N.call(t+"_copy",N.getLocal("idx2"),N.getLocal("idx1")),...N.call(t+"_copy",X,N.getLocal("idx2"))],[...N.call(t+"_copy",N.getLocal("idx1"),X),...N.call(n,N.getLocal("idx2"),N.getLocal("mulFactor"),N.getLocal("idx1")),...N.call(n,X,N.getLocal("mulFactor"),N.getLocal("idx2"))]),N.if(N.call(a+"_isOne",N.getLocal("mulFactor")),[],[...N.call(n,N.getLocal("idx1"),N.getLocal("mulFactor"),N.getLocal("idx1")),...N.call(n,N.getLocal("idx2"),N.getLocal("mulFactor"),N.getLocal("idx2"))])),N.setLocal("i",N.i32_add(N.getLocal("i"),N.i32_const(1))),N.br(0))),N.if(N.call(a+"_isOne",N.getLocal("mulFactor")),[],[...N.call(n,N.getLocal("px"),N.getLocal("mulFactor"),N.getLocal("px")),...N.setLocal("idx2",N.i32_add(N.getLocal("px"),N.i32_mul(N.getLocal("ndiv2"),N.i32_const(o)))),...N.call(n,N.getLocal("idx2"),N.getLocal("mulFactor"),N.getLocal("idx2"))]))}function b(){const K=e.addFunction(r+"__reversePermutation");K.addParam("px","i32"),K.addParam("bits","i32"),K.addLocal("n","i32"),K.addLocal("i","i32"),K.addLocal("ri","i32"),K.addLocal("idx1","i32"),K.addLocal("idx2","i32");const N=K.getCodeBuilder(),X=N.i32_const(e.alloc(o));K.addCode(N.setLocal("n",N.i32_shl(N.i32_const(1),N.getLocal("bits"))),N.setLocal("i",N.i32_const(0)),N.block(N.loop(N.br_if(1,N.i32_eq(N.getLocal("i"),N.getLocal("n"))),N.setLocal("idx1",N.i32_add(N.getLocal("px"),N.i32_mul(N.getLocal("i"),N.i32_const(o)))),N.setLocal("ri",N.call(r+"__rev",N.getLocal("i"),N.getLocal("bits"))),N.setLocal("idx2",N.i32_add(N.getLocal("px"),N.i32_mul(N.getLocal("ri"),N.i32_const(o)))),N.if(N.i32_lt_u(N.getLocal("i"),N.getLocal("ri")),[...N.call(t+"_copy",N.getLocal("idx1"),X),...N.call(t+"_copy",N.getLocal("idx2"),N.getLocal("idx1")),...N.call(t+"_copy",X,N.getLocal("idx2"))]),N.setLocal("i",N.i32_add(N.getLocal("i"),N.i32_const(1))),N.br(0))))}function f(){const K=e.addFunction(r+"__rev");K.addParam("x","i32"),K.addParam("bits","i32"),K.setReturnType("i32");const N=K.getCodeBuilder();K.addCode(N.i32_rotl(N.i32_add(N.i32_add(N.i32_shl(N.i32_load8_u(N.i32_and(N.getLocal("x"),N.i32_const(255)),l,0),N.i32_const(24)),N.i32_shl(N.i32_load8_u(N.i32_and(N.i32_shr_u(N.getLocal("x"),N.i32_const(8)),N.i32_const(255)),l,0),N.i32_const(16))),N.i32_add(N.i32_shl(N.i32_load8_u(N.i32_and(N.i32_shr_u(N.getLocal("x"),N.i32_const(16)),N.i32_const(255)),l,0),N.i32_const(8)),N.i32_load8_u(N.i32_and(N.i32_shr_u(N.getLocal("x"),N.i32_const(24)),N.i32_const(255)),l,0))),N.getLocal("bits")))}function C(){const K=e.addFunction(r+"_fftJoin");K.addParam("pBuff1","i32"),K.addParam("pBuff2","i32"),K.addParam("n","i32"),K.addParam("first","i32"),K.addParam("inc","i32"),K.addLocal("idx1","i32"),K.addLocal("idx2","i32"),K.addLocal("i","i32");const N=K.getCodeBuilder(),X=N.i32_const(e.alloc(u)),Q=N.i32_const(e.alloc(o)),L=N.i32_const(e.alloc(o));K.addCode(N.call(a+"_copy",N.getLocal("first"),X),N.setLocal("i",N.i32_const(0)),N.block(N.loop(N.br_if(1,N.i32_eq(N.getLocal("i"),N.getLocal("n"))),N.setLocal("idx1",N.i32_add(N.getLocal("pBuff1"),N.i32_mul(N.getLocal("i"),N.i32_const(o)))),N.setLocal("idx2",N.i32_add(N.getLocal("pBuff2"),N.i32_mul(N.getLocal("i"),N.i32_const(o)))),N.call(n,N.getLocal("idx2"),X,Q),N.call(t+"_copy",N.getLocal("idx1"),L),N.call(t+"_add",L,Q,N.getLocal("idx1")),N.call(t+"_sub",L,Q,N.getLocal("idx2")),N.call(a+"_mul",X,N.getLocal("inc"),X),N.setLocal("i",N.i32_add(N.getLocal("i"),N.i32_const(1))),N.br(0))))}function F(){const K=e.addFunction(r+"_fftJoinExt");K.addParam("pBuff1","i32"),K.addParam("pBuff2","i32"),K.addParam("n","i32"),K.addParam("first","i32"),K.addParam("inc","i32"),K.addParam("totalBits","i32"),K.addLocal("idx1","i32"),K.addLocal("idx2","i32"),K.addLocal("i","i32"),K.addLocal("pShiftToM","i32");const N=K.getCodeBuilder(),X=N.i32_const(e.alloc(u)),Q=N.i32_const(e.alloc(o));K.addCode(N.setLocal("pShiftToM",N.i32_add(N.i32_const(O),N.i32_mul(N.getLocal("totalBits"),N.i32_const(u)))),N.call(a+"_copy",N.getLocal("first"),X),N.setLocal("i",N.i32_const(0)),N.block(N.loop(N.br_if(1,N.i32_eq(N.getLocal("i"),N.getLocal("n"))),N.setLocal("idx1",N.i32_add(N.getLocal("pBuff1"),N.i32_mul(N.getLocal("i"),N.i32_const(o)))),N.setLocal("idx2",N.i32_add(N.getLocal("pBuff2"),N.i32_mul(N.getLocal("i"),N.i32_const(o)))),N.call(t+"_add",N.getLocal("idx1"),N.getLocal("idx2"),Q),N.call(n,N.getLocal("idx2"),N.getLocal("pShiftToM"),N.getLocal("idx2")),N.call(t+"_add",N.getLocal("idx1"),N.getLocal("idx2"),N.getLocal("idx2")),N.call(n,N.getLocal("idx2"),X,N.getLocal("idx2")),N.call(t+"_copy",Q,N.getLocal("idx1")),N.call(a+"_mul",X,N.getLocal("inc"),X),N.setLocal("i",N.i32_add(N.getLocal("i"),N.i32_const(1))),N.br(0))))}function z(){const K=e.addFunction(r+"_fftJoinExtInv");K.addParam("pBuff1","i32"),K.addParam("pBuff2","i32"),K.addParam("n","i32"),K.addParam("first","i32"),K.addParam("inc","i32"),K.addParam("totalBits","i32"),K.addLocal("idx1","i32"),K.addLocal("idx2","i32"),K.addLocal("i","i32"),K.addLocal("pShiftToM","i32"),K.addLocal("pSConst","i32");const N=K.getCodeBuilder(),X=N.i32_const(e.alloc(u)),Q=N.i32_const(e.alloc(o));K.addCode(N.setLocal("pShiftToM",N.i32_add(N.i32_const(O),N.i32_mul(N.getLocal("totalBits"),N.i32_const(u)))),N.setLocal("pSConst",N.i32_add(N.i32_const(G),N.i32_mul(N.getLocal("totalBits"),N.i32_const(u)))),N.call(a+"_copy",N.getLocal("first"),X),N.setLocal("i",N.i32_const(0)),N.block(N.loop(N.br_if(1,N.i32_eq(N.getLocal("i"),N.getLocal("n"))),N.setLocal("idx1",N.i32_add(N.getLocal("pBuff1"),N.i32_mul(N.getLocal("i"),N.i32_const(o)))),N.setLocal("idx2",N.i32_add(N.getLocal("pBuff2"),N.i32_mul(N.getLocal("i"),N.i32_const(o)))),N.call(n,N.getLocal("idx2"),X,Q),N.call(t+"_sub",N.getLocal("idx1"),Q,N.getLocal("idx2")),N.call(n,N.getLocal("idx2"),N.getLocal("pSConst"),N.getLocal("idx2")),N.call(n,N.getLocal("idx1"),N.getLocal("pShiftToM"),N.getLocal("idx1")),N.call(t+"_sub",Q,N.getLocal("idx1"),N.getLocal("idx1")),N.call(n,N.getLocal("idx1"),N.getLocal("pSConst"),N.getLocal("idx1")),N.call(a+"_mul",X,N.getLocal("inc"),X),N.setLocal("i",N.i32_add(N.getLocal("i"),N.i32_const(1))),N.br(0))))}function W(){const K=e.addFunction(r+"_prepareLagrangeEvaluation");K.addParam("pBuff1","i32"),K.addParam("pBuff2","i32"),K.addParam("n","i32"),K.addParam("first","i32"),K.addParam("inc","i32"),K.addParam("totalBits","i32"),K.addLocal("idx1","i32"),K.addLocal("idx2","i32"),K.addLocal("i","i32"),K.addLocal("pShiftToM","i32"),K.addLocal("pSConst","i32");const N=K.getCodeBuilder(),X=N.i32_const(e.alloc(u)),Q=N.i32_const(e.alloc(o));K.addCode(N.setLocal("pShiftToM",N.i32_add(N.i32_const(O),N.i32_mul(N.getLocal("totalBits"),N.i32_const(u)))),N.setLocal("pSConst",N.i32_add(N.i32_const(G),N.i32_mul(N.getLocal("totalBits"),N.i32_const(u)))),N.call(a+"_copy",N.getLocal("first"),X),N.setLocal("i",N.i32_const(0)),N.block(N.loop(N.br_if(1,N.i32_eq(N.getLocal("i"),N.getLocal("n"))),N.setLocal("idx1",N.i32_add(N.getLocal("pBuff1"),N.i32_mul(N.getLocal("i"),N.i32_const(o)))),N.setLocal("idx2",N.i32_add(N.getLocal("pBuff2"),N.i32_mul(N.getLocal("i"),N.i32_const(o)))),N.call(n,N.getLocal("idx1"),N.getLocal("pShiftToM"),Q),N.call(t+"_sub",N.getLocal("idx2"),Q,Q),N.call(t+"_sub",N.getLocal("idx1"),N.getLocal("idx2"),N.getLocal("idx2")),N.call(n,Q,N.getLocal("pSConst"),N.getLocal("idx1")),N.call(n,N.getLocal("idx2"),X,N.getLocal("idx2")),N.call(a+"_mul",X,N.getLocal("inc"),X),N.setLocal("i",N.i32_add(N.getLocal("i"),N.i32_const(1))),N.br(0))))}function $(){const K=e.addFunction(r+"_fftMix");K.addParam("pBuff","i32"),K.addParam("n","i32"),K.addParam("exp","i32"),K.addLocal("nGroups","i32"),K.addLocal("nPerGroup","i32"),K.addLocal("nPerGroupDiv2","i32"),K.addLocal("pairOffset","i32"),K.addLocal("idx1","i32"),K.addLocal("idx2","i32"),K.addLocal("i","i32"),K.addLocal("j","i32"),K.addLocal("pwm","i32");const N=K.getCodeBuilder(),X=N.i32_const(e.alloc(u)),Q=N.i32_const(e.alloc(o)),L=N.i32_const(e.alloc(o));K.addCode(N.setLocal("nPerGroup",N.i32_shl(N.i32_const(1),N.getLocal("exp"))),N.setLocal("nPerGroupDiv2",N.i32_shr_u(N.getLocal("nPerGroup"),N.i32_const(1))),N.setLocal("nGroups",N.i32_shr_u(N.getLocal("n"),N.getLocal("exp"))),N.setLocal("pairOffset",N.i32_mul(N.getLocal("nPerGroupDiv2"),N.i32_const(o))),N.setLocal("pwm",N.i32_add(N.i32_const(M),N.i32_mul(N.getLocal("exp"),N.i32_const(u)))),N.setLocal("i",N.i32_const(0)),N.block(N.loop(N.br_if(1,N.i32_eq(N.getLocal("i"),N.getLocal("nGroups"))),N.call(a+"_one",X),N.setLocal("j",N.i32_const(0)),N.block(N.loop(N.br_if(1,N.i32_eq(N.getLocal("j"),N.getLocal("nPerGroupDiv2"))),N.setLocal("idx1",N.i32_add(N.getLocal("pBuff"),N.i32_mul(N.i32_add(N.i32_mul(N.getLocal("i"),N.getLocal("nPerGroup")),N.getLocal("j")),N.i32_const(o)))),N.setLocal("idx2",N.i32_add(N.getLocal("idx1"),N.getLocal("pairOffset"))),N.call(n,N.getLocal("idx2"),X,Q),N.call(t+"_copy",N.getLocal("idx1"),L),N.call(t+"_add",L,Q,N.getLocal("idx1")),N.call(t+"_sub",L,Q,N.getLocal("idx2")),N.call(a+"_mul",X,N.getLocal("pwm"),X),N.setLocal("j",N.i32_add(N.getLocal("j"),N.i32_const(1))),N.br(0))),N.setLocal("i",N.i32_add(N.getLocal("i"),N.i32_const(1))),N.br(0))))}function I(){const K=e.addFunction(r+"_fftFinal");K.addParam("pBuff","i32"),K.addParam("n","i32"),K.addParam("factor","i32"),K.addLocal("idx1","i32"),K.addLocal("idx2","i32"),K.addLocal("i","i32"),K.addLocal("ndiv2","i32");const N=K.getCodeBuilder(),X=N.i32_const(e.alloc(o));K.addCode(N.setLocal("ndiv2",N.i32_shr_u(N.getLocal("n"),N.i32_const(1))),N.if(N.i32_and(N.getLocal("n"),N.i32_const(1)),N.call(n,N.i32_add(N.getLocal("pBuff"),N.i32_mul(N.getLocal("ndiv2"),N.i32_const(o))),N.getLocal("factor"),N.i32_add(N.getLocal("pBuff"),N.i32_mul(N.getLocal("ndiv2"),N.i32_const(o))))),N.setLocal("i",N.i32_const(0)),N.block(N.loop(N.br_if(1,N.i32_ge_u(N.getLocal("i"),N.getLocal("ndiv2"))),N.setLocal("idx1",N.i32_add(N.getLocal("pBuff"),N.i32_mul(N.getLocal("i"),N.i32_const(o)))),N.setLocal("idx2",N.i32_add(N.getLocal("pBuff"),N.i32_mul(N.i32_sub(N.i32_sub(N.getLocal("n"),N.i32_const(1)),N.getLocal("i")),N.i32_const(o)))),N.call(n,N.getLocal("idx2"),N.getLocal("factor"),X),N.call(n,N.getLocal("idx1"),N.getLocal("factor"),N.getLocal("idx2")),N.call(t+"_copy",X,N.getLocal("idx1")),N.setLocal("i",N.i32_add(N.getLocal("i"),N.i32_const(1))),N.br(0))))}f(),b(),x(),w(),d(),p(),m(),C(),F(),z(),$(),I(),W(),e.exportFunction(r+"_fft"),e.exportFunction(r+"_ifft"),e.exportFunction(r+"_rawfft"),e.exportFunction(r+"_fftJoin"),e.exportFunction(r+"_fftJoinExt"),e.exportFunction(r+"_fftJoinExtInv"),e.exportFunction(r+"_fftMix"),e.exportFunction(r+"_fftFinal"),e.exportFunction(r+"_prepareLagrangeEvaluation")},Rb=function(e,r,t){const n=e.modules[t].n64*8;function c(){const v=e.addFunction(r+"_zero");v.addParam("px","i32"),v.addParam("n","i32"),v.addLocal("lastp","i32"),v.addLocal("p","i32");const o=v.getCodeBuilder();v.addCode(o.setLocal("p",o.getLocal("px")),o.setLocal("lastp",o.i32_add(o.getLocal("px"),o.i32_mul(o.getLocal("n"),o.i32_const(n)))),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("p"),o.getLocal("lastp"))),o.call(t+"_zero",o.getLocal("p")),o.setLocal("p",o.i32_add(o.getLocal("p"),o.i32_const(n))),o.br(0))))}function u(){const v=e.addFunction(r+"_constructLC");v.addParam("ppolynomials","i32"),v.addParam("psignals","i32"),v.addParam("nSignals","i32"),v.addParam("pres","i32"),v.addLocal("i","i32"),v.addLocal("j","i32"),v.addLocal("pp","i32"),v.addLocal("ps","i32"),v.addLocal("pd","i32"),v.addLocal("ncoefs","i32");const o=v.getCodeBuilder(),h=o.i32_const(e.alloc(n));v.addCode(o.setLocal("i",o.i32_const(0)),o.setLocal("pp",o.getLocal("ppolynomials")),o.setLocal("ps",o.getLocal("psignals")),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("nSignals"))),o.setLocal("ncoefs",o.i32_load(o.getLocal("pp"))),o.setLocal("pp",o.i32_add(o.getLocal("pp"),o.i32_const(4))),o.setLocal("j",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("j"),o.getLocal("ncoefs"))),o.setLocal("pd",o.i32_add(o.getLocal("pres"),o.i32_mul(o.i32_load(o.getLocal("pp")),o.i32_const(n)))),o.setLocal("pp",o.i32_add(o.getLocal("pp"),o.i32_const(4))),o.call(t+"_mul",o.getLocal("ps"),o.getLocal("pp"),h),o.call(t+"_add",h,o.getLocal("pd"),o.getLocal("pd")),o.setLocal("pp",o.i32_add(o.getLocal("pp"),o.i32_const(n))),o.setLocal("j",o.i32_add(o.getLocal("j"),o.i32_const(1))),o.br(0))),o.setLocal("ps",o.i32_add(o.getLocal("ps"),o.i32_const(n))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))))}return c(),u(),e.exportFunction(r+"_zero"),e.exportFunction(r+"_constructLC"),r},Nb=function(e,r,t){const n=e.modules[t].n64*8;function c(){const o=e.addFunction(r+"_buildABC");o.addParam("pCoefs","i32"),o.addParam("nCoefs","i32"),o.addParam("pWitness","i32"),o.addParam("pA","i32"),o.addParam("pB","i32"),o.addParam("pC","i32"),o.addParam("offsetOut","i32"),o.addParam("nOut","i32"),o.addParam("offsetWitness","i32"),o.addParam("nWitness","i32"),o.addLocal("it","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("last","i32"),o.addLocal("m","i32"),o.addLocal("c","i32"),o.addLocal("s","i32"),o.addLocal("pOut","i32");const h=o.getCodeBuilder(),g=h.i32_const(e.alloc(n));o.addCode(h.setLocal("ita",h.getLocal("pA")),h.setLocal("itb",h.getLocal("pB")),h.setLocal("last",h.i32_add(h.getLocal("pA"),h.i32_mul(h.getLocal("nOut"),h.i32_const(n)))),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("ita"),h.getLocal("last"))),h.call(t+"_zero",h.getLocal("ita")),h.call(t+"_zero",h.getLocal("itb")),h.setLocal("ita",h.i32_add(h.getLocal("ita"),h.i32_const(n))),h.setLocal("itb",h.i32_add(h.getLocal("itb"),h.i32_const(n))),h.br(0))),h.setLocal("it",h.getLocal("pCoefs")),h.setLocal("last",h.i32_add(h.getLocal("pCoefs"),h.i32_mul(h.getLocal("nCoefs"),h.i32_const(n+12)))),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("it"),h.getLocal("last"))),h.setLocal("s",h.i32_load(h.getLocal("it"),8)),h.if(h.i32_or(h.i32_lt_u(h.getLocal("s"),h.getLocal("offsetWitness")),h.i32_ge_u(h.getLocal("s"),h.i32_add(h.getLocal("offsetWitness"),h.getLocal("nWitness")))),[...h.setLocal("it",h.i32_add(h.getLocal("it"),h.i32_const(n+12))),...h.br(1)]),h.setLocal("m",h.i32_load(h.getLocal("it"))),h.if(h.i32_eq(h.getLocal("m"),h.i32_const(0)),h.setLocal("pOut",h.getLocal("pA")),h.if(h.i32_eq(h.getLocal("m"),h.i32_const(1)),h.setLocal("pOut",h.getLocal("pB")),[...h.setLocal("it",h.i32_add(h.getLocal("it"),h.i32_const(n+12))),...h.br(1)])),h.setLocal("c",h.i32_load(h.getLocal("it"),4)),h.if(h.i32_or(h.i32_lt_u(h.getLocal("c"),h.getLocal("offsetOut")),h.i32_ge_u(h.getLocal("c"),h.i32_add(h.getLocal("offsetOut"),h.getLocal("nOut")))),[...h.setLocal("it",h.i32_add(h.getLocal("it"),h.i32_const(n+12))),...h.br(1)]),h.setLocal("pOut",h.i32_add(h.getLocal("pOut"),h.i32_mul(h.i32_sub(h.getLocal("c"),h.getLocal("offsetOut")),h.i32_const(n)))),h.call(t+"_mul",h.i32_add(h.getLocal("pWitness"),h.i32_mul(h.i32_sub(h.getLocal("s"),h.getLocal("offsetWitness")),h.i32_const(n))),h.i32_add(h.getLocal("it"),h.i32_const(12)),g),h.call(t+"_add",h.getLocal("pOut"),g,h.getLocal("pOut")),h.setLocal("it",h.i32_add(h.getLocal("it"),h.i32_const(n+12))),h.br(0))),h.setLocal("ita",h.getLocal("pA")),h.setLocal("itb",h.getLocal("pB")),h.setLocal("it",h.getLocal("pC")),h.setLocal("last",h.i32_add(h.getLocal("pA"),h.i32_mul(h.getLocal("nOut"),h.i32_const(n)))),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("ita"),h.getLocal("last"))),h.call(t+"_mul",h.getLocal("ita"),h.getLocal("itb"),h.getLocal("it")),h.setLocal("ita",h.i32_add(h.getLocal("ita"),h.i32_const(n))),h.setLocal("itb",h.i32_add(h.getLocal("itb"),h.i32_const(n))),h.setLocal("it",h.i32_add(h.getLocal("it"),h.i32_const(n))),h.br(0))))}function u(){const o=e.addFunction(r+"_joinABC");o.addParam("pA","i32"),o.addParam("pB","i32"),o.addParam("pC","i32"),o.addParam("n","i32"),o.addParam("pP","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("itc","i32"),o.addLocal("itp","i32"),o.addLocal("last","i32");const h=o.getCodeBuilder(),g=h.i32_const(e.alloc(n));o.addCode(h.setLocal("ita",h.getLocal("pA")),h.setLocal("itb",h.getLocal("pB")),h.setLocal("itc",h.getLocal("pC")),h.setLocal("itp",h.getLocal("pP")),h.setLocal("last",h.i32_add(h.getLocal("pA"),h.i32_mul(h.getLocal("n"),h.i32_const(n)))),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("ita"),h.getLocal("last"))),h.call(t+"_mul",h.getLocal("ita"),h.getLocal("itb"),g),h.call(t+"_sub",g,h.getLocal("itc"),h.getLocal("itp")),h.setLocal("ita",h.i32_add(h.getLocal("ita"),h.i32_const(n))),h.setLocal("itb",h.i32_add(h.getLocal("itb"),h.i32_const(n))),h.setLocal("itc",h.i32_add(h.getLocal("itc"),h.i32_const(n))),h.setLocal("itp",h.i32_add(h.getLocal("itp"),h.i32_const(n))),h.br(0))))}function v(){const o=e.addFunction(r+"_batchAdd");o.addParam("pa","i32"),o.addParam("pb","i32"),o.addParam("n","i32"),o.addParam("pr","i32"),o.addLocal("ita","i32"),o.addLocal("itb","i32"),o.addLocal("itr","i32"),o.addLocal("last","i32");const h=o.getCodeBuilder();o.addCode(h.setLocal("ita",h.getLocal("pa")),h.setLocal("itb",h.getLocal("pb")),h.setLocal("itr",h.getLocal("pr")),h.setLocal("last",h.i32_add(h.getLocal("pa"),h.i32_mul(h.getLocal("n"),h.i32_const(n)))),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("ita"),h.getLocal("last"))),h.call(t+"_add",h.getLocal("ita"),h.getLocal("itb"),h.getLocal("itr")),h.setLocal("ita",h.i32_add(h.getLocal("ita"),h.i32_const(n))),h.setLocal("itb",h.i32_add(h.getLocal("itb"),h.i32_const(n))),h.setLocal("itr",h.i32_add(h.getLocal("itr"),h.i32_const(n))),h.br(0))))}return c(),u(),v(),e.exportFunction(r+"_buildABC"),e.exportFunction(r+"_joinABC"),e.exportFunction(r+"_batchAdd"),r},kb=function(e,r,t,a,n,c,u,v){const o=e.addFunction(r);o.addParam("pIn","i32"),o.addParam("n","i32"),o.addParam("pFirst","i32"),o.addParam("pInc","i32"),o.addParam("pOut","i32"),o.addLocal("pOldFree","i32"),o.addLocal("i","i32"),o.addLocal("pFrom","i32"),o.addLocal("pTo","i32");const h=o.getCodeBuilder(),g=h.i32_const(e.alloc(u));o.addCode(h.setLocal("pFrom",h.getLocal("pIn")),h.setLocal("pTo",h.getLocal("pOut"))),o.addCode(h.call(a+"_copy",h.getLocal("pFirst"),g)),o.addCode(h.setLocal("i",h.i32_const(0)),h.block(h.loop(h.br_if(1,h.i32_eq(h.getLocal("i"),h.getLocal("n"))),h.call(v,h.getLocal("pFrom"),g,h.getLocal("pTo")),h.setLocal("pFrom",h.i32_add(h.getLocal("pFrom"),h.i32_const(n))),h.setLocal("pTo",h.i32_add(h.getLocal("pTo"),h.i32_const(c))),h.call(a+"_mul",g,h.getLocal("pInc"),g),h.setLocal("i",h.i32_add(h.getLocal("i"),h.i32_const(1))),h.br(0)))),e.exportFunction(r)};const Ue=wa,PC=x1,UC=Ib,Zg=Mb,DC=Bb,jg=Lb,ih=Tb,OC=Rb,FC=Nb,Ys=kb,{bitLength:qC,modInv:zC,isOdd:Wg,isNegative:VC}=yi;var GC=function(e,r){const t=r||"bn128";if(e.modules[t])return t;const a=21888242871839275222246405745257275088696311157297823662689037894645226208583n,n=21888242871839275222246405745257275088548364400416034343698204186575808495617n,c=Math.floor((qC(a-1n)-1)/64)+1,u=c*8,v=u,o=u,h=o*2,g=o*12,y=e.alloc(Ue.bigInt2BytesLE(n,v)),_=PC(e,a,"f1m");UC(e,n,"fr","frm");const A=e.alloc(Ue.bigInt2BytesLE(P(3n),o)),S=jg(e,"g1m","f1m",A);ih(e,"frm","frm","frm","frm_mul"),OC(e,"pol","frm"),FC(e,"qap","frm");const T=Zg(e,"f1m_neg","f2m","f1m"),B=e.alloc([...Ue.bigInt2BytesLE(P(19485874751759354771024239261021720505790618469301721065564631296452457478373n),o),...Ue.bigInt2BytesLE(P(266929791119991161246907387137283842545076965332900288569378510910307636690n),o)]),M=jg(e,"g2m","f2m",B);function R(ut,Y){const tt=e.addFunction(ut);tt.addParam("pG","i32"),tt.addParam("pFr","i32"),tt.addParam("pr","i32");const dt=tt.getCodeBuilder(),mt=dt.i32_const(e.alloc(u));tt.addCode(dt.call("frm_fromMontgomery",dt.getLocal("pFr"),mt),dt.call(Y,dt.getLocal("pG"),mt,dt.i32_const(u),dt.getLocal("pr"))),e.exportFunction(ut)}R("g1m_timesFr","g1m_timesScalar"),ih(e,"g1m","g1m","frm","g1m_timesFr"),R("g2m_timesFr","g2m_timesScalar"),ih(e,"g2m","g2m","frm","g2m_timesFr"),R("g1m_timesFrAffine","g1m_timesScalarAffine"),R("g2m_timesFrAffine","g2m_timesScalarAffine"),Ys(e,"frm_batchApplyKey","fmr","frm",u,u,u,"frm_mul"),Ys(e,"g1m_batchApplyKey","g1m","frm",u*3,u*3,u,"g1m_timesFr"),Ys(e,"g1m_batchApplyKeyMixed","g1m","frm",u*2,u*3,u,"g1m_timesFrAffine"),Ys(e,"g2m_batchApplyKey","g2m","frm",u*2*3,u*3*2,u,"g2m_timesFr"),Ys(e,"g2m_batchApplyKeyMixed","g2m","frm",u*2*2,u*3*2,u,"g2m_timesFrAffine");function P(ut){return BigInt(ut)*(1n<<BigInt(o*8))%a}const D=[1n,2n,1n],q=e.alloc([...Ue.bigInt2BytesLE(P(D[0]),o),...Ue.bigInt2BytesLE(P(D[1]),o),...Ue.bigInt2BytesLE(P(D[2]),o)]),k=[0n,1n,0n],U=e.alloc([...Ue.bigInt2BytesLE(P(k[0]),o),...Ue.bigInt2BytesLE(P(k[1]),o),...Ue.bigInt2BytesLE(P(k[2]),o)]),O=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],G=e.alloc([...Ue.bigInt2BytesLE(P(O[0][0]),o),...Ue.bigInt2BytesLE(P(O[0][1]),o),...Ue.bigInt2BytesLE(P(O[1][0]),o),...Ue.bigInt2BytesLE(P(O[1][1]),o),...Ue.bigInt2BytesLE(P(O[2][0]),o),...Ue.bigInt2BytesLE(P(O[2][1]),o)]),E=[[0n,0n],[1n,0n],[0n,0n]],s=e.alloc([...Ue.bigInt2BytesLE(P(E[0][0]),o),...Ue.bigInt2BytesLE(P(E[0][1]),o),...Ue.bigInt2BytesLE(P(E[1][0]),o),...Ue.bigInt2BytesLE(P(E[1][1]),o),...Ue.bigInt2BytesLE(P(E[2][0]),o),...Ue.bigInt2BytesLE(P(E[2][1]),o)]),l=e.alloc([...Ue.bigInt2BytesLE(P(1),o),...Ue.bigInt2BytesLE(P(0),o),...Ue.bigInt2BytesLE(P(0),o),...Ue.bigInt2BytesLE(P(0),o),...Ue.bigInt2BytesLE(P(0),o),...Ue.bigInt2BytesLE(P(0),o),...Ue.bigInt2BytesLE(P(0),o),...Ue.bigInt2BytesLE(P(0),o),...Ue.bigInt2BytesLE(P(0),o),...Ue.bigInt2BytesLE(P(0),o),...Ue.bigInt2BytesLE(P(0),o),...Ue.bigInt2BytesLE(P(0),o)]),d=e.alloc([...Ue.bigInt2BytesLE(P(9),o),...Ue.bigInt2BytesLE(P(1),o)]),p=e.alloc([...Ue.bigInt2BytesLE(P(zC(2n,a)),o),...Ue.bigInt2BytesLE(0n,o)]),m=d,w=e.alloc([...Ue.bigInt2BytesLE(P(19485874751759354771024239261021720505790618469301721065564631296452457478373n),o),...Ue.bigInt2BytesLE(P(266929791119991161246907387137283842545076965332900288569378510910307636690n),o)]);function x(){const ut=e.addFunction(t+"_mulNR6");ut.addParam("x","i32"),ut.addParam("pr","i32");const Y=ut.getCodeBuilder();ut.addCode(Y.call(T+"_mul",Y.i32_const(d),Y.getLocal("x"),Y.getLocal("pr")))}x();const b=DC(e,t+"_mulNR6","f6m","f2m");function f(){const ut=e.addFunction(t+"_mulNR12");ut.addParam("x","i32"),ut.addParam("pr","i32");const Y=ut.getCodeBuilder();ut.addCode(Y.call(T+"_mul",Y.i32_const(d),Y.i32_add(Y.getLocal("x"),Y.i32_const(u*4)),Y.getLocal("pr")),Y.call(T+"_copy",Y.getLocal("x"),Y.i32_add(Y.getLocal("pr"),Y.i32_const(u*2))),Y.call(T+"_copy",Y.i32_add(Y.getLocal("x"),Y.i32_const(u*2)),Y.i32_add(Y.getLocal("pr"),Y.i32_const(u*4))))}f();const C=Zg(e,t+"_mulNR12","ftm",b),z=Z(29793968203157093288n),W=e.alloc(z),$=3*h,I=z.length-1,N=z.reduce((ut,Y)=>ut+(Y!=0?1:0),0)+I+1,X=3*2*u,Q=3*u*2+N*$;e.modules[t]={n64:c,pG1gen:q,pG1zero:U,pG1b:A,pG2gen:G,pG2zero:s,pG2b:B,pq:e.modules.f1m.pq,pr:y,pOneT:l,prePSize:X,preQSize:Q,r:n.toString(),q:a.toString()};const L=4965661367192848881n;function V(ut){let Y=ut;const tt=[];for(;Y>0n;){if(Wg(Y)){const dt=2-Number(Y%4n);tt.push(dt),Y=Y-BigInt(dt)}else tt.push(0);Y=Y>>1n}return tt}function Z(ut){let Y=ut;const tt=[];for(;Y>0n;)Wg(Y)?tt.push(1):tt.push(0),Y=Y>>1n;return tt}function H(){const ut=e.addFunction(t+"_prepareG1");ut.addParam("pP","i32"),ut.addParam("ppreP","i32");const Y=ut.getCodeBuilder();ut.addCode(Y.call(S+"_normalize",Y.getLocal("pP"),Y.getLocal("ppreP")))}function j(){const ut=e.addFunction(t+"_prepAddStep");ut.addParam("pQ","i32"),ut.addParam("pR","i32"),ut.addParam("pCoef","i32");const Y=ut.getCodeBuilder(),tt=Y.getLocal("pQ"),dt=Y.i32_add(Y.getLocal("pQ"),Y.i32_const(h)),mt=Y.getLocal("pR"),xt=Y.i32_add(Y.getLocal("pR"),Y.i32_const(h)),bt=Y.i32_add(Y.getLocal("pR"),Y.i32_const(2*h)),_t=Y.getLocal("pCoef"),Ht=Y.i32_add(Y.getLocal("pCoef"),Y.i32_const(h)),St=Y.i32_add(Y.getLocal("pCoef"),Y.i32_const(2*h)),Mt=Ht,jt=Y.i32_const(e.alloc(h)),Lt=Y.i32_const(e.alloc(h)),Ft=Y.i32_const(e.alloc(h)),te=Y.i32_const(e.alloc(h)),Bt=Y.i32_const(e.alloc(h)),Ot=Y.i32_const(e.alloc(h)),ie=Y.i32_const(e.alloc(h));ut.addCode(Y.call(T+"_mul",tt,bt,Mt),Y.call(T+"_sub",mt,Mt,Mt),Y.call(T+"_mul",dt,bt,jt),Y.call(T+"_sub",xt,jt,jt),Y.call(T+"_square",Mt,Lt),Y.call(T+"_square",jt,Ft),Y.call(T+"_mul",Mt,Lt,te),Y.call(T+"_mul",mt,Lt,Bt),Y.call(T+"_add",Bt,Bt,ie),Y.call(T+"_mul",bt,Ft,Ot),Y.call(T+"_add",te,Ot,Ot),Y.call(T+"_sub",Ot,ie,Ot),Y.call(T+"_mul",Mt,Ot,mt),Y.call(T+"_mul",te,xt,xt),Y.call(T+"_sub",Bt,Ot,ie),Y.call(T+"_mul",jt,ie,ie),Y.call(T+"_sub",ie,xt,xt),Y.call(T+"_mul",bt,te,bt),Y.call(T+"_mul",Mt,dt,ie),Y.call(T+"_mul",jt,tt,_t),Y.call(T+"_sub",_t,ie,_t),Y.call(T+"_mul",_t,Y.i32_const(m),_t),Y.call(T+"_neg",jt,St))}function et(){const ut=e.addFunction(t+"_prepDblStep");ut.addParam("pR","i32"),ut.addParam("pCoef","i32");const Y=ut.getCodeBuilder(),tt=Y.getLocal("pR"),dt=Y.i32_add(Y.getLocal("pR"),Y.i32_const(h)),mt=Y.i32_add(Y.getLocal("pR"),Y.i32_const(2*h)),xt=Y.getLocal("pCoef"),bt=Y.i32_add(Y.getLocal("pCoef"),Y.i32_const(h)),_t=Y.i32_add(Y.getLocal("pCoef"),Y.i32_const(2*h)),Ht=Y.i32_const(e.alloc(h)),St=Y.i32_const(e.alloc(h)),Mt=Y.i32_const(e.alloc(h)),jt=Y.i32_const(e.alloc(h)),Lt=Y.i32_const(e.alloc(h)),Ft=Y.i32_const(e.alloc(h)),te=Y.i32_const(e.alloc(h)),Bt=Y.i32_const(e.alloc(h)),Ot=Y.i32_const(e.alloc(h)),ie=Y.i32_const(e.alloc(h)),kt=Y.i32_const(e.alloc(h)),qt=Y.i32_const(e.alloc(h));ut.addCode(Y.call(T+"_mul",dt,Y.i32_const(p),Ht),Y.call(T+"_mul",tt,Ht,Ht),Y.call(T+"_square",dt,St),Y.call(T+"_square",mt,Mt),Y.call(T+"_add",Mt,Mt,jt),Y.call(T+"_add",jt,Mt,jt),Y.call(T+"_mul",Y.i32_const(w),jt,Lt),Y.call(T+"_add",Lt,Lt,Ft),Y.call(T+"_add",Lt,Ft,Ft),Y.call(T+"_add",St,Ft,te),Y.call(T+"_mul",te,Y.i32_const(p),te),Y.call(T+"_add",St,Mt,qt),Y.call(T+"_add",dt,mt,Bt),Y.call(T+"_square",Bt,Bt),Y.call(T+"_sub",Bt,qt,Bt),Y.call(T+"_sub",Lt,St,Ot),Y.call(T+"_square",tt,ie),Y.call(T+"_square",Lt,kt),Y.call(T+"_sub",St,Ft,qt),Y.call(T+"_mul",Ht,qt,tt),Y.call(T+"_add",kt,kt,qt),Y.call(T+"_add",kt,qt,qt),Y.call(T+"_square",te,dt),Y.call(T+"_sub",dt,qt,dt),Y.call(T+"_mul",St,Bt,mt),Y.call(T+"_mul",Y.i32_const(m),Ot,xt),Y.call(T+"_neg",Bt,bt),Y.call(T+"_add",ie,ie,_t),Y.call(T+"_add",ie,_t,_t))}function nt(){const ut=e.addFunction(t+"_mulByQ");ut.addParam("p1","i32"),ut.addParam("pr","i32");const Y=ut.getCodeBuilder(),tt=Y.getLocal("p1"),dt=Y.i32_add(Y.getLocal("p1"),Y.i32_const(h)),mt=Y.i32_add(Y.getLocal("p1"),Y.i32_const(h*2)),xt=Y.getLocal("pr"),bt=Y.i32_add(Y.getLocal("pr"),Y.i32_const(h)),_t=Y.i32_add(Y.getLocal("pr"),Y.i32_const(h*2)),Ht=Y.i32_const(e.alloc([...Ue.bigInt2BytesLE(P("21575463638280843010398324269430826099269044274347216827212613867836435027261"),o),...Ue.bigInt2BytesLE(P("10307601595873709700152284273816112264069230130616436755625194854815875713954"),o)])),St=Y.i32_const(e.alloc([...Ue.bigInt2BytesLE(P("2821565182194536844548159561693502659359617185244120367078079554186484126554"),o),...Ue.bigInt2BytesLE(P("3505843767911556378687030309984248845540243509899259641013678093033130930403"),o)]));ut.addCode(Y.call(T+"_conjugate",tt,xt),Y.call(T+"_mul",Ht,xt,xt),Y.call(T+"_conjugate",dt,bt),Y.call(T+"_mul",St,bt,bt),Y.call(T+"_conjugate",mt,_t))}function st(){nt();const ut=e.addFunction(t+"_prepareG2");ut.addParam("pQ","i32"),ut.addParam("ppreQ","i32"),ut.addLocal("pCoef","i32"),ut.addLocal("i","i32");const Y=ut.getCodeBuilder(),tt=Y.getLocal("pQ"),dt=e.alloc(h*3),mt=Y.i32_const(dt),xt=Y.i32_const(dt),bt=Y.i32_const(dt+h),_t=Y.i32_const(dt+2*h),Ht=Y.i32_add(Y.getLocal("ppreQ"),Y.i32_const(0)),St=Y.i32_add(Y.getLocal("ppreQ"),Y.i32_const(h)),Mt=e.alloc(h*3),jt=Y.i32_const(Mt),Lt=e.alloc(h*3),Ft=Y.i32_const(Lt),te=Y.i32_const(Lt+h);ut.addCode(Y.call(M+"_normalize",tt,Ht),Y.call(T+"_copy",Ht,xt),Y.call(T+"_copy",St,bt),Y.call(T+"_one",_t)),ut.addCode(Y.setLocal("pCoef",Y.i32_add(Y.getLocal("ppreQ"),Y.i32_const(h*3))),Y.setLocal("i",Y.i32_const(z.length-2)),Y.block(Y.loop(Y.call(t+"_prepDblStep",mt,Y.getLocal("pCoef")),Y.setLocal("pCoef",Y.i32_add(Y.getLocal("pCoef"),Y.i32_const($))),Y.if(Y.i32_load8_s(Y.getLocal("i"),W),[...Y.call(t+"_prepAddStep",Ht,mt,Y.getLocal("pCoef")),...Y.setLocal("pCoef",Y.i32_add(Y.getLocal("pCoef"),Y.i32_const($)))]),Y.br_if(1,Y.i32_eqz(Y.getLocal("i"))),Y.setLocal("i",Y.i32_sub(Y.getLocal("i"),Y.i32_const(1))),Y.br(0)))),ut.addCode(Y.call(t+"_mulByQ",Ht,jt),Y.call(t+"_mulByQ",jt,Ft)),ut.addCode(Y.call(T+"_neg",te,te),Y.call(t+"_prepAddStep",jt,mt,Y.getLocal("pCoef")),Y.setLocal("pCoef",Y.i32_add(Y.getLocal("pCoef"),Y.i32_const($))),Y.call(t+"_prepAddStep",Ft,mt,Y.getLocal("pCoef")),Y.setLocal("pCoef",Y.i32_add(Y.getLocal("pCoef"),Y.i32_const($))))}function ft(){const ut=e.addFunction(t+"__mulBy024Old");ut.addParam("pEll0","i32"),ut.addParam("pEllVW","i32"),ut.addParam("pEllVV","i32"),ut.addParam("pR","i32");const Y=ut.getCodeBuilder(),tt=Y.getLocal("pEll0"),dt=Y.getLocal("pEllVV"),mt=Y.getLocal("pEllVW"),xt=Y.getLocal("pR"),bt=e.alloc(g),_t=Y.i32_const(bt),Ht=Y.i32_const(bt),St=Y.i32_const(bt+h),Mt=Y.i32_const(bt+h*2),jt=Y.i32_const(bt+h*3),Lt=Y.i32_const(bt+h*4),Ft=Y.i32_const(bt+h*5);ut.addCode(Y.call(T+"_copy",tt,Ht),Y.call(T+"_zero",St),Y.call(T+"_copy",dt,Mt),Y.call(T+"_zero",jt),Y.call(T+"_copy",mt,Lt),Y.call(T+"_zero",Ft),Y.call(C+"_mul",_t,xt,xt))}function vt(){const ut=e.addFunction(t+"__mulBy024");ut.addParam("pEll0","i32"),ut.addParam("pEllVW","i32"),ut.addParam("pEllVV","i32"),ut.addParam("pR","i32");const Y=ut.getCodeBuilder(),tt=Y.getLocal("pEll0"),dt=Y.getLocal("pEllVV"),mt=Y.getLocal("pEllVW"),xt=Y.getLocal("pR"),bt=Y.i32_add(Y.getLocal("pR"),Y.i32_const(2*u)),_t=Y.i32_add(Y.getLocal("pR"),Y.i32_const(4*u)),Ht=Y.i32_add(Y.getLocal("pR"),Y.i32_const(6*u)),St=Y.i32_add(Y.getLocal("pR"),Y.i32_const(8*u)),Mt=Y.i32_add(Y.getLocal("pR"),Y.i32_const(10*u)),jt=Y.i32_const(e.alloc(h)),Lt=Y.i32_const(e.alloc(h)),Ft=Y.i32_const(e.alloc(h)),te=Y.i32_const(e.alloc(h)),Bt=Y.i32_const(e.alloc(h)),Ot=Y.i32_const(e.alloc(h)),ie=Y.i32_const(e.alloc(h)),kt=Y.i32_const(e.alloc(h)),qt=Y.i32_const(e.alloc(h)),ae=Y.i32_const(e.alloc(h)),Rt=Y.i32_const(e.alloc(h));ut.addCode(Y.call(T+"_mul",xt,tt,ie),Y.call(T+"_mul",_t,dt,kt),Y.call(T+"_mul",St,mt,qt),Y.call(T+"_add",xt,St,Ft),Y.call(T+"_add",xt,_t,Lt),Y.call(T+"_add",bt,Ht,te),Y.call(T+"_add",te,Mt,te),Y.call(T+"_mul",bt,dt,ae),Y.call(T+"_add",ae,qt,Bt),Y.call(T+"_mul",Y.i32_const(d),Bt,Ot),Y.call(T+"_add",Ot,ie,xt),Y.call(T+"_mul",Mt,mt,Bt),Y.call(T+"_add",ae,Bt,ae),Y.call(T+"_add",Bt,kt,Bt),Y.call(T+"_mul",Y.i32_const(d),Bt,Ot),Y.call(T+"_mul",bt,tt,Bt),Y.call(T+"_add",ae,Bt,ae),Y.call(T+"_add",Ot,Bt,bt),Y.call(T+"_add",tt,dt,jt),Y.call(T+"_mul",Lt,jt,Bt),Y.call(T+"_add",ie,kt,Rt),Y.call(T+"_sub",Bt,Rt,Bt),Y.call(T+"_mul",Ht,mt,Ot),Y.call(T+"_add",ae,Ot,ae),Y.call(T+"_add",_t,St,jt),Y.call(T+"_add",Bt,Ot,_t),Y.call(T+"_add",dt,mt,Lt),Y.call(T+"_mul",Lt,jt,Bt),Y.call(T+"_add",kt,qt,Rt),Y.call(T+"_sub",Bt,Rt,Bt),Y.call(T+"_mul",Y.i32_const(d),Bt,Ot),Y.call(T+"_mul",Ht,tt,Bt),Y.call(T+"_add",ae,Bt,ae),Y.call(T+"_add",Ot,Bt,Ht),Y.call(T+"_mul",Mt,dt,Bt),Y.call(T+"_add",ae,Bt,ae),Y.call(T+"_mul",Y.i32_const(d),Bt,Ot),Y.call(T+"_add",tt,mt,jt),Y.call(T+"_mul",Ft,jt,Bt),Y.call(T+"_add",ie,qt,Rt),Y.call(T+"_sub",Bt,Rt,Bt),Y.call(T+"_add",Ot,Bt,St),Y.call(T+"_add",tt,dt,jt),Y.call(T+"_add",jt,mt,jt),Y.call(T+"_mul",te,jt,Bt),Y.call(T+"_sub",Bt,ae,Mt))}function ot(){const ut=e.addFunction(t+"_millerLoop");ut.addParam("ppreP","i32"),ut.addParam("ppreQ","i32"),ut.addParam("r","i32"),ut.addLocal("pCoef","i32"),ut.addLocal("i","i32");const Y=ut.getCodeBuilder(),tt=Y.getLocal("ppreP"),dt=Y.i32_add(Y.getLocal("ppreP"),Y.i32_const(o)),mt=Y.getLocal("pCoef"),xt=Y.i32_add(Y.getLocal("pCoef"),Y.i32_const(h)),bt=Y.i32_add(Y.getLocal("pCoef"),Y.i32_const(2*h)),_t=e.alloc(h),Ht=Y.i32_const(_t),St=e.alloc(h),Mt=Y.i32_const(St),jt=Y.getLocal("r");ut.addCode(Y.call(C+"_one",jt),Y.setLocal("pCoef",Y.i32_add(Y.getLocal("ppreQ"),Y.i32_const(h*3))),Y.setLocal("i",Y.i32_const(z.length-2)),Y.block(Y.loop(Y.call(C+"_square",jt,jt),Y.call(T+"_mul1",xt,dt,Ht),Y.call(T+"_mul1",bt,tt,Mt),Y.call(t+"__mulBy024",mt,Ht,Mt,jt),Y.setLocal("pCoef",Y.i32_add(Y.getLocal("pCoef"),Y.i32_const($))),Y.if(Y.i32_load8_s(Y.getLocal("i"),W),[...Y.call(T+"_mul1",xt,dt,Ht),...Y.call(T+"_mul1",bt,tt,Mt),...Y.call(t+"__mulBy024",mt,Ht,Mt,jt),...Y.setLocal("pCoef",Y.i32_add(Y.getLocal("pCoef"),Y.i32_const($)))]),Y.br_if(1,Y.i32_eqz(Y.getLocal("i"))),Y.setLocal("i",Y.i32_sub(Y.getLocal("i"),Y.i32_const(1))),Y.br(0)))),ut.addCode(Y.call(T+"_mul1",xt,dt,Ht),Y.call(T+"_mul1",bt,tt,Mt),Y.call(t+"__mulBy024",mt,Ht,Mt,jt),Y.setLocal("pCoef",Y.i32_add(Y.getLocal("pCoef"),Y.i32_const($))),Y.call(T+"_mul1",xt,dt,Ht),Y.call(T+"_mul1",bt,tt,Mt),Y.call(t+"__mulBy024",mt,Ht,Mt,jt),Y.setLocal("pCoef",Y.i32_add(Y.getLocal("pCoef"),Y.i32_const($))))}function pt(ut){const Y=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],tt=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],dt=e.addFunction(t+"__frobeniusMap"+ut);dt.addParam("x","i32"),dt.addParam("r","i32");const mt=dt.getCodeBuilder();for(let bt=0;bt<6;bt++){const _t=bt==0?mt.getLocal("x"):mt.i32_add(mt.getLocal("x"),mt.i32_const(bt*h)),Ht=_t,St=mt.i32_add(mt.getLocal("x"),mt.i32_const(bt*h+o)),Mt=bt==0?mt.getLocal("r"):mt.i32_add(mt.getLocal("r"),mt.i32_const(bt*h)),jt=Mt,Lt=mt.i32_add(mt.getLocal("r"),mt.i32_const(bt*h+o)),Ft=xt(Y[Math.floor(bt/3)][ut%12],tt[bt%3][ut%6]),te=e.alloc([...Ue.bigInt2BytesLE(P(Ft[0]),32),...Ue.bigInt2BytesLE(P(Ft[1]),32)]);ut%2==1?dt.addCode(mt.call(_+"_copy",Ht,jt),mt.call(_+"_neg",St,Lt),mt.call(T+"_mul",Mt,mt.i32_const(te),Mt)):dt.addCode(mt.call(T+"_mul",_t,mt.i32_const(te),Mt))}function xt(bt,_t){const Ht=BigInt(bt[0]),St=BigInt(bt[1]),Mt=BigInt(_t[0]),jt=BigInt(_t[1]),Lt=[(Ht*Mt-St*jt)%a,(Ht*jt+St*Mt)%a];return VC(Lt[0])&&(Lt[0]=Lt[0]+a),Lt}}function Ut(){const ut=e.addFunction(t+"__finalExponentiationFirstChunk");ut.addParam("x","i32"),ut.addParam("r","i32");const Y=ut.getCodeBuilder(),tt=Y.getLocal("x"),dt=tt,mt=Y.i32_add(tt,Y.i32_const(u*6)),xt=Y.getLocal("r"),bt=e.alloc(g),_t=Y.i32_const(bt),Ht=_t,St=Y.i32_const(bt+u*6),Mt=Y.i32_const(e.alloc(g)),jt=Y.i32_const(e.alloc(g)),Lt=Y.i32_const(e.alloc(g));ut.addCode(Y.call(b+"_copy",dt,Ht),Y.call(b+"_neg",mt,St),Y.call(C+"_inverse",tt,Mt),Y.call(C+"_mul",_t,Mt,jt),Y.call(t+"__frobeniusMap2",jt,Lt),Y.call(C+"_mul",jt,Lt,xt))}function At(){const ut=e.addFunction(t+"__cyclotomicSquare");ut.addParam("x","i32"),ut.addParam("r","i32");const Y=ut.getCodeBuilder(),tt=Y.getLocal("x"),dt=Y.i32_add(Y.getLocal("x"),Y.i32_const(h)),mt=Y.i32_add(Y.getLocal("x"),Y.i32_const(2*h)),xt=Y.i32_add(Y.getLocal("x"),Y.i32_const(3*h)),bt=Y.i32_add(Y.getLocal("x"),Y.i32_const(4*h)),_t=Y.i32_add(Y.getLocal("x"),Y.i32_const(5*h)),Ht=Y.getLocal("r"),St=Y.i32_add(Y.getLocal("r"),Y.i32_const(h)),Mt=Y.i32_add(Y.getLocal("r"),Y.i32_const(2*h)),jt=Y.i32_add(Y.getLocal("r"),Y.i32_const(3*h)),Lt=Y.i32_add(Y.getLocal("r"),Y.i32_const(4*h)),Ft=Y.i32_add(Y.getLocal("r"),Y.i32_const(5*h)),te=Y.i32_const(e.alloc(h)),Bt=Y.i32_const(e.alloc(h)),Ot=Y.i32_const(e.alloc(h)),ie=Y.i32_const(e.alloc(h)),kt=Y.i32_const(e.alloc(h)),qt=Y.i32_const(e.alloc(h)),ae=Y.i32_const(e.alloc(h)),Rt=Y.i32_const(e.alloc(h));ut.addCode(Y.call(T+"_mul",tt,bt,ae),Y.call(T+"_mul",bt,Y.i32_const(d),te),Y.call(T+"_add",tt,te,te),Y.call(T+"_add",tt,bt,Rt),Y.call(T+"_mul",Rt,te,te),Y.call(T+"_mul",Y.i32_const(d),ae,Rt),Y.call(T+"_add",ae,Rt,Rt),Y.call(T+"_sub",te,Rt,te),Y.call(T+"_add",ae,ae,Bt),Y.call(T+"_mul",xt,mt,ae),Y.call(T+"_mul",mt,Y.i32_const(d),Ot),Y.call(T+"_add",xt,Ot,Ot),Y.call(T+"_add",xt,mt,Rt),Y.call(T+"_mul",Rt,Ot,Ot),Y.call(T+"_mul",Y.i32_const(d),ae,Rt),Y.call(T+"_add",ae,Rt,Rt),Y.call(T+"_sub",Ot,Rt,Ot),Y.call(T+"_add",ae,ae,ie),Y.call(T+"_mul",dt,_t,ae),Y.call(T+"_mul",_t,Y.i32_const(d),kt),Y.call(T+"_add",dt,kt,kt),Y.call(T+"_add",dt,_t,Rt),Y.call(T+"_mul",Rt,kt,kt),Y.call(T+"_mul",Y.i32_const(d),ae,Rt),Y.call(T+"_add",ae,Rt,Rt),Y.call(T+"_sub",kt,Rt,kt),Y.call(T+"_add",ae,ae,qt),Y.call(T+"_sub",te,tt,Ht),Y.call(T+"_add",Ht,Ht,Ht),Y.call(T+"_add",te,Ht,Ht),Y.call(T+"_add",Bt,bt,Lt),Y.call(T+"_add",Lt,Lt,Lt),Y.call(T+"_add",Bt,Lt,Lt),Y.call(T+"_mul",qt,Y.i32_const(m),Rt),Y.call(T+"_add",Rt,xt,jt),Y.call(T+"_add",jt,jt,jt),Y.call(T+"_add",Rt,jt,jt),Y.call(T+"_sub",kt,mt,Mt),Y.call(T+"_add",Mt,Mt,Mt),Y.call(T+"_add",kt,Mt,Mt),Y.call(T+"_sub",Ot,dt,St),Y.call(T+"_add",St,St,St),Y.call(T+"_add",Ot,St,St),Y.call(T+"_add",ie,_t,Ft),Y.call(T+"_add",Ft,Ft,Ft),Y.call(T+"_add",ie,Ft,Ft))}function It(ut,Y){const tt=V(ut).map(St=>St==-1?255:St),dt=e.alloc(tt),mt=e.addFunction(t+"__cyclotomicExp_"+Y);mt.addParam("x","i32"),mt.addParam("r","i32"),mt.addLocal("bit","i32"),mt.addLocal("i","i32");const xt=mt.getCodeBuilder(),bt=xt.getLocal("x"),_t=xt.getLocal("r"),Ht=xt.i32_const(e.alloc(g));mt.addCode(xt.call(C+"_conjugate",bt,Ht),xt.call(C+"_one",_t),xt.if(xt.teeLocal("bit",xt.i32_load8_s(xt.i32_const(tt.length-1),dt)),xt.if(xt.i32_eq(xt.getLocal("bit"),xt.i32_const(1)),xt.call(C+"_mul",_t,bt,_t),xt.call(C+"_mul",_t,Ht,_t))),xt.setLocal("i",xt.i32_const(tt.length-2)),xt.block(xt.loop(xt.call(t+"__cyclotomicSquare",_t,_t),xt.if(xt.teeLocal("bit",xt.i32_load8_s(xt.getLocal("i"),dt)),xt.if(xt.i32_eq(xt.getLocal("bit"),xt.i32_const(1)),xt.call(C+"_mul",_t,bt,_t),xt.call(C+"_mul",_t,Ht,_t))),xt.br_if(1,xt.i32_eqz(xt.getLocal("i"))),xt.setLocal("i",xt.i32_sub(xt.getLocal("i"),xt.i32_const(1))),xt.br(0))))}function Jt(){At(),It(L,"w0");const ut=e.addFunction(t+"__finalExponentiationLastChunk");ut.addParam("x","i32"),ut.addParam("r","i32");const Y=ut.getCodeBuilder(),tt=Y.getLocal("x"),dt=Y.getLocal("r"),mt=Y.i32_const(e.alloc(g)),xt=Y.i32_const(e.alloc(g)),bt=Y.i32_const(e.alloc(g)),_t=Y.i32_const(e.alloc(g)),Ht=Y.i32_const(e.alloc(g)),St=Y.i32_const(e.alloc(g)),Mt=Y.i32_const(e.alloc(g)),jt=Y.i32_const(e.alloc(g)),Lt=Y.i32_const(e.alloc(g)),Ft=Y.i32_const(e.alloc(g)),te=Y.i32_const(e.alloc(g)),Bt=Y.i32_const(e.alloc(g)),Ot=Y.i32_const(e.alloc(g)),ie=Y.i32_const(e.alloc(g)),kt=Y.i32_const(e.alloc(g)),qt=Y.i32_const(e.alloc(g)),ae=Y.i32_const(e.alloc(g)),Rt=Y.i32_const(e.alloc(g)),zt=Y.i32_const(e.alloc(g)),he=Y.i32_const(e.alloc(g)),Vt=Y.i32_const(e.alloc(g));ut.addCode(Y.call(t+"__cyclotomicExp_w0",tt,mt),Y.call(C+"_conjugate",mt,mt),Y.call(t+"__cyclotomicSquare",mt,xt),Y.call(t+"__cyclotomicSquare",xt,bt),Y.call(C+"_mul",bt,xt,_t),Y.call(t+"__cyclotomicExp_w0",_t,Ht),Y.call(C+"_conjugate",Ht,Ht),Y.call(t+"__cyclotomicSquare",Ht,St),Y.call(t+"__cyclotomicExp_w0",St,Mt),Y.call(C+"_conjugate",Mt,Mt),Y.call(C+"_conjugate",_t,jt),Y.call(C+"_conjugate",Mt,Lt),Y.call(C+"_mul",Lt,Ht,Ft),Y.call(C+"_mul",Ft,jt,te),Y.call(C+"_mul",te,xt,Bt),Y.call(C+"_mul",te,Ht,Ot),Y.call(C+"_mul",Ot,tt,ie),Y.call(t+"__frobeniusMap1",Bt,kt),Y.call(C+"_mul",kt,ie,qt),Y.call(t+"__frobeniusMap2",te,ae),Y.call(C+"_mul",ae,qt,Rt),Y.call(C+"_conjugate",tt,zt),Y.call(C+"_mul",zt,Bt,he),Y.call(t+"__frobeniusMap3",he,Vt),Y.call(C+"_mul",Vt,Rt,dt))}function at(){Ut(),Jt();const ut=e.addFunction(t+"_finalExponentiation");ut.addParam("x","i32"),ut.addParam("r","i32");const Y=ut.getCodeBuilder(),tt=Y.getLocal("x"),dt=Y.getLocal("r"),mt=Y.i32_const(e.alloc(g));ut.addCode(Y.call(t+"__finalExponentiationFirstChunk",tt,mt),Y.call(t+"__finalExponentiationLastChunk",mt,dt))}function J(){const ut=e.addFunction(t+"_finalExponentiationOld");ut.addParam("x","i32"),ut.addParam("r","i32");const tt=e.alloc(Ue.bigInt2BytesLE(552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,352)),dt=ut.getCodeBuilder();ut.addCode(dt.call(C+"_exp",dt.getLocal("x"),dt.i32_const(tt),dt.i32_const(352),dt.getLocal("r")))}const rt=e.alloc(X),lt=e.alloc(Q);function gt(ut){const Y=e.addFunction(t+"_pairingEq"+ut);for(let xt=0;xt<ut;xt++)Y.addParam("p_"+xt,"i32"),Y.addParam("q_"+xt,"i32");Y.addParam("c","i32"),Y.setReturnType("i32");const tt=Y.getCodeBuilder(),dt=tt.i32_const(e.alloc(g)),mt=tt.i32_const(e.alloc(g));Y.addCode(tt.call(C+"_one",dt));for(let xt=0;xt<ut;xt++)Y.addCode(tt.call(t+"_prepareG1",tt.getLocal("p_"+xt),tt.i32_const(rt))),Y.addCode(tt.call(t+"_prepareG2",tt.getLocal("q_"+xt),tt.i32_const(lt))),Y.addCode(tt.call(t+"_millerLoop",tt.i32_const(rt),tt.i32_const(lt),mt)),Y.addCode(tt.call(C+"_mul",dt,mt,dt));Y.addCode(tt.call(t+"_finalExponentiation",dt,dt)),Y.addCode(tt.call(C+"_eq",dt,tt.getLocal("c")))}function Dt(){const ut=e.addFunction(t+"_pairing");ut.addParam("p","i32"),ut.addParam("q","i32"),ut.addParam("r","i32");const Y=ut.getCodeBuilder(),tt=Y.i32_const(e.alloc(g));ut.addCode(Y.call(t+"_prepareG1",Y.getLocal("p"),Y.i32_const(rt))),ut.addCode(Y.call(t+"_prepareG2",Y.getLocal("q"),Y.i32_const(lt))),ut.addCode(Y.call(t+"_millerLoop",Y.i32_const(rt),Y.i32_const(lt),tt)),ut.addCode(Y.call(t+"_finalExponentiation",tt,Y.getLocal("r")))}j(),et(),H(),st(),vt(),ft(),ot();for(let ut=0;ut<10;ut++)pt(ut),e.exportFunction(t+"__frobeniusMap"+ut);J(),at();for(let ut=1;ut<=5;ut++)gt(ut),e.exportFunction(t+"_pairingEq"+ut);Dt(),e.exportFunction(t+"_pairing"),e.exportFunction(t+"_prepareG1"),e.exportFunction(t+"_prepareG2"),e.exportFunction(t+"_millerLoop"),e.exportFunction(t+"_finalExponentiation"),e.exportFunction(t+"_finalExponentiationOld"),e.exportFunction(t+"__mulBy024"),e.exportFunction(t+"__mulBy024Old"),e.exportFunction(t+"__cyclotomicSquare"),e.exportFunction(t+"__cyclotomicExp_w0")};const ke=wa,KC=x1,HC=Ib,Yg=Mb,QC=Bb,Xg=Lb,nh=Tb,$C=Rb,ZC=Nb,Xs=kb,{bitLength:Jg,isOdd:tm,isNegative:jC}=yi;var WC=function(e,r){const t=r||"bls12381";if(e.modules[t])return t;const a=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,n=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,c=Math.floor((Jg(a-1n)-1)/64)+1,u=c*8,v=u,o=v*2,h=v*12,g=Math.floor((Jg(n-1n)-1)/64)+1,y=g*8,_=y,A=e.alloc(ke.bigInt2BytesLE(n,_)),S=KC(e,a,"f1m","intq");HC(e,n,"fr","frm","intr");const T=e.alloc(ke.bigInt2BytesLE(q(4n),v)),B=Xg(e,"g1m","f1m",T);nh(e,"frm","frm","frm","frm_mul"),$C(e,"pol","frm"),ZC(e,"qap","frm");const M=Yg(e,"f1m_neg","f2m","f1m"),R=e.alloc([...ke.bigInt2BytesLE(q(4n),v),...ke.bigInt2BytesLE(q(4n),v)]),P=Xg(e,"g2m","f2m",R);function D(Y,tt){const dt=e.addFunction(Y);dt.addParam("pG","i32"),dt.addParam("pFr","i32"),dt.addParam("pr","i32");const mt=dt.getCodeBuilder(),xt=mt.i32_const(e.alloc(y));dt.addCode(mt.call("frm_fromMontgomery",mt.getLocal("pFr"),xt),mt.call(tt,mt.getLocal("pG"),xt,mt.i32_const(y),mt.getLocal("pr"))),e.exportFunction(Y)}D("g1m_timesFr","g1m_timesScalar"),nh(e,"g1m","g1m","frm","g1m_timesFr"),D("g2m_timesFr","g2m_timesScalar"),nh(e,"g2m","g2m","frm","g2m_timesFr"),D("g1m_timesFrAffine","g1m_timesScalarAffine"),D("g2m_timesFrAffine","g2m_timesScalarAffine"),Xs(e,"frm_batchApplyKey","fmr","frm",y,y,y,"frm_mul"),Xs(e,"g1m_batchApplyKey","g1m","frm",u*3,u*3,y,"g1m_timesFr"),Xs(e,"g1m_batchApplyKeyMixed","g1m","frm",u*2,u*3,y,"g1m_timesFrAffine"),Xs(e,"g2m_batchApplyKey","g2m","frm",u*2*3,u*3*2,y,"g2m_timesFr"),Xs(e,"g2m_batchApplyKeyMixed","g2m","frm",u*2*2,u*3*2,y,"g2m_timesFrAffine");function q(Y){return BigInt(Y)*(1n<<BigInt(v*8))%a}const k=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],U=e.alloc([...ke.bigInt2BytesLE(q(k[0]),v),...ke.bigInt2BytesLE(q(k[1]),v),...ke.bigInt2BytesLE(q(k[2]),v)]),O=[0n,1n,0n],G=e.alloc([...ke.bigInt2BytesLE(q(O[0]),v),...ke.bigInt2BytesLE(q(O[1]),v),...ke.bigInt2BytesLE(q(O[2]),v)]),E=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],s=e.alloc([...ke.bigInt2BytesLE(q(E[0][0]),v),...ke.bigInt2BytesLE(q(E[0][1]),v),...ke.bigInt2BytesLE(q(E[1][0]),v),...ke.bigInt2BytesLE(q(E[1][1]),v),...ke.bigInt2BytesLE(q(E[2][0]),v),...ke.bigInt2BytesLE(q(E[2][1]),v)]),l=[[0n,0n],[1n,0n],[0n,0n]],d=e.alloc([...ke.bigInt2BytesLE(q(l[0][0]),v),...ke.bigInt2BytesLE(q(l[0][1]),v),...ke.bigInt2BytesLE(q(l[1][0]),v),...ke.bigInt2BytesLE(q(l[1][1]),v),...ke.bigInt2BytesLE(q(l[2][0]),v),...ke.bigInt2BytesLE(q(l[2][1]),v)]),p=e.alloc([...ke.bigInt2BytesLE(q(1n),v),...ke.bigInt2BytesLE(q(0n),v),...ke.bigInt2BytesLE(q(0n),v),...ke.bigInt2BytesLE(q(0n),v),...ke.bigInt2BytesLE(q(0n),v),...ke.bigInt2BytesLE(q(0n),v),...ke.bigInt2BytesLE(q(0n),v),...ke.bigInt2BytesLE(q(0n),v),...ke.bigInt2BytesLE(q(0n),v),...ke.bigInt2BytesLE(q(0n),v),...ke.bigInt2BytesLE(q(0n),v),...ke.bigInt2BytesLE(q(0n),v)]),m=e.alloc([...ke.bigInt2BytesLE(q(1n),v),...ke.bigInt2BytesLE(q(1n),v)]);function w(){const Y=e.addFunction(M+"_mulNR");Y.addParam("x","i32"),Y.addParam("pr","i32");const tt=Y.getCodeBuilder(),dt=tt.i32_const(e.alloc(v)),mt=tt.getLocal("x"),xt=tt.i32_add(tt.getLocal("x"),tt.i32_const(v)),bt=tt.getLocal("pr"),_t=tt.i32_add(tt.getLocal("pr"),tt.i32_const(v));Y.addCode(tt.call(S+"_copy",mt,dt),tt.call(S+"_sub",mt,xt,bt),tt.call(S+"_add",dt,xt,_t))}w();const x=QC(e,M+"_mulNR","f6m","f2m");function b(){const Y=e.addFunction(x+"_mulNR");Y.addParam("x","i32"),Y.addParam("pr","i32");const tt=Y.getCodeBuilder(),dt=tt.i32_const(e.alloc(v*2));Y.addCode(tt.call(M+"_copy",tt.getLocal("x"),dt),tt.call(M+"_mulNR",tt.i32_add(tt.getLocal("x"),tt.i32_const(u*4)),tt.getLocal("pr")),tt.call(M+"_copy",tt.i32_add(tt.getLocal("x"),tt.i32_const(u*2)),tt.i32_add(tt.getLocal("pr"),tt.i32_const(u*4))),tt.call(M+"_copy",dt,tt.i32_add(tt.getLocal("pr"),tt.i32_const(u*2))))}b();const f=Yg(e,x+"_mulNR","ftm",x),F=Z(0xd201000000010000n),z=e.alloc(F),W=3*o,$=F.length-1,K=F.reduce((Y,tt)=>Y+(tt!=0?1:0),0)+$+1,N=3*2*u,X=3*u*2+K*W,Q=!0,L=15132376222941642752n;e.modules[t]={n64q:c,n64r:g,n8q:u,n8r:y,pG1gen:U,pG1zero:G,pG1b:T,pG2gen:s,pG2zero:d,pG2b:R,pq:e.modules.f1m.pq,pr:A,pOneT:p,r:n,q:a,prePSize:N,preQSize:X};function V(Y){let tt=Y;const dt=[];for(;tt>0n;){if(tm(tt)){const mt=2-Number(tt%4n);dt.push(mt),tt=tt-BigInt(mt)}else dt.push(0);tt=tt>>1n}return dt}function Z(Y){let tt=Y;const dt=[];for(;tt>0n;)tm(tt)?dt.push(1):dt.push(0),tt=tt>>1n;return dt}function H(){const Y=e.addFunction(t+"_prepareG1");Y.addParam("pP","i32"),Y.addParam("ppreP","i32");const tt=Y.getCodeBuilder();Y.addCode(tt.call(B+"_normalize",tt.getLocal("pP"),tt.getLocal("ppreP")))}function j(){const Y=e.addFunction(t+"_prepDblStep");Y.addParam("R","i32"),Y.addParam("r","i32");const tt=Y.getCodeBuilder(),dt=tt.getLocal("R"),mt=tt.i32_add(tt.getLocal("R"),tt.i32_const(2*u)),xt=tt.i32_add(tt.getLocal("R"),tt.i32_const(4*u)),bt=tt.getLocal("r"),_t=tt.i32_add(tt.getLocal("r"),tt.i32_const(2*u)),Ht=tt.i32_add(tt.getLocal("r"),tt.i32_const(4*u)),St=tt.i32_const(e.alloc(o)),Mt=tt.i32_const(e.alloc(o)),jt=tt.i32_const(e.alloc(o)),Lt=tt.i32_const(e.alloc(o)),Ft=tt.i32_const(e.alloc(o));Y.addCode(tt.call(M+"_square",dt,bt),tt.call(M+"_square",mt,Mt),tt.call(M+"_square",Mt,jt),tt.call(M+"_add",Mt,dt,_t),tt.call(M+"_square",_t,_t),tt.call(M+"_sub",_t,bt,_t),tt.call(M+"_sub",_t,jt,_t),tt.call(M+"_add",_t,_t,_t),tt.call(M+"_add",bt,bt,Lt),tt.call(M+"_add",Lt,bt,Lt),tt.call(M+"_add",dt,Lt,Ht),tt.call(M+"_square",Lt,Ft),tt.call(M+"_square",xt,St),tt.call(M+"_sub",Ft,_t,dt),tt.call(M+"_sub",dt,_t,dt),tt.call(M+"_add",xt,mt,xt),tt.call(M+"_square",xt,xt),tt.call(M+"_sub",xt,Mt,xt),tt.call(M+"_sub",xt,St,xt),tt.call(M+"_sub",_t,dt,mt),tt.call(M+"_mul",mt,Lt,mt),tt.call(M+"_add",jt,jt,jt),tt.call(M+"_add",jt,jt,jt),tt.call(M+"_add",jt,jt,jt),tt.call(M+"_sub",mt,jt,mt),tt.call(M+"_mul",Lt,St,_t),tt.call(M+"_add",_t,_t,_t),tt.call(M+"_neg",_t,_t),tt.call(M+"_square",Ht,Ht),tt.call(M+"_sub",Ht,bt,Ht),tt.call(M+"_sub",Ht,Ft,Ht),tt.call(M+"_add",Mt,Mt,Mt),tt.call(M+"_add",Mt,Mt,Mt),tt.call(M+"_sub",Ht,Mt,Ht),tt.call(M+"_mul",xt,St,bt),tt.call(M+"_add",bt,bt,bt))}function et(){const Y=e.addFunction(t+"_prepAddStep");Y.addParam("R","i32"),Y.addParam("Q","i32"),Y.addParam("r","i32");const tt=Y.getCodeBuilder(),dt=tt.getLocal("R"),mt=tt.i32_add(tt.getLocal("R"),tt.i32_const(2*u)),xt=tt.i32_add(tt.getLocal("R"),tt.i32_const(4*u)),bt=tt.getLocal("Q"),_t=tt.i32_add(tt.getLocal("Q"),tt.i32_const(2*u)),Ht=tt.getLocal("r"),St=tt.i32_add(tt.getLocal("r"),tt.i32_const(2*u)),Mt=tt.i32_add(tt.getLocal("r"),tt.i32_const(4*u)),jt=tt.i32_const(e.alloc(o)),Lt=tt.i32_const(e.alloc(o)),Ft=tt.i32_const(e.alloc(o)),te=tt.i32_const(e.alloc(o)),Bt=tt.i32_const(e.alloc(o)),Ot=tt.i32_const(e.alloc(o)),ie=tt.i32_const(e.alloc(o)),kt=tt.i32_const(e.alloc(o)),qt=tt.i32_const(e.alloc(o)),ae=tt.i32_const(e.alloc(o)),Rt=tt.i32_const(e.alloc(o));Y.addCode(tt.call(M+"_square",xt,jt),tt.call(M+"_square",_t,Lt),tt.call(M+"_mul",jt,bt,te),tt.call(M+"_add",_t,xt,St),tt.call(M+"_square",St,St),tt.call(M+"_sub",St,Lt,St),tt.call(M+"_sub",St,jt,St),tt.call(M+"_mul",St,jt,St),tt.call(M+"_sub",te,dt,Bt),tt.call(M+"_square",Bt,Ot),tt.call(M+"_add",Ot,Ot,ie),tt.call(M+"_add",ie,ie,ie),tt.call(M+"_mul",ie,Bt,kt),tt.call(M+"_sub",St,mt,qt),tt.call(M+"_sub",qt,mt,qt),tt.call(M+"_mul",qt,bt,Mt),tt.call(M+"_mul",ie,dt,ae),tt.call(M+"_square",qt,dt),tt.call(M+"_sub",dt,kt,dt),tt.call(M+"_sub",dt,ae,dt),tt.call(M+"_sub",dt,ae,dt),tt.call(M+"_add",xt,Bt,xt),tt.call(M+"_square",xt,xt),tt.call(M+"_sub",xt,jt,xt),tt.call(M+"_sub",xt,Ot,xt),tt.call(M+"_add",_t,xt,Ht),tt.call(M+"_sub",ae,dt,Rt),tt.call(M+"_mul",Rt,qt,Rt),tt.call(M+"_mul",mt,kt,te),tt.call(M+"_add",te,te,te),tt.call(M+"_sub",Rt,te,mt),tt.call(M+"_square",Ht,Ht),tt.call(M+"_sub",Ht,Lt,Ht),tt.call(M+"_square",xt,Ft),tt.call(M+"_sub",Ht,Ft,Ht),tt.call(M+"_add",Mt,Mt,Mt),tt.call(M+"_sub",Mt,Ht,Mt),tt.call(M+"_add",xt,xt,Ht),tt.call(M+"_neg",qt,qt),tt.call(M+"_add",qt,qt,St))}function nt(){const Y=e.addFunction(t+"_prepareG2");Y.addParam("pQ","i32"),Y.addParam("ppreQ","i32"),Y.addLocal("pCoef","i32"),Y.addLocal("i","i32");const tt=Y.getCodeBuilder(),dt=tt.getLocal("pQ"),mt=e.alloc(o*3),xt=tt.i32_const(mt),bt=tt.getLocal("ppreQ");Y.addCode(tt.call(P+"_normalize",dt,bt),tt.if(tt.call(P+"_isZero",bt),tt.ret([])),tt.call(P+"_copy",bt,xt),tt.setLocal("pCoef",tt.i32_add(tt.getLocal("ppreQ"),tt.i32_const(o*3)))),Y.addCode(tt.setLocal("i",tt.i32_const(F.length-2)),tt.block(tt.loop(tt.call(t+"_prepDblStep",xt,tt.getLocal("pCoef")),tt.setLocal("pCoef",tt.i32_add(tt.getLocal("pCoef"),tt.i32_const(W))),tt.if(tt.i32_load8_s(tt.getLocal("i"),z),[...tt.call(t+"_prepAddStep",xt,bt,tt.getLocal("pCoef")),...tt.setLocal("pCoef",tt.i32_add(tt.getLocal("pCoef"),tt.i32_const(W)))]),tt.br_if(1,tt.i32_eqz(tt.getLocal("i"))),tt.setLocal("i",tt.i32_sub(tt.getLocal("i"),tt.i32_const(1))),tt.br(0))))}function st(){const Y=e.addFunction(x+"_mul1");Y.addParam("pA","i32"),Y.addParam("pC1","i32"),Y.addParam("pR","i32");const tt=Y.getCodeBuilder(),dt=tt.getLocal("pA"),mt=tt.i32_add(tt.getLocal("pA"),tt.i32_const(v*2)),xt=tt.i32_add(tt.getLocal("pA"),tt.i32_const(v*4)),bt=tt.getLocal("pC1"),_t=tt.getLocal("pR"),Ht=tt.i32_add(tt.getLocal("pR"),tt.i32_const(v*2)),St=tt.i32_add(tt.getLocal("pR"),tt.i32_const(v*4)),Mt=tt.i32_const(e.alloc(v*2)),jt=tt.i32_const(e.alloc(v*2));Y.addCode(tt.call(M+"_add",dt,mt,Mt),tt.call(M+"_add",mt,xt,jt),tt.call(M+"_mul",mt,bt,St),tt.call(M+"_mul",jt,bt,_t),tt.call(M+"_sub",_t,St,_t),tt.call(M+"_mulNR",_t,_t),tt.call(M+"_mul",Mt,bt,Ht),tt.call(M+"_sub",Ht,St,Ht))}st();function ft(){const Y=e.addFunction(x+"_mul01");Y.addParam("pA","i32"),Y.addParam("pC0","i32"),Y.addParam("pC1","i32"),Y.addParam("pR","i32");const tt=Y.getCodeBuilder(),dt=tt.getLocal("pA"),mt=tt.i32_add(tt.getLocal("pA"),tt.i32_const(v*2)),xt=tt.i32_add(tt.getLocal("pA"),tt.i32_const(v*4)),bt=tt.getLocal("pC0"),_t=tt.getLocal("pC1"),Ht=tt.getLocal("pR"),St=tt.i32_add(tt.getLocal("pR"),tt.i32_const(v*2)),Mt=tt.i32_add(tt.getLocal("pR"),tt.i32_const(v*4)),jt=tt.i32_const(e.alloc(v*2)),Lt=tt.i32_const(e.alloc(v*2)),Ft=tt.i32_const(e.alloc(v*2)),te=tt.i32_const(e.alloc(v*2));Y.addCode(tt.call(M+"_mul",dt,bt,jt),tt.call(M+"_mul",mt,_t,Lt),tt.call(M+"_add",dt,mt,Ft),tt.call(M+"_add",dt,xt,te),tt.call(M+"_add",mt,xt,Ht),tt.call(M+"_mul",Ht,_t,Ht),tt.call(M+"_sub",Ht,Lt,Ht),tt.call(M+"_mulNR",Ht,Ht),tt.call(M+"_add",Ht,jt,Ht),tt.call(M+"_add",bt,_t,St),tt.call(M+"_mul",St,Ft,St),tt.call(M+"_sub",St,jt,St),tt.call(M+"_sub",St,Lt,St),tt.call(M+"_mul",te,bt,Mt),tt.call(M+"_sub",Mt,jt,Mt),tt.call(M+"_add",Mt,Lt,Mt))}ft();function vt(){const Y=e.addFunction(f+"_mul014");Y.addParam("pA","i32"),Y.addParam("pC0","i32"),Y.addParam("pC1","i32"),Y.addParam("pC4","i32"),Y.addParam("pR","i32");const tt=Y.getCodeBuilder(),dt=tt.getLocal("pA"),mt=tt.i32_add(tt.getLocal("pA"),tt.i32_const(v*6)),xt=tt.getLocal("pC0"),bt=tt.getLocal("pC1"),_t=tt.getLocal("pC4"),Ht=tt.i32_const(e.alloc(v*6)),St=tt.i32_const(e.alloc(v*6)),Mt=tt.i32_const(e.alloc(v*2)),jt=tt.getLocal("pR"),Lt=tt.i32_add(tt.getLocal("pR"),tt.i32_const(v*6));Y.addCode(tt.call(x+"_mul01",dt,xt,bt,Ht),tt.call(x+"_mul1",mt,_t,St),tt.call(M+"_add",bt,_t,Mt),tt.call(x+"_add",mt,dt,Lt),tt.call(x+"_mul01",Lt,xt,Mt,Lt),tt.call(x+"_sub",Lt,Ht,Lt),tt.call(x+"_sub",Lt,St,Lt),tt.call(x+"_copy",St,jt),tt.call(x+"_mulNR",jt,jt),tt.call(x+"_add",jt,Ht,jt))}vt();function ot(){const Y=e.addFunction(t+"_ell");Y.addParam("pP","i32"),Y.addParam("pCoefs","i32"),Y.addParam("pF","i32");const tt=Y.getCodeBuilder(),dt=tt.getLocal("pP"),mt=tt.i32_add(tt.getLocal("pP"),tt.i32_const(u)),xt=tt.getLocal("pF"),bt=tt.getLocal("pCoefs"),_t=tt.i32_add(tt.getLocal("pCoefs"),tt.i32_const(v)),Ht=tt.i32_add(tt.getLocal("pCoefs"),tt.i32_const(v*2)),St=tt.i32_add(tt.getLocal("pCoefs"),tt.i32_const(v*3)),Mt=tt.i32_add(tt.getLocal("pCoefs"),tt.i32_const(v*4)),jt=e.alloc(v*2),Lt=tt.i32_const(jt),Ft=tt.i32_const(jt),te=tt.i32_const(jt+v),Bt=e.alloc(v*2),Ot=tt.i32_const(Bt),ie=tt.i32_const(Bt),kt=tt.i32_const(Bt+v);Y.addCode(tt.call(S+"_mul",bt,mt,Ft),tt.call(S+"_mul",_t,mt,te),tt.call(S+"_mul",Ht,dt,ie),tt.call(S+"_mul",St,dt,kt),tt.call(f+"_mul014",xt,Mt,Ot,Lt,xt))}ot();function pt(){const Y=e.addFunction(t+"_millerLoop");Y.addParam("ppreP","i32"),Y.addParam("ppreQ","i32"),Y.addParam("r","i32"),Y.addLocal("pCoef","i32"),Y.addLocal("i","i32");const tt=Y.getCodeBuilder(),dt=tt.getLocal("ppreP"),mt=tt.getLocal("pCoef"),xt=tt.getLocal("r");Y.addCode(tt.call(f+"_one",xt),tt.if(tt.call(B+"_isZero",dt),tt.ret([])),tt.if(tt.call(B+"_isZero",tt.getLocal("ppreQ")),tt.ret([])),tt.setLocal("pCoef",tt.i32_add(tt.getLocal("ppreQ"),tt.i32_const(o*3))),tt.setLocal("i",tt.i32_const(F.length-2)),tt.block(tt.loop(tt.call(t+"_ell",dt,mt,xt),tt.setLocal("pCoef",tt.i32_add(tt.getLocal("pCoef"),tt.i32_const(W))),tt.if(tt.i32_load8_s(tt.getLocal("i"),z),[...tt.call(t+"_ell",dt,mt,xt),...tt.setLocal("pCoef",tt.i32_add(tt.getLocal("pCoef"),tt.i32_const(W)))]),tt.call(f+"_square",xt,xt),tt.br_if(1,tt.i32_eq(tt.getLocal("i"),tt.i32_const(1))),tt.setLocal("i",tt.i32_sub(tt.getLocal("i"),tt.i32_const(1))),tt.br(0))),tt.call(t+"_ell",dt,mt,xt)),Y.addCode(tt.call(f+"_conjugate",xt,xt))}function Ut(Y){const tt=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],dt=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],mt=e.addFunction(f+"_frobeniusMap"+Y);mt.addParam("x","i32"),mt.addParam("r","i32");const xt=mt.getCodeBuilder();for(let _t=0;_t<6;_t++){const Ht=_t==0?xt.getLocal("x"):xt.i32_add(xt.getLocal("x"),xt.i32_const(_t*o)),St=Ht,Mt=xt.i32_add(xt.getLocal("x"),xt.i32_const(_t*o+v)),jt=_t==0?xt.getLocal("r"):xt.i32_add(xt.getLocal("r"),xt.i32_const(_t*o)),Lt=jt,Ft=xt.i32_add(xt.getLocal("r"),xt.i32_const(_t*o+v)),te=bt(tt[Math.floor(_t/3)][Y%12],dt[_t%3][Y%6]),Bt=e.alloc([...ke.bigInt2BytesLE(q(te[0]),u),...ke.bigInt2BytesLE(q(te[1]),u)]);Y%2==1?mt.addCode(xt.call(S+"_copy",St,Lt),xt.call(S+"_neg",Mt,Ft),xt.call(M+"_mul",jt,xt.i32_const(Bt),jt)):mt.addCode(xt.call(M+"_mul",Ht,xt.i32_const(Bt),jt))}function bt(_t,Ht){const St=_t[0],Mt=_t[1],jt=Ht[0],Lt=Ht[1],Ft=[(St*jt-Mt*Lt)%a,(St*Lt+Mt*jt)%a];return jC(Ft[0])&&(Ft[0]=Ft[0]+a),Ft}}function At(){const Y=e.addFunction(t+"__cyclotomicSquare");Y.addParam("x","i32"),Y.addParam("r","i32");const tt=Y.getCodeBuilder(),dt=tt.getLocal("x"),mt=tt.i32_add(tt.getLocal("x"),tt.i32_const(o)),xt=tt.i32_add(tt.getLocal("x"),tt.i32_const(2*o)),bt=tt.i32_add(tt.getLocal("x"),tt.i32_const(3*o)),_t=tt.i32_add(tt.getLocal("x"),tt.i32_const(4*o)),Ht=tt.i32_add(tt.getLocal("x"),tt.i32_const(5*o)),St=tt.getLocal("r"),Mt=tt.i32_add(tt.getLocal("r"),tt.i32_const(o)),jt=tt.i32_add(tt.getLocal("r"),tt.i32_const(2*o)),Lt=tt.i32_add(tt.getLocal("r"),tt.i32_const(3*o)),Ft=tt.i32_add(tt.getLocal("r"),tt.i32_const(4*o)),te=tt.i32_add(tt.getLocal("r"),tt.i32_const(5*o)),Bt=tt.i32_const(e.alloc(o)),Ot=tt.i32_const(e.alloc(o)),ie=tt.i32_const(e.alloc(o)),kt=tt.i32_const(e.alloc(o)),qt=tt.i32_const(e.alloc(o)),ae=tt.i32_const(e.alloc(o)),Rt=tt.i32_const(e.alloc(o)),zt=tt.i32_const(e.alloc(o));Y.addCode(tt.call(M+"_mul",dt,_t,Rt),tt.call(M+"_mulNR",_t,Bt),tt.call(M+"_add",dt,Bt,Bt),tt.call(M+"_add",dt,_t,zt),tt.call(M+"_mul",zt,Bt,Bt),tt.call(M+"_mulNR",Rt,zt),tt.call(M+"_add",Rt,zt,zt),tt.call(M+"_sub",Bt,zt,Bt),tt.call(M+"_add",Rt,Rt,Ot),tt.call(M+"_mul",bt,xt,Rt),tt.call(M+"_mulNR",xt,ie),tt.call(M+"_add",bt,ie,ie),tt.call(M+"_add",bt,xt,zt),tt.call(M+"_mul",zt,ie,ie),tt.call(M+"_mulNR",Rt,zt),tt.call(M+"_add",Rt,zt,zt),tt.call(M+"_sub",ie,zt,ie),tt.call(M+"_add",Rt,Rt,kt),tt.call(M+"_mul",mt,Ht,Rt),tt.call(M+"_mulNR",Ht,qt),tt.call(M+"_add",mt,qt,qt),tt.call(M+"_add",mt,Ht,zt),tt.call(M+"_mul",zt,qt,qt),tt.call(M+"_mulNR",Rt,zt),tt.call(M+"_add",Rt,zt,zt),tt.call(M+"_sub",qt,zt,qt),tt.call(M+"_add",Rt,Rt,ae),tt.call(M+"_sub",Bt,dt,St),tt.call(M+"_add",St,St,St),tt.call(M+"_add",Bt,St,St),tt.call(M+"_add",Ot,_t,Ft),tt.call(M+"_add",Ft,Ft,Ft),tt.call(M+"_add",Ot,Ft,Ft),tt.call(M+"_mul",ae,tt.i32_const(m),zt),tt.call(M+"_add",zt,bt,Lt),tt.call(M+"_add",Lt,Lt,Lt),tt.call(M+"_add",zt,Lt,Lt),tt.call(M+"_sub",qt,xt,jt),tt.call(M+"_add",jt,jt,jt),tt.call(M+"_add",qt,jt,jt),tt.call(M+"_sub",ie,mt,Mt),tt.call(M+"_add",Mt,Mt,Mt),tt.call(M+"_add",ie,Mt,Mt),tt.call(M+"_add",kt,Ht,te),tt.call(M+"_add",te,te,te),tt.call(M+"_add",kt,te,te))}function It(Y,tt,dt){const mt=V(Y).map(jt=>jt==-1?255:jt),xt=e.alloc(mt),bt=e.addFunction(t+"__cyclotomicExp_"+dt);bt.addParam("x","i32"),bt.addParam("r","i32"),bt.addLocal("bit","i32"),bt.addLocal("i","i32");const _t=bt.getCodeBuilder(),Ht=_t.getLocal("x"),St=_t.getLocal("r"),Mt=_t.i32_const(e.alloc(h));bt.addCode(_t.call(f+"_conjugate",Ht,Mt),_t.call(f+"_one",St),_t.if(_t.teeLocal("bit",_t.i32_load8_s(_t.i32_const(mt.length-1),xt)),_t.if(_t.i32_eq(_t.getLocal("bit"),_t.i32_const(1)),_t.call(f+"_mul",St,Ht,St),_t.call(f+"_mul",St,Mt,St))),_t.setLocal("i",_t.i32_const(mt.length-2)),_t.block(_t.loop(_t.call(t+"__cyclotomicSquare",St,St),_t.if(_t.teeLocal("bit",_t.i32_load8_s(_t.getLocal("i"),xt)),_t.if(_t.i32_eq(_t.getLocal("bit"),_t.i32_const(1)),_t.call(f+"_mul",St,Ht,St),_t.call(f+"_mul",St,Mt,St))),_t.br_if(1,_t.i32_eqz(_t.getLocal("i"))),_t.setLocal("i",_t.i32_sub(_t.getLocal("i"),_t.i32_const(1))),_t.br(0)))),bt.addCode(_t.call(f+"_conjugate",St,St))}function Jt(){At(),It(L,Q,"w0");const Y=e.addFunction(t+"_finalExponentiation");Y.addParam("x","i32"),Y.addParam("r","i32");const tt=Y.getCodeBuilder(),dt=tt.getLocal("x"),mt=tt.getLocal("r"),xt=tt.i32_const(e.alloc(h)),bt=tt.i32_const(e.alloc(h)),_t=tt.i32_const(e.alloc(h)),Ht=tt.i32_const(e.alloc(h)),St=tt.i32_const(e.alloc(h)),Mt=tt.i32_const(e.alloc(h)),jt=tt.i32_const(e.alloc(h));Y.addCode(tt.call(f+"_frobeniusMap6",dt,xt),tt.call(f+"_inverse",dt,bt),tt.call(f+"_mul",xt,bt,_t),tt.call(f+"_copy",_t,bt),tt.call(f+"_frobeniusMap2",_t,_t),tt.call(f+"_mul",_t,bt,_t),tt.call(t+"__cyclotomicSquare",_t,bt),tt.call(f+"_conjugate",bt,bt),tt.call(t+"__cyclotomicExp_w0",_t,Ht),tt.call(t+"__cyclotomicSquare",Ht,St),tt.call(f+"_mul",bt,Ht,Mt),tt.call(t+"__cyclotomicExp_w0",Mt,bt),tt.call(t+"__cyclotomicExp_w0",bt,xt),tt.call(t+"__cyclotomicExp_w0",xt,jt),tt.call(f+"_mul",jt,St,jt),tt.call(t+"__cyclotomicExp_w0",jt,St),tt.call(f+"_conjugate",Mt,Mt),tt.call(f+"_mul",St,Mt,St),tt.call(f+"_mul",St,_t,St),tt.call(f+"_conjugate",_t,Mt),tt.call(f+"_mul",bt,_t,bt),tt.call(f+"_frobeniusMap3",bt,bt),tt.call(f+"_mul",jt,Mt,jt),tt.call(f+"_frobeniusMap1",jt,jt),tt.call(f+"_mul",Ht,xt,Ht),tt.call(f+"_frobeniusMap2",Ht,Ht),tt.call(f+"_mul",Ht,bt,Ht),tt.call(f+"_mul",Ht,jt,Ht),tt.call(f+"_mul",Ht,St,mt))}function at(){const Y=e.addFunction(t+"_finalExponentiationOld");Y.addParam("x","i32"),Y.addParam("r","i32");const dt=e.alloc(ke.bigInt2BytesLE(322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,544)),mt=Y.getCodeBuilder();Y.addCode(mt.call(f+"_exp",mt.getLocal("x"),mt.i32_const(dt),mt.i32_const(544),mt.getLocal("r")))}const J=e.alloc(N),rt=e.alloc(X);function lt(Y){const tt=e.addFunction(t+"_pairingEq"+Y);for(let bt=0;bt<Y;bt++)tt.addParam("p_"+bt,"i32"),tt.addParam("q_"+bt,"i32");tt.addParam("c","i32"),tt.setReturnType("i32");const dt=tt.getCodeBuilder(),mt=dt.i32_const(e.alloc(h)),xt=dt.i32_const(e.alloc(h));tt.addCode(dt.call(f+"_one",mt));for(let bt=0;bt<Y;bt++)tt.addCode(dt.call(t+"_prepareG1",dt.getLocal("p_"+bt),dt.i32_const(J))),tt.addCode(dt.call(t+"_prepareG2",dt.getLocal("q_"+bt),dt.i32_const(rt))),tt.addCode(dt.if(dt.i32_eqz(dt.call(B+"_inGroupAffine",dt.i32_const(J))),dt.ret(dt.i32_const(0))),dt.if(dt.i32_eqz(dt.call(P+"_inGroupAffine",dt.i32_const(rt))),dt.ret(dt.i32_const(0)))),tt.addCode(dt.call(t+"_millerLoop",dt.i32_const(J),dt.i32_const(rt),xt)),tt.addCode(dt.call(f+"_mul",mt,xt,mt));tt.addCode(dt.call(t+"_finalExponentiation",mt,mt)),tt.addCode(dt.call(f+"_eq",mt,dt.getLocal("c")))}function gt(){const Y=e.addFunction(t+"_pairing");Y.addParam("p","i32"),Y.addParam("q","i32"),Y.addParam("r","i32");const tt=Y.getCodeBuilder(),dt=tt.i32_const(e.alloc(h));Y.addCode(tt.call(t+"_prepareG1",tt.getLocal("p"),tt.i32_const(J))),Y.addCode(tt.call(t+"_prepareG2",tt.getLocal("q"),tt.i32_const(rt))),Y.addCode(tt.call(t+"_millerLoop",tt.i32_const(J),tt.i32_const(rt),dt)),Y.addCode(tt.call(t+"_finalExponentiation",dt,tt.getLocal("r")))}function Dt(){const Y=e.addFunction(P+"_inGroupAffine");Y.addParam("p","i32"),Y.setReturnType("i32");const tt=Y.getCodeBuilder(),dt=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],mt=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,xt=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],bt=tt.i32_const(e.alloc([...ke.bigInt2BytesLE(q(dt[0]),u),...ke.bigInt2BytesLE(q(dt[1]),u)])),_t=tt.i32_const(e.alloc(ke.bigInt2BytesLE(q(mt),u))),Ht=tt.i32_const(e.alloc([...ke.bigInt2BytesLE(q(xt[0]),u),...ke.bigInt2BytesLE(q(xt[1]),u)])),St=tt.i32_const(e.alloc(ke.bigInt2BytesLE(L,8))),Mt=tt.getLocal("p"),jt=tt.i32_add(tt.getLocal("p"),tt.i32_const(o)),Lt=tt.i32_const(e.alloc(v)),Ft=tt.i32_const(e.alloc(o)),te=tt.i32_const(e.alloc(o)),Bt=e.alloc(o*2),Ot=tt.i32_const(Bt),ie=tt.i32_const(Bt),kt=tt.i32_const(Bt),qt=tt.i32_const(Bt+v),ae=tt.i32_const(Bt+o),Rt=tt.i32_const(Bt+o),zt=tt.i32_const(Bt+o+v),he=e.alloc(o*3),Vt=tt.i32_const(he),Qt=tt.i32_const(he),ge=tt.i32_const(he),Gt=tt.i32_const(he+v),$t=tt.i32_const(he+o),pe=tt.i32_const(he+o),de=tt.i32_const(he+o+v),Ee=tt.i32_const(he+o*2);Y.addCode(tt.if(tt.call(P+"_isZeroAffine",tt.getLocal("p")),tt.ret(tt.i32_const(1))),tt.if(tt.i32_eqz(tt.call(P+"_inCurveAffine",tt.getLocal("p"))),tt.ret(tt.i32_const(0))),tt.call(M+"_mul",Mt,bt,Ft),tt.call(M+"_mul",jt,bt,te),tt.call(M+"_mul1",Ft,_t,ie),tt.call(M+"_neg",te,ae),tt.call(M+"_neg",Ft,Qt),tt.call(M+"_mul",te,Ht,$t),tt.call(S+"_sub",kt,qt,Lt),tt.call(S+"_add",kt,qt,qt),tt.call(S+"_copy",Lt,kt),tt.call(S+"_sub",Rt,zt,Lt),tt.call(S+"_add",Rt,zt,zt),tt.call(S+"_copy",Lt,Rt),tt.call(S+"_add",ge,Gt,Lt),tt.call(S+"_sub",ge,Gt,Gt),tt.call(S+"_copy",Lt,ge),tt.call(S+"_sub",de,pe,Lt),tt.call(S+"_add",pe,de,de),tt.call(S+"_copy",Lt,pe),tt.call(M+"_one",Ee),tt.call(P+"_timesScalar",Vt,St,tt.i32_const(8),Vt),tt.call(P+"_addMixed",Vt,Ot,Vt),tt.ret(tt.call(P+"_eqMixed",Vt,tt.getLocal("p"))));const xe=e.addFunction(P+"_inGroup");xe.addParam("pIn","i32"),xe.setReturnType("i32");const Se=xe.getCodeBuilder(),Be=Se.i32_const(e.alloc(o*2));xe.addCode(Se.call(P+"_toAffine",Se.getLocal("pIn"),Be),Se.ret(Se.call(P+"_inGroupAffine",Be)))}function ut(){const Y=e.addFunction(B+"_inGroupAffine");Y.addParam("p","i32"),Y.setReturnType("i32");const tt=Y.getCodeBuilder(),dt=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,mt=793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,xt=(L*L-1n)/3n,bt=tt.i32_const(e.alloc(ke.bigInt2BytesLE(q(dt),u))),_t=tt.i32_const(e.alloc(ke.bigInt2BytesLE(q(mt),u))),Ht=tt.i32_const(e.alloc(ke.bigInt2BytesLE(xt,16))),St=tt.getLocal("p"),Mt=tt.i32_add(tt.getLocal("p"),tt.i32_const(v)),jt=e.alloc(v*3),Lt=tt.i32_const(jt),Ft=tt.i32_const(jt),te=tt.i32_const(jt+v),Bt=e.alloc(v*2),Ot=tt.i32_const(Bt),ie=tt.i32_const(Bt),kt=tt.i32_const(Bt+v);Y.addCode(tt.if(tt.call(B+"_isZeroAffine",tt.getLocal("p")),tt.ret(tt.i32_const(1))),tt.if(tt.i32_eqz(tt.call(B+"_inCurveAffine",tt.getLocal("p"))),tt.ret(tt.i32_const(0))),tt.call(S+"_mul",St,bt,Ft),tt.call(S+"_copy",Mt,te),tt.call(S+"_mul",St,_t,ie),tt.call(S+"_copy",Mt,kt),tt.call(B+"_doubleAffine",Lt,Lt),tt.call(B+"_subMixed",Lt,tt.getLocal("p"),Lt),tt.call(B+"_subMixed",Lt,Ot,Lt),tt.call(B+"_timesScalar",Lt,Ht,tt.i32_const(16),Lt),tt.ret(tt.call(B+"_eqMixed",Lt,Ot)));const qt=e.addFunction(B+"_inGroup");qt.addParam("pIn","i32"),qt.setReturnType("i32");const ae=qt.getCodeBuilder(),Rt=ae.i32_const(e.alloc(v*2));qt.addCode(ae.call(B+"_toAffine",ae.getLocal("pIn"),Rt),ae.ret(ae.call(B+"_inGroupAffine",Rt)))}for(let Y=0;Y<10;Y++)Ut(Y),e.exportFunction(f+"_frobeniusMap"+Y);ut(),Dt(),et(),j(),H(),nt(),pt(),at(),Jt();for(let Y=1;Y<=5;Y++)lt(Y),e.exportFunction(t+"_pairingEq"+Y);gt(),e.exportFunction(t+"_pairing"),e.exportFunction(t+"_prepareG1"),e.exportFunction(t+"_prepareG2"),e.exportFunction(t+"_millerLoop"),e.exportFunction(t+"_finalExponentiation"),e.exportFunction(t+"_finalExponentiationOld"),e.exportFunction(t+"__cyclotomicSquare"),e.exportFunction(t+"__cyclotomicExp_w0"),e.exportFunction(x+"_mul1"),e.exportFunction(x+"_mul01"),e.exportFunction(f+"_mul014"),e.exportFunction(B+"_inGroupAffine"),e.exportFunction(B+"_inGroup"),e.exportFunction(P+"_inGroupAffine"),e.exportFunction(P+"_inGroup")},YC=GC,XC=WC;function Yh(i){if(typeof i=="bigint"||i.eq!==void 0)return i.toString(10);if(i instanceof Uint8Array)return Bo(i,0);if(Array.isArray(i))return i.map(Yh);if(typeof i=="object"){const e={};return Object.keys(i).forEach(t=>{e[t]=Yh(i[t])}),e}else return i}function Xh(i){if(typeof i=="string"&&/^[0-9]+$/.test(i))return BigInt(i);if(typeof i=="string"&&/^0x[0-9a-fA-F]+$/.test(i))return BigInt(i);if(Array.isArray(i))return i.map(Xh);if(typeof i=="object"){if(i===null)return null;const e={};return Object.keys(i).forEach(t=>{e[t]=Xh(i[t])}),e}else return i}function JC(i){let e=BigInt(0),r=i.length,t=0;const a=new DataView(i.buffer,i.byteOffset,i.byteLength);for(;r>0;)r>=4?(r-=4,e+=BigInt(a.getUint32(r))<<BigInt(t*8),t+=4):r>=2?(r-=2,e+=BigInt(a.getUint16(r))<<BigInt(t*8),t+=2):(r-=1,e+=BigInt(a.getUint8(r))<<BigInt(t*8),t+=1);return e}function tE(i,e){let r=i;const t=new Uint8Array(e),a=new DataView(t.buffer);let n=e;for(;n>0;)n-4>=0?(n-=4,a.setUint32(n,Number(r&BigInt(4294967295))),r=r>>BigInt(32)):n-2>=0?(n-=2,a.setUint16(n,Number(r&BigInt(65535))),r=r>>BigInt(16)):(n-=1,a.setUint8(n,Number(r&BigInt(255))),r=r>>BigInt(8));if(r)throw new Error("Number does not fit in this length");return t}function eE(i){let e=BigInt(0),r=0;const t=new DataView(i.buffer,i.byteOffset,i.byteLength);for(;r<i.length;)r+4<=i.length?(e+=BigInt(t.getUint32(r,!0))<<BigInt(r*8),r+=4):r+2<=i.length?(e+=BigInt(t.getUint16(r,!0))<<BigInt(r*8),r+=2):(e+=BigInt(t.getUint8(r,!0))<<BigInt(r*8),r+=1);return e}function Pb(i,e){let r=i;typeof e>"u"&&(e=Math.floor(($o(i)-1)/8)+1,e==0&&(e=1));const t=new Uint8Array(e),a=new DataView(t.buffer);let n=0;for(;n<e;)n+4<=e?(a.setUint32(n,Number(r&BigInt(4294967295)),!0),n+=4,r=r>>BigInt(32)):n+2<=e?(a.setUint16(n,Number(r&BigInt(65535)),!0),n+=2,r=r>>BigInt(16)):(a.setUint8(n,Number(r&BigInt(255)),!0),n+=1,r=r>>BigInt(8));if(r)throw new Error("Number does not fit in this length");return t}function Jh(i,e){if(typeof e=="bigint"||e.eq!==void 0)return e.toString(10);if(e instanceof Uint8Array)return i.toString(i.e(e));if(Array.isArray(e))return e.map(Jh.bind(this,i));if(typeof e=="object"){const r={};return Object.keys(e).forEach(a=>{r[a]=Jh(i,e[a])}),r}else return e}function td(i,e){if(typeof e=="string"&&/^[0-9]+$/.test(e))return i.e(e);if(typeof e=="string"&&/^0x[0-9a-fA-F]+$/.test(e))return i.e(e);if(Array.isArray(e))return e.map(td.bind(this,i));if(typeof e=="object"){if(e===null)return null;const r={};return Object.keys(e).forEach(a=>{r[a]=td(i,e[a])}),r}else return e}const so=[];for(let i=0;i<256;i++)so[i]=rE(i,8);function rE(i,e){let r=0,t=i;for(let a=0;a<e;a++)r<<=1,r=r|t&1,t>>=1;return r}function Ub(i,e){return(so[i>>>24]|so[i>>>16&255]<<8|so[i>>>8&255]<<16|so[i&255]<<24)>>>32-e}function Ci(i){return(i&4294901760?(i&=4294901760,16):0)|(i&4278255360?(i&=4278255360,8):0)|(i&4042322160?(i&=4042322160,4):0)|(i&3435973836?(i&=3435973836,2):0)|(i&2863311530)!==0}function Db(i,e){const r=i.byteLength/e,t=Ci(r);if(r!=1<<t)throw new Error("Invalid number of pointers");for(let a=0;a<r;a++){const n=Ub(a,t);if(a>n){const c=i.slice(a*e,(a+1)*e);i.set(i.slice(n*e,(n+1)*e),a*e),i.set(c,n*e)}}}function I1(i,e){const r=new Uint8Array(e*i.length);for(let t=0;t<i.length;t++)r.set(i[t],t*e);return r}function nl(i,e){const r=i.byteLength/e,t=new Array(r);for(let a=0;a<r;a++)t[a]=i.slice(a*e,a*e+e);return t}var iE=Object.freeze({__proto__:null,array2buffer:I1,beBuff2int:JC,beInt2Buff:tE,bitReverse:Ub,buffReverseBits:Db,buffer2array:nl,leBuff2int:eE,leInt2Buff:Pb,log2:Ci,stringifyBigInts:Yh,stringifyFElements:Jh,unstringifyBigInts:Xh,unstringifyFElements:td});const Wr=1<<30;class ee{constructor(e){this.buffers=[],this.byteLength=e;for(let r=0;r<e;r+=Wr){const t=Math.min(e-r,Wr);this.buffers.push(new Uint8Array(t))}}slice(e,r){r===void 0&&(r=this.byteLength),e===void 0&&(e=0);const t=r-e,a=Math.floor(e/Wr),n=Math.floor((e+t-1)/Wr);if(a==n||t==0)return this.buffers[a].slice(e%Wr,e%Wr+t);let c,u=a,v=e%Wr,o=t;for(;o>0;){const h=v+o>Wr?Wr-v:o,g=new Uint8Array(this.buffers[u].buffer,this.buffers[u].byteOffset+v,h);if(h==t)return g.slice();c||(t<=Wr?c=new Uint8Array(t):c=new ee(t)),c.set(g,t-o),o=o-h,u++,v=0}return c}set(e,r){r===void 0&&(r=0);const t=e.byteLength;if(t==0)return;const a=Math.floor(r/Wr),n=Math.floor((r+t-1)/Wr);if(a==n)return e instanceof ee&&e.buffers.length==1?this.buffers[a].set(e.buffers[0],r%Wr):this.buffers[a].set(e,r%Wr);let c=a,u=r%Wr,v=t;for(;v>0;){const o=u+v>Wr?Wr-u:v,h=e.slice(t-v,t-v+o);new Uint8Array(this.buffers[c].buffer,this.buffers[c].byteOffset+u,o).set(h),v=v-o,c++,u=0}}}function ta(i,e,r,t){return async function(n){const c=Math.floor(n.byteLength/r);if(c*r!==n.byteLength)throw new Error("Invalid buffer size");const u=Math.floor(c/i.concurrency),v=[];for(let y=0;y<i.concurrency;y++){let _;if(y<i.concurrency-1?_=u:_=c-y*u,_==0)continue;const S=[{cmd:"ALLOCSET",var:0,buff:n.slice(y*u*r,y*u*r+_*r)},{cmd:"ALLOC",var:1,len:t*_},{cmd:"CALL",fnName:e,params:[{var:0},{val:_},{var:1}]},{cmd:"GET",out:0,var:1,len:t*_}];v.push(i.queueAction(S))}const o=await Promise.all(v);let h;n instanceof ee?h=new ee(c*t):h=new Uint8Array(c*t);let g=0;for(let y=0;y<o.length;y++)h.set(o[y][0],g),g+=o[y][0].byteLength;return h}}class em{constructor(e,r,t,a){if(this.tm=e,this.prefix=r,this.p=a,this.n8=t,this.type="F1",this.m=1,this.half=hs(a,Ba),this.bitLength=$o(a),this.mask=Kn(rl(Ba,this.bitLength),Ba),this.pOp1=e.alloc(t),this.pOp2=e.alloc(t),this.pOp3=e.alloc(t),this.tm.instance.exports[r+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[r+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(t/8),this.n32=Math.floor(t/4),this.n64*8!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=hs(this.p,Ba),this.nqr=this.two;let n=this.exp(this.nqr,this.half);for(;!this.eq(n,this.negone);)this.nqr=this.add(this.nqr,this.one),n=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let c=Kn(this.p,Ba);for(;!g1(c);)this.s=this.s+1,c=hs(c,Ba);this.w=[],this.w[this.s]=this.exp(this.nqr,c);for(let u=this.s-1;u>=0;u--)this.w[u]=this.square(this.w[u+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=ta(e,r+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=ta(e,r+"_batchFromMontgomery",this.n8,this.n8)}op2(e,r,t){return this.tm.setBuff(this.pOp1,r),this.tm.setBuff(this.pOp2,t),this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(e,r,t){return this.tm.setBuff(this.pOp1,r),this.tm.setBuff(this.pOp2,t),!!this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp2)}op1(e,r){return this.tm.setBuff(this.pOp1,r),this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(e,r){return this.tm.setBuff(this.pOp1,r),!!this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp3)}add(e,r){return this.op2("_add",e,r)}eq(e,r){return this.op2Bool("_eq",e,r)}isZero(e){return this.op1Bool("_isZero",e)}sub(e,r){return this.op2("_sub",e,r)}neg(e){return this.op1("_neg",e)}inv(e){return this.op1("_inverse",e)}toMontgomery(e){return this.op1("_toMontgomery",e)}fromMontgomery(e){return this.op1("_fromMontgomery",e)}mul(e,r){return this.op2("_mul",e,r)}div(e,r){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,r),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(e){return this.op1("_square",e)}isSquare(e){return this.op1Bool("_isSquare",e)}sqrt(e){return this.op1("_sqrt",e)}exp(e,r){return r instanceof Uint8Array||(r=bs(qr(r))),this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,r),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,r.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(e){return this.op1Bool("_isNegative",e)}e(e,r){if(e instanceof Uint8Array)return e;let t=qr(e,r);cb(t)?(t=pb(t),Wh(t,this.p)&&(t=vn(t,this.p)),t=Kn(this.p,t)):Wh(t,this.p)&&(t=vn(t,this.p));const a=Pb(t,this.n8);return this.toMontgomery(a)}toString(e,r){const t=this.fromMontgomery(e),a=Bo(t,0);return b1(a,r)}fromRng(e){let r;const t=new Uint8Array(this.n8);do{r=bb;for(let a=0;a<this.n64;a++)r=m1(r,rl(e.nextU64(),64*a));r=y1(r,this.mask)}while(gb(r,this.p));return Mo(t,0,r,this.n8),t}random(){return this.fromRng(_1())}toObject(e){const r=this.fromMontgomery(e);return Bo(r,0)}fromObject(e){const r=new Uint8Array(this.n8);return Mo(r,0,e,this.n8),this.toMontgomery(r)}toRprLE(e,r,t){e.set(this.fromMontgomery(t),r)}toRprBE(e,r,t){const a=this.fromMontgomery(t);for(let n=0;n<this.n8/2;n++){const c=a[n];a[n]=a[this.n8-1-n],a[this.n8-1-n]=c}e.set(a,r)}fromRprLE(e,r){r=r||0;const t=e.slice(r,r+this.n8);return this.toMontgomery(t)}async batchInverse(e){let r=!1;const t=this.n8,a=this.n8;Array.isArray(e)?(e=I1(e,t),r=!0):e=e.slice(0,e.byteLength);const n=Math.floor(e.byteLength/t);if(n*t!==e.byteLength)throw new Error("Invalid buffer size");const c=Math.floor(n/this.tm.concurrency),u=[];for(let g=0;g<this.tm.concurrency;g++){let y;if(g<this.tm.concurrency-1?y=c:y=n-g*c,y==0)continue;const A=[{cmd:"ALLOCSET",var:0,buff:e.slice(g*c*t,g*c*t+y*t)},{cmd:"ALLOC",var:1,len:a*y},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:t},{val:y},{var:1},{val:a}]},{cmd:"GET",out:0,var:1,len:a*y}];u.push(this.tm.queueAction(A))}const v=await Promise.all(u);let o;e instanceof ee?o=new ee(n*a):o=new Uint8Array(n*a);let h=0;for(let g=0;g<v.length;g++)o.set(v[g][0],h),h+=v[g][0].byteLength;return r?nl(o,a):o}}class rm{constructor(e,r,t){this.tm=e,this.prefix=r,this.F=t,this.type="F2",this.m=t.m*2,this.n8=this.F.n8*2,this.n32=this.F.n32*2,this.n64=this.F.n64*2,this.pOp1=e.alloc(t.n8*2),this.pOp2=e.alloc(t.n8*2),this.pOp3=e.alloc(t.n8*2),this.tm.instance.exports[r+"_zero"](this.pOp1),this.zero=e.getBuff(this.pOp1,this.n8),this.tm.instance.exports[r+"_one"](this.pOp1),this.one=e.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(e,r,t){return this.tm.setBuff(this.pOp1,r),this.tm.setBuff(this.pOp2,t),this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(e,r,t){return this.tm.setBuff(this.pOp1,r),this.tm.setBuff(this.pOp2,t),!!this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp2)}op1(e,r){return this.tm.setBuff(this.pOp1,r),this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(e,r){return this.tm.setBuff(this.pOp1,r),!!this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp3)}add(e,r){return this.op2("_add",e,r)}eq(e,r){return this.op2Bool("_eq",e,r)}isZero(e){return this.op1Bool("_isZero",e)}sub(e,r){return this.op2("_sub",e,r)}neg(e){return this.op1("_neg",e)}inv(e){return this.op1("_inverse",e)}isNegative(e){return this.op1Bool("_isNegative",e)}toMontgomery(e){return this.op1("_toMontgomery",e)}fromMontgomery(e){return this.op1("_fromMontgomery",e)}mul(e,r){return this.op2("_mul",e,r)}mul1(e,r){return this.op2("_mul1",e,r)}div(e,r){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,r),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(e){return this.op1("_square",e)}isSquare(e){return this.op1Bool("_isSquare",e)}sqrt(e){return this.op1("_sqrt",e)}exp(e,r){return r instanceof Uint8Array||(r=bs(qr(r))),this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,r),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,r.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(e,r){if(e instanceof Uint8Array)return e;if(Array.isArray(e)&&e.length==2){const t=this.F.e(e[0],r),a=this.F.e(e[1],r),n=new Uint8Array(this.F.n8*2);return n.set(t),n.set(a,this.F.n8*2),n}else throw new Error("invalid F2")}toString(e,r){const t=this.F.toString(e.slice(0,this.F.n8),r),a=this.F.toString(e.slice(this.F.n8),r);return`[${t}, ${a}]`}fromRng(e){const r=this.F.fromRng(e),t=this.F.fromRng(e),a=new Uint8Array(this.F.n8*2);return a.set(r),a.set(t,this.F.n8),a}random(){return this.fromRng(_1())}toObject(e){const r=this.F.toObject(e.slice(0,this.F.n8)),t=this.F.toObject(e.slice(this.F.n8,this.F.n8*2));return[r,t]}fromObject(e){const r=new Uint8Array(this.F.n8*2),t=this.F.fromObject(e[0]),a=this.F.fromObject(e[1]);return r.set(t),r.set(a,this.F.n8),r}c1(e){return e.slice(0,this.F.n8)}c2(e){return e.slice(this.F.n8)}}class nE{constructor(e,r,t){this.tm=e,this.prefix=r,this.F=t,this.type="F3",this.m=t.m*3,this.n8=this.F.n8*3,this.n32=this.F.n32*3,this.n64=this.F.n64*3,this.pOp1=e.alloc(t.n8*3),this.pOp2=e.alloc(t.n8*3),this.pOp3=e.alloc(t.n8*3),this.tm.instance.exports[r+"_zero"](this.pOp1),this.zero=e.getBuff(this.pOp1,this.n8),this.tm.instance.exports[r+"_one"](this.pOp1),this.one=e.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(e,r,t){return this.tm.setBuff(this.pOp1,r),this.tm.setBuff(this.pOp2,t),this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(e,r,t){return this.tm.setBuff(this.pOp1,r),this.tm.setBuff(this.pOp2,t),!!this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp2)}op1(e,r){return this.tm.setBuff(this.pOp1,r),this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(e,r){return this.tm.setBuff(this.pOp1,r),!!this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp3)}eq(e,r){return this.op2Bool("_eq",e,r)}isZero(e){return this.op1Bool("_isZero",e)}add(e,r){return this.op2("_add",e,r)}sub(e,r){return this.op2("_sub",e,r)}neg(e){return this.op1("_neg",e)}inv(e){return this.op1("_inverse",e)}isNegative(e){return this.op1Bool("_isNegative",e)}toMontgomery(e){return this.op1("_toMontgomery",e)}fromMontgomery(e){return this.op1("_fromMontgomery",e)}mul(e,r){return this.op2("_mul",e,r)}div(e,r){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,r),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(e){return this.op1("_square",e)}isSquare(e){return this.op1Bool("_isSquare",e)}sqrt(e){return this.op1("_sqrt",e)}exp(e,r){return r instanceof Uint8Array||(r=bs(qr(r))),this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,r),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,r.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(e,r){if(e instanceof Uint8Array)return e;if(Array.isArray(e)&&e.length==3){const t=this.F.e(e[0],r),a=this.F.e(e[1],r),n=this.F.e(e[2],r),c=new Uint8Array(this.F.n8*3);return c.set(t),c.set(a,this.F.n8),c.set(n,this.F.n8*2),c}else throw new Error("invalid F3")}toString(e,r){const t=this.F.toString(e.slice(0,this.F.n8),r),a=this.F.toString(e.slice(this.F.n8,this.F.n8*2),r),n=this.F.toString(e.slice(this.F.n8*2),r);return`[${t}, ${a}, ${n}]`}fromRng(e){const r=this.F.fromRng(e),t=this.F.fromRng(e),a=this.F.fromRng(e),n=new Uint8Array(this.F.n8*3);return n.set(r),n.set(t,this.F.n8),n.set(a,this.F.n8*2),n}random(){return this.fromRng(_1())}toObject(e){const r=this.F.toObject(e.slice(0,this.F.n8)),t=this.F.toObject(e.slice(this.F.n8,this.F.n8*2)),a=this.F.toObject(e.slice(this.F.n8*2,this.F.n8*3));return[r,t,a]}fromObject(e){const r=new Uint8Array(this.F.n8*3),t=this.F.fromObject(e[0]),a=this.F.fromObject(e[1]),n=this.F.fromObject(e[2]);return r.set(t),r.set(a,this.F.n8),r.set(n,this.F.n8*2),r}c1(e){return e.slice(0,this.F.n8)}c2(e){return e.slice(this.F.n8,this.F.n8*2)}c3(e){return e.slice(this.F.n8*2)}}class im{constructor(e,r,t,a,n,c){this.tm=e,this.prefix=r,this.F=t,this.pOp1=e.alloc(t.n8*3),this.pOp2=e.alloc(t.n8*3),this.pOp3=e.alloc(t.n8*3),this.tm.instance.exports[r+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,t.n8*3),this.tm.instance.exports[r+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,t.n8*2),this.one=this.tm.getBuff(a,t.n8*3),this.g=this.one,this.oneAffine=this.tm.getBuff(a,t.n8*2),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(n,t.n8),c&&(this.cofactor=bs(c)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=ta(e,r+"_batchLEMtoC",t.n8*2,t.n8),this.batchLEMtoU=ta(e,r+"_batchLEMtoU",t.n8*2,t.n8*2),this.batchCtoLEM=ta(e,r+"_batchCtoLEM",t.n8,t.n8*2),this.batchUtoLEM=ta(e,r+"_batchUtoLEM",t.n8*2,t.n8*2),this.batchToJacobian=ta(e,r+"_batchToJacobian",t.n8*2,t.n8*3),this.batchToAffine=ta(e,r+"_batchToAffine",t.n8*3,t.n8*2)}op2(e,r,t){return this.tm.setBuff(this.pOp1,r),this.tm.setBuff(this.pOp2,t),this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op2bool(e,r,t){return this.tm.setBuff(this.pOp1,r),this.tm.setBuff(this.pOp2,t),!!this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp2,this.pOp3)}op1(e,r){return this.tm.setBuff(this.pOp1,r),this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op1Affine(e,r){return this.tm.setBuff(this.pOp1,r),this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*2)}op1Bool(e,r){return this.tm.setBuff(this.pOp1,r),!!this.tm.instance.exports[this.prefix+e](this.pOp1,this.pOp3)}add(e,r){if(e.byteLength==this.F.n8*3){if(r.byteLength==this.F.n8*3)return this.op2("_add",e,r);if(r.byteLength==this.F.n8*2)return this.op2("_addMixed",e,r);throw new Error("invalid point size")}else if(e.byteLength==this.F.n8*2){if(r.byteLength==this.F.n8*3)return this.op2("_addMixed",r,e);if(r.byteLength==this.F.n8*2)return this.op2("_addAffine",e,r);throw new Error("invalid point size")}else throw new Error("invalid point size")}sub(e,r){if(e.byteLength==this.F.n8*3){if(r.byteLength==this.F.n8*3)return this.op2("_sub",e,r);if(r.byteLength==this.F.n8*2)return this.op2("_subMixed",e,r);throw new Error("invalid point size")}else if(e.byteLength==this.F.n8*2){if(r.byteLength==this.F.n8*3)return this.op2("_subMixed",r,e);if(r.byteLength==this.F.n8*2)return this.op2("_subAffine",e,r);throw new Error("invalid point size")}else throw new Error("invalid point size")}neg(e){if(e.byteLength==this.F.n8*3)return this.op1("_neg",e);if(e.byteLength==this.F.n8*2)return this.op1Affine("_negAffine",e);throw new Error("invalid point size")}double(e){if(e.byteLength==this.F.n8*3)return this.op1("_double",e);if(e.byteLength==this.F.n8*2)return this.op1("_doubleAffine",e);throw new Error("invalid point size")}isZero(e){if(e.byteLength==this.F.n8*3)return this.op1Bool("_isZero",e);if(e.byteLength==this.F.n8*2)return this.op1Bool("_isZeroAffine",e);throw new Error("invalid point size")}timesScalar(e,r){r instanceof Uint8Array||(r=bs(qr(r)));let t;if(e.byteLength==this.F.n8*3)t=this.prefix+"_timesScalar";else if(e.byteLength==this.F.n8*2)t=this.prefix+"_timesScalarAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,r),this.tm.instance.exports[t](this.pOp1,this.pOp2,r.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}timesFr(e,r){let t;if(e.byteLength==this.F.n8*3)t=this.prefix+"_timesFr";else if(e.byteLength==this.F.n8*2)t=this.prefix+"_timesFrAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,r),this.tm.instance.exports[t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}eq(e,r){if(e.byteLength==this.F.n8*3){if(r.byteLength==this.F.n8*3)return this.op2bool("_eq",e,r);if(r.byteLength==this.F.n8*2)return this.op2bool("_eqMixed",e,r);throw new Error("invalid point size")}else if(e.byteLength==this.F.n8*2){if(r.byteLength==this.F.n8*3)return this.op2bool("_eqMixed",r,e);if(r.byteLength==this.F.n8*2)return this.op2bool("_eqAffine",e,r);throw new Error("invalid point size")}else throw new Error("invalid point size")}toAffine(e){if(e.byteLength==this.F.n8*3)return this.op1Affine("_toAffine",e);if(e.byteLength==this.F.n8*2)return e;throw new Error("invalid point size")}toJacobian(e){if(e.byteLength==this.F.n8*3)return e;if(e.byteLength==this.F.n8*2)return this.op1("_toJacobian",e);throw new Error("invalid point size")}toRprUncompressed(e,r,t){if(this.tm.setBuff(this.pOp1,t),t.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(t.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);const a=this.tm.getBuff(this.pOp1,this.F.n8*2);e.set(a,r)}fromRprUncompressed(e,r){const t=e.slice(r,r+this.F.n8*2);return this.tm.setBuff(this.pOp1,t),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,this.F.n8*2)}toRprCompressed(e,r,t){if(this.tm.setBuff(this.pOp1,t),t.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(t.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);const a=this.tm.getBuff(this.pOp1,this.F.n8);e.set(a,r)}fromRprCompressed(e,r){const t=e.slice(r,r+this.F.n8);return this.tm.setBuff(this.pOp1,t),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,this.F.n8*2)}toUncompressed(e){const r=new Uint8Array(this.F.n8*2);return this.toRprUncompressed(r,0,e),r}toRprLEM(e,r,t){if(t.byteLength==this.F.n8*2){e.set(t,r);return}else if(t.byteLength==this.F.n8*3){this.tm.setBuff(this.pOp1,t),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);const a=this.tm.getBuff(this.pOp1,this.F.n8*2);e.set(a,r)}else throw new Error("invalid point size")}fromRprLEM(e,r){return r=r||0,e.slice(r,r+this.F.n8*2)}toString(e,r){if(e.byteLength==this.F.n8*3){const t=this.F.toString(e.slice(0,this.F.n8),r),a=this.F.toString(e.slice(this.F.n8,this.F.n8*2),r),n=this.F.toString(e.slice(this.F.n8*2),r);return`[ ${t}, ${a}, ${n} ]`}else if(e.byteLength==this.F.n8*2){const t=this.F.toString(e.slice(0,this.F.n8),r),a=this.F.toString(e.slice(this.F.n8),r);return`[ ${t}, ${a} ]`}else throw new Error("invalid point size")}isValid(e){if(this.isZero(e))return!0;const r=this.F,t=this.toAffine(e),a=t.slice(0,this.F.n8),n=t.slice(this.F.n8,this.F.n8*2),c=r.add(r.mul(r.square(a),a),this.b),u=r.square(n);return r.eq(c,u)}fromRng(e){const r=this.F;let t=[],a,n;do t[0]=r.fromRng(e),a=e.nextBool(),n=r.add(r.mul(r.square(t[0]),t[0]),this.b);while(!r.isSquare(n));t[1]=r.sqrt(n);const c=r.isNegative(t[1]);a^c&&(t[1]=r.neg(t[1]));let u=new Uint8Array(this.F.n8*2);return u.set(t[0]),u.set(t[1],this.F.n8),this.cofactor&&(u=this.timesScalar(u,this.cofactor)),u}toObject(e){if(this.isZero(e))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];const r=this.F.toObject(e.slice(0,this.F.n8)),t=this.F.toObject(e.slice(this.F.n8,this.F.n8*2));let a;return e.byteLength==this.F.n8*3?a=this.F.toObject(e.slice(this.F.n8*2,this.F.n8*3)):a=this.F.toObject(this.F.one),[r,t,a]}fromObject(e){const r=this.F.fromObject(e[0]),t=this.F.fromObject(e[1]);let a;if(e.length==3?a=this.F.fromObject(e[2]):a=this.F.one,this.F.isZero(a,this.F.one))return this.zeroAffine;if(this.F.eq(a,this.F.one)){const n=new Uint8Array(this.F.n8*2);return n.set(r),n.set(t,this.F.n8),n}else{const n=new Uint8Array(this.F.n8*3);return n.set(r),n.set(t,this.F.n8),n.set(a,this.F.n8*2),n}}e(e){return e instanceof Uint8Array?e:this.fromObject(e)}x(e){return this.toAffine(e).slice(0,this.F.n8)}y(e){return this.toAffine(e).slice(this.F.n8)}}function aE(i){let r,t;async function a(h){const g=new Uint8Array(h.code),y=await WebAssembly.compile(g);t=new WebAssembly.Memory({initial:h.init,maximum:32767}),r=await WebAssembly.instantiate(y,{env:{memory:t}})}function n(h){const g=new Uint32Array(t.buffer,0,1);for(;g[0]&3;)g[0]++;const y=g[0];if(g[0]+=h,g[0]+h>t.buffer.byteLength){const _=t.buffer.byteLength/65536;let A=Math.floor((g[0]+h)/65536)+1;A>32767&&(A=32767),t.grow(A-_)}return y}function c(h){const g=n(h.byteLength);return v(g,h),g}function u(h,g){const y=new Uint8Array(t.buffer);return new Uint8Array(y.buffer,y.byteOffset+h,g)}function v(h,g){new Uint8Array(t.buffer).set(new Uint8Array(g),h)}function o(h){if(h[0].cmd=="INIT")return a(h[0]);const g={vars:[],out:[]},_=new Uint32Array(t.buffer,0,1)[0];for(let S=0;S<h.length;S++)switch(h[S].cmd){case"ALLOCSET":g.vars[h[S].var]=c(h[S].buff);break;case"ALLOC":g.vars[h[S].var]=n(h[S].len);break;case"SET":v(g.vars[h[S].var],h[S].buff);break;case"CALL":{const T=[];for(let B=0;B<h[S].params.length;B++){const M=h[S].params[B];typeof M.var<"u"?T.push(g.vars[M.var]+(M.offset||0)):typeof M.val<"u"&&T.push(M.val)}r.exports[h[S].fnName](...T);break}case"GET":g.out[h[S].out]=u(g.vars[h[S].var],h[S].len).slice();break;default:throw new Error("Invalid cmd")}const A=new Uint32Array(t.buffer,0,1);return A[0]=_,g.out}return o}const ah=25;class nm{constructor(){this.promise=new Promise((e,r)=>{this.reject=r,this.resolve=e})}}function sE(i){return new Promise(e=>setTimeout(e,i))}let ed;const am=`(function thread(self) {
    const MAXMEM = 32767;
    let instance;
    let memory;

    if (self) {
        self.onmessage = function(e) {
            let data;
            if (e.data) {
                data = e.data;
            } else {
                data = e;
            }

            if (data[0].cmd == "INIT") {
                init(data[0]).then(function() {
                    self.postMessage(data.result);
                });
            } else if (data[0].cmd == "TERMINATE") {
                self.close();
            } else {
                const res = runTask(data);
                self.postMessage(res);
            }
        };
    }

    async function init(data) {
        const code = new Uint8Array(data.code);
        const wasmModule = await WebAssembly.compile(code);
        memory = new WebAssembly.Memory({initial:data.init, maximum: MAXMEM});

        instance = await WebAssembly.instantiate(wasmModule, {
            env: {
                "memory": memory
            }
        });
    }



    function alloc(length) {
        const u32 = new Uint32Array(memory.buffer, 0, 1);
        while (u32[0] & 3) u32[0]++;  // Return always aligned pointers
        const res = u32[0];
        u32[0] += length;
        if (u32[0] + length > memory.buffer.byteLength) {
            const currentPages = memory.buffer.byteLength / 0x10000;
            let requiredPages = Math.floor((u32[0] + length) / 0x10000)+1;
            if (requiredPages>MAXMEM) requiredPages=MAXMEM;
            memory.grow(requiredPages-currentPages);
        }
        return res;
    }

    function allocBuffer(buffer) {
        const p = alloc(buffer.byteLength);
        setBuffer(p, buffer);
        return p;
    }

    function getBuffer(pointer, length) {
        const u8 = new Uint8Array(memory.buffer);
        return new Uint8Array(u8.buffer, u8.byteOffset + pointer, length);
    }

    function setBuffer(pointer, buffer) {
        const u8 = new Uint8Array(memory.buffer);
        u8.set(new Uint8Array(buffer), pointer);
    }

    function runTask(task) {
        if (task[0].cmd == "INIT") {
            return init(task[0]);
        }
        const ctx = {
            vars: [],
            out: []
        };
        const u32a = new Uint32Array(memory.buffer, 0, 1);
        const oldAlloc = u32a[0];
        for (let i=0; i<task.length; i++) {
            switch (task[i].cmd) {
            case "ALLOCSET":
                ctx.vars[task[i].var] = allocBuffer(task[i].buff);
                break;
            case "ALLOC":
                ctx.vars[task[i].var] = alloc(task[i].len);
                break;
            case "SET":
                setBuffer(ctx.vars[task[i].var], task[i].buff);
                break;
            case "CALL": {
                const params = [];
                for (let j=0; j<task[i].params.length; j++) {
                    const p = task[i].params[j];
                    if (typeof p.var !== "undefined") {
                        params.push(ctx.vars[p.var] + (p.offset || 0));
                    } else if (typeof p.val != "undefined") {
                        params.push(p.val);
                    }
                }
                instance.exports[task[i].fnName](...params);
                break;
            }
            case "GET":
                ctx.out[task[i].out] = getBuffer(ctx.vars[task[i].var], task[i].len).slice();
                break;
            default:
                throw new Error("Invalid cmd");
            }
        }
        const u32b = new Uint32Array(memory.buffer, 0, 1);
        u32b[0] = oldAlloc;
        return ctx.out;
    }


    return runTask;
})(self)`;if(globalThis!=null&&globalThis.Blob){const i=new TextEncoder().encode(am),e=new Blob([i],{type:"application/javascript"});ed=URL.createObjectURL(e)}else ed="data:application/javascript;base64,"+globalThis.btoa(am);async function oE(i,e){const r=new fE;r.memory=new WebAssembly.Memory({initial:ah}),r.u8=new Uint8Array(r.memory.buffer),r.u32=new Uint32Array(r.memory.buffer);const t=await WebAssembly.compile(i.code);if(r.instance=await WebAssembly.instantiate(t,{env:{memory:r.memory}}),globalThis!=null&&globalThis.Worker||(e=!0),r.singleThread=e,r.initalPFree=r.u32[0],r.pq=i.pq,r.pr=i.pr,r.pG1gen=i.pG1gen,r.pG1zero=i.pG1zero,r.pG2gen=i.pG2gen,r.pG2zero=i.pG2zero,r.pOneT=i.pOneT,e)r.code=i.code,r.taskManager=aE(),await r.taskManager([{cmd:"INIT",init:ah,code:r.code.slice()}]),r.concurrency=1;else{r.workers=[],r.pendingDeferreds=[],r.working=[];let n=2;typeof navigator=="object"&&navigator.hardwareConcurrency&&(n=navigator.hardwareConcurrency),n==0&&(n=2),n>64&&(n=64),r.concurrency=n;for(let u=0;u<n;u++)r.workers[u]=new Worker(ed),r.workers[u].addEventListener("message",a(u)),r.working[u]=!1;const c=[];for(let u=0;u<r.workers.length;u++){const v=i.code.slice();c.push(r.postAction(u,[{cmd:"INIT",init:ah,code:v}],[v.buffer]))}await Promise.all(c)}return r;function a(n){return function(c){let u;c&&c.data?u=c.data:u=c,r.working[n]=!1,r.pendingDeferreds[n].resolve(u),r.processWorks()}}}class fE{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(this.oldPFree!=0)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(this.oldPFree==0)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(e,r,t,a){if(this.working[e])throw new Error("Posting a job t a working worker");return this.working[e]=!0,this.pendingDeferreds[e]=a||new nm,this.workers[e].postMessage(r,t),this.pendingDeferreds[e].promise}processWorks(){for(let e=0;e<this.workers.length&&this.actionQueue.length>0;e++)if(this.working[e]==!1){const r=this.actionQueue.shift();this.postAction(e,r.data,r.transfers,r.deferred)}}queueAction(e,r){const t=new nm;if(this.singleThread){const a=this.taskManager(e);t.resolve(a)}else this.actionQueue.push({data:e,transfers:r,deferred:t}),this.processWorks();return t.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(e){const r=this.alloc(e.byteLength);return this.setBuff(r,e),r}getBuff(e,r){return this.u8.slice(e,e+r)}setBuff(e,r){this.u8.set(new Uint8Array(r),e)}alloc(e){for(;this.u32[0]&3;)this.u32[0]++;const r=this.u32[0];return this.u32[0]+=e,r}async terminate(){for(let e=0;e<this.workers.length;e++)this.workers[e].postMessage([{cmd:"TERMINATE"}]);await sE(200)}}function sh(i,e){const r=i[e],t=i.Fr,a=i.tm;i[e].batchApplyKey=async function(n,c,u,v,o){v=v||"affine",o=o||"affine";let h,g,y,_,A;if(e=="G1")v=="jacobian"?(y=r.F.n8*3,h="g1m_batchApplyKey"):(y=r.F.n8*2,h="g1m_batchApplyKeyMixed"),_=r.F.n8*3,o=="jacobian"?A=r.F.n8*3:(g="g1m_batchToAffine",A=r.F.n8*2);else if(e=="G2")v=="jacobian"?(y=r.F.n8*3,h="g2m_batchApplyKey"):(y=r.F.n8*2,h="g2m_batchApplyKeyMixed"),_=r.F.n8*3,o=="jacobian"?A=r.F.n8*3:(g="g2m_batchToAffine",A=r.F.n8*2);else if(e=="Fr")h="frm_batchApplyKey",y=r.n8,_=r.n8,A=r.n8;else throw new Error("Invalid group: "+e);const S=Math.floor(n.byteLength/y),T=Math.floor(S/a.concurrency),B=[];u=t.e(u);let M=t.e(c);for(let q=0;q<a.concurrency;q++){let k;if(q<a.concurrency-1?k=T:k=S-q*T,k==0)continue;const U=[];U.push({cmd:"ALLOCSET",var:0,buff:n.slice(q*T*y,q*T*y+k*y)}),U.push({cmd:"ALLOCSET",var:1,buff:M}),U.push({cmd:"ALLOCSET",var:2,buff:u}),U.push({cmd:"ALLOC",var:3,len:k*Math.max(_,A)}),U.push({cmd:"CALL",fnName:h,params:[{var:0},{val:k},{var:1},{var:2},{var:3}]}),g&&U.push({cmd:"CALL",fnName:g,params:[{var:3},{val:k},{var:3}]}),U.push({cmd:"GET",out:0,var:3,len:k*A}),B.push(a.queueAction(U)),M=t.mul(M,t.exp(u,k))}const R=await Promise.all(B);let P;n instanceof ee?P=new ee(S*A):P=new Uint8Array(S*A);let D=0;for(let q=0;q<R.length;q++)P.set(R[q][0],D),D+=R[q][0].byteLength;return P}}function lE(i){const e=i.tm;i.pairing=function(t,a){e.startSyncOp();const n=e.allocBuff(i.G1.toJacobian(t)),c=e.allocBuff(i.G2.toJacobian(a)),u=e.alloc(i.Gt.n8);e.instance.exports[i.name+"_pairing"](n,c,u);const v=e.getBuff(u,i.Gt.n8);return e.endSyncOp(),v},i.pairingEq=async function(){let t,a;arguments.length%2==1?(t=arguments[arguments.length-1],a=(arguments.length-1)/2):(t=i.Gt.one,a=arguments.length/2);const n=[];for(let h=0;h<a;h++){const g=[],y=i.G1.toJacobian(arguments[h*2]);g.push({cmd:"ALLOCSET",var:0,buff:y}),g.push({cmd:"ALLOC",var:1,len:i.prePSize});const _=i.G2.toJacobian(arguments[h*2+1]);g.push({cmd:"ALLOCSET",var:2,buff:_}),g.push({cmd:"ALLOC",var:3,len:i.preQSize}),g.push({cmd:"ALLOC",var:4,len:i.Gt.n8}),g.push({cmd:"CALL",fnName:i.name+"_prepareG1",params:[{var:0},{var:1}]}),g.push({cmd:"CALL",fnName:i.name+"_prepareG2",params:[{var:2},{var:3}]}),g.push({cmd:"CALL",fnName:i.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),g.push({cmd:"GET",out:0,var:4,len:i.Gt.n8}),n.push(e.queueAction(g))}const c=await Promise.all(n);e.startSyncOp();const u=e.alloc(i.Gt.n8);e.instance.exports.ftm_one(u);for(let h=0;h<c.length;h++){const g=e.allocBuff(c[h][0]);e.instance.exports.ftm_mul(u,g,u)}e.instance.exports[i.name+"_finalExponentiation"](u,u);const v=e.allocBuff(t),o=!!e.instance.exports.ftm_eq(u,v);return e.endSyncOp(),o},i.prepareG1=function(r){this.tm.startSyncOp();const t=this.tm.allocBuff(r),a=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](t,a);const n=this.tm.getBuff(a,this.prePSize);return this.tm.endSyncOp(),n},i.prepareG2=function(r){this.tm.startSyncOp();const t=this.tm.allocBuff(r),a=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](t,a);const n=this.tm.getBuff(a,this.preQSize);return this.tm.endSyncOp(),n},i.millerLoop=function(r,t){this.tm.startSyncOp();const a=this.tm.allocBuff(r),n=this.tm.allocBuff(t),c=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](a,n,c);const u=this.tm.getBuff(c,this.Gt.n8);return this.tm.endSyncOp(),u},i.finalExponentiation=function(r){this.tm.startSyncOp();const t=this.tm.allocBuff(r),a=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](t,a);const n=this.tm.getBuff(a,this.Gt.n8);return this.tm.endSyncOp(),n}}const sm=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function om(i,e){const r=i[e],t=r.tm;async function a(c,u,v,o,h){if(!(c instanceof Uint8Array))throw o&&o.error(`${h} _multiExpChunk buffBases is not Uint8Array`),new Error(`${h} _multiExpChunk buffBases is not Uint8Array`);if(!(u instanceof Uint8Array))throw o&&o.error(`${h} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${h} _multiExpChunk buffScalars is not Uint8Array`);v=v||"affine";let g,y;if(e=="G1")v=="affine"?(y="g1m_multiexpAffine_chunk",g=r.F.n8*2):(y="g1m_multiexp_chunk",g=r.F.n8*3);else if(e=="G2")v=="affine"?(y="g2m_multiexpAffine_chunk",g=r.F.n8*2):(y="g2m_multiexp_chunk",g=r.F.n8*3);else throw new Error("Invalid group");const _=Math.floor(c.byteLength/g);if(_==0)return r.zero;const A=Math.floor(u.byteLength/_);if(A*_!=u.byteLength)throw new Error("Scalar size does not match");const S=sm[Ci(_)],T=Math.floor((A*8-1)/S)+1,B=[];for(let P=0;P<T;P++){const D=[{cmd:"ALLOCSET",var:0,buff:c},{cmd:"ALLOCSET",var:1,buff:u},{cmd:"ALLOC",var:2,len:r.F.n8*3},{cmd:"CALL",fnName:y,params:[{var:0},{var:1},{val:A},{val:_},{val:P*S},{val:Math.min(A*8-P*S,S)},{var:2}]},{cmd:"GET",out:0,var:2,len:r.F.n8*3}];B.push(r.tm.queueAction(D))}const M=await Promise.all(B);let R=r.zero;for(let P=M.length-1;P>=0;P--){if(!r.isZero(R))for(let D=0;D<S;D++)R=r.double(R);R=r.add(R,M[P][0])}return R}async function n(c,u,v,o,h){let _;if(e=="G1")v=="affine"?_=r.F.n8*2:_=r.F.n8*3;else if(e=="G2")v=="affine"?_=r.F.n8*2:_=r.F.n8*3;else throw new Error("Invalid group");const A=Math.floor(c.byteLength/_);if(A==0)return r.zero;const S=Math.floor(u.byteLength/A);if(S*A!=u.byteLength)throw new Error("Scalar size does not match");const T=sm[Ci(A)],B=Math.floor((S*8-1)/T)+1;let M;M=Math.floor(A/(t.concurrency/B)),M>4194304&&(M=4194304),M<1024&&(M=1024);const R=[];for(let q=0;q<A;q+=M){o&&o.debug(`Multiexp start: ${h}: ${q}/${A}`);const k=Math.min(A-q,M),U=c.slice(q*_,(q+k)*_),O=u.slice(q*S,(q+k)*S);R.push(a(U,O,v,o,h).then(G=>(o&&o.debug(`Multiexp end: ${h}: ${q}/${A}`),G)))}const P=await Promise.all(R);let D=r.zero;for(let q=P.length-1;q>=0;q--)D=r.add(D,P[q]);return D}r.multiExp=async function(u,v,o,h){return await n(u,v,"jacobian",o,h)},r.multiExpAffine=async function(u,v,o,h){return await n(u,v,"affine",o,h)}}function oh(i,e){const r=i[e],t=i.Fr,a=r.tm;async function n(o,h,g,y,_,A){g=g||"affine",y=y||"affine";const S=14;let T,B,M,R,P,D,q,k;e=="G1"?(g=="affine"?(T=r.F.n8*2,R="g1m_batchToJacobian"):T=r.F.n8*3,B=r.F.n8*3,h&&(k="g1m_fftFinal"),q="g1m_fftJoin",D="g1m_fftMix",y=="affine"?(M=r.F.n8*2,P="g1m_batchToAffine"):M=r.F.n8*3):e=="G2"?(g=="affine"?(T=r.F.n8*2,R="g2m_batchToJacobian"):T=r.F.n8*3,B=r.F.n8*3,h&&(k="g2m_fftFinal"),q="g2m_fftJoin",D="g2m_fftMix",y=="affine"?(M=r.F.n8*2,P="g2m_batchToAffine"):M=r.F.n8*3):e=="Fr"&&(T=r.n8,B=r.n8,M=r.n8,h&&(k="frm_fftFinal"),D="frm_fftMix",q="frm_fftJoin");let U=!1;Array.isArray(o)?(o=I1(o,T),U=!0):o=o.slice(0,o.byteLength);const O=o.byteLength/T,G=Ci(O);if(1<<G!=O)throw new Error("fft must be multiple of 2");if(G==t.s+1){let x;return h?x=await u(o,g,y,_,A):x=await c(o,g,y,_,A),U?nl(x,M):x}let E;h&&(E=t.inv(t.e(O)));let s;Db(o,T);let l,d=Math.min(1<<S,O),p=O/d;for(;p<a.concurrency&&d>=16;)p*=2,d/=2;const m=Ci(d),w=[];for(let x=0;x<p;x++){_&&_.debug(`${A}: fft ${G} mix start: ${x}/${p}`);const b=[];b.push({cmd:"ALLOC",var:0,len:B*d});const f=o.slice(d*x*T,d*(x+1)*T);b.push({cmd:"SET",var:0,buff:f}),R&&b.push({cmd:"CALL",fnName:R,params:[{var:0},{val:d},{var:0}]});for(let C=1;C<=m;C++)b.push({cmd:"CALL",fnName:D,params:[{var:0},{val:d},{val:C}]});m==G?(k&&(b.push({cmd:"ALLOCSET",var:1,buff:E}),b.push({cmd:"CALL",fnName:k,params:[{var:0},{val:d},{var:1}]})),P&&b.push({cmd:"CALL",fnName:P,params:[{var:0},{val:d},{var:0}]}),b.push({cmd:"GET",out:0,var:0,len:d*M})):b.push({cmd:"GET",out:0,var:0,len:B*d}),w.push(a.queueAction(b).then(C=>(_&&_.debug(`${A}: fft ${G} mix end: ${x}/${p}`),C)))}l=await Promise.all(w);for(let x=0;x<p;x++)l[x]=l[x][0];for(let x=m+1;x<=G;x++){_&&_.debug(`${A}: fft  ${G}  join: ${x}/${G}`);const b=1<<G-x,f=p/b,C=[];for(let z=0;z<b;z++)for(let W=0;W<f/2;W++){const $=t.exp(t.w[x],W*d),I=t.w[x],K=z*f+W,N=z*f+W+f/2,X=[];X.push({cmd:"ALLOCSET",var:0,buff:l[K]}),X.push({cmd:"ALLOCSET",var:1,buff:l[N]}),X.push({cmd:"ALLOCSET",var:2,buff:$}),X.push({cmd:"ALLOCSET",var:3,buff:I}),X.push({cmd:"CALL",fnName:q,params:[{var:0},{var:1},{val:d},{var:2},{var:3}]}),x==G?(k&&(X.push({cmd:"ALLOCSET",var:4,buff:E}),X.push({cmd:"CALL",fnName:k,params:[{var:0},{val:d},{var:4}]}),X.push({cmd:"CALL",fnName:k,params:[{var:1},{val:d},{var:4}]})),P&&(X.push({cmd:"CALL",fnName:P,params:[{var:0},{val:d},{var:0}]}),X.push({cmd:"CALL",fnName:P,params:[{var:1},{val:d},{var:1}]})),X.push({cmd:"GET",out:0,var:0,len:d*M}),X.push({cmd:"GET",out:1,var:1,len:d*M})):(X.push({cmd:"GET",out:0,var:0,len:d*B}),X.push({cmd:"GET",out:1,var:1,len:d*B})),C.push(a.queueAction(X).then(Q=>(_&&_.debug(`${A}: fft ${G} join  ${x}/${G}  ${z+1}/${b} ${W}/${f/2}`),Q)))}const F=await Promise.all(C);for(let z=0;z<b;z++)for(let W=0;W<f/2;W++){const $=z*f+W,I=z*f+W+f/2,K=F.shift();l[$]=K[0],l[I]=K[1]}}if(o instanceof ee?s=new ee(O*M):s=new Uint8Array(O*M),h){s.set(l[0].slice((d-1)*M));let x=M;for(let b=p-1;b>0;b--)s.set(l[b],x),x+=d*M,delete l[b];s.set(l[0].slice(0,(d-1)*M),x),delete l[0]}else for(let x=0;x<p;x++)s.set(l[x],d*M*x),delete l[x];return U?nl(s,M):s}async function c(o,h,g,y,_){let A,S;A=o.slice(0,o.byteLength/2),S=o.slice(o.byteLength/2,o.byteLength);const T=[];[A,S]=await v(A,S,"fftJoinExt",t.one,t.shift,h,"jacobian",y,_),T.push(n(A,!1,"jacobian",g,y,_)),T.push(n(S,!1,"jacobian",g,y,_));const B=await Promise.all(T);let M;return B[0].byteLength>1<<28?M=new ee(B[0].byteLength*2):M=new Uint8Array(B[0].byteLength*2),M.set(B[0]),M.set(B[1],B[0].byteLength),M}async function u(o,h,g,y,_){let A,S;A=o.slice(0,o.byteLength/2),S=o.slice(o.byteLength/2,o.byteLength);const T=[];T.push(n(A,!0,h,"jacobian",y,_)),T.push(n(S,!0,h,"jacobian",y,_)),[A,S]=await Promise.all(T);const B=await v(A,S,"fftJoinExtInv",t.one,t.shiftInv,"jacobian",g,y,_);let M;return B[0].byteLength>1<<28?M=new ee(B[0].byteLength*2):M=new Uint8Array(B[0].byteLength*2),M.set(B[0]),M.set(B[1],B[0].byteLength),M}async function v(o,h,g,y,_,A,S,T,B){let P,D,q,k,U,O;if(e=="G1")A=="affine"?(U=r.F.n8*2,D="g1m_batchToJacobian"):U=r.F.n8*3,O=r.F.n8*3,P="g1m_"+g,S=="affine"?(q="g1m_batchToAffine",k=r.F.n8*2):k=r.F.n8*3;else if(e=="G2")A=="affine"?(U=r.F.n8*2,D="g2m_batchToJacobian"):U=r.F.n8*3,P="g2m_"+g,O=r.F.n8*3,S=="affine"?(q="g2m_batchToAffine",k=r.F.n8*2):k=r.F.n8*3;else if(e=="Fr")U=t.n8,k=t.n8,O=t.n8,P="frm_"+g;else throw new Error("Invalid group");if(o.byteLength!=h.byteLength)throw new Error("Invalid buffer size");const G=Math.floor(o.byteLength/U);if(G!=1<<Ci(G))throw new Error("Invalid number of points");let E=Math.floor(G/a.concurrency);E<16&&(E=16),E>65536&&(E=65536);const s=[];for(let w=0;w<G;w+=E){T&&T.debug(`${B}: fftJoinExt Start: ${w}/${G}`);const x=Math.min(G-w,E),b=t.mul(y,t.exp(_,w)),f=[],C=o.slice(w*U,(w+x)*U),F=h.slice(w*U,(w+x)*U);f.push({cmd:"ALLOC",var:0,len:O*x}),f.push({cmd:"SET",var:0,buff:C}),f.push({cmd:"ALLOC",var:1,len:O*x}),f.push({cmd:"SET",var:1,buff:F}),f.push({cmd:"ALLOCSET",var:2,buff:b}),f.push({cmd:"ALLOCSET",var:3,buff:_}),D&&(f.push({cmd:"CALL",fnName:D,params:[{var:0},{val:x},{var:0}]}),f.push({cmd:"CALL",fnName:D,params:[{var:1},{val:x},{var:1}]})),f.push({cmd:"CALL",fnName:P,params:[{var:0},{var:1},{val:x},{var:2},{var:3},{val:t.s}]}),q&&(f.push({cmd:"CALL",fnName:q,params:[{var:0},{val:x},{var:0}]}),f.push({cmd:"CALL",fnName:q,params:[{var:1},{val:x},{var:1}]})),f.push({cmd:"GET",out:0,var:0,len:x*k}),f.push({cmd:"GET",out:1,var:1,len:x*k}),s.push(a.queueAction(f).then(z=>(T&&T.debug(`${B}: fftJoinExt End: ${w}/${G}`),z)))}const l=await Promise.all(s);let d,p;G*k>1<<28?(d=new ee(G*k),p=new ee(G*k)):(d=new Uint8Array(G*k),p=new Uint8Array(G*k));let m=0;for(let w=0;w<l.length;w++)d.set(l[w][0],m),p.set(l[w][1],m),m+=l[w][0].byteLength;return[d,p]}r.fft=async function(o,h,g,y,_){return await n(o,!1,h,g,y,_)},r.ifft=async function(o,h,g,y,_){return await n(o,!0,h,g,y,_)},r.lagrangeEvaluations=async function(o,h,g,y,_){h=h||"affine",g=g||"affine";let A;if(e=="G1")h=="affine"?A=r.F.n8*2:A=r.F.n8*3;else if(e=="G2")h=="affine"?A=r.F.n8*2:A=r.F.n8*3;else if(e=="Fr")A=t.n8;else throw new Error("Invalid group");const S=o.byteLength/A,T=Ci(S);if(2**T*A!=o.byteLength)throw y&&y.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(T<=t.s)return await r.ifft(o,h,g,y,_);if(T>t.s+1)throw y&&y.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let B=o.slice(0,o.byteLength/2),M=o.slice(o.byteLength/2,o.byteLength);const R=t.exp(t.shift,S/2),P=t.inv(t.sub(t.one,R));[B,M]=await v(B,M,"prepareLagrangeEvaluation",P,t.shiftInv,h,"jacobian",y,_+" prep");const D=[];D.push(n(B,!0,"jacobian",g,y,_+" t0")),D.push(n(M,!0,"jacobian",g,y,_+" t1")),[B,M]=await Promise.all(D);let q;return B.byteLength>1<<28?q=new ee(B.byteLength*2):q=new Uint8Array(B.byteLength*2),q.set(B),q.set(M,B.byteLength),q},r.fftMix=async function(h){const g=r.F.n8*3;let y,_;if(e=="G1")y="g1m_fftMix",_="g1m_fftJoin";else if(e=="G2")y="g2m_fftMix",_="g2m_fftJoin";else if(e=="Fr")y="frm_fftMix",_="frm_fftJoin";else throw new Error("Invalid group");const A=Math.floor(h.byteLength/g),S=Ci(A);let T=1<<Ci(a.concurrency);A<=T*2&&(T=1);const B=A/T,M=Ci(B),R=[];for(let U=0;U<T;U++){const O=[],G=h.slice(U*B*g,(U+1)*B*g);O.push({cmd:"ALLOCSET",var:0,buff:G});for(let E=1;E<=M;E++)O.push({cmd:"CALL",fnName:y,params:[{var:0},{val:B},{val:E}]});O.push({cmd:"GET",out:0,var:0,len:B*g}),R.push(a.queueAction(O))}const P=await Promise.all(R),D=[];for(let U=0;U<P.length;U++)D[U]=P[U][0];for(let U=M+1;U<=S;U++){const O=1<<S-U,G=T/O,E=[];for(let l=0;l<O;l++)for(let d=0;d<G/2;d++){const p=t.exp(t.w[U],d*B),m=t.w[U],w=l*G+d,x=l*G+d+G/2,b=[];b.push({cmd:"ALLOCSET",var:0,buff:D[w]}),b.push({cmd:"ALLOCSET",var:1,buff:D[x]}),b.push({cmd:"ALLOCSET",var:2,buff:p}),b.push({cmd:"ALLOCSET",var:3,buff:m}),b.push({cmd:"CALL",fnName:_,params:[{var:0},{var:1},{val:B},{var:2},{var:3}]}),b.push({cmd:"GET",out:0,var:0,len:B*g}),b.push({cmd:"GET",out:1,var:1,len:B*g}),E.push(a.queueAction(b))}const s=await Promise.all(E);for(let l=0;l<O;l++)for(let d=0;d<G/2;d++){const p=l*G+d,m=l*G+d+G/2,w=s.shift();D[p]=w[0],D[m]=w[1]}}let q;h instanceof ee?q=new ee(A*g):q=new Uint8Array(A*g);let k=0;for(let U=0;U<T;U++)q.set(D[U],k),k+=D[U].byteLength;return q},r.fftJoin=async function(h,g,y,_){const A=r.F.n8*3;let S;if(e=="G1")S="g1m_fftJoin";else if(e=="G2")S="g2m_fftJoin";else if(e=="Fr")S="frm_fftJoin";else throw new Error("Invalid group");if(h.byteLength!=g.byteLength)throw new Error("Invalid buffer size");const T=Math.floor(h.byteLength/A);if(T!=1<<Ci(T))throw new Error("Invalid number of points");let B=1<<Ci(a.concurrency);T<=B*2&&(B=1);const M=T/B,R=[];for(let U=0;U<B;U++){const O=[],G=t.mul(y,t.exp(_,U*M)),E=h.slice(U*M*A,(U+1)*M*A),s=g.slice(U*M*A,(U+1)*M*A);O.push({cmd:"ALLOCSET",var:0,buff:E}),O.push({cmd:"ALLOCSET",var:1,buff:s}),O.push({cmd:"ALLOCSET",var:2,buff:G}),O.push({cmd:"ALLOCSET",var:3,buff:_}),O.push({cmd:"CALL",fnName:S,params:[{var:0},{var:1},{val:M},{var:2},{var:3}]}),O.push({cmd:"GET",out:0,var:0,len:M*A}),O.push({cmd:"GET",out:1,var:1,len:M*A}),R.push(a.queueAction(O))}const P=await Promise.all(R);let D,q;h instanceof ee?(D=new ee(T*A),q=new ee(T*A)):(D=new Uint8Array(T*A),q=new Uint8Array(T*A));let k=0;for(let U=0;U<P.length;U++)D.set(P[U][0],k),q.set(P[U][1],k),k+=P[U][0].byteLength;return[D,q]},r.fftFinal=async function(h,g){const y=r.F.n8*3,_=r.F.n8*2;let A,S;if(e=="G1")A="g1m_fftFinal",S="g1m_batchToAffine";else if(e=="G2")A="g2m_fftFinal",S="g2m_batchToAffine";else throw new Error("Invalid group");const T=Math.floor(h.byteLength/y);if(T!=1<<Ci(T))throw new Error("Invalid number of points");const B=Math.floor(T/a.concurrency),M=[];for(let q=0;q<a.concurrency;q++){let k;if(q<a.concurrency-1?k=B:k=T-q*B,k==0)continue;const U=[],O=h.slice(q*B*y,(q*B+k)*y);U.push({cmd:"ALLOCSET",var:0,buff:O}),U.push({cmd:"ALLOCSET",var:1,buff:g}),U.push({cmd:"CALL",fnName:A,params:[{var:0},{val:k},{var:1}]}),U.push({cmd:"CALL",fnName:S,params:[{var:0},{val:k},{var:0}]}),U.push({cmd:"GET",out:0,var:0,len:k*_}),M.push(a.queueAction(U))}const R=await Promise.all(M);let P;h instanceof ee?P=new ee(T*_):P=new Uint8Array(T*_);let D=0;for(let q=R.length-1;q>=0;q--)P.set(R[q][0],D),D+=R[q][0].byteLength;return P}}async function Ob(i){const e=await oE(i.wasm,i.singleThread),r={};return r.q=qr(i.wasm.q.toString()),r.r=qr(i.wasm.r.toString()),r.name=i.name,r.tm=e,r.prePSize=i.wasm.prePSize,r.preQSize=i.wasm.preQSize,r.Fr=new em(e,"frm",i.n8r,i.r),r.F1=new em(e,"f1m",i.n8q,i.q),r.F2=new rm(e,"f2m",r.F1),r.G1=new im(e,"g1m",r.F1,i.wasm.pG1gen,i.wasm.pG1b,i.cofactorG1),r.G2=new im(e,"g2m",r.F2,i.wasm.pG2gen,i.wasm.pG2b,i.cofactorG2),r.F6=new nE(e,"f6m",r.F2),r.F12=new rm(e,"ftm",r.F6),r.Gt=r.F12,sh(r,"G1"),sh(r,"G2"),sh(r,"Fr"),om(r,"G1"),om(r,"G2"),oh(r,"G1"),oh(r,"G2"),oh(r,"Fr"),lE(r),r.array2buffer=function(t,a){const n=new Uint8Array(a*t.length);for(let c=0;c<t.length;c++)n.set(t[c],c*a);return n},r.buffer2array=function(t,a){const n=t.byteLength/a,c=new Array(n);for(let u=0;u<n;u++)c[u]=t.slice(u*a,u*a+a);return c},r}function Ls(i){return BigInt(i)}function Fb(i){return i<0n}function cE(i){return i===0n}function uE(i){return Fb(i)?i.toString(2).length-1:i.toString(2).length}function fh(i){const e=[],r=Ls(i);return e.push(Number(r&0xFFn)),e.push(Number(r>>8n&0xFFn)),e.push(Number(r>>16n&0xFFn)),e.push(Number(r>>24n&0xFFn)),e}function hE(i){for(var e=[],r=0;r<i.length;r++){var t=i.charCodeAt(r);t<128?e.push(t):t<2048?e.push(192|t>>6,128|t&63):t<55296||t>=57344?e.push(224|t>>12,128|t>>6&63,128|t&63):(r++,t=65536+((t&1023)<<10|i.charCodeAt(r)&1023),e.push(240|t>>18,128|t>>12&63,128|t>>6&63,128|t&63))}return e}function Js(i){const e=hE(i);return[...Pe(e.length),...e]}function qb(i){const e=[];let r=Ls(i);if(Fb(r))throw new Error("Number cannot be negative");for(;!cE(r);)e.push(Number(r&0x7Fn)),r=r>>7n;e.length==0&&e.push(0);for(let t=0;t<e.length-1;t++)e[t]=e[t]|128;return e}function zb(i){let e,r;const t=uE(i);i<0?(r=!0,e=(1n<<BigInt(t))+i):(r=!1,e=Ls(i));const a=7-t%7,n=(1n<<BigInt(a))-1n<<BigInt(t),c=(1<<7-a)-1|128,u=qb(e+n);return r||(u[u.length-1]=u[u.length-1]&c),u}function rd(i){let e=Ls(i);if(e>0xFFFFFFFFn)throw new Error("Number too big");if(e>0x7FFFFFFFn&&(e=e-0x100000000n),e<-2147483648n)throw new Error("Number too small");return zb(e)}function dE(i){let e=Ls(i);if(e>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(e>0x7FFFFFFFFFFFFFFFn&&(e=e-0x10000000000000000n),e<-9223372036854775808n)throw new Error("Number too small");return zb(e)}function Pe(i){let e=Ls(i);if(e>0xFFFFFFFFn)throw new Error("Number too big");return qb(e)}function fm(i){return Array.from(i,function(e){return("0"+(e&255).toString(16)).slice(-2)}).join("")}class pE{constructor(e){this.func=e,this.functionName=e.functionName,this.module=e.module}setLocal(e,r){const t=this.func.localIdxByName[e];if(t===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${e} `);return[...r,33,...Pe(t)]}teeLocal(e,r){const t=this.func.localIdxByName[e];if(t===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${e} `);return[...r,34,...Pe(t)]}getLocal(e){const r=this.func.localIdxByName[e];if(r===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${e} `);return[32,...Pe(r)]}i64_load8_s(e,r,t){const a=r||0,n=t===void 0?0:t;return[...e,48,n,...Pe(a)]}i64_load8_u(e,r,t){const a=r||0,n=t===void 0?0:t;return[...e,49,n,...Pe(a)]}i64_load16_s(e,r,t){const a=r||0,n=t===void 0?1:t;return[...e,50,n,...Pe(a)]}i64_load16_u(e,r,t){const a=r||0,n=t===void 0?1:t;return[...e,51,n,...Pe(a)]}i64_load32_s(e,r,t){const a=r||0,n=t===void 0?2:t;return[...e,52,n,...Pe(a)]}i64_load32_u(e,r,t){const a=r||0,n=t===void 0?2:t;return[...e,53,n,...Pe(a)]}i64_load(e,r,t){const a=r||0,n=t===void 0?3:t;return[...e,41,n,...Pe(a)]}i64_store(e,r,t,a){let n,c,u;return Array.isArray(r)?(n=0,c=3,u=r):Array.isArray(t)?(n=r,c=3,u=t):Array.isArray(a)&&(n=r,c=t,u=a),[...e,...u,55,c,...Pe(n)]}i64_store32(e,r,t,a){let n,c,u;return Array.isArray(r)?(n=0,c=2,u=r):Array.isArray(t)?(n=r,c=2,u=t):Array.isArray(a)&&(n=r,c=t,u=a),[...e,...u,62,c,...Pe(n)]}i64_store16(e,r,t,a){let n,c,u;return Array.isArray(r)?(n=0,c=1,u=r):Array.isArray(t)?(n=r,c=1,u=t):Array.isArray(a)&&(n=r,c=t,u=a),[...e,...u,61,c,...Pe(n)]}i64_store8(e,r,t,a){let n,c,u;return Array.isArray(r)?(n=0,c=0,u=r):Array.isArray(t)?(n=r,c=0,u=t):Array.isArray(a)&&(n=r,c=t,u=a),[...e,...u,60,c,...Pe(n)]}i32_load8_s(e,r,t){const a=r||0,n=t===void 0?0:t;return[...e,44,n,...Pe(a)]}i32_load8_u(e,r,t){const a=r||0,n=t===void 0?0:t;return[...e,45,n,...Pe(a)]}i32_load16_s(e,r,t){const a=r||0,n=t===void 0?1:t;return[...e,46,n,...Pe(a)]}i32_load16_u(e,r,t){const a=r||0,n=t===void 0?1:t;return[...e,47,n,...Pe(a)]}i32_load(e,r,t){const a=r||0,n=t===void 0?2:t;return[...e,40,n,...Pe(a)]}i32_store(e,r,t,a){let n,c,u;return Array.isArray(r)?(n=0,c=2,u=r):Array.isArray(t)?(n=r,c=2,u=t):Array.isArray(a)&&(n=r,c=t,u=a),[...e,...u,54,c,...Pe(n)]}i32_store16(e,r,t,a){let n,c,u;return Array.isArray(r)?(n=0,c=1,u=r):Array.isArray(t)?(n=r,c=1,u=t):Array.isArray(a)&&(n=r,c=t,u=a),[...e,...u,59,c,...Pe(n)]}i32_store8(e,r,t,a){let n,c,u;return Array.isArray(r)?(n=0,c=0,u=r):Array.isArray(t)?(n=r,c=0,u=t):Array.isArray(a)&&(n=r,c=t,u=a),[...e,...u,58,c,...Pe(n)]}call(e,...r){const t=this.module.functionIdxByName[e];if(t===void 0)throw new Error(`Function not defined: Function: ${e}`);return[...[].concat(...r),16,...Pe(t)]}call_indirect(e,...r){return[...[].concat(...r),...e,17,0,0]}if(e,r,t){return t?[...e,4,64,...r,5,...t,11]:[...e,4,64,...r,11]}block(e){return[2,64,...e,11]}loop(...e){return[3,64,...[].concat(...e),11]}br_if(e,r){return[...r,13,...Pe(e)]}br(e){return[12,...Pe(e)]}ret(e){return[...e,15]}drop(e){return[...e,26]}i64_const(e){return[66,...dE(e)]}i32_const(e){return[65,...rd(e)]}i64_eqz(e){return[...e,80]}i64_eq(e,r){return[...e,...r,81]}i64_ne(e,r){return[...e,...r,82]}i64_lt_s(e,r){return[...e,...r,83]}i64_lt_u(e,r){return[...e,...r,84]}i64_gt_s(e,r){return[...e,...r,85]}i64_gt_u(e,r){return[...e,...r,86]}i64_le_s(e,r){return[...e,...r,87]}i64_le_u(e,r){return[...e,...r,88]}i64_ge_s(e,r){return[...e,...r,89]}i64_ge_u(e,r){return[...e,...r,90]}i64_add(e,r){return[...e,...r,124]}i64_sub(e,r){return[...e,...r,125]}i64_mul(e,r){return[...e,...r,126]}i64_div_s(e,r){return[...e,...r,127]}i64_div_u(e,r){return[...e,...r,128]}i64_rem_s(e,r){return[...e,...r,129]}i64_rem_u(e,r){return[...e,...r,130]}i64_and(e,r){return[...e,...r,131]}i64_or(e,r){return[...e,...r,132]}i64_xor(e,r){return[...e,...r,133]}i64_shl(e,r){return[...e,...r,134]}i64_shr_s(e,r){return[...e,...r,135]}i64_shr_u(e,r){return[...e,...r,136]}i64_extend_i32_s(e){return[...e,172]}i64_extend_i32_u(e){return[...e,173]}i64_clz(e){return[...e,121]}i64_ctz(e){return[...e,122]}i32_eqz(e){return[...e,69]}i32_eq(e,r){return[...e,...r,70]}i32_ne(e,r){return[...e,...r,71]}i32_lt_s(e,r){return[...e,...r,72]}i32_lt_u(e,r){return[...e,...r,73]}i32_gt_s(e,r){return[...e,...r,74]}i32_gt_u(e,r){return[...e,...r,75]}i32_le_s(e,r){return[...e,...r,76]}i32_le_u(e,r){return[...e,...r,77]}i32_ge_s(e,r){return[...e,...r,78]}i32_ge_u(e,r){return[...e,...r,79]}i32_add(e,r){return[...e,...r,106]}i32_sub(e,r){return[...e,...r,107]}i32_mul(e,r){return[...e,...r,108]}i32_div_s(e,r){return[...e,...r,109]}i32_div_u(e,r){return[...e,...r,110]}i32_rem_s(e,r){return[...e,...r,111]}i32_rem_u(e,r){return[...e,...r,112]}i32_and(e,r){return[...e,...r,113]}i32_or(e,r){return[...e,...r,114]}i32_xor(e,r){return[...e,...r,115]}i32_shl(e,r){return[...e,...r,116]}i32_shr_s(e,r){return[...e,...r,117]}i32_shr_u(e,r){return[...e,...r,118]}i32_rotl(e,r){return[...e,...r,119]}i32_rotr(e,r){return[...e,...r,120]}i32_wrap_i64(e){return[...e,167]}i32_clz(e){return[...e,103]}i32_ctz(e){return[...e,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}}const lh={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};class lm{constructor(e,r,t,a,n){if(t=="import")this.fnType="import",this.moduleName=a,this.fieldName=n;else if(t=="internal")this.fnType="internal";else throw new Error("Invalid function fnType: "+t);this.module=e,this.fnName=r,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(e,r){if(this.localIdxByName[e])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${e} `);const t=this.nextLocal++;this.localIdxByName[e]=t,this.params.push({type:r})}addLocal(e,r,t){const a=t||1;if(this.localIdxByName[e])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${e} `);const n=this.nextLocal++;this.localIdxByName[e]=n,this.locals.push({type:r,length:a})}setReturnType(e){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=e}getSignature(){const e=[...Pe(this.params.length),...this.params.map(t=>lh[t.type])],r=this.returnType?[1,lh[this.returnType]]:[0];return[96,...e,...r]}getBody(){const e=this.locals.map(t=>[...Pe(t.length),lh[t.type]]),r=[...Pe(this.locals.length),...[].concat(...e),...this.code,11];return[...Pe(r.length),...r]}addCode(...e){this.code.push(...[].concat(...e))}getCodeBuilder(){return new pE(this)}}class Vb{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...fh(1836278016),...fh(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(e){if(typeof this.functionIdxByName[e]<"u")throw new Error(`Function already defined: ${e}`);const r=this.functions.length;return this.functionIdxByName[e]=r,this.functions.push(new lm(this,e,"internal")),this.nInternalFunctions++,this.functions[r]}addIimportFunction(e,r,t){if(typeof this.functionIdxByName[e]<"u")throw new Error(`Function already defined: ${e}`);if(this.functions.length>0&&this.functions[this.functions.length-1].type=="internal")throw new Error(`Import functions must be declared before internal: ${e}`);let a=t||e;const n=this.functions.length;return this.functionIdxByName[e]=n,this.functions.push(new lm(this,e,"import",r,a)),this.nImportFunctions++,this.functions[n]}setMemory(e,r,t){this.memory={pagesSize:e,moduleName:r||"env",fieldName:t||"memory"}}exportFunction(e,r){const t=r||e;if(typeof this.functionIdxByName[e]>"u")throw new Error(`Function not defined: ${e}`);const a=this.functionIdxByName[e];t!=e&&(this.functionIdxByName[t]=a),this.exports.push({exportName:t,idx:a})}addFunctionToTable(e){const r=this.functionIdxByName[e];this.functionsTable.push(r)}addData(e,r){this.datas.push({offset:e,bytes:r})}alloc(e,r){let t,a;(Array.isArray(e)||ArrayBuffer.isView(e))&&typeof r>"u"?(t=e.length,a=e):(t=e,a=r),t=(t-1>>3)+1<<3;const n=this.free;return this.free+=t,a&&this.addData(n,a),n}allocString(e){const t=new globalThis.TextEncoder().encode(e);return this.alloc([...t,0])}_setSignatures(){this.signatures=[];const e={};if(this.functionsTable.length>0){const r=this.functions[this.functionsTable[0]].getSignature(),t="s_"+fm(r);e[t]=0,this.signatures.push(r)}for(let r=0;r<this.functions.length;r++){const t=this.functions[r].getSignature(),a="s_"+fm(t);typeof e[a]>"u"&&(e[a]=this.signatures.length,this.signatures.push(t)),this.functions[r].signatureIdx=e[a]}}_buildSection(e,r){return[e,...Pe(r.length),...r]}_buildType(){return this._buildSection(1,[...Pe(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){const e=[];e.push([...Js(this.memory.moduleName),...Js(this.memory.fieldName),2,0,...Pe(this.memory.pagesSize)]);for(let r=0;r<this.nImportFunctions;r++)e.push([...Js(this.functions[r].moduleName),...Js(this.functions[r].fieldName),0,...Pe(this.functions[r].signatureIdx)]);return this._buildSection(2,Pe(e.length).concat(...e))}_buildFunctionDeclarations(){const e=[];for(let r=this.nImportFunctions;r<this.nImportFunctions+this.nInternalFunctions;r++)e.push(...Pe(this.functions[r].signatureIdx));return this._buildSection(3,[...Pe(e.length),...e])}_buildFunctionsTable(){return this.functionsTable.length==0?[]:this._buildSection(4,[...Pe(1),112,0,...Pe(this.functionsTable.length)])}_buildElements(){if(this.functionsTable.length==0)return[];const e=[];for(let r=0;r<this.functionsTable.length;r++)e.push(...Pe(this.functionsTable[r]));return this._buildSection(9,[...Pe(1),...Pe(0),65,...rd(0),11,...Pe(this.functionsTable.length),...e])}_buildExports(){const e=[];for(let r=0;r<this.exports.length;r++)e.push([...Js(this.exports[r].exportName),0,...Pe(this.exports[r].idx)]);return this._buildSection(7,Pe(e.length).concat(...e))}_buildCode(){const e=[];for(let r=this.nImportFunctions;r<this.nImportFunctions+this.nInternalFunctions;r++)e.push(this.functions[r].getBody());return this._buildSection(10,Pe(e.length).concat(...e))}_buildData(){const e=[];e.push([0,65,0,11,4,...fh(this.free)]);for(let r=0;r<this.datas.length;r++)e.push([0,65,...rd(this.datas[r].offset),11,...Pe(this.datas[r].bytes.length),...this.datas[r].bytes]);return this._buildSection(11,Pe(e.length).concat(...e))}}globalThis.curve_bn128=null;async function Hl(i,e){if(!i&&globalThis.curve_bn128)return globalThis.curve_bn128;const r=new Vb;r.setMemory(25),YC(r);const t={};t.code=r.build(),t.pq=r.modules.f1m.pq,t.pr=r.modules.frm.pq,t.pG1gen=r.modules.bn128.pG1gen,t.pG1zero=r.modules.bn128.pG1zero,t.pG1b=r.modules.bn128.pG1b,t.pG2gen=r.modules.bn128.pG2gen,t.pG2zero=r.modules.bn128.pG2zero,t.pG2b=r.modules.bn128.pG2b,t.pOneT=r.modules.bn128.pOneT,t.prePSize=r.modules.bn128.prePSize,t.preQSize=r.modules.bn128.preQSize,t.n8q=32,t.n8r=32,t.q=r.modules.bn128.q,t.r=r.modules.bn128.r;const a={name:"bn128",wasm:t,q:qr("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:qr("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:qr("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!i},n=await Ob(a);return n.terminate=async function(){a.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},i||(globalThis.curve_bn128=n),n}globalThis.curve_bls12381=null;async function Ql(i,e){if(!i&&globalThis.curve_bls12381)return globalThis.curve_bls12381;const r=new Vb;r.setMemory(25),XC(r);const t={};t.code=r.build(),t.pq=r.modules.f1m.pq,t.pr=r.modules.frm.pq,t.pG1gen=r.modules.bls12381.pG1gen,t.pG1zero=r.modules.bls12381.pG1zero,t.pG1b=r.modules.bls12381.pG1b,t.pG2gen=r.modules.bls12381.pG2gen,t.pG2zero=r.modules.bls12381.pG2zero,t.pG2b=r.modules.bls12381.pG2b,t.pOneT=r.modules.bls12381.pOneT,t.prePSize=r.modules.bls12381.prePSize,t.preQSize=r.modules.bls12381.preQSize,t.n8q=48,t.n8r=32,t.q=r.modules.bls12381.q,t.r=r.modules.bls12381.r;const a={name:"bls12381",wasm:t,q:qr("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:qr("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:qr("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:qr("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!i},n=await Ob(a);return n.terminate=async function(){a.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},i||(globalThis.curve_bls12381=n),n}const vE=qr("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),gE=qr("21888242871839275222246405745257275088548364400416034343698204186575808495617");qr("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16);qr("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function mE(i,e,r){let t;if(Dn(i,gE))t=await Hl(e);else if(Dn(i,vE))t=await Ql(e);else throw new Error(`Curve not supported: ${b1(i)}`);return t}const Ae=X7,ri=iE;var Gb={};async function Kb(i,e,r,t){if(r=r||4096*64,typeof e!="number"&&["w+","wx+","r","ax+","a+"].indexOf(e)<0)throw new Error("Invalid open option");const a=await Gb.promises.open(i,e),n=await a.stat();return new yE(a,n,r,t,i)}class yE{constructor(e,r,t,a,n){for(this.fileName=n,this.fd=e,this.pos=0,this.pageSize=a||256;this.pageSize<r.blksize;)this.pageSize*=2;this.totalSize=r.size,this.totalPages=Math.floor((r.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(t/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(e){const r=this,t=new Promise((a,n)=>{r.pendingLoads.push({page:e,resolve:a,reject:n})});return r.__statusPage("After Load request: ",e),t}__statusPage(e,r){const t=[],a=this;if(!a.logHistory)return;t.push("=="+e+" "+r);let n="";for(let c=0;c<a.pendingLoads.length;c++)a.pendingLoads[c].page==r&&(n=n+" "+c);if(n&&t.push("Pending loads:"+n),typeof a.pages[r]<"u"){const c=a.pages[r];t.push("Loaded"),t.push("pendingOps: "+c.pendingOps),c.loading&&t.push("loading: "+c.loading),c.writing&&t.push("writing"),c.dirty&&t.push("dirty")}t.push("=="),a.history[r]||(a.history[r]=[]),a.history[r].push(t)}__printHistory(e){const r=this;r.history[e]||console.log("Empty History ",e),console.log("History "+e);for(let t=0;t<r.history[e].length;t++)for(let a=0;a<r.history[e][t].length;a++)console.log("-> "+r.history[e][t][a])}_triggerLoad(){const e=this;if(e.reading||e.pendingLoads.length==0)return;const r=Object.keys(e.pages),t=[];for(let u=0;u<r.length;u++){const v=e.pages[parseInt(r[u])];v.dirty==!1&&v.pendingOps==0&&!v.writing&&!v.loading&&t.push(parseInt(r[u]))}let a=e.maxPagesLoaded-r.length;const n=[];for(;e.pendingLoads.length>0&&(typeof e.pages[e.pendingLoads[0].page]<"u"||a>0||t.length>0);){const u=e.pendingLoads.shift();if(typeof e.pages[u.page]<"u"){e.pages[u.page].pendingOps++;const v=t.indexOf(u.page);v>=0&&t.splice(v,1),e.pages[u.page].loading?e.pages[u.page].loading.push(u):u.resolve(),e.__statusPage("After Load (cached): ",u.page)}else{if(a)a--;else{const v=t.shift();e.__statusPage("Before Unload: ",v),e.avBuffs.unshift(e.pages[v]),delete e.pages[v],e.__statusPage("After Unload: ",v)}u.page>=e.totalPages?(e.pages[u.page]=c(),u.resolve(),e.__statusPage("After Load (new): ",u.page)):(e.reading=!0,e.pages[u.page]=c(),e.pages[u.page].loading=[u],n.push(e.fd.read(e.pages[u.page].buff,0,e.pageSize,u.page*e.pageSize).then(v=>{e.pages[u.page].size=v.bytesRead;const o=e.pages[u.page].loading;delete e.pages[u.page].loading;for(let h=0;h<o.length;h++)o[h].resolve();return e.__statusPage("After Load (loaded): ",u.page),v},v=>{u.reject(v)})),e.__statusPage("After Load (loading): ",u.page))}}Promise.all(n).then(()=>{e.reading=!1,e.pendingLoads.length>0&&setImmediate(e._triggerLoad.bind(e)),e._tryClose()});function c(){if(e.avBuffs.length>0){const u=e.avBuffs.shift();return u.dirty=!1,u.pendingOps=1,u.size=0,u}else return{dirty:!1,buff:new Uint8Array(e.pageSize),pendingOps:1,size:0}}}_triggerWrite(){const e=this;if(e.writing)return;const r=Object.keys(e.pages),t=[];for(let a=0;a<r.length;a++){const n=e.pages[parseInt(r[a])];n.dirty&&(n.dirty=!1,n.writing=!0,e.writing=!0,t.push(e.fd.write(n.buff,0,n.size,parseInt(r[a])*e.pageSize).then(()=>{n.writing=!1},c=>{console.log("ERROR Writing: "+c),e.error=c,e._tryClose()})))}e.writing&&Promise.all(t).then(()=>{e.writing=!1,setImmediate(e._triggerWrite.bind(e)),e._tryClose(),e.pendingLoads.length>0&&setImmediate(e._triggerLoad.bind(e))})}_getDirtyPage(){for(let e in this.pages)if(this.pages[e].dirty)return e;return-1}async write(e,r){if(e.byteLength==0)return;const t=this;if(typeof r>"u"&&(r=t.pos),t.pos=r+e.byteLength,t.totalSize<r+e.byteLength&&(t.totalSize=r+e.byteLength),t.pendingClose)throw new Error("Writing a closing file");const a=Math.floor(r/t.pageSize),n=Math.floor((r+e.byteLength-1)/t.pageSize),c=[];for(let h=a;h<=n;h++)c.push(t._loadPage(h));t._triggerLoad();let u=a,v=r%t.pageSize,o=e.byteLength;for(;o>0;){await c[u-a];const h=v+o>t.pageSize?t.pageSize-v:o,g=e.slice(e.byteLength-o,e.byteLength-o+h);new Uint8Array(t.pages[u].buff.buffer,v,h).set(g),t.pages[u].dirty=!0,t.pages[u].pendingOps--,t.pages[u].size=Math.max(v+h,t.pages[u].size),u>=t.totalPages&&(t.totalPages=u+1),o=o-h,u++,v=0,t.writing||setImmediate(t._triggerWrite.bind(t))}}async read(e,r){const t=this;let a=new Uint8Array(e);return await t.readToBuffer(a,0,e,r),a}async readToBuffer(e,r,t,a){if(t==0)return;const n=this;if(t>n.pageSize*n.maxPagesLoaded*.8){const y=Math.floor(t*1.1);this.maxPagesLoaded=Math.floor(y/n.pageSize)+1}if(typeof a>"u"&&(a=n.pos),n.pos=a+t,n.pendingClose)throw new Error("Reading a closing file");const c=Math.floor(a/n.pageSize),u=Math.floor((a+t-1)/n.pageSize),v=[];for(let y=c;y<=u;y++)v.push(n._loadPage(y));n._triggerLoad();let o=c,h=a%n.pageSize,g=a+t>n.totalSize?t-(a+t-n.totalSize):t;for(;g>0;){await v[o-c],n.__statusPage("After Await (read): ",o);const y=h+g>n.pageSize?n.pageSize-h:g,_=new Uint8Array(n.pages[o].buff.buffer,n.pages[o].buff.byteOffset+h,y);e.set(_,r+t-g),n.pages[o].pendingOps--,n.__statusPage("After Op done: ",o),g=g-y,o++,h=0,n.pendingLoads.length>0&&setImmediate(n._triggerLoad.bind(n))}this.pos=a+t}_tryClose(){const e=this;!e.pendingClose||(e.error&&e.pendingCloseReject(e.error),e._getDirtyPage()>=0||e.writing||e.reading||e.pendingLoads.length>0)||e.pendingClose()}close(){const e=this;if(e.pendingClose)throw new Error("Closing the file twice");return new Promise((r,t)=>{e.pendingClose=r,e.pendingCloseReject=t,e._tryClose()}).then(()=>{e.fd.close()},r=>{throw e.fd.close(),r})}async discard(){await this.close(),await Gb.promises.unlink(this.fileName)}async writeULE32(e,r){const t=this,a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,e,!0),await t.write(a,r)}async writeUBE32(e,r){const t=this,a=new Uint8Array(4);new DataView(a.buffer).setUint32(0,e,!1),await t.write(a,r)}async writeULE64(e,r){const t=this,a=new Uint8Array(8),n=new DataView(a.buffer);n.setUint32(0,e&4294967295,!0),n.setUint32(4,Math.floor(e/4294967296),!0),await t.write(a,r)}async readULE32(e){const t=await this.read(4,e);return new Uint32Array(t.buffer)[0]}async readUBE32(e){const t=await this.read(4,e);return new DataView(t.buffer).getUint32(0,!1)}async readULE64(e){const t=await this.read(8,e),a=new Uint32Array(t.buffer);return a[1]*4294967296+a[0]}async readString(e){const r=this;if(r.pendingClose)throw new Error("Reading a closing file");let t=typeof e>"u"?r.pos:e,a=Math.floor(t/r.pageSize),n=!1,c="";for(;!n;){let u=r._loadPage(a);r._triggerLoad(),await u,r.__statusPage("After Await (read): ",a);let v=t%r.pageSize;const o=new Uint8Array(r.pages[a].buff.buffer,r.pages[a].buff.byteOffset+v,r.pageSize-v);let h=o.findIndex(g=>g===0);n=h!==-1,n?(c+=new TextDecoder().decode(o.slice(0,h)),r.pos=a*this.pageSize+v+h+1):(c+=new TextDecoder().decode(o),r.pos=a*this.pageSize+v+o.length),r.pages[a].pendingOps--,r.__statusPage("After Op done: ",a),t=r.pos,a++,r.pendingLoads.length>0&&setImmediate(r._triggerLoad.bind(r))}return c}}function bE(i){const e=i.initialSize||1048576,r=new Qb;return r.o=i,r.o.data=new Uint8Array(e),r.allocSize=e,r.totalSize=0,r.readOnly=!1,r.pos=0,r}function _E(i){const e=new Qb;return e.o=i,e.allocSize=i.data.byteLength,e.totalSize=i.data.byteLength,e.readOnly=!0,e.pos=0,e}const id=new Uint8Array(4),cm=new DataView(id.buffer),Hb=new Uint8Array(8),um=new DataView(Hb.buffer);class Qb{constructor(){this.pageSize=16384}_resizeIfNeeded(e){if(e>this.allocSize){const r=Math.max(this.allocSize+1048576,Math.floor(this.allocSize*1.1),e),t=new Uint8Array(r);t.set(this.o.data),this.o.data=t,this.allocSize=r}}async write(e,r){if(typeof r>"u"&&(r=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(r+e.byteLength),this.o.data.set(e.slice(),r),r+e.byteLength>this.totalSize&&(this.totalSize=r+e.byteLength),this.pos=r+e.byteLength}async readToBuffer(e,r,t,a){if(typeof a>"u"&&(a=this.pos),this.readOnly&&a+t>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(a+t);const c=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+a,t);e.set(c,r),this.pos=a+t}async read(e,r){const t=this,a=new Uint8Array(e);return await t.readToBuffer(a,0,e,r),a}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(e,r){const t=this;cm.setUint32(0,e,!0),await t.write(id,r)}async writeUBE32(e,r){const t=this;cm.setUint32(0,e,!1),await t.write(id,r)}async writeULE64(e,r){const t=this;um.setUint32(0,e&4294967295,!0),um.setUint32(4,Math.floor(e/4294967296),!0),await t.write(Hb,r)}async readULE32(e){const t=await this.read(4,e);return new Uint32Array(t.buffer)[0]}async readUBE32(e){const t=await this.read(4,e);return new DataView(t.buffer).getUint32(0,!1)}async readULE64(e){const t=await this.read(8,e),a=new Uint32Array(t.buffer);return a[1]*4294967296+a[0]}async readString(e){const r=this;let t=typeof e>"u"?r.pos:e;if(t>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(e)}const a=new Uint8Array(r.o.data.buffer,t,this.totalSize-t);let n=a.findIndex(v=>v===0),c=n!==-1,u="";return c?(u=new TextDecoder().decode(a.slice(0,n)),r.pos=t+n+1):r.pos=t,u}}const Kr=1<<22;function wE(i){const e=i.initialSize||0,r=new Zb;r.o=i;const t=e?Math.floor((e-1)/Kr)+1:0;r.o.data=[];for(let a=0;a<t-1;a++)r.o.data.push(new Uint8Array(Kr));return t&&r.o.data.push(new Uint8Array(e-Kr*(t-1))),r.totalSize=0,r.readOnly=!1,r.pos=0,r}function CE(i){const e=new Zb;return e.o=i,e.totalSize=(i.data.length-1)*Kr+i.data[i.data.length-1].byteLength,e.readOnly=!0,e.pos=0,e}const nd=new Uint8Array(4),hm=new DataView(nd.buffer),$b=new Uint8Array(8),dm=new DataView($b.buffer);class Zb{constructor(){this.pageSize=16384}_resizeIfNeeded(e){if(e<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");const r=Math.floor((e-1)/Kr)+1;for(let t=Math.max(this.o.data.length-1,0);t<r;t++){const a=t<r-1?Kr:e-(r-1)*Kr,n=new Uint8Array(a);t==this.o.data.length-1&&n.set(this.o.data[t]),this.o.data[t]=n}this.totalSize=e}async write(e,r){const t=this;if(typeof r>"u"&&(r=t.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(r+e.byteLength);let n=Math.floor(r/Kr),c=r%Kr,u=e.byteLength;for(;u>0;){const v=c+u>Kr?Kr-c:u,o=e.slice(e.byteLength-u,e.byteLength-u+v);new Uint8Array(t.o.data[n].buffer,c,v).set(o),u=u-v,n++,c=0}this.pos=r+e.byteLength}async readToBuffer(e,r,t,a){const n=this;if(typeof a>"u"&&(a=n.pos),this.readOnly&&a+t>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(a+t);let u=Math.floor(a/Kr),v=a%Kr,o=t;for(;o>0;){const h=v+o>Kr?Kr-v:o,g=new Uint8Array(n.o.data[u].buffer,v,h);e.set(g,r+t-o),o=o-h,u++,v=0}this.pos=a+t}async read(e,r){const t=this,a=new Uint8Array(e);return await t.readToBuffer(a,0,e,r),a}close(){}async discard(){}async writeULE32(e,r){const t=this;hm.setUint32(0,e,!0),await t.write(nd,r)}async writeUBE32(e,r){const t=this;hm.setUint32(0,e,!1),await t.write(nd,r)}async writeULE64(e,r){const t=this;dm.setUint32(0,e&4294967295,!0),dm.setUint32(4,Math.floor(e/4294967296),!0),await t.write($b,r)}async readULE32(e){const t=await this.read(4,e);return new Uint32Array(t.buffer)[0]}async readUBE32(e){const t=await this.read(4,e);return new DataView(t.buffer).getUint32(0,!1)}async readULE64(e){const t=await this.read(8,e),a=new Uint32Array(t.buffer);return a[1]*4294967296+a[0]}async readString(e){const r=this,t=2048;let a=typeof e>"u"?r.pos:e;if(a>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(e)}let n=!1,c="";for(;!n;){let u=Math.floor(a/Kr),v=a%Kr;if(r.o.data[u]===void 0)throw new Error("ERROR");let o=Math.min(t,r.o.data[u].length-v);const h=new Uint8Array(r.o.data[u].buffer,v,o);let g=h.findIndex(y=>y===0);n=g!==-1,n?(c+=new TextDecoder().decode(h.slice(0,g)),r.pos=u*Kr+v+g+1):(c+=new TextDecoder().decode(h),r.pos=u*Kr+v+h.length),a=r.pos}return c}}const EE=1024,AE=512,SE=2,xE=0,IE=65536,ME=8192;async function Ts(i,e,r){if(typeof i=="string"&&(i={type:"file",fileName:i,cacheSize:e||IE,pageSize:r||ME}),i.type=="file")return await Kb(i.fileName,EE|AE|SE,i.cacheSize,i.pageSize);if(i.type=="mem")return bE(i);if(i.type=="bigMem")return wE(i);throw new Error("Invalid FastFile type: "+i.type)}async function Ca(i,e,r){if(i instanceof Uint8Array&&(i={type:"mem",data:i}),typeof i=="string"&&(i={type:"mem",data:await fetch(i).then(function(a){return a.arrayBuffer()}).then(function(a){return new Uint8Array(a)})}),i.type=="file")return await Kb(i.fileName,xE,i.cacheSize,i.pageSize);if(i.type=="mem")return await _E(i);if(i.type=="bigMem")return await CE(i);throw new Error("Invalid FastFile type: "+i.type)}async function gr(i,e,r,t,a){const n=await Ca(i),c=await n.read(4);let u="";for(let g=0;g<4;g++)u+=String.fromCharCode(c[g]);if(u!=e)throw new Error(i+": Invalid File format");if(await n.readULE32()>r)throw new Error("Version not supported");const o=await n.readULE32();let h=[];for(let g=0;g<o;g++){let y=await n.readULE32(),_=await n.readULE64();typeof h[y]>"u"&&(h[y]=[]),h[y].push({p:n.pos,size:_}),n.pos+=_}return{fd:n,sections:h}}async function bi(i,e,r,t,a,n){const c=await Ts(i,a,n),u=new Uint8Array(4);for(let v=0;v<4;v++)u[v]=e.charCodeAt(v);return await c.write(u,0),await c.writeULE32(r),await c.writeULE32(t),c}async function Oe(i,e){if(typeof i.writingSection<"u")throw new Error("Already writing a section");await i.writeULE32(e),i.writingSection={pSectionSize:i.pos},await i.writeULE64(0)}async function Fe(i){if(typeof i.writingSection>"u")throw new Error("Not writing a section");const e=i.pos-i.writingSection.pSectionSize-8,r=i.pos;i.pos=i.writingSection.pSectionSize,await i.writeULE64(e),i.pos=r,delete i.writingSection}async function yr(i,e,r){if(typeof i.readingSection<"u")throw new Error("Already reading a section");if(!e[r])throw new Error(i.fileName+": Missing section "+r);if(e[r].length>1)throw new Error(i.fileName+": Section Duplicated "+r);i.pos=e[r][0].p,i.readingSection=e[r][0]}async function br(i,e){if(typeof i.readingSection>"u")throw new Error("Not reading a section");if(!e&&i.pos-i.readingSection.p!=i.readingSection.size)throw new Error("Invalid section size reading");delete i.readingSection}async function nn(i,e,r,t){const a=new Uint8Array(r);Ae.toRprLE(a,0,e,r),await i.write(a,t)}async function Sn(i,e,r){const t=await i.read(e,r);return Ae.fromRprLE(t,0,e)}async function tr(i,e,r,t,a){typeof a>"u"&&(a=e[t][0].size);const n=i.pageSize;await yr(i,e,t),await Oe(r,t);for(let c=0;c<a;c+=n){const u=Math.min(a-c,n),v=await i.read(u);await r.write(v)}await Fe(r),await br(i,a!=e[t][0].size)}async function fr(i,e,r,t,a){if(t=typeof t>"u"?0:t,a=typeof a>"u"?e[r][0].size-t:a,t+a>e[r][0].size)throw new Error("Reading out of the range of the section");let n;return a<1<<30?n=new Uint8Array(a):n=new ee(a),await i.readToBuffer(n,0,a,e[r][0].p+t),n}async function to(i,e,r,t,a){const n=i.pageSize*16;if(await yr(i,e,a),await yr(r,t,a),e[a][0].size!=t[a][0].size)return!1;const c=e[a][0].size;for(let u=0;u<c;u+=n){const v=Math.min(c-u,n),o=await i.read(v),h=await r.read(v);for(let g=0;g<v;g++)if(o[g]!=h[g])return!1}return await br(i),await br(r),!0}const BE=Ae.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),LE=Ae.e("21888242871839275222246405745257275088548364400416034343698204186575808495617"),TE=Ae.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),RE=Ae.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function jb(i,e){let r,t=e&&e.singleThread;if(Ae.eq(i,LE))r=await Hl(t);else if(Ae.eq(i,BE))r=await Ql(t);else throw new Error(`Curve not supported: ${Ae.toString(i)}`);return r}async function _i(i,e){let r,t=e&&e.singleThread;if(Ae.eq(i,RE))r=await Hl(t);else if(Ae.eq(i,TE))r=await Ql(t);else throw new Error(`Curve not supported: ${Ae.toString(i)}`);return r}async function Za(i,e){let r,t=e&&e.singleThread;const a=n(i);if(["BN128","BN254","ALTBN128"].indexOf(a)>=0)r=await Hl(t);else if(["BLS12381"].indexOf(a)>=0)r=await Ql(t);else throw new Error(`Curve not supported: ${i}`);return r;function n(c){return c.toUpperCase().match(/[A-Za-z0-9]+/g).join("")}}var NE=Object.freeze({__proto__:null,getCurveFromR:jb,getCurveFromQ:_i,getCurveFromName:Za}),kE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},Te={exports:{}},PE=Yb;class Wb extends Error{}Wb.prototype.name="AssertionError";function Yb(i,e){if(!i){var r=new Wb(e);throw Error.captureStackTrace&&Error.captureStackTrace(r,Yb),r}}var ad={exports:{}};function Xb(i){return i.length}function UE(i){const e=i.byteLength;let r="";for(let t=0;t<e;t++)r+=String.fromCharCode(i[t]);return r}function DE(i,e,r=0,t=Xb(e)){const a=Math.min(t,i.byteLength-r);for(let n=0;n<a;n++)i[r+n]=e.charCodeAt(n);return a}var OE={byteLength:Xb,toString:UE,write:DE};const fs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pa=new Uint8Array(256);for(let i=0;i<fs.length;i++)Pa[fs.charCodeAt(i)]=i;Pa[45]=62;Pa[95]=63;function Jb(i){let e=i.length;return i.charCodeAt(e-1)===61&&e--,e>1&&i.charCodeAt(e-1)===61&&e--,e*3>>>2}function FE(i){const e=i.byteLength;let r="";for(let t=0;t<e;t+=3)r+=fs[i[t]>>2]+fs[(i[t]&3)<<4|i[t+1]>>4]+fs[(i[t+1]&15)<<2|i[t+2]>>6]+fs[i[t+2]&63];return e%3===2?r=r.substring(0,r.length-1)+"=":e%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function qE(i,e,r=0,t=Jb(e)){const a=Math.min(t,i.byteLength-r);for(let n=0,c=0;c<a;n+=4){const u=Pa[e.charCodeAt(n)],v=Pa[e.charCodeAt(n+1)],o=Pa[e.charCodeAt(n+2)],h=Pa[e.charCodeAt(n+3)];i[c++]=u<<2|v>>4,i[c++]=(v&15)<<4|o>>2,i[c++]=(o&3)<<6|h&63}return a}var zE={byteLength:Jb,toString:FE,write:qE};function t6(i){return i.length>>>1}function VE(i){const e=i.byteLength;i=new DataView(i.buffer,i.byteOffset,e);let r="",t=0;for(let a=e-e%4;t<a;t+=4)r+=i.getUint32(t).toString(16).padStart(8,"0");for(;t<e;t++)r+=i.getUint8(t).toString(16).padStart(2,"0");return r}function GE(i,e,r=0,t=t6(e)){const a=Math.min(t,i.byteLength-r);for(let n=0;n<a;n++){const c=pm(e.charCodeAt(n*2)),u=pm(e.charCodeAt(n*2+1));if(c===void 0||u===void 0)return i.subarray(0,n);i[r+n]=c<<4|u}return a}var KE={byteLength:t6,toString:VE,write:GE};function pm(i){if(i>=48&&i<=57)return i-48;if(i>=65&&i<=70)return i-65+10;if(i>=97&&i<=102)return i-97+10}function sd(i){let e=0;for(let r=0,t=i.length;r<t;r++){const a=i.charCodeAt(r);if(a>=55296&&a<=56319&&r+1<t){const n=i.charCodeAt(r+1);if(n>=56320&&n<=57343){e+=4,r++;continue}}a<=127?e+=1:a<=2047?e+=2:e+=3}return e}let od;if(typeof TextDecoder<"u"){const i=new TextDecoder;od=function(r){return i.decode(r)}}else od=function(e){const r=e.byteLength;let t="",a=0;for(;a<r;){let n=e[a];if(n<=127){t+=String.fromCharCode(n),a++;continue}let c=0,u=0;if(n<=223?(c=1,u=n&31):n<=239?(c=2,u=n&15):n<=244&&(c=3,u=n&7),r-a-c>0){let v=0;for(;v<c;)n=e[a+v+1],u=u<<6|n&63,v+=1}else u=65533,c=r-a;t+=String.fromCodePoint(u),a+=c+1}return t};let fd;if(typeof TextEncoder<"u"){const i=new TextEncoder;fd=function(r,t,a=0,n=sd(t)){const c=Math.min(n,r.byteLength-a);return i.encodeInto(t,r.subarray(a,a+c)),c}}else fd=function(e,r,t=0,a=sd(r)){const n=Math.min(a,e.byteLength-t);e=e.subarray(t,t+n);let c=0,u=0;for(;c<r.length;){const v=r.codePointAt(c);if(v<=127){e[u++]=v,c++;continue}let o=0,h=0;for(v<=2047?(o=6,h=192):v<=65535?(o=12,h=224):v<=2097151&&(o=18,h=240),e[u++]=h|v>>o,o-=6;o>=0;)e[u++]=128|v>>o&63,o-=6;c+=v>=65536?2:1}return n};var HE={byteLength:sd,toString:od,write:fd};function e6(i){return i.length*2}function QE(i){const e=i.byteLength;let r="";for(let t=0;t<e-1;t+=2)r+=String.fromCharCode(i[t]+i[t+1]*256);return r}function $E(i,e,r=0,t=e6(e)){const a=Math.min(t,i.byteLength-r);let n=a;for(let c=0;c<e.length&&!((n-=2)<0);++c){const u=e.charCodeAt(c),v=u>>8,o=u%256;i[r+c*2]=o,i[r+c*2+1]=v}return a}var ZE={byteLength:e6,toString:QE,write:$E};(function(i,e){const r=OE,t=zE,a=KE,n=HE,c=ZE,u=new Uint8Array(Uint16Array.of(255).buffer)[0]===255;function v(N){switch(N){case"ascii":return r;case"base64":return t;case"hex":return a;case"utf8":case"utf-8":case void 0:return n;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c;default:throw new Error(`Unknown encoding: ${N}`)}}function o(N){return N instanceof Uint8Array}function h(N){try{return v(N),!0}catch{return!1}}function g(N,X,Q){const L=new Uint8Array(N);return X!==void 0&&e.fill(L,X,0,L.byteLength,Q),L}function y(N){return new Uint8Array(N)}function _(N){return new Uint8Array(N)}function A(N,X){return v(X).byteLength(N)}function S(N,X){if(N===X)return 0;const Q=Math.min(N.byteLength,X.byteLength);N=new DataView(N.buffer,N.byteOffset,N.byteLength),X=new DataView(X.buffer,X.byteOffset,X.byteLength);let L=0;for(let V=Q-Q%4;L<V;L+=4){const Z=N.getUint32(L,u),H=X.getUint32(L,u);if(Z!==H)break}for(;L<Q;L++){const V=N.getUint8(L),Z=X.getUint8(L);if(V<Z)return-1;if(V>Z)return 1}return N.byteLength>X.byteLength?1:N.byteLength<X.byteLength?-1:0}function T(N,X){X===void 0&&(X=N.reduce((V,Z)=>V+Z.byteLength,0));const Q=new Uint8Array(X);let L=0;for(const V of N){if(L+V.byteLength>Q.byteLength){const Z=V.subarray(0,Q.byteLength-L);return Q.set(Z,L),Q}Q.set(V,L),L+=V.byteLength}return Q}function B(N,X,Q=0,L=0,V=N.byteLength){if(V>0&&V<L||V===L||N.byteLength===0||X.byteLength===0)return 0;if(Q<0)throw new RangeError("targetStart is out of range");if(L<0||L>=N.byteLength)throw new RangeError("sourceStart is out of range");if(V<0)throw new RangeError("sourceEnd is out of range");Q>=X.byteLength&&(Q=X.byteLength),V>N.byteLength&&(V=N.byteLength),X.byteLength-Q<V-L&&(V=X.length-Q+L);const Z=V-L;return N===X?X.copyWithin(Q,L,V):X.set(N.subarray(L,V),Q),Z}function M(N,X){if(N===X)return!0;if(N.byteLength!==X.byteLength)return!1;const Q=N.byteLength;N=new DataView(N.buffer,N.byteOffset,N.byteLength),X=new DataView(X.buffer,X.byteOffset,X.byteLength);let L=0;for(let V=Q-Q%4;L<V;L+=4)if(N.getUint32(L,u)!==X.getUint32(L,u))return!1;for(;L<Q;L++)if(N.getUint8(L)!==X.getUint8(L))return!1;return!0}function R(N,X,Q,L,V){if(typeof X=="string"?typeof Q=="string"?(V=Q,Q=0,L=N.byteLength):typeof L=="string"&&(V=L,L=N.byteLength):typeof X=="number"?X=X&255:typeof X=="boolean"&&(X=+X),Q<0||N.byteLength<Q||N.byteLength<L)throw new RangeError("Out of range index");if(Q===void 0&&(Q=0),L===void 0&&(L=N.byteLength),L<=Q)return N;if(X||(X=0),typeof X=="number")for(let Z=Q;Z<L;++Z)N[Z]=X;else{X=o(X)?X:P(X,V);const Z=X.byteLength;for(let H=0;H<L-Q;++H)N[H+Q]=X[H%Z]}return N}function P(N,X,Q){return typeof N=="string"?D(N,X):Array.isArray(N)?q(N):ArrayBuffer.isView(N)?k(N):U(N,X,Q)}function D(N,X){const Q=v(X),L=new Uint8Array(Q.byteLength(N));return Q.write(L,N,0,L.byteLength),L}function q(N){const X=new Uint8Array(N.length);return X.set(N),X}function k(N){const X=new Uint8Array(N.byteLength);return X.set(N),X}function U(N,X,Q){return new Uint8Array(N,X,Q)}function O(N,X,Q,L){return E(N,X,Q,L)!==-1}function G(N,X,Q,L,V){if(N.byteLength===0)return-1;if(typeof Q=="string"?(L=Q,Q=0):Q===void 0?Q=V?0:N.length-1:Q<0&&(Q+=N.byteLength),Q>=N.byteLength){if(V)return-1;Q=N.byteLength-1}else if(Q<0)if(V)Q=0;else return-1;if(typeof X=="string")X=P(X,L);else if(typeof X=="number")return X=X&255,V?N.indexOf(X,Q):N.lastIndexOf(X,Q);if(X.byteLength===0)return-1;if(V){let Z=-1;for(let H=Q;H<N.byteLength;H++)if(N[H]===X[Z===-1?0:H-Z]){if(Z===-1&&(Z=H),H-Z+1===X.byteLength)return Z}else Z!==-1&&(H-=H-Z),Z=-1}else{Q+X.byteLength>N.byteLength&&(Q=N.byteLength-X.byteLength);for(let Z=Q;Z>=0;Z--){let H=!0;for(let j=0;j<X.byteLength;j++)if(N[Z+j]!==X[j]){H=!1;break}if(H)return Z}}return-1}function E(N,X,Q,L){return G(N,X,Q,L,!0)}function s(N,X,Q,L){return G(N,X,Q,L,!1)}function l(N,X,Q){const L=N[X];N[X]=N[Q],N[Q]=L}function d(N){const X=N.byteLength;if(X%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Q=0;Q<X;Q+=2)l(N,Q,Q+1);return N}function p(N){const X=N.byteLength;if(X%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Q=0;Q<X;Q+=4)l(N,Q,Q+3),l(N,Q+1,Q+2);return N}function m(N){const X=N.byteLength;if(X%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Q=0;Q<X;Q+=8)l(N,Q,Q+7),l(N,Q+1,Q+6),l(N,Q+2,Q+5),l(N,Q+3,Q+4);return N}function w(N){return N}function x(N,X,Q=0,L=N.byteLength){const V=N.byteLength;return Q>=V||L<=Q?"":(Q<0&&(Q=0),L>V&&(L=V),(Q!==0||L<V)&&(N=N.subarray(Q,L)),v(X).toString(N))}function b(N,X,Q,L,V){return Q===void 0?V="utf8":L===void 0&&typeof Q=="string"?(V=Q,Q=void 0):V===void 0&&typeof L=="string"&&(V=L,L=void 0),v(V).write(N,X,Q,L)}function f(N,X,Q){return Q===void 0&&(Q=0),new DataView(N.buffer,N.byteOffset,N.byteLength).setFloat64(Q,X,!0),Q+8}function C(N,X,Q){return Q===void 0&&(Q=0),new DataView(N.buffer,N.byteOffset,N.byteLength).setFloat32(Q,X,!0),Q+4}function F(N,X,Q){return Q===void 0&&(Q=0),new DataView(N.buffer,N.byteOffset,N.byteLength).setUint32(Q,X,!0),Q+4}function z(N,X,Q){return Q===void 0&&(Q=0),new DataView(N.buffer,N.byteOffset,N.byteLength).setInt32(Q,X,!0),Q+4}function W(N,X){return X===void 0&&(X=0),new DataView(N.buffer,N.byteOffset,N.byteLength).getFloat64(X,!0)}function $(N,X){return X===void 0&&(X=0),new DataView(N.buffer,N.byteOffset,N.byteLength).getFloat32(X,!0)}function I(N,X){return X===void 0&&(X=0),new DataView(N.buffer,N.byteOffset,N.byteLength).getUint32(X,!0)}function K(N,X){return X===void 0&&(X=0),new DataView(N.buffer,N.byteOffset,N.byteLength).getInt32(X,!0)}i.exports=e={isBuffer:o,isEncoding:h,alloc:g,allocUnsafe:y,allocUnsafeSlow:_,byteLength:A,compare:S,concat:T,copy:B,equals:M,fill:R,from:P,includes:O,indexOf:E,lastIndexOf:s,swap16:d,swap32:p,swap64:m,toBuffer:w,toString:x,write:b,writeDoubleLE:f,writeFloatLE:C,writeUInt32LE:F,writeInt32LE:z,readDoubleLE:W,readFloatLE:$,readUInt32LE:I,readInt32LE:K}})(ad,ad.exports);var ch,vm;function jE(){if(vm)return ch;vm=1;var i=(n,c)=>function(){return c||(0,n[Object.keys(n)[0]])((c={exports:{}}).exports,c),c.exports},e=(()=>{for(var n=new Uint8Array(128),c=0;c<64;c++)n[c<26?c+65:c<52?c+71:c<62?c-4:c*4-205]=c;return u=>{for(var v=u.length,o=new Uint8Array((v-(u[v-1]=="=")-(u[v-2]=="="))*3/4|0),h=0,g=0;h<v;){var y=n[u.charCodeAt(h++)],_=n[u.charCodeAt(h++)],A=n[u.charCodeAt(h++)],S=n[u.charCodeAt(h++)];o[g++]=y<<2|_>>4,o[g++]=_<<4|A>>2,o[g++]=A<<6|S}return o}})(),r=i({"wasm-binary:./blake2b.wat"(n,c){c.exports=e("AGFzbQEAAAABEANgAn9/AGADf39/AGABfwADBQQAAQICBQUBAQroBwdNBQZtZW1vcnkCAAxibGFrZTJiX2luaXQAAA5ibGFrZTJiX3VwZGF0ZQABDWJsYWtlMmJfZmluYWwAAhBibGFrZTJiX2NvbXByZXNzAAMKvz8EwAIAIABCADcDACAAQgA3AwggAEIANwMQIABCADcDGCAAQgA3AyAgAEIANwMoIABCADcDMCAAQgA3AzggAEIANwNAIABCADcDSCAAQgA3A1AgAEIANwNYIABCADcDYCAAQgA3A2ggAEIANwNwIABCADcDeCAAQoiS853/zPmE6gBBACkDAIU3A4ABIABCu86qptjQ67O7f0EIKQMAhTcDiAEgAEKr8NP0r+68tzxBECkDAIU3A5ABIABC8e30+KWn/aelf0EYKQMAhTcDmAEgAELRhZrv+s+Uh9EAQSApAwCFNwOgASAAQp/Y+dnCkdqCm39BKCkDAIU3A6gBIABC6/qG2r+19sEfQTApAwCFNwOwASAAQvnC+JuRo7Pw2wBBOCkDAIU3A7gBIABCADcDwAEgAEIANwPIASAAQgA3A9ABC20BA38gAEHAAWohAyAAQcgBaiEEIAQpAwCnIQUCQANAIAEgAkYNASAFQYABRgRAIAMgAykDACAFrXw3AwBBACEFIAAQAwsgACAFaiABLQAAOgAAIAVBAWohBSABQQFqIQEMAAsLIAQgBa03AwALYQEDfyAAQcABaiEBIABByAFqIQIgASABKQMAIAIpAwB8NwMAIABCfzcD0AEgAikDAKchAwJAA0AgA0GAAUYNASAAIANqQQA6AAAgA0EBaiEDDAALCyACIAOtNwMAIAAQAwuqOwIgfgl/IABBgAFqISEgAEGIAWohIiAAQZABaiEjIABBmAFqISQgAEGgAWohJSAAQagBaiEmIABBsAFqIScgAEG4AWohKCAhKQMAIQEgIikDACECICMpAwAhAyAkKQMAIQQgJSkDACEFICYpAwAhBiAnKQMAIQcgKCkDACEIQoiS853/zPmE6gAhCUK7zqqm2NDrs7t/IQpCq/DT9K/uvLc8IQtC8e30+KWn/aelfyEMQtGFmu/6z5SH0QAhDUKf2PnZwpHagpt/IQ5C6/qG2r+19sEfIQ9C+cL4m5Gjs/DbACEQIAApAwAhESAAKQMIIRIgACkDECETIAApAxghFCAAKQMgIRUgACkDKCEWIAApAzAhFyAAKQM4IRggACkDQCEZIAApA0ghGiAAKQNQIRsgACkDWCEcIAApA2AhHSAAKQNoIR4gACkDcCEfIAApA3ghICANIAApA8ABhSENIA8gACkD0AGFIQ8gASAFIBF8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSASfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgE3x8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBR8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAVfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgFnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBd8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAYfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgGXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBp8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAbfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgHHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIB18fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAefHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgH3x8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFICB8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAffHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgG3x8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBV8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAZfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgGnx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHICB8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAefHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggF3x8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBJ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAdfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgEXx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBN8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAcfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGHx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBZ8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAUfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgHHx8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBl8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAdfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgEXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBZ8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByATfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggIHx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIB58fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAbfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgH3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBR8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAXfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggGHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBJ8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAafHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFXx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBh8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAafHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgFHx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBJ8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAefHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHXx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBx8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAffHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgE3x8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBd8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAWfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgG3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBV8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCARfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgIHx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBl8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAafHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEXx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBZ8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAYfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgE3x8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBV8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAbfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggIHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIB98fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiASfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgHHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIB18fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAXfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggGXx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBR8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAefHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgE3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIB18fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAXfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgG3x8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBF8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAcfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggGXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBR8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAVfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHnx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBh8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAWfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggIHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIB98fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSASfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgGnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIB18fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSAWfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgEnx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGICB8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAffHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgHnx8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBV8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAbfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgEXx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBh8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAXfHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgFHx8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBp8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCATfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgGXx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBx8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSAefHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgHHx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBh8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAffHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgHXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBJ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAUfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGnx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBZ8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiARfHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgIHx8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBV8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAZfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggF3x8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIBN8fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAbfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgF3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFICB8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAffHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGnx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBx8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAUfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggEXx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBl8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiAdfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgE3x8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIB58fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByAYfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggEnx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBV8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAbfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFnx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgASAFIBt8fCEBIA0gAYVCIIohDSAJIA18IQkgBSAJhUIYiiEFIAEgBSATfHwhASANIAGFQhCKIQ0gCSANfCEJIAUgCYVCP4ohBSACIAYgGXx8IQIgDiAChUIgiiEOIAogDnwhCiAGIAqFQhiKIQYgAiAGIBV8fCECIA4gAoVCEIohDiAKIA58IQogBiAKhUI/iiEGIAMgByAYfHwhAyAPIAOFQiCKIQ8gCyAPfCELIAcgC4VCGIohByADIAcgF3x8IQMgDyADhUIQiiEPIAsgD3whCyAHIAuFQj+KIQcgBCAIIBJ8fCEEIBAgBIVCIIohECAMIBB8IQwgCCAMhUIYiiEIIAQgCCAWfHwhBCAQIASFQhCKIRAgDCAQfCEMIAggDIVCP4ohCCABIAYgIHx8IQEgECABhUIgiiEQIAsgEHwhCyAGIAuFQhiKIQYgASAGIBx8fCEBIBAgAYVCEIohECALIBB8IQsgBiALhUI/iiEGIAIgByAafHwhAiANIAKFQiCKIQ0gDCANfCEMIAcgDIVCGIohByACIAcgH3x8IQIgDSAChUIQiiENIAwgDXwhDCAHIAyFQj+KIQcgAyAIIBR8fCEDIA4gA4VCIIohDiAJIA58IQkgCCAJhUIYiiEIIAMgCCAdfHwhAyAOIAOFQhCKIQ4gCSAOfCEJIAggCYVCP4ohCCAEIAUgHnx8IQQgDyAEhUIgiiEPIAogD3whCiAFIAqFQhiKIQUgBCAFIBF8fCEEIA8gBIVCEIohDyAKIA98IQogBSAKhUI/iiEFIAEgBSARfHwhASANIAGFQiCKIQ0gCSANfCEJIAUgCYVCGIohBSABIAUgEnx8IQEgDSABhUIQiiENIAkgDXwhCSAFIAmFQj+KIQUgAiAGIBN8fCECIA4gAoVCIIohDiAKIA58IQogBiAKhUIYiiEGIAIgBiAUfHwhAiAOIAKFQhCKIQ4gCiAOfCEKIAYgCoVCP4ohBiADIAcgFXx8IQMgDyADhUIgiiEPIAsgD3whCyAHIAuFQhiKIQcgAyAHIBZ8fCEDIA8gA4VCEIohDyALIA98IQsgByALhUI/iiEHIAQgCCAXfHwhBCAQIASFQiCKIRAgDCAQfCEMIAggDIVCGIohCCAEIAggGHx8IQQgECAEhUIQiiEQIAwgEHwhDCAIIAyFQj+KIQggASAGIBl8fCEBIBAgAYVCIIohECALIBB8IQsgBiALhUIYiiEGIAEgBiAafHwhASAQIAGFQhCKIRAgCyAQfCELIAYgC4VCP4ohBiACIAcgG3x8IQIgDSAChUIgiiENIAwgDXwhDCAHIAyFQhiKIQcgAiAHIBx8fCECIA0gAoVCEIohDSAMIA18IQwgByAMhUI/iiEHIAMgCCAdfHwhAyAOIAOFQiCKIQ4gCSAOfCEJIAggCYVCGIohCCADIAggHnx8IQMgDiADhUIQiiEOIAkgDnwhCSAIIAmFQj+KIQggBCAFIB98fCEEIA8gBIVCIIohDyAKIA98IQogBSAKhUIYiiEFIAQgBSAgfHwhBCAPIASFQhCKIQ8gCiAPfCEKIAUgCoVCP4ohBSABIAUgH3x8IQEgDSABhUIgiiENIAkgDXwhCSAFIAmFQhiKIQUgASAFIBt8fCEBIA0gAYVCEIohDSAJIA18IQkgBSAJhUI/iiEFIAIgBiAVfHwhAiAOIAKFQiCKIQ4gCiAOfCEKIAYgCoVCGIohBiACIAYgGXx8IQIgDiAChUIQiiEOIAogDnwhCiAGIAqFQj+KIQYgAyAHIBp8fCEDIA8gA4VCIIohDyALIA98IQsgByALhUIYiiEHIAMgByAgfHwhAyAPIAOFQhCKIQ8gCyAPfCELIAcgC4VCP4ohByAEIAggHnx8IQQgECAEhUIgiiEQIAwgEHwhDCAIIAyFQhiKIQggBCAIIBd8fCEEIBAgBIVCEIohECAMIBB8IQwgCCAMhUI/iiEIIAEgBiASfHwhASAQIAGFQiCKIRAgCyAQfCELIAYgC4VCGIohBiABIAYgHXx8IQEgECABhUIQiiEQIAsgEHwhCyAGIAuFQj+KIQYgAiAHIBF8fCECIA0gAoVCIIohDSAMIA18IQwgByAMhUIYiiEHIAIgByATfHwhAiANIAKFQhCKIQ0gDCANfCEMIAcgDIVCP4ohByADIAggHHx8IQMgDiADhUIgiiEOIAkgDnwhCSAIIAmFQhiKIQggAyAIIBh8fCEDIA4gA4VCEIohDiAJIA58IQkgCCAJhUI/iiEIIAQgBSAWfHwhBCAPIASFQiCKIQ8gCiAPfCEKIAUgCoVCGIohBSAEIAUgFHx8IQQgDyAEhUIQiiEPIAogD3whCiAFIAqFQj+KIQUgISAhKQMAIAEgCYWFNwMAICIgIikDACACIAqFhTcDACAjICMpAwAgAyALhYU3AwAgJCAkKQMAIAQgDIWFNwMAICUgJSkDACAFIA2FhTcDACAmICYpAwAgBiAOhYU3AwAgJyAnKQMAIAcgD4WFNwMAICggKCkDACAIIBCFhTcDAAs=")}}),t=r(),a=WebAssembly.compile(t);return ch=async n=>(await WebAssembly.instantiate(await a,n)).exports,ch}var Mi=PE,WE=ad.exports,Hn=null,gm=typeof WebAssembly<"u"&&jE()().then(i=>{Hn=i}),qn=64,Zf=[];Te.exports=gi;var mm=Te.exports.BYTES_MIN=16,ym=Te.exports.BYTES_MAX=64;Te.exports.BYTES=32;var bm=Te.exports.KEYBYTES_MIN=16,_m=Te.exports.KEYBYTES_MAX=64;Te.exports.KEYBYTES=32;var wm=Te.exports.SALTBYTES=16,Cm=Te.exports.PERSONALBYTES=16;function gi(i,e,r,t,a){if(!(this instanceof gi))return new gi(i,e,r,t,a);if(!Hn)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");i||(i=32),a!==!0&&(Mi(i>=mm,"digestLength must be at least "+mm+", was given "+i),Mi(i<=ym,"digestLength must be at most "+ym+", was given "+i),e!=null&&(Mi(e instanceof Uint8Array,"key must be Uint8Array or Buffer"),Mi(e.length>=bm,"key must be at least "+bm+", was given "+e.length),Mi(e.length<=_m,"key must be at least "+_m+", was given "+e.length)),r!=null&&(Mi(r instanceof Uint8Array,"salt must be Uint8Array or Buffer"),Mi(r.length===wm,"salt must be exactly "+wm+", was given "+r.length)),t!=null&&(Mi(t instanceof Uint8Array,"personal must be Uint8Array or Buffer"),Mi(t.length===Cm,"personal must be exactly "+Cm+", was given "+t.length))),Zf.length||(Zf.push(qn),qn+=216),this.digestLength=i,this.finalized=!1,this.pointer=Zf.pop(),this._memory=new Uint8Array(Hn.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=e?e.length:0,this._memory[2]=1,this._memory[3]=1,r&&this._memory.set(r,32),t&&this._memory.set(t,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),Hn.blake2b_init(this.pointer,this.digestLength),e&&(this.update(e),this._memory.fill(0,qn,qn+e.length),this._memory[this.pointer+200]=128)}gi.prototype._realloc=function(i){Hn.memory.grow(Math.max(0,Math.ceil(Math.abs(i-this._memory.length)/65536))),this._memory=new Uint8Array(Hn.memory.buffer)};gi.prototype.update=function(i){return Mi(this.finalized===!1,"Hash instance finalized"),Mi(i instanceof Uint8Array,"input must be Uint8Array or Buffer"),qn+i.length>this._memory.length&&this._realloc(qn+i.length),this._memory.set(i,qn),Hn.blake2b_update(this.pointer,qn,qn+i.length),this};gi.prototype.digest=function(i){if(Mi(this.finalized===!1,"Hash instance finalized"),this.finalized=!0,Zf.push(this.pointer),Hn.blake2b_final(this.pointer),!i||i==="binary")return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if(typeof i=="string")return WE.toString(this._memory,i,this.pointer+128,this.pointer+128+this.digestLength);Mi(i instanceof Uint8Array&&i.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var e=0;e<this.digestLength;e++)i[e]=this._memory[this.pointer+128+e];return i};gi.prototype.final=gi.prototype.digest;gi.WASM=Hn;gi.SUPPORTED=typeof WebAssembly<"u";gi.ready=function(i){return i||(i=YE),gm?gm.then(()=>i(),i):i(new Error("WebAssembly not supported"))};gi.prototype.ready=gi.ready;gi.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)};gi.prototype.setPartialHash=function(i){this._memory.set(i,this.pointer)};function YE(){}function Ea(i){return(i&4294901760?(i&=4294901760,16):0)|(i&4278255360?(i&=4278255360,8):0)|(i&4042322160?(i&=4042322160,4):0)|(i&3435973836?(i&=3435973836,2):0)|(i&2863311530)!==0}function Pr(i,e){const r=new DataView(i.buffer,i.byteOffset,i.byteLength);let t="";for(let a=0;a<4;a++){a>0&&(t+=`
`),t+="		";for(let n=0;n<4;n++)n>0&&(t+=" "),t+=r.getUint32(a*16+n*4).toString(16).padStart(8,"0")}return e&&(t=e+`
`+t),t}function pa(i,e){if(i.byteLength!=e.byteLength)return!1;for(var r=new Int8Array(i),t=new Int8Array(e),a=0;a!=i.byteLength;a++)if(r[a]!=t[a])return!1;return!0}function XE(i){const e=i.getPartialHash(),r=Te.exports(64);return r.setPartialHash(e),r}async function r6(i,e,r,t,a){return i.G1.isZero(e)||i.G1.isZero(r)||i.G2.isZero(t)||i.G2.isZero(a)?!1:await i.pairingEq(e,a,i.G1.neg(r),t)}function JE(){return window.prompt("Enter a random text. (Entropy): ","")}function ds(i){let e=new Uint8Array(i);return globalThis.crypto.getRandomValues(e),e}async function tA(i){{const e=await globalThis.crypto.subtle.digest("SHA-256",i.buffer);return new Uint8Array(e)}}function al(i,e){return new DataView(i.buffer).getUint32(e,!1)}async function $l(i){for(;!i;)i=await JE();const e=Te.exports(64);e.update(ds(64));const r=new TextEncoder;e.update(r.encode(i));const t=e.digest(),a=[];for(let c=0;c<8;c++)a[c]=al(t,c*4);return new Ka(a)}async function M1(i,e){let r,t;e<32?(r=1<<e>>>0,t=1):(r=4294967296,t=1<<e-32>>>0);let a=i;for(let v=0;v<t;v++)for(let o=0;o<r;o++)a=await tA(a);const n=new DataView(a.buffer,a.byteOffset,a.byteLength),c=[];for(let v=0;v<8;v++)c[v]=n.getUint32(v*4,!1);return new Ka(c)}function i6(i){return i instanceof Uint8Array?i:(i.slice(0,2)=="0x"&&(i=i.slice(2)),new Uint8Array(i.match(/[\da-f]{2}/gi).map(function(e){return parseInt(e,16)})))}function n6(i){return Array.prototype.map.call(i,function(e){return("0"+(e&255).toString(16)).slice(-2)}).join("")}function sl(i,e){if(e instanceof Uint8Array)return i.toString(e);if(Array.isArray(e))return e.map(sl.bind(null,i));if(typeof e=="object"){const r={};return Object.keys(e).forEach(a=>{r[a]=sl(i,e[a])}),r}else return typeof e=="bigint"||e.eq!==void 0?e.toString(10):e}const Em=1,eA=1,rA=2,Wo=10,iA=3,nA=17,ld=2,ol=3,cd=4,ud=5,hd=6,ho=7,po=8,vo=9,go=10,mo=11,yo=12,bo=13,_o=14,dd=15,fl=16,pd=17;async function B1(i,e){await Oe(i,1),await i.writeULE32(1),await Fe(i);const r=await _i(e.q);await Oe(i,2);const t=r.q,a=(Math.floor((Ae.bitLength(t)-1)/64)+1)*8,n=r.r,c=(Math.floor((Ae.bitLength(n)-1)/64)+1)*8;await i.writeULE32(a),await nn(i,t,a),await i.writeULE32(c),await nn(i,n,c),await i.writeULE32(e.nVars),await i.writeULE32(e.nPublic),await i.writeULE32(e.domainSize),await ps(i,r,e.vk_alpha_1),await ps(i,r,e.vk_beta_1),await jf(i,r,e.vk_beta_2),await jf(i,r,e.vk_gamma_2),await ps(i,r,e.vk_delta_1),await jf(i,r,e.vk_delta_2),await Fe(i)}async function ps(i,e,r){const t=new Uint8Array(e.G1.F.n8*2);e.G1.toRprLEM(t,0,r),await i.write(t)}async function jf(i,e,r){const t=new Uint8Array(e.G2.F.n8*2);e.G2.toRprLEM(t,0,r),await i.write(t)}async function Vr(i,e,r){const t=await i.read(e.G1.F.n8*2),a=e.G1.fromRprLEM(t,0);return r?e.G1.toObject(a):a}async function za(i,e,r){const t=await i.read(e.G2.F.n8*2),a=e.G2.fromRprLEM(t,0);return r?e.G2.toObject(a):a}async function an(i,e,r,t){await yr(i,e,1);const a=await i.readULE32();if(await br(i),a===eA)return await aA(i,e,r,t);if(a===rA)return await sA(i,e,r,t);if(a===Wo)return await oA(i,e,r,t);throw new Error("Protocol not supported: ")}async function aA(i,e,r,t){const a={};a.protocol="groth16",await yr(i,e,2);const n=await i.readULE32();a.n8q=n,a.q=await Sn(i,n);const c=await i.readULE32();return a.n8r=c,a.r=await Sn(i,c),a.curve=await _i(a.q,t),a.nVars=await i.readULE32(),a.nPublic=await i.readULE32(),a.domainSize=await i.readULE32(),a.power=Ea(a.domainSize),a.vk_alpha_1=await Vr(i,a.curve,r),a.vk_beta_1=await Vr(i,a.curve,r),a.vk_beta_2=await za(i,a.curve,r),a.vk_gamma_2=await za(i,a.curve,r),a.vk_delta_1=await Vr(i,a.curve,r),a.vk_delta_2=await za(i,a.curve,r),await br(i),a}async function sA(i,e,r,t){const a={};a.protocol="plonk",await yr(i,e,2);const n=await i.readULE32();a.n8q=n,a.q=await Sn(i,n);const c=await i.readULE32();return a.n8r=c,a.r=await Sn(i,c),a.curve=await _i(a.q,t),a.nVars=await i.readULE32(),a.nPublic=await i.readULE32(),a.domainSize=await i.readULE32(),a.power=Ea(a.domainSize),a.nAdditions=await i.readULE32(),a.nConstraints=await i.readULE32(),a.k1=await i.read(c),a.k2=await i.read(c),a.Qm=await Vr(i,a.curve,r),a.Ql=await Vr(i,a.curve,r),a.Qr=await Vr(i,a.curve,r),a.Qo=await Vr(i,a.curve,r),a.Qc=await Vr(i,a.curve,r),a.S1=await Vr(i,a.curve,r),a.S2=await Vr(i,a.curve,r),a.S3=await Vr(i,a.curve,r),a.X_2=await za(i,a.curve,r),await br(i),a}async function oA(i,e,r,t){const a={};a.protocol="fflonk",a.protocolId=Wo,await yr(i,e,ld);const n=await i.readULE32();a.n8q=n,a.q=await Sn(i,n),a.curve=await _i(a.q,t);const c=await i.readULE32();return a.n8r=c,a.r=await Sn(i,c),a.nVars=await i.readULE32(),a.nPublic=await i.readULE32(),a.domainSize=await i.readULE32(),a.power=Ea(a.domainSize),a.nAdditions=await i.readULE32(),a.nConstraints=await i.readULE32(),a.k1=await i.read(c),a.k2=await i.read(c),a.w3=await i.read(c),a.w4=await i.read(c),a.w8=await i.read(c),a.wr=await i.read(c),a.X_2=await za(i,a.curve,r),a.C0=await Vr(i,a.curve,r),await br(i),a}async function fA(i,e){const{fd:r,sections:t}=await gr(i,"zkey",1),a=await an(r,t,e),n=new w1(a.r),c=Ae.mod(Ae.shl(1,a.n8r*8),a.r),u=n.inv(c),v=n.mul(u,u);let o=await _i(a.q);await yr(r,t,3),a.IC=[];for(let y=0;y<=a.nPublic;y++){const _=await Vr(r,o,e);a.IC.push(_)}await br(r),await yr(r,t,4);const h=await r.readULE32();a.ccoefs=[];for(let y=0;y<h;y++){const _=await r.readULE32(),A=await r.readULE32(),S=await r.readULE32(),T=await g();a.ccoefs.push({matrix:_,constraint:A,signal:S,value:T})}await br(r),await yr(r,t,5),a.A=[];for(let y=0;y<a.nVars;y++){const _=await Vr(r,o,e);a.A[y]=_}await br(r),await yr(r,t,6),a.B1=[];for(let y=0;y<a.nVars;y++){const _=await Vr(r,o,e);a.B1[y]=_}await br(r),await yr(r,t,7),a.B2=[];for(let y=0;y<a.nVars;y++){const _=await za(r,o,e);a.B2[y]=_}await br(r),await yr(r,t,8),a.C=[];for(let y=a.nPublic+1;y<a.nVars;y++){const _=await Vr(r,o,e);a.C[y]=_}await br(r),await yr(r,t,9),a.hExps=[];for(let y=0;y<a.domainSize;y++){const _=await Vr(r,o,e);a.hExps.push(_)}return await br(r),await r.close(),a;async function g(){const y=await Sn(r,a.n8r);return n.mul(y,v)}}async function lA(i,e,r){const t={delta:{}};t.deltaAfter=await Vr(i,e,r),t.delta.g1_s=await Vr(i,e,r),t.delta.g1_sx=await Vr(i,e,r),t.delta.g2_spx=await za(i,e,r),t.transcript=await i.read(64),t.type=await i.readULE32();const a=await i.readULE32(),n=i.pos;let c=0;for(;i.pos-n<a;){const u=await i.read(1);if(u[0]<=c)throw new Error("Parameters in the contribution must be sorted");if(c=u[0],u[0]==1){const v=await i.read(1),o=await i.read(v[0]);t.name=new TextDecoder().decode(o)}else if(u[0]==2){const v=await i.read(1);t.numIterationsExp=v[0]}else if(u[0]==3){const v=await i.read(1);t.beaconHash=await i.read(v[0])}else throw new Error("Parameter not recognized")}if(i.pos!=n+a)throw new Error("Parameters do not match");return t}async function ws(i,e,r){await yr(i,r,10);const t={contributions:[]};t.csHash=await i.read(64);const a=await i.readULE32();for(let n=0;n<a;n++){const c=await lA(i,e);t.contributions.push(c)}return await br(i),t}async function cA(i,e,r){await ps(i,e,r.deltaAfter),await ps(i,e,r.delta.g1_s),await ps(i,e,r.delta.g1_sx),await jf(i,e,r.delta.g2_spx),await i.write(r.transcript),await i.writeULE32(r.type||0);const t=[];if(r.name){t.push(1);const a=new TextEncoder("utf-8").encode(r.name.substring(0,64));t.push(a.byteLength);for(let n=0;n<a.byteLength;n++)t.push(a[n])}if(r.type==1){t.push(2),t.push(r.numIterationsExp),t.push(3),t.push(r.beaconHash.byteLength);for(let a=0;a<r.beaconHash.byteLength;a++)t.push(r.beaconHash[a])}if(t.length>0){const a=new Uint8Array(t);await i.writeULE32(a.byteLength),await i.write(a)}else await i.writeULE32(0)}async function L1(i,e,r){await Oe(i,10),await i.write(r.csHash),await i.writeULE32(r.contributions.length);for(let t=0;t<r.contributions.length;t++)await cA(i,e,r.contributions[t]);await Fe(i)}function rn(i,e,r){const t=new Uint8Array(e.G1.F.n8*2);e.G1.toRprUncompressed(t,0,r),i.update(t)}function uA(i,e,r){const t=new Uint8Array(e.G2.F.n8*2);e.G2.toRprUncompressed(t,0,r),i.update(t)}function va(i,e,r){rn(i,e,r.deltaAfter),rn(i,e,r.delta.g1_s),rn(i,e,r.delta.g1_sx),uA(i,e,r.delta.g2_spx),i.update(r.transcript)}async function hA(i,e,r){await Oe(i,1);const t=(Math.floor((Ae.bitLength(r)-1)/64)+1)*8;await i.writeULE32(t),await nn(i,r,t),await i.writeULE32(e.length),await Fe(i),await Oe(i,2);for(let a=0;a<e.length;a++)await nn(i,e[a],t);await Fe(i)}async function dA(i,e,r){await Oe(i,1);const t=(Math.floor((Ae.bitLength(r)-1)/64)+1)*8;if(await i.writeULE32(t),await nn(i,r,t),e.byteLength%t!=0)throw new Error("Invalid witness length");await i.writeULE32(e.byteLength/t),await Fe(i),await Oe(i,2),await i.write(e),await Fe(i)}async function Yo(i,e){await yr(i,e,1);const r=await i.readULE32(),t=await Sn(i,r),a=await i.readULE32();return await br(i),{n8:r,q:t,nWitness:a}}async function pA(i){const{fd:e,sections:r}=await gr(i,"wtns",2),{n8:t,nWitness:a}=await Yo(e,r);await yr(e,r,2);const n=[];for(let c=0;c<a;c++){const u=await Sn(e,t);n.push(u)}return await br(e),await e.close(),n}const{stringifyBigInts:Am}=ri;async function a6(i,e,r,t){const{fd:a,sections:n}=await gr(e,"wtns",2),c=await Yo(a,n),{fd:u,sections:v}=await gr(i,"zkey",2),o=await an(u,v,void 0,t);if(o.protocol!="groth16")throw new Error("zkey file is not groth16");if(!Ae.eq(o.r,c.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(c.nWitness!=o.nVars)throw new Error(`Invalid witness length. Circuit: ${o.nVars}, witness: ${c.nWitness}`);const h=o.curve,g=h.Fr,y=h.G1,_=h.G2,A=Ea(o.domainSize);r&&r.debug("Reading Wtns");const S=await fr(a,n,2);r&&r.debug("Reading Coeffs");const T=await fr(u,v,4);r&&r.debug("Building ABC");const[B,M,R]=await vA(h,o,S,T,r),P=A==g.s?h.Fr.shift:h.Fr.w[A+1],D=await g.ifft(B,"","",r,"IFFT_A"),q=await g.batchApplyKey(D,g.e(1),P),k=await g.fft(q,"","",r,"FFT_A"),U=await g.ifft(M,"","",r,"IFFT_B"),O=await g.batchApplyKey(U,g.e(1),P),G=await g.fft(O,"","",r,"FFT_B"),E=await g.ifft(R,"","",r,"IFFT_C"),s=await g.batchApplyKey(E,g.e(1),P),l=await g.fft(s,"","",r,"FFT_C");r&&r.debug("Join ABC");const d=await gA(h,o,k,G,l,r);let p={};r&&r.debug("Reading A Points");const m=await fr(u,v,5);p.pi_a=await h.G1.multiExpAffine(m,S,r,"multiexp A"),r&&r.debug("Reading B1 Points");const w=await fr(u,v,6);let x=await h.G1.multiExpAffine(w,S,r,"multiexp B1");r&&r.debug("Reading B2 Points");const b=await fr(u,v,7);p.pi_b=await h.G2.multiExpAffine(b,S,r,"multiexp B2"),r&&r.debug("Reading C Points");const f=await fr(u,v,8);p.pi_c=await h.G1.multiExpAffine(f,S.slice((o.nPublic+1)*h.Fr.n8),r,"multiexp C"),r&&r.debug("Reading H Points");const C=await fr(u,v,9),F=await h.G1.multiExpAffine(C,d,r,"multiexp H"),z=h.Fr.random(),W=h.Fr.random();p.pi_a=y.add(p.pi_a,o.vk_alpha_1),p.pi_a=y.add(p.pi_a,y.timesFr(o.vk_delta_1,z)),p.pi_b=_.add(p.pi_b,o.vk_beta_2),p.pi_b=_.add(p.pi_b,_.timesFr(o.vk_delta_2,W)),x=y.add(x,o.vk_beta_1),x=y.add(x,y.timesFr(o.vk_delta_1,W)),p.pi_c=y.add(p.pi_c,F),p.pi_c=y.add(p.pi_c,y.timesFr(p.pi_a,W)),p.pi_c=y.add(p.pi_c,y.timesFr(x,z)),p.pi_c=y.add(p.pi_c,y.timesFr(o.vk_delta_1,g.neg(g.mul(z,W))));let $=[];for(let I=1;I<=o.nPublic;I++){const K=S.slice(I*g.n8,I*g.n8+g.n8);$.push(Ae.fromRprLE(K))}return p.pi_a=y.toObject(y.toAffine(p.pi_a)),p.pi_b=_.toObject(_.toAffine(p.pi_b)),p.pi_c=y.toObject(y.toAffine(p.pi_c)),p.protocol="groth16",p.curve=h.name,await u.close(),await a.close(),p=Am(p),$=Am($),{proof:p,publicSignals:$}}async function vA(i,e,r,t,a){const n=i.Fr.n8,c=4*3+e.n8r,u=(t.byteLength-4)/c,v=new ee(e.domainSize*n),o=new ee(e.domainSize*n),h=new ee(e.domainSize*n),g=[v,o];for(let y=0;y<u;y++){a&&y%1e6==0&&a.debug(`QAP AB: ${y}/${u}`);const _=t.slice(4+y*c,4+y*c+c),A=new DataView(_.buffer),S=A.getUint32(0,!0),T=A.getUint32(4,!0),B=A.getUint32(8,!0),M=_.slice(12,12+n);g[S].set(i.Fr.add(g[S].slice(T*n,T*n+n),i.Fr.mul(M,r.slice(B*n,B*n+n))),T*n)}for(let y=0;y<e.domainSize;y++)a&&y%1e6==0&&a.debug(`QAP C: ${y}/${e.domainSize}`),h.set(i.Fr.mul(v.slice(y*n,y*n+n),o.slice(y*n,y*n+n)),y*n);return[v,o,h]}async function gA(i,e,r,t,a,n){const u=i.Fr.n8,v=Math.floor(r.byteLength/i.Fr.n8),o=[];for(let _=0;_<v;_+=4194304){n&&n.debug(`JoinABC: ${_}/${v}`);const A=Math.min(v-_,4194304),S=[],T=r.slice(_*u,(_+A)*u),B=t.slice(_*u,(_+A)*u),M=a.slice(_*u,(_+A)*u);S.push({cmd:"ALLOCSET",var:0,buff:T}),S.push({cmd:"ALLOCSET",var:1,buff:B}),S.push({cmd:"ALLOCSET",var:2,buff:M}),S.push({cmd:"ALLOC",var:3,len:A*u}),S.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:A},{var:3}]}),S.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:A},{var:3}]}),S.push({cmd:"GET",out:0,var:3,len:A*u}),o.push(i.tm.queueAction(S))}const h=await Promise.all(o);let g;r instanceof ee?g=new ee(r.byteLength):g=new Uint8Array(r.byteLength);let y=0;for(let _=0;_<h.length;_++)g.set(h[_][0],y),y+=h[_][0].byteLength;return g}function s6(i){let e=[];return r(e,i),e;function r(t,a){if(Array.isArray(a))for(let n=0;n<a.length;n++)r(t,a[n]);else t.push(a)}}function mA(i,e){let r=BigInt(i)%e;return r<0&&(r+=e),r}function o6(i){const e=BigInt(2)**BigInt(64);let r=BigInt("0xCBF29CE484222325");for(let n=0;n<i.length;n++)r^=BigInt(i[n].charCodeAt(0)),r*=BigInt(1099511628211),r%=e;let t=r.toString(16),a=16-t.length;return t="0".repeat(a).concat(t),t}function yA(i,e){const r=[];let t=BigInt(i);const a=BigInt(4294967296);for(;t;)r.unshift(Number(t%a)),t=t/a;if(e){let n=e-r.length;for(;n>0;)r.unshift(0),n--}return r}async function f6(i,e){let r,t,a;e=e||{};let n=1,c=0,u=0,v=!1;if(i instanceof WebAssembly.Instance)r=i,v=!0;else{let y=32767;if(e.memorySize&&(y=parseInt(e.memorySize),y<0))throw new Error("Invalid memory size");let _=!1;for(;!_;)try{a=new WebAssembly.Memory({initial:y}),_=!0}catch(B){if(y<=1)throw B;console.warn("Could not allocate "+y*1024*64+" bytes. This may cause severe instability. Trying with "+y*1024*64/2+" bytes"),y=Math.floor(y/2)}const A=await WebAssembly.compile(i);let S="",T="";r=await WebAssembly.instantiate(A,{env:{memory:a},runtime:{printDebug:function(B){console.log("printDebug:",B)},exceptionHandler:function(B){let M;throw B===1?M="Signal not found. ":B===2?M="Too many signals set. ":B===3?M="Signal already set. ":B===4?M="Assert Failed. ":B===5?M="Not enough memory. ":B===6?M="Input signal array access exceeds the size. ":M="Unknown error. ",console.error("ERROR: ",B,S),new Error(M+S)},printErrorMessage:function(){S+=h()+`
`},writeBufferMessage:function(){const B=h();B===`
`?(console.log(T),T=""):(T!==""&&(T+=" "),T+=B)},showSharedRWMemory:function(){const B=r.exports.getFieldNumLen32(),M=new Uint32Array(B);for(let R=0;R<B;R++)M[B-1-R]=r.exports.readSharedRWMemory(R);if(n>=2&&(c>=1||u>=7)){T!==""&&(T+=" ");const R=Ae.fromArray(M,4294967296).toString();T+=R}else console.log(Ae.fromArray(M,4294967296))},error:function(B,M,R,P,D,q){let k;throw B===7?k=g(M)+" "+t.getFr(P).toString()+" != "+t.getFr(D).toString()+" "+g(q):B===9?k=g(M)+" "+t.getFr(P).toString()+" "+g(D):B===5&&e.sym?k=g(M)+" "+e.sym.labelIdx2Name[D]:k=g(M)+" "+R+" "+P+" "+D+" "+q,console.log("ERROR: ",B,k),new Error(k)},log:function(B){console.log(t.getFr(B).toString())},logGetSignal:function(B,M){e.logGetSignal&&e.logGetSignal(B,t.getFr(M))},logSetSignal:function(B,M){e.logSetSignal&&e.logSetSignal(B,t.getFr(M))},logStartComponent:function(B){e.logStartComponent&&e.logStartComponent(B)},logFinishComponent:function(B){e.logFinishComponent&&e.logFinishComponent(B)}}})}typeof r.exports.getVersion=="function"&&(n=r.exports.getVersion()),typeof r.exports.getMinorVersion=="function"&&(c=r.exports.getMinorVersion()),typeof r.exports.getPatchVersion=="function"&&(u=r.exports.getPatchVersion());const o=e&&(e.sanityCheck||e.logGetSignal||e.logSetSignal||e.logStartComponent||e.logFinishComponent);if(n===2)t=new _A(r,o);else if(n===1){if(v)throw new Error("Loading code from WebAssembly instance is not supported for circom version 1");t=new bA(a,r,o)}else throw new Error(`Unsupported circom version: ${n}`);return t;function h(){let y="",_=r.exports.getMessageChar();for(;_!==0;)y+=String.fromCharCode(_),_=r.exports.getMessageChar();return y}function g(y){const _=new Uint8Array(a.buffer),A=[];for(let S=0;_[y+S]>0;S++)A.push(_[y+S]);return String.fromCharCode.apply(null,A)}}class bA{constructor(e,r,t){this.memory=e,this.i32=new Uint32Array(e.buffer),this.instance=r,this.n32=(this.instance.exports.getFrLen()>>2)-2;const a=this.instance.exports.getPRawPrime(),n=new Array(this.n32);for(let c=0;c<this.n32;c++)n[this.n32-1-c]=this.i32[(a>>2)+c];this.prime=Ae.fromArray(n,4294967296),this.Fr=new w1(this.prime),this.mask32=Ae.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(Ae.shiftLeft(1,this.n64*64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=t}circom_version(){return 1}async _doCalculateWitness(e,r){this.instance.exports.init(this.sanityCheck||r?1:0);const t=this.allocInt(),a=this.allocFr();Object.keys(e).forEach(c=>{const u=o6(c),v=parseInt(u.slice(0,8),16),o=parseInt(u.slice(8,16),16);try{this.instance.exports.getSignalOffset32(t,0,v,o)}catch{throw new Error(`Signal ${c} is not an input of the circuit.`)}const h=this.getInt(t),g=s6(e[c]);for(let y=0;y<g.length;y++)this.setFr(a,g[y]),this.instance.exports.setSignal(0,0,h+y,a)})}async calculateWitness(e,r){const t=this,a=t.i32[0],n=[];await t._doCalculateWitness(e,r);for(let c=0;c<t.NVars;c++){const u=t.instance.exports.getPWitness(c);n.push(t.getFr(u))}return t.i32[0]=a,n}async calculateBinWitness(e,r){const t=this,a=t.i32[0];await t._doCalculateWitness(e,r);const n=t.instance.exports.getWitnessBuffer();t.i32[0]=a;const c=t.memory.buffer.slice(n,n+t.NVars*t.n64*8);return new Uint8Array(c)}allocInt(){const e=this.i32[0];return this.i32[0]=e+8,e}allocFr(){const e=this.i32[0];return this.i32[0]=e+this.n32*4+8,e}getInt(e){return this.i32[e>>2]}setInt(e,r){this.i32[e>>2]=r}getFr(e){const r=this,t=e>>2;if(r.i32[t+1]&2147483648){const n=new Array(r.n32);for(let u=0;u<r.n32;u++)n[r.n32-1-u]=r.i32[t+2+u];const c=r.Fr.e(Ae.fromArray(n,4294967296));return r.i32[t+1]&1073741824?a(c):c}else return r.i32[t]&2147483648?r.Fr.e(r.i32[t]-4294967296):r.Fr.e(r.i32[t]);function a(n){return r.Fr.mul(r.RInv,n)}}setFr(e,r){const t=this;r=t.Fr.e(r);const a=t.Fr.neg(t.Fr.e("80000000",16)),n=t.Fr.e("7FFFFFFF",16);if(t.Fr.geq(r,a)&&t.Fr.leq(r,n)){let u;t.Fr.geq(r,t.Fr.zero)?u=Ae.toNumber(r):(u=Ae.toNumber(t.Fr.sub(r,a)),u=u-2147483648,u=4294967296+u),t.i32[e>>2]=u,t.i32[(e>>2)+1]=0;return}t.i32[e>>2]=0,t.i32[(e>>2)+1]=2147483648;const c=Ae.toArray(r,4294967296);for(let u=0;u<t.n32;u++){const v=c.length-1-u;v>=0?t.i32[(e>>2)+2+u]=c[v]:t.i32[(e>>2)+2+u]=0}}}class _A{constructor(e,r){this.instance=e,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();const t=new Uint32Array(this.n32);for(let a=0;a<this.n32;a++)t[this.n32-1-a]=this.instance.exports.readSharedRWMemory(a);this.prime=Ae.fromArray(t,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=r}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(e,r){this.instance.exports.init(this.sanityCheck||r?1:0);const t=Object.keys(e);let a=0;if(t.forEach(n=>{const c=o6(n),u=parseInt(c.slice(0,8),16),v=parseInt(c.slice(8,16),16),o=s6(e[n]);if(typeof this.instance.exports.getInputSignalSize=="function"){let h=this.instance.exports.getInputSignalSize(u,v);if(h<0)throw new Error(`Signal ${n} not found
`);if(o.length<h)throw new Error(`Not enough values for input signal ${n}
`);if(o.length>h)throw new Error(`Too many values for input signal ${n}
`)}for(let h=0;h<o.length;h++){const g=yA(mA(o[h],this.prime),this.n32);for(let y=0;y<this.n32;y++)this.instance.exports.writeSharedRWMemory(y,g[this.n32-1-y]);try{this.instance.exports.setInputSignal(u,v,h),a++}catch(y){throw new Error(y)}}}),a<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${a} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(e,r){const t=[];await this._doCalculateWitness(e,r);for(let a=0;a<this.witnessSize;a++){this.instance.exports.getWitness(a);const n=new Uint32Array(this.n32);for(let c=0;c<this.n32;c++)n[this.n32-1-c]=this.instance.exports.readSharedRWMemory(c);t.push(Ae.fromArray(n,4294967296))}return t}async calculateWTNSBin(e,r){const t=new Uint32Array(this.witnessSize*this.n32+this.n32+11),a=new Uint8Array(t.buffer);await this._doCalculateWitness(e,r),a[0]=119,a[1]=116,a[2]=110,a[3]=115,t[1]=2,t[2]=2,t[3]=1;const n=this.n32*4,u=(8+n).toString(16);t[4]=parseInt(u.slice(0,8),16),t[5]=parseInt(u.slice(8,16),16),t[6]=n,this.instance.exports.getRawPrime();let v=7;for(let g=0;g<this.n32;g++)t[v+g]=this.instance.exports.readSharedRWMemory(g);v+=this.n32,t[v]=this.witnessSize,v++,t[v]=2,v++;const h=(n*this.witnessSize).toString(16);t[v]=parseInt(h.slice(0,8),16),t[v+1]=parseInt(h.slice(8,16),16),v+=2;for(let g=0;g<this.witnessSize;g++){this.instance.exports.getWitness(g);for(let y=0;y<this.n32;y++)t[v+y]=this.instance.exports.readSharedRWMemory(y);v+=this.n32}return a}}const{unstringifyBigInts:wA}=ri;async function Zl(i,e,r,t){const a=wA(i),n=await Ca(e),c=await n.read(n.totalSize);await n.close();const u=await f6(c,t);if(u.circom_version()===1){const v=await u.calculateBinWitness(a),o=await bi(r,"wtns",2,2);await dA(o,v,u.prime),await o.close()}else{const v=await Ts(r),o=await u.calculateWTNSBin(a);await v.write(o),await v.close()}}const{unstringifyBigInts:CA}=ri;async function EA(i,e,r,t,a,n){const c=CA(i),u={type:"mem"};return await Zl(c,e,u,a),await a6(r,u,t,n)}const{unstringifyBigInts:uh}=ri;async function AA(i,e,r,t){const a=uh(i),n=uh(r),c=uh(e),u=await Za(a.curve),v=u.G1.fromObject(a.IC[0]),o=new Uint8Array(u.G1.F.n8*2*c.length),h=new Uint8Array(u.Fr.n8*c.length);if(!xA(u,c))return t&&t.error("Public inputs are not valid."),!1;for(let P=0;P<c.length;P++){const D=u.G1.fromObject(a.IC[P+1]);o.set(D,P*u.G1.F.n8*2),Ae.toRprLE(h,u.Fr.n8*P,c[P],u.Fr.n8)}let g=await u.G1.multiExpAffine(o,h);g=u.G1.add(g,v);const y=u.G1.fromObject(n.pi_a),_=u.G2.fromObject(n.pi_b),A=u.G1.fromObject(n.pi_c);if(!SA(u,{pi_a:y,pi_b:_,pi_c:A}))return t&&t.error("Proof commitments are not valid."),!1;const S=u.G2.fromObject(a.vk_gamma_2),T=u.G2.fromObject(a.vk_delta_2),B=u.G1.fromObject(a.vk_alpha_1),M=u.G2.fromObject(a.vk_beta_2);return await u.pairingEq(u.G1.neg(y),_,g,S,A,T,B,M)?(t&&t.info("OK!"),!0):(t&&t.error("Invalid proof"),!1)}function SA(i,e){const r=i.G1,t=i.G2;return r.isValid(e.pi_a)&&t.isValid(e.pi_b)&&r.isValid(e.pi_c)}function xA(i,e){for(let r=0;r<e.length;r++)if(!Ae.lt(e[r],i.r))return!1;return!0}const{unstringifyBigInts:Sm}=ri;function Tn(i){let e=i.toString(16);for(;e.length<64;)e="0"+e;return e=`"0x${e}"`,e}async function IA(i,e){const r=Sm(i),t=Sm(e);let a="";for(let c=0;c<t.length;c++)a!=""&&(a=a+","),a=a+Tn(t[c]);let n;return n=`[${Tn(r.pi_a[0])}, ${Tn(r.pi_a[1])}],[[${Tn(r.pi_b[0][1])}, ${Tn(r.pi_b[0][0])}],[${Tn(r.pi_b[1][1])}, ${Tn(r.pi_b[1][0])}]],[${Tn(r.pi_c[0])}, ${Tn(r.pi_c[1])}],[${a}]`,n}var MA=Object.freeze({__proto__:null,fullProve:EA,prove:a6,verify:AA,exportSolidityCallData:IA});function Xo(i,e){const r=new DataView(e.buffer,e.byteOffset,e.byteLength),t=[];for(let c=0;c<8;c++)t[c]=r.getUint32(c*4);const a=new Ka(t);return i.G2.fromRng(a)}function Wf(i,e,r,t,a){const n=Te.exports(64),c=new Uint8Array([e]);n.update(c),n.update(r);const u=i.G1.toUncompressed(t);n.update(u);const v=i.G1.toUncompressed(a);n.update(v);const o=n.digest();return Xo(i,o)}function hh(i,e,r,t,a){return i.g1_s=e.G1.toAffine(e.G1.fromRng(a)),i.g1_sx=e.G1.toAffine(e.G1.timesFr(i.g1_s,i.prvKey)),i.g2_sp=e.G2.toAffine(Wf(e,r,t,i.g1_s,i.g1_sx)),i.g2_spx=e.G2.toAffine(e.G2.timesFr(i.g2_sp,i.prvKey)),i}function T1(i,e,r){const t={tau:{},alpha:{},beta:{}};return t.tau.prvKey=i.Fr.fromRng(r),t.alpha.prvKey=i.Fr.fromRng(r),t.beta.prvKey=i.Fr.fromRng(r),hh(t.tau,i,0,e,r),hh(t.alpha,i,1,e,r),hh(t.beta,i,2,e,r),t}async function ja(i,e,r,t){t||(t=r),await i.writeULE32(1);const a=i.pos;await i.writeULE64(0),await i.writeULE32(e.F1.n64*8);const n=new Uint8Array(e.F1.n8);Ae.toRprLE(n,0,e.q,e.F1.n8),await i.write(n),await i.writeULE32(r),await i.writeULE32(t);const c=i.pos-a-8,u=i.pos;await i.writeULE64(c,a),i.pos=u}async function Wi(i,e){if(!e[1])throw new Error(i.fileName+": File has no  header");if(e[1].length>1)throw new Error(i.fileName+": File has more than one header");i.pos=e[1][0].p;const r=await i.readULE32(),t=await i.read(r),a=Ae.fromRprLE(t),n=await _i(a);if(n.F1.n64*8!=r)throw new Error(i.fileName+": Invalid size");const c=await i.readULE32(),u=await i.readULE32();if(i.pos-e[1][0].p!=e[1][0].size)throw new Error("Invalid PTau header size");return{curve:n,power:c,ceremonyPower:u}}async function BA(i,e,r){const t=await i.read(e.F1.n8*2*6+e.F2.n8*2*3);return l6(t,0,e,r)}function l6(i,e,r,t){const a={tau:{},alpha:{},beta:{}};return a.tau.g1_s=n(),a.tau.g1_sx=n(),a.alpha.g1_s=n(),a.alpha.g1_sx=n(),a.beta.g1_s=n(),a.beta.g1_sx=n(),a.tau.g2_spx=c(),a.alpha.g2_spx=c(),a.beta.g2_spx=c(),a;function n(){let u;return t?u=r.G1.fromRprLEM(i,e):u=r.G1.fromRprUncompressed(i,e),e+=r.G1.F.n8*2,u}function c(){let u;return t?u=r.G2.fromRprLEM(i,e):u=r.G2.fromRprUncompressed(i,e),e+=r.G2.F.n8*2,u}}function Rs(i,e,r,t,a){n(t.tau.g1_s),n(t.tau.g1_sx),n(t.alpha.g1_s),n(t.alpha.g1_sx),n(t.beta.g1_s),n(t.beta.g1_sx),c(t.tau.g2_spx),c(t.alpha.g2_spx),c(t.beta.g2_spx);async function n(u){a?r.G1.toRprLEM(i,e,u):r.G1.toRprUncompressed(i,e,u),e+=r.F1.n8*2}async function c(u){a?r.G2.toRprLEM(i,e,u):r.G2.toRprUncompressed(i,e,u),e+=r.F2.n8*2}return i}async function LA(i,e,r,t){const a=new Uint8Array(e.F1.n8*2*6+e.F2.n8*2*3);Rs(a,0,e,r,t),await i.write(a)}async function TA(i,e){const r={};r.tauG1=await v(),r.tauG2=await o(),r.alphaG1=await v(),r.betaG1=await v(),r.betaG2=await o(),r.key=await BA(i,e,!0),r.partialHash=await i.read(216),r.nextChallenge=await i.read(64),r.type=await i.readULE32();const t=new Uint8Array(e.G1.F.n8*2*6+e.G2.F.n8*2*3);Rs(t,0,e,r.key,!1);const a=Te.exports(64);a.setPartialHash(r.partialHash),a.update(t),r.responseHash=a.digest();const n=await i.readULE32(),c=i.pos;let u=0;for(;i.pos-c<n;){const g=await h(1);if(g[0]<=u)throw new Error("Parameters in the contribution must be sorted");if(u=g[0],g[0]==1){const y=await h(1),_=await h(y[0]);r.name=new TextDecoder().decode(_)}else if(g[0]==2){const y=await h(1);r.numIterationsExp=y[0]}else if(g[0]==3){const y=await h(1);r.beaconHash=await h(y[0])}else throw new Error("Parameter not recognized")}if(i.pos!=c+n)throw new Error("Parameters do not match");return r;async function v(){const g=await i.read(e.G1.F.n8*2);return e.G1.fromRprLEM(g)}async function o(){const g=await i.read(e.G2.F.n8*2);return e.G2.fromRprLEM(g)}async function h(g){const y=await i.read(g);return new Uint8Array(y)}}async function Ns(i,e,r){if(!r[7])throw new Error(i.fileName+": File has no  contributions");if(r[7][0].length>1)throw new Error(i.fileName+": File has more than one contributions section");i.pos=r[7][0].p;const t=await i.readULE32(),a=[];for(let n=0;n<t;n++){const c=await TA(i,e);c.id=n+1,a.push(c)}if(i.pos-r[7][0].p!=r[7][0].size)throw new Error("Invalid contribution section size");return a}async function RA(i,e,r){const t=new Uint8Array(e.F1.n8*2),a=new Uint8Array(e.F2.n8*2);await c(r.tauG1),await u(r.tauG2),await c(r.alphaG1),await c(r.betaG1),await u(r.betaG2),await LA(i,e,r.key,!0),await i.write(r.partialHash),await i.write(r.nextChallenge),await i.writeULE32(r.type||0);const n=[];if(r.name){n.push(1);const v=new TextEncoder("utf-8").encode(r.name.substring(0,64));n.push(v.byteLength);for(let o=0;o<v.byteLength;o++)n.push(v[o])}if(r.type==1){n.push(2),n.push(r.numIterationsExp),n.push(3),n.push(r.beaconHash.byteLength);for(let v=0;v<r.beaconHash.byteLength;v++)n.push(r.beaconHash[v])}if(n.length>0){const v=new Uint8Array(n);await i.writeULE32(v.byteLength),await i.write(v)}else await i.writeULE32(0);async function c(v){e.G1.toRprLEM(t,0,v),await i.write(t)}async function u(v){e.G2.toRprLEM(a,0,v),await i.write(a)}}async function R1(i,e,r){await i.writeULE32(7);const t=i.pos;await i.writeULE64(0),await i.writeULE32(r.length);for(let c=0;c<r.length;c++)await RA(i,e,r[c]);const a=i.pos-t-8,n=i.pos;await i.writeULE64(a,t),i.pos=n}function ks(i,e,r){r&&r.debug("Calculating First Challenge Hash");const t=new Te.exports(64),a=new Uint8Array(i.G1.F.n8*2),n=new Uint8Array(i.G2.F.n8*2);i.G1.toRprUncompressed(a,0,i.G1.g),i.G2.toRprUncompressed(n,0,i.G2.g),t.update(Te.exports(64).digest());let c;return c=2**e*2-1,r&&r.debug("Calculate Initial Hash: tauG1"),u(a,c),c=2**e,r&&r.debug("Calculate Initial Hash: tauG2"),u(n,c),r&&r.debug("Calculate Initial Hash: alphaTauG1"),u(a,c),r&&r.debug("Calculate Initial Hash: betaTauG1"),u(a,c),t.update(n),t.digest();function u(v,o){const g=Math.floor(o/341e3),y=o%341e3,_=new Uint8Array(341e3*v.byteLength);for(let A=0;A<341e3;A++)_.set(v,A*v.byteLength);for(let A=0;A<g;A++)t.update(_),r&&r.debug("Initial hash: "+A*341e3);for(let A=0;A<y;A++)t.update(v)}}async function c6(i,e,r,t){const a=await M1(r,t);return T1(i,e,a)}async function NA(i,e,r,t){await Te.exports.ready();const a=await bi(r,"ptau",1,7);await ja(a,i,e,0);const n=i.G1.oneAffine,c=i.G2.oneAffine;await Oe(a,2);const u=2**e*2-1;for(let y=0;y<u;y++)await a.write(n),t&&y%1e5==0&&y&&t.log("tauG1: "+y);await Fe(a),await Oe(a,3);const v=2**e;for(let y=0;y<v;y++)await a.write(c),t&&y%1e5==0&&y&&t.log("tauG2: "+y);await Fe(a),await Oe(a,4);const o=2**e;for(let y=0;y<o;y++)await a.write(n),t&&y%1e5==0&&y&&t.log("alphaTauG1: "+y);await Fe(a),await Oe(a,5);const h=2**e;for(let y=0;y<h;y++)await a.write(n),t&&y%1e5==0&&y&&t.log("betaTauG1: "+y);await Fe(a),await Oe(a,6),await a.write(c),await Fe(a),await Oe(a,7),await a.writeULE32(0),await Fe(a),await a.close();const g=ks(i,e,t);return t&&t.debug(Pr(Te.exports(64).digest(),"Blank Contribution Hash:")),t&&t.info(Pr(g,"First Contribution Hash:")),g}async function kA(i,e,r){await Te.exports.ready();const{fd:t,sections:a}=await gr(i,"ptau",1),{curve:n,power:c}=await Wi(t,a),u=await Ns(t,n,a);let v,o;u.length==0?(v=Te.exports(64).digest(),o=ks(n,c)):(v=u[u.length-1].responseHash,o=u[u.length-1].nextChallenge),r&&r.info(Pr(v,"Last Response Hash: ")),r&&r.info(Pr(o,"New Challenge Hash: "));const h=await Ts(e),g=Te.exports(64);await h.write(v),g.update(v),await _(2,"G1",2**c*2-1,"tauG1"),await _(3,"G2",2**c,"tauG2"),await _(4,"G1",2**c,"alphaTauG1"),await _(5,"G1",2**c,"betaTauG1"),await _(6,"G2",1,"betaG2"),await t.close(),await h.close();const y=g.digest();if(!pa(o,y))throw r&&r.info(Pr(y,"Calc Curret Challenge Hash: ")),r&&r.error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one"),new Error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one");return o;async function _(A,S,T,B){const M=n[S],R=M.F.n8*2,P=Math.floor((1<<24)/R);await yr(t,a,A);for(let D=0;D<T;D+=P){r&&r.debug(`Exporting ${B}: ${D}/${T}`);const q=Math.min(T-D,P);let k;k=await t.read(q*R),k=await M.batchLEMtoU(k),await h.write(k),g.update(k)}await br(t)}}async function PA(i,e,r,t,a,n){await Te.exports.ready();const c=new Uint8Array(64);for(let d=0;d<64;d++)c[d]=255;const{fd:u,sections:v}=await gr(i,"ptau",1),{curve:o,power:h}=await Wi(u,v),g=await Ns(u,o,v),y={};t&&(y.name=t);const _=o.F1.n8*2,A=o.F1.n8,S=o.F2.n8*2,T=o.F2.n8,B=await Ca(e);if(B.totalSize!=64+(2**h*2-1)*A+2**h*T+2**h*A+2**h*A+T+_*6+S*3)throw new Error("Size of the contribution is invalid");let M;g.length>0?M=g[g.length-1].nextChallenge:M=ks(o,h,n);const R=await bi(r,"ptau",1,a?7:2);await ja(R,o,h);const P=await B.read(64);if(pa(c,M)&&(M=P,g[g.length-1].nextChallenge=M),!pa(P,M))throw new Error("Wrong contribution. This contribution is not based on the previous hash");const D=new Te.exports(64);D.update(P);const q=[];let k;k=await G(B,R,"G1",2,2**h*2-1,[1],"tauG1"),y.tauG1=k[0],k=await G(B,R,"G2",3,2**h,[1],"tauG2"),y.tauG2=k[0],k=await G(B,R,"G1",4,2**h,[0],"alphaG1"),y.alphaG1=k[0],k=await G(B,R,"G1",5,2**h,[0],"betaG1"),y.betaG1=k[0],k=await G(B,R,"G2",6,1,[0],"betaG2"),y.betaG2=k[0],y.partialHash=D.getPartialHash();const U=await B.read(o.F1.n8*2*6+o.F2.n8*2*3);y.key=l6(U,0,o,!1),D.update(new Uint8Array(U));const O=D.digest();if(n&&n.info(Pr(O,"Contribution Response Hash imported: ")),a){const d=new Te.exports(64);d.update(O),await l(d,R,"G1",2,2**h*2-1,"tauG1",n),await l(d,R,"G2",3,2**h,"tauG2",n),await l(d,R,"G1",4,2**h,"alphaTauG1",n),await l(d,R,"G1",5,2**h,"betaTauG1",n),await l(d,R,"G2",6,1,"betaG2",n),y.nextChallenge=d.digest(),n&&n.info(Pr(y.nextChallenge,"Next Challenge Hash: "))}else y.nextChallenge=c;return g.push(y),await R1(R,o,g),await B.close(),await R.close(),await u.close(),y.nextChallenge;async function G(d,p,m,w,x,b,f){return a?await E(d,p,m,w,x,b,f):await s(d,p,m,w,x,b,f)}async function E(d,p,m,w,x,b,f){const C=o[m],F=C.F.n8,z=C.F.n8*2,W=[];await Oe(p,w);const $=Math.floor((1<<24)/z);q[w]=p.pos;for(let I=0;I<x;I+=$){n&&n.debug(`Importing ${f}: ${I}/${x}`);const K=Math.min(x-I,$),N=await d.read(K*F);D.update(N);const X=await C.batchCtoLEM(N);await p.write(X);for(let Q=0;Q<b.length;Q++){const L=b[Q];if(L>=I&&L<I+K){const V=C.fromRprLEM(X,(L-I)*z);W.push(V)}}}return await Fe(p),W}async function s(d,p,m,w,x,b,f){const C=o[m],F=C.F.n8,z=[],W=Math.floor((1<<24)/F);for(let $=0;$<x;$+=W){n&&n.debug(`Importing ${f}: ${$}/${x}`);const I=Math.min(x-$,W),K=await d.read(I*F);D.update(K);for(let N=0;N<b.length;N++){const X=b[N];if(X>=$&&X<$+I){const Q=C.fromRprCompressed(K,(X-$)*F);z.push(Q)}}}return z}async function l(d,p,m,w,x,b,f){const C=o[m],F=C.F.n8*2,z=Math.floor((1<<24)/F),W=p.pos;p.pos=q[w];for(let $=0;$<x;$+=z){f&&f.debug(`Hashing ${b}: ${$}/${x}`);const I=Math.min(x-$,z),K=await p.read(I*F),N=await C.batchLEMtoU(K);d.update(N)}p.pos=W}}const Fi=r6;async function xm(i,e,r,t){let a;if(e.type==1){const n=await c6(i,r.nextChallenge,e.beaconHash,e.numIterationsExp);if(!i.G1.eq(e.key.tau.g1_s,n.tau.g1_s))return t&&t.error(`BEACON key (tauG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!i.G1.eq(e.key.tau.g1_sx,n.tau.g1_sx))return t&&t.error(`BEACON key (tauG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!i.G2.eq(e.key.tau.g2_spx,n.tau.g2_spx))return t&&t.error(`BEACON key (tauG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!i.G1.eq(e.key.alpha.g1_s,n.alpha.g1_s))return t&&t.error(`BEACON key (alphaG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!i.G1.eq(e.key.alpha.g1_sx,n.alpha.g1_sx))return t&&t.error(`BEACON key (alphaG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!i.G2.eq(e.key.alpha.g2_spx,n.alpha.g2_spx))return t&&t.error(`BEACON key (alphaG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!i.G1.eq(e.key.beta.g1_s,n.beta.g1_s))return t&&t.error(`BEACON key (betaG1_s) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!i.G1.eq(e.key.beta.g1_sx,n.beta.g1_sx))return t&&t.error(`BEACON key (betaG1_sx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1;if(!i.G2.eq(e.key.beta.g2_spx,n.beta.g2_spx))return t&&t.error(`BEACON key (betaG2_spx) is not generated correctly in challenge #${e.id}  ${e.name||""}`),!1}return e.key.tau.g2_sp=i.G2.toAffine(Wf(i,0,r.nextChallenge,e.key.tau.g1_s,e.key.tau.g1_sx)),e.key.alpha.g2_sp=i.G2.toAffine(Wf(i,1,r.nextChallenge,e.key.alpha.g1_s,e.key.alpha.g1_sx)),e.key.beta.g2_sp=i.G2.toAffine(Wf(i,2,r.nextChallenge,e.key.beta.g1_s,e.key.beta.g1_sx)),a=await Fi(i,e.key.tau.g1_s,e.key.tau.g1_sx,e.key.tau.g2_sp,e.key.tau.g2_spx),a!==!0?(t&&t.error("INVALID key (tau) in challenge #"+e.id),!1):(a=await Fi(i,e.key.alpha.g1_s,e.key.alpha.g1_sx,e.key.alpha.g2_sp,e.key.alpha.g2_spx),a!==!0?(t&&t.error("INVALID key (alpha) in challenge #"+e.id),!1):(a=await Fi(i,e.key.beta.g1_s,e.key.beta.g1_sx,e.key.beta.g2_sp,e.key.beta.g2_spx),a!==!0?(t&&t.error("INVALID key (beta) in challenge #"+e.id),!1):(a=await Fi(i,r.tauG1,e.tauG1,e.key.tau.g2_sp,e.key.tau.g2_spx),a!==!0?(t&&t.error("INVALID tau*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(a=await Fi(i,e.key.tau.g1_s,e.key.tau.g1_sx,r.tauG2,e.tauG2),a!==!0?(t&&t.error("INVALID tau*G2. challenge #"+e.id+" It does not follow the previous contribution"),!1):(a=await Fi(i,r.alphaG1,e.alphaG1,e.key.alpha.g2_sp,e.key.alpha.g2_spx),a!==!0?(t&&t.error("INVALID alpha*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(a=await Fi(i,r.betaG1,e.betaG1,e.key.beta.g2_sp,e.key.beta.g2_spx),a!==!0?(t&&t.error("INVALID beta*G1. challenge #"+e.id+" It does not follow the previous contribution"),!1):(a=await Fi(i,e.key.beta.g1_s,e.key.beta.g1_sx,r.betaG2,e.betaG2),a!==!0?(t&&t.error("INVALID beta*G2. challenge #"+e.id+"It does not follow the previous contribution"),!1):(t&&t.info("Powers Of tau file OK!"),!0))))))))}async function UA(i,e){let r;await Te.exports.ready();const{fd:t,sections:a}=await gr(i,"ptau",1),{curve:n,power:c,ceremonyPower:u}=await Wi(t,a),v=await Ns(t,n,a);e&&e.debug("power: 2**"+c),e&&e.debug("Computing initial contribution hash");const o={tauG1:n.G1.g,tauG2:n.G2.g,alphaG1:n.G1.g,betaG1:n.G1.g,betaG2:n.G2.g,nextChallenge:ks(n,u,e),responseHash:Te.exports(64).digest()};if(v.length==0)return e&&e.error("This file has no contribution! It cannot be used in production"),!1;let h;v.length>1?h=v[v.length-2]:h=o;const g=v[v.length-1];if(e&&e.debug("Validating contribution #"+v[v.length-1].id),!await xm(n,g,h,e))return!1;const _=Te.exports(64);_.update(g.responseHash),e&&e.debug("Verifying powers in tau*G1 section");const A=await q(2,"G1","tauG1",2**c*2-1,[0,1],e);if(r=await Fi(n,A.R1,A.R2,n.G2.g,g.tauG2),r!==!0)return e&&e.error("tauG1 section. Powers do not match"),!1;if(!n.G1.eq(n.G1.g,A.singularPoints[0]))return e&&e.error("First element of tau*G1 section must be the generator"),!1;if(!n.G1.eq(g.tauG1,A.singularPoints[1]))return e&&e.error("Second element of tau*G1 section does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in tau*G2 section");const S=await q(3,"G2","tauG2",2**c,[0,1],e);if(r=await Fi(n,n.G1.g,g.tauG1,S.R1,S.R2),r!==!0)return e&&e.error("tauG2 section. Powers do not match"),!1;if(!n.G2.eq(n.G2.g,S.singularPoints[0]))return e&&e.error("First element of tau*G2 section must be the generator"),!1;if(!n.G2.eq(g.tauG2,S.singularPoints[1]))return e&&e.error("Second element of tau*G2 section does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in alpha*tau*G1 section");const T=await q(4,"G1","alphatauG1",2**c,[0],e);if(r=await Fi(n,T.R1,T.R2,n.G2.g,g.tauG2),r!==!0)return e&&e.error("alphaTauG1 section. Powers do not match"),!1;if(!n.G1.eq(g.alphaG1,T.singularPoints[0]))return e&&e.error("First element of alpha*tau*G1 section (alpha*G1) does not match the one in the contribution section"),!1;e&&e.debug("Verifying powers in beta*tau*G1 section");const B=await q(5,"G1","betatauG1",2**c,[0],e);if(r=await Fi(n,B.R1,B.R2,n.G2.g,g.tauG2),r!==!0)return e&&e.error("betaTauG1 section. Powers do not match"),!1;if(!n.G1.eq(g.betaG1,B.singularPoints[0]))return e&&e.error("First element of beta*tau*G1 section (beta*G1) does not match the one in the contribution section"),!1;const M=await D(e);if(!n.G2.eq(g.betaG2,M))return e&&e.error("betaG2 element in betaG2 section does not match the one in the contribution section"),!1;const R=_.digest();if(c==u&&!pa(R,g.nextChallenge))return e&&e.error("Hash of the values does not match the next challenge of the last contributor in the contributions section"),!1;e&&e.info(Pr(R,"Next challenge hash: ")),P(g,h);for(let U=v.length-2;U>=0;U--){const O=v[U],G=U>0?v[U-1]:o;if(!await xm(n,O,G,e))return!1;P(O,G)}if(e&&e.info("-----------------------------------------------------"),!a[12]||!a[13]||!a[14]||!a[15])e&&e.warn(`this file does not contain phase2 precalculated values. Please run: 
   snarkjs "powersoftau preparephase2" to prepare this file to be used in the phase2 ceremony.`);else{let U;if(U=await k("G1",2,12,"tauG1",e),!U||(U=await k("G2",3,13,"tauG2",e),!U)||(U=await k("G1",4,14,"alphaTauG1",e),!U)||(U=await k("G1",5,15,"betaTauG1",e),!U))return!1}return await t.close(),e&&e.info("Powers of Tau Ok!"),!0;function P(U,O){if(!e)return;e.info("-----------------------------------------------------"),e.info(`Contribution #${U.id}: ${U.name||""}`),e.info(Pr(U.nextChallenge,"Next Challenge: "));const G=new Uint8Array(n.G1.F.n8*2*6+n.G2.F.n8*2*3);Rs(G,0,n,U.key,!1);const E=Te.exports(64);E.setPartialHash(U.partialHash),E.update(G);const s=E.digest();e.info(Pr(s,"Response Hash:")),e.info(Pr(O.nextChallenge,"Response Hash:")),U.type==1&&(e.info(`Beacon generator: ${n6(U.beaconHash)}`),e.info(`Beacon iterations Exp: ${U.numIterationsExp}`))}async function D(U){const O=n.G2,G=O.F.n8*2,E=new Uint8Array(G);if(!a[6])throw U.error("File has no BetaG2 section"),new Error("File has no BetaG2 section");if(a[6].length>1)throw U.error("File has no BetaG2 section"),new Error("File has more than one GetaG2 section");t.pos=a[6][0].p;const s=await t.read(G),l=O.fromRprLEM(s);return O.toRprUncompressed(E,0,l),_.update(E),l}async function q(U,O,G,E,s,l){const p=n[O],m=p.F.n8*2;await yr(t,a,U);const w=[];let x=p.zero,b=p.zero,f=p.zero;for(let C=0;C<E;C+=65536){l&&l.debug(`points relations: ${G}: ${C}/${E} `);const F=Math.min(E-C,65536),z=await t.read(F*m),W=await p.batchLEMtoU(z);_.update(W);const $=ds(4*(F-1));if(C>0){const N=p.fromRprLEM(z,0),X=al(ds(4),0);x=p.add(x,p.timesScalar(f,X)),b=p.add(b,p.timesScalar(N,X))}const I=await p.multiExpAffine(z.slice(0,(F-1)*m),$),K=await p.multiExpAffine(z.slice(m),$);x=p.add(x,I),b=p.add(b,K),f=p.fromRprLEM(z,(F-1)*m);for(let N=0;N<s.length;N++){const X=s[N];if(X>=C&&X<C+F){const Q=p.fromRprLEM(z,(X-C)*m);w.push(Q)}}}return await br(t),{R1:x,R2:b,singularPoints:w}}async function k(U,O,G,E,s){s&&s.debug(`Verifying phase2 calculated values ${E}...`);const l=n[U],d=l.F.n8*2,p=new Array(8);for(let w=0;w<8;w++)p[w]=al(ds(4),0);for(let w=0;w<=c;w++)if(!await m(w))return!1;if(O==2&&!await m(c+1))return!1;return!0;async function m(w){s&&s.debug(`Power ${w}...`);const x=n.Fr.n8,b=2**w;let f=new Uint32Array(b),C,F=new Ka(p);s&&s.debug(`Creating random numbers Powers${w}...`);for(let K=0;K<b;K++)w==c+1&&K==b-1?f[K]=0:f[K]=F.nextU32();f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength),s&&s.debug(`reading points Powers${w}...`),await yr(t,a,O),C=new ee(b*d),w==c+1?(await t.readToBuffer(C,0,(b-1)*d),C.set(n.G1.zeroAffine,(b-1)*d)):await t.readToBuffer(C,0,b*d),await br(t,!0);const z=await l.multiExpAffine(C,f,s,E+"_"+w);f=new ee(b*x),F=new Ka(p);const W=new Uint8Array(4),$=new DataView(W.buffer);s&&s.debug(`Creating random numbers Powers${w}...`);for(let K=0;K<b;K++)(K!=b-1||w!=c+1)&&($.setUint32(0,F.nextU32(),!0),f.set(W,K*x));s&&s.debug(`batchToMontgomery ${w}...`),f=await n.Fr.batchToMontgomery(f),s&&s.debug(`fft ${w}...`),f=await n.Fr.fft(f),s&&s.debug(`batchFromMontgomery ${w}...`),f=await n.Fr.batchFromMontgomery(f),s&&s.debug(`reading points Lagrange${w}...`),await yr(t,a,G),t.pos+=d*(2**w-1),await t.readToBuffer(C,0,b*d),await br(t,!0);const I=await l.multiExpAffine(C,f,s,E+"_"+w+"_transformed");return l.eq(z,I)?!0:(s&&s.error("Phase2 caclutation does not match with powers of tau"),!1)}}}async function ll(i,e,r,t,a,n,c,u,v,o){const g=a[n],y=g.F.n8*2,_=e[t][0].size/y;await yr(i,e,t),await Oe(r,t);let A=c;for(let S=0;S<_;S+=65536){o&&o.debug(`Applying key: ${v}: ${S}/${_}`);const T=Math.min(_-S,65536);let B;B=await i.read(T*y),B=await g.batchApplyKey(B,A,u),await r.write(B),A=a.Fr.mul(A,a.Fr.exp(u,T))}await Fe(r),await br(i)}async function Ta(i,e,r,t,a,n,c,u,v,o,h){const g=t[a],y=g.F.n8*2,_=Math.floor((1<<20)/y);let A=c;for(let S=0;S<n;S+=_){h&&h.debug(`Applying key ${o}: ${S}/${n}`);const T=Math.min(n-S,_),B=await i.read(T*y),M=await g.batchUtoLEM(B),R=await g.batchApplyKey(M,A,u);let P;v=="COMPRESSED"?P=await g.batchLEMtoC(R):P=await g.batchLEMtoU(R),r&&r.update(P),await e.write(P),A=t.Fr.mul(A,t.Fr.exp(u,T))}}async function DA(i,e,r,t,a){await Te.exports.ready();const n=await Ca(e),c=i.F1.n64*8*2,u=i.F2.n64*8*2,v=(n.totalSize+c-64-u)/(4*c+u);let o=v,h=0;for(;o>1;)o=o/2,h+=1;if(2**h!=v)throw new Error("Invalid file size");a&&a.debug("Power to tau size: "+h);const g=await $l(t),y=await Ts(r),_=Te.exports(64);for(let P=0;P<n.totalSize;P+=n.pageSize){a&&a.debug(`Hashing challenge ${P}/${n.totalSize}`);const D=Math.min(n.totalSize-P,n.pageSize),q=await n.read(D);_.update(q)}const A=await n.read(64,0);a&&a.info(Pr(A,"Claimed Previous Response Hash: "));const S=_.digest();a&&a.info(Pr(S,"Current Challenge Hash: "));const T=T1(i,S,g);a&&["tau","alpha","beta"].forEach(P=>{a.debug(P+".g1_s: "+i.G1.toString(T[P].g1_s,16)),a.debug(P+".g1_sx: "+i.G1.toString(T[P].g1_sx,16)),a.debug(P+".g2_sp: "+i.G2.toString(T[P].g2_sp,16)),a.debug(P+".g2_spx: "+i.G2.toString(T[P].g2_spx,16)),a.debug("")});const B=Te.exports(64);await y.write(S),B.update(S),await Ta(n,y,B,i,"G1",2**h*2-1,i.Fr.one,T.tau.prvKey,"COMPRESSED","tauG1",a),await Ta(n,y,B,i,"G2",2**h,i.Fr.one,T.tau.prvKey,"COMPRESSED","tauG2",a),await Ta(n,y,B,i,"G1",2**h,T.alpha.prvKey,T.tau.prvKey,"COMPRESSED","alphaTauG1",a),await Ta(n,y,B,i,"G1",2**h,T.beta.prvKey,T.tau.prvKey,"COMPRESSED","betaTauG1",a),await Ta(n,y,B,i,"G2",1,T.beta.prvKey,T.tau.prvKey,"COMPRESSED","betaTauG2",a);const M=new Uint8Array(i.F1.n8*2*6+i.F2.n8*2*3);Rs(M,0,i,T,!1),await y.write(M),B.update(M);const R=B.digest();a&&a.info(Pr(R,"Contribution Response Hash: ")),await y.close(),await n.close()}async function OA(i,e,r,t,a,n){const c=i6(t);if(c.byteLength==0||c.byteLength*2!=t.length)return n&&n.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(c.length>=256)return n&&n.error("Maximum length of beacon hash is 255 bytes"),!1;if(a=parseInt(a),a<10||a>63)return n&&n.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;await Te.exports.ready();const{fd:u,sections:v}=await gr(i,"ptau",1),{curve:o,power:h,ceremonyPower:g}=await Wi(u,v);if(h!=g)return n&&n.error("This file has been reduced. You cannot contribute into a reduced file."),!1;v[12]&&n&&n.warn("Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");const y=await Ns(u,o,v),_={name:r,type:1,numIterationsExp:a,beaconHash:c};let A;y.length>0?A=y[y.length-1].nextChallenge:A=ks(o,h,n),_.key=await c6(o,A,c,a);const S=new Te.exports(64);S.update(A);const T=await bi(e,"ptau",1,7);await ja(T,o,h);const B=[];let M;M=await q(2,"G1",2**h*2-1,o.Fr.e(1),_.key.tau.prvKey,"tauG1",n),_.tauG1=M[1],M=await q(3,"G2",2**h,o.Fr.e(1),_.key.tau.prvKey,"tauG2",n),_.tauG2=M[1],M=await q(4,"G1",2**h,_.key.alpha.prvKey,_.key.tau.prvKey,"alphaTauG1",n),_.alphaG1=M[0],M=await q(5,"G1",2**h,_.key.beta.prvKey,_.key.tau.prvKey,"betaTauG1",n),_.betaG1=M[0],M=await q(6,"G2",1,_.key.beta.prvKey,_.key.tau.prvKey,"betaTauG2",n),_.betaG2=M[0],_.partialHash=S.getPartialHash();const R=new Uint8Array(o.F1.n8*2*6+o.F2.n8*2*3);Rs(R,0,o,_.key,!1),S.update(new Uint8Array(R));const P=S.digest();n&&n.info(Pr(P,"Contribution Response Hash imported: "));const D=new Te.exports(64);return D.update(P),await k(T,"G1",2,2**h*2-1,"tauG1",n),await k(T,"G2",3,2**h,"tauG2",n),await k(T,"G1",4,2**h,"alphaTauG1",n),await k(T,"G1",5,2**h,"betaTauG1",n),await k(T,"G2",6,1,"betaG2",n),_.nextChallenge=D.digest(),n&&n.info(Pr(_.nextChallenge,"Next Challenge Hash: ")),y.push(_),await R1(T,o,y),await u.close(),await T.close(),P;async function q(U,O,G,E,s,l,d){const p=[];u.pos=v[U][0].p,await Oe(T,U),B[U]=T.pos;const m=o[O],w=m.F.n8*2,x=Math.floor((1<<20)/w);let b=E;for(let f=0;f<G;f+=x){d&&d.debug(`applying key${l}: ${f}/${G}`);const C=Math.min(G-f,x),F=await u.read(C*w),z=await m.batchApplyKey(F,b,s),W=T.write(z),$=await m.batchLEMtoC(z);if(S.update($),await W,f==0)for(let I=0;I<Math.min(2,G);I++)p.push(m.fromRprLEM(z,I*w));b=o.Fr.mul(b,o.Fr.exp(s,C))}return await Fe(T),p}async function k(U,O,G,E,s,l){const d=o[O],p=d.F.n8*2,m=Math.floor((1<<24)/p),w=U.pos;U.pos=B[G];for(let x=0;x<E;x+=m){l&&l.debug(`Hashing ${s}: ${x}/${E}`);const b=Math.min(E-x,m),f=await U.read(b*p),C=await d.batchLEMtoU(f);D.update(C)}U.pos=w}}async function FA(i,e,r,t,a){await Te.exports.ready();const{fd:n,sections:c}=await gr(i,"ptau",1),{curve:u,power:v,ceremonyPower:o}=await Wi(n,c);if(v!=o)throw a&&a.error("This file has been reduced. You cannot contribute into a reduced file."),new Error("This file has been reduced. You cannot contribute into a reduced file.");c[12]&&a&&a.warn("WARNING: Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");const h=await Ns(n,u,c),g={name:r,type:0};let y;const _=await $l(t);h.length>0?y=h[h.length-1].nextChallenge:y=ks(u,v,a),g.key=T1(u,y,_);const A=new Te.exports(64);A.update(y);const S=await bi(e,"ptau",1,7);await ja(S,u,v);const T=[];let B;B=await D(2,"G1",2**v*2-1,u.Fr.e(1),g.key.tau.prvKey,"tauG1"),g.tauG1=B[1],B=await D(3,"G2",2**v,u.Fr.e(1),g.key.tau.prvKey,"tauG2"),g.tauG2=B[1],B=await D(4,"G1",2**v,g.key.alpha.prvKey,g.key.tau.prvKey,"alphaTauG1"),g.alphaG1=B[0],B=await D(5,"G1",2**v,g.key.beta.prvKey,g.key.tau.prvKey,"betaTauG1"),g.betaG1=B[0],B=await D(6,"G2",1,g.key.beta.prvKey,g.key.tau.prvKey,"betaTauG2"),g.betaG2=B[0],g.partialHash=A.getPartialHash();const M=new Uint8Array(u.F1.n8*2*6+u.F2.n8*2*3);Rs(M,0,u,g.key,!1),A.update(new Uint8Array(M));const R=A.digest();a&&a.info(Pr(R,"Contribution Response Hash imported: "));const P=new Te.exports(64);return P.update(R),await q(S,"G1",2,2**v*2-1,"tauG1"),await q(S,"G2",3,2**v,"tauG2"),await q(S,"G1",4,2**v,"alphaTauG1"),await q(S,"G1",5,2**v,"betaTauG1"),await q(S,"G2",6,1,"betaG2"),g.nextChallenge=P.digest(),a&&a.info(Pr(g.nextChallenge,"Next Challenge Hash: ")),h.push(g),await R1(S,u,h),await n.close(),await S.close(),R;async function D(k,U,O,G,E,s){const l=[];n.pos=c[k][0].p,await Oe(S,k),T[k]=S.pos;const d=u[U],p=d.F.n8*2,m=Math.floor((1<<20)/p);let w=G;for(let x=0;x<O;x+=m){a&&a.debug(`processing: ${s}: ${x}/${O}`);const b=Math.min(O-x,m),f=await n.read(b*p),C=await d.batchApplyKey(f,w,E),F=S.write(C),z=await d.batchLEMtoC(C);if(A.update(z),await F,x==0)for(let W=0;W<Math.min(2,O);W++)l.push(d.fromRprLEM(C,W*p));w=u.Fr.mul(w,u.Fr.exp(E,b))}return await Fe(S),l}async function q(k,U,O,G,E){const s=u[U],l=s.F.n8*2,d=Math.floor((1<<24)/l),p=k.pos;k.pos=T[O];for(let m=0;m<G;m+=d){a&&m&&a.debug(`Hashing ${E}: `+m);const w=Math.min(G-m,d),x=await k.read(w*l),b=await s.batchLEMtoU(x);P.update(b)}k.pos=p}}async function qA(i,e,r){const{fd:t,sections:a}=await gr(i,"ptau",1),{curve:n,power:c}=await Wi(t,a),u=await bi(e,"ptau",1,11);await ja(u,n,c),await tr(t,a,u,2),await tr(t,a,u,3),await tr(t,a,u,4),await tr(t,a,u,5),await tr(t,a,u,6),await tr(t,a,u,7),await v(2,12,"G1","tauG1"),await v(3,13,"G2","tauG2"),await v(4,14,"G1","alphaTauG1"),await v(5,15,"G1","betaTauG1"),await t.close(),await u.close();return;async function v(o,h,g,y){r&&r.debug("Starting section: "+y),await Oe(u,h);for(let A=0;A<=c;A++)await _(A);o==2&&await _(c+1),await Fe(u);async function _(A){const S=2**A,T=n[g],B=T.F.n8*2;let M;M=new ee(S*B),await yr(t,a,o),o==2&&A==c+1?(await t.readToBuffer(M,0,(S-1)*B),M.set(n.G1.zeroAffine,(S-1)*B)):await t.readToBuffer(M,0,S*B),await br(t,!0),M=await T.lagrangeEvaluations(M,"affine","affine",r,y),await u.write(M)}}}async function zA(i,e,r){const{fd:t,sections:a}=await gr(i,"ptau",1),{curve:n,power:c,ceremonyPower:u}=await Wi(t,a),v=n.G1.F.n8*2,o=n.G2.F.n8*2;for(let g=1;g<c;g++)await h(g);return await t.close(),!0;async function h(g){let y=g.toString();for(;y.length<2;)y="0"+y;r&&r.debug("Writing Power: "+y);const _=await bi(e+y+".ptau","ptau",1,11);await ja(_,n,g,u),await tr(t,a,_,2,(2**g*2-1)*v),await tr(t,a,_,3,2**g*o),await tr(t,a,_,4,2**g*v),await tr(t,a,_,5,2**g*v),await tr(t,a,_,6,o),await tr(t,a,_,7),await tr(t,a,_,12,(2**(g+1)*2-1)*v),await tr(t,a,_,13,(2**g*2-1)*o),await tr(t,a,_,14,(2**g*2-1)*v),await tr(t,a,_,15,(2**g*2-1)*v),await _.close()}}async function VA(i,e,r){const{fd:t,sections:a}=await gr(i,"ptau",1),{curve:n,power:c}=await Wi(t,a),u=await bi(e,"ptau",1,11);await ja(u,n,c),await tr(t,a,u,2),await tr(t,a,u,3),await tr(t,a,u,4),await tr(t,a,u,5),await tr(t,a,u,6),await tr(t,a,u,7),await v(2,12,"G1","tauG1"),await tr(t,a,u,13),await tr(t,a,u,14),await tr(t,a,u,15),await t.close(),await u.close();return;async function v(o,h,g,y){r&&r.debug("Starting section: "+y),await Oe(u,h);const _=a[h][0].size,A=t.pageSize;await yr(t,a,h);for(let T=0;T<_;T+=A){const B=Math.min(_-T,A),M=await t.read(B);await u.write(M)}await br(t),await S(c+1),await Fe(u);async function S(T){const B=2**T,M=n[g],R=M.F.n8*2;let P;P=new ee(B*R),await yr(t,a,o),T==c+1?(await t.readToBuffer(P,0,(B-1)*R),P.set(n.G1.zeroAffine,(B-1)*R)):await t.readToBuffer(P,0,B*R),await br(t,!0),P=await M.lagrangeEvaluations(P,"affine","affine",r,y),await u.write(P)}}}async function GA(i,e){const{fd:r,sections:t}=await gr(i,"ptau",1),{curve:a,power:n}=await Wi(r,t),c={};return c.q=a.q,c.power=n,c.contributions=await Ns(r,a,t),c.tauG1=await u(2,"G1",2**n*2-1,"tauG1"),c.tauG2=await u(3,"G2",2**n,"tauG2"),c.alphaTauG1=await u(4,"G1",2**n,"alphaTauG1"),c.betaTauG1=await u(5,"G1",2**n,"betaTauG1"),c.betaG2=await u(6,"G2",1,"betaG2"),c.lTauG1=await v(12,"G1","lTauG1"),c.lTauG2=await v(13,"G2","lTauG2"),c.lAlphaTauG1=await v(14,"G1","lAlphaTauG2"),c.lBetaTauG1=await v(15,"G1","lBetaTauG2"),await r.close(),sl(a.Fr,c);async function u(o,h,g,y){const _=a[h],A=_.F.n8*2,S=[];await yr(r,t,o);for(let T=0;T<g;T++){e&&T&&T%1e4==0&&console.log(`${y}: `+T);const B=await r.read(A);S.push(_.fromRprLEM(B,0))}return await br(r),S}async function v(o,h,g){const y=a[h],_=y.F.n8*2,A=[];await yr(r,t,o);for(let S=0;S<=n;S++){e&&console.log(`${g}: Power: ${S}`),A[S]=[];const T=2**S;for(let B=0;B<T;B++){e&&B&&B%1e4==0&&console.log(`${g}: ${B}/${T}`);const M=await r.read(_);A[S].push(y.fromRprLEM(M,0))}}return await br(r,!0),A}}var KA=Object.freeze({__proto__:null,newAccumulator:NA,exportChallenge:kA,importResponse:PA,verify:UA,challengeContribute:DA,beacon:OA,contribute:FA,preparePhase2:qA,truncate:zA,convert:VA,exportJson:GA});function HA(i,e,r){for(let a=0;a<i.constraints.length;a++)t(i.constraints[a]);function t(a){const n=u=>{let v="";return Object.keys(u).forEach(h=>{let g=e.varIdx2Name[h];g=="one"&&(g="1");let y=i.curve.Fr.toString(u[h]);y=="1"&&(y=""),y=="-1"&&(y="-"),v!=""&&y[0]!="-"&&(y="+"+y),v!=""&&(y=" "+y),v=v+y+g}),v},c=`[ ${n(a[0])} ] * [ ${n(a[1])} ] - [ ${n(a[2])} ] = 0`;r&&r.info(c)}}const cn=262144,QA={get:function(i,e){return isNaN(e)?i[e]:i.getElement(e)},set:function(i,e,r){return isNaN(e)?(i[e]=r,!0):i.setElement(e,r)}};class $A{constructor(e){this.length=e||0,this.arr=new Array(cn);for(let r=0;r<e;r+=cn)this.arr[r/cn]=new Array(Math.min(cn,e-r));return this}push(){for(let e=0;e<arguments.length;e++)this.setElement(this.length,arguments[e])}slice(e,r){const t=new Array(r-e);for(let a=e;a<r;a++)t[a-e]=this.getElement(a);return t}getElement(e){e=parseInt(e);const r=Math.floor(e/cn),t=e%cn;return this.arr[r]?this.arr[r][t]:void 0}setElement(e,r){e=parseInt(e);const t=Math.floor(e/cn);this.arr[t]||(this.arr[t]=new Array(cn));const a=e%cn;return this.arr[t][a]=r,e>=this.length&&(this.length=e+1),!0}getKeys(){const e=new u6;for(let r=0;r<this.arr.length;r++)if(this.arr[r])for(let t=0;t<this.arr[r].length;t++)typeof this.arr[r][t]<"u"&&e.push(r*cn+t);return e}}class u6{constructor(e){const r=new $A(e);return new Proxy(r,QA)}}var N1=u6;const vd=4,gd=5;async function h6(i,e,r){let t;typeof r=="object"?t=r:typeof r>"u"?t={singleThread:!1}:t={singleThread:r};const a={};if(await yr(i,e,1),a.n8=await i.readULE32(),a.prime=await Sn(i,a.n8),t.F){if(t.F.p!=a.prime)throw new Error("Different Prime");a.F=t.F}else if(t.getFieldFromPrime)a.F=await t.getFieldFromPrime(a.prime,t.singleThread);else if(t.getCurveFromPrime)a.curve=await t.getCurveFromPrime(a.prime,t.singleThread),a.F=a.curve.Fr;else try{a.curve=await mE(a.prime,t.singleThread),a.F=a.curve.Fr}catch{a.F=new w1(a.prime)}return a.nVars=await i.readULE32(),a.nOutputs=await i.readULE32(),a.nPubInputs=await i.readULE32(),a.nPrvInputs=await i.readULE32(),a.nLabels=await i.readULE64(),a.nConstraints=await i.readULE32(),a.useCustomGates=typeof e[vd]<"u"&&e[vd]!==null&&typeof e[gd]<"u"&&e[gd]!==null,await br(i),a}async function ZA(i,e,r,t,a){let n;typeof t=="object"?n=t:typeof t>"u"?n={}:n={logger:t,loggerCtx:a};const c=await fr(i,e,2);let u=0,v;r.nConstraints>1<<20?v=new N1:v=[];for(let g=0;g<r.nConstraints;g++){n.logger&&g%1e5==0&&n.logger.info(`${n.loggerCtx}: Loading constraints: ${g}/${r.nConstraints}`);const y=o();v.push(y)}return v;function o(){const g=[];return g[0]=h(),g[1]=h(),g[2]=h(),g}function h(){const g={},y=c.slice(u,u+4);u+=4;const A=new DataView(y.buffer).getUint32(0,!0),S=c.slice(u,u+(4+r.n8)*A);u+=(4+r.n8)*A;const T=new DataView(S.buffer);for(let B=0;B<A;B++){const M=T.getUint32(B*(4+r.n8),!0),R=r.F.fromRprLE(S,B*(4+r.n8)+4);g[M]=R}return g}}async function jA(i,e,r,t,a){let n;typeof t=="object"?n=t:typeof t>"u"?n={}:n={logger:t,loggerCtx:a};const c=await fr(i,e,3);let u=0,v;r.nVars>1<<20?v=new N1:v=[];for(let h=0;h<r.nVars;h++){n.logger&&h%1e4==0&&n.logger.info(`${n.loggerCtx}: Loading map: ${h}/${r.nVars}`);const g=o();v.push(g)}return v;function o(){const h=c.slice(u,u+8);u+=8;const g=new DataView(h.buffer),y=g.getUint32(0,!0);return g.getUint32(4,!0)*4294967296+y}}async function jl(i,e,r){if(typeof r!="object")throw new Error("readR1csFd: options must be an object");r.loadConstraints="loadConstraints"in r?r.loadConstraints:!0,r.loadMap="loadMap"in r?r.loadMap:!1,r.loadCustomGates="loadCustomGates"in r?r.loadCustomGates:!0;const t=await h6(i,e,r);return r.loadConstraints&&(t.constraints=await ZA(i,e,t,r)),r.loadMap&&(t.map=await jA(i,e,t,r)),r.loadCustomGates&&(t.useCustomGates?(t.customGates=await WA(i,e,t),t.customGatesUses=await YA(i,e,r)):(t.customGates=[],t.customGatesUses=[])),t}async function d6(i,e,r,t,a,n){let c;typeof e=="object"?c=e:typeof e>"u"?c={loadConstraints:!0,loadMap:!1,loadCustomGates:!0}:c={loadConstraints:e,loadMap:r,singleThread:t,logger:a,loggerCtx:n};const{fd:u,sections:v}=await gr(i,"r1cs",1),o=await jl(u,v,c);return await u.close(),o}async function WA(i,e,r){await yr(i,e,vd);let t=await i.readULE32(),a=[];for(let n=0;n<t;n++){let c={};c.templateName=await i.readString();let u=await i.readULE32();c.parameters=Array(u);let v=await i.read(r.n8*u);for(let o=0;o<u;o++)c.parameters[o]=r.F.fromRprLE(v,o*r.n8,r.n8);a.push(c)}return await br(i),a}async function YA(i,e,r){const t=await fr(i,e,gd),a=new Uint32Array(t.buffer,t.byteOffset,t.byteLength/4),n=a[0];let c=1,u;n>1<<20?u=new N1:u=[];for(let v=0;v<n;v++){r.logger&&v%1e5==0&&r.logger.info(`${r.loggerCtx}: Loading custom gate uses: ${v}/${n}`);let o={};o.id=a[c++];let h=a[c++];o.signals=[];for(let g=0;g<h;g++){const y=a[c++],_=a[c++];o.signals.push(_*4294967296+y)}u.push(o)}return u}const XA=Ae.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),JA=Ae.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");async function t9(i,e){const r=await d6(i);return Ae.eq(r.prime,JA)?e&&e.info("Curve: bn-128"):Ae.eq(r.prime,XA)?e&&e.info("Curve: bls12-381"):e&&e.info(`Unknown Curve. Prime: ${Ae.toString(r.prime)}`),e&&e.info(`# of Wires: ${r.nVars}`),e&&e.info(`# of Constraints: ${r.nConstraints}`),e&&e.info(`# of Private Inputs: ${r.nPrvInputs}`),e&&e.info(`# of Public Inputs: ${r.nPubInputs}`),e&&e.info(`# of Labels: ${r.nLabels}`),e&&e.info(`# of Outputs: ${r.nOutputs}`),r}async function e9(i,e){const r=await d6(i,!0,!0,!0,e),t=r.curve.Fr;return delete r.curve,delete r.F,sl(t,r)}var r9=Object.freeze({__proto__:null,print:HA,info:t9,exportJson:e9});async function Bf(i){const e={labelIdx2Name:["one"],varIdx2Name:["one"],componentIdx2Name:[]},r=await Ca(i),t=await r.read(r.totalSize),n=new TextDecoder("utf-8").decode(t).split(`
`);for(let u=0;u<n.length;u++){const v=n[u].split(",");v.length==4&&(e.varIdx2Name[v[1]]?e.varIdx2Name[v[1]]+="|"+v[3]:e.varIdx2Name[v[1]]=v[3],e.labelIdx2Name[v[0]]=v[3],e.componentIdx2Name[v[2]]||(e.componentIdx2Name[v[2]]=c(v[3])))}return await r.close(),e;function c(u){const v=u.split(".");return v.pop(),v.join(".")}}const{unstringifyBigInts:i9}=ri;async function n9(i,e,r,t,a,n){const c=i9(i),u=await Ca(e),v=await u.read(u.totalSize);await u.close();const o={...a,sanityCheck:!0};let h=await Bf(t);a.set&&(h||(h=await Bf(t)),o.logSetSignal=function(A,S){n&&n.info("SET "+h.labelIdx2Name[A]+" <-- "+S.toString())}),a.get&&(h||(h=await Bf(t)),o.logGetSignal=function(A,S){n&&n.info("GET "+h.labelIdx2Name[A]+" --> "+S.toString())}),a.trigger&&(h||(h=await Bf(t)),o.logStartComponent=function(A){n&&n.info("START: "+h.componentIdx2Name[A])},o.logFinishComponent=function(A){n&&n.info("FINISH: "+h.componentIdx2Name[A])}),o.sym=h;const g=await f6(v,o),y=await g.calculateWitness(c,!0),_=await bi(r,"wtns",2,2);await hA(_,y,g.prime),await _.close()}async function a9(i){return await pA(i)}async function s9(i,e,r){r&&r.info("WITNESS CHECKING STARTED"),r&&r.info("> Reading r1cs file");const{fd:t,sections:a}=await gr(i,"r1cs",1),n=await jl(t,a,{loadConstraints:!1,loadCustomGates:!1});r&&r.info("> Reading witness file");const{fd:c,sections:u}=await gr(e,"wtns",2),v=await Yo(c,u);if(!Ae.eq(n.prime,v.q))throw new Error("Curve of the witness does not match the curve of the proving key");const o=await fr(c,u,2);await c.close();const g=(await jb(n.prime)).Fr,y=g.n8,_=await fr(t,a,2);r&&(r.info("----------------------------"),r.info("  WITNESS CHECK"),r.info(`  Curve:          ${n.curve.name}`),r.info(`  Vars (wires):   ${n.nVars}`),r.info(`  Outputs:        ${n.nOutputs}`),r.info(`  Public Inputs:  ${n.nPubInputs}`),r.info(`  Private Inputs: ${n.nPrvInputs}`),r.info(`  Labels:         ${n.nLabels}`),r.info(`  Constraints:    ${n.nConstraints}`),r.info(`  Custom Gates:   ${n.useCustomGates}`),r.info("----------------------------")),r&&r.info("> Checking witness correctness");let A=0,S=!0;for(let R=0;R<n.nConstraints;R++){r&&R!==0&&R%5e5===0&&r.info(` processing r1cs constraints ${R}/${n.nConstraints}`);const P=B(),D=B(),q=B(),k=T(P),U=T(D),O=T(q);if(!g.eq(g.sub(g.mul(k,U),O),g.zero)){r.warn(" aborting checking process at constraint "+R),S=!1;break}}return t.close(),r&&(S?(r.info("WITNESS IS CORRECT"),r.info("WITNESS CHECKING FINISHED SUCCESSFULLY")):(r.warn("WITNESS IS NOT CORRECT"),r.warn("WITNESS CHECKING FINISHED UNSUCCESSFULLY"))),S;function T(R){let P=g.zero;return Object.keys(R).forEach(q=>{const k=M(q),U=R[q];P=g.add(P,g.mul(k,U))}),P}function B(){const R={},P=_.slice(A,A+4);A+=4;const q=new DataView(P.buffer).getUint32(0,!0),k=_.slice(A,A+(4+n.n8)*q);A+=(4+n.n8)*q;const U=new DataView(k.buffer);for(let O=0;O<q;O++){const G=U.getUint32(O*(4+n.n8),!0),E=n.F.fromRprLE(k,O*(4+n.n8)+4);R[G]=E}return R}function M(R){return g.fromRprLE(o.slice(R*y,R*y+y))}}var o9=Object.freeze({__proto__:null,calculate:Zl,debug:n9,exportJson:a9,check:s9});const un=262144,f9={get:function(i,e){return isNaN(e)?i[e]:i.getElement(e)},set:function(i,e,r){return isNaN(e)?(i[e]=r,!0):i.setElement(e,r)}};class l9{constructor(e){this.length=e||0,this.arr=new Array(un);for(let r=0;r<e;r+=un)this.arr[r/un]=new Array(Math.min(un,e-r));return this}push(){for(let e=0;e<arguments.length;e++)this.setElement(this.length,arguments[e])}slice(e,r){const t=new Array(r-e);for(let a=e;a<r;a++)t[a-e]=this.getElement(a);return t}getElement(e){e=parseInt(e);const r=Math.floor(e/un),t=e%un;return this.arr[r]?this.arr[r][t]:void 0}setElement(e,r){e=parseInt(e);const t=Math.floor(e/un);this.arr[t]||(this.arr[t]=new Array(un));const a=e%un;return this.arr[t][a]=r,e>=this.length&&(this.length=e+1),!0}getKeys(){const e=new p6;for(let r=0;r<this.arr.length;r++)if(this.arr[r])for(let t=0;t<this.arr[r].length;t++)typeof this.arr[r][t]<"u"&&e.push(r*un+t);return e}}class p6{constructor(e){const r=new l9(e);return new Proxy(r,f9)}}var Li=p6;async function v6(i,e,r,t){await Te.exports.ready();const v=Te.exports(64),{fd:o,sections:h}=await gr(e,"ptau",1),{curve:g,power:y}=await Wi(o,h),{fd:_,sections:A}=await gr(i,"r1cs",1),S=await h6(_,A,!1),T=await bi(r,"zkey",1,10,1<<22,1<<24),B=g.G1.F.n8*2,M=g.G2.F.n8*2;if(S.prime!=g.r)return t&&t.error("r1cs curve does not match powers of tau ceremony curve"),-1;const R=Ea(S.nConstraints+S.nPubInputs+S.nOutputs+1-1)+1;if(R>y)return t&&t.error(`circuit too big for this power of tau ceremony. ${S.nConstraints}*2 > 2**${y}`),-1;if(!h[12])return t&&t.error("Powers of tau is not prepared."),-1;const P=S.nOutputs+S.nPubInputs,D=2**R;await Oe(T,1),await T.writeULE32(1),await Fe(T),await Oe(T,2);const q=g.q,k=(Math.floor((Ae.bitLength(q)-1)/64)+1)*8,U=g.r,O=(Math.floor((Ae.bitLength(U)-1)/64)+1)*8,G=Ae.mod(Ae.shl(1,O*8),U),E=g.Fr.e(Ae.mod(Ae.mul(G,G),U));await T.writeULE32(k),await nn(T,q,k),await T.writeULE32(O),await nn(T,U,O),await T.writeULE32(S.nVars),await T.writeULE32(P),await T.writeULE32(D);let s;s=await o.read(B,h[4][0].p),await T.write(s),s=await g.G1.batchLEMtoU(s),v.update(s);let l;l=await o.read(B,h[5][0].p),await T.write(l),l=await g.G1.batchLEMtoU(l),v.update(l);let d;d=await o.read(M,h[6][0].p),await T.write(d),d=await g.G2.batchLEMtoU(d),v.update(d);const p=new Uint8Array(B);g.G1.toRprLEM(p,0,g.G1.g);const m=new Uint8Array(M);g.G2.toRprLEM(m,0,g.G2.g);const w=new Uint8Array(B);g.G1.toRprUncompressed(w,0,g.G1.g);const x=new Uint8Array(M);g.G2.toRprUncompressed(x,0,g.G2.g),await T.write(m),await T.write(p),await T.write(m),v.update(x),v.update(w),v.update(x),await Fe(T),t&&t.info("Reading r1cs");let b=await fr(_,A,2);const f=new Li(S.nVars),C=new Li(S.nVars),F=new Li(S.nVars),z=new Li(S.nVars-P-1),W=new Array(P+1);t&&t.info("Reading tauG1");let $=await fr(o,h,12,(D-1)*B,D*B);t&&t.info("Reading tauG2");let I=await fr(o,h,13,(D-1)*M,D*M);t&&t.info("Reading alphatauG1");let K=await fr(o,h,14,(D-1)*B,D*B);t&&t.info("Reading betatauG1");let N=await fr(o,h,15,(D-1)*B,D*B);await L(),await V(3,"G1",W,"IC"),await Q(),await H(),await V(8,"G1",z,"C"),await V(5,"G1",f,"A"),await V(6,"G1",C,"B1"),await V(7,"G2",F,"B2");const X=v.digest();return await Oe(T,10),await T.write(X),await T.writeULE32(0),await Fe(T),t&&t.info(Pr(X,"Circuit hash: ")),await T.close(),await _.close(),await o.close(),X;async function Q(){await Oe(T,9);const st=new ee(D*B);if(R<g.Fr.s){let ft=await fr(o,h,12,(D*2-1)*B,D*2*B);for(let vt=0;vt<D;vt++){t&&vt%1e4==0&&t.debug(`splitting buffer: ${vt}/${D}`);const ot=ft.slice((vt*2+1)*B,(vt*2+1)*B+B);st.set(ot,vt*B)}}else if(R==g.Fr.s){const ft=h[12][0].p+(2**(R+1)-1)*B;await o.readToBuffer(st,0,D*B,ft+D*B)}else throw t&&t.error("Circuit too big"),new Error("Circuit too big for this curve");await T.write(st),await Fe(T)}async function L(){const st=new Uint8Array(12+g.Fr.n8),ft=new DataView(st.buffer),vt=new Uint8Array(g.Fr.n8);g.Fr.toRprLE(vt,0,g.Fr.e(1));let ot=0;function pt(){const rt=b.slice(ot,ot+4);return ot+=4,new DataView(rt.buffer).getUint32(0,!0)}const Ut=new Li;for(let rt=0;rt<S.nConstraints;rt++){t&&rt%1e4==0&&t.debug(`processing constraints: ${rt}/${S.nConstraints}`);const lt=pt();for(let ut=0;ut<lt;ut++){const Y=pt(),tt=ot;ot+=g.Fr.n8;const dt=0,mt=B*rt,xt=3,bt=B*rt;typeof f[Y]>"u"&&(f[Y]=[]),f[Y].push([dt,mt,tt]),Y<=P?(typeof W[Y]>"u"&&(W[Y]=[]),W[Y].push([xt,bt,tt])):(typeof z[Y-P-1]>"u"&&(z[Y-P-1]=[]),z[Y-P-1].push([xt,bt,tt])),Ut.push([0,rt,Y,tt])}const gt=pt();for(let ut=0;ut<gt;ut++){const Y=pt(),tt=ot;ot+=g.Fr.n8;const dt=0,mt=B*rt,xt=1,bt=M*rt,_t=2,Ht=B*rt;typeof C[Y]>"u"&&(C[Y]=[]),C[Y].push([dt,mt,tt]),typeof F[Y]>"u"&&(F[Y]=[]),F[Y].push([xt,bt,tt]),Y<=P?(typeof W[Y]>"u"&&(W[Y]=[]),W[Y].push([_t,Ht,tt])):(typeof z[Y-P-1]>"u"&&(z[Y-P-1]=[]),z[Y-P-1].push([_t,Ht,tt])),Ut.push([1,rt,Y,tt])}const Dt=pt();for(let ut=0;ut<Dt;ut++){const Y=pt(),tt=ot;ot+=g.Fr.n8;const dt=0,mt=B*rt;Y<=P?(typeof W[Y]>"u"&&(W[Y]=[]),W[Y].push([dt,mt,tt])):(typeof z[Y-P-1]>"u"&&(z[Y-P-1]=[]),z[Y-P-1].push([dt,mt,tt]))}}for(let rt=0;rt<=P;rt++){const gt=B*(S.nConstraints+rt),Dt=3,ut=B*(S.nConstraints+rt);typeof f[rt]>"u"&&(f[rt]=[]),f[rt].push([0,gt,-1]),typeof W[rt]>"u"&&(W[rt]=[]),W[rt].push([Dt,ut,-1]),Ut.push([0,S.nConstraints+rt,rt,-1])}await Oe(T,4);const At=new ee(Ut.length*(12+g.Fr.n8)+4),It=new Uint8Array(4);new DataView(It.buffer).setUint32(0,Ut.length,!0),At.set(It);let at=4;for(let rt=0;rt<Ut.length;rt++)t&&rt%1e5==0&&t.debug(`writing coeffs: ${rt}/${Ut.length}`),J(Ut[rt]);await T.write(At),await Fe(T);function J(rt){ft.setUint32(0,rt[0],!0),ft.setUint32(4,rt[1],!0),ft.setUint32(8,rt[2],!0);let lt;rt[3]>=0?lt=g.Fr.fromRprLE(b.slice(rt[3],rt[3]+g.Fr.n8),0):lt=g.Fr.fromRprLE(vt,0);const gt=g.Fr.mul(lt,E);g.Fr.toRprLE(st,12,gt),At.set(st,at),at+=st.length}}async function V(st,ft,vt,ot){const Ut=g[ft];nt(vt.length),await Oe(T,st);let At=[],It=0;for(;It<vt.length;){let Jt=0;for(;It<vt.length&&Jt<g.tm.concurrency;){t&&t.debug(`Writing points start ${ot}: ${It}/${vt.length}`);let J=1,rt=vt[It]?vt[It].length:0;for(;It+J<vt.length&&rt+(vt[It+J]?vt[It+J].length:0)<32768&&J<32768;)rt+=vt[It+J]?vt[It+J].length:0,J++;const lt=vt.slice(It,It+J),gt=It;At.push(Z(ft,lt,t,ot).then(Dt=>(t&&t.debug(`Writing points end ${ot}: ${gt}/${vt.length}`),Dt))),It+=J,Jt++}const at=await Promise.all(At);for(let J=0;J<at.length;J++){await T.write(at[J][0]);const rt=await Ut.batchLEMtoU(at[J][0]);v.update(rt)}At=[]}await Fe(T)}async function Z(st,ft,vt,ot){const pt=g[st],Ut=pt.F.n8*2,At=pt.F.n8*3,It=pt.F.n8*2;let Jt,at,J,rt;if(st=="G1")Jt="g1m_timesScalarAffine",at="g1m_multiexpAffine",J="g1m_batchToAffine",rt="g1m_zero";else if(st=="G2")Jt="g2m_timesScalarAffine",at="g2m_multiexpAffine",J="g2m_batchToAffine",rt="g2m_zero";else throw new Error("Invalid group");let lt=0;for(let xt=0;xt<ft.length;xt++)lt+=ft[xt]?ft[xt].length:0;let gt,Dt;lt>32768?(gt=new ee(lt*Ut),Dt=new ee(lt*g.Fr.n8)):(gt=new Uint8Array(lt*Ut),Dt=new Uint8Array(lt*g.Fr.n8));let ut=0,Y=0;const tt=[$,I,K,N],dt=new Uint8Array(g.Fr.n8);g.Fr.toRprLE(dt,0,g.Fr.e(1));let mt=0;for(let xt=0;xt<ft.length;xt++)if(ft[xt])for(let bt=0;bt<ft[xt].length;bt++)vt&&bt&&bt%1e4==0&&vt.debug(`Configuring big array ${ot}: ${bt}/${ft[xt].length}`),gt.set(tt[ft[xt][bt][0]].slice(ft[xt][bt][1],ft[xt][bt][1]+Ut),mt*Ut),ft[xt][bt][2]>=0?Dt.set(b.slice(ft[xt][bt][2],ft[xt][bt][2]+g.Fr.n8),mt*g.Fr.n8):Dt.set(dt,mt*g.Fr.n8),mt++;if(ft.length>1){const xt=[];xt.push({cmd:"ALLOCSET",var:0,buff:gt}),xt.push({cmd:"ALLOCSET",var:1,buff:Dt}),xt.push({cmd:"ALLOC",var:2,len:ft.length*At}),ut=0,Y=0;let bt=0;for(let Ht=0;Ht<ft.length;Ht++){if(!ft[Ht]){xt.push({cmd:"CALL",fnName:rt,params:[{var:2,offset:bt}]}),bt+=At;continue}ft[Ht].length==1?xt.push({cmd:"CALL",fnName:Jt,params:[{var:0,offset:ut},{var:1,offset:Y},{val:g.Fr.n8},{var:2,offset:bt}]}):xt.push({cmd:"CALL",fnName:at,params:[{var:0,offset:ut},{var:1,offset:Y},{val:g.Fr.n8},{val:ft[Ht].length},{var:2,offset:bt}]}),ut+=Ut*ft[Ht].length,Y+=g.Fr.n8*ft[Ht].length,bt+=At}return xt.push({cmd:"CALL",fnName:J,params:[{var:2},{val:ft.length},{var:2}]}),xt.push({cmd:"GET",out:0,var:2,len:ft.length*It}),await g.tm.queueAction(xt)}else{let xt=await pt.multiExpAffine(gt,Dt,vt,ot);return xt=[pt.toAffine(xt)],xt}}async function H(){nt(D-1);for(let ft=0;ft<D-1;ft+=16384){t&&t.debug(`HashingHPoints: ${ft}/${D}`);const vt=Math.min(D-1,16384);await j(ft,vt)}}async function j(st,ft){const vt=await o.read(ft*B,h[2][0].p+(st+D)*B),ot=await o.read(ft*B,h[2][0].p+st*B),pt=g.tm.concurrency,Ut=Math.floor(ft/pt),At=[];for(let Jt=0;Jt<pt;Jt++){let at;if(Jt<pt-1?at=Ut:at=ft-Jt*Ut,at==0)continue;const J=vt.slice(Jt*Ut*B,(Jt*Ut+at)*B),rt=ot.slice(Jt*Ut*B,(Jt*Ut+at)*B);At.push(et(J,rt))}const It=await Promise.all(At);for(let Jt=0;Jt<It.length;Jt++)v.update(It[Jt][0])}async function et(st,ft){const vt=st.byteLength/B,ot=g.G1.F.n8*3,pt=[];pt.push({cmd:"ALLOCSET",var:0,buff:st}),pt.push({cmd:"ALLOCSET",var:1,buff:ft}),pt.push({cmd:"ALLOC",var:2,len:vt*ot});for(let At=0;At<vt;At++)pt.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:At*B},{var:1,offset:At*B},{var:2,offset:At*ot}]});return pt.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:vt},{var:2}]}),pt.push({cmd:"CALL",fnName:"g1m_batchLEMtoU",params:[{var:2},{val:vt},{var:2}]}),pt.push({cmd:"GET",out:0,var:2,len:vt*B}),await g.tm.queueAction(pt)}function nt(st){const ft=new Uint8Array(4);new DataView(ft.buffer,ft.byteOffset,ft.byteLength).setUint32(0,st,!1),v.update(ft)}}async function c9(i,e,r){const{fd:t,sections:a}=await gr(i,"zkey",2),n=await an(t,a);if(n.protocol!="groth16")throw new Error("zkey file is not groth16");const c=await _i(n.q),u=c.G1.F.n8*2,v=c.G2.F.n8*2,o=await ws(t,c,a),h=await Ts(e);await M(n.vk_alpha_1),await M(n.vk_beta_1),await R(n.vk_beta_2),await R(n.vk_gamma_2),await M(n.vk_delta_1),await R(n.vk_delta_2);let g;g=await fr(t,a,3),g=await c.G1.batchLEMtoU(g),await P("G1",g);const y=await fr(t,a,9);let _;_=await c.G1.fft(y,"affine","jacobian",r),_=await c.G1.batchApplyKey(_,c.Fr.neg(c.Fr.e(2)),c.Fr.w[n.power+1],"jacobian","affine",r),_=_.slice(0,_.byteLength-u),_=await c.G1.batchLEMtoU(_),await P("G1",_);let A;A=await fr(t,a,8),A=await c.G1.batchLEMtoU(A),await P("G1",A);let S;S=await fr(t,a,5),S=await c.G1.batchLEMtoU(S),await P("G1",S);let T;T=await fr(t,a,6),T=await c.G1.batchLEMtoU(T),await P("G1",T);let B;B=await fr(t,a,7),B=await c.G2.batchLEMtoU(B),await P("G2",B),await h.write(o.csHash),await D(o.contributions.length);for(let q=0;q<o.contributions.length;q++){const k=o.contributions[q];await M(k.deltaAfter),await M(k.delta.g1_s),await M(k.delta.g1_sx),await R(k.delta.g2_spx),await h.write(k.transcript)}await t.close(),await h.close();async function M(q){const k=new Uint8Array(u);c.G1.toRprUncompressed(k,0,q),await h.write(k)}async function R(q){const k=new Uint8Array(v);c.G2.toRprUncompressed(k,0,q),await h.write(k)}async function P(q,k){let U;q=="G1"?U=u:U=v;const O=new Uint8Array(4);new DataView(O.buffer,O.byteOffset,O.byteLength).setUint32(0,k.byteLength/U,!1),await h.write(O),await h.write(k)}async function D(q){const k=new Uint8Array(4);new DataView(k.buffer,k.byteOffset,k.byteLength).setUint32(0,q,!1),await h.write(k)}}async function u9(i,e,r,t,a){const{fd:n,sections:c}=await gr(i,"zkey",2),u=await an(n,c,!1);if(u.protocol!="groth16")throw new Error("zkey file is not groth16");const v=await _i(u.q),o=v.G1.F.n8*2,h=v.G2.F.n8*2,g=await ws(n,v,c),y={},_=await Ca(e);_.pos=o*3+h*3+8+o*u.nVars+4+o*(u.domainSize-1)+4+o*u.nVars+4+o*u.nVars+4+h*u.nVars,y.csHash=await _.read(64);const A=await _.readUBE32();y.contributions=[];for(let p=0;p<A;p++){const m={delta:{}};m.deltaAfter=await s(_),m.delta.g1_s=await s(_),m.delta.g1_sx=await s(_),m.delta.g2_spx=await l(_),m.transcript=await _.read(64),p<g.contributions.length&&(m.type=g.contributions[p].type,m.type==1&&(m.beaconHash=g.contributions[p].beaconHash,m.numIterationsExp=g.contributions[p].numIterationsExp),g.contributions[p].name&&(m.name=g.contributions[p].name)),y.contributions.push(m)}if(!pa(y.csHash,g.csHash))return a&&a.error("Hash of the original circuit does not match with the MPC one"),!1;if(g.contributions.length>y.contributions.length)return a&&a.error("The impoerted file does not include new contributions"),!1;for(let p=0;p<g.contributions.length;p++)if(!d(g.contributions[p],y.contributions[p]))return a&&a.error(`Previous contribution ${p} does not match`),!1;if(t)for(let p=g.contributions.length;p<y.contributions.length;p++)y.contributions[p].name=t;const S=await bi(r,"zkey",1,10);if(_.pos=0,_.pos+=o,_.pos+=o,_.pos+=h,_.pos+=h,u.vk_delta_1=await s(_),u.vk_delta_2=await l(_),await B1(S,u),await _.readUBE32()!=u.nPublic+1)return a&&a.error("Invalid number of points in IC"),await S.discard(),!1;if(_.pos+=o*(u.nPublic+1),await tr(n,c,S,3),await tr(n,c,S,4),await _.readUBE32()!=u.domainSize-1)return a&&a.error("Invalid number of points in H"),await S.discard(),!1;let M;const R=await _.read(o*(u.domainSize-1)),P=await v.G1.batchUtoLEM(R);M=new Uint8Array(u.domainSize*o),M.set(P),v.G1.toRprLEM(M,o*(u.domainSize-1),v.G1.zeroAffine);const D=v.Fr.neg(v.Fr.inv(v.Fr.e(2))),q=v.Fr.inv(v.Fr.w[u.power+1]);if(M=await v.G1.batchApplyKey(M,D,q,"affine","jacobian",a),M=await v.G1.ifft(M,"jacobian","affine",a),await Oe(S,9),await S.write(M),await Fe(S),await _.readUBE32()!=u.nVars-u.nPublic-1)return a&&a.error("Invalid number of points in L"),await S.discard(),!1;let U;if(U=await _.read(o*(u.nVars-u.nPublic-1)),U=await v.G1.batchUtoLEM(U),await Oe(S,8),await S.write(U),await Fe(S),await _.readUBE32()!=u.nVars)return a&&a.error("Invalid number of points in A"),await S.discard(),!1;if(_.pos+=o*u.nVars,await tr(n,c,S,5),await _.readUBE32()!=u.nVars)return a&&a.error("Invalid number of points in B1"),await S.discard(),!1;if(_.pos+=o*u.nVars,await tr(n,c,S,6),await _.readUBE32()!=u.nVars)return a&&a.error("Invalid number of points in B2"),await S.discard(),!1;return _.pos+=h*u.nVars,await tr(n,c,S,7),await L1(S,v,y),await _.close(),await S.close(),await n.close(),!0;async function s(p){const m=await p.read(v.G1.F.n8*2);return v.G1.fromRprUncompressed(m,0)}async function l(p){const m=await p.read(v.G2.F.n8*2);return v.G2.fromRprUncompressed(m,0)}function d(p,m){return!(!v.G1.eq(p.deltaAfter,m.deltaAfter)||!v.G1.eq(p.delta.g1_s,m.delta.g1_s)||!v.G1.eq(p.delta.g1_sx,m.delta.g1_sx)||!v.G2.eq(p.delta.g2_spx,m.delta.g2_spx)||!pa(p.transcript,m.transcript))}}const eo=r6;async function g6(i,e,r,t){let a;await Te.exports.ready();const{fd:n,sections:c}=await gr(r,"zkey",2),u=await an(n,c,!1);if(u.protocol!="groth16")throw new Error("zkey file is not groth16");const v=await _i(u.q),o=v.G1.F.n8*2,h=await ws(n,v,c),g=Te.exports(64);g.update(h.csHash);let y=v.G1.g;for(let q=0;q<h.contributions.length;q++){const k=h.contributions[q],U=XE(g);if(rn(U,v,k.delta.g1_s),rn(U,v,k.delta.g1_sx),!pa(U.digest(),k.transcript))return console.log(`INVALID(${q}): Inconsistent transcript `),!1;const O=Xo(v,k.transcript);if(a=await eo(v,k.delta.g1_s,k.delta.g1_sx,O,k.delta.g2_spx),a!==!0)return console.log(`INVALID(${q}): public key G1 and G2 do not have the same ration `),!1;if(a=await eo(v,y,k.deltaAfter,O,k.delta.g2_spx),a!==!0)return console.log(`INVALID(${q}): deltaAfter does not fillow the public key `),!1;if(k.type==1){const E=await M1(k.beaconHash,k.numIterationsExp),s=v.Fr.fromRng(E),l=v.G1.toAffine(v.G1.fromRng(E)),d=v.G1.toAffine(v.G1.timesFr(l,s));if(v.G1.eq(l,k.delta.g1_s)!==!0)return console.log(`INVALID(${q}): Key of the beacon does not match. g1_s `),!1;if(v.G1.eq(d,k.delta.g1_sx)!==!0)return console.log(`INVALID(${q}): Key of the beacon does not match. g1_sx `),!1}va(g,v,k);const G=Te.exports(64);va(G,v,k),k.contributionHash=G.digest(),y=k.deltaAfter}const{fd:_,sections:A}=await gr(i,"zkey",2),S=await an(_,A,!1);if(S.protocol!="groth16")throw new Error("zkeyinit file is not groth16");if(!Ae.eq(S.q,u.q)||!Ae.eq(S.r,u.r)||S.n8q!=u.n8q||S.n8r!=u.n8r)return t&&t.error("INVALID:  Different curves"),!1;if(S.nVars!=u.nVars||S.nPublic!=u.nPublic||S.domainSize!=u.domainSize)return t&&t.error("INVALID:  Different circuit parameters"),!1;if(!v.G1.eq(u.vk_alpha_1,S.vk_alpha_1))return t&&t.error("INVALID:  Invalid alpha1"),!1;if(!v.G1.eq(u.vk_beta_1,S.vk_beta_1))return t&&t.error("INVALID:  Invalid beta1"),!1;if(!v.G2.eq(u.vk_beta_2,S.vk_beta_2))return t&&t.error("INVALID:  Invalid beta2"),!1;if(!v.G2.eq(u.vk_gamma_2,S.vk_gamma_2))return t&&t.error("INVALID:  Invalid gamma2"),!1;if(!v.G1.eq(u.vk_delta_1,y))return t&&t.error("INVALID:  Invalid delta1"),!1;if(a=await eo(v,v.G1.g,y,v.G2.g,u.vk_delta_2),a!==!0)return t&&t.error("INVALID:  Invalid delta2"),!1;const T=await ws(_,v,A);if(!pa(h.csHash,T.csHash))return t&&t.error("INVALID:  Circuit does not match"),!1;if(c[8][0].size!=o*(u.nVars-u.nPublic-1))return t&&t.error("INVALID:  Invalid L section size"),!1;if(c[9][0].size!=o*u.domainSize)return t&&t.error("INVALID:  Invalid H section size"),!1;let B;if(B=await to(n,c,_,A,3),!B)return t&&t.error("INVALID:  IC section is not identical"),!1;if(B=await to(n,c,_,A,4),!B)return t&&t.error("Coeffs section is not identical"),!1;if(B=await to(n,c,_,A,5),!B)return t&&t.error("A section is not identical"),!1;if(B=await to(n,c,_,A,6),!B)return t&&t.error("B1 section is not identical"),!1;if(B=await to(n,c,_,A,7),!B)return t&&t.error("B2 section is not identical"),!1;if(a=await M("G1",_,A,n,c,8,u.vk_delta_2,S.vk_delta_2,"L section"),a!==!0)return t&&t.error("L section does not match"),!1;if(a=await R(),a!==!0)return t&&t.error("H section does not match"),!1;t&&t.info(Pr(h.csHash,"Circuit Hash: ")),await n.close(),await _.close();for(let q=h.contributions.length-1;q>=0;q--){const k=h.contributions[q];t&&t.info("-------------------------"),t&&t.info(Pr(k.contributionHash,`contribution #${q+1} ${k.name?k.name:""}:`)),k.type==1&&(t&&t.info(`Beacon generator: ${n6(k.beaconHash)}`),t&&t.info(`Beacon iterations Exp: ${k.numIterationsExp}`))}return t&&t.info("-------------------------"),t&&t.info("ZKey Ok!"),!0;async function M(q,k,U,O,G,E,s,l,d){const m=v[q],w=m.F.n8*2;await yr(k,U,E),await yr(O,G,E);let x=m.zero,b=m.zero;const f=U[E][0].size/w;for(let C=0;C<f;C+=1048576){t&&t.debug(`Same ratio check ${d}:  ${C}/${f}`);const F=Math.min(f-C,1048576),z=await k.read(F*w),W=await O.read(F*w),$=ds(4*F),I=await m.multiExpAffine(z,$),K=await m.multiExpAffine(W,$);x=m.add(x,I),b=m.add(b,K)}return await br(k),await br(O),f==0?!0:(a=await eo(v,x,b,s,l),a===!0)}async function R(){const k=v.G1,U=v.Fr,O=k.F.n8*2,{fd:G,sections:E}=await gr(e,"ptau",1);let s=new ee(u.domainSize*u.n8r);const l=new Array(8);for(let b=0;b<8;b++)l[b]=al(ds(4),0);const d=new Ka(l);for(let b=0;b<u.domainSize-1;b++){const f=U.fromRng(d);U.toRprLE(s,b*u.n8r,f)}U.toRprLE(s,(u.domainSize-1)*u.n8r,U.zero);let p=k.zero;for(let b=0;b<u.domainSize;b+=1048576){t&&t.debug(`H Verification(tau):  ${b}/${u.domainSize}`);const f=Math.min(u.domainSize-b,1048576),C=await G.read(O*f,E[2][0].p+u.domainSize*O+b*O),F=await G.read(O*f,E[2][0].p+b*O),z=await P(C,F),W=s.slice(b*u.n8r,(b+f)*u.n8r),$=await k.multiExpAffine(z,W);p=k.add(p,$)}s=await U.batchToMontgomery(s);let m;if(u.power<U.s)m=U.neg(U.e(2));else{const b=2**U.s,f=U.exp(U.shift,b);m=U.sub(f,U.one)}const w=u.power<U.s?U.w[u.power+1]:U.shift;s=await U.batchApplyKey(s,m,w),s=await U.fft(s),s=await U.batchFromMontgomery(s),await yr(n,c,9);let x=k.zero;for(let b=0;b<u.domainSize;b+=1048576){t&&t.debug(`H Verification(lagrange):  ${b}/${u.domainSize}`);const f=Math.min(u.domainSize-b,1048576),C=await n.read(O*f),F=s.slice(b*u.n8r,(b+f)*u.n8r),z=await k.multiExpAffine(C,F);x=k.add(x,z)}return await br(n),a=await eo(v,p,x,u.vk_delta_2,S.vk_delta_2),a===!0}async function P(q,k){const U=v.G1.F.n8*2,O=q.byteLength/U,G=v.tm.concurrency,E=Math.floor(O/G),s=[];for(let m=0;m<G;m++){let w;if(m<G-1?w=E:w=O-m*E,w==0)continue;const x=q.slice(m*E*o,(m*E+w)*o),b=k.slice(m*E*o,(m*E+w)*o);s.push(D(x,b))}const l=await Promise.all(s),d=new Uint8Array(O*U);let p=0;for(let m=0;m<l.length;m++)d.set(l[m][0],p),p+=l[m][0].byteLength;return d}async function D(q,k){const U=v.G1.F.n8*2,O=v.G1.F.n8*3,G=q.byteLength/U,E=[];E.push({cmd:"ALLOCSET",var:0,buff:q}),E.push({cmd:"ALLOCSET",var:1,buff:k}),E.push({cmd:"ALLOC",var:2,len:G*O});for(let l=0;l<G;l++)E.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:l*U},{var:1,offset:l*U},{var:2,offset:l*O}]});return E.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:G},{var:2}]}),E.push({cmd:"GET",out:0,var:2,len:G*U}),await v.tm.queueAction(E)}}async function h9(i,e,r,t){const a={type:"bigMem"};return await v6(i,e,a,t),await g6(a,e,r,t)}async function d9(i,e,r,t,a){await Te.exports.ready();const{fd:n,sections:c}=await gr(i,"zkey",2),u=await an(n,c);if(u.protocol!="groth16")throw new Error("zkey file is not groth16");const v=await _i(u.q),o=await ws(n,v,c),h=await bi(e,"zkey",1,10),g=await $l(t),y=Te.exports(64);y.update(o.csHash);for(let B=0;B<o.contributions.length;B++)va(y,v,o.contributions[B]);const _={};_.delta={},_.delta.prvKey=v.Fr.fromRng(g),_.delta.g1_s=v.G1.toAffine(v.G1.fromRng(g)),_.delta.g1_sx=v.G1.toAffine(v.G1.timesFr(_.delta.g1_s,_.delta.prvKey)),rn(y,v,_.delta.g1_s),rn(y,v,_.delta.g1_sx),_.transcript=y.digest(),_.delta.g2_sp=Xo(v,_.transcript),_.delta.g2_spx=v.G2.toAffine(v.G2.timesFr(_.delta.g2_sp,_.delta.prvKey)),u.vk_delta_1=v.G1.timesFr(u.vk_delta_1,_.delta.prvKey),u.vk_delta_2=v.G2.timesFr(u.vk_delta_2,_.delta.prvKey),_.deltaAfter=u.vk_delta_1,_.type=0,r&&(_.name=r),o.contributions.push(_),await B1(h,u),await tr(n,c,h,3),await tr(n,c,h,4),await tr(n,c,h,5),await tr(n,c,h,6),await tr(n,c,h,7);const A=v.Fr.inv(_.delta.prvKey);await ll(n,c,h,8,v,"G1",A,v.Fr.e(1),"L Section",a),await ll(n,c,h,9,v,"G1",A,v.Fr.e(1),"H Section",a),await L1(h,v,o),await n.close(),await h.close();const S=Te.exports(64);va(S,v,_);const T=S.digest();return a&&a.info(Pr(o.csHash,"Circuit Hash: ")),a&&a.info(Pr(T,"Contribution Hash: ")),T}async function p9(i,e,r,t,a,n){await Te.exports.ready();const c=i6(t);if(c.byteLength==0||c.byteLength*2!=t.length)return n&&n.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(c.length>=256)return n&&n.error("Maximum length of beacon hash is 255 bytes"),!1;if(a=parseInt(a),a<10||a>63)return n&&n.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;const{fd:u,sections:v}=await gr(i,"zkey",2),o=await an(u,v);if(o.protocol!="groth16")throw new Error("zkey file is not groth16");const h=await _i(o.q),g=await ws(u,h,v),y=await bi(e,"zkey",1,10),_=await M1(c,a),A=Te.exports(64);A.update(g.csHash);for(let R=0;R<g.contributions.length;R++)va(A,h,g.contributions[R]);const S={};S.delta={},S.delta.prvKey=h.Fr.fromRng(_),S.delta.g1_s=h.G1.toAffine(h.G1.fromRng(_)),S.delta.g1_sx=h.G1.toAffine(h.G1.timesFr(S.delta.g1_s,S.delta.prvKey)),rn(A,h,S.delta.g1_s),rn(A,h,S.delta.g1_sx),S.transcript=A.digest(),S.delta.g2_sp=Xo(h,S.transcript),S.delta.g2_spx=h.G2.toAffine(h.G2.timesFr(S.delta.g2_sp,S.delta.prvKey)),o.vk_delta_1=h.G1.timesFr(o.vk_delta_1,S.delta.prvKey),o.vk_delta_2=h.G2.timesFr(o.vk_delta_2,S.delta.prvKey),S.deltaAfter=o.vk_delta_1,S.type=1,S.numIterationsExp=a,S.beaconHash=c,r&&(S.name=r),g.contributions.push(S),await B1(y,o),await tr(u,v,y,3),await tr(u,v,y,4),await tr(u,v,y,5),await tr(u,v,y,6),await tr(u,v,y,7);const T=h.Fr.inv(S.delta.prvKey);await ll(u,v,y,8,h,"G1",T,h.Fr.e(1),"L Section",n),await ll(u,v,y,9,h,"G1",T,h.Fr.e(1),"H Section",n),await L1(y,h,g),await u.close(),await y.close();const B=Te.exports(64);va(B,h,S);const M=B.digest();return n&&n.info(Pr(M,"Contribution Hash: ")),M}async function v9(i){const e=await fA(i,!0);return delete e.curve,delete e.F,ri.stringifyBigInts(e)}async function g9(i,e,r,t,a){await Te.exports.ready();const n=await $l(t),c=i.Fr.fromRng(n),u=i.Fr.inv(c),v=i.G1.F.n8*2,o=i.G2.F.n8*2,h=await Ca(e),g=await Ts(r);await s(v),await s(v),await s(o),await s(o);const y=await l(),_=i.G1.timesFr(y,c);await p(_);const A=await d(),S=i.G2.timesFr(A,c);await m(S);const T=await h.readUBE32();await g.writeUBE32(T),await s(T*v);const B=await h.readUBE32();await g.writeUBE32(B),await Ta(h,g,null,i,"G1",B,u,i.Fr.e(1),"UNCOMPRESSED","H",a);const M=await h.readUBE32();await g.writeUBE32(M),await Ta(h,g,null,i,"G1",M,u,i.Fr.e(1),"UNCOMPRESSED","L",a);const R=await h.readUBE32();await g.writeUBE32(R),await s(R*v);const P=await h.readUBE32();await g.writeUBE32(P),await s(P*v);const D=await h.readUBE32();await g.writeUBE32(D),await s(D*o);const q=Te.exports(64),k={};k.csHash=await h.read(64),q.update(k.csHash);const U=await h.readUBE32();k.contributions=[];for(let w=0;w<U;w++){const x={delta:{}};x.deltaAfter=await l(),x.delta.g1_s=await l(),x.delta.g1_sx=await l(),x.delta.g2_spx=await d(),x.transcript=await h.read(64),k.contributions.push(x),va(q,i,x)}const O={};O.delta={},O.delta.prvKey=c,O.delta.g1_s=i.G1.toAffine(i.G1.fromRng(n)),O.delta.g1_sx=i.G1.toAffine(i.G1.timesFr(O.delta.g1_s,c)),rn(q,i,O.delta.g1_s),rn(q,i,O.delta.g1_sx),O.transcript=q.digest(),O.delta.g2_sp=Xo(i,O.transcript),O.delta.g2_spx=i.G2.toAffine(i.G2.timesFr(O.delta.g2_sp,c)),O.deltaAfter=_,O.type=0,k.contributions.push(O),await g.write(k.csHash),await g.writeUBE32(k.contributions.length);for(let w=0;w<k.contributions.length;w++){const x=k.contributions[w];await p(x.deltaAfter),await p(x.delta.g1_s),await p(x.delta.g1_sx),await m(x.delta.g2_spx),await g.write(x.transcript)}const G=Te.exports(64);va(G,i,O);const E=G.digest();return a&&a.info(Pr(E,"Contribution Hash: ")),await g.close(),await h.close(),E;async function s(w){const x=h.pageSize*2;for(let b=0;b<w;b+=x){const f=Math.min(w-b,x),C=await h.read(f);await g.write(C)}}async function l(){const w=await h.read(i.G1.F.n8*2);return i.G1.fromRprUncompressed(w,0)}async function d(){const w=await h.read(i.G2.F.n8*2);return i.G2.fromRprUncompressed(w,0)}async function p(w){const x=new Uint8Array(v);i.G1.toRprUncompressed(x,0,w),await g.write(x)}async function m(w){const x=new Uint8Array(o);i.G2.toRprUncompressed(x,0,w),await g.write(x)}}const{stringifyBigInts:k1}=ri;async function m6(i,e){e&&e.info("EXPORT VERIFICATION KEY STARTED");const{fd:r,sections:t}=await gr(i,"zkey",2),a=await an(r,t);e&&e.info("> Detected protocol: "+a.protocol);let n;if(a.protocol==="groth16")n=await m9(a,r,t);else if(a.protocol==="plonk")n=await y9(a);else if(a.protocolId&&a.protocolId===Wo)n=await b9(a);else throw new Error("zkey file protocol unrecognized");return await r.close(),e&&e.info("EXPORT VERIFICATION KEY FINISHED"),n}async function m9(i,e,r){const t=await _i(i.q),a=t.G1.F.n8*2,n=await t.pairing(i.vk_alpha_1,i.vk_beta_2);let c={protocol:i.protocol,curve:t.name,nPublic:i.nPublic,vk_alpha_1:t.G1.toObject(i.vk_alpha_1),vk_beta_2:t.G2.toObject(i.vk_beta_2),vk_gamma_2:t.G2.toObject(i.vk_gamma_2),vk_delta_2:t.G2.toObject(i.vk_delta_2),vk_alphabeta_12:t.Gt.toObject(n)};await yr(e,r,3),c.IC=[];for(let u=0;u<=i.nPublic;u++){const v=await e.read(a),o=t.G1.toObject(v);c.IC.push(o)}return await br(e),c=k1(c),c}async function y9(i){const e=await _i(i.q);let r={protocol:i.protocol,curve:e.name,nPublic:i.nPublic,power:i.power,k1:e.Fr.toObject(i.k1),k2:e.Fr.toObject(i.k2),Qm:e.G1.toObject(i.Qm),Ql:e.G1.toObject(i.Ql),Qr:e.G1.toObject(i.Qr),Qo:e.G1.toObject(i.Qo),Qc:e.G1.toObject(i.Qc),S1:e.G1.toObject(i.S1),S2:e.G1.toObject(i.S2),S3:e.G1.toObject(i.S3),X_2:e.G2.toObject(i.X_2),w:e.Fr.toObject(e.Fr.w[i.power])};return r=k1(r),r}async function b9(i,e){const r=await _i(i.q);let t={protocol:i.protocol,curve:r.name,nPublic:i.nPublic,power:i.power,k1:r.Fr.toObject(i.k1),k2:r.Fr.toObject(i.k2),w:r.Fr.toObject(r.Fr.w[i.power]),w3:r.Fr.toObject(i.w3),w4:r.Fr.toObject(i.w4),w8:r.Fr.toObject(i.w8),wr:r.Fr.toObject(i.wr),X_2:r.G2.toObject(i.X_2),C0:r.G1.toObject(i.C0)};return k1(t)}var y6={};const{unstringifyBigInts:_9,stringifyBigInts:w9}=ri;async function b6(i,e,r){r&&r.info("FFLONK EXPORT SOLIDITY VERIFIER STARTED");const t=await Za(i.curve);let a=o(i.w3);i.w3_2=h(t.Fr.square(a));let n=o(i.w4);i.w4_2=h(t.Fr.square(n)),i.w4_3=h(t.Fr.mul(t.Fr.square(n),n));let c=o(i.w8),u=t.Fr.one;for(let g=1;g<8;g++)u=t.Fr.mul(u,c),i["w8_"+g]=h(u);let v=e[i.protocol];return r&&r.info("FFLONK EXPORT SOLIDITY VERIFIER FINISHED"),y6.render(v,i);function o(g){const y=_9(g);return t.Fr.fromObject(y)}function h(g){const y=t.Fr.toObject(g);return w9(y)}}async function C9(i,e,r){const t=await m6(i,r);if(t.protocol==="fflonk")return b6(t,e,r);let a=e[t.protocol];return y6.render(a,t)}var E9=Object.freeze({__proto__:null,newZKey:v6,exportBellman:c9,importBellman:u9,verifyFromR1cs:h9,verifyFromInit:g6,contribute:d9,beacon:p9,exportJson:v9,bellmanContribute:g9,exportVerificationKey:m6,exportSolidityVerifier:C9});async function A9(i,e,r,t){globalThis.gc&&globalThis.gc(),await Te.exports.ready();const{fd:a,sections:n}=await gr(e,"ptau",1),{curve:c,power:u}=await Wi(a,n),{fd:v,sections:o}=await gr(i,"r1cs",1),h=await jl(v,o,{loadConstraints:!0,loadCustomGates:!0}),g=c.G1.F.n8*2,y=c.G1,_=c.G2.F.n8*2,A=c.Fr,S=c.Fr.n8;t&&t.info("Reading r1cs"),await fr(v,o,2);const T=new Li,B=new Li;let M=h.nVars;const R=h.nOutputs+h.nPubInputs;await l(c.Fr,h,t),globalThis.gc&&globalThis.gc();const P=await bi(r,"zkey",1,14,1<<22,1<<24);if(h.prime!=c.r)return t&&t.error("r1cs curve does not match powers of tau ceremony curve"),-1;let D=Ea(T.length-1)+1;D<3&&(D=3);const q=2**D;if(t&&t.info("Plonk constraints: "+T.length),D>u)return t&&t.error(`circuit too big for this power of tau ceremony. ${T.length} > 2**${u}`),-1;if(!n[12])return t&&t.error("Powers of tau is not prepared."),-1;const k=new ee(q*g),U=n[12][0].p+(2**D-1)*g;await a.readToBuffer(k,0,q*g,U);const[O,G]=C(),E={};await w(3,"Additions"),globalThis.gc&&globalThis.gc(),await d(4,0,"Amap"),globalThis.gc&&globalThis.gc(),await d(5,1,"Bmap"),globalThis.gc&&globalThis.gc(),await d(6,2,"Cmap"),globalThis.gc&&globalThis.gc(),await p(7,3,"Qm"),globalThis.gc&&globalThis.gc(),await p(8,4,"Ql"),globalThis.gc&&globalThis.gc(),await p(9,5,"Qr"),globalThis.gc&&globalThis.gc(),await p(10,6,"Qo"),globalThis.gc&&globalThis.gc(),await p(11,7,"Qc"),globalThis.gc&&globalThis.gc(),await x(12,"sigma"),globalThis.gc&&globalThis.gc(),await b(13,"lagrange polynomials"),globalThis.gc&&globalThis.gc(),await Oe(P,14);const s=new ee((q+6)*g);await a.readToBuffer(s,0,(q+6)*g,n[2][0].p),await P.write(s),await Fe(P),globalThis.gc&&globalThis.gc(),await f(),await P.close(),await v.close(),await a.close(),t&&t.info("Setup Finished");return;async function l(F,z,W){function $(V){const Z=Object.keys(V);for(let H=0;H<Z.length;H++)V[Z[H]]==0n&&delete V[Z[H]]}function I(V,Z,H){const j={};for(let et in V)typeof j[et]>"u"?j[et]=F.mul(Z,V[et]):j[et]=F.add(j[et],F.mul(Z,V[et]));for(let et in H)typeof j[et]>"u"?j[et]=H[et]:j[et]=F.add(j[et],H[et]);return $(j),j}function K(V,Z){const H={k:F.zero,s:[],coefs:[]},j=[];for(let et in V)et==0?H.k=F.add(H.k,V[et]):V[et]!=0n&&j.push([Number(et),V[et]]);for(;j.length>Z;){const et=j.shift(),nt=j.shift(),st=et[0],ft=nt[0],vt=M++,ot=F.zero,pt=F.neg(et[1]),Ut=F.neg(nt[1]),At=F.one,It=F.zero;T.push([st,ft,vt,ot,pt,Ut,At,It]),B.push([st,ft,et[1],nt[1]]),j.push([vt,F.one])}for(let et=0;et<j.length;et++)H.s[et]=j[et][0],H.coefs[et]=j[et][1];for(;H.coefs.length<Z;)H.s.push(0),H.coefs.push(F.zero);return H}function N(V){const Z=K(V,3),H=Z.s[0],j=Z.s[1],et=Z.s[2],nt=F.zero,st=Z.coefs[0],ft=Z.coefs[1],vt=Z.coefs[2],ot=Z.k;T.push([H,j,et,nt,st,ft,vt,ot])}function X(V,Z,H){const j=K(V,1),et=K(Z,1),nt=K(H,1),st=j.s[0],ft=et.s[0],vt=nt.s[0],ot=F.mul(j.coefs[0],et.coefs[0]),pt=F.mul(j.coefs[0],et.k),Ut=F.mul(j.k,et.coefs[0]),At=F.neg(nt.coefs[0]),It=F.sub(F.mul(j.k,et.k),nt.k);T.push([st,ft,vt,ot,pt,Ut,At,It])}function Q(V){let Z=F.zero,H=0;const j=Object.keys(V);for(let et=0;et<j.length;et++)V[j[et]]==0n?delete V[j[et]]:j[et]==0?Z=F.add(Z,V[j[et]]):H++;return H>0?H.toString():Z!=F.zero?"k":"0"}function L(V,Z,H){const j=Q(V),et=Q(Z);if(j==="0"||et==="0")$(H),N(H);else if(j==="k"){const nt=I(Z,V[0],H);N(nt)}else if(et==="k"){const nt=I(V,Z[0],H);N(nt)}else X(V,Z,H)}for(let V=1;V<=R;V++){const Z=V,H=0,j=0,et=F.zero,nt=F.one,st=F.zero,ft=F.zero,vt=F.zero;T.push([Z,H,j,et,nt,st,ft,vt])}for(let V=0;V<z.constraints.length;V++)W&&V%1e4===0&&W.debug(`processing constraints: ${V}/${z.nConstraints}`),L(...z.constraints[V])}async function d(F,z,W){await Oe(P,F);for(let $=0;$<T.length;$++)await P.writeULE32(T[$][z]),t&&$%1e6==0&&t.debug(`writing ${W}: ${$}/${T.length}`);await Fe(P)}async function p(F,z,W){let $=new ee(q*S);for(let I=0;I<T.length;I++)$.set(T[I][z],I*S),t&&I%1e6==0&&t.debug(`writing ${W}: ${I}/${T.length}`);await Oe(P,F),await m($),await Fe(P),$=await A.batchFromMontgomery($),E[W]=await c.G1.multiExpAffine(k,$,t,"multiexp "+W)}async function m(F){const z=await A.ifft(F),W=new ee(q*S*4);W.set(z,0);const $=await A.fft(W);await P.write(z),await P.write($)}async function w(F,z){await Oe(P,F);const W=new Uint8Array(2*4+2*S),$=new DataView(W.buffer);for(let I=0;I<B.length;I++){const K=B[I];let N=0;$.setUint32(N,K[0],!0),N+=4,$.setUint32(N,K[1],!0),N+=4,W.set(K[2],N),N+=S,W.set(K[3],N),N+=S,await P.write(W),t&&I%1e6==0&&t.debug(`writing ${z}: ${I}/${B.length}`)}await Fe(P)}async function x(F,z){const W=new ee(S*q*3),$=new Li(M),I=new Li(M);let K=A.one;for(let V=0;V<q;V++)V<T.length?(L(T[V][0],V),L(T[V][1],q+V),L(T[V][2],q*2+V)):(L(0,V),L(0,q+V),L(0,q*2+V)),K=A.mul(K,A.w[D]),t&&V%1e6==0&&t.debug(`writing ${z} phase1: ${V}/${T.length}`);for(let V=0;V<M;V++)typeof I[V]<"u"?W.set($[V],I[V]*S):console.log("Variable not used"),t&&V%1e6==0&&t.debug(`writing ${z} phase2: ${V}/${M}`);globalThis.gc&&globalThis.gc(),await Oe(P,F);let N=W.slice(0,q*S);await m(N),globalThis.gc&&globalThis.gc();let X=W.slice(q*S,q*S*2);await m(X),globalThis.gc&&globalThis.gc();let Q=W.slice(q*S*2,q*S*3);await m(Q),globalThis.gc&&globalThis.gc(),await Fe(P),N=await A.batchFromMontgomery(N),X=await A.batchFromMontgomery(X),Q=await A.batchFromMontgomery(Q),E.S1=await c.G1.multiExpAffine(k,N,t,"multiexp S1"),globalThis.gc&&globalThis.gc(),E.S2=await c.G1.multiExpAffine(k,X,t,"multiexp S2"),globalThis.gc&&globalThis.gc(),E.S3=await c.G1.multiExpAffine(k,Q,t,"multiexp S3"),globalThis.gc&&globalThis.gc();function L(V,Z){typeof $[V]>"u"?I[V]=Z:W.set($[V],Z*S);let H;Z<q?H=K:Z<2*q?H=A.mul(K,O):H=A.mul(K,G),$[V]=H}}async function b(F,z){await Oe(P,F);const W=Math.max(R,1);for(let $=0;$<W;$++){let I=new ee(q*S);I.set(A.one,$*S),await m(I),t&&t.debug(`writing ${z} ${$}/${W}`)}await Fe(P)}async function f(){await Oe(P,1),await P.writeULE32(2),await Fe(P),await Oe(P,2);const F=c.q,z=(Math.floor((Ae.bitLength(F)-1)/64)+1)*8,W=c.r,$=(Math.floor((Ae.bitLength(W)-1)/64)+1)*8;await P.writeULE32(z),await nn(P,F,z),await P.writeULE32($),await nn(P,W,$),await P.writeULE32(M),await P.writeULE32(R),await P.writeULE32(q),await P.writeULE32(B.length),await P.writeULE32(T.length),await P.write(O),await P.write(G),await P.write(y.toAffine(E.Qm)),await P.write(y.toAffine(E.Ql)),await P.write(y.toAffine(E.Qr)),await P.write(y.toAffine(E.Qo)),await P.write(y.toAffine(E.Qc)),await P.write(y.toAffine(E.S1)),await P.write(y.toAffine(E.S2)),await P.write(y.toAffine(E.S3));let I;I=await a.read(_,n[3][0].p+_),await P.write(I),await Fe(P)}function C(){let F=A.two;for(;W(F,[],D);)A.add(F,A.one);let z=A.add(F,A.one);for(;W(z,[F],D);)A.add(z,A.one);return[F,z];function W($,I,K){const N=2**K;let X=A.one;for(let Q=0;Q<N;Q++){if(A.eq($,X))return!0;for(let L=0;L<I.length;L++)if(A.eq($,A.mul(I[L],X)))return!0;X=A.mul(X,A.w[K])}return!1}}}class P1{constructor(e,r){this.curve=e,this.logger=r,this.resetProof()}resetProof(){this.polynomials={},this.evaluations={}}addPolynomial(e,r){e in this.polynomials&&this.logger.warn(`proof: polynomial.${e} already exist in proof`),this.polynomials[e]=r}getPolynomial(e){return e in this.polynomials||this.logger.warn(`proof: polynomial ${e} does not exist in proof`),this.polynomials[e]}addEvaluation(e,r){e in this.evaluations&&this.logger.warn(`proof: evaluations.${e} already exist in proof`),this.evaluations[e]=r}getEvaluation(e){return e in this.evaluations||this.logger.warn(`proof: evaluation ${e} does not exist in proof`),this.evaluations[e]}toObjectProof(e=!0){let r=e?{polynomials:{},evaluations:{}}:{};return Object.keys(this.polynomials).forEach(t=>{const a=this.curve.G1.toObject(this.polynomials[t]);e?r.polynomials[t]=a:r[t]=a}),Object.keys(this.evaluations).forEach(t=>{const a=this.curve.Fr.toObject(this.evaluations[t]);e?r.evaluations[t]=a:r[t]=a}),r}fromObjectProof(e){this.resetProof(),Object.keys(e.polynomials).forEach(r=>{this.polynomials[r]=this.curve.G1.fromObject(e.polynomials[r])}),Object.keys(e.evaluations).forEach(r=>{this.evaluations[r]=this.curve.Fr.fromObject(e.evaluations[r])})}}var _6={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(i){(function(){var e="input is invalid type",r="finalize already called",t=typeof window=="object",a=t?window:{};a.JS_SHA3_NO_WINDOW&&(t=!1);var n=!t&&typeof self=="object",c=!a.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;c?a=kE:n&&(a=self);var u=!a.JS_SHA3_NO_COMMON_JS&&!0&&i.exports,v=!a.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",o="0123456789abcdef".split(""),h=[31,7936,2031616,520093696],g=[4,1024,262144,67108864],y=[1,256,65536,16777216],_=[6,1536,393216,100663296],A=[0,8,16,24],S=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],T=[224,256,384,512],B=[128,256],M=["hex","buffer","arrayBuffer","array","digest"],R={128:168,256:136};(a.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function($){return Object.prototype.toString.call($)==="[object Array]"}),v&&(a.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function($){return typeof $=="object"&&$.buffer&&$.buffer.constructor===ArrayBuffer});for(var P=function($,I,K){return function(N){return new F($,I,$).update(N)[K]()}},D=function($,I,K){return function(N,X){return new F($,I,X).update(N)[K]()}},q=function($,I,K){return function(N,X,Q,L){return d["cshake"+$].update(N,X,Q,L)[K]()}},k=function($,I,K){return function(N,X,Q,L){return d["kmac"+$].update(N,X,Q,L)[K]()}},U=function($,I,K,N){for(var X=0;X<M.length;++X){var Q=M[X];$[Q]=I(K,N,Q)}return $},O=function($,I){var K=P($,I,"hex");return K.create=function(){return new F($,I,$)},K.update=function(N){return K.create().update(N)},U(K,P,$,I)},G=function($,I){var K=D($,I,"hex");return K.create=function(N){return new F($,I,N)},K.update=function(N,X){return K.create(X).update(N)},U(K,D,$,I)},E=function($,I){var K=R[$],N=q($,I,"hex");return N.create=function(X,Q,L){return!Q&&!L?d["shake"+$].create(X):new F($,I,X).bytepad([Q,L],K)},N.update=function(X,Q,L,V){return N.create(Q,L,V).update(X)},U(N,q,$,I)},s=function($,I){var K=R[$],N=k($,I,"hex");return N.create=function(X,Q,L){return new z($,I,Q).bytepad(["KMAC",L],K).bytepad([X],K)},N.update=function(X,Q,L,V){return N.create(X,L,V).update(Q)},U(N,k,$,I)},l=[{name:"keccak",padding:y,bits:T,createMethod:O},{name:"sha3",padding:_,bits:T,createMethod:O},{name:"shake",padding:h,bits:B,createMethod:G},{name:"cshake",padding:g,bits:B,createMethod:E},{name:"kmac",padding:g,bits:B,createMethod:s}],d={},p=[],m=0;m<l.length;++m)for(var w=l[m],x=w.bits,b=0;b<x.length;++b){var f=w.name+"_"+x[b];if(p.push(f),d[f]=w.createMethod(x[b],w.padding),w.name!=="sha3"){var C=w.name+x[b];p.push(C),d[C]=d[f]}}function F($,I,K){this.blocks=[],this.s=[],this.padding=I,this.outputBits=K,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-($<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=K>>5,this.extraBytes=(K&31)>>3;for(var N=0;N<50;++N)this.s[N]=0}F.prototype.update=function($){if(this.finalized)throw new Error(r);var I,K=typeof $;if(K!=="string"){if(K==="object"){if($===null)throw new Error(e);if(v&&$.constructor===ArrayBuffer)$=new Uint8Array($);else if(!Array.isArray($)&&(!v||!ArrayBuffer.isView($)))throw new Error(e)}else throw new Error(e);I=!0}for(var N=this.blocks,X=this.byteCount,Q=$.length,L=this.blockCount,V=0,Z=this.s,H,j;V<Q;){if(this.reset)for(this.reset=!1,N[0]=this.block,H=1;H<L+1;++H)N[H]=0;if(I)for(H=this.start;V<Q&&H<X;++V)N[H>>2]|=$[V]<<A[H++&3];else for(H=this.start;V<Q&&H<X;++V)j=$.charCodeAt(V),j<128?N[H>>2]|=j<<A[H++&3]:j<2048?(N[H>>2]|=(192|j>>6)<<A[H++&3],N[H>>2]|=(128|j&63)<<A[H++&3]):j<55296||j>=57344?(N[H>>2]|=(224|j>>12)<<A[H++&3],N[H>>2]|=(128|j>>6&63)<<A[H++&3],N[H>>2]|=(128|j&63)<<A[H++&3]):(j=65536+((j&1023)<<10|$.charCodeAt(++V)&1023),N[H>>2]|=(240|j>>18)<<A[H++&3],N[H>>2]|=(128|j>>12&63)<<A[H++&3],N[H>>2]|=(128|j>>6&63)<<A[H++&3],N[H>>2]|=(128|j&63)<<A[H++&3]);if(this.lastByteIndex=H,H>=X){for(this.start=H-X,this.block=N[L],H=0;H<L;++H)Z[H]^=N[H];W(Z),this.reset=!0}else this.start=H}return this},F.prototype.encode=function($,I){var K=$&255,N=1,X=[K];for($=$>>8,K=$&255;K>0;)X.unshift(K),$=$>>8,K=$&255,++N;return I?X.push(N):X.unshift(N),this.update(X),X.length},F.prototype.encodeString=function($){var I,K=typeof $;if(K!=="string"){if(K==="object"){if($===null)throw new Error(e);if(v&&$.constructor===ArrayBuffer)$=new Uint8Array($);else if(!Array.isArray($)&&(!v||!ArrayBuffer.isView($)))throw new Error(e)}else throw new Error(e);I=!0}var N=0,X=$.length;if(I)N=X;else for(var Q=0;Q<$.length;++Q){var L=$.charCodeAt(Q);L<128?N+=1:L<2048?N+=2:L<55296||L>=57344?N+=3:(L=65536+((L&1023)<<10|$.charCodeAt(++Q)&1023),N+=4)}return N+=this.encode(N*8),this.update($),N},F.prototype.bytepad=function($,I){for(var K=this.encode(I),N=0;N<$.length;++N)K+=this.encodeString($[N]);var X=I-K%I,Q=[];return Q.length=X,this.update(Q),this},F.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var $=this.blocks,I=this.lastByteIndex,K=this.blockCount,N=this.s;if($[I>>2]|=this.padding[I&3],this.lastByteIndex===this.byteCount)for($[0]=$[K],I=1;I<K+1;++I)$[I]=0;for($[K-1]|=2147483648,I=0;I<K;++I)N[I]^=$[I];W(N)}},F.prototype.toString=F.prototype.hex=function(){this.finalize();for(var $=this.blockCount,I=this.s,K=this.outputBlocks,N=this.extraBytes,X=0,Q=0,L="",V;Q<K;){for(X=0;X<$&&Q<K;++X,++Q)V=I[X],L+=o[V>>4&15]+o[V&15]+o[V>>12&15]+o[V>>8&15]+o[V>>20&15]+o[V>>16&15]+o[V>>28&15]+o[V>>24&15];Q%$===0&&(W(I),X=0)}return N&&(V=I[X],L+=o[V>>4&15]+o[V&15],N>1&&(L+=o[V>>12&15]+o[V>>8&15]),N>2&&(L+=o[V>>20&15]+o[V>>16&15])),L},F.prototype.arrayBuffer=function(){this.finalize();var $=this.blockCount,I=this.s,K=this.outputBlocks,N=this.extraBytes,X=0,Q=0,L=this.outputBits>>3,V;N?V=new ArrayBuffer(K+1<<2):V=new ArrayBuffer(L);for(var Z=new Uint32Array(V);Q<K;){for(X=0;X<$&&Q<K;++X,++Q)Z[Q]=I[X];Q%$===0&&W(I)}return N&&(Z[X]=I[X],V=V.slice(0,L)),V},F.prototype.buffer=F.prototype.arrayBuffer,F.prototype.digest=F.prototype.array=function(){this.finalize();for(var $=this.blockCount,I=this.s,K=this.outputBlocks,N=this.extraBytes,X=0,Q=0,L=[],V,Z;Q<K;){for(X=0;X<$&&Q<K;++X,++Q)V=Q<<2,Z=I[X],L[V]=Z&255,L[V+1]=Z>>8&255,L[V+2]=Z>>16&255,L[V+3]=Z>>24&255;Q%$===0&&W(I)}return N&&(V=Q<<2,Z=I[X],L[V]=Z&255,N>1&&(L[V+1]=Z>>8&255),N>2&&(L[V+2]=Z>>16&255)),L};function z($,I,K){F.call(this,$,I,K)}z.prototype=new F,z.prototype.finalize=function(){return this.encode(this.outputBits,!0),F.prototype.finalize.call(this)};var W=function($){var I,K,N,X,Q,L,V,Z,H,j,et,nt,st,ft,vt,ot,pt,Ut,At,It,Jt,at,J,rt,lt,gt,Dt,ut,Y,tt,dt,mt,xt,bt,_t,Ht,St,Mt,jt,Lt,Ft,te,Bt,Ot,ie,kt,qt,ae,Rt,zt,he,Vt,Qt,ge,Gt,$t,pe,de,Ee,xe,Se,Be,Ne;for(N=0;N<48;N+=2)X=$[0]^$[10]^$[20]^$[30]^$[40],Q=$[1]^$[11]^$[21]^$[31]^$[41],L=$[2]^$[12]^$[22]^$[32]^$[42],V=$[3]^$[13]^$[23]^$[33]^$[43],Z=$[4]^$[14]^$[24]^$[34]^$[44],H=$[5]^$[15]^$[25]^$[35]^$[45],j=$[6]^$[16]^$[26]^$[36]^$[46],et=$[7]^$[17]^$[27]^$[37]^$[47],nt=$[8]^$[18]^$[28]^$[38]^$[48],st=$[9]^$[19]^$[29]^$[39]^$[49],I=nt^(L<<1|V>>>31),K=st^(V<<1|L>>>31),$[0]^=I,$[1]^=K,$[10]^=I,$[11]^=K,$[20]^=I,$[21]^=K,$[30]^=I,$[31]^=K,$[40]^=I,$[41]^=K,I=X^(Z<<1|H>>>31),K=Q^(H<<1|Z>>>31),$[2]^=I,$[3]^=K,$[12]^=I,$[13]^=K,$[22]^=I,$[23]^=K,$[32]^=I,$[33]^=K,$[42]^=I,$[43]^=K,I=L^(j<<1|et>>>31),K=V^(et<<1|j>>>31),$[4]^=I,$[5]^=K,$[14]^=I,$[15]^=K,$[24]^=I,$[25]^=K,$[34]^=I,$[35]^=K,$[44]^=I,$[45]^=K,I=Z^(nt<<1|st>>>31),K=H^(st<<1|nt>>>31),$[6]^=I,$[7]^=K,$[16]^=I,$[17]^=K,$[26]^=I,$[27]^=K,$[36]^=I,$[37]^=K,$[46]^=I,$[47]^=K,I=j^(X<<1|Q>>>31),K=et^(Q<<1|X>>>31),$[8]^=I,$[9]^=K,$[18]^=I,$[19]^=K,$[28]^=I,$[29]^=K,$[38]^=I,$[39]^=K,$[48]^=I,$[49]^=K,ft=$[0],vt=$[1],kt=$[11]<<4|$[10]>>>28,qt=$[10]<<4|$[11]>>>28,ut=$[20]<<3|$[21]>>>29,Y=$[21]<<3|$[20]>>>29,xe=$[31]<<9|$[30]>>>23,Se=$[30]<<9|$[31]>>>23,te=$[40]<<18|$[41]>>>14,Bt=$[41]<<18|$[40]>>>14,bt=$[2]<<1|$[3]>>>31,_t=$[3]<<1|$[2]>>>31,ot=$[13]<<12|$[12]>>>20,pt=$[12]<<12|$[13]>>>20,ae=$[22]<<10|$[23]>>>22,Rt=$[23]<<10|$[22]>>>22,tt=$[33]<<13|$[32]>>>19,dt=$[32]<<13|$[33]>>>19,Be=$[42]<<2|$[43]>>>30,Ne=$[43]<<2|$[42]>>>30,ge=$[5]<<30|$[4]>>>2,Gt=$[4]<<30|$[5]>>>2,Ht=$[14]<<6|$[15]>>>26,St=$[15]<<6|$[14]>>>26,Ut=$[25]<<11|$[24]>>>21,At=$[24]<<11|$[25]>>>21,zt=$[34]<<15|$[35]>>>17,he=$[35]<<15|$[34]>>>17,mt=$[45]<<29|$[44]>>>3,xt=$[44]<<29|$[45]>>>3,rt=$[6]<<28|$[7]>>>4,lt=$[7]<<28|$[6]>>>4,$t=$[17]<<23|$[16]>>>9,pe=$[16]<<23|$[17]>>>9,Mt=$[26]<<25|$[27]>>>7,jt=$[27]<<25|$[26]>>>7,It=$[36]<<21|$[37]>>>11,Jt=$[37]<<21|$[36]>>>11,Vt=$[47]<<24|$[46]>>>8,Qt=$[46]<<24|$[47]>>>8,Ot=$[8]<<27|$[9]>>>5,ie=$[9]<<27|$[8]>>>5,gt=$[18]<<20|$[19]>>>12,Dt=$[19]<<20|$[18]>>>12,de=$[29]<<7|$[28]>>>25,Ee=$[28]<<7|$[29]>>>25,Lt=$[38]<<8|$[39]>>>24,Ft=$[39]<<8|$[38]>>>24,at=$[48]<<14|$[49]>>>18,J=$[49]<<14|$[48]>>>18,$[0]=ft^~ot&Ut,$[1]=vt^~pt&At,$[10]=rt^~gt&ut,$[11]=lt^~Dt&Y,$[20]=bt^~Ht&Mt,$[21]=_t^~St&jt,$[30]=Ot^~kt&ae,$[31]=ie^~qt&Rt,$[40]=ge^~$t&de,$[41]=Gt^~pe&Ee,$[2]=ot^~Ut&It,$[3]=pt^~At&Jt,$[12]=gt^~ut&tt,$[13]=Dt^~Y&dt,$[22]=Ht^~Mt&Lt,$[23]=St^~jt&Ft,$[32]=kt^~ae&zt,$[33]=qt^~Rt&he,$[42]=$t^~de&xe,$[43]=pe^~Ee&Se,$[4]=Ut^~It&at,$[5]=At^~Jt&J,$[14]=ut^~tt&mt,$[15]=Y^~dt&xt,$[24]=Mt^~Lt&te,$[25]=jt^~Ft&Bt,$[34]=ae^~zt&Vt,$[35]=Rt^~he&Qt,$[44]=de^~xe&Be,$[45]=Ee^~Se&Ne,$[6]=It^~at&ft,$[7]=Jt^~J&vt,$[16]=tt^~mt&rt,$[17]=dt^~xt&lt,$[26]=Lt^~te&bt,$[27]=Ft^~Bt&_t,$[36]=zt^~Vt&Ot,$[37]=he^~Qt&ie,$[46]=xe^~Be&ge,$[47]=Se^~Ne&Gt,$[8]=at^~ft&ot,$[9]=J^~vt&pt,$[18]=mt^~rt&gt,$[19]=xt^~lt&Dt,$[28]=te^~bt&Ht,$[29]=Bt^~_t&St,$[38]=Vt^~Ot&kt,$[39]=Qt^~ie&qt,$[48]=Be^~ge&$t,$[49]=Ne^~Gt&pe,$[0]^=S[N],$[1]^=S[N+1]};if(u)i.exports=d;else for(m=0;m<p.length;++m)a[p[m]]=d[p[m]]})()})(_6);var S9=_6.exports;const{keccak256:x9}=S9,dh=0,I9=1;class Ua{constructor(e){this.G1=e.G1,this.Fr=e.Fr,this.reset()}reset(){this.data=[]}addPolCommitment(e){this.data.push({type:dh,data:e})}addScalar(e){this.data.push({type:I9,data:e})}getChallenge(){if(this.data.length===0)throw new Error("Keccak256Transcript: No data to generate a transcript");let e=0,r=0;this.data.forEach(c=>dh===c.type?e++:r++);let t=new Uint8Array(r*this.Fr.n8+e*this.G1.F.n8*2),a=0;for(let c=0;c<this.data.length;c++)dh===this.data[c].type?(this.G1.toRprUncompressed(t,a,this.data[c].data),a+=this.G1.F.n8*2):(this.Fr.toRprBE(t,a,this.data[c].data),a+=this.Fr.n8);const n=Ae.fromRprBE(new Uint8Array(x9.arrayBuffer(t)));return this.Fr.e(n)}}class ph{static getZ1(e){return[e.zero,e.add(e.e(-1),e.w[2]),e.e(-2),e.sub(e.e(-1),e.w[2])]}static getZ2(e){return[e.zero,e.add(e.zero,e.mul(e.e(-2),e.w[2])),e.e(4),e.sub(e.zero,e.mul(e.e(-2),e.w[2]))]}static getZ3(e){return[e.zero,e.add(e.e(2),e.mul(e.e(2),e.w[2])),e.e(-8),e.sub(e.e(2),e.mul(e.e(2),e.w[2]))]}static mul2(e,r,t,a,n,c){const u=this.getZ1(c);let v,o;const h=c.mul(e,r),g=c.mul(e,a),y=c.mul(t,r),_=c.mul(t,a);v=h;let A=c.add(g,y),S=_;return o=A,n&&(o=c.add(o,c.mul(u[n],S))),[v,o]}static mul3(e,r,t,a,n,c,u,v){const o=this.getZ1(v),h=this.getZ2(v);let g,y;const _=v.mul(e,r),A=v.mul(e,n),S=v.mul(a,r),T=v.mul(a,n);g=v.mul(_,t);let B=v.mul(S,t);B=v.add(B,v.mul(A,t)),B=v.add(B,v.mul(_,c));let M=v.mul(T,t);if(M=v.add(M,v.mul(A,c)),M=v.add(M,v.mul(S,c)),y=B,u){const R=v.mul(T,c);y=v.add(y,v.mul(o[u],M)),y=v.add(y,v.mul(h[u],R))}return[g,y]}static mul4(e,r,t,a,n,c,u,v,o,h){const g=this.getZ1(h),y=this.getZ2(h),_=this.getZ3(h);let A,S;const T=h.mul(e,r),B=h.mul(e,c),M=h.mul(n,r),R=h.mul(n,c),P=h.mul(t,a),D=h.mul(t,v),q=h.mul(u,a),k=h.mul(u,v);A=h.mul(T,P);let U=h.mul(M,P);U=h.add(U,h.mul(B,P)),U=h.add(U,h.mul(T,q)),U=h.add(U,h.mul(T,D));let O=h.mul(R,P);O=h.add(O,h.mul(M,q)),O=h.add(O,h.mul(M,D)),O=h.add(O,h.mul(B,q)),O=h.add(O,h.mul(B,D)),O=h.add(O,h.mul(T,k));let G=h.mul(B,k);G=h.add(G,h.mul(M,k)),G=h.add(G,h.mul(R,D)),G=h.add(G,h.mul(R,q));let E=h.mul(R,k);return S=U,o&&(S=h.add(S,h.mul(g[o],O)),S=h.add(S,h.mul(y[o],G)),S=h.add(S,h.mul(_[o],E))),[A,S]}}const Im=3,M9=4,B9=5,L9=6,vh=7,gh=8,mh=9,yh=10,bh=11,Ia=12,T9=13,Mm=14;class _e{constructor(e,r,t){this.coef=e,this.curve=r,this.Fr=r.Fr,this.G1=r.G1,this.logger=t}static async fromEvaluations(e,r,t){let a=await r.Fr.ifft(e);return new _e(a,r,t)}static fromCoefficientsArray(e,r,t){const a=r.Fr;let n=e.length>32768?new ee(e.length*a.n8):new Uint8Array(e.length*a.n8);for(let c=0;c<e.length;c++)n.set(e[c],c*a.n8);return new _e(n,r,t)}static fromPolynomial(e,r,t){let a=e.length(),n=r.Fr,c=a>32768?new ee(a*n.n8):new Uint8Array(a*n.n8);return c.set(e.coef.slice(),0),new _e(c,r,t)}isEqual(e){const r=this.degree();if(r!==e.degree())return!1;for(let t=0;t<r+1;t++)if(!this.Fr.eq(this.getCoef(t),e.getCoef(t)))return!1;return!0}blindCoefficients(e){e=e||[];const r=this.length()+e.length>32768?new ee((this.length()+e.length)*this.Fr.n8):new Uint8Array((this.length()+e.length)*this.Fr.n8);r.set(this.coef,0);for(let t=0;t<e.length;t++)r.set(this.Fr.add(r.slice((this.length()+t)*this.Fr.n8,(this.length()+t+1)*this.Fr.n8),e[t]),(this.length()+t)*this.Fr.n8),r.set(this.Fr.sub(r.slice(t*this.Fr.n8,(t+1)*this.Fr.n8),e[t]),t*this.Fr.n8);this.coef=r}getCoef(e){const r=e*this.Fr.n8;return r+this.Fr.n8>this.coef.byteLength?this.Fr.zero:this.coef.slice(r,r+this.Fr.n8)}setCoef(e,r){if(e>this.length()-1)throw new Error("Coef index is not available");this.coef.set(r,e*this.Fr.n8)}static async to4T(e,r,t,a){t=t||[];let n=await a.ifft(e);const c=r*4>32768?new ee(r*4*a.n8):new Uint8Array(r*4*a.n8);c.set(n,0);const u=await a.fft(c);if(t.length===0)return[n,u];const v=r+t.length>32768?new ee((r+t.length)*a.n8):new Uint8Array((r+t.length)*a.n8);v.set(n,0);for(let o=0;o<t.length;o++)v.set(a.add(v.slice((r+o)*a.n8,(r+o+1)*a.n8),t[o]),(r+o)*a.n8),v.set(a.sub(v.slice(o*a.n8,(o+1)*a.n8),t[o]),o*a.n8);return[v,u]}length(){let e=this.coef.byteLength/this.Fr.n8;if(e!==Math.floor(this.coef.byteLength/this.Fr.n8))throw new Error("Polynomial coefficients buffer has incorrect size");return e===0&&this.logger&&this.logger.warn("Polynomial has length zero"),e}degree(){for(let e=this.length()-1;e>0;e--){const r=e*this.Fr.n8;if(!this.Fr.eq(this.Fr.zero,this.coef.slice(r,r+this.Fr.n8)))return e}return 0}evaluate(e){let r=this.Fr.zero;for(let t=this.degree()+1;t>0;t--){let a=t*this.Fr.n8;const n=this.coef.slice(a-this.Fr.n8,a);r=this.Fr.add(n,this.Fr.mul(r,e))}return r}fastEvaluate(e){const r=this.Fr;let t=3,a=this.degree()+1,n=parseInt(a/t),c=a-n*t,u=[],v=[];v[0]=r.one;for(let o=0;o<t;o++){u[o]=r.zero;let h=o===t-1?n+c:n;for(let g=h;g>0;g--)u[o]=r.add(this.getCoef(o*n+g-1),r.mul(u[o],e)),o===0&&(v[0]=r.mul(v[0],e))}for(let o=1;o<t;o++)u[0]=r.add(u[0],r.mul(v[o-1],u[o])),v[o]=r.mul(v[o-1],v[0]);return u[0]}add(e,r){let t=!1;e.length()>this.length()&&(t=!0);const a=this.length(),n=e.length();for(let c=0;c<Math.max(a,n);c++){const u=c*this.Fr.n8,v=c<a?this.coef.slice(u,u+this.Fr.n8):this.Fr.zero;let o=c<n?e.coef.slice(u,u+this.Fr.n8):this.Fr.zero;r!==void 0&&(o=this.Fr.mul(o,r)),t?e.coef.set(this.Fr.add(v,o),u):this.coef.set(this.Fr.add(v,o),u)}t&&(delete this.coef,this.coef=e.coef)}sub(e,r){let t=!1;e.length()>this.length()&&(t=!0);const a=this.length(),n=e.length();for(let c=0;c<Math.max(a,n);c++){const u=c*this.Fr.n8,v=c<a?this.coef.slice(u,u+this.Fr.n8):this.Fr.zero;let o=c<n?e.coef.slice(u,u+this.Fr.n8):this.Fr.zero;r!==void 0&&(o=this.Fr.mul(o,r)),t?e.coef.set(this.Fr.sub(v,o),u):this.coef.set(this.Fr.sub(v,o),u)}t&&(delete this.coef,this.coef=e.coef)}mulScalar(e){for(let r=0;r<this.length();r++){const t=r*this.Fr.n8;this.coef.set(this.Fr.mul(this.coef.slice(t,t+this.Fr.n8),e),t)}}addScalar(e){const r=this.length()===0?this.Fr.zero:this.coef.slice(0,this.Fr.n8);this.coef.set(this.Fr.add(r,e),0)}subScalar(e){const r=this.length()===0?this.Fr.zero:this.coef.slice(0,this.Fr.n8);this.coef.set(this.Fr.sub(r,e),0)}byXSubValue(e){const r=this.Fr,a=!r.eq(r.zero,this.getCoef(this.length()-1))?this.length()+1:this.length(),n=a>32768?new ee(a*r.n8):new Uint8Array(a*r.n8);let c=new _e(n,this.curve,this.logger);c.coef.set(this.coef.slice(0,(a-1)*r.n8),32),this.mulScalar(r.neg(e)),c.add(this),this.coef=c.coef}byXNSubValue(e,r){const t=this.Fr,n=!(this.length()-e-1>=this.degree())?this.length()+e:this.length(),c=n>32768?new ee(n*t.n8):new Uint8Array(n*t.n8);let u=new _e(c,this.curve,this.logger);u.coef.set(this.coef.slice(0,(this.degree()+1)*32),e*32),this.mulScalar(r),u.add(this),this.coef=u.coef}divBy(e){const r=this.Fr,t=this.degree(),a=e.degree();let n=new _e(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new ee(this.length()*r.n8):new Uint8Array(this.length()*r.n8);for(let c=t-a;c>=0;c--){this.setCoef(c,r.div(n.getCoef(c+a),e.getCoef(a)));for(let u=0;u<=a;u++)n.setCoef(c+u,r.sub(n.getCoef(c+u),r.mul(this.getCoef(c),e.getCoef(u))))}return n}divByMonic(e,r){const t=this.Fr;let a=this.degree(),n=this.length()>32768?new ee(this.length()*t.n8):new Uint8Array(this.length()*t.n8),c=new _e(n,this.curve,this.logger),u=[];for(let o=0;o<e;o++)c.setCoef(a-o-e,this.getCoef(a-o)),u[o]=this.getCoef(a-o);let v=e;for(let o=0;o<v;o++)for(let h=a-2*e-o;h>=0&&!(h<0);h=h-v){let g=o;u[g]=t.add(this.getCoef(h+e),t.mul(u[g],r)),c.setCoef(h,u[g])}this.coef=c.coef}divByVanishing(e,r){if(this.degree()<e)throw new Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");const t=this.Fr;let a=new _e(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new ee(this.length()*t.n8):new Uint8Array(this.length()*t.n8);for(let n=this.length()-1;n>=e;n--){let c=a.getCoef(n);t.eq(t.zero,c)||(a.setCoef(n,t.zero),a.setCoef(n-e,t.add(a.getCoef(n-e),t.mul(r,c))),this.setCoef(n-e,t.add(this.getCoef(n-e),c)))}return a}divByVanishing2(e,r){if(this.degree()<e)throw new Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");const t=this.Fr;let a=new _e(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new ee(this.length()*t.n8):new Uint8Array(this.length()*t.n8);let n=3,c=this.length()-e,u=Math.floor(c/n),v=c-(n-1)*u;console.log(c),console.log(u+"  "+v);for(let o=0;o<n;o++){console.log("> Thread "+o);for(let h=o===0?v:u;h>0;h--){let g=h-1;o!==0&&(g+=(o-1)*u+v);let y=g+e,_=a.getCoef(y);t.eq(t.zero,_)||(a.setCoef(y,t.zero),a.setCoef(g,t.add(a.getCoef(g),t.mul(r,_))),this.setCoef(g,t.add(this.getCoef(g),_)),console.log(g+" <-- "+y))}}return this.print(),a}fastDivByVanishing(e){const r=this.Fr;for(let t=0;t<e.length;t++){let a=e[t][0],n=e[t][1];if(this.degree()<a)throw new Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");let c=5,u=this.length()-a,v=Math.floor(u/c/a),o=v*a,h=u-c*o,g=new _e(this.length()>32768?new ee(this.length()*r.n8):new Uint8Array(this.length()*r.n8),this.curve,this.logger),y=this.coef;this.coef=g.coef,g.coef=y;for(let M=0;M<c;M++){let R=(M+1)*o+h;for(let P=0;P<a;P++)this.setCoef(R+P-a,g.getCoef(R+P));for(let P=0;P<o-a;P++){let D=R-P-1,q=r.add(g.getCoef(D),r.mul(n,this.getCoef(D)));this.setCoef(D-a,q)}}let _=h,A=h;for(let M=0;M<a&&A;M++)this.setCoef(_-M-1,g.getCoef(_+a-M-1)),A--;for(let M=0;M<A;M++){let R=_-M-1,P=r.add(g.getCoef(R),r.mul(n,this.getCoef(R)));this.setCoef(R-a,P)}let S=[],T=r.one;for(let M=0;M<v;M++)T=r.mul(T,n);let B=r.one;for(let M=c;M>0;M--){let R=M-1,P=R*o+h;S[R]=[];for(let D=0;D<a;D++)S[R][D]=this.getCoef(P+D),M!==c&&(S[R][D]=r.add(S[R][D],r.mul(T,S[R+1][D])));B=r.mul(B,T)}for(let M=0;M<c;M++){let R=M*o+h,P=n,D=a-1,q=M===0?h:o;for(let k=0;k<q;k++){let U=R-k-1,O=r.add(this.getCoef(U),r.mul(P,S[M][D]));this.setCoef(U,O),D===0?(D=a-1,P=r.mul(P,n)):D--}}}}divByXSubValue(e){const r=this.length()>32768?new ee(this.length()*this.Fr.n8):new Uint8Array(this.length()*this.Fr.n8);r.set(this.Fr.zero,(this.length()-1)*this.Fr.n8),r.set(this.coef.slice((this.length()-1)*this.Fr.n8,this.length()*this.Fr.n8),(this.length()-2)*this.Fr.n8);for(let t=this.length()-3;t>=0;t--){let a=t*this.Fr.n8;r.set(this.Fr.add(this.coef.slice(a+this.Fr.n8,a+2*this.Fr.n8),this.Fr.mul(e,r.slice(a+this.Fr.n8,a+2*this.Fr.n8))),t*this.Fr.n8)}if(!this.Fr.eq(this.coef.slice(0,this.Fr.n8),this.Fr.mul(this.Fr.neg(e),r.slice(0,this.Fr.n8))))throw new Error("Polynomial does not divide");this.coef=r}divZh(e,r=4){for(let a=0;a<e;a++){const n=a*this.Fr.n8;this.coef.set(this.Fr.neg(this.coef.slice(n,n+this.Fr.n8)),n)}const t=this.coef.byteLength/this.Fr.n8;for(let a=e;a<t;a++){const n=a*this.Fr.n8,c=this.Fr.sub(this.coef.slice((a-e)*this.Fr.n8,(a-e)*this.Fr.n8+this.Fr.n8),this.coef.slice(n,n+this.Fr.n8));if(this.coef.set(c,n),a>e*(r-1)-r&&!this.Fr.isZero(c))throw new Error("Polynomial is not divisible")}return this}divByZerofier(e,r){let t=this.Fr;const a=t.inv(r),n=t.neg(a);let c=t.eq(t.one,n),u=t.eq(t.negone,n);if(!c)for(let v=0;v<e;v++){const o=v*this.Fr.n8;let h;u?h=t.neg(this.coef.slice(o,o+this.Fr.n8)):h=t.mul(n,this.coef.slice(o,o+this.Fr.n8)),this.coef.set(h,o)}c=t.eq(t.one,a),u=t.eq(t.negone,a);for(let v=e;v<this.length();v++){const o=v*this.Fr.n8,h=(v-e)*this.Fr.n8;let g=this.Fr.sub(this.coef.slice(h,h+this.Fr.n8),this.coef.slice(o,o+this.Fr.n8));if(c||(u?g=t.neg(g):g=t.mul(a,g)),this.coef.set(g,o),v>this.length()-e-1&&!this.Fr.isZero(g))throw new Error("Polynomial is not divisible")}return this}byX(){const e=this.length()+1>32768?new ee(this.coef.byteLength+this.Fr.n8):new Uint8Array(this.coef.byteLength+this.Fr.n8);e.set(this.Fr.zero,0),e.set(this.coef,this.Fr.n8),this.coef=e}static async expX(e,r,t=!1){const a=e.Fr;if(r<1)throw new Error("Compute a new polynomial to a zero or negative number is not allowed");if(r===1)return await _e.fromEvaluations(e.coef,curve,e.logger);const n=t?e.degree():e.length()-1,c=n*r+1>32768?new ee((n*r+1)*a.n8):new Uint8Array((n*r+1)*a.n8);c.set(e.getCoef(0),0);for(let u=1;u<=n;u++){const v=u*a.n8,o=e.getCoef(u);c.set(o,v*r)}return new _e(c,e.curve,e.logger)}split(e,r,t){if(e<1)throw new Error(`Polynomials can't be split in ${e} parts`);if(e===1)return[this];if(t.length!==0&&t.length<e-1)throw new Error(`Blinding factors length must be ${e-1}`);const a=(r+1)*this.Fr.n8;let n=[];const c=Math.ceil((this.degree()+1)*this.Fr.n8/a);if(c<e)for(let u=c;u<e;u++)n[u]=new _e(new Uint8Array(this.Fr.n8),this.curve,this.logger);e=Math.min(e,c);for(let u=0;u<e;u++){const v=e-1===u,o=v?this.coef.byteLength-(e-1)*a:a+this.Fr.n8;let h=o/this.Fr.n8>32768?new ee(o):new Uint8Array(o);n[u]=new _e(h,this.curve,this.logger);const g=u*a,y=v?this.coef.byteLength:(u+1)*a;if(n[u].coef.set(this.coef.slice(g,y),0),v||n[u].coef.set(t[u],a),u!==0){const _=this.Fr.sub(n[u].coef.slice(0,this.Fr.n8),t[u-1]);n[u].coef.set(_,0)}v&&n[u].truncate()}return n}truncate(){const e=this.degree();if(e+1<this.coef.byteLength/this.Fr.n8){const r=e+1>32768?new ee((e+1)*this.Fr.n8):new Uint8Array((e+1)*this.Fr.n8);r.set(this.coef.slice(0,(e+1)*this.Fr.n8),0),this.coef=r}}static lagrangePolynomialInterpolation(e,r,t){const a=t.Fr;let n=c(0);for(let u=1;u<e.length;u++)n.add(c(u));return n;function c(u){let v;for(let g=0;g<e.length;g++)if(g!==u)if(v===void 0){let y=e.length>32768?new ee(e.length*a.n8):new Uint8Array(e.length*a.n8);v=new _e(y,t),v.setCoef(0,a.neg(e[g])),v.setCoef(1,a.one)}else v.byXSubValue(e[g]);let o=v.evaluate(e[u]);o=a.inv(o);const h=a.mul(r[u],o);return v.mulScalar(h),v}}static zerofierPolynomial(e,r){const t=r.Fr;let a=e.length+1>32768?new ee((e.length+1)*t.n8):new Uint8Array((e.length+1)*t.n8),n=new _e(a,r);n.setCoef(0,t.neg(e[0])),n.setCoef(1,t.one);for(let c=1;c<e.length;c++)n.byXSubValue(e[c]);return n}print(){const e=this.Fr;let r="";for(let t=this.degree();t>=0;t--){const a=this.getCoef(t);e.eq(e.zero,a)||(e.isNegative(a)?r+=" - ":t!==this.degree()&&(r+=" + "),r+=e.toString(a),t>0&&(r+=t>1?"x^"+t:"x"))}console.log(r)}async multiExponentiation(e,r){const t=this.coef.byteLength/this.Fr.n8,a=e.slice(0,t*this.G1.F.n8*2),n=await this.Fr.batchFromMontgomery(this.coef);let c=await this.G1.multiExpAffine(a,n,this.logger,r);return c=this.G1.toAffine(c),c}}class Ar{constructor(e,r,t){this.eval=e,this.curve=r,this.Fr=r.Fr,this.logger=t}static async fromPolynomial(e,r,t,a){const n=new ee(e.length()*r*t.Fr.n8);n.set(e.coef,0);const c=await t.Fr.fft(n);return new Ar(c,t,a)}getEvaluation(e){const r=e*this.Fr.n8;if(r+this.Fr.n8>this.eval.byteLength)throw new Error("Evaluations.getEvaluation() out of bounds");return this.eval.slice(r,r+this.Fr.n8)}length(){let e=this.eval.byteLength/this.Fr.n8;if(e!==Math.floor(this.eval.byteLength/this.Fr.n8))throw new Error("Polynomial evaluations buffer has incorrect size");return e===0&&this.logger.warn("Polynomial has length zero"),e}}const{stringifyBigInts:Bm}=ri;async function w6(i,e,r,t){const{fd:a,sections:n}=await gr(e,"wtns",2);r&&r.debug("> Reading witness file");const c=await Yo(a,n);r&&r.debug("> Reading zkey file");const{fd:u,sections:v}=await gr(i,"zkey",2),o=await an(u,v,void 0,t);if(o.protocol!="plonk")throw new Error("zkey file is not plonk");if(!Ae.eq(o.r,c.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(c.nWitness!=o.nVars-o.nAdditions)throw new Error(`Invalid witness length. Circuit: ${o.nVars}, witness: ${c.nWitness}, ${o.nAdditions}`);const h=o.curve,g=h.Fr,y=h.Fr.n8,_=o.domainSize*y;r&&(r.debug("----------------------------"),r.debug("  PLONK PROVE SETTINGS"),r.debug(`  Curve:         ${h.name}`),r.debug(`  Circuit power: ${o.power}`),r.debug(`  Domain size:   ${o.domainSize}`),r.debug(`  Vars:          ${o.nVars}`),r.debug(`  Public vars:   ${o.nPublic}`),r.debug(`  Constraints:   ${o.nConstraints}`),r.debug(`  Additions:     ${o.nAdditions}`),r.debug("----------------------------")),r&&r.debug("> Reading witness file data");const A=await fr(a,n,2);A.set(g.zero,0);const S=new ee(y*o.nAdditions);let T={},B={},M={},R={},P=new P1(h,r);const D=new Ua(h);r&&r.debug(`> Reading Section ${Im}. Additions`),await O(),r&&r.debug(`> Reading Section ${Ia}. Sigma1, Sigma2 & Sigma 3`),r&&r.debug(" Reading Sigma polynomials "),B.Sigma1=new _e(new ee(_),h,r),B.Sigma2=new _e(new ee(_),h,r),B.Sigma3=new _e(new ee(_),h,r),await u.readToBuffer(B.Sigma1.coef,0,_,v[Ia][0].p),await u.readToBuffer(B.Sigma2.coef,0,_,v[Ia][0].p+5*_),await u.readToBuffer(B.Sigma3.coef,0,_,v[Ia][0].p+10*_),r&&r.debug(" Reading Sigma evaluations"),M.Sigma1=new Ar(new ee(_*4),h,r),M.Sigma2=new Ar(new ee(_*4),h,r),M.Sigma3=new Ar(new ee(_*4),h,r),await u.readToBuffer(M.Sigma1.eval,0,_*4,v[Ia][0].p+_),await u.readToBuffer(M.Sigma2.eval,0,_*4,v[Ia][0].p+6*_),await u.readToBuffer(M.Sigma3.eval,0,_*4,v[Ia][0].p+11*_),r&&r.debug(`> Reading Section ${Mm}. Powers of Tau`);const q=await fr(u,v,Mm);let k=[];for(let z=1;z<=o.nPublic;z++){const W=A.slice(z*g.n8,z*g.n8+g.n8);k.push(Ae.fromRprLE(W))}r&&r.debug(""),r&&r.debug("> ROUND 1"),await s(),r&&r.debug("> ROUND 2"),await d(),r&&r.debug("> ROUND 3"),await m(),r&&r.debug("> ROUND 4"),await x(),r&&r.debug("> ROUND 5"),await b(),await u.close(),await a.close();let U=P.toObjectProof(!1);return U.protocol="plonk",U.curve=h.name,r&&r.debug("PLONK PROVER FINISHED"),{proof:Bm(U),publicSignals:Bm(k)};async function O(){r&&r.debug(" Computing additions");const z=await fr(u,v,Im),W=8+y*2;for(let $=0;$<o.nAdditions;$++){r&&$!==0&&$%1e5===0&&r.debug(`    addition ${$}/${o.nAdditions}`);let I=$*W;const K=G(z,I);I+=4;const N=G(z,I);I+=4;const X=z.slice(I,I+y);I+=y;const Q=z.slice(I,I+y),L=E(K),V=E(N),Z=g.add(g.mul(X,L),g.mul(Q,V));S.set(Z,y*$)}}function G(z,W){const $=z.slice(W,W+4);return new DataView($.buffer,$.byteOffset,$.byteLength).getUint32(0,!0)}function E(z){return z<o.nVars-o.nAdditions?A.slice(z*y,z*y+y):z<o.nVars?S.slice((z-(o.nVars-o.nAdditions))*y,(z-(o.nVars-o.nAdditions))*y+y):h.Fr.zero}async function s(){R.b=[];for(let I=1;I<=11;I++)R.b[I]=h.Fr.random();r&&r.debug("> Computing A, B, C wire polynomials"),await l(),r&&r.debug("> Computing A, B, C MSM");let z=await B.A.multiExponentiation(q,"A"),W=await B.B.multiExponentiation(q,"B"),$=await B.C.multiExponentiation(q,"C");return P.addPolynomial("A",z),P.addPolynomial("B",W),P.addPolynomial("C",$),0}async function l(){r&&r.debug(" Reading data from zkey file"),T.A=new ee(_),T.B=new ee(_),T.C=new ee(_);const z=await fr(u,v,M9),W=await fr(u,v,B9),$=await fr(u,v,L9);for(let I=0;I<o.nConstraints;I++){const K=I*y,N=I*4,X=G(z,N);T.A.set(E(X),K);const Q=G(W,N);T.B.set(E(Q),K);const L=G($,N);T.C.set(E(L),K)}if(T.A=await g.batchToMontgomery(T.A),T.B=await g.batchToMontgomery(T.B),T.C=await g.batchToMontgomery(T.C),r&&r.debug(" Computing A ifft"),B.A=await _e.fromEvaluations(T.A,h,r),r&&r.debug(" Computing B ifft"),B.B=await _e.fromEvaluations(T.B,h,r),r&&r.debug(" Computing C ifft"),B.C=await _e.fromEvaluations(T.C,h,r),r&&r.debug(" Computing A fft"),M.A=await Ar.fromPolynomial(B.A,4,h,r),r&&r.debug(" Computing B fft"),M.B=await Ar.fromPolynomial(B.B,4,h,r),r&&r.debug(" Computing C fft"),M.C=await Ar.fromPolynomial(B.C,4,h,r),B.A.blindCoefficients([R.b[2],R.b[1]]),B.B.blindCoefficients([R.b[4],R.b[3]]),B.C.blindCoefficients([R.b[6],R.b[5]]),B.A.degree()>=o.domainSize+2)throw new Error("A Polynomial is not well calculated");if(B.B.degree()>=o.domainSize+2)throw new Error("B Polynomial is not well calculated");if(B.C.degree()>=o.domainSize+2)throw new Error("C Polynomial is not well calculated")}async function d(){r&&r.debug("> Computing challenges beta and gamma"),D.reset(),D.addPolCommitment(o.Qm),D.addPolCommitment(o.Ql),D.addPolCommitment(o.Qr),D.addPolCommitment(o.Qo),D.addPolCommitment(o.Qc),D.addPolCommitment(o.S1),D.addPolCommitment(o.S2),D.addPolCommitment(o.S3);for(let W=0;W<o.nPublic;W++)D.addScalar(T.A.slice(W*y,W*y+y));D.addPolCommitment(P.getPolynomial("A")),D.addPolCommitment(P.getPolynomial("B")),D.addPolCommitment(P.getPolynomial("C")),R.beta=D.getChallenge(),r&&r.debug(" challenges.beta: "+g.toString(R.beta,16)),D.reset(),D.addScalar(R.beta),R.gamma=D.getChallenge(),r&&r.debug(" challenges.gamma: "+g.toString(R.gamma,16)),r&&r.debug("> Computing Z polynomial"),await p(),r&&r.debug("> Computing Z MSM");let z=await B.Z.multiExponentiation(q,"Z");P.addPolynomial("Z",z)}async function p(){r&&r.debug(" Computing Z evaluations");let z=new ee(_),W=new ee(_);z.set(g.one,0),W.set(g.one,0);let $=g.one;for(let I=0;I<o.domainSize;I++){const K=I*y,N=T.A.slice(K,K+y),X=T.B.slice(K,K+y),Q=T.C.slice(K,K+y),L=g.mul(R.beta,$);let V=g.add(N,L);V=g.add(V,R.gamma);let Z=g.add(X,g.mul(o.k1,L));Z=g.add(Z,R.gamma);let H=g.add(Q,g.mul(o.k2,L));H=g.add(H,R.gamma);let j=g.mul(V,g.mul(Z,H)),et=g.add(N,g.mul(M.Sigma1.getEvaluation(I*4),R.beta));et=g.add(et,R.gamma);let nt=g.add(X,g.mul(M.Sigma2.getEvaluation(I*4),R.beta));nt=g.add(nt,R.gamma);let st=g.add(Q,g.mul(M.Sigma3.getEvaluation(I*4),R.beta));st=g.add(st,R.gamma);let ft=g.mul(et,g.mul(nt,st));j=g.mul(z.slice(K,K+y),j),z.set(j,(I+1)%o.domainSize*y),ft=g.mul(W.slice(K,K+y),ft),W.set(ft,(I+1)%o.domainSize*y),$=g.mul($,g.w[o.power])}W=await g.batchInverse(W);for(let I=0;I<o.domainSize;I++){const K=I*y,N=g.mul(z.slice(K,K+y),W.slice(K,K+y));z.set(N,K)}if(T.Z=z,!g.eq(z.slice(0,y),g.one))throw new Error("Copy constraints does not match");if(r&&r.debug(" Computing Z ifft"),B.Z=await _e.fromEvaluations(T.Z,h,r),r&&r.debug(" Computing Z fft"),M.Z=await Ar.fromPolynomial(B.Z,4,h,r),B.Z.blindCoefficients([R.b[9],R.b[8],R.b[7]]),B.Z.degree()>=o.domainSize+3)throw new Error("Z Polynomial is not well calculated");delete T.Z}async function m(){r&&r.debug("> Computing challenge alpha"),D.reset(),D.addScalar(R.beta),D.addScalar(R.gamma),D.addPolCommitment(P.getPolynomial("Z")),R.alpha=D.getChallenge(),R.alpha2=g.square(R.alpha),r&&r.debug(" challenges.alpha: "+g.toString(R.alpha,16)),r&&r.debug("> Computing T polynomial"),await w(),r&&r.debug("> Computing T MSM");let z=await B.T1.multiExponentiation(q,"T1"),W=await B.T2.multiExponentiation(q,"T2"),$=await B.T3.multiExponentiation(q,"T3");P.addPolynomial("T1",z),P.addPolynomial("T2",W),P.addPolynomial("T3",$)}async function w(){r&&r.debug(` Reading sections ${gh}, ${mh}, ${vh}, ${yh}, ${bh}. Q selectors`),M.QL=new Ar(new ee(_*4),h,r),M.QR=new Ar(new ee(_*4),h,r),M.QM=new Ar(new ee(_*4),h,r),M.QO=new Ar(new ee(_*4),h,r),M.QC=new Ar(new ee(_*4),h,r),await u.readToBuffer(M.QL.eval,0,_*4,v[gh][0].p+_),await u.readToBuffer(M.QR.eval,0,_*4,v[mh][0].p+_),await u.readToBuffer(M.QM.eval,0,_*4,v[vh][0].p+_),await u.readToBuffer(M.QO.eval,0,_*4,v[yh][0].p+_),await u.readToBuffer(M.QC.eval,0,_*4,v[bh][0].p+_),M.Lagrange=new Ar(new ee(_*4*o.nPublic),h,r);for(let I=0;I<o.nPublic;I++)await u.readToBuffer(M.Lagrange.eval,I*_*4,_*4,v[T9][0].p+I*5*_+_);T.T=new ee(_*4),T.Tz=new ee(_*4),r&&r.debug(" Computing T evaluations");let z=g.one;for(let I=0;I<o.domainSize*4;I++){r&&I!==0&&I%1e5===0&&r.debug(`      T evaluation ${I}/${o.domainSize*4}`);const K=M.A.getEvaluation(I),N=M.B.getEvaluation(I),X=M.C.getEvaluation(I),Q=M.Z.getEvaluation(I),L=M.Z.getEvaluation((o.domainSize*4+4+I)%(o.domainSize*4)),V=M.QM.getEvaluation(I),Z=M.QL.getEvaluation(I),H=M.QR.getEvaluation(I),j=M.QO.getEvaluation(I),et=M.QC.getEvaluation(I),nt=M.Sigma1.getEvaluation(I),st=M.Sigma2.getEvaluation(I),ft=M.Sigma3.getEvaluation(I),vt=g.add(R.b[2],g.mul(R.b[1],z)),ot=g.add(R.b[4],g.mul(R.b[3],z)),pt=g.add(R.b[6],g.mul(R.b[5],z)),Ut=g.square(z),At=g.add(g.add(g.mul(R.b[7],Ut),g.mul(R.b[8],z)),R.b[9]),It=g.mul(z,g.w[o.power]),Jt=g.square(It),at=g.add(g.add(g.mul(R.b[7],Jt),g.mul(R.b[8],It)),R.b[9]);let J=g.zero;for(let Bt=0;Bt<o.nPublic;Bt++){const Ot=Bt*4*o.domainSize+I,ie=M.Lagrange.getEvaluation(Ot),kt=T.A.slice(Bt*y,(Bt+1)*y);J=g.sub(J,g.mul(ie,kt))}let[rt,lt]=ph.mul2(K,N,vt,ot,I%4,g);rt=g.mul(rt,V),lt=g.mul(lt,V),rt=g.add(rt,g.mul(K,Z)),lt=g.add(lt,g.mul(vt,Z)),rt=g.add(rt,g.mul(N,H)),lt=g.add(lt,g.mul(ot,H)),rt=g.add(rt,g.mul(X,j)),lt=g.add(lt,g.mul(pt,j)),rt=g.add(rt,J),rt=g.add(rt,et);const gt=g.mul(R.beta,z);let Dt=K;Dt=g.add(Dt,gt),Dt=g.add(Dt,R.gamma);let ut=N;ut=g.add(ut,g.mul(gt,o.k1)),ut=g.add(ut,R.gamma);let Y=X;Y=g.add(Y,g.mul(gt,o.k2)),Y=g.add(Y,R.gamma);let tt=Q,[dt,mt]=ph.mul4(Dt,ut,Y,tt,vt,ot,pt,At,I%4,g);dt=g.mul(dt,R.alpha),mt=g.mul(mt,R.alpha);let xt=K;xt=g.add(xt,g.mul(R.beta,nt)),xt=g.add(xt,R.gamma);let bt=N;bt=g.add(bt,g.mul(R.beta,st)),bt=g.add(bt,R.gamma);let _t=X;_t=g.add(_t,g.mul(R.beta,ft)),_t=g.add(_t,R.gamma);let Ht=L,[St,Mt]=ph.mul4(xt,bt,_t,Ht,vt,ot,pt,at,I%4,g);St=g.mul(St,R.alpha),Mt=g.mul(Mt,R.alpha);let jt=g.sub(Q,g.one);jt=g.mul(jt,M.Lagrange.getEvaluation(I)),jt=g.mul(jt,R.alpha2);let Lt=g.mul(At,M.Lagrange.getEvaluation(I));Lt=g.mul(Lt,R.alpha2);let Ft=g.add(g.sub(g.add(rt,dt),St),jt),te=g.add(g.sub(g.add(lt,mt),Mt),Lt);T.T.set(Ft,I*y),T.Tz.set(te,I*y),z=g.mul(z,g.w[o.power+2])}if(r&&r.debug(" Computing T ifft"),B.T=await _e.fromEvaluations(T.T,h,r),r&&r.debug(" Computing T / ZH"),B.T.divZh(o.domainSize,4),r&&r.debug(" Computing Tz ifft"),B.Tz=await _e.fromEvaluations(T.Tz,h,r),B.T.add(B.Tz),B.T.degree()>=o.domainSize*3+6)throw new Error("T Polynomial is not well calculated");r&&r.debug(" Computing T1, T2, T3 polynomials"),B.T1=new _e(new ee((o.domainSize+1)*y),h,r),B.T2=new _e(new ee((o.domainSize+1)*y),h,r),B.T3=new _e(new ee((o.domainSize+6)*y),h,r),B.T1.coef.set(B.T.coef.slice(0,_),0),B.T2.coef.set(B.T.coef.slice(_,_*2),0),B.T3.coef.set(B.T.coef.slice(_*2,_*3+6*y),0),B.T1.setCoef(o.domainSize,R.b[10]);const W=g.sub(B.T2.getCoef(0),R.b[10]);B.T2.setCoef(0,W),B.T2.setCoef(o.domainSize,R.b[11]);const $=g.sub(B.T3.getCoef(0),R.b[11]);B.T3.setCoef(0,$)}async function x(){r&&r.debug("> Computing challenge xi"),D.reset(),D.addScalar(R.alpha),D.addPolCommitment(P.getPolynomial("T1")),D.addPolCommitment(P.getPolynomial("T2")),D.addPolCommitment(P.getPolynomial("T3")),R.xi=D.getChallenge(),R.xiw=g.mul(R.xi,g.w[o.power]),r&&r.debug(" challenges.xi: "+g.toString(R.xi,16)),P.addEvaluation("eval_a",B.A.evaluate(R.xi)),P.addEvaluation("eval_b",B.B.evaluate(R.xi)),P.addEvaluation("eval_c",B.C.evaluate(R.xi)),P.addEvaluation("eval_s1",B.Sigma1.evaluate(R.xi)),P.addEvaluation("eval_s2",B.Sigma2.evaluate(R.xi)),P.addEvaluation("eval_zw",B.Z.evaluate(R.xiw))}async function b(){r&&r.debug("> Computing challenge v"),D.reset(),D.addScalar(R.xi),D.addScalar(P.getEvaluation("eval_a")),D.addScalar(P.getEvaluation("eval_b")),D.addScalar(P.getEvaluation("eval_c")),D.addScalar(P.getEvaluation("eval_s1")),D.addScalar(P.getEvaluation("eval_s2")),D.addScalar(P.getEvaluation("eval_zw")),R.v=[],R.v[1]=D.getChallenge(),r&&r.debug(" challenges.v: "+g.toString(R.v[1],16));for(let $=2;$<6;$++)R.v[$]=g.mul(R.v[$-1],R.v[1]);r&&r.debug("> Computing linearisation polynomial R(X)"),await f(),r&&r.debug("> Computing opening proof polynomial Wxi(X) polynomial"),C(),r&&r.debug("> Computing opening proof polynomial Wxiw(X) polynomial"),F(),r&&r.debug("> Computing Wxi, Wxiw MSM");let z=await B.Wxi.multiExponentiation(q,"Wxi"),W=await B.Wxiw.multiExponentiation(q,"Wxiw");P.addPolynomial("Wxi",z),P.addPolynomial("Wxiw",W)}async function f(){const z=h.Fr;B.QL=new _e(new ee(_),h,r),B.QR=new _e(new ee(_),h,r),B.QM=new _e(new ee(_),h,r),B.QO=new _e(new ee(_),h,r),B.QC=new _e(new ee(_),h,r),await u.readToBuffer(B.QL.coef,0,_,v[gh][0].p),await u.readToBuffer(B.QR.coef,0,_,v[mh][0].p),await u.readToBuffer(B.QM.coef,0,_,v[vh][0].p),await u.readToBuffer(B.QO.coef,0,_,v[yh][0].p),await u.readToBuffer(B.QC.coef,0,_,v[bh][0].p),R.xin=R.xi;for(let ot=0;ot<o.power;ot++)R.xin=z.square(R.xin);R.zh=z.sub(R.xin,z.one);const W=[],$=z.e(o.domainSize);let I=z.one;for(let ot=1;ot<=Math.max(1,o.nPublic);ot++)W[ot]=z.div(z.mul(I,R.zh),z.mul($,z.sub(R.xi,I))),I=z.mul(I,z.w[o.power]);const K=z.div(z.sub(R.xin,z.one),z.mul($,z.sub(R.xi,z.one)));if(r){r.debug("Lagrange Evaluations: ");for(let ot=1;ot<W.length;ot++)r.debug(`L${ot}(xi)=`+z.toString(W[ot],16))}let N=z.zero;for(let ot=0;ot<k.length;ot++){const pt=z.e(k[ot]);N=z.sub(N,z.mul(pt,W[ot+1]))}r&&r.debug("PI: "+z.toString(N,16));const X=z.mul(P.evaluations.eval_a,P.evaluations.eval_b);let Q=P.evaluations.eval_a;const L=z.mul(R.beta,R.xi);Q=z.add(Q,L),Q=z.add(Q,R.gamma);let V=P.evaluations.eval_b;V=z.add(V,z.mul(L,o.k1)),V=z.add(V,R.gamma);let Z=P.evaluations.eval_c;Z=z.add(Z,z.mul(L,o.k2)),Z=z.add(Z,R.gamma);const H=z.mul(z.mul(z.mul(Q,V),Z),R.alpha);let j=P.evaluations.eval_a;j=z.add(j,z.mul(R.beta,P.evaluations.eval_s1)),j=z.add(j,R.gamma);let et=P.evaluations.eval_b;et=z.add(et,z.mul(R.beta,P.evaluations.eval_s2)),et=z.add(et,R.gamma);let nt=z.mul(j,et);nt=z.mul(nt,P.evaluations.eval_zw),nt=z.mul(nt,R.alpha);const st=z.mul(K,R.alpha2);B.R=new _e(new ee((o.domainSize+6)*y),h,r),B.R.add(B.QM,X),B.R.add(B.QL,P.evaluations.eval_a),B.R.add(B.QR,P.evaluations.eval_b),B.R.add(B.QO,P.evaluations.eval_c),B.R.add(B.QC),B.R.add(B.Z,H),B.R.sub(B.Sigma3,z.mul(nt,R.beta)),B.R.add(B.Z,st);let ft=_e.fromPolynomial(B.T3,h,r);ft.mulScalar(z.square(R.xin)),ft.add(B.T2,R.xin),ft.add(B.T1),ft.mulScalar(R.zh),B.R.sub(ft);let vt=z.sub(N,z.mul(nt,z.add(P.evaluations.eval_c,R.gamma)));vt=z.sub(vt,st),r&&r.debug("r0: "+z.toString(vt,16)),B.R.addScalar(vt)}function C(){B.Wxi=new _e(new ee(_+6*y),h,r),B.Wxi.add(B.R),B.Wxi.add(B.A,R.v[1]),B.Wxi.add(B.B,R.v[2]),B.Wxi.add(B.C,R.v[3]),B.Wxi.add(B.Sigma1,R.v[4]),B.Wxi.add(B.Sigma2,R.v[5]),B.Wxi.subScalar(g.mul(R.v[1],P.evaluations.eval_a)),B.Wxi.subScalar(g.mul(R.v[2],P.evaluations.eval_b)),B.Wxi.subScalar(g.mul(R.v[3],P.evaluations.eval_c)),B.Wxi.subScalar(g.mul(R.v[4],P.evaluations.eval_s1)),B.Wxi.subScalar(g.mul(R.v[5],P.evaluations.eval_s2)),B.Wxi.divByZerofier(1,R.xi)}async function F(){B.Wxiw=_e.fromPolynomial(B.Z,h,r),B.Wxiw.subScalar(P.evaluations.eval_zw),B.Wxiw.divByZerofier(1,R.xiw)}}const{unstringifyBigInts:R9}=ri;async function N9(i,e,r,t,a,n){const c=R9(i),u={type:"mem"};return await Zl(c,e,u,a),await w6(r,u,t,n)}const{unstringifyBigInts:_h}=ri;async function k9(i,e,r,t){let a=_h(i);r=_h(r);let n=_h(e);const c=await Za(a.curve),u=c.Fr,v=c.G1;t&&t.info("PLONK VERIFIER STARTED");let o=P9(c,r);if(a=U9(c,a),!D9(c,o))return t.error("Proof is not well constructed"),!1;if(n.length!=a.nPublic)return t.error("Invalid number of public inputs"),!1;const h=O9(c,o,n,a);if(t){t.debug("beta: "+u.toString(h.beta,16)),t.debug("gamma: "+u.toString(h.gamma,16)),t.debug("alpha: "+u.toString(h.alpha,16)),t.debug("xi: "+u.toString(h.xi,16));for(let M=1;M<6;M++)t&&t.debug("v: "+u.toString(h.v[M],16));t.debug("u: "+u.toString(h.u,16))}const g=F9(c,h,a);if(t)for(let M=1;M<g.length;M++)t.debug(`L${M}(xi)=`+u.toString(g[M],16));if(n.length!=a.nPublic)return t.error("Number of public signals does not match with vk"),!1;const y=q9(c,n,g);t&&t.debug("PI(xi): "+u.toString(y,16));const _=z9(c,o,h,y,g[1]);t&&t.debug("r0: "+u.toString(_,16));const A=V9(c,o,h,a,g[1]);t&&t.debug("D: "+v.toString(v.toAffine(A),16));const S=G9(c,o,h,a,A);t&&t.debug("F: "+v.toString(v.toAffine(S),16));const T=K9(c,o,h,_);t&&t.debug("E: "+v.toString(v.toAffine(T),16));const B=await H9(c,o,h,a,T,S);return t&&(B?t.info("OK!"):t.warn("Invalid Proof")),B}function P9(i,e){const r=i.G1,t=i.Fr,a={};return a.A=r.fromObject(e.A),a.B=r.fromObject(e.B),a.C=r.fromObject(e.C),a.Z=r.fromObject(e.Z),a.T1=r.fromObject(e.T1),a.T2=r.fromObject(e.T2),a.T3=r.fromObject(e.T3),a.eval_a=t.fromObject(e.eval_a),a.eval_b=t.fromObject(e.eval_b),a.eval_c=t.fromObject(e.eval_c),a.eval_zw=t.fromObject(e.eval_zw),a.eval_s1=t.fromObject(e.eval_s1),a.eval_s2=t.fromObject(e.eval_s2),a.Wxi=r.fromObject(e.Wxi),a.Wxiw=r.fromObject(e.Wxiw),a}function U9(i,e){const r=i.G1,t=i.G2,a=i.Fr,n=e;return n.Qm=r.fromObject(e.Qm),n.Ql=r.fromObject(e.Ql),n.Qr=r.fromObject(e.Qr),n.Qo=r.fromObject(e.Qo),n.Qc=r.fromObject(e.Qc),n.S1=r.fromObject(e.S1),n.S2=r.fromObject(e.S2),n.S3=r.fromObject(e.S3),n.k1=a.fromObject(e.k1),n.k2=a.fromObject(e.k2),n.X_2=t.fromObject(e.X_2),n}function D9(i,e){const r=i.G1;return!(!r.isValid(e.A)||!r.isValid(e.B)||!r.isValid(e.C)||!r.isValid(e.Z)||!r.isValid(e.T1)||!r.isValid(e.T2)||!r.isValid(e.T3)||!r.isValid(e.Wxi)||!r.isValid(e.Wxiw))}function O9(i,e,r,t){const a=i.Fr,n={},c=new Ua(i);c.addPolCommitment(t.Qm),c.addPolCommitment(t.Ql),c.addPolCommitment(t.Qr),c.addPolCommitment(t.Qo),c.addPolCommitment(t.Qc),c.addPolCommitment(t.S1),c.addPolCommitment(t.S2),c.addPolCommitment(t.S3);for(let u=0;u<r.length;u++)c.addScalar(a.e(r[u]));c.addPolCommitment(e.A),c.addPolCommitment(e.B),c.addPolCommitment(e.C),n.beta=c.getChallenge(),c.reset(),c.addScalar(n.beta),n.gamma=c.getChallenge(),c.reset(),c.addScalar(n.beta),c.addScalar(n.gamma),c.addPolCommitment(e.Z),n.alpha=c.getChallenge(),c.reset(),c.addScalar(n.alpha),c.addPolCommitment(e.T1),c.addPolCommitment(e.T2),c.addPolCommitment(e.T3),n.xi=c.getChallenge(),c.reset(),c.addScalar(n.xi),c.addScalar(e.eval_a),c.addScalar(e.eval_b),c.addScalar(e.eval_c),c.addScalar(e.eval_s1),c.addScalar(e.eval_s2),c.addScalar(e.eval_zw),n.v=[],n.v[1]=c.getChallenge();for(let u=2;u<6;u++)n.v[u]=a.mul(n.v[u-1],n.v[1]);return c.reset(),c.addPolCommitment(e.Wxi),c.addPolCommitment(e.Wxiw),n.u=c.getChallenge(),n}function F9(i,e,r){const t=i.Fr;let a=e.xi,n=1;for(let o=0;o<r.power;o++)a=t.square(a),n*=2;e.xin=a,e.zh=t.sub(a,t.one);const c=[],u=t.e(n);let v=t.one;for(let o=1;o<=Math.max(1,r.nPublic);o++)c[o]=t.div(t.mul(v,e.zh),t.mul(u,t.sub(e.xi,v))),v=t.mul(v,t.w[r.power]);return c}function q9(i,e,r){const t=i.Fr;let a=t.zero;for(let n=0;n<e.length;n++){const c=t.e(e[n]);a=t.sub(a,t.mul(c,r[n+1]))}return a}function z9(i,e,r,t,a){const n=i.Fr,c=t,u=n.mul(a,n.square(r.alpha));let v=n.add(e.eval_a,n.mul(r.beta,e.eval_s1));v=n.add(v,r.gamma);let o=n.add(e.eval_b,n.mul(r.beta,e.eval_s2));o=n.add(o,r.gamma);let h=n.add(e.eval_c,r.gamma),g=n.mul(n.mul(v,o),h);return g=n.mul(g,e.eval_zw),g=n.mul(g,r.alpha),n.sub(n.sub(c,u),g)}function V9(i,e,r,t,a){const n=i.G1,c=i.Fr;let u=n.timesFr(t.Qm,c.mul(e.eval_a,e.eval_b));u=n.add(u,n.timesFr(t.Ql,e.eval_a)),u=n.add(u,n.timesFr(t.Qr,e.eval_b)),u=n.add(u,n.timesFr(t.Qo,e.eval_c)),u=n.add(u,t.Qc);const v=c.mul(r.beta,r.xi),o=c.add(c.add(e.eval_a,v),r.gamma),h=c.add(c.add(e.eval_b,c.mul(v,t.k1)),r.gamma),g=c.add(c.add(e.eval_c,c.mul(v,t.k2)),r.gamma),y=c.mul(c.mul(c.mul(o,h),g),r.alpha),_=c.mul(a,c.square(r.alpha)),A=n.timesFr(e.Z,c.add(c.add(y,_),r.u)),S=c.add(c.add(e.eval_a,c.mul(r.beta,e.eval_s1)),r.gamma),T=c.add(c.add(e.eval_b,c.mul(r.beta,e.eval_s2)),r.gamma),B=c.mul(c.mul(r.alpha,r.beta),e.eval_zw),M=n.timesFr(t.S3,c.mul(c.mul(S,T),B)),R=e.T1,P=n.timesFr(e.T2,r.xin),D=n.timesFr(e.T3,c.square(r.xin));let q=n.add(R,n.add(P,D));return q=n.timesFr(q,r.zh),n.sub(n.sub(n.add(u,A),M),q)}function G9(i,e,r,t,a){const n=i.G1;let c=n.add(a,n.timesFr(e.A,r.v[1]));return c=n.add(c,n.timesFr(e.B,r.v[2])),c=n.add(c,n.timesFr(e.C,r.v[3])),c=n.add(c,n.timesFr(t.S1,r.v[4])),c=n.add(c,n.timesFr(t.S2,r.v[5])),c}function K9(i,e,r,t){const a=i.G1,n=i.Fr;let c=n.add(n.neg(t),n.mul(r.v[1],e.eval_a));return c=n.add(c,n.mul(r.v[2],e.eval_b)),c=n.add(c,n.mul(r.v[3],e.eval_c)),c=n.add(c,n.mul(r.v[4],e.eval_s1)),c=n.add(c,n.mul(r.v[5],e.eval_s2)),c=n.add(c,n.mul(r.u,e.eval_zw)),a.timesFr(a.one,c)}async function H9(i,e,r,t,a,n){const c=i.G1,u=i.Fr;let v=e.Wxi;v=c.add(v,c.timesFr(e.Wxiw,r.u));let o=c.timesFr(e.Wxi,r.xi);const h=u.mul(u.mul(r.u,r.xi),u.w[t.power]);return o=c.add(o,c.timesFr(e.Wxiw,h)),o=c.add(o,n),o=c.sub(o,a),await i.pairingEq(c.neg(v),t.X_2,o,i.G2.one)}const{unstringifyBigInts:Lm}=ri;function Tr(i){let e=i.toString(16);for(;e.length<64;)e="0"+e;return e=`"0x${e}"`,e}async function Q9(i,e){const r=Lm(i),t=Lm(e);await Za(r.curve);let a="";for(let n=0;n<t.length;n++)a!=""&&(a=a+","),a=a+Tr(t[n]);return`[${Tr(r.A[0])}, ${Tr(r.A[1])},${Tr(r.B[0])},${Tr(r.B[1])},${Tr(r.C[0])},${Tr(r.C[1])},${Tr(r.Z[0])},${Tr(r.Z[1])},${Tr(r.T1[0])},${Tr(r.T1[1])},${Tr(r.T2[0])},${Tr(r.T2[1])},${Tr(r.T3[0])},${Tr(r.T3[1])},${Tr(r.Wxi[0])},${Tr(r.Wxi[1])},${Tr(r.Wxiw[0])},${Tr(r.Wxiw[1])},${Tr(r.eval_a)},${Tr(r.eval_b)},${Tr(r.eval_c)},${Tr(r.eval_s1)},${Tr(r.eval_s2)},${Tr(r.eval_zw)}][${a}]`}var $9=Object.freeze({__proto__:null,setup:A9,fullProve:N9,prove:w6,verify:k9,exportSolidityCallData:Q9});function Tm(i,e){return[i,0,0,e.one,e.zero,e.zero,e.zero,e.zero]}function Z9(i,e,r,t,a,n,c,u){return[i,e,r,t,a,n,c,u]}function j9(i,e,r,t,a,n,c,u,v){return[i,e,r,t,a,n,c,u]}const wh=0,Ch=1,W9=2;class Y9{constructor(e,r,t,a,n){this.Fr=e,this.logger=n,this.fnGetAdditionConstraint=t,this.fnGetMultiplicationConstraint=a}processR1csConstraint(e,r,t,a){this.normalizeLinearCombination(r),this.normalizeLinearCombination(t),this.normalizeLinearCombination(a);const n=this.getLinearCombinationType(r),c=this.getLinearCombinationType(t);if(n===wh||c===wh)return this.processR1csAdditionConstraint(e,a);if(n===Ch){const u=this.joinLinearCombinations(t,a,r[0]);return this.processR1csAdditionConstraint(e,u)}else if(c===Ch){const u=this.joinLinearCombinations(r,a,t[0]);return this.processR1csAdditionConstraint(e,u)}else return this.processR1csMultiplicationConstraint(e,r,t,a)}getLinearCombinationType(e){let r=this.Fr.zero,t=0;const a=Object.keys(e);for(let n=0;n<a.length;n++)e[a[n]]==0n?delete e[a[n]]:a[n]==0?r=this.Fr.add(r,e[a[n]]):t++;return t>0?W9:this.Fr.isZero(r)?wh:Ch}normalizeLinearCombination(e){const r=Object.keys(e);for(let t=0;t<r.length;t++)this.Fr.isZero(e[r[t]])&&delete e[r[t]];return e}joinLinearCombinations(e,r,t){const a={};for(let n in e)typeof a[n]>"u"?a[n]=this.Fr.mul(t,e[n]):a[n]=this.Fr.add(a[n],this.Fr.mul(t,e[n]));for(let n in r)typeof a[n]>"u"?a[n]=r[n]:a[n]=this.Fr.add(a[n],r[n]);return this.normalizeLinearCombination(a)}reduceCoefs(e,r,t,a,n){const c={k:this.Fr.zero,signals:[],coefs:[]},u=[];for(let v in a)v==0?c.k=this.Fr.add(c.k,a[v]):a[v]!=0n&&u.push([Number(v),a[v]]);for(;u.length>n;){const v=u.shift(),o=u.shift(),h=e.nVars++,g=this.fnGetAdditionConstraint(v[0],o[0],h,this.Fr.neg(v[1]),this.Fr.neg(o[1]),this.Fr.zero,this.Fr.one,this.Fr.zero);r.push(g),t.push([v[0],o[0],v[1],o[1]]),u.push([h,this.Fr.one])}for(let v=0;v<u.length;v++)c.signals[v]=u[v][0],c.coefs[v]=u[v][1];for(;c.coefs.length<n;)c.signals.push(0),c.coefs.push(this.Fr.zero);return c}processR1csAdditionConstraint(e,r){const t=[],a=[],n=this.reduceCoefs(e,t,a,r,3),c=this.fnGetAdditionConstraint(n.signals[0],n.signals[1],n.signals[2],n.coefs[0],n.coefs[1],this.Fr.zero,n.coefs[2],n.k);return t.push(c),[t,a]}processR1csMultiplicationConstraint(e,r,t,a){const n=[],c=[],u=this.reduceCoefs(e,n,c,r,1),v=this.reduceCoefs(e,n,c,t,1),o=this.reduceCoefs(e,n,c,a,1),h=this.fnGetMultiplicationConstraint(u.signals[0],v.signals[0],o.signals[0],this.Fr.mul(u.coefs[0],v.k),this.Fr.mul(u.k,v.coefs[0]),this.Fr.mul(u.coefs[0],v.coefs[0]),this.Fr.neg(o.coefs[0]),this.Fr.sub(this.Fr.mul(u.k,v.k),o.k));return n.push(h),[n,c]}}class md{constructor(e,r,t){this.n=e,this.polynomials=Array(e).fill(void 0),this.curve=r,this.Fr=r.Fr,this.G1=r.G1,this.logger=t}addPolynomial(e,r){if(e>this.n-1)throw new Error("CPolynomial:addPolynomial, cannot add a polynomial to a position greater than n-1");this.polynomials[e]=r}degree(){let e=this.polynomials.map((r,t)=>r===void 0?0:r.degree()*this.n+t);return Math.max(...e)}getPolynomial(){let e=this.polynomials.map(c=>c===void 0?0:c.degree());const r=this.degree(),t=2**(Ea(r-1)+1),a=this.Fr.n8;let n=new _e(new ee(t*a),this.curve,this.logger);for(let c=0;c<r;c++){const u=c*a,v=u*this.n;for(let o=0;o<this.n;o++)this.polynomials[o]!==void 0&&c<=e[o]&&n.coef.set(this.polynomials[o].coef.slice(u,u+a),v+o*a)}return n}async multiExponentiation(e,r){let t=this.getPolynomial();const a=t.coef.byteLength/this.Fr.n8,n=e.slice(0,a*this.G1.F.n8*2),c=await this.Fr.batchFromMontgomery(t.coef);let u=await this.G1.multiExpAffine(n,c,this.logger,r);return u=this.G1.toAffine(u),u}}async function X9(i,e,r,t){t&&t.info("FFLONK SETUP STARTED"),globalThis.gc&&globalThis.gc(),t&&t.info("> Reading PTau file");const{fd:a,sections:n}=await gr(e,"ptau",1);if(!n[12])throw new Error("Powers of Tau is not well prepared. Section 12 missing.");t&&t.info("> Getting curve from PTau settings");const{curve:c}=await Wi(a,n);t&&t.info("> Reading r1cs file");const{fd:u,sections:v}=await gr(i,"r1cs",1),o=await jl(u,v,{loadConstraints:!1,loadCustomGates:!0});if(o.prime!==c.r)throw new Error("r1cs curve does not match powers of tau ceremony curve");const h=c.Fr,g=c.Fr.n8,y=c.G1.F.n8*2,_=c.G2.F.n8*2;let A={},S={},T,B={nVars:o.nVars,nPublic:o.nOutputs+o.nPubInputs};const M=new Li;let R=new Li;if(t&&t.info("> Processing FFlonk constraints"),await G(c.Fr,o,t),globalThis.gc&&globalThis.gc(),B.cirPower=Math.max(iA,Ea(M.length+2-1)+1),B.domainSize=2**B.cirPower,n[2][0].size<(B.domainSize*9+18)*y)throw new Error("Powers of Tau is not big enough for this circuit size. Section 2 too small.");if(n[3][0].size<_)throw new Error("Powers of Tau is not well prepared. Section 3 too small.");t&&(t.info("----------------------------"),t.info("  FFLONK SETUP SETTINGS"),t.info(`  Curve:         ${c.name}`),t.info(`  Circuit power: ${B.cirPower}`),t.info(`  Domain size:   ${B.domainSize}`),t.info(`  Vars:          ${B.nVars}`),t.info(`  Public vars:   ${B.nPublic}`),t.info(`  Constraints:   ${M.length}`),t.info(`  Additions:     ${R.length}`),t.info("----------------------------")),t&&t.info("> computing k1 and k2");const[P,D]=F();t&&t.info("> computing w3");const q=z();t&&t.info("> computing w4");const k=W();t&&t.info("> computing w8");const U=$();t&&t.info("> computing wr");const O=I(B.cirPower,c.Fr);return await E(),await u.close(),await a.close(),t&&t.info("FFLONK SETUP FINISHED"),0;async function G(K,N,X){for(let j=0;j<B.nPublic;j++)M.push(Tm(j+1,K));const Q=new Y9(K,Tm,Z9,j9,X),L=await fr(u,v,2);let V=0;for(let j=0;j<N.nConstraints;j++){X&&j!==0&&j%5e5===0&&X.info(`    processing r1cs constraints ${j}/${N.nConstraints}`);const[et,nt]=Q.processR1csConstraint(B,...Z());M.push(...et),R.push(...nt)}function Z(){const j=[];return j[0]=H(),j[1]=H(),j[2]=H(),j}function H(){const j={},et=L.slice(V,V+4);V+=4;const st=new DataView(et.buffer).getUint32(0,!0),ft=L.slice(V,V+(4+N.n8)*st);V+=(4+N.n8)*st;const vt=new DataView(ft.buffer);for(let ot=0;ot<st;ot++){const pt=vt.getUint32(ot*(4+N.n8),!0),Ut=N.F.fromRprLE(ft,ot*(4+N.n8)+4);j[pt]=Ut}return j}return 0}async function E(){t&&t.info("> Writing the zkey file");const K=await bi(r,"zkey",1,nA,1<<22,1<<24);t&&t.info(` Writing Section ${Em}. Zkey Header`),await s(K),t&&t.info(` Writing Section ${ol}. Additions`),await l(K),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${cd}. A Map`),await d(K,cd,0,"A map"),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${ud}. B Map`),await d(K,ud,1,"B map"),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${hd}. C Map`),await d(K,hd,2,"C map"),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${ho}. QL`),await p(K,ho,3,"QL"),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${po}. QR`),await p(K,po,4,"QR"),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${vo}. QM`),await p(K,vo,5,"QM"),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${go}. QO`),await p(K,go,6,"QO"),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${mo}. QC`),await p(K,mo,7,"QC"),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Sections ${yo},${bo},${_o}. Sigma1, Sigma2 & Sigma 3`),await m(K),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${dd}. Lagrange Polynomials`),await w(K),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${fl}. Powers of Tau`),await x(K),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${pd}. C0`),await b(K),globalThis.gc&&globalThis.gc(),t&&t.info(` Writing Section ${ld}. FFlonk Header`),await f(K),globalThis.gc&&globalThis.gc(),t&&t.info("> Writing the zkey file finished"),await K.close()}async function s(K){await Oe(K,Em),await K.writeULE32(Wo),await Fe(K)}async function l(K){await Oe(K,ol);const N=new Uint8Array(8+2*g),X=new DataView(N.buffer);for(let Q=0;Q<R.length;Q++){t&&Q!==0&&Q%5e5===0&&t.info(`      writing Additions: ${Q}/${R.length}`);const L=R[Q];X.setUint32(0,L[0],!0),X.setUint32(4,L[1],!0),N.set(L[2],8),N.set(L[3],8+g),await K.write(N)}await Fe(K)}async function d(K,N,X,Q){await Oe(K,N);for(let L=0;L<M.length;L++)t&&L!==0&&L%5e5===0&&t.info(`      writing witness ${Q}: ${L}/${M.length}`),await K.writeULE32(M[L][X]);await Fe(K)}async function p(K,N,X,Q){let L=new ee(B.domainSize*g);for(let V=0;V<M.length;V++)L.set(M[V][X],V*g),t&&V!==0&&V%5e5===0&&t.info(`      writing ${Q}: ${V}/${M.length}`);A[Q]=await _e.fromEvaluations(L,c,t),S[Q]=await Ar.fromPolynomial(A[Q],4,c,t),await Oe(K,N),await K.write(A[Q].coef),await K.write(S[Q].eval),await Fe(K)}async function m(K){const N=new ee(g*B.domainSize*3),X=new Li(B.nVars),Q=new Li(B.nVars);let L=h.one;for(let Z=0;Z<B.domainSize;Z++)Z<M.length?(V(M[Z][0],Z),V(M[Z][1],B.domainSize+Z),V(M[Z][2],B.domainSize*2+Z)):Z<B.domainSize-2?(V(0,Z),V(0,B.domainSize+Z),V(0,B.domainSize*2+Z)):(N.set(L,Z*g),N.set(h.mul(L,P),(B.domainSize+Z)*g),N.set(h.mul(L,D),(B.domainSize*2+Z)*g)),L=h.mul(L,h.w[B.cirPower]),t&&Z!==0&&Z%5e5===0&&t.info(`      writing sigma phase1: ${Z}/${M.length}`);for(let Z=0;Z<B.nVars;Z++)typeof Q[Z]<"u"?N.set(X[Z],Q[Z]*g):console.log("Variable not used"),t&&Z!==0&&Z%5e5===0&&t.info(`      writing sigma phase2: ${Z}/${B.nVars}`);globalThis.gc&&globalThis.gc();for(let Z=0;Z<3;Z++){const H=Z===0?yo:Z===1?bo:_o;let j="S"+(Z+1);A[j]=await _e.fromEvaluations(N.slice(B.domainSize*g*Z,B.domainSize*g*(Z+1)),c,t),S[j]=await Ar.fromPolynomial(A[j],4,c,t),await Oe(K,H),await K.write(A[j].coef),await K.write(S[j].eval),await Fe(K),globalThis.gc&&globalThis.gc()}return 0;function V(Z,H){typeof X[Z]>"u"?Q[Z]=H:N.set(X[Z],H*g);let j;H<B.domainSize?j=L:H<2*B.domainSize?j=h.mul(L,P):j=h.mul(L,D),X[Z]=j}}async function w(K){await Oe(K,dd);const N=Math.max(B.nPublic,1);for(let X=0;X<N;X++){let Q=new ee(B.domainSize*g);Q.set(h.one,X*g),await C(K,Q)}await Fe(K)}async function x(K){await Oe(K,fl),T=new ee((B.domainSize*9+18)*y),await a.readToBuffer(T,0,(B.domainSize*9+18)*y,n[2][0].p),await K.write(T),await Fe(K)}async function b(K){let N=new md(8,c,t);if(N.addPolynomial(0,A.QL),N.addPolynomial(1,A.QR),N.addPolynomial(2,A.QO),N.addPolynomial(3,A.QM),N.addPolynomial(4,A.QC),N.addPolynomial(5,A.S1),N.addPolynomial(6,A.S2),N.addPolynomial(7,A.S3),A.C0=N.getPolynomial(),A.C0.degree()>=8*B.domainSize)throw new Error("C0 Polynomial is not well calculated");await Oe(K,pd),await K.write(A.C0.coef),await Fe(K)}async function f(K){await Oe(K,ld);const N=c.q,X=(Math.floor((Ae.bitLength(N)-1)/64)+1)*8;await K.writeULE32(X),await nn(K,N,X);const Q=c.r,L=(Math.floor((Ae.bitLength(Q)-1)/64)+1)*8;await K.writeULE32(L),await nn(K,Q,L),await K.writeULE32(B.nVars),await K.writeULE32(B.nPublic),await K.writeULE32(B.domainSize),await K.writeULE32(R.length),await K.writeULE32(M.length),await K.write(P),await K.write(D),await K.write(q),await K.write(k),await K.write(U),await K.write(O);let V;V=await a.read(_,n[3][0].p+_),await K.write(V);let Z=await A.C0.multiExponentiation(T,"C0");await K.write(Z),await Fe(K)}async function C(K,N){const[X,Q]=await _e.to4T(N,B.domainSize,[],h);return await K.write(X),await K.write(Q),[X,Q]}function F(){let K=h.two;for(;X(K,[],B.cirPower);)h.add(K,h.one);let N=h.add(K,h.one);for(;X(N,[K],B.cirPower);)h.add(N,h.one);return[K,N];function X(Q,L,V){const Z=2**V;let H=h.one;for(let j=0;j<Z;j++){if(h.eq(Q,H))return!0;for(let et=0;et<L.length;et++)if(h.eq(Q,h.mul(L[et],H)))return!0;H=h.mul(H,h.w[V])}return!1}}function z(){let K=h.e(31624),X=Ae.div(3648040478639879203707734290876212514758060733402672390616367364429301415936n,Ae.e(3));return h.exp(K,X)}function W(){return h.w[2]}function $(){return h.w[3]}function I(K,N){const X=N.e(467799165886069610036046866799264026481344299079011762026774533774345988080n);return N.exp(X,2**(28-K))}}const{stringifyBigInts:Rm}=ri;async function C6(i,e,r,t){r&&r.info("FFLONK PROVER STARTED"),r&&r.info("> Reading witness file");const{fd:a,sections:n}=await gr(e,"wtns",2),c=await Yo(a,n);r&&r.info("> Reading zkey file");const{fd:u,sections:v}=await gr(i,"zkey",2),o=await an(u,v,void 0,t);if(o.protocolId!==Wo)throw new Error("zkey file is not fflonk");if(!Ae.eq(o.r,c.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(c.nWitness!==o.nVars-o.nAdditions)throw new Error(`Invalid witness length. Circuit: ${o.nVars}, witness: ${c.nWitness}, ${o.nAdditions}`);const h=o.curve,g=h.Fr,y=h.Fr.n8,_=h.G1.F.n8*2,A=o.domainSize*y;r&&(r.info("----------------------------"),r.info("  FFLONK PROVE SETTINGS"),r.info(`  Curve:         ${h.name}`),r.info(`  Circuit power: ${o.power}`),r.info(`  Domain size:   ${o.domainSize}`),r.info(`  Vars:          ${o.nVars}`),r.info(`  Public vars:   ${o.nPublic}`),r.info(`  Constraints:   ${o.nConstraints}`),r.info(`  Additions:     ${o.nAdditions}`),r.info("----------------------------")),r&&r.info("> Reading witness file data");const S=await fr(a,n,2);await a.close(),S.set(g.zero,0);const T=new ee(o.nAdditions*y);let B={},M={},R={},P={},D={},q={},k=new P1(h,r);r&&r.info(`> Reading Section ${ol}. Additions`),await E(),r&&r.info(`> Reading Sections ${yo},${bo},${_o}. Sigma1, Sigma2 & Sigma 3`),r&&r.info(" Reading Sigma polynomials "),M.Sigma1=new _e(new ee(A),h,r),M.Sigma2=new _e(new ee(A),h,r),M.Sigma3=new _e(new ee(A),h,r),await u.readToBuffer(M.Sigma1.coef,0,A,v[yo][0].p),await u.readToBuffer(M.Sigma2.coef,0,A,v[bo][0].p),await u.readToBuffer(M.Sigma3.coef,0,A,v[_o][0].p),r&&r.info(" Reading Sigma evaluations"),R.Sigma1=new Ar(new ee(A*4),h,r),R.Sigma2=new Ar(new ee(A*4),h,r),R.Sigma3=new Ar(new ee(A*4),h,r),await u.readToBuffer(R.Sigma1.eval,0,A*4,v[yo][0].p+A),await u.readToBuffer(R.Sigma2.eval,0,A*4,v[bo][0].p+A),await u.readToBuffer(R.Sigma3.eval,0,A*4,v[_o][0].p+A),r&&r.info(`> Reading Section ${fl}. Powers of Tau`);const U=new ee(o.domainSize*16*_);await u.readToBuffer(U,0,(o.domainSize*9+18)*_,v[fl][0].p),globalThis.gc&&globalThis.gc(),r&&r.info(""),r&&r.info("> ROUND 1"),await d(),delete M.T0,delete R.QL,delete R.QR,delete R.QM,delete R.QO,delete R.QC,globalThis.gc&&globalThis.gc(),r&&r.info("> ROUND 2"),await p(),delete B.A,delete B.B,delete B.C,delete R.A,delete R.B,delete R.C,delete R.Sigma1,delete R.Sigma2,delete R.Sigma3,delete R.lagrange1,delete R.Z,globalThis.gc&&globalThis.gc(),r&&r.info("> ROUND 3"),await m(),delete M.A,delete M.B,delete M.C,delete M.Z,delete M.T1,delete M.T2,delete M.Sigma1,delete M.Sigma2,delete M.Sigma3,delete M.QL,delete M.QR,delete M.QM,delete M.QC,delete M.QO,globalThis.gc&&globalThis.gc(),r&&r.info("> ROUND 4"),await w(),globalThis.gc&&globalThis.gc(),r&&r.info("> ROUND 5"),await x(),delete M.C0,delete M.C1,delete M.C2,delete M.R1,delete M.R2,delete M.F,delete M.L,delete M.ZT,delete M.ZTS2,await u.close(),globalThis.gc&&globalThis.gc(),k.addEvaluation("inv",b());let O=k.toObjectProof();O.protocol="fflonk",O.curve=h.name;let G=[];for(let f=1;f<=o.nPublic;f++){const C=f*y,F=S.slice(C,C+y);G.push(Ae.fromRprLE(F))}return r&&r.info("FFLONK PROVER FINISHED"),{proof:Rm(O),publicSignals:Rm(G)};async function E(){r&&r.info(" Computing additions");const f=await fr(u,v,ol),C=8+y*2;for(let F=0;F<o.nAdditions;F++){r&&F!==0&&F%1e5===0&&r.info(`    addition ${F}/${o.nAdditions}`);let z=F*C;const W=s(f,z);z+=4;const $=s(f,z);z+=4;const I=f.slice(z,z+y);z+=y;const K=f.slice(z,z+y),N=l(W),X=l($),Q=g.add(g.mul(I,N),g.mul(K,X));T.set(Q,y*F)}}function s(f,C){const F=f.slice(C,C+4);return new DataView(F.buffer,F.byteOffset,F.byteLength).getUint32(0,!0)}function l(f){let C=o.nVars-o.nAdditions;if(f<C)return S.slice(f*y,f*y+y);if(f<o.nVars){const F=(f-C)*y;return T.slice(F,F+y)}return g.zero}async function d(){D.b=[];for(let W=1;W<=9;W++)D.b[W]=g.random();r&&r.info("> Computing A, B, C wire polynomials"),await C(),r&&r.info("> Computing T0 polynomial"),await F(),r&&r.info("> Computing C1 polynomial"),await z(),r&&r.info("> Computing C1 multi exponentiation");let f=await M.C1.multiExponentiation(U,"C1");return k.addPolynomial("C1",f),0;async function C(){r&&r.info(" Reading data from zkey file"),B.A=new ee(A),B.B=new ee(A),B.C=new ee(A);const W=await fr(u,v,cd),$=await fr(u,v,ud),I=await fr(u,v,hd);for(let K=0;K<o.nConstraints;K++){const N=K*y,X=K*4,Q=s(W,X);B.A.set(l(Q),N);const L=s($,X);B.B.set(l(L),N);const V=s(I,X);B.C.set(l(V),N)}if(B.A.set(D.b[1],A-64),B.A.set(D.b[2],A-32),B.B.set(D.b[3],A-64),B.B.set(D.b[4],A-32),B.C.set(D.b[5],A-64),B.C.set(D.b[6],A-32),B.A=await g.batchToMontgomery(B.A),B.B=await g.batchToMontgomery(B.B),B.C=await g.batchToMontgomery(B.C),r&&r.info(" Computing A ifft"),M.A=await _e.fromEvaluations(B.A,h,r),r&&r.info(" Computing B ifft"),M.B=await _e.fromEvaluations(B.B,h,r),r&&r.info(" Computing C ifft"),M.C=await _e.fromEvaluations(B.C,h,r),r&&r.info(" Computing A fft"),R.A=await Ar.fromPolynomial(M.A,4,h,r),r&&r.info(" Computing B fft"),R.B=await Ar.fromPolynomial(M.B,4,h,r),r&&r.info(" Computing C fft"),R.C=await Ar.fromPolynomial(M.C,4,h,r),M.A.degree()>=o.domainSize)throw new Error("A Polynomial is not well calculated");if(M.B.degree()>=o.domainSize)throw new Error("B Polynomial is not well calculated");if(M.C.degree()>=o.domainSize)throw new Error("C Polynomial is not well calculated")}async function F(){r&&r.info(` Reading sections ${ho}, ${po}, ${vo}, ${go}, ${mo}. Q selectors`),R.QL=new Ar(new ee(A*4),h,r),R.QR=new Ar(new ee(A*4),h,r),R.QM=new Ar(new ee(A*4),h,r),R.QO=new Ar(new ee(A*4),h,r),R.QC=new Ar(new ee(A*4),h,r),await u.readToBuffer(R.QL.eval,0,A*4,v[ho][0].p+A),await u.readToBuffer(R.QR.eval,0,A*4,v[po][0].p+A),await u.readToBuffer(R.QM.eval,0,A*4,v[vo][0].p+A),await u.readToBuffer(R.QO.eval,0,A*4,v[go][0].p+A),await u.readToBuffer(R.QC.eval,0,A*4,v[mo][0].p+A);const W=await fr(u,v,dd);R.lagrange1=new Ar(W,h,r),B.T0=new ee(A*4),r&&r.info(" Computing T0 evaluations");for(let $=0;$<o.domainSize*4;$++){r&&$!==0&&$%1e5===0&&r.info(`      T0 evaluation ${$}/${o.domainSize*4}`);const I=R.A.getEvaluation($),K=R.B.getEvaluation($),N=R.C.getEvaluation($),X=R.QL.getEvaluation($),Q=R.QR.getEvaluation($),L=R.QM.getEvaluation($),V=R.QO.getEvaluation($),Z=R.QC.getEvaluation($);let H=g.zero;for(let vt=0;vt<o.nPublic;vt++){const ot=vt*5*o.domainSize+o.domainSize+$,pt=R.lagrange1.getEvaluation(ot),Ut=B.A.slice(vt*y,(vt+1)*y);H=g.sub(H,g.mul(pt,Ut))}const j=g.mul(I,X),et=g.mul(K,Q),nt=g.mul(g.mul(I,K),L),st=g.mul(N,V),ft=g.add(j,g.add(et,g.add(nt,g.add(st,g.add(Z,H)))));B.T0.set(ft,$*y)}if(r&&r.info("buffer T0: "+B.T0.byteLength/y),r&&r.info(" Computing T0 ifft"),M.T0=await _e.fromEvaluations(B.T0,h,r),r&&r.info("T0 length: "+M.T0.length()),r&&r.info("T0 degree: "+M.T0.degree()),r&&r.info(" Computing T0 / ZH"),M.T0.divByZerofier(o.domainSize,g.one),M.T0.degree()>=2*o.domainSize-2)throw new Error(`T0 Polynomial is not well calculated (degree is ${M.T0.degree()} and must be less than ${2*o.domainSize+2}`);delete B.T0}async function z(){let W=new md(4,h,r);if(W.addPolynomial(0,M.A),W.addPolynomial(1,M.B),W.addPolynomial(2,M.C),W.addPolynomial(3,M.T0),M.C1=W.getPolynomial(),M.C1.degree()>=8*o.domainSize-8)throw new Error("C1 Polynomial is not well calculated")}}async function p(){r&&r.info("> Computing challenges beta and gamma");const f=new Ua(h);f.addPolCommitment(o.C0);for(let I=0;I<o.nPublic;I++)f.addScalar(B.A.slice(I*y,I*y+y));f.addPolCommitment(k.getPolynomial("C1")),D.beta=f.getChallenge(),r&&r.info(" challenges.beta: "+g.toString(D.beta)),f.reset(),f.addScalar(D.beta),D.gamma=f.getChallenge(),r&&r.info(" challenges.gamma: "+g.toString(D.gamma)),r&&r.info("> Computing Z polynomial"),await F(),r&&r.info("> Computing T1 polynomial"),await z(),r&&r.info("> Computing T2 polynomial"),await W(),r&&r.info("> Computing C2 polynomial"),await $(),r&&r.info("> Computing C2 multi exponentiation");let C=await M.C2.multiExponentiation(U,"C2");return k.addPolynomial("C2",C),0;async function F(){r&&r.info(" Computing Z evaluations");let I=new ee(A),K=new ee(A);I.set(g.one,0),K.set(g.one,0);let N=g.one;for(let X=0;X<o.domainSize;X++){r&&X!==0&&X%1e5===0&&r.info(`    Z evaluation ${X}/${o.domainSize}`);const Q=X*y,L=g.mul(D.beta,N);let V=B.A.slice(Q,Q+y);V=g.add(V,L),V=g.add(V,D.gamma);let Z=B.B.slice(Q,Q+y);Z=g.add(Z,g.mul(o.k1,L)),Z=g.add(Z,D.gamma);let H=B.C.slice(Q,Q+y);H=g.add(H,g.mul(o.k2,L)),H=g.add(H,D.gamma);let j=g.mul(V,g.mul(Z,H)),et=B.A.slice(Q,Q+y);et=g.add(et,g.mul(D.beta,R.Sigma1.getEvaluation(X*4))),et=g.add(et,D.gamma);let nt=B.B.slice(Q,Q+y);nt=g.add(nt,g.mul(D.beta,R.Sigma2.getEvaluation(X*4))),nt=g.add(nt,D.gamma);let st=B.C.slice(Q,Q+y);st=g.add(st,g.mul(D.beta,R.Sigma3.getEvaluation(X*4))),st=g.add(st,D.gamma);let ft=g.mul(et,g.mul(nt,st));j=g.mul(I.slice(Q,Q+y),j),I.set(j,(X+1)%o.domainSize*y),ft=g.mul(K.slice(Q,Q+y),ft),K.set(ft,(X+1)%o.domainSize*y),N=g.mul(N,g.w[o.power])}K=await g.batchInverse(K);for(let X=0;X<o.domainSize;X++){const Q=X*y,L=g.mul(I.slice(Q,Q+y),K.slice(Q,Q+y));I.set(L,Q)}if(B.Z=I,!g.eq(I.slice(0,y),g.one))throw new Error("Copy constraints does not match");if(r&&r.info(" Computing Z ifft"),M.Z=await _e.fromEvaluations(B.Z,h,r),r&&r.info(" Computing Z fft"),R.Z=await Ar.fromPolynomial(M.Z,4,h,r),M.Z.blindCoefficients([D.b[9],D.b[8],D.b[7]]),M.Z.degree()>=o.domainSize+3)throw new Error("Z Polynomial is not well calculated");delete B.Z}async function z(){r&&r.info(" Computing T1 evaluations"),B.T1=new ee(A*2),B.T1z=new ee(A*2);let I=g.one;for(let K=0;K<o.domainSize*2;K++){r&&K!==0&&K%1e5===0&&r.info(`    T1 evaluation ${K}/${o.domainSize*4}`);const N=g.square(I),X=R.Z.getEvaluation(K*2),Q=g.add(g.add(g.mul(D.b[7],N),g.mul(D.b[8],I)),D.b[9]),L=R.lagrange1.getEvaluation(o.domainSize+K*2);let V=g.mul(g.sub(X,g.one),L),Z=g.mul(Q,L);B.T1.set(V,K*y),B.T1z.set(Z,K*y),I=g.mul(I,g.w[o.power+1])}if(r&&r.info(" Computing T1 ifft"),M.T1=await _e.fromEvaluations(B.T1,h,r),M.T1.divByZerofier(o.domainSize,g.one),r&&r.info(" Computing T1z ifft"),M.T1z=await _e.fromEvaluations(B.T1z,h,r),M.T1.add(M.T1z),M.T1.degree()>=o.domainSize+2)throw new Error("T1 Polynomial is not well calculated");delete B.T1,delete B.T1z,delete M.T1z}async function W(){r&&r.info(" Computing T2 evaluations"),B.T2=new ee(A*4),B.T2z=new ee(A*4);let I=g.one;for(let K=0;K<o.domainSize*4;K++){r&&K!==0&&K%1e5===0&&r.info(`    T2 evaluation ${K}/${o.domainSize*4}`);const N=g.square(I),X=g.mul(I,g.w[o.power]),Q=g.square(X),L=R.A.getEvaluation(K),V=R.B.getEvaluation(K),Z=R.C.getEvaluation(K),H=R.Z.getEvaluation(K),j=R.Z.getEvaluation((o.domainSize*4+4+K)%(o.domainSize*4)),et=g.add(g.add(g.mul(D.b[7],N),g.mul(D.b[8],I)),D.b[9]),nt=g.add(g.add(g.mul(D.b[7],Q),g.mul(D.b[8],X)),D.b[9]),st=R.Sigma1.getEvaluation(K),ft=R.Sigma2.getEvaluation(K),vt=R.Sigma3.getEvaluation(K),ot=g.mul(D.beta,I);let pt=g.add(L,ot);pt=g.add(pt,D.gamma);let Ut=g.add(V,g.mul(ot,o.k1));Ut=g.add(Ut,D.gamma);let At=g.add(Z,g.mul(ot,o.k2));At=g.add(At,D.gamma);let It=g.mul(g.mul(g.mul(pt,Ut),At),H),Jt=g.mul(g.mul(g.mul(pt,Ut),At),et),at=g.add(L,g.mul(D.beta,st));at=g.add(at,D.gamma);let J=g.add(V,g.mul(D.beta,ft));J=g.add(J,D.gamma);let rt=g.add(Z,g.mul(D.beta,vt));rt=g.add(rt,D.gamma);let lt=g.mul(g.mul(g.mul(at,J),rt),j),gt=g.mul(g.mul(g.mul(at,J),rt),nt),Dt=g.sub(It,lt),ut=g.sub(Jt,gt);B.T2.set(Dt,K*y),B.T2z.set(ut,K*y),I=g.mul(I,g.w[o.power+2])}if(r&&r.info(" Computing T2 ifft"),M.T2=await _e.fromEvaluations(B.T2,h,r),r&&r.info(" Computing T2 / ZH"),M.T2.divByZerofier(o.domainSize,g.one),r&&r.info(" Computing T2z ifft"),M.T2z=await _e.fromEvaluations(B.T2z,h,r),M.T2.add(M.T2z),M.T2.degree()>=3*o.domainSize)throw new Error("T2 Polynomial is not well calculated");delete B.T2,delete B.T2z,delete M.T2z}async function $(){let I=new md(3,h,r);if(I.addPolynomial(0,M.Z),I.addPolynomial(1,M.T1),I.addPolynomial(2,M.T2),M.C2=I.getPolynomial(),M.C2.degree()>=9*o.domainSize)throw new Error("C2 Polynomial is not well calculated")}}async function m(){r&&r.info("> Computing challenge xi");const f=new Ua(h);f.addScalar(D.gamma),f.addPolCommitment(k.getPolynomial("C2")),D.xiSeed=f.getChallenge();const C=g.square(D.xiSeed);q.w8=[],q.w8[0]=g.one;for(let F=1;F<8;F++)q.w8[F]=g.mul(q.w8[F-1],o.w8);q.w4=[],q.w4[0]=g.one;for(let F=1;F<4;F++)q.w4[F]=g.mul(q.w4[F-1],o.w4);q.w3=[],q.w3[0]=g.one,q.w3[1]=o.w3,q.w3[2]=g.square(o.w3),q.S0={},q.S0.h0w8=[],q.S0.h0w8[0]=g.mul(C,D.xiSeed);for(let F=1;F<8;F++)q.S0.h0w8[F]=g.mul(q.S0.h0w8[0],q.w8[F]);q.S1={},q.S1.h1w4=[],q.S1.h1w4[0]=g.square(q.S0.h0w8[0]);for(let F=1;F<4;F++)q.S1.h1w4[F]=g.mul(q.S1.h1w4[0],q.w4[F]);q.S2={},q.S2.h2w3=[],q.S2.h2w3[0]=g.mul(q.S1.h1w4[0],C),q.S2.h2w3[1]=g.mul(q.S2.h2w3[0],q.w3[1]),q.S2.h2w3[2]=g.mul(q.S2.h2w3[0],q.w3[2]),q.S2.h3w3=[],q.S2.h3w3[0]=g.mul(q.S2.h2w3[0],o.wr),q.S2.h3w3[1]=g.mul(q.S2.h3w3[0],q.w3[1]),q.S2.h3w3[2]=g.mul(q.S2.h3w3[0],q.w3[2]),D.xi=g.mul(g.square(q.S2.h2w3[0]),q.S2.h2w3[0]),r&&r.info(" challenges.xi: "+g.toString(D.xi)),M.QL=new _e(new ee(A),h,r),M.QR=new _e(new ee(A),h,r),M.QM=new _e(new ee(A),h,r),M.QO=new _e(new ee(A),h,r),M.QC=new _e(new ee(A),h,r),await u.readToBuffer(M.QL.coef,0,A,v[ho][0].p),await u.readToBuffer(M.QR.coef,0,A,v[po][0].p),await u.readToBuffer(M.QM.coef,0,A,v[vo][0].p),await u.readToBuffer(M.QO.coef,0,A,v[go][0].p),await u.readToBuffer(M.QC.coef,0,A,v[mo][0].p),r&&r.info(" Computing evaluations"),k.addEvaluation("ql",M.QL.evaluate(D.xi)),k.addEvaluation("qr",M.QR.evaluate(D.xi)),k.addEvaluation("qm",M.QM.evaluate(D.xi)),k.addEvaluation("qo",M.QO.evaluate(D.xi)),k.addEvaluation("qc",M.QC.evaluate(D.xi)),k.addEvaluation("s1",M.Sigma1.evaluate(D.xi)),k.addEvaluation("s2",M.Sigma2.evaluate(D.xi)),k.addEvaluation("s3",M.Sigma3.evaluate(D.xi)),k.addEvaluation("a",M.A.evaluate(D.xi)),k.addEvaluation("b",M.B.evaluate(D.xi)),k.addEvaluation("c",M.C.evaluate(D.xi)),k.addEvaluation("z",M.Z.evaluate(D.xi)),D.xiw=g.mul(D.xi,g.w[o.power]),k.addEvaluation("zw",M.Z.evaluate(D.xiw)),k.addEvaluation("t1w",M.T1.evaluate(D.xiw)),k.addEvaluation("t2w",M.T2.evaluate(D.xiw))}async function w(){r&&r.info("> Computing challenge alpha");const f=new Ua(h);f.addScalar(D.xiSeed),f.addScalar(k.getEvaluation("ql")),f.addScalar(k.getEvaluation("qr")),f.addScalar(k.getEvaluation("qm")),f.addScalar(k.getEvaluation("qo")),f.addScalar(k.getEvaluation("qc")),f.addScalar(k.getEvaluation("s1")),f.addScalar(k.getEvaluation("s2")),f.addScalar(k.getEvaluation("s3")),f.addScalar(k.getEvaluation("a")),f.addScalar(k.getEvaluation("b")),f.addScalar(k.getEvaluation("c")),f.addScalar(k.getEvaluation("z")),f.addScalar(k.getEvaluation("zw")),f.addScalar(k.getEvaluation("t1w")),f.addScalar(k.getEvaluation("t2w")),D.alpha=f.getChallenge(),r&&r.info(" challenges.alpha: "+g.toString(D.alpha)),r&&r.info("> Reading C0 polynomial"),M.C0=new _e(new ee(A*8),h,r),await u.readToBuffer(M.C0.coef,0,A*8,v[pd][0].p),r&&r.info("> Computing R0 polynomial"),F(),r&&r.info("> Computing R1 polynomial"),z(),r&&r.info("> Computing R2 polynomial"),W(),r&&r.info("> Computing F polynomial"),await $(),r&&r.info("> Computing W1 multi exponentiation");let C=await M.F.multiExponentiation(U,"W1");return k.addPolynomial("W1",C),0;function F(){if(M.R0=_e.lagrangePolynomialInterpolation([q.S0.h0w8[0],q.S0.h0w8[1],q.S0.h0w8[2],q.S0.h0w8[3],q.S0.h0w8[4],q.S0.h0w8[5],q.S0.h0w8[6],q.S0.h0w8[7]],[M.C0.evaluate(q.S0.h0w8[0]),M.C0.evaluate(q.S0.h0w8[1]),M.C0.evaluate(q.S0.h0w8[2]),M.C0.evaluate(q.S0.h0w8[3]),M.C0.evaluate(q.S0.h0w8[4]),M.C0.evaluate(q.S0.h0w8[5]),M.C0.evaluate(q.S0.h0w8[6]),M.C0.evaluate(q.S0.h0w8[7])],h),M.R0.degree()>7)throw new Error("R0 Polynomial is not well calculated")}function z(){if(M.R1=_e.lagrangePolynomialInterpolation([q.S1.h1w4[0],q.S1.h1w4[1],q.S1.h1w4[2],q.S1.h1w4[3]],[M.C1.evaluate(q.S1.h1w4[0]),M.C1.evaluate(q.S1.h1w4[1]),M.C1.evaluate(q.S1.h1w4[2]),M.C1.evaluate(q.S1.h1w4[3])],h),M.R1.degree()>3)throw new Error("R1 Polynomial is not well calculated")}function W(){if(M.R2=_e.lagrangePolynomialInterpolation([q.S2.h2w3[0],q.S2.h2w3[1],q.S2.h2w3[2],q.S2.h3w3[0],q.S2.h3w3[1],q.S2.h3w3[2]],[M.C2.evaluate(q.S2.h2w3[0]),M.C2.evaluate(q.S2.h2w3[1]),M.C2.evaluate(q.S2.h2w3[2]),M.C2.evaluate(q.S2.h3w3[0]),M.C2.evaluate(q.S2.h3w3[1]),M.C2.evaluate(q.S2.h3w3[2])],h),M.R2.degree()>5)throw new Error("R2 Polynomial is not well calculated")}async function $(){r&&r.info(" Computing F polynomial"),M.F=_e.fromPolynomial(M.C0,h,r),M.F.sub(M.R0),M.F.divByZerofier(8,D.xi);let I=_e.fromPolynomial(M.C1,h,r);I.sub(M.R1),I.mulScalar(D.alpha),I.divByZerofier(4,D.xi);let K=_e.fromPolynomial(M.C2,h,r);if(K.sub(M.R2),K.mulScalar(g.square(D.alpha)),K.divByZerofier(3,D.xi),K.divByZerofier(3,D.xiw),M.F.add(I),M.F.add(K),M.F.degree()>=9*o.domainSize-6)throw new Error("F Polynomial is not well calculated")}}async function x(){r&&r.info("> Computing challenge y");const f=new Ua(h);f.addScalar(D.alpha),f.addPolCommitment(k.getPolynomial("W1")),D.y=f.getChallenge(),r&&r.info(" challenges.y: "+g.toString(D.y)),r&&r.info("> Computing L polynomial"),await $(),r&&r.info("> Computing ZTS2 polynomial"),await K();let C=M.ZTS2.evaluate(D.y);C=g.inv(C),M.L.mulScalar(C);const F=_e.fromCoefficientsArray([g.neg(D.y),g.one],h);r&&r.info("> Computing W' = L / ZTS2 polynomial");const z=M.L.divBy(F);if(z.degree()>0)throw new Error(`Degree of L(X)/(ZTS2(y)(X-y)) remainder is ${z.degree()} and should be 0`);if(M.L.degree()>=9*o.domainSize-1)throw new Error("Degree of L(X)/(ZTS2(y)(X-y)) is not correct");r&&r.info("> Computing W' multi exponentiation");let W=await M.L.multiExponentiation(U,"W2");return k.addPolynomial("W2",W),0;async function $(){r&&r.info(" Computing L polynomial");const N=M.R0.evaluate(D.y),X=M.R1.evaluate(D.y),Q=M.R2.evaluate(D.y);let L=g.sub(D.y,q.S0.h0w8[0]);for(let vt=1;vt<8;vt++)L=g.mul(L,g.sub(D.y,q.S0.h0w8[vt]));let V=g.sub(D.y,q.S1.h1w4[0]);for(let vt=1;vt<4;vt++)V=g.mul(V,g.sub(D.y,q.S1.h1w4[vt]));let Z=g.sub(D.y,q.S2.h2w3[0]);for(let vt=1;vt<3;vt++)Z=g.mul(Z,g.sub(D.y,q.S2.h2w3[vt]));for(let vt=0;vt<3;vt++)Z=g.mul(Z,g.sub(D.y,q.S2.h3w3[vt]));let H=g.mul(V,Z),j=g.mul(D.alpha,g.mul(L,Z)),et=g.mul(g.square(D.alpha),g.mul(L,V));P.denH1=V,P.denH2=Z,M.L=_e.fromPolynomial(M.C0,h,r),M.L.subScalar(N),M.L.mulScalar(H);let nt=_e.fromPolynomial(M.C1,h,r);nt.subScalar(X),nt.mulScalar(j);let st=_e.fromPolynomial(M.C2,h,r);st.subScalar(Q),st.mulScalar(et),M.L.add(nt),M.L.add(st),r&&r.info("> Computing ZT polynomial"),await I();const ft=M.ZT.evaluate(D.y);if(M.F.mulScalar(ft),M.L.sub(M.F),M.L.degree()>=9*o.domainSize)throw new Error("L Polynomial is not well calculated");delete B.L}async function I(){M.ZT=_e.zerofierPolynomial([q.S0.h0w8[0],q.S0.h0w8[1],q.S0.h0w8[2],q.S0.h0w8[3],q.S0.h0w8[4],q.S0.h0w8[5],q.S0.h0w8[6],q.S0.h0w8[7],q.S1.h1w4[0],q.S1.h1w4[1],q.S1.h1w4[2],q.S1.h1w4[3],q.S2.h2w3[0],q.S2.h2w3[1],q.S2.h2w3[2],q.S2.h3w3[0],q.S2.h3w3[1],q.S2.h3w3[2]],h)}async function K(){M.ZTS2=_e.zerofierPolynomial([q.S1.h1w4[0],q.S1.h1w4[1],q.S1.h1w4[2],q.S1.h1w4[3],q.S2.h2w3[0],q.S2.h2w3[1],q.S2.h2w3[2],q.S2.h3w3[0],q.S2.h3w3[1],q.S2.h3w3[2]],h)}}function b(){let f=D.xi;for(let K=0;K<o.power;K++)f=g.square(f);P.zh=g.sub(f,g.one),W(P,q.S0.h0w8,D.y,h),$(P,q.S1.h1w4,D.y,h),I(P,q.S2.h2w3,q.S2.h3w3,D.y,D.xi,D.xiw,h);const C=Math.max(1,o.nPublic);let F=g.one;for(let K=0;K<C;K++)P["Li_"+(K+1)]=g.mul(g.e(o.domainSize),g.sub(D.xi,F)),F=g.mul(F,g.w[o.power]);let z=g.one;for(const K of Object.values(P))if(Array.isArray(K))for(const N of K)z=g.mul(z,N);else z=g.mul(z,K);return g.inv(z);function W(K,N,X,Q){const L=Q.Fr,V=N.length,Z=L.mul(L.e(V),L.exp(N[0],V-2)),H=[];for(let j=0;j<V;j++){const et=N[(V-1)*j%V],nt=L.sub(X,N[j]);K[["LiS0_"+(j+1)]]=L.mul(L.mul(Z,et),nt)}return H}function $(K,N,X,Q){const L=Q.Fr,V=N.length,Z=L.mul(L.e(V),L.exp(N[0],V-2)),H=[];for(let j=0;j<V;j++){const et=N[(V-1)*j%V],nt=L.sub(X,N[j]);K[["LiS1_"+(j+1)]]=L.mul(L.mul(Z,et),nt)}return H}function I(K,N,X,Q,L,V,Z){const H=Z.Fr,j=[],et=H.mul(H.e(3),N[0]),nt=H.sub(L,V);let st=H.mul(et,nt);for(let ot=0;ot<3;ot++){const pt=N[2*ot%3],Ut=H.sub(Q,N[ot]);K[["LiS2_"+(ot+1)]]=H.mul(st,H.mul(pt,Ut))}const ft=H.mul(H.e(3),X[0]),vt=H.sub(V,L);st=H.mul(ft,vt);for(let ot=0;ot<3;ot++){const pt=X[2*ot%3],Ut=H.sub(Q,X[ot]);K[["LiS2_"+(ot+1+3)]]=H.mul(st,H.mul(pt,Ut))}return j}}}const{unstringifyBigInts:J9}=ri;async function tS(i,e,r,t,a,n){const c=J9(i),u={type:"mem"};return await Zl(c,e,u,a),await C6(r,u,t,n)}const{unstringifyBigInts:Eh}=ri;async function eS(i,e,r,t){t&&t.info("FFLONK VERIFIER STARTED"),i=Eh(i),r=Eh(r);const a=await Za(i.curve),n=rS(a,i),c=new P1(a,t);c.fromObjectProof(r);const u=Eh(e);if(u.length!==n.nPublic)return t.error("Number of public signals does not match with vk"),!1;const v=a.Fr;if(t&&(t.info("----------------------------"),t.info("  FFLONK VERIFY SETTINGS"),t.info(`  Curve:         ${a.name}`),t.info(`  Circuit power: ${n.power}`),t.info(`  Domain size:   ${2**n.power}`),t.info(`  Public vars:   ${n.nPublic}`),t.info("----------------------------")),t&&t.info("> Checking commitments belong to G1"),!iS(a,c,n))return t&&t.error("Proof commitments are not valid"),!1;if(t&&t.info("> Checking evaluations belong to F"),!nS(a,c))return t&&t.error("Proof evaluations are not valid."),!1;if(t&&t.info("> Checking public inputs belong to F"),!aS(a,u))return t&&t.error("Public inputs are not valid."),!1;t&&t.info("> Computing challenges");const{challenges:o,roots:h}=sS(a,c,n,u,t);t&&t.info("> Computing Zero polynomial evaluation Z_H(xi)"),o.zh=v.sub(o.xiN,v.one),o.invzh=v.inv(o.zh),t&&t.info("> Computing Lagrange evaluations");const g=await oS(a,o,n);t&&t.info("> Computing polynomial identities PI(X)");const y=fS(a,u,g);t&&t.info("> Computing r0(y)");const _=lS(c,o,h,a,t);t&&t.info("> Computing r1(y)");const A=cS(c,o,h,y,a,t);t&&t.info("> Computing r2(y)");const S=uS(c,o,h,g[1],n,a,t);t&&t.info("> Computing F");const T=hS(a,c,n,o,h);t&&t.info("> Computing E");const B=dS(a,c,o,n,_,A,S);t&&t.info("> Computing J");const M=pS(a,c,o);t&&t.info("> Validate all evaluations with a pairing");const R=await vS(a,c,o,n,T,B,M);return t&&(R?t.info("PROOF VERIFIED SUCCESSFULLY"):t.warn("Invalid Proof")),t&&t.info("FFLONK VERIFIER FINISHED"),R}function rS(i,e){const r=e;return r.k1=i.Fr.fromObject(e.k1),r.k2=i.Fr.fromObject(e.k2),r.w=i.Fr.fromObject(e.w),r.w3=i.Fr.fromObject(e.w3),r.w4=i.Fr.fromObject(e.w4),r.w8=i.Fr.fromObject(e.w8),r.wr=i.Fr.fromObject(e.wr),r.X_2=i.G2.fromObject(e.X_2),r.C0=i.G1.fromObject(e.C0),r}function iS(i,e,r){const t=i.G1;return t.isValid(e.polynomials.C1)&&t.isValid(e.polynomials.C2)&&t.isValid(e.polynomials.W1)&&t.isValid(e.polynomials.W2)&&t.isValid(r.C0)}function E6(i,e){return Ae.lt(e,i.r)}function fi(i,e){return E6(i,Ae.fromRprLE(e))}function nS(i,e){return fi(i,e.evaluations.ql)&&fi(i,e.evaluations.qr)&&fi(i,e.evaluations.qm)&&fi(i,e.evaluations.qo)&&fi(i,e.evaluations.qc)&&fi(i,e.evaluations.s1)&&fi(i,e.evaluations.s2)&&fi(i,e.evaluations.s3)&&fi(i,e.evaluations.a)&&fi(i,e.evaluations.b)&&fi(i,e.evaluations.c)&&fi(i,e.evaluations.z)&&fi(i,e.evaluations.zw)&&fi(i,e.evaluations.t1w)&&fi(i,e.evaluations.t2w)}function aS(i,e){for(let r=0;r<e.length;r++)if(!E6(i,e[r]))return!1;return!0}function sS(i,e,r,t,a){const n=i.Fr,c={},u={},v=new Ua(i);v.addPolCommitment(r.C0);for(let A=0;A<t.length;A++)v.addScalar(n.e(t[A]));v.addPolCommitment(e.polynomials.C1),c.beta=v.getChallenge(),v.reset(),v.addScalar(c.beta),c.gamma=v.getChallenge(),v.reset(),v.addScalar(c.gamma),v.addPolCommitment(e.polynomials.C2);const o=v.getChallenge(),h=n.square(o);let g=[];g[1]=r.w8,g[2]=n.square(r.w8),g[3]=n.mul(g[2],r.w8),g[4]=n.mul(g[3],r.w8),g[5]=n.mul(g[4],r.w8),g[6]=n.mul(g[5],r.w8),g[7]=n.mul(g[6],r.w8);let y=[];y[1]=r.w4,y[2]=n.square(r.w4),y[3]=n.mul(y[2],r.w4);let _=[];_[1]=r.w3,_[2]=n.square(r.w3),u.S0={},u.S0.h0w8=[],u.S0.h0w8[0]=n.mul(h,o);for(let A=1;A<8;A++)u.S0.h0w8[A]=n.mul(u.S0.h0w8[0],g[A]);u.S1={},u.S1.h1w4=[],u.S1.h1w4[0]=n.square(u.S0.h0w8[0]);for(let A=1;A<4;A++)u.S1.h1w4[A]=n.mul(u.S1.h1w4[0],y[A]);u.S2={},u.S2.h2w3=[],u.S2.h2w3[0]=n.mul(u.S1.h1w4[0],h),u.S2.h2w3[1]=n.mul(u.S2.h2w3[0],_[1]),u.S2.h2w3[2]=n.mul(u.S2.h2w3[0],_[2]),u.S2.h3w3=[],u.S2.h3w3[0]=n.mul(u.S2.h2w3[0],r.wr),u.S2.h3w3[1]=n.mul(u.S2.h3w3[0],_[1]),u.S2.h3w3[2]=n.mul(u.S2.h3w3[0],_[2]),c.xi=n.mul(n.square(u.S2.h2w3[0]),u.S2.h2w3[0]),c.xiw=n.mul(c.xi,n.w[r.power]),c.xiN=c.xi,r.domainSize=1;for(let A=0;A<r.power;A++)c.xiN=n.square(c.xiN),r.domainSize*=2;return v.reset(),v.addScalar(o),v.addScalar(e.evaluations.ql),v.addScalar(e.evaluations.qr),v.addScalar(e.evaluations.qm),v.addScalar(e.evaluations.qo),v.addScalar(e.evaluations.qc),v.addScalar(e.evaluations.s1),v.addScalar(e.evaluations.s2),v.addScalar(e.evaluations.s3),v.addScalar(e.evaluations.a),v.addScalar(e.evaluations.b),v.addScalar(e.evaluations.c),v.addScalar(e.evaluations.z),v.addScalar(e.evaluations.zw),v.addScalar(e.evaluations.t1w),v.addScalar(e.evaluations.t2w),c.alpha=v.getChallenge(),v.reset(),v.addScalar(c.alpha),v.addPolCommitment(e.polynomials.W1),c.y=v.getChallenge(),a&&(a.info(" challenges.beta:  "+n.toString(c.beta)),a.info(" challenges.gamma: "+n.toString(c.gamma)),a.info(" challenges.xi:    "+n.toString(c.xi)),a.info(" challenges.alpha: "+n.toString(c.alpha)),a.info(" challenges.y:     "+n.toString(c.y))),{challenges:c,roots:u}}async function oS(i,e,r){const t=i.Fr,a=Math.max(1,r.nPublic),n=new ee(a*t.n8);let c=new ee(a*t.n8),u=t.one;for(let o=0;o<a;o++){const h=o*t.n8;n.set(t.mul(u,e.zh),h),c.set(t.mul(t.e(r.domainSize),t.sub(e.xi,u)),h),u=t.mul(u,r.w)}c=await t.batchInverse(c);let v=[];for(let o=0;o<a;o++){const h=o*t.n8;v[o+1]=t.mul(n.slice(h,h+t.n8),c.slice(h,h+t.n8))}return v}function fS(i,e,r){const t=i.Fr;let a=t.zero;for(let n=0;n<e.length;n++){const c=t.e(e[n]);a=t.sub(a,t.mul(c,r[n+1]))}return a}function lS(i,e,r,t,a){const n=t.Fr,c=A6(r.S0.h0w8,e.y,e.xi,t);a&&a.info(" Computing r0(y)");let u=n.zero;for(let v=0;v<8;v++){let o=[];o[1]=r.S0.h0w8[v];for(let g=2;g<8;g++)o[g]=n.mul(o[g-1],r.S0.h0w8[v]);let h=n.add(i.evaluations.ql,n.mul(i.evaluations.qr,o[1]));h=n.add(h,n.mul(i.evaluations.qo,o[2])),h=n.add(h,n.mul(i.evaluations.qm,o[3])),h=n.add(h,n.mul(i.evaluations.qc,o[4])),h=n.add(h,n.mul(i.evaluations.s1,o[5])),h=n.add(h,n.mul(i.evaluations.s2,o[6])),h=n.add(h,n.mul(i.evaluations.s3,o[7])),u=n.add(u,n.mul(h,c[v]))}return u}function cS(i,e,r,t,a,n){const c=a.Fr,u=A6(r.S1.h1w4,e.y,e.xi,a);n&&n.info(" Computing T0(xi)");let v=c.mul(i.evaluations.ql,i.evaluations.a);v=c.add(v,c.mul(i.evaluations.qr,i.evaluations.b)),v=c.add(v,c.mul(i.evaluations.qm,c.mul(i.evaluations.a,i.evaluations.b))),v=c.add(v,c.mul(i.evaluations.qo,i.evaluations.c)),v=c.add(v,i.evaluations.qc),v=c.add(v,t),v=c.mul(v,e.invzh),n&&n.info(" Computing C1(h_1_4^i) values");let o=c.zero;for(let h=0;h<4;h++){let g=i.evaluations.a;g=c.add(g,c.mul(r.S1.h1w4[h],i.evaluations.b));const y=c.square(r.S1.h1w4[h]);g=c.add(g,c.mul(y,i.evaluations.c)),g=c.add(g,c.mul(c.mul(y,r.S1.h1w4[h]),v)),o=c.add(o,c.mul(g,u[h]))}return o}function uS(i,e,r,t,a,n,c){const u=n.Fr,v=gS([r.S2.h2w3,r.S2.h3w3],e.y,e.xi,e.xiw,n);c&&c.info(" Computing T1(xi)");let o=u.sub(i.evaluations.z,u.one);o=u.mul(o,t),o=u.mul(o,e.invzh),c&&c.info(" Computing T2(xi)");const h=u.mul(e.beta,e.xi),g=u.add(i.evaluations.a,u.add(h,e.gamma)),y=u.add(i.evaluations.b,u.add(u.mul(h,a.k1),e.gamma)),_=u.add(i.evaluations.c,u.add(u.mul(h,a.k2),e.gamma)),A=u.mul(g,u.mul(y,u.mul(_,i.evaluations.z))),S=u.add(i.evaluations.a,u.add(u.mul(e.beta,i.evaluations.s1),e.gamma)),T=u.add(i.evaluations.b,u.add(u.mul(e.beta,i.evaluations.s2),e.gamma)),B=u.add(i.evaluations.c,u.add(u.mul(e.beta,i.evaluations.s3),e.gamma)),M=u.mul(S,u.mul(T,u.mul(B,i.evaluations.zw)));let R=u.sub(A,M);R=u.mul(R,e.invzh),c&&c.info(" Computing C2(h_2_3^i) values");let P=u.zero;for(let D=0;D<3;D++){let q=u.add(i.evaluations.z,u.mul(r.S2.h2w3[D],o));q=u.add(q,u.mul(u.square(r.S2.h2w3[D]),R)),P=u.add(P,u.mul(q,v[D]))}c&&c.info(" Computing C2(h_3_3^i) values");for(let D=0;D<3;D++){let q=u.add(i.evaluations.zw,u.mul(r.S2.h3w3[D],i.evaluations.t1w));q=u.add(q,u.mul(u.square(r.S2.h3w3[D]),i.evaluations.t2w)),P=u.add(P,u.mul(q,v[D+3]))}return P}function hS(i,e,r,t,a){const n=i.G1,c=i.Fr;let u=c.sub(t.y,a.S0.h0w8[0]);for(let y=1;y<8;y++)u=c.mul(u,c.sub(t.y,a.S0.h0w8[y]));t.temp=u;let v=c.sub(t.y,a.S1.h1w4[0]);for(let y=1;y<4;y++)v=c.mul(v,c.sub(t.y,a.S1.h1w4[y]));let o=c.sub(t.y,a.S2.h2w3[0]);for(let y=1;y<3;y++)o=c.mul(o,c.sub(t.y,a.S2.h2w3[y]));for(let y=0;y<3;y++)o=c.mul(o,c.sub(t.y,a.S2.h3w3[y]));t.quotient1=c.mul(t.alpha,c.div(u,v)),t.quotient2=c.mul(c.square(t.alpha),c.div(u,o));let h=n.timesFr(e.polynomials.C1,t.quotient1),g=n.timesFr(e.polynomials.C2,t.quotient2);return n.add(r.C0,n.add(h,g))}function dS(i,e,r,t,a,n,c){const u=i.G1,v=i.Fr;let o=v.mul(n,r.quotient1),h=v.mul(c,r.quotient2);return u.timesFr(u.one,v.add(a,v.add(o,h)))}function pS(i,e,r){return i.G1.timesFr(e.polynomials.W1,r.temp)}async function vS(i,e,r,t,a,n,c){const u=i.G1;let v=u.timesFr(e.polynomials.W2,r.y);v=u.add(u.sub(u.sub(a,n),c),v);const o=i.G2.one,h=e.polynomials.W2,g=t.X_2;return await i.pairingEq(u.neg(v),o,h,g)}function A6(i,e,r,t){const a=t.Fr,n=i.length,c=a.sub(a.exp(e,n),r),u=a.mul(a.e(n),a.exp(i[0],n-2)),v=[];for(let o=0;o<n;o++){const h=i[(n-1)*o%n],g=a.sub(e,i[o]);v[o]=a.div(c,a.mul(a.mul(u,h),g))}return v}function gS(i,e,r,t,a){const n=a.Fr,c=[],u=i[0].length,v=u*i.length,o=n.exp(e,v),h=n.mul(n.add(r,t),n.exp(e,u)),g=n.mul(r,t),y=n.add(n.sub(o,h),g);let _=n.mul(n.mul(n.e(u),i[0][0]),n.sub(r,t));for(let A=0;A<u;A++){const S=i[0][(u-1)*A%u],T=n.sub(e,i[0][A]),B=n.mul(_,n.mul(S,T));c[A]=n.div(y,B)}_=n.mul(n.mul(n.e(u),i[1][0]),n.sub(t,r));for(let A=0;A<u;A++){const S=i[1][(u-1)*A%u],T=n.sub(e,i[1][A]),B=n.mul(_,n.mul(S,T));c[A+u]=n.div(y,B)}return c}const{unstringifyBigInts:Nm}=ri;function Rr(i){let e=i.toString(16);for(;e.length<64;)e="0"+e;return e=`0x${e}`,e}async function mS(i,e){const r=Nm(e),t=Nm(i);await Za(r.curve);let a="";for(let n=0;n<t.length;n++)a!==""&&(a=a+","),a=a+Rr(t[n]);return`[${Rr(r.polynomials.C1[0])}, ${Rr(r.polynomials.C1[1])},${Rr(r.polynomials.C2[0])},${Rr(r.polynomials.C2[1])},${Rr(r.polynomials.W1[0])},${Rr(r.polynomials.W1[1])},${Rr(r.polynomials.W2[0])},${Rr(r.polynomials.W2[1])},${Rr(r.evaluations.ql)},${Rr(r.evaluations.qr)},${Rr(r.evaluations.qm)},${Rr(r.evaluations.qo)},${Rr(r.evaluations.qc)},${Rr(r.evaluations.s1)},${Rr(r.evaluations.s2)},${Rr(r.evaluations.s3)},${Rr(r.evaluations.a)},${Rr(r.evaluations.b)},${Rr(r.evaluations.c)},${Rr(r.evaluations.z)},${Rr(r.evaluations.zw)},${Rr(r.evaluations.t1w)},${Rr(r.evaluations.t2w)},${Rr(r.evaluations.inv)}],[${a}]`}var yS=Object.freeze({__proto__:null,setup:X9,prove:C6,fullProve:tS,verify:eS,exportSolidityVerifier:b6,exportSolidityCallData:mS});const bS=Object.freeze(Object.defineProperty({__proto__:null,curves:NE,fflonk:yS,groth16:MA,plonk:$9,powersOfTau:KA,r1cs:r9,wtns:o9,zKey:E9},Symbol.toStringTag,{value:"Module"})),S6=e1(bS);var Wl={exports:{}},x6={exports:{}},I6={exports:{}};(function(i){(function(e){var r,t=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,n=Math.floor,c="[BigNumber Error] ",u=c+"Number primitive has more than 15 significant digits: ",v=1e14,o=14,h=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,_=1e9;function A(q){var k,U,O,G=W.prototype={constructor:W,toString:null,valueOf:null},E=new W(1),s=20,l=4,d=-7,p=21,m=-1e7,w=1e7,x=!1,b=1,f=0,C={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},F="0123456789abcdefghijklmnopqrstuvwxyz",z=!0;function W(Q,L){var V,Z,H,j,et,nt,st,ft,vt=this;if(!(vt instanceof W))return new W(Q,L);if(L==null){if(Q&&Q._isBigNumber===!0){vt.s=Q.s,!Q.c||Q.e>w?vt.c=vt.e=null:Q.e<m?vt.c=[vt.e=0]:(vt.e=Q.e,vt.c=Q.c.slice());return}if((nt=typeof Q=="number")&&Q*0==0){if(vt.s=1/Q<0?(Q=-Q,-1):1,Q===~~Q){for(j=0,et=Q;et>=10;et/=10,j++);j>w?vt.c=vt.e=null:(vt.e=j,vt.c=[Q]);return}ft=String(Q)}else{if(!t.test(ft=String(Q)))return O(vt,ft,nt);vt.s=ft.charCodeAt(0)==45?(ft=ft.slice(1),-1):1}(j=ft.indexOf("."))>-1&&(ft=ft.replace(".","")),(et=ft.search(/e/i))>0?(j<0&&(j=et),j+=+ft.slice(et+1),ft=ft.substring(0,et)):j<0&&(j=ft.length)}else{if(M(L,2,F.length,"Base"),L==10&&z)return vt=new W(Q),N(vt,s+vt.e+1,l);if(ft=String(Q),nt=typeof Q=="number"){if(Q*0!=0)return O(vt,ft,nt,L);if(vt.s=1/Q<0?(ft=ft.slice(1),-1):1,W.DEBUG&&ft.replace(/^0\.0*|\./,"").length>15)throw Error(u+Q)}else vt.s=ft.charCodeAt(0)===45?(ft=ft.slice(1),-1):1;for(V=F.slice(0,L),j=et=0,st=ft.length;et<st;et++)if(V.indexOf(Z=ft.charAt(et))<0){if(Z=="."){if(et>j){j=st;continue}}else if(!H&&(ft==ft.toUpperCase()&&(ft=ft.toLowerCase())||ft==ft.toLowerCase()&&(ft=ft.toUpperCase()))){H=!0,et=-1,j=0;continue}return O(vt,String(Q),nt,L)}nt=!1,ft=U(ft,L,10,vt.s),(j=ft.indexOf("."))>-1?ft=ft.replace(".",""):j=ft.length}for(et=0;ft.charCodeAt(et)===48;et++);for(st=ft.length;ft.charCodeAt(--st)===48;);if(ft=ft.slice(et,++st)){if(st-=et,nt&&W.DEBUG&&st>15&&(Q>h||Q!==n(Q)))throw Error(u+vt.s*Q);if((j=j-et-1)>w)vt.c=vt.e=null;else if(j<m)vt.c=[vt.e=0];else{if(vt.e=j,vt.c=[],et=(j+1)%o,j<0&&(et+=o),et<st){for(et&&vt.c.push(+ft.slice(0,et)),st-=o;et<st;)vt.c.push(+ft.slice(et,et+=o));et=o-(ft=ft.slice(et)).length}else et-=st;for(;et--;ft+="0");vt.c.push(+ft)}}else vt.c=[vt.e=0]}W.clone=A,W.ROUND_UP=0,W.ROUND_DOWN=1,W.ROUND_CEIL=2,W.ROUND_FLOOR=3,W.ROUND_HALF_UP=4,W.ROUND_HALF_DOWN=5,W.ROUND_HALF_EVEN=6,W.ROUND_HALF_CEIL=7,W.ROUND_HALF_FLOOR=8,W.EUCLID=9,W.config=W.set=function(Q){var L,V;if(Q!=null)if(typeof Q=="object"){if(Q.hasOwnProperty(L="DECIMAL_PLACES")&&(V=Q[L],M(V,0,_,L),s=V),Q.hasOwnProperty(L="ROUNDING_MODE")&&(V=Q[L],M(V,0,8,L),l=V),Q.hasOwnProperty(L="EXPONENTIAL_AT")&&(V=Q[L],V&&V.pop?(M(V[0],-_,0,L),M(V[1],0,_,L),d=V[0],p=V[1]):(M(V,-_,_,L),d=-(p=V<0?-V:V))),Q.hasOwnProperty(L="RANGE"))if(V=Q[L],V&&V.pop)M(V[0],-_,-1,L),M(V[1],1,_,L),m=V[0],w=V[1];else if(M(V,-_,_,L),V)m=-(w=V<0?-V:V);else throw Error(c+L+" cannot be zero: "+V);if(Q.hasOwnProperty(L="CRYPTO"))if(V=Q[L],V===!!V)if(V)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))x=V;else throw x=!V,Error(c+"crypto unavailable");else x=V;else throw Error(c+L+" not true or false: "+V);if(Q.hasOwnProperty(L="MODULO_MODE")&&(V=Q[L],M(V,0,9,L),b=V),Q.hasOwnProperty(L="POW_PRECISION")&&(V=Q[L],M(V,0,_,L),f=V),Q.hasOwnProperty(L="FORMAT"))if(V=Q[L],typeof V=="object")C=V;else throw Error(c+L+" not an object: "+V);if(Q.hasOwnProperty(L="ALPHABET"))if(V=Q[L],typeof V=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(V))z=V.slice(0,10)=="0123456789",F=V;else throw Error(c+L+" invalid: "+V)}else throw Error(c+"Object expected: "+Q);return{DECIMAL_PLACES:s,ROUNDING_MODE:l,EXPONENTIAL_AT:[d,p],RANGE:[m,w],CRYPTO:x,MODULO_MODE:b,POW_PRECISION:f,FORMAT:C,ALPHABET:F}},W.isBigNumber=function(Q){if(!Q||Q._isBigNumber!==!0)return!1;if(!W.DEBUG)return!0;var L,V,Z=Q.c,H=Q.e,j=Q.s;t:if({}.toString.call(Z)=="[object Array]"){if((j===1||j===-1)&&H>=-_&&H<=_&&H===n(H)){if(Z[0]===0){if(H===0&&Z.length===1)return!0;break t}if(L=(H+1)%o,L<1&&(L+=o),String(Z[0]).length==L){for(L=0;L<Z.length;L++)if(V=Z[L],V<0||V>=v||V!==n(V))break t;if(V!==0)return!0}}}else if(Z===null&&H===null&&(j===null||j===1||j===-1))return!0;throw Error(c+"Invalid BigNumber: "+Q)},W.maximum=W.max=function(){return I(arguments,-1)},W.minimum=W.min=function(){return I(arguments,1)},W.random=function(){var Q=9007199254740992,L=Math.random()*Q&2097151?function(){return n(Math.random()*Q)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(V){var Z,H,j,et,nt,st=0,ft=[],vt=new W(E);if(V==null?V=s:M(V,0,_),et=a(V/o),x)if(crypto.getRandomValues){for(Z=crypto.getRandomValues(new Uint32Array(et*=2));st<et;)nt=Z[st]*131072+(Z[st+1]>>>11),nt>=9e15?(H=crypto.getRandomValues(new Uint32Array(2)),Z[st]=H[0],Z[st+1]=H[1]):(ft.push(nt%1e14),st+=2);st=et/2}else if(crypto.randomBytes){for(Z=crypto.randomBytes(et*=7);st<et;)nt=(Z[st]&31)*281474976710656+Z[st+1]*1099511627776+Z[st+2]*4294967296+Z[st+3]*16777216+(Z[st+4]<<16)+(Z[st+5]<<8)+Z[st+6],nt>=9e15?crypto.randomBytes(7).copy(Z,st):(ft.push(nt%1e14),st+=7);st=et/7}else throw x=!1,Error(c+"crypto unavailable");if(!x)for(;st<et;)nt=L(),nt<9e15&&(ft[st++]=nt%1e14);for(et=ft[--st],V%=o,et&&V&&(nt=g[o-V],ft[st]=n(et/nt)*nt);ft[st]===0;ft.pop(),st--);if(st<0)ft=[j=0];else{for(j=-1;ft[0]===0;ft.splice(0,1),j-=o);for(st=1,nt=ft[0];nt>=10;nt/=10,st++);st<o&&(j-=o-st)}return vt.e=j,vt.c=ft,vt}}(),W.sum=function(){for(var Q=1,L=arguments,V=new W(L[0]);Q<L.length;)V=V.plus(L[Q++]);return V},U=function(){var Q="0123456789";function L(V,Z,H,j){for(var et,nt=[0],st,ft=0,vt=V.length;ft<vt;){for(st=nt.length;st--;nt[st]*=Z);for(nt[0]+=j.indexOf(V.charAt(ft++)),et=0;et<nt.length;et++)nt[et]>H-1&&(nt[et+1]==null&&(nt[et+1]=0),nt[et+1]+=nt[et]/H|0,nt[et]%=H)}return nt.reverse()}return function(V,Z,H,j,et){var nt,st,ft,vt,ot,pt,Ut,At,It=V.indexOf("."),Jt=s,at=l;for(It>=0&&(vt=f,f=0,V=V.replace(".",""),At=new W(Z),pt=At.pow(V.length-It),f=vt,At.c=L(D(T(pt.c),pt.e,"0"),10,H,Q),At.e=At.c.length),Ut=L(V,Z,H,et?(nt=F,Q):(nt=Q,F)),ft=vt=Ut.length;Ut[--vt]==0;Ut.pop());if(!Ut[0])return nt.charAt(0);if(It<0?--ft:(pt.c=Ut,pt.e=ft,pt.s=j,pt=k(pt,At,Jt,at,H),Ut=pt.c,ot=pt.r,ft=pt.e),st=ft+Jt+1,It=Ut[st],vt=H/2,ot=ot||st<0||Ut[st+1]!=null,ot=at<4?(It!=null||ot)&&(at==0||at==(pt.s<0?3:2)):It>vt||It==vt&&(at==4||ot||at==6&&Ut[st-1]&1||at==(pt.s<0?8:7)),st<1||!Ut[0])V=ot?D(nt.charAt(1),-Jt,nt.charAt(0)):nt.charAt(0);else{if(Ut.length=st,ot)for(--H;++Ut[--st]>H;)Ut[st]=0,st||(++ft,Ut=[1].concat(Ut));for(vt=Ut.length;!Ut[--vt];);for(It=0,V="";It<=vt;V+=nt.charAt(Ut[It++]));V=D(V,ft,nt.charAt(0))}return V}}(),k=function(){function Q(Z,H,j){var et,nt,st,ft,vt=0,ot=Z.length,pt=H%y,Ut=H/y|0;for(Z=Z.slice();ot--;)st=Z[ot]%y,ft=Z[ot]/y|0,et=Ut*st+ft*pt,nt=pt*st+et%y*y+vt,vt=(nt/j|0)+(et/y|0)+Ut*ft,Z[ot]=nt%j;return vt&&(Z=[vt].concat(Z)),Z}function L(Z,H,j,et){var nt,st;if(j!=et)st=j>et?1:-1;else for(nt=st=0;nt<j;nt++)if(Z[nt]!=H[nt]){st=Z[nt]>H[nt]?1:-1;break}return st}function V(Z,H,j,et){for(var nt=0;j--;)Z[j]-=nt,nt=Z[j]<H[j]?1:0,Z[j]=nt*et+Z[j]-H[j];for(;!Z[0]&&Z.length>1;Z.splice(0,1));}return function(Z,H,j,et,nt){var st,ft,vt,ot,pt,Ut,At,It,Jt,at,J,rt,lt,gt,Dt,ut,Y,tt=Z.s==H.s?1:-1,dt=Z.c,mt=H.c;if(!dt||!dt[0]||!mt||!mt[0])return new W(!Z.s||!H.s||(dt?mt&&dt[0]==mt[0]:!mt)?NaN:dt&&dt[0]==0||!mt?tt*0:tt/0);for(It=new W(tt),Jt=It.c=[],ft=Z.e-H.e,tt=j+ft+1,nt||(nt=v,ft=S(Z.e/o)-S(H.e/o),tt=tt/o|0),vt=0;mt[vt]==(dt[vt]||0);vt++);if(mt[vt]>(dt[vt]||0)&&ft--,tt<0)Jt.push(1),ot=!0;else{for(gt=dt.length,ut=mt.length,vt=0,tt+=2,pt=n(nt/(mt[0]+1)),pt>1&&(mt=Q(mt,pt,nt),dt=Q(dt,pt,nt),ut=mt.length,gt=dt.length),lt=ut,at=dt.slice(0,ut),J=at.length;J<ut;at[J++]=0);Y=mt.slice(),Y=[0].concat(Y),Dt=mt[0],mt[1]>=nt/2&&Dt++;do{if(pt=0,st=L(mt,at,ut,J),st<0){if(rt=at[0],ut!=J&&(rt=rt*nt+(at[1]||0)),pt=n(rt/Dt),pt>1)for(pt>=nt&&(pt=nt-1),Ut=Q(mt,pt,nt),At=Ut.length,J=at.length;L(Ut,at,At,J)==1;)pt--,V(Ut,ut<At?Y:mt,At,nt),At=Ut.length,st=1;else pt==0&&(st=pt=1),Ut=mt.slice(),At=Ut.length;if(At<J&&(Ut=[0].concat(Ut)),V(at,Ut,J,nt),J=at.length,st==-1)for(;L(mt,at,ut,J)<1;)pt++,V(at,ut<J?Y:mt,J,nt),J=at.length}else st===0&&(pt++,at=[0]);Jt[vt++]=pt,at[0]?at[J++]=dt[lt]||0:(at=[dt[lt]],J=1)}while((lt++<gt||at[0]!=null)&&tt--);ot=at[0]!=null,Jt[0]||Jt.splice(0,1)}if(nt==v){for(vt=1,tt=Jt[0];tt>=10;tt/=10,vt++);N(It,j+(It.e=vt+ft*o-1)+1,et,ot)}else It.e=ft,It.r=+ot;return It}}();function $(Q,L,V,Z){var H,j,et,nt,st;if(V==null?V=l:M(V,0,8),!Q.c)return Q.toString();if(H=Q.c[0],et=Q.e,L==null)st=T(Q.c),st=Z==1||Z==2&&(et<=d||et>=p)?P(st,et):D(st,et,"0");else if(Q=N(new W(Q),L,V),j=Q.e,st=T(Q.c),nt=st.length,Z==1||Z==2&&(L<=j||j<=d)){for(;nt<L;st+="0",nt++);st=P(st,j)}else if(L-=et,st=D(st,j,"0"),j+1>nt){if(--L>0)for(st+=".";L--;st+="0");}else if(L+=j-nt,L>0)for(j+1==nt&&(st+=".");L--;st+="0");return Q.s<0&&H?"-"+st:st}function I(Q,L){for(var V,Z,H=1,j=new W(Q[0]);H<Q.length;H++)Z=new W(Q[H]),(!Z.s||(V=B(j,Z))===L||V===0&&j.s===L)&&(j=Z);return j}function K(Q,L,V){for(var Z=1,H=L.length;!L[--H];L.pop());for(H=L[0];H>=10;H/=10,Z++);return(V=Z+V*o-1)>w?Q.c=Q.e=null:V<m?Q.c=[Q.e=0]:(Q.e=V,Q.c=L),Q}O=function(){var Q=/^(-?)0([xbo])(?=\w[\w.]*$)/i,L=/^([^.]+)\.$/,V=/^\.([^.]+)$/,Z=/^-?(Infinity|NaN)$/,H=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(j,et,nt,st){var ft,vt=nt?et:et.replace(H,"");if(Z.test(vt))j.s=isNaN(vt)?null:vt<0?-1:1;else{if(!nt&&(vt=vt.replace(Q,function(ot,pt,Ut){return ft=(Ut=Ut.toLowerCase())=="x"?16:Ut=="b"?2:8,!st||st==ft?pt:ot}),st&&(ft=st,vt=vt.replace(L,"$1").replace(V,"0.$1")),et!=vt))return new W(vt,ft);if(W.DEBUG)throw Error(c+"Not a"+(st?" base "+st:"")+" number: "+et);j.s=null}j.c=j.e=null}}();function N(Q,L,V,Z){var H,j,et,nt,st,ft,vt,ot=Q.c,pt=g;if(ot){t:{for(H=1,nt=ot[0];nt>=10;nt/=10,H++);if(j=L-H,j<0)j+=o,et=L,st=ot[ft=0],vt=n(st/pt[H-et-1]%10);else if(ft=a((j+1)/o),ft>=ot.length)if(Z){for(;ot.length<=ft;ot.push(0));st=vt=0,H=1,j%=o,et=j-o+1}else break t;else{for(st=nt=ot[ft],H=1;nt>=10;nt/=10,H++);j%=o,et=j-o+H,vt=et<0?0:n(st/pt[H-et-1]%10)}if(Z=Z||L<0||ot[ft+1]!=null||(et<0?st:st%pt[H-et-1]),Z=V<4?(vt||Z)&&(V==0||V==(Q.s<0?3:2)):vt>5||vt==5&&(V==4||Z||V==6&&(j>0?et>0?st/pt[H-et]:0:ot[ft-1])%10&1||V==(Q.s<0?8:7)),L<1||!ot[0])return ot.length=0,Z?(L-=Q.e+1,ot[0]=pt[(o-L%o)%o],Q.e=-L||0):ot[0]=Q.e=0,Q;if(j==0?(ot.length=ft,nt=1,ft--):(ot.length=ft+1,nt=pt[o-j],ot[ft]=et>0?n(st/pt[H-et]%pt[et])*nt:0),Z)for(;;)if(ft==0){for(j=1,et=ot[0];et>=10;et/=10,j++);for(et=ot[0]+=nt,nt=1;et>=10;et/=10,nt++);j!=nt&&(Q.e++,ot[0]==v&&(ot[0]=1));break}else{if(ot[ft]+=nt,ot[ft]!=v)break;ot[ft--]=0,nt=1}for(j=ot.length;ot[--j]===0;ot.pop());}Q.e>w?Q.c=Q.e=null:Q.e<m&&(Q.c=[Q.e=0])}return Q}function X(Q){var L,V=Q.e;return V===null?Q.toString():(L=T(Q.c),L=V<=d||V>=p?P(L,V):D(L,V,"0"),Q.s<0?"-"+L:L)}return G.absoluteValue=G.abs=function(){var Q=new W(this);return Q.s<0&&(Q.s=1),Q},G.comparedTo=function(Q,L){return B(this,new W(Q,L))},G.decimalPlaces=G.dp=function(Q,L){var V,Z,H,j=this;if(Q!=null)return M(Q,0,_),L==null?L=l:M(L,0,8),N(new W(j),Q+j.e+1,L);if(!(V=j.c))return null;if(Z=((H=V.length-1)-S(this.e/o))*o,H=V[H])for(;H%10==0;H/=10,Z--);return Z<0&&(Z=0),Z},G.dividedBy=G.div=function(Q,L){return k(this,new W(Q,L),s,l)},G.dividedToIntegerBy=G.idiv=function(Q,L){return k(this,new W(Q,L),0,1)},G.exponentiatedBy=G.pow=function(Q,L){var V,Z,H,j,et,nt,st,ft,vt,ot=this;if(Q=new W(Q),Q.c&&!Q.isInteger())throw Error(c+"Exponent not an integer: "+X(Q));if(L!=null&&(L=new W(L)),nt=Q.e>14,!ot.c||!ot.c[0]||ot.c[0]==1&&!ot.e&&ot.c.length==1||!Q.c||!Q.c[0])return vt=new W(Math.pow(+X(ot),nt?Q.s*(2-R(Q)):+X(Q))),L?vt.mod(L):vt;if(st=Q.s<0,L){if(L.c?!L.c[0]:!L.s)return new W(NaN);Z=!st&&ot.isInteger()&&L.isInteger(),Z&&(ot=ot.mod(L))}else{if(Q.e>9&&(ot.e>0||ot.e<-1||(ot.e==0?ot.c[0]>1||nt&&ot.c[1]>=24e7:ot.c[0]<8e13||nt&&ot.c[0]<=9999975e7)))return j=ot.s<0&&R(Q)?-0:0,ot.e>-1&&(j=1/j),new W(st?1/j:j);f&&(j=a(f/o+2))}for(nt?(V=new W(.5),st&&(Q.s=1),ft=R(Q)):(H=Math.abs(+X(Q)),ft=H%2),vt=new W(E);;){if(ft){if(vt=vt.times(ot),!vt.c)break;j?vt.c.length>j&&(vt.c.length=j):Z&&(vt=vt.mod(L))}if(H){if(H=n(H/2),H===0)break;ft=H%2}else if(Q=Q.times(V),N(Q,Q.e+1,1),Q.e>14)ft=R(Q);else{if(H=+X(Q),H===0)break;ft=H%2}ot=ot.times(ot),j?ot.c&&ot.c.length>j&&(ot.c.length=j):Z&&(ot=ot.mod(L))}return Z?vt:(st&&(vt=E.div(vt)),L?vt.mod(L):j?N(vt,f,l,et):vt)},G.integerValue=function(Q){var L=new W(this);return Q==null?Q=l:M(Q,0,8),N(L,L.e+1,Q)},G.isEqualTo=G.eq=function(Q,L){return B(this,new W(Q,L))===0},G.isFinite=function(){return!!this.c},G.isGreaterThan=G.gt=function(Q,L){return B(this,new W(Q,L))>0},G.isGreaterThanOrEqualTo=G.gte=function(Q,L){return(L=B(this,new W(Q,L)))===1||L===0},G.isInteger=function(){return!!this.c&&S(this.e/o)>this.c.length-2},G.isLessThan=G.lt=function(Q,L){return B(this,new W(Q,L))<0},G.isLessThanOrEqualTo=G.lte=function(Q,L){return(L=B(this,new W(Q,L)))===-1||L===0},G.isNaN=function(){return!this.s},G.isNegative=function(){return this.s<0},G.isPositive=function(){return this.s>0},G.isZero=function(){return!!this.c&&this.c[0]==0},G.minus=function(Q,L){var V,Z,H,j,et=this,nt=et.s;if(Q=new W(Q,L),L=Q.s,!nt||!L)return new W(NaN);if(nt!=L)return Q.s=-L,et.plus(Q);var st=et.e/o,ft=Q.e/o,vt=et.c,ot=Q.c;if(!st||!ft){if(!vt||!ot)return vt?(Q.s=-L,Q):new W(ot?et:NaN);if(!vt[0]||!ot[0])return ot[0]?(Q.s=-L,Q):new W(vt[0]?et:l==3?-0:0)}if(st=S(st),ft=S(ft),vt=vt.slice(),nt=st-ft){for((j=nt<0)?(nt=-nt,H=vt):(ft=st,H=ot),H.reverse(),L=nt;L--;H.push(0));H.reverse()}else for(Z=(j=(nt=vt.length)<(L=ot.length))?nt:L,nt=L=0;L<Z;L++)if(vt[L]!=ot[L]){j=vt[L]<ot[L];break}if(j&&(H=vt,vt=ot,ot=H,Q.s=-Q.s),L=(Z=ot.length)-(V=vt.length),L>0)for(;L--;vt[V++]=0);for(L=v-1;Z>nt;){if(vt[--Z]<ot[Z]){for(V=Z;V&&!vt[--V];vt[V]=L);--vt[V],vt[Z]+=v}vt[Z]-=ot[Z]}for(;vt[0]==0;vt.splice(0,1),--ft);return vt[0]?K(Q,vt,ft):(Q.s=l==3?-1:1,Q.c=[Q.e=0],Q)},G.modulo=G.mod=function(Q,L){var V,Z,H=this;return Q=new W(Q,L),!H.c||!Q.s||Q.c&&!Q.c[0]?new W(NaN):!Q.c||H.c&&!H.c[0]?new W(H):(b==9?(Z=Q.s,Q.s=1,V=k(H,Q,0,3),Q.s=Z,V.s*=Z):V=k(H,Q,0,b),Q=H.minus(V.times(Q)),!Q.c[0]&&b==1&&(Q.s=H.s),Q)},G.multipliedBy=G.times=function(Q,L){var V,Z,H,j,et,nt,st,ft,vt,ot,pt,Ut,At,It,Jt,at=this,J=at.c,rt=(Q=new W(Q,L)).c;if(!J||!rt||!J[0]||!rt[0])return!at.s||!Q.s||J&&!J[0]&&!rt||rt&&!rt[0]&&!J?Q.c=Q.e=Q.s=null:(Q.s*=at.s,!J||!rt?Q.c=Q.e=null:(Q.c=[0],Q.e=0)),Q;for(Z=S(at.e/o)+S(Q.e/o),Q.s*=at.s,st=J.length,ot=rt.length,st<ot&&(At=J,J=rt,rt=At,H=st,st=ot,ot=H),H=st+ot,At=[];H--;At.push(0));for(It=v,Jt=y,H=ot;--H>=0;){for(V=0,pt=rt[H]%Jt,Ut=rt[H]/Jt|0,et=st,j=H+et;j>H;)ft=J[--et]%Jt,vt=J[et]/Jt|0,nt=Ut*ft+vt*pt,ft=pt*ft+nt%Jt*Jt+At[j]+V,V=(ft/It|0)+(nt/Jt|0)+Ut*vt,At[j--]=ft%It;At[j]=V}return V?++Z:At.splice(0,1),K(Q,At,Z)},G.negated=function(){var Q=new W(this);return Q.s=-Q.s||null,Q},G.plus=function(Q,L){var V,Z=this,H=Z.s;if(Q=new W(Q,L),L=Q.s,!H||!L)return new W(NaN);if(H!=L)return Q.s=-L,Z.minus(Q);var j=Z.e/o,et=Q.e/o,nt=Z.c,st=Q.c;if(!j||!et){if(!nt||!st)return new W(H/0);if(!nt[0]||!st[0])return st[0]?Q:new W(nt[0]?Z:H*0)}if(j=S(j),et=S(et),nt=nt.slice(),H=j-et){for(H>0?(et=j,V=st):(H=-H,V=nt),V.reverse();H--;V.push(0));V.reverse()}for(H=nt.length,L=st.length,H-L<0&&(V=st,st=nt,nt=V,L=H),H=0;L;)H=(nt[--L]=nt[L]+st[L]+H)/v|0,nt[L]=v===nt[L]?0:nt[L]%v;return H&&(nt=[H].concat(nt),++et),K(Q,nt,et)},G.precision=G.sd=function(Q,L){var V,Z,H,j=this;if(Q!=null&&Q!==!!Q)return M(Q,1,_),L==null?L=l:M(L,0,8),N(new W(j),Q,L);if(!(V=j.c))return null;if(H=V.length-1,Z=H*o+1,H=V[H]){for(;H%10==0;H/=10,Z--);for(H=V[0];H>=10;H/=10,Z++);}return Q&&j.e+1>Z&&(Z=j.e+1),Z},G.shiftedBy=function(Q){return M(Q,-h,h),this.times("1e"+Q)},G.squareRoot=G.sqrt=function(){var Q,L,V,Z,H,j=this,et=j.c,nt=j.s,st=j.e,ft=s+4,vt=new W("0.5");if(nt!==1||!et||!et[0])return new W(!nt||nt<0&&(!et||et[0])?NaN:et?j:1/0);if(nt=Math.sqrt(+X(j)),nt==0||nt==1/0?(L=T(et),(L.length+st)%2==0&&(L+="0"),nt=Math.sqrt(+L),st=S((st+1)/2)-(st<0||st%2),nt==1/0?L="5e"+st:(L=nt.toExponential(),L=L.slice(0,L.indexOf("e")+1)+st),V=new W(L)):V=new W(nt+""),V.c[0]){for(st=V.e,nt=st+ft,nt<3&&(nt=0);;)if(H=V,V=vt.times(H.plus(k(j,H,ft,1))),T(H.c).slice(0,nt)===(L=T(V.c)).slice(0,nt))if(V.e<st&&--nt,L=L.slice(nt-3,nt+1),L=="9999"||!Z&&L=="4999"){if(!Z&&(N(H,H.e+s+2,0),H.times(H).eq(j))){V=H;break}ft+=4,nt+=4,Z=1}else{(!+L||!+L.slice(1)&&L.charAt(0)=="5")&&(N(V,V.e+s+2,1),Q=!V.times(V).eq(j));break}}return N(V,V.e+s+1,l,Q)},G.toExponential=function(Q,L){return Q!=null&&(M(Q,0,_),Q++),$(this,Q,L,1)},G.toFixed=function(Q,L){return Q!=null&&(M(Q,0,_),Q=Q+this.e+1),$(this,Q,L)},G.toFormat=function(Q,L,V){var Z,H=this;if(V==null)Q!=null&&L&&typeof L=="object"?(V=L,L=null):Q&&typeof Q=="object"?(V=Q,Q=L=null):V=C;else if(typeof V!="object")throw Error(c+"Argument not an object: "+V);if(Z=H.toFixed(Q,L),H.c){var j,et=Z.split("."),nt=+V.groupSize,st=+V.secondaryGroupSize,ft=V.groupSeparator||"",vt=et[0],ot=et[1],pt=H.s<0,Ut=pt?vt.slice(1):vt,At=Ut.length;if(st&&(j=nt,nt=st,st=j,At-=j),nt>0&&At>0){for(j=At%nt||nt,vt=Ut.substr(0,j);j<At;j+=nt)vt+=ft+Ut.substr(j,nt);st>0&&(vt+=ft+Ut.slice(j)),pt&&(vt="-"+vt)}Z=ot?vt+(V.decimalSeparator||"")+((st=+V.fractionGroupSize)?ot.replace(new RegExp("\\d{"+st+"}\\B","g"),"$&"+(V.fractionGroupSeparator||"")):ot):vt}return(V.prefix||"")+Z+(V.suffix||"")},G.toFraction=function(Q){var L,V,Z,H,j,et,nt,st,ft,vt,ot,pt,Ut=this,At=Ut.c;if(Q!=null&&(nt=new W(Q),!nt.isInteger()&&(nt.c||nt.s!==1)||nt.lt(E)))throw Error(c+"Argument "+(nt.isInteger()?"out of range: ":"not an integer: ")+X(nt));if(!At)return new W(Ut);for(L=new W(E),ft=V=new W(E),Z=st=new W(E),pt=T(At),j=L.e=pt.length-Ut.e-1,L.c[0]=g[(et=j%o)<0?o+et:et],Q=!Q||nt.comparedTo(L)>0?j>0?L:ft:nt,et=w,w=1/0,nt=new W(pt),st.c[0]=0;vt=k(nt,L,0,1),H=V.plus(vt.times(Z)),H.comparedTo(Q)!=1;)V=Z,Z=H,ft=st.plus(vt.times(H=ft)),st=H,L=nt.minus(vt.times(H=L)),nt=H;return H=k(Q.minus(V),Z,0,1),st=st.plus(H.times(ft)),V=V.plus(H.times(Z)),st.s=ft.s=Ut.s,j=j*2,ot=k(ft,Z,j,l).minus(Ut).abs().comparedTo(k(st,V,j,l).minus(Ut).abs())<1?[ft,Z]:[st,V],w=et,ot},G.toNumber=function(){return+X(this)},G.toPrecision=function(Q,L){return Q!=null&&M(Q,1,_),$(this,Q,L,2)},G.toString=function(Q){var L,V=this,Z=V.s,H=V.e;return H===null?Z?(L="Infinity",Z<0&&(L="-"+L)):L="NaN":(Q==null?L=H<=d||H>=p?P(T(V.c),H):D(T(V.c),H,"0"):Q===10&&z?(V=N(new W(V),s+H+1,l),L=D(T(V.c),V.e,"0")):(M(Q,2,F.length,"Base"),L=U(D(T(V.c),H,"0"),10,Q,Z,!0)),Z<0&&V.c[0]&&(L="-"+L)),L},G.valueOf=G.toJSON=function(){return X(this)},G._isBigNumber=!0,q!=null&&W.set(q),W}function S(q){var k=q|0;return q>0||q===k?k:k-1}function T(q){for(var k,U,O=1,G=q.length,E=q[0]+"";O<G;){for(k=q[O++]+"",U=o-k.length;U--;k="0"+k);E+=k}for(G=E.length;E.charCodeAt(--G)===48;);return E.slice(0,G+1||1)}function B(q,k){var U,O,G=q.c,E=k.c,s=q.s,l=k.s,d=q.e,p=k.e;if(!s||!l)return null;if(U=G&&!G[0],O=E&&!E[0],U||O)return U?O?0:-l:s;if(s!=l)return s;if(U=s<0,O=d==p,!G||!E)return O?0:!G^U?1:-1;if(!O)return d>p^U?1:-1;for(l=(d=G.length)<(p=E.length)?d:p,s=0;s<l;s++)if(G[s]!=E[s])return G[s]>E[s]^U?1:-1;return d==p?0:d>p^U?1:-1}function M(q,k,U,O){if(q<k||q>U||q!==n(q))throw Error(c+(O||"Argument")+(typeof q=="number"?q<k||q>U?" out of range: ":" not an integer: ":" not a primitive number: ")+String(q))}function R(q){var k=q.c.length-1;return S(q.e/o)==k&&q.c[k]%2!=0}function P(q,k){return(q.length>1?q.charAt(0)+"."+q.slice(1):q)+(k<0?"e":"e+")+k}function D(q,k,U){var O,G;if(k<0){for(G=U+".";++k;G+=U);q=G+q}else if(O=q.length,++k>O){for(G=U,k-=O;--k;G+=U);q+=G}else k<O&&(q=q.slice(0,k)+"."+q.slice(k));return q}r=A(),r.default=r.BigNumber=r,i.exports?i.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(di)})(I6);var M6=I6.exports;(function(i){var e=M6,r=i.exports;(function(){var t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a,n,c={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},u;function v(h){return t.lastIndex=0,t.test(h)?'"'+h.replace(t,function(g){var y=c[g];return typeof y=="string"?y:"\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+h+'"'}function o(h,g){var y,_,A,S,T=a,B,M=g[h],R=M!=null&&(M instanceof e||e.isBigNumber(M));switch(M&&typeof M=="object"&&typeof M.toJSON=="function"&&(M=M.toJSON(h)),typeof u=="function"&&(M=u.call(g,h,M)),typeof M){case"string":return R?M:v(M);case"number":return isFinite(M)?String(M):"null";case"boolean":case"null":case"bigint":return String(M);case"object":if(!M)return"null";if(a+=n,B=[],Object.prototype.toString.apply(M)==="[object Array]"){for(S=M.length,y=0;y<S;y+=1)B[y]=o(y,M)||"null";return A=B.length===0?"[]":a?`[
`+a+B.join(`,
`+a)+`
`+T+"]":"["+B.join(",")+"]",a=T,A}if(u&&typeof u=="object")for(S=u.length,y=0;y<S;y+=1)typeof u[y]=="string"&&(_=u[y],A=o(_,M),A&&B.push(v(_)+(a?": ":":")+A));else Object.keys(M).forEach(function(P){var D=o(P,M);D&&B.push(v(P)+(a?": ":":")+D)});return A=B.length===0?"{}":a?`{
`+a+B.join(`,
`+a)+`
`+T+"}":"{"+B.join(",")+"}",a=T,A}}typeof r.stringify!="function"&&(r.stringify=function(h,g,y){var _;if(a="",n="",typeof y=="number")for(_=0;_<y;_+=1)n+=" ";else typeof y=="string"&&(n=y);if(u=g,g&&typeof g!="function"&&(typeof g!="object"||typeof g.length!="number"))throw new Error("JSON.stringify");return o("",{"":h})})})()})(x6);var _S=x6.exports,Lf=null;const wS=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,CS=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;var ES=function(i){var e={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(i!=null){if(i.strict===!0&&(e.strict=!0),i.storeAsString===!0&&(e.storeAsString=!0),e.alwaysParseAsBig=i.alwaysParseAsBig===!0?i.alwaysParseAsBig:!1,e.useNativeBigInt=i.useNativeBigInt===!0?i.useNativeBigInt:!1,typeof i.constructorAction<"u")if(i.constructorAction==="error"||i.constructorAction==="ignore"||i.constructorAction==="preserve")e.constructorAction=i.constructorAction;else throw new Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${i.constructorAction}`);if(typeof i.protoAction<"u")if(i.protoAction==="error"||i.protoAction==="ignore"||i.protoAction==="preserve")e.protoAction=i.protoAction;else throw new Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${i.protoAction}`)}var r,t,a={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},n,c=function(S){throw{name:"SyntaxError",message:S,at:r,text:n}},u=function(S){return S&&S!==t&&c("Expected '"+S+"' instead of '"+t+"'"),t=n.charAt(r),r+=1,t},v=function(){var S,T="";for(t==="-"&&(T="-",u("-"));t>="0"&&t<="9";)T+=t,u();if(t===".")for(T+=".";u()&&t>="0"&&t<="9";)T+=t;if(t==="e"||t==="E")for(T+=t,u(),(t==="-"||t==="+")&&(T+=t,u());t>="0"&&t<="9";)T+=t,u();if(S=+T,!isFinite(S))c("Bad number");else return Lf==null&&(Lf=M6),T.length>15?e.storeAsString?T:e.useNativeBigInt?BigInt(T):new Lf(T):e.alwaysParseAsBig?e.useNativeBigInt?BigInt(S):new Lf(S):S},o=function(){var S,T,B="",M;if(t==='"')for(var R=r;u();){if(t==='"')return r-1>R&&(B+=n.substring(R,r-1)),u(),B;if(t==="\\"){if(r-1>R&&(B+=n.substring(R,r-1)),u(),t==="u"){for(M=0,T=0;T<4&&(S=parseInt(u(),16),!!isFinite(S));T+=1)M=M*16+S;B+=String.fromCharCode(M)}else if(typeof a[t]=="string")B+=a[t];else break;R=r}}c("Bad string")},h=function(){for(;t&&t<=" ";)u()},g=function(){switch(t){case"t":return u("t"),u("r"),u("u"),u("e"),!0;case"f":return u("f"),u("a"),u("l"),u("s"),u("e"),!1;case"n":return u("n"),u("u"),u("l"),u("l"),null}c("Unexpected '"+t+"'")},y,_=function(){var S=[];if(t==="["){if(u("["),h(),t==="]")return u("]"),S;for(;t;){if(S.push(y()),h(),t==="]")return u("]"),S;u(","),h()}}c("Bad array")},A=function(){var S,T=Object.create(null);if(t==="{"){if(u("{"),h(),t==="}")return u("}"),T;for(;t;){if(S=o(),h(),u(":"),e.strict===!0&&Object.hasOwnProperty.call(T,S)&&c('Duplicate key "'+S+'"'),wS.test(S)===!0?e.protoAction==="error"?c("Object contains forbidden prototype property"):e.protoAction==="ignore"?y():T[S]=y():CS.test(S)===!0?e.constructorAction==="error"?c("Object contains forbidden constructor property"):e.constructorAction==="ignore"?y():T[S]=y():T[S]=y(),h(),t==="}")return u("}"),T;u(","),h()}}c("Bad object")};return y=function(){switch(h(),t){case"{":return A();case"[":return _();case'"':return o();case"-":return v();default:return t>="0"&&t<="9"?v():g()}},function(S,T){var B;return n=S+"",r=0,t=" ",B=y(),h(),t&&c("Syntax error"),typeof T=="function"?function M(R,P){var D,q=R[P];return q&&typeof q=="object"&&Object.keys(q).forEach(function(k){D=M(q,k),D!==void 0?q[k]=D:delete q[k]}),T.call(R,P,q)}({"":B},""):B}},AS=ES,B6=_S.stringify,L6=AS;Wl.exports=function(i){return{parse:L6(i),stringify:B6}};Wl.exports.parse=L6();Wl.exports.stringify=B6;var SS=Wl.exports,T6={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(i,e){(function(r){i.exports=r()})(function(){return function r(t,a,n){function c(o,h){if(!a[o]){if(!t[o]){var g=typeof ao=="function"&&ao;if(!h&&g)return g(o,!0);if(u)return u(o,!0);var y=new Error("Cannot find module '"+o+"'");throw y.code="MODULE_NOT_FOUND",y}var _=a[o]={exports:{}};t[o][0].call(_.exports,function(A){var S=t[o][1][A];return c(S||A)},_,_.exports,r,t,a,n)}return a[o].exports}for(var u=typeof ao=="function"&&ao,v=0;v<n.length;v++)c(n[v]);return c}({1:[function(r,t,a){(function(n){var c=n.MutationObserver||n.WebKitMutationObserver,u;if(c){var v=0,o=new c(A),h=n.document.createTextNode("");o.observe(h,{characterData:!0}),u=function(){h.data=v=++v%2}}else if(!n.setImmediate&&typeof n.MessageChannel<"u"){var g=new n.MessageChannel;g.port1.onmessage=A,u=function(){g.port2.postMessage(0)}}else"document"in n&&"onreadystatechange"in n.document.createElement("script")?u=function(){var T=n.document.createElement("script");T.onreadystatechange=function(){A(),T.onreadystatechange=null,T.parentNode.removeChild(T),T=null},n.document.documentElement.appendChild(T)}:u=function(){setTimeout(A,0)};var y,_=[];function A(){y=!0;for(var T,B,M=_.length;M;){for(B=_,_=[],T=-1;++T<M;)B[T]();M=_.length}y=!1}t.exports=S;function S(T){_.push(T)===1&&!y&&u()}}).call(this,typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(r,t,a){var n=r(1);function c(){}var u={},v=["REJECTED"],o=["FULFILLED"],h=["PENDING"];t.exports=g;function g(D){if(typeof D!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,D!==c&&S(this,D)}g.prototype.catch=function(D){return this.then(null,D)},g.prototype.then=function(D,q){if(typeof D!="function"&&this.state===o||typeof q!="function"&&this.state===v)return this;var k=new this.constructor(c);if(this.state!==h){var U=this.state===o?D:q;_(k,U,this.outcome)}else this.queue.push(new y(k,D,q));return k};function y(D,q,k){this.promise=D,typeof q=="function"&&(this.onFulfilled=q,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}y.prototype.callFulfilled=function(D){u.resolve(this.promise,D)},y.prototype.otherCallFulfilled=function(D){_(this.promise,this.onFulfilled,D)},y.prototype.callRejected=function(D){u.reject(this.promise,D)},y.prototype.otherCallRejected=function(D){_(this.promise,this.onRejected,D)};function _(D,q,k){n(function(){var U;try{U=q(k)}catch(O){return u.reject(D,O)}U===D?u.reject(D,new TypeError("Cannot resolve promise with itself")):u.resolve(D,U)})}u.resolve=function(D,q){var k=T(A,q);if(k.status==="error")return u.reject(D,k.value);var U=k.value;if(U)S(D,U);else{D.state=o,D.outcome=q;for(var O=-1,G=D.queue.length;++O<G;)D.queue[O].callFulfilled(q)}return D},u.reject=function(D,q){D.state=v,D.outcome=q;for(var k=-1,U=D.queue.length;++k<U;)D.queue[k].callRejected(q);return D};function A(D){var q=D&&D.then;if(D&&(typeof D=="object"||typeof D=="function")&&typeof q=="function")return function(){q.apply(D,arguments)}}function S(D,q){var k=!1;function U(s){k||(k=!0,u.reject(D,s))}function O(s){k||(k=!0,u.resolve(D,s))}function G(){q(O,U)}var E=T(G);E.status==="error"&&U(E.value)}function T(D,q){var k={};try{k.value=D(q),k.status="success"}catch(U){k.status="error",k.value=U}return k}g.resolve=B;function B(D){return D instanceof this?D:u.resolve(new this(c),D)}g.reject=M;function M(D){var q=new this(c);return u.reject(q,D)}g.all=R;function R(D){var q=this;if(Object.prototype.toString.call(D)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=D.length,U=!1;if(!k)return this.resolve([]);for(var O=new Array(k),G=0,E=-1,s=new this(c);++E<k;)l(D[E],E);return s;function l(d,p){q.resolve(d).then(m,function(w){U||(U=!0,u.reject(s,w))});function m(w){O[p]=w,++G===k&&!U&&(U=!0,u.resolve(s,O))}}}g.race=P;function P(D){var q=this;if(Object.prototype.toString.call(D)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=D.length,U=!1;if(!k)return this.resolve([]);for(var O=-1,G=new this(c);++O<k;)E(D[O]);return G;function E(s){q.resolve(s).then(function(l){U||(U=!0,u.resolve(G,l))},function(l){U||(U=!0,u.reject(G,l))})}}},{1:1}],3:[function(r,t,a){(function(n){typeof n.Promise!="function"&&(n.Promise=r(2))}).call(this,typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(r,t,a){var n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(it){return typeof it}:function(it){return it&&typeof Symbol=="function"&&it.constructor===Symbol&&it!==Symbol.prototype?"symbol":typeof it};function c(it,ct){if(!(it instanceof ct))throw new TypeError("Cannot call a class as a function")}function u(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var v=u();function o(){try{if(!v||!v.open)return!1;var it=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),ct=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!it||ct)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function h(it,ct){it=it||[],ct=ct||{};try{return new Blob(it,ct)}catch(Pt){if(Pt.name!=="TypeError")throw Pt;for(var ht=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,Tt=new ht,Nt=0;Nt<it.length;Nt+=1)Tt.append(it[Nt]);return Tt.getBlob(ct.type)}}typeof Promise>"u"&&r(3);var g=Promise;function y(it,ct){ct&&it.then(function(ht){ct(null,ht)},function(ht){ct(ht)})}function _(it,ct,ht){typeof ct=="function"&&it.then(ct),typeof ht=="function"&&it.catch(ht)}function A(it){return typeof it!="string"&&(console.warn(it+" used as a key, but it is not a string."),it=String(it)),it}function S(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var T="local-forage-detect-blob-support",B=void 0,M={},R=Object.prototype.toString,P="readonly",D="readwrite";function q(it){for(var ct=it.length,ht=new ArrayBuffer(ct),Tt=new Uint8Array(ht),Nt=0;Nt<ct;Nt++)Tt[Nt]=it.charCodeAt(Nt);return ht}function k(it){return new g(function(ct){var ht=it.transaction(T,D),Tt=h([""]);ht.objectStore(T).put(Tt,"key"),ht.onabort=function(Nt){Nt.preventDefault(),Nt.stopPropagation(),ct(!1)},ht.oncomplete=function(){var Nt=navigator.userAgent.match(/Chrome\/(\d+)/),Pt=navigator.userAgent.match(/Edge\//);ct(Pt||!Nt||parseInt(Nt[1],10)>=43)}}).catch(function(){return!1})}function U(it){return typeof B=="boolean"?g.resolve(B):k(it).then(function(ct){return B=ct,B})}function O(it){var ct=M[it.name],ht={};ht.promise=new g(function(Tt,Nt){ht.resolve=Tt,ht.reject=Nt}),ct.deferredOperations.push(ht),ct.dbReady?ct.dbReady=ct.dbReady.then(function(){return ht.promise}):ct.dbReady=ht.promise}function G(it){var ct=M[it.name],ht=ct.deferredOperations.pop();if(ht)return ht.resolve(),ht.promise}function E(it,ct){var ht=M[it.name],Tt=ht.deferredOperations.pop();if(Tt)return Tt.reject(ct),Tt.promise}function s(it,ct){return new g(function(ht,Tt){if(M[it.name]=M[it.name]||F(),it.db)if(ct)O(it),it.db.close();else return ht(it.db);var Nt=[it.name];ct&&Nt.push(it.version);var Pt=v.open.apply(v,Nt);ct&&(Pt.onupgradeneeded=function(Yt){var ne=Pt.result;try{ne.createObjectStore(it.storeName),Yt.oldVersion<=1&&ne.createObjectStore(T)}catch(se){if(se.name==="ConstraintError")console.warn('The database "'+it.name+'" has been upgraded from version '+Yt.oldVersion+" to version "+Yt.newVersion+', but the storage "'+it.storeName+'" already exists.');else throw se}}),Pt.onerror=function(Yt){Yt.preventDefault(),Tt(Pt.error)},Pt.onsuccess=function(){var Yt=Pt.result;Yt.onversionchange=function(ne){ne.target.close()},ht(Yt),G(it)}})}function l(it){return s(it,!1)}function d(it){return s(it,!0)}function p(it,ct){if(!it.db)return!0;var ht=!it.db.objectStoreNames.contains(it.storeName),Tt=it.version<it.db.version,Nt=it.version>it.db.version;if(Tt&&(it.version!==ct&&console.warn('The database "'+it.name+`" can't be downgraded from version `+it.db.version+" to version "+it.version+"."),it.version=it.db.version),Nt||ht){if(ht){var Pt=it.db.version+1;Pt>it.version&&(it.version=Pt)}return!0}return!1}function m(it){return new g(function(ct,ht){var Tt=new FileReader;Tt.onerror=ht,Tt.onloadend=function(Nt){var Pt=btoa(Nt.target.result||"");ct({__local_forage_encoded_blob:!0,data:Pt,type:it.type})},Tt.readAsBinaryString(it)})}function w(it){var ct=q(atob(it.data));return h([ct],{type:it.type})}function x(it){return it&&it.__local_forage_encoded_blob}function b(it){var ct=this,ht=ct._initReady().then(function(){var Tt=M[ct._dbInfo.name];if(Tt&&Tt.dbReady)return Tt.dbReady});return _(ht,it,it),ht}function f(it){O(it);for(var ct=M[it.name],ht=ct.forages,Tt=0;Tt<ht.length;Tt++){var Nt=ht[Tt];Nt._dbInfo.db&&(Nt._dbInfo.db.close(),Nt._dbInfo.db=null)}return it.db=null,l(it).then(function(Pt){return it.db=Pt,p(it)?d(it):Pt}).then(function(Pt){it.db=ct.db=Pt;for(var Yt=0;Yt<ht.length;Yt++)ht[Yt]._dbInfo.db=Pt}).catch(function(Pt){throw E(it,Pt),Pt})}function C(it,ct,ht,Tt){Tt===void 0&&(Tt=1);try{var Nt=it.db.transaction(it.storeName,ct);ht(null,Nt)}catch(Pt){if(Tt>0&&(!it.db||Pt.name==="InvalidStateError"||Pt.name==="NotFoundError"))return g.resolve().then(function(){if(!it.db||Pt.name==="NotFoundError"&&!it.db.objectStoreNames.contains(it.storeName)&&it.version<=it.db.version)return it.db&&(it.version=it.db.version+1),d(it)}).then(function(){return f(it).then(function(){C(it,ct,ht,Tt-1)})}).catch(ht);ht(Pt)}}function F(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function z(it){var ct=this,ht={db:null};if(it)for(var Tt in it)ht[Tt]=it[Tt];var Nt=M[ht.name];Nt||(Nt=F(),M[ht.name]=Nt),Nt.forages.push(ct),ct._initReady||(ct._initReady=ct.ready,ct.ready=b);var Pt=[];function Yt(){return g.resolve()}for(var ne=0;ne<Nt.forages.length;ne++){var se=Nt.forages[ne];se!==ct&&Pt.push(se._initReady().catch(Yt))}var le=Nt.forages.slice(0);return g.all(Pt).then(function(){return ht.db=Nt.db,l(ht)}).then(function(ue){return ht.db=ue,p(ht,ct._defaultConfig.version)?d(ht):ue}).then(function(ue){ht.db=Nt.db=ue,ct._dbInfo=ht;for(var we=0;we<le.length;we++){var Ke=le[we];Ke!==ct&&(Ke._dbInfo.db=ht.db,Ke._dbInfo.version=ht.version)}})}function W(it,ct){var ht=this;it=A(it);var Tt=new g(function(Nt,Pt){ht.ready().then(function(){C(ht._dbInfo,P,function(Yt,ne){if(Yt)return Pt(Yt);try{var se=ne.objectStore(ht._dbInfo.storeName),le=se.get(it);le.onsuccess=function(){var ue=le.result;ue===void 0&&(ue=null),x(ue)&&(ue=w(ue)),Nt(ue)},le.onerror=function(){Pt(le.error)}}catch(ue){Pt(ue)}})}).catch(Pt)});return y(Tt,ct),Tt}function $(it,ct){var ht=this,Tt=new g(function(Nt,Pt){ht.ready().then(function(){C(ht._dbInfo,P,function(Yt,ne){if(Yt)return Pt(Yt);try{var se=ne.objectStore(ht._dbInfo.storeName),le=se.openCursor(),ue=1;le.onsuccess=function(){var we=le.result;if(we){var Ke=we.value;x(Ke)&&(Ke=w(Ke));var $e=it(Ke,we.key,ue++);$e!==void 0?Nt($e):we.continue()}else Nt()},le.onerror=function(){Pt(le.error)}}catch(we){Pt(we)}})}).catch(Pt)});return y(Tt,ct),Tt}function I(it,ct,ht){var Tt=this;it=A(it);var Nt=new g(function(Pt,Yt){var ne;Tt.ready().then(function(){return ne=Tt._dbInfo,R.call(ct)==="[object Blob]"?U(ne.db).then(function(se){return se?ct:m(ct)}):ct}).then(function(se){C(Tt._dbInfo,D,function(le,ue){if(le)return Yt(le);try{var we=ue.objectStore(Tt._dbInfo.storeName);se===null&&(se=void 0);var Ke=we.put(se,it);ue.oncomplete=function(){se===void 0&&(se=null),Pt(se)},ue.onabort=ue.onerror=function(){var $e=Ke.error?Ke.error:Ke.transaction.error;Yt($e)}}catch($e){Yt($e)}})}).catch(Yt)});return y(Nt,ht),Nt}function K(it,ct){var ht=this;it=A(it);var Tt=new g(function(Nt,Pt){ht.ready().then(function(){C(ht._dbInfo,D,function(Yt,ne){if(Yt)return Pt(Yt);try{var se=ne.objectStore(ht._dbInfo.storeName),le=se.delete(it);ne.oncomplete=function(){Nt()},ne.onerror=function(){Pt(le.error)},ne.onabort=function(){var ue=le.error?le.error:le.transaction.error;Pt(ue)}}catch(ue){Pt(ue)}})}).catch(Pt)});return y(Tt,ct),Tt}function N(it){var ct=this,ht=new g(function(Tt,Nt){ct.ready().then(function(){C(ct._dbInfo,D,function(Pt,Yt){if(Pt)return Nt(Pt);try{var ne=Yt.objectStore(ct._dbInfo.storeName),se=ne.clear();Yt.oncomplete=function(){Tt()},Yt.onabort=Yt.onerror=function(){var le=se.error?se.error:se.transaction.error;Nt(le)}}catch(le){Nt(le)}})}).catch(Nt)});return y(ht,it),ht}function X(it){var ct=this,ht=new g(function(Tt,Nt){ct.ready().then(function(){C(ct._dbInfo,P,function(Pt,Yt){if(Pt)return Nt(Pt);try{var ne=Yt.objectStore(ct._dbInfo.storeName),se=ne.count();se.onsuccess=function(){Tt(se.result)},se.onerror=function(){Nt(se.error)}}catch(le){Nt(le)}})}).catch(Nt)});return y(ht,it),ht}function Q(it,ct){var ht=this,Tt=new g(function(Nt,Pt){if(it<0){Nt(null);return}ht.ready().then(function(){C(ht._dbInfo,P,function(Yt,ne){if(Yt)return Pt(Yt);try{var se=ne.objectStore(ht._dbInfo.storeName),le=!1,ue=se.openKeyCursor();ue.onsuccess=function(){var we=ue.result;if(!we){Nt(null);return}it===0||le?Nt(we.key):(le=!0,we.advance(it))},ue.onerror=function(){Pt(ue.error)}}catch(we){Pt(we)}})}).catch(Pt)});return y(Tt,ct),Tt}function L(it){var ct=this,ht=new g(function(Tt,Nt){ct.ready().then(function(){C(ct._dbInfo,P,function(Pt,Yt){if(Pt)return Nt(Pt);try{var ne=Yt.objectStore(ct._dbInfo.storeName),se=ne.openKeyCursor(),le=[];se.onsuccess=function(){var ue=se.result;if(!ue){Tt(le);return}le.push(ue.key),ue.continue()},se.onerror=function(){Nt(se.error)}}catch(ue){Nt(ue)}})}).catch(Nt)});return y(ht,it),ht}function V(it,ct){ct=S.apply(this,arguments);var ht=this.config();it=typeof it!="function"&&it||{},it.name||(it.name=it.name||ht.name,it.storeName=it.storeName||ht.storeName);var Tt=this,Nt;if(!it.name)Nt=g.reject("Invalid arguments");else{var Pt=it.name===ht.name&&Tt._dbInfo.db,Yt=Pt?g.resolve(Tt._dbInfo.db):l(it).then(function(ne){var se=M[it.name],le=se.forages;se.db=ne;for(var ue=0;ue<le.length;ue++)le[ue]._dbInfo.db=ne;return ne});it.storeName?Nt=Yt.then(function(ne){if(ne.objectStoreNames.contains(it.storeName)){var se=ne.version+1;O(it);var le=M[it.name],ue=le.forages;ne.close();for(var we=0;we<ue.length;we++){var Ke=ue[we];Ke._dbInfo.db=null,Ke._dbInfo.version=se}var $e=new g(function(je,Lr){var Er=v.open(it.name,se);Er.onerror=function(ii){var Qs=Er.result;Qs.close(),Lr(ii)},Er.onupgradeneeded=function(){var ii=Er.result;ii.deleteObjectStore(it.storeName)},Er.onsuccess=function(){var ii=Er.result;ii.close(),je(ii)}});return $e.then(function(je){le.db=je;for(var Lr=0;Lr<ue.length;Lr++){var Er=ue[Lr];Er._dbInfo.db=je,G(Er._dbInfo)}}).catch(function(je){throw(E(it,je)||g.resolve()).catch(function(){}),je})}}):Nt=Yt.then(function(ne){O(it);var se=M[it.name],le=se.forages;ne.close();for(var ue=0;ue<le.length;ue++){var we=le[ue];we._dbInfo.db=null}var Ke=new g(function($e,je){var Lr=v.deleteDatabase(it.name);Lr.onerror=function(){var Er=Lr.result;Er&&Er.close(),je(Lr.error)},Lr.onblocked=function(){console.warn('dropInstance blocked for database "'+it.name+'" until all open connections are closed')},Lr.onsuccess=function(){var Er=Lr.result;Er&&Er.close(),$e(Er)}});return Ke.then(function($e){se.db=$e;for(var je=0;je<le.length;je++){var Lr=le[je];G(Lr._dbInfo)}}).catch(function($e){throw(E(it,$e)||g.resolve()).catch(function(){}),$e})})}return y(Nt,ct),Nt}var Z={_driver:"asyncStorage",_initStorage:z,_support:o(),iterate:$,getItem:W,setItem:I,removeItem:K,clear:N,length:X,key:Q,keys:L,dropInstance:V};function H(){return typeof openDatabase=="function"}var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",et="~~local_forage_type~",nt=/^~~local_forage_type~([^~]+)~/,st="__lfsc__:",ft=st.length,vt="arbf",ot="blob",pt="si08",Ut="ui08",At="uic8",It="si16",Jt="si32",at="ur16",J="ui32",rt="fl32",lt="fl64",gt=ft+vt.length,Dt=Object.prototype.toString;function ut(it){var ct=it.length*.75,ht=it.length,Tt,Nt=0,Pt,Yt,ne,se;it[it.length-1]==="="&&(ct--,it[it.length-2]==="="&&ct--);var le=new ArrayBuffer(ct),ue=new Uint8Array(le);for(Tt=0;Tt<ht;Tt+=4)Pt=j.indexOf(it[Tt]),Yt=j.indexOf(it[Tt+1]),ne=j.indexOf(it[Tt+2]),se=j.indexOf(it[Tt+3]),ue[Nt++]=Pt<<2|Yt>>4,ue[Nt++]=(Yt&15)<<4|ne>>2,ue[Nt++]=(ne&3)<<6|se&63;return le}function Y(it){var ct=new Uint8Array(it),ht="",Tt;for(Tt=0;Tt<ct.length;Tt+=3)ht+=j[ct[Tt]>>2],ht+=j[(ct[Tt]&3)<<4|ct[Tt+1]>>4],ht+=j[(ct[Tt+1]&15)<<2|ct[Tt+2]>>6],ht+=j[ct[Tt+2]&63];return ct.length%3===2?ht=ht.substring(0,ht.length-1)+"=":ct.length%3===1&&(ht=ht.substring(0,ht.length-2)+"=="),ht}function tt(it,ct){var ht="";if(it&&(ht=Dt.call(it)),it&&(ht==="[object ArrayBuffer]"||it.buffer&&Dt.call(it.buffer)==="[object ArrayBuffer]")){var Tt,Nt=st;it instanceof ArrayBuffer?(Tt=it,Nt+=vt):(Tt=it.buffer,ht==="[object Int8Array]"?Nt+=pt:ht==="[object Uint8Array]"?Nt+=Ut:ht==="[object Uint8ClampedArray]"?Nt+=At:ht==="[object Int16Array]"?Nt+=It:ht==="[object Uint16Array]"?Nt+=at:ht==="[object Int32Array]"?Nt+=Jt:ht==="[object Uint32Array]"?Nt+=J:ht==="[object Float32Array]"?Nt+=rt:ht==="[object Float64Array]"?Nt+=lt:ct(new Error("Failed to get type for BinaryArray"))),ct(Nt+Y(Tt))}else if(ht==="[object Blob]"){var Pt=new FileReader;Pt.onload=function(){var Yt=et+it.type+"~"+Y(this.result);ct(st+ot+Yt)},Pt.readAsArrayBuffer(it)}else try{ct(JSON.stringify(it))}catch(Yt){console.error("Couldn't convert value into a JSON string: ",it),ct(null,Yt)}}function dt(it){if(it.substring(0,ft)!==st)return JSON.parse(it);var ct=it.substring(gt),ht=it.substring(ft,gt),Tt;if(ht===ot&&nt.test(ct)){var Nt=ct.match(nt);Tt=Nt[1],ct=ct.substring(Nt[0].length)}var Pt=ut(ct);switch(ht){case vt:return Pt;case ot:return h([Pt],{type:Tt});case pt:return new Int8Array(Pt);case Ut:return new Uint8Array(Pt);case At:return new Uint8ClampedArray(Pt);case It:return new Int16Array(Pt);case at:return new Uint16Array(Pt);case Jt:return new Int32Array(Pt);case J:return new Uint32Array(Pt);case rt:return new Float32Array(Pt);case lt:return new Float64Array(Pt);default:throw new Error("Unkown type: "+ht)}}var mt={serialize:tt,deserialize:dt,stringToBuffer:ut,bufferToString:Y};function xt(it,ct,ht,Tt){it.executeSql("CREATE TABLE IF NOT EXISTS "+ct.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],ht,Tt)}function bt(it){var ct=this,ht={db:null};if(it)for(var Tt in it)ht[Tt]=typeof it[Tt]!="string"?it[Tt].toString():it[Tt];var Nt=new g(function(Pt,Yt){try{ht.db=openDatabase(ht.name,String(ht.version),ht.description,ht.size)}catch(ne){return Yt(ne)}ht.db.transaction(function(ne){xt(ne,ht,function(){ct._dbInfo=ht,Pt()},function(se,le){Yt(le)})},Yt)});return ht.serializer=mt,Nt}function _t(it,ct,ht,Tt,Nt,Pt){it.executeSql(ht,Tt,Nt,function(Yt,ne){ne.code===ne.SYNTAX_ERR?Yt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[ct.storeName],function(se,le){le.rows.length?Pt(se,ne):xt(se,ct,function(){se.executeSql(ht,Tt,Nt,Pt)},Pt)},Pt):Pt(Yt,ne)},Pt)}function Ht(it,ct){var ht=this;it=A(it);var Tt=new g(function(Nt,Pt){ht.ready().then(function(){var Yt=ht._dbInfo;Yt.db.transaction(function(ne){_t(ne,Yt,"SELECT * FROM "+Yt.storeName+" WHERE key = ? LIMIT 1",[it],function(se,le){var ue=le.rows.length?le.rows.item(0).value:null;ue&&(ue=Yt.serializer.deserialize(ue)),Nt(ue)},function(se,le){Pt(le)})})}).catch(Pt)});return y(Tt,ct),Tt}function St(it,ct){var ht=this,Tt=new g(function(Nt,Pt){ht.ready().then(function(){var Yt=ht._dbInfo;Yt.db.transaction(function(ne){_t(ne,Yt,"SELECT * FROM "+Yt.storeName,[],function(se,le){for(var ue=le.rows,we=ue.length,Ke=0;Ke<we;Ke++){var $e=ue.item(Ke),je=$e.value;if(je&&(je=Yt.serializer.deserialize(je)),je=it(je,$e.key,Ke+1),je!==void 0){Nt(je);return}}Nt()},function(se,le){Pt(le)})})}).catch(Pt)});return y(Tt,ct),Tt}function Mt(it,ct,ht,Tt){var Nt=this;it=A(it);var Pt=new g(function(Yt,ne){Nt.ready().then(function(){ct===void 0&&(ct=null);var se=ct,le=Nt._dbInfo;le.serializer.serialize(ct,function(ue,we){we?ne(we):le.db.transaction(function(Ke){_t(Ke,le,"INSERT OR REPLACE INTO "+le.storeName+" (key, value) VALUES (?, ?)",[it,ue],function(){Yt(se)},function($e,je){ne(je)})},function(Ke){if(Ke.code===Ke.QUOTA_ERR){if(Tt>0){Yt(Mt.apply(Nt,[it,se,ht,Tt-1]));return}ne(Ke)}})})}).catch(ne)});return y(Pt,ht),Pt}function jt(it,ct,ht){return Mt.apply(this,[it,ct,ht,1])}function Lt(it,ct){var ht=this;it=A(it);var Tt=new g(function(Nt,Pt){ht.ready().then(function(){var Yt=ht._dbInfo;Yt.db.transaction(function(ne){_t(ne,Yt,"DELETE FROM "+Yt.storeName+" WHERE key = ?",[it],function(){Nt()},function(se,le){Pt(le)})})}).catch(Pt)});return y(Tt,ct),Tt}function Ft(it){var ct=this,ht=new g(function(Tt,Nt){ct.ready().then(function(){var Pt=ct._dbInfo;Pt.db.transaction(function(Yt){_t(Yt,Pt,"DELETE FROM "+Pt.storeName,[],function(){Tt()},function(ne,se){Nt(se)})})}).catch(Nt)});return y(ht,it),ht}function te(it){var ct=this,ht=new g(function(Tt,Nt){ct.ready().then(function(){var Pt=ct._dbInfo;Pt.db.transaction(function(Yt){_t(Yt,Pt,"SELECT COUNT(key) as c FROM "+Pt.storeName,[],function(ne,se){var le=se.rows.item(0).c;Tt(le)},function(ne,se){Nt(se)})})}).catch(Nt)});return y(ht,it),ht}function Bt(it,ct){var ht=this,Tt=new g(function(Nt,Pt){ht.ready().then(function(){var Yt=ht._dbInfo;Yt.db.transaction(function(ne){_t(ne,Yt,"SELECT key FROM "+Yt.storeName+" WHERE id = ? LIMIT 1",[it+1],function(se,le){var ue=le.rows.length?le.rows.item(0).key:null;Nt(ue)},function(se,le){Pt(le)})})}).catch(Pt)});return y(Tt,ct),Tt}function Ot(it){var ct=this,ht=new g(function(Tt,Nt){ct.ready().then(function(){var Pt=ct._dbInfo;Pt.db.transaction(function(Yt){_t(Yt,Pt,"SELECT key FROM "+Pt.storeName,[],function(ne,se){for(var le=[],ue=0;ue<se.rows.length;ue++)le.push(se.rows.item(ue).key);Tt(le)},function(ne,se){Nt(se)})})}).catch(Nt)});return y(ht,it),ht}function ie(it){return new g(function(ct,ht){it.transaction(function(Tt){Tt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(Nt,Pt){for(var Yt=[],ne=0;ne<Pt.rows.length;ne++)Yt.push(Pt.rows.item(ne).name);ct({db:it,storeNames:Yt})},function(Nt,Pt){ht(Pt)})},function(Tt){ht(Tt)})})}function kt(it,ct){ct=S.apply(this,arguments);var ht=this.config();it=typeof it!="function"&&it||{},it.name||(it.name=it.name||ht.name,it.storeName=it.storeName||ht.storeName);var Tt=this,Nt;return it.name?Nt=new g(function(Pt){var Yt;it.name===ht.name?Yt=Tt._dbInfo.db:Yt=openDatabase(it.name,"","",0),it.storeName?Pt({db:Yt,storeNames:[it.storeName]}):Pt(ie(Yt))}).then(function(Pt){return new g(function(Yt,ne){Pt.db.transaction(function(se){function le($e){return new g(function(je,Lr){se.executeSql("DROP TABLE IF EXISTS "+$e,[],function(){je()},function(Er,ii){Lr(ii)})})}for(var ue=[],we=0,Ke=Pt.storeNames.length;we<Ke;we++)ue.push(le(Pt.storeNames[we]));g.all(ue).then(function(){Yt()}).catch(function($e){ne($e)})},function(se){ne(se)})})}):Nt=g.reject("Invalid arguments"),y(Nt,ct),Nt}var qt={_driver:"webSQLStorage",_initStorage:bt,_support:H(),iterate:St,getItem:Ht,setItem:jt,removeItem:Lt,clear:Ft,length:te,key:Bt,keys:Ot,dropInstance:kt};function ae(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Rt(it,ct){var ht=it.name+"/";return it.storeName!==ct.storeName&&(ht+=it.storeName+"/"),ht}function zt(){var it="_localforage_support_test";try{return localStorage.setItem(it,!0),localStorage.removeItem(it),!1}catch{return!0}}function he(){return!zt()||localStorage.length>0}function Vt(it){var ct=this,ht={};if(it)for(var Tt in it)ht[Tt]=it[Tt];return ht.keyPrefix=Rt(it,ct._defaultConfig),he()?(ct._dbInfo=ht,ht.serializer=mt,g.resolve()):g.reject()}function Qt(it){var ct=this,ht=ct.ready().then(function(){for(var Tt=ct._dbInfo.keyPrefix,Nt=localStorage.length-1;Nt>=0;Nt--){var Pt=localStorage.key(Nt);Pt.indexOf(Tt)===0&&localStorage.removeItem(Pt)}});return y(ht,it),ht}function ge(it,ct){var ht=this;it=A(it);var Tt=ht.ready().then(function(){var Nt=ht._dbInfo,Pt=localStorage.getItem(Nt.keyPrefix+it);return Pt&&(Pt=Nt.serializer.deserialize(Pt)),Pt});return y(Tt,ct),Tt}function Gt(it,ct){var ht=this,Tt=ht.ready().then(function(){for(var Nt=ht._dbInfo,Pt=Nt.keyPrefix,Yt=Pt.length,ne=localStorage.length,se=1,le=0;le<ne;le++){var ue=localStorage.key(le);if(ue.indexOf(Pt)===0){var we=localStorage.getItem(ue);if(we&&(we=Nt.serializer.deserialize(we)),we=it(we,ue.substring(Yt),se++),we!==void 0)return we}}});return y(Tt,ct),Tt}function $t(it,ct){var ht=this,Tt=ht.ready().then(function(){var Nt=ht._dbInfo,Pt;try{Pt=localStorage.key(it)}catch{Pt=null}return Pt&&(Pt=Pt.substring(Nt.keyPrefix.length)),Pt});return y(Tt,ct),Tt}function pe(it){var ct=this,ht=ct.ready().then(function(){for(var Tt=ct._dbInfo,Nt=localStorage.length,Pt=[],Yt=0;Yt<Nt;Yt++){var ne=localStorage.key(Yt);ne.indexOf(Tt.keyPrefix)===0&&Pt.push(ne.substring(Tt.keyPrefix.length))}return Pt});return y(ht,it),ht}function de(it){var ct=this,ht=ct.keys().then(function(Tt){return Tt.length});return y(ht,it),ht}function Ee(it,ct){var ht=this;it=A(it);var Tt=ht.ready().then(function(){var Nt=ht._dbInfo;localStorage.removeItem(Nt.keyPrefix+it)});return y(Tt,ct),Tt}function xe(it,ct,ht){var Tt=this;it=A(it);var Nt=Tt.ready().then(function(){ct===void 0&&(ct=null);var Pt=ct;return new g(function(Yt,ne){var se=Tt._dbInfo;se.serializer.serialize(ct,function(le,ue){if(ue)ne(ue);else try{localStorage.setItem(se.keyPrefix+it,le),Yt(Pt)}catch(we){(we.name==="QuotaExceededError"||we.name==="NS_ERROR_DOM_QUOTA_REACHED")&&ne(we),ne(we)}})})});return y(Nt,ht),Nt}function Se(it,ct){if(ct=S.apply(this,arguments),it=typeof it!="function"&&it||{},!it.name){var ht=this.config();it.name=it.name||ht.name,it.storeName=it.storeName||ht.storeName}var Tt=this,Nt;return it.name?Nt=new g(function(Pt){it.storeName?Pt(Rt(it,Tt._defaultConfig)):Pt(it.name+"/")}).then(function(Pt){for(var Yt=localStorage.length-1;Yt>=0;Yt--){var ne=localStorage.key(Yt);ne.indexOf(Pt)===0&&localStorage.removeItem(ne)}}):Nt=g.reject("Invalid arguments"),y(Nt,ct),Nt}var Be={_driver:"localStorageWrapper",_initStorage:Vt,_support:ae(),iterate:Gt,getItem:ge,setItem:xe,removeItem:Ee,clear:Qt,length:de,key:$t,keys:pe,dropInstance:Se},Ne=function(ct,ht){return ct===ht||typeof ct=="number"&&typeof ht=="number"&&isNaN(ct)&&isNaN(ht)},qe=function(ct,ht){for(var Tt=ct.length,Nt=0;Nt<Tt;){if(Ne(ct[Nt],ht))return!0;Nt++}return!1},Xe=Array.isArray||function(it){return Object.prototype.toString.call(it)==="[object Array]"},Ge={},Je={},ze={INDEXEDDB:Z,WEBSQL:qt,LOCALSTORAGE:Be},rr=[ze.INDEXEDDB._driver,ze.WEBSQL._driver,ze.LOCALSTORAGE._driver],Qe=["dropInstance"],Le=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Qe),ir={description:"",driver:rr.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function nr(it,ct){it[ct]=function(){var ht=arguments;return it.ready().then(function(){return it[ct].apply(it,ht)})}}function Ze(){for(var it=1;it<arguments.length;it++){var ct=arguments[it];if(ct)for(var ht in ct)ct.hasOwnProperty(ht)&&(Xe(ct[ht])?arguments[0][ht]=ct[ht].slice():arguments[0][ht]=ct[ht])}return arguments[0]}var ar=function(){function it(ct){c(this,it);for(var ht in ze)if(ze.hasOwnProperty(ht)){var Tt=ze[ht],Nt=Tt._driver;this[ht]=Nt,Ge[Nt]||this.defineDriver(Tt)}this._defaultConfig=Ze({},ir),this._config=Ze({},this._defaultConfig,ct),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return it.prototype.config=function(ht){if((typeof ht>"u"?"undefined":n(ht))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var Tt in ht){if(Tt==="storeName"&&(ht[Tt]=ht[Tt].replace(/\W/g,"_")),Tt==="version"&&typeof ht[Tt]!="number")return new Error("Database version must be a number.");this._config[Tt]=ht[Tt]}return"driver"in ht&&ht.driver?this.setDriver(this._config.driver):!0}else return typeof ht=="string"?this._config[ht]:this._config},it.prototype.defineDriver=function(ht,Tt,Nt){var Pt=new g(function(Yt,ne){try{var se=ht._driver,le=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!ht._driver){ne(le);return}for(var ue=Le.concat("_initStorage"),we=0,Ke=ue.length;we<Ke;we++){var $e=ue[we],je=!qe(Qe,$e);if((je||ht[$e])&&typeof ht[$e]!="function"){ne(le);return}}var Lr=function(){for(var Qs=function(X4){return function(){var J4=new Error("Method "+X4+" is not implemented by the current driver"),mp=g.reject(J4);return y(mp,arguments[arguments.length-1]),mp}},vc=0,Y4=Qe.length;vc<Y4;vc++){var gc=Qe[vc];ht[gc]||(ht[gc]=Qs(gc))}};Lr();var Er=function(Qs){Ge[se]&&console.info("Redefining LocalForage driver: "+se),Ge[se]=ht,Je[se]=Qs,Yt()};"_support"in ht?ht._support&&typeof ht._support=="function"?ht._support().then(Er,ne):Er(!!ht._support):Er(!0)}catch(ii){ne(ii)}});return _(Pt,Tt,Nt),Pt},it.prototype.driver=function(){return this._driver||null},it.prototype.getDriver=function(ht,Tt,Nt){var Pt=Ge[ht]?g.resolve(Ge[ht]):g.reject(new Error("Driver not found."));return _(Pt,Tt,Nt),Pt},it.prototype.getSerializer=function(ht){var Tt=g.resolve(mt);return _(Tt,ht),Tt},it.prototype.ready=function(ht){var Tt=this,Nt=Tt._driverSet.then(function(){return Tt._ready===null&&(Tt._ready=Tt._initDriver()),Tt._ready});return _(Nt,ht,ht),Nt},it.prototype.setDriver=function(ht,Tt,Nt){var Pt=this;Xe(ht)||(ht=[ht]);var Yt=this._getSupportedDrivers(ht);function ne(){Pt._config.driver=Pt.driver()}function se(we){return Pt._extend(we),ne(),Pt._ready=Pt._initStorage(Pt._config),Pt._ready}function le(we){return function(){var Ke=0;function $e(){for(;Ke<we.length;){var je=we[Ke];return Ke++,Pt._dbInfo=null,Pt._ready=null,Pt.getDriver(je).then(se).catch($e)}ne();var Lr=new Error("No available storage method found.");return Pt._driverSet=g.reject(Lr),Pt._driverSet}return $e()}}var ue=this._driverSet!==null?this._driverSet.catch(function(){return g.resolve()}):g.resolve();return this._driverSet=ue.then(function(){var we=Yt[0];return Pt._dbInfo=null,Pt._ready=null,Pt.getDriver(we).then(function(Ke){Pt._driver=Ke._driver,ne(),Pt._wrapLibraryMethodsWithReady(),Pt._initDriver=le(Yt)})}).catch(function(){ne();var we=new Error("No available storage method found.");return Pt._driverSet=g.reject(we),Pt._driverSet}),_(this._driverSet,Tt,Nt),this._driverSet},it.prototype.supports=function(ht){return!!Je[ht]},it.prototype._extend=function(ht){Ze(this,ht)},it.prototype._getSupportedDrivers=function(ht){for(var Tt=[],Nt=0,Pt=ht.length;Nt<Pt;Nt++){var Yt=ht[Nt];this.supports(Yt)&&Tt.push(Yt)}return Tt},it.prototype._wrapLibraryMethodsWithReady=function(){for(var ht=0,Tt=Le.length;ht<Tt;ht++)nr(this,Le[ht])},it.prototype.createInstance=function(ht){return new it(ht)},it}(),yt=new ar;t.exports=yt},{3:3}]},{},[4])(4)})})(T6);var xS=T6.exports,sn={},Ps={},In={},Us={};const IS=4,km=0,Pm=1,MS=2;function Ds(i){let e=i.length;for(;--e>=0;)i[e]=0}const BS=0,R6=1,LS=2,TS=3,RS=258,U1=29,Jo=256,Lo=Jo+1+U1,vs=30,D1=19,N6=2*Lo+1,Da=15,Ah=16,NS=7,O1=256,k6=16,P6=17,U6=18,yd=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Yf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),kS=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),D6=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),PS=512,On=new Array((Lo+2)*2);Ds(On);const wo=new Array(vs*2);Ds(wo);const To=new Array(PS);Ds(To);const Ro=new Array(RS-TS+1);Ds(Ro);const F1=new Array(U1);Ds(F1);const cl=new Array(vs);Ds(cl);function Sh(i,e,r,t,a){this.static_tree=i,this.extra_bits=e,this.extra_base=r,this.elems=t,this.max_length=a,this.has_stree=i&&i.length}let O6,F6,q6;function xh(i,e){this.dyn_tree=i,this.max_code=0,this.stat_desc=e}const z6=i=>i<256?To[i]:To[256+(i>>>7)],No=(i,e)=>{i.pending_buf[i.pending++]=e&255,i.pending_buf[i.pending++]=e>>>8&255},Ei=(i,e,r)=>{i.bi_valid>Ah-r?(i.bi_buf|=e<<i.bi_valid&65535,No(i,i.bi_buf),i.bi_buf=e>>Ah-i.bi_valid,i.bi_valid+=r-Ah):(i.bi_buf|=e<<i.bi_valid&65535,i.bi_valid+=r)},yn=(i,e,r)=>{Ei(i,r[e*2],r[e*2+1])},V6=(i,e)=>{let r=0;do r|=i&1,i>>>=1,r<<=1;while(--e>0);return r>>>1},US=i=>{i.bi_valid===16?(No(i,i.bi_buf),i.bi_buf=0,i.bi_valid=0):i.bi_valid>=8&&(i.pending_buf[i.pending++]=i.bi_buf&255,i.bi_buf>>=8,i.bi_valid-=8)},DS=(i,e)=>{const r=e.dyn_tree,t=e.max_code,a=e.stat_desc.static_tree,n=e.stat_desc.has_stree,c=e.stat_desc.extra_bits,u=e.stat_desc.extra_base,v=e.stat_desc.max_length;let o,h,g,y,_,A,S=0;for(y=0;y<=Da;y++)i.bl_count[y]=0;for(r[i.heap[i.heap_max]*2+1]=0,o=i.heap_max+1;o<N6;o++)h=i.heap[o],y=r[r[h*2+1]*2+1]+1,y>v&&(y=v,S++),r[h*2+1]=y,!(h>t)&&(i.bl_count[y]++,_=0,h>=u&&(_=c[h-u]),A=r[h*2],i.opt_len+=A*(y+_),n&&(i.static_len+=A*(a[h*2+1]+_)));if(S!==0){do{for(y=v-1;i.bl_count[y]===0;)y--;i.bl_count[y]--,i.bl_count[y+1]+=2,i.bl_count[v]--,S-=2}while(S>0);for(y=v;y!==0;y--)for(h=i.bl_count[y];h!==0;)g=i.heap[--o],!(g>t)&&(r[g*2+1]!==y&&(i.opt_len+=(y-r[g*2+1])*r[g*2],r[g*2+1]=y),h--)}},G6=(i,e,r)=>{const t=new Array(Da+1);let a=0,n,c;for(n=1;n<=Da;n++)a=a+r[n-1]<<1,t[n]=a;for(c=0;c<=e;c++){let u=i[c*2+1];u!==0&&(i[c*2]=V6(t[u]++,u))}},OS=()=>{let i,e,r,t,a;const n=new Array(Da+1);for(r=0,t=0;t<U1-1;t++)for(F1[t]=r,i=0;i<1<<yd[t];i++)Ro[r++]=t;for(Ro[r-1]=t,a=0,t=0;t<16;t++)for(cl[t]=a,i=0;i<1<<Yf[t];i++)To[a++]=t;for(a>>=7;t<vs;t++)for(cl[t]=a<<7,i=0;i<1<<Yf[t]-7;i++)To[256+a++]=t;for(e=0;e<=Da;e++)n[e]=0;for(i=0;i<=143;)On[i*2+1]=8,i++,n[8]++;for(;i<=255;)On[i*2+1]=9,i++,n[9]++;for(;i<=279;)On[i*2+1]=7,i++,n[7]++;for(;i<=287;)On[i*2+1]=8,i++,n[8]++;for(G6(On,Lo+1,n),i=0;i<vs;i++)wo[i*2+1]=5,wo[i*2]=V6(i,5);O6=new Sh(On,yd,Jo+1,Lo,Da),F6=new Sh(wo,Yf,0,vs,Da),q6=new Sh(new Array(0),kS,0,D1,NS)},K6=i=>{let e;for(e=0;e<Lo;e++)i.dyn_ltree[e*2]=0;for(e=0;e<vs;e++)i.dyn_dtree[e*2]=0;for(e=0;e<D1;e++)i.bl_tree[e*2]=0;i.dyn_ltree[O1*2]=1,i.opt_len=i.static_len=0,i.sym_next=i.matches=0},H6=i=>{i.bi_valid>8?No(i,i.bi_buf):i.bi_valid>0&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0},Um=(i,e,r,t)=>{const a=e*2,n=r*2;return i[a]<i[n]||i[a]===i[n]&&t[e]<=t[r]},Ih=(i,e,r)=>{const t=i.heap[r];let a=r<<1;for(;a<=i.heap_len&&(a<i.heap_len&&Um(e,i.heap[a+1],i.heap[a],i.depth)&&a++,!Um(e,t,i.heap[a],i.depth));)i.heap[r]=i.heap[a],r=a,a<<=1;i.heap[r]=t},Dm=(i,e,r)=>{let t,a,n=0,c,u;if(i.sym_next!==0)do t=i.pending_buf[i.sym_buf+n++]&255,t+=(i.pending_buf[i.sym_buf+n++]&255)<<8,a=i.pending_buf[i.sym_buf+n++],t===0?yn(i,a,e):(c=Ro[a],yn(i,c+Jo+1,e),u=yd[c],u!==0&&(a-=F1[c],Ei(i,a,u)),t--,c=z6(t),yn(i,c,r),u=Yf[c],u!==0&&(t-=cl[c],Ei(i,t,u)));while(n<i.sym_next);yn(i,O1,e)},bd=(i,e)=>{const r=e.dyn_tree,t=e.stat_desc.static_tree,a=e.stat_desc.has_stree,n=e.stat_desc.elems;let c,u,v=-1,o;for(i.heap_len=0,i.heap_max=N6,c=0;c<n;c++)r[c*2]!==0?(i.heap[++i.heap_len]=v=c,i.depth[c]=0):r[c*2+1]=0;for(;i.heap_len<2;)o=i.heap[++i.heap_len]=v<2?++v:0,r[o*2]=1,i.depth[o]=0,i.opt_len--,a&&(i.static_len-=t[o*2+1]);for(e.max_code=v,c=i.heap_len>>1;c>=1;c--)Ih(i,r,c);o=n;do c=i.heap[1],i.heap[1]=i.heap[i.heap_len--],Ih(i,r,1),u=i.heap[1],i.heap[--i.heap_max]=c,i.heap[--i.heap_max]=u,r[o*2]=r[c*2]+r[u*2],i.depth[o]=(i.depth[c]>=i.depth[u]?i.depth[c]:i.depth[u])+1,r[c*2+1]=r[u*2+1]=o,i.heap[1]=o++,Ih(i,r,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],DS(i,e),G6(r,v,i.bl_count)},Om=(i,e,r)=>{let t,a=-1,n,c=e[0*2+1],u=0,v=7,o=4;for(c===0&&(v=138,o=3),e[(r+1)*2+1]=65535,t=0;t<=r;t++)n=c,c=e[(t+1)*2+1],!(++u<v&&n===c)&&(u<o?i.bl_tree[n*2]+=u:n!==0?(n!==a&&i.bl_tree[n*2]++,i.bl_tree[k6*2]++):u<=10?i.bl_tree[P6*2]++:i.bl_tree[U6*2]++,u=0,a=n,c===0?(v=138,o=3):n===c?(v=6,o=3):(v=7,o=4))},Fm=(i,e,r)=>{let t,a=-1,n,c=e[0*2+1],u=0,v=7,o=4;for(c===0&&(v=138,o=3),t=0;t<=r;t++)if(n=c,c=e[(t+1)*2+1],!(++u<v&&n===c)){if(u<o)do yn(i,n,i.bl_tree);while(--u!==0);else n!==0?(n!==a&&(yn(i,n,i.bl_tree),u--),yn(i,k6,i.bl_tree),Ei(i,u-3,2)):u<=10?(yn(i,P6,i.bl_tree),Ei(i,u-3,3)):(yn(i,U6,i.bl_tree),Ei(i,u-11,7));u=0,a=n,c===0?(v=138,o=3):n===c?(v=6,o=3):(v=7,o=4)}},FS=i=>{let e;for(Om(i,i.dyn_ltree,i.l_desc.max_code),Om(i,i.dyn_dtree,i.d_desc.max_code),bd(i,i.bl_desc),e=D1-1;e>=3&&i.bl_tree[D6[e]*2+1]===0;e--);return i.opt_len+=3*(e+1)+5+5+4,e},qS=(i,e,r,t)=>{let a;for(Ei(i,e-257,5),Ei(i,r-1,5),Ei(i,t-4,4),a=0;a<t;a++)Ei(i,i.bl_tree[D6[a]*2+1],3);Fm(i,i.dyn_ltree,e-1),Fm(i,i.dyn_dtree,r-1)},zS=i=>{let e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&i.dyn_ltree[r*2]!==0)return km;if(i.dyn_ltree[9*2]!==0||i.dyn_ltree[10*2]!==0||i.dyn_ltree[13*2]!==0)return Pm;for(r=32;r<Jo;r++)if(i.dyn_ltree[r*2]!==0)return Pm;return km};let qm=!1;const VS=i=>{qm||(OS(),qm=!0),i.l_desc=new xh(i.dyn_ltree,O6),i.d_desc=new xh(i.dyn_dtree,F6),i.bl_desc=new xh(i.bl_tree,q6),i.bi_buf=0,i.bi_valid=0,K6(i)},Q6=(i,e,r,t)=>{Ei(i,(BS<<1)+(t?1:0),3),H6(i),No(i,r),No(i,~r),r&&i.pending_buf.set(i.window.subarray(e,e+r),i.pending),i.pending+=r},GS=i=>{Ei(i,R6<<1,3),yn(i,O1,On),US(i)},KS=(i,e,r,t)=>{let a,n,c=0;i.level>0?(i.strm.data_type===MS&&(i.strm.data_type=zS(i)),bd(i,i.l_desc),bd(i,i.d_desc),c=FS(i),a=i.opt_len+3+7>>>3,n=i.static_len+3+7>>>3,n<=a&&(a=n)):a=n=r+5,r+4<=a&&e!==-1?Q6(i,e,r,t):i.strategy===IS||n===a?(Ei(i,(R6<<1)+(t?1:0),3),Dm(i,On,wo)):(Ei(i,(LS<<1)+(t?1:0),3),qS(i,i.l_desc.max_code+1,i.d_desc.max_code+1,c+1),Dm(i,i.dyn_ltree,i.dyn_dtree)),K6(i),t&&H6(i)},HS=(i,e,r)=>(i.pending_buf[i.sym_buf+i.sym_next++]=e,i.pending_buf[i.sym_buf+i.sym_next++]=e>>8,i.pending_buf[i.sym_buf+i.sym_next++]=r,e===0?i.dyn_ltree[r*2]++:(i.matches++,e--,i.dyn_ltree[(Ro[r]+Jo+1)*2]++,i.dyn_dtree[z6(e)*2]++),i.sym_next===i.sym_end);Us._tr_init=VS;Us._tr_stored_block=Q6;Us._tr_flush_block=KS;Us._tr_tally=HS;Us._tr_align=GS;const QS=(i,e,r,t)=>{let a=i&65535|0,n=i>>>16&65535|0,c=0;for(;r!==0;){c=r>2e3?2e3:r,r-=c;do a=a+e[t++]|0,n=n+a|0;while(--c);a%=65521,n%=65521}return a|n<<16|0};var $6=QS;const $S=()=>{let i,e=[];for(var r=0;r<256;r++){i=r;for(var t=0;t<8;t++)i=i&1?3988292384^i>>>1:i>>>1;e[r]=i}return e},ZS=new Uint32Array($S()),jS=(i,e,r,t)=>{const a=ZS,n=t+r;i^=-1;for(let c=t;c<n;c++)i=i>>>8^a[(i^e[c])&255];return i^-1};var Z6=jS,q1={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Wa={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:WS,_tr_stored_block:_d,_tr_flush_block:YS,_tr_tally:la,_tr_align:XS}=Us,j6=$6,Jn=Z6,JS=q1,{Z_NO_FLUSH:ca,Z_PARTIAL_FLUSH:tx,Z_FULL_FLUSH:ex,Z_FINISH:zi,Z_BLOCK:zm,Z_OK:Xr,Z_STREAM_END:Vm,Z_STREAM_ERROR:En,Z_DATA_ERROR:rx,Z_BUF_ERROR:Mh,Z_DEFAULT_COMPRESSION:ix,Z_FILTERED:nx,Z_HUFFMAN_ONLY:Tf,Z_RLE:ax,Z_FIXED:sx,Z_DEFAULT_STRATEGY:ox,Z_UNKNOWN:fx,Z_DEFLATED:Yl}=Wa,lx=9,cx=15,ux=8,hx=29,dx=256,wd=dx+1+hx,px=30,vx=19,gx=2*wd+1,mx=15,pr=3,ia=258,An=ia+pr+1,yx=32,Cs=42,z1=57,Cd=69,Ed=73,Ad=91,Sd=103,Oa=113,oo=666,vi=1,Os=2,Ha=3,Fs=4,bx=3,Fa=(i,e)=>(i.msg=JS[e],e),Gm=i=>i*2-(i>4?9:0),ea=i=>{let e=i.length;for(;--e>=0;)i[e]=0},_x=i=>{let e,r,t,a=i.w_size;e=i.hash_size,t=e;do r=i.head[--t],i.head[t]=r>=a?r-a:0;while(--e);e=a,t=e;do r=i.prev[--t],i.prev[t]=r>=a?r-a:0;while(--e)};let wx=(i,e,r)=>(e<<i.hash_shift^r)&i.hash_mask,ua=wx;const Ii=i=>{const e=i.state;let r=e.pending;r>i.avail_out&&(r=i.avail_out),r!==0&&(i.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),i.next_out),i.next_out+=r,e.pending_out+=r,i.total_out+=r,i.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))},Ri=(i,e)=>{YS(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,e),i.block_start=i.strstart,Ii(i.strm)},Cr=(i,e)=>{i.pending_buf[i.pending++]=e},ro=(i,e)=>{i.pending_buf[i.pending++]=e>>>8&255,i.pending_buf[i.pending++]=e&255},xd=(i,e,r,t)=>{let a=i.avail_in;return a>t&&(a=t),a===0?0:(i.avail_in-=a,e.set(i.input.subarray(i.next_in,i.next_in+a),r),i.state.wrap===1?i.adler=j6(i.adler,e,a,r):i.state.wrap===2&&(i.adler=Jn(i.adler,e,a,r)),i.next_in+=a,i.total_in+=a,a)},W6=(i,e)=>{let r=i.max_chain_length,t=i.strstart,a,n,c=i.prev_length,u=i.nice_match;const v=i.strstart>i.w_size-An?i.strstart-(i.w_size-An):0,o=i.window,h=i.w_mask,g=i.prev,y=i.strstart+ia;let _=o[t+c-1],A=o[t+c];i.prev_length>=i.good_match&&(r>>=2),u>i.lookahead&&(u=i.lookahead);do if(a=e,!(o[a+c]!==A||o[a+c-1]!==_||o[a]!==o[t]||o[++a]!==o[t+1])){t+=2,a++;do;while(o[++t]===o[++a]&&o[++t]===o[++a]&&o[++t]===o[++a]&&o[++t]===o[++a]&&o[++t]===o[++a]&&o[++t]===o[++a]&&o[++t]===o[++a]&&o[++t]===o[++a]&&t<y);if(n=ia-(y-t),t=y-ia,n>c){if(i.match_start=e,c=n,n>=u)break;_=o[t+c-1],A=o[t+c]}}while((e=g[e&h])>v&&--r!==0);return c<=i.lookahead?c:i.lookahead},Es=i=>{const e=i.w_size;let r,t,a;do{if(t=i.window_size-i.lookahead-i.strstart,i.strstart>=e+(e-An)&&(i.window.set(i.window.subarray(e,e+e-t),0),i.match_start-=e,i.strstart-=e,i.block_start-=e,i.insert>i.strstart&&(i.insert=i.strstart),_x(i),t+=e),i.strm.avail_in===0)break;if(r=xd(i.strm,i.window,i.strstart+i.lookahead,t),i.lookahead+=r,i.lookahead+i.insert>=pr)for(a=i.strstart-i.insert,i.ins_h=i.window[a],i.ins_h=ua(i,i.ins_h,i.window[a+1]);i.insert&&(i.ins_h=ua(i,i.ins_h,i.window[a+pr-1]),i.prev[a&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=a,a++,i.insert--,!(i.lookahead+i.insert<pr)););}while(i.lookahead<An&&i.strm.avail_in!==0)},Y6=(i,e)=>{let r=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,t,a,n,c=0,u=i.strm.avail_in;do{if(t=65535,n=i.bi_valid+42>>3,i.strm.avail_out<n||(n=i.strm.avail_out-n,a=i.strstart-i.block_start,t>a+i.strm.avail_in&&(t=a+i.strm.avail_in),t>n&&(t=n),t<r&&(t===0&&e!==zi||e===ca||t!==a+i.strm.avail_in)))break;c=e===zi&&t===a+i.strm.avail_in?1:0,_d(i,0,0,c),i.pending_buf[i.pending-4]=t,i.pending_buf[i.pending-3]=t>>8,i.pending_buf[i.pending-2]=~t,i.pending_buf[i.pending-1]=~t>>8,Ii(i.strm),a&&(a>t&&(a=t),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+a),i.strm.next_out),i.strm.next_out+=a,i.strm.avail_out-=a,i.strm.total_out+=a,i.block_start+=a,t-=a),t&&(xd(i.strm,i.strm.output,i.strm.next_out,t),i.strm.next_out+=t,i.strm.avail_out-=t,i.strm.total_out+=t)}while(c===0);return u-=i.strm.avail_in,u&&(u>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=u&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-u,i.strm.next_in),i.strstart),i.strstart+=u,i.insert+=u>i.w_size-i.insert?i.w_size-i.insert:u),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),c?Fs:e!==ca&&e!==zi&&i.strm.avail_in===0&&i.strstart===i.block_start?Os:(n=i.window_size-i.strstart,i.strm.avail_in>n&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,n+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),n>i.strm.avail_in&&(n=i.strm.avail_in),n&&(xd(i.strm,i.window,i.strstart,n),i.strstart+=n,i.insert+=n>i.w_size-i.insert?i.w_size-i.insert:n),i.high_water<i.strstart&&(i.high_water=i.strstart),n=i.bi_valid+42>>3,n=i.pending_buf_size-n>65535?65535:i.pending_buf_size-n,r=n>i.w_size?i.w_size:n,a=i.strstart-i.block_start,(a>=r||(a||e===zi)&&e!==ca&&i.strm.avail_in===0&&a<=n)&&(t=a>n?n:a,c=e===zi&&i.strm.avail_in===0&&t===a?1:0,_d(i,i.block_start,t,c),i.block_start+=t,Ii(i.strm)),c?Ha:vi)},Bh=(i,e)=>{let r,t;for(;;){if(i.lookahead<An){if(Es(i),i.lookahead<An&&e===ca)return vi;if(i.lookahead===0)break}if(r=0,i.lookahead>=pr&&(i.ins_h=ua(i,i.ins_h,i.window[i.strstart+pr-1]),r=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),r!==0&&i.strstart-r<=i.w_size-An&&(i.match_length=W6(i,r)),i.match_length>=pr)if(t=la(i,i.strstart-i.match_start,i.match_length-pr),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=pr){i.match_length--;do i.strstart++,i.ins_h=ua(i,i.ins_h,i.window[i.strstart+pr-1]),r=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!==0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=ua(i,i.ins_h,i.window[i.strstart+1]);else t=la(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(t&&(Ri(i,!1),i.strm.avail_out===0))return vi}return i.insert=i.strstart<pr-1?i.strstart:pr-1,e===zi?(Ri(i,!0),i.strm.avail_out===0?Ha:Fs):i.sym_next&&(Ri(i,!1),i.strm.avail_out===0)?vi:Os},ns=(i,e)=>{let r,t,a;for(;;){if(i.lookahead<An){if(Es(i),i.lookahead<An&&e===ca)return vi;if(i.lookahead===0)break}if(r=0,i.lookahead>=pr&&(i.ins_h=ua(i,i.ins_h,i.window[i.strstart+pr-1]),r=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=pr-1,r!==0&&i.prev_length<i.max_lazy_match&&i.strstart-r<=i.w_size-An&&(i.match_length=W6(i,r),i.match_length<=5&&(i.strategy===nx||i.match_length===pr&&i.strstart-i.match_start>4096)&&(i.match_length=pr-1)),i.prev_length>=pr&&i.match_length<=i.prev_length){a=i.strstart+i.lookahead-pr,t=la(i,i.strstart-1-i.prev_match,i.prev_length-pr),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=a&&(i.ins_h=ua(i,i.ins_h,i.window[i.strstart+pr-1]),r=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!==0);if(i.match_available=0,i.match_length=pr-1,i.strstart++,t&&(Ri(i,!1),i.strm.avail_out===0))return vi}else if(i.match_available){if(t=la(i,0,i.window[i.strstart-1]),t&&Ri(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return vi}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(t=la(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<pr-1?i.strstart:pr-1,e===zi?(Ri(i,!0),i.strm.avail_out===0?Ha:Fs):i.sym_next&&(Ri(i,!1),i.strm.avail_out===0)?vi:Os},Cx=(i,e)=>{let r,t,a,n;const c=i.window;for(;;){if(i.lookahead<=ia){if(Es(i),i.lookahead<=ia&&e===ca)return vi;if(i.lookahead===0)break}if(i.match_length=0,i.lookahead>=pr&&i.strstart>0&&(a=i.strstart-1,t=c[a],t===c[++a]&&t===c[++a]&&t===c[++a])){n=i.strstart+ia;do;while(t===c[++a]&&t===c[++a]&&t===c[++a]&&t===c[++a]&&t===c[++a]&&t===c[++a]&&t===c[++a]&&t===c[++a]&&a<n);i.match_length=ia-(n-a),i.match_length>i.lookahead&&(i.match_length=i.lookahead)}if(i.match_length>=pr?(r=la(i,1,i.match_length-pr),i.lookahead-=i.match_length,i.strstart+=i.match_length,i.match_length=0):(r=la(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++),r&&(Ri(i,!1),i.strm.avail_out===0))return vi}return i.insert=0,e===zi?(Ri(i,!0),i.strm.avail_out===0?Ha:Fs):i.sym_next&&(Ri(i,!1),i.strm.avail_out===0)?vi:Os},Ex=(i,e)=>{let r;for(;;){if(i.lookahead===0&&(Es(i),i.lookahead===0)){if(e===ca)return vi;break}if(i.match_length=0,r=la(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++,r&&(Ri(i,!1),i.strm.avail_out===0))return vi}return i.insert=0,e===zi?(Ri(i,!0),i.strm.avail_out===0?Ha:Fs):i.sym_next&&(Ri(i,!1),i.strm.avail_out===0)?vi:Os};function hn(i,e,r,t,a){this.good_length=i,this.max_lazy=e,this.nice_length=r,this.max_chain=t,this.func=a}const fo=[new hn(0,0,0,0,Y6),new hn(4,4,8,4,Bh),new hn(4,5,16,8,Bh),new hn(4,6,32,32,Bh),new hn(4,4,16,16,ns),new hn(8,16,32,32,ns),new hn(8,16,128,128,ns),new hn(8,32,128,256,ns),new hn(32,128,258,1024,ns),new hn(32,258,258,4096,ns)],Ax=i=>{i.window_size=2*i.w_size,ea(i.head),i.max_lazy_match=fo[i.level].max_lazy,i.good_match=fo[i.level].good_length,i.nice_match=fo[i.level].nice_length,i.max_chain_length=fo[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=pr-1,i.match_available=0,i.ins_h=0};function Sx(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Yl,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(gx*2),this.dyn_dtree=new Uint16Array((2*px+1)*2),this.bl_tree=new Uint16Array((2*vx+1)*2),ea(this.dyn_ltree),ea(this.dyn_dtree),ea(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(mx+1),this.heap=new Uint16Array(2*wd+1),ea(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*wd+1),ea(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const tf=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.status!==Cs&&e.status!==z1&&e.status!==Cd&&e.status!==Ed&&e.status!==Ad&&e.status!==Sd&&e.status!==Oa&&e.status!==oo?1:0},X6=i=>{if(tf(i))return Fa(i,En);i.total_in=i.total_out=0,i.data_type=fx;const e=i.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?z1:e.wrap?Cs:Oa,i.adler=e.wrap===2?0:1,e.last_flush=-2,WS(e),Xr},J6=i=>{const e=X6(i);return e===Xr&&Ax(i.state),e},xx=(i,e)=>tf(i)||i.state.wrap!==2?En:(i.state.gzhead=e,Xr),t_=(i,e,r,t,a,n)=>{if(!i)return En;let c=1;if(e===ix&&(e=6),t<0?(c=0,t=-t):t>15&&(c=2,t-=16),a<1||a>lx||r!==Yl||t<8||t>15||e<0||e>9||n<0||n>sx||t===8&&c!==1)return Fa(i,En);t===8&&(t=9);const u=new Sx;return i.state=u,u.strm=i,u.status=Cs,u.wrap=c,u.gzhead=null,u.w_bits=t,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=a+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+pr-1)/pr),u.window=new Uint8Array(u.w_size*2),u.head=new Uint16Array(u.hash_size),u.prev=new Uint16Array(u.w_size),u.lit_bufsize=1<<a+6,u.pending_buf_size=u.lit_bufsize*4,u.pending_buf=new Uint8Array(u.pending_buf_size),u.sym_buf=u.lit_bufsize,u.sym_end=(u.lit_bufsize-1)*3,u.level=e,u.strategy=n,u.method=r,J6(i)},Ix=(i,e)=>t_(i,e,Yl,cx,ux,ox),Mx=(i,e)=>{if(tf(i)||e>zm||e<0)return i?Fa(i,En):En;const r=i.state;if(!i.output||i.avail_in!==0&&!i.input||r.status===oo&&e!==zi)return Fa(i,i.avail_out===0?Mh:En);const t=r.last_flush;if(r.last_flush=e,r.pending!==0){if(Ii(i),i.avail_out===0)return r.last_flush=-1,Xr}else if(i.avail_in===0&&Gm(e)<=Gm(t)&&e!==zi)return Fa(i,Mh);if(r.status===oo&&i.avail_in!==0)return Fa(i,Mh);if(r.status===Cs&&r.wrap===0&&(r.status=Oa),r.status===Cs){let a=Yl+(r.w_bits-8<<4)<<8,n=-1;if(r.strategy>=Tf||r.level<2?n=0:r.level<6?n=1:r.level===6?n=2:n=3,a|=n<<6,r.strstart!==0&&(a|=yx),a+=31-a%31,ro(r,a),r.strstart!==0&&(ro(r,i.adler>>>16),ro(r,i.adler&65535)),i.adler=1,r.status=Oa,Ii(i),r.pending!==0)return r.last_flush=-1,Xr}if(r.status===z1){if(i.adler=0,Cr(r,31),Cr(r,139),Cr(r,8),r.gzhead)Cr(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Cr(r,r.gzhead.time&255),Cr(r,r.gzhead.time>>8&255),Cr(r,r.gzhead.time>>16&255),Cr(r,r.gzhead.time>>24&255),Cr(r,r.level===9?2:r.strategy>=Tf||r.level<2?4:0),Cr(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(Cr(r,r.gzhead.extra.length&255),Cr(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(i.adler=Jn(i.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Cd;else if(Cr(r,0),Cr(r,0),Cr(r,0),Cr(r,0),Cr(r,0),Cr(r,r.level===9?2:r.strategy>=Tf||r.level<2?4:0),Cr(r,bx),r.status=Oa,Ii(i),r.pending!==0)return r.last_flush=-1,Xr}if(r.status===Cd){if(r.gzhead.extra){let a=r.pending,n=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+n>r.pending_buf_size;){let u=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+u),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>a&&(i.adler=Jn(i.adler,r.pending_buf,r.pending-a,a)),r.gzindex+=u,Ii(i),r.pending!==0)return r.last_flush=-1,Xr;a=0,n-=u}let c=new Uint8Array(r.gzhead.extra);r.pending_buf.set(c.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending+=n,r.gzhead.hcrc&&r.pending>a&&(i.adler=Jn(i.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=Ed}if(r.status===Ed){if(r.gzhead.name){let a=r.pending,n;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(i.adler=Jn(i.adler,r.pending_buf,r.pending-a,a)),Ii(i),r.pending!==0)return r.last_flush=-1,Xr;a=0}r.gzindex<r.gzhead.name.length?n=r.gzhead.name.charCodeAt(r.gzindex++)&255:n=0,Cr(r,n)}while(n!==0);r.gzhead.hcrc&&r.pending>a&&(i.adler=Jn(i.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=Ad}if(r.status===Ad){if(r.gzhead.comment){let a=r.pending,n;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(i.adler=Jn(i.adler,r.pending_buf,r.pending-a,a)),Ii(i),r.pending!==0)return r.last_flush=-1,Xr;a=0}r.gzindex<r.gzhead.comment.length?n=r.gzhead.comment.charCodeAt(r.gzindex++)&255:n=0,Cr(r,n)}while(n!==0);r.gzhead.hcrc&&r.pending>a&&(i.adler=Jn(i.adler,r.pending_buf,r.pending-a,a))}r.status=Sd}if(r.status===Sd){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Ii(i),r.pending!==0))return r.last_flush=-1,Xr;Cr(r,i.adler&255),Cr(r,i.adler>>8&255),i.adler=0}if(r.status=Oa,Ii(i),r.pending!==0)return r.last_flush=-1,Xr}if(i.avail_in!==0||r.lookahead!==0||e!==ca&&r.status!==oo){let a=r.level===0?Y6(r,e):r.strategy===Tf?Ex(r,e):r.strategy===ax?Cx(r,e):fo[r.level].func(r,e);if((a===Ha||a===Fs)&&(r.status=oo),a===vi||a===Ha)return i.avail_out===0&&(r.last_flush=-1),Xr;if(a===Os&&(e===tx?XS(r):e!==zm&&(_d(r,0,0,!1),e===ex&&(ea(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Ii(i),i.avail_out===0))return r.last_flush=-1,Xr}return e!==zi?Xr:r.wrap<=0?Vm:(r.wrap===2?(Cr(r,i.adler&255),Cr(r,i.adler>>8&255),Cr(r,i.adler>>16&255),Cr(r,i.adler>>24&255),Cr(r,i.total_in&255),Cr(r,i.total_in>>8&255),Cr(r,i.total_in>>16&255),Cr(r,i.total_in>>24&255)):(ro(r,i.adler>>>16),ro(r,i.adler&65535)),Ii(i),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Xr:Vm)},Bx=i=>{if(tf(i))return En;const e=i.state.status;return i.state=null,e===Oa?Fa(i,rx):Xr},Lx=(i,e)=>{let r=e.length;if(tf(i))return En;const t=i.state,a=t.wrap;if(a===2||a===1&&t.status!==Cs||t.lookahead)return En;if(a===1&&(i.adler=j6(i.adler,e,r,0)),t.wrap=0,r>=t.w_size){a===0&&(ea(t.head),t.strstart=0,t.block_start=0,t.insert=0);let v=new Uint8Array(t.w_size);v.set(e.subarray(r-t.w_size,r),0),e=v,r=t.w_size}const n=i.avail_in,c=i.next_in,u=i.input;for(i.avail_in=r,i.next_in=0,i.input=e,Es(t);t.lookahead>=pr;){let v=t.strstart,o=t.lookahead-(pr-1);do t.ins_h=ua(t,t.ins_h,t.window[v+pr-1]),t.prev[v&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=v,v++;while(--o);t.strstart=v,t.lookahead=pr-1,Es(t)}return t.strstart+=t.lookahead,t.block_start=t.strstart,t.insert=t.lookahead,t.lookahead=0,t.match_length=t.prev_length=pr-1,t.match_available=0,i.next_in=c,i.input=u,i.avail_in=n,t.wrap=a,Xr};In.deflateInit=Ix;In.deflateInit2=t_;In.deflateReset=J6;In.deflateResetKeep=X6;In.deflateSetHeader=xx;In.deflate=Mx;In.deflateEnd=Bx;In.deflateSetDictionary=Lx;In.deflateInfo="pako deflate (from Nodeca project)";var Xl={};const Tx=(i,e)=>Object.prototype.hasOwnProperty.call(i,e);Xl.assign=function(i){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const t in r)Tx(r,t)&&(i[t]=r[t])}}return i};Xl.flattenChunks=i=>{let e=0;for(let t=0,a=i.length;t<a;t++)e+=i[t].length;const r=new Uint8Array(e);for(let t=0,a=0,n=i.length;t<n;t++){let c=i[t];r.set(c,a),a+=c.length}return r};var ef={};let e_=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{e_=!1}const ko=new Uint8Array(256);for(let i=0;i<256;i++)ko[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;ko[254]=ko[254]=1;ef.string2buf=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let e,r,t,a,n,c=i.length,u=0;for(a=0;a<c;a++)r=i.charCodeAt(a),(r&64512)===55296&&a+1<c&&(t=i.charCodeAt(a+1),(t&64512)===56320&&(r=65536+(r-55296<<10)+(t-56320),a++)),u+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(u),n=0,a=0;n<u;a++)r=i.charCodeAt(a),(r&64512)===55296&&a+1<c&&(t=i.charCodeAt(a+1),(t&64512)===56320&&(r=65536+(r-55296<<10)+(t-56320),a++)),r<128?e[n++]=r:r<2048?(e[n++]=192|r>>>6,e[n++]=128|r&63):r<65536?(e[n++]=224|r>>>12,e[n++]=128|r>>>6&63,e[n++]=128|r&63):(e[n++]=240|r>>>18,e[n++]=128|r>>>12&63,e[n++]=128|r>>>6&63,e[n++]=128|r&63);return e};const Rx=(i,e)=>{if(e<65534&&i.subarray&&e_)return String.fromCharCode.apply(null,i.length===e?i:i.subarray(0,e));let r="";for(let t=0;t<e;t++)r+=String.fromCharCode(i[t]);return r};ef.buf2string=(i,e)=>{const r=e||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,e));let t,a;const n=new Array(r*2);for(a=0,t=0;t<r;){let c=i[t++];if(c<128){n[a++]=c;continue}let u=ko[c];if(u>4){n[a++]=65533,t+=u-1;continue}for(c&=u===2?31:u===3?15:7;u>1&&t<r;)c=c<<6|i[t++]&63,u--;if(u>1){n[a++]=65533;continue}c<65536?n[a++]=c:(c-=65536,n[a++]=55296|c>>10&1023,n[a++]=56320|c&1023)}return Rx(n,a)};ef.utf8border=(i,e)=>{e=e||i.length,e>i.length&&(e=i.length);let r=e-1;for(;r>=0&&(i[r]&192)===128;)r--;return r<0||r===0?e:r+ko[i[r]]>e?r:e};function Nx(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var r_=Nx;const Co=In,i_=Xl,n_=ef,Id=q1,kx=r_,a_=Object.prototype.toString,{Z_NO_FLUSH:Px,Z_SYNC_FLUSH:Ux,Z_FULL_FLUSH:Dx,Z_FINISH:Ox,Z_OK:ul,Z_STREAM_END:Fx,Z_DEFAULT_COMPRESSION:qx,Z_DEFAULT_STRATEGY:zx,Z_DEFLATED:Vx}=Wa;function rf(i){this.options=i_.assign({level:qx,method:Vx,chunkSize:16384,windowBits:15,memLevel:8,strategy:zx},i||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kx,this.strm.avail_out=0;let r=Co.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==ul)throw new Error(Id[r]);if(e.header&&Co.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(typeof e.dictionary=="string"?t=n_.string2buf(e.dictionary):a_.call(e.dictionary)==="[object ArrayBuffer]"?t=new Uint8Array(e.dictionary):t=e.dictionary,r=Co.deflateSetDictionary(this.strm,t),r!==ul)throw new Error(Id[r]);this._dict_set=!0}}rf.prototype.push=function(i,e){const r=this.strm,t=this.options.chunkSize;let a,n;if(this.ended)return!1;for(e===~~e?n=e:n=e===!0?Ox:Px,typeof i=="string"?r.input=n_.string2buf(i):a_.call(i)==="[object ArrayBuffer]"?r.input=new Uint8Array(i):r.input=i,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(t),r.next_out=0,r.avail_out=t),(n===Ux||n===Dx)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(a=Co.deflate(r,n),a===Fx)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=Co.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===ul;if(r.avail_out===0){this.onData(r.output);continue}if(n>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};rf.prototype.onData=function(i){this.chunks.push(i)};rf.prototype.onEnd=function(i){i===ul&&(this.result=i_.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function V1(i,e){const r=new rf(e);if(r.push(i,!0),r.err)throw r.msg||Id[r.err];return r.result}function Gx(i,e){return e=e||{},e.raw=!0,V1(i,e)}function Kx(i,e){return e=e||{},e.gzip=!0,V1(i,e)}Ps.Deflate=rf;Ps.deflate=V1;Ps.deflateRaw=Gx;Ps.gzip=Kx;Ps.constants=Wa;var qs={},on={};const Rf=16209,Hx=16191;var Qx=function(e,r){let t,a,n,c,u,v,o,h,g,y,_,A,S,T,B,M,R,P,D,q,k,U,O,G;const E=e.state;t=e.next_in,O=e.input,a=t+(e.avail_in-5),n=e.next_out,G=e.output,c=n-(r-e.avail_out),u=n+(e.avail_out-257),v=E.dmax,o=E.wsize,h=E.whave,g=E.wnext,y=E.window,_=E.hold,A=E.bits,S=E.lencode,T=E.distcode,B=(1<<E.lenbits)-1,M=(1<<E.distbits)-1;t:do{A<15&&(_+=O[t++]<<A,A+=8,_+=O[t++]<<A,A+=8),R=S[_&B];e:for(;;){if(P=R>>>24,_>>>=P,A-=P,P=R>>>16&255,P===0)G[n++]=R&65535;else if(P&16){D=R&65535,P&=15,P&&(A<P&&(_+=O[t++]<<A,A+=8),D+=_&(1<<P)-1,_>>>=P,A-=P),A<15&&(_+=O[t++]<<A,A+=8,_+=O[t++]<<A,A+=8),R=T[_&M];r:for(;;){if(P=R>>>24,_>>>=P,A-=P,P=R>>>16&255,P&16){if(q=R&65535,P&=15,A<P&&(_+=O[t++]<<A,A+=8,A<P&&(_+=O[t++]<<A,A+=8)),q+=_&(1<<P)-1,q>v){e.msg="invalid distance too far back",E.mode=Rf;break t}if(_>>>=P,A-=P,P=n-c,q>P){if(P=q-P,P>h&&E.sane){e.msg="invalid distance too far back",E.mode=Rf;break t}if(k=0,U=y,g===0){if(k+=o-P,P<D){D-=P;do G[n++]=y[k++];while(--P);k=n-q,U=G}}else if(g<P){if(k+=o+g-P,P-=g,P<D){D-=P;do G[n++]=y[k++];while(--P);if(k=0,g<D){P=g,D-=P;do G[n++]=y[k++];while(--P);k=n-q,U=G}}}else if(k+=g-P,P<D){D-=P;do G[n++]=y[k++];while(--P);k=n-q,U=G}for(;D>2;)G[n++]=U[k++],G[n++]=U[k++],G[n++]=U[k++],D-=3;D&&(G[n++]=U[k++],D>1&&(G[n++]=U[k++]))}else{k=n-q;do G[n++]=G[k++],G[n++]=G[k++],G[n++]=G[k++],D-=3;while(D>2);D&&(G[n++]=G[k++],D>1&&(G[n++]=G[k++]))}}else if(P&64){e.msg="invalid distance code",E.mode=Rf;break t}else{R=T[(R&65535)+(_&(1<<P)-1)];continue r}break}}else if(P&64)if(P&32){E.mode=Hx;break t}else{e.msg="invalid literal/length code",E.mode=Rf;break t}else{R=S[(R&65535)+(_&(1<<P)-1)];continue e}break}}while(t<a&&n<u);D=A>>3,t-=D,A-=D<<3,_&=(1<<A)-1,e.next_in=t,e.next_out=n,e.avail_in=t<a?5+(a-t):5-(t-a),e.avail_out=n<u?257+(u-n):257-(n-u),E.hold=_,E.bits=A};const as=15,Km=852,Hm=592,Qm=0,Lh=1,$m=2,$x=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Zx=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),jx=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Wx=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Yx=(i,e,r,t,a,n,c,u)=>{const v=u.bits;let o=0,h=0,g=0,y=0,_=0,A=0,S=0,T=0,B=0,M=0,R,P,D,q,k,U=null,O;const G=new Uint16Array(as+1),E=new Uint16Array(as+1);let s=null,l,d,p;for(o=0;o<=as;o++)G[o]=0;for(h=0;h<t;h++)G[e[r+h]]++;for(_=v,y=as;y>=1&&G[y]===0;y--);if(_>y&&(_=y),y===0)return a[n++]=1<<24|64<<16|0,a[n++]=1<<24|64<<16|0,u.bits=1,0;for(g=1;g<y&&G[g]===0;g++);for(_<g&&(_=g),T=1,o=1;o<=as;o++)if(T<<=1,T-=G[o],T<0)return-1;if(T>0&&(i===Qm||y!==1))return-1;for(E[1]=0,o=1;o<as;o++)E[o+1]=E[o]+G[o];for(h=0;h<t;h++)e[r+h]!==0&&(c[E[e[r+h]]++]=h);if(i===Qm?(U=s=c,O=20):i===Lh?(U=$x,s=Zx,O=257):(U=jx,s=Wx,O=0),M=0,h=0,o=g,k=n,A=_,S=0,D=-1,B=1<<_,q=B-1,i===Lh&&B>Km||i===$m&&B>Hm)return 1;for(;;){l=o-S,c[h]+1<O?(d=0,p=c[h]):c[h]>=O?(d=s[c[h]-O],p=U[c[h]-O]):(d=96,p=0),R=1<<o-S,P=1<<A,g=P;do P-=R,a[k+(M>>S)+P]=l<<24|d<<16|p|0;while(P!==0);for(R=1<<o-1;M&R;)R>>=1;if(R!==0?(M&=R-1,M+=R):M=0,h++,--G[o]===0){if(o===y)break;o=e[r+c[h]]}if(o>_&&(M&q)!==D){for(S===0&&(S=_),k+=g,A=o-S,T=1<<A;A+S<y&&(T-=G[A+S],!(T<=0));)A++,T<<=1;if(B+=1<<A,i===Lh&&B>Km||i===$m&&B>Hm)return 1;D=M&q,a[D]=_<<24|A<<16|k-n|0}}return M!==0&&(a[k+M]=o-S<<24|64<<16|0),u.bits=_,0};var Xx=Yx;const Md=$6,dn=Z6,Jx=Qx,Eo=Xx,tI=0,s_=1,o_=2,{Z_FINISH:Zm,Z_BLOCK:eI,Z_TREES:Nf,Z_OK:Qa,Z_STREAM_END:rI,Z_NEED_DICT:iI,Z_STREAM_ERROR:Qi,Z_DATA_ERROR:f_,Z_MEM_ERROR:l_,Z_BUF_ERROR:nI,Z_DEFLATED:jm}=Wa,Jl=16180,Wm=16181,Ym=16182,Xm=16183,Jm=16184,t3=16185,e3=16186,r3=16187,i3=16188,n3=16189,hl=16190,Rn=16191,Th=16192,a3=16193,Rh=16194,s3=16195,o3=16196,f3=16197,l3=16198,kf=16199,Pf=16200,c3=16201,u3=16202,h3=16203,d3=16204,p3=16205,Nh=16206,v3=16207,g3=16208,Ur=16209,c_=16210,u_=16211,aI=852,sI=592,oI=15,fI=oI,m3=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function lI(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ya=i=>{if(!i)return 1;const e=i.state;return!e||e.strm!==i||e.mode<Jl||e.mode>u_?1:0},h_=i=>{if(Ya(i))return Qi;const e=i.state;return i.total_in=i.total_out=e.total=0,i.msg="",e.wrap&&(i.adler=e.wrap&1),e.mode=Jl,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(aI),e.distcode=e.distdyn=new Int32Array(sI),e.sane=1,e.back=-1,Qa},d_=i=>{if(Ya(i))return Qi;const e=i.state;return e.wsize=0,e.whave=0,e.wnext=0,h_(i)},p_=(i,e)=>{let r;if(Ya(i))return Qi;const t=i.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Qi:(t.window!==null&&t.wbits!==e&&(t.window=null),t.wrap=r,t.wbits=e,d_(i))},v_=(i,e)=>{if(!i)return Qi;const r=new lI;i.state=r,r.strm=i,r.window=null,r.mode=Jl;const t=p_(i,e);return t!==Qa&&(i.state=null),t},cI=i=>v_(i,fI);let y3=!0,kh,Ph;const uI=i=>{if(y3){kh=new Int32Array(512),Ph=new Int32Array(32);let e=0;for(;e<144;)i.lens[e++]=8;for(;e<256;)i.lens[e++]=9;for(;e<280;)i.lens[e++]=7;for(;e<288;)i.lens[e++]=8;for(Eo(s_,i.lens,0,288,kh,0,i.work,{bits:9}),e=0;e<32;)i.lens[e++]=5;Eo(o_,i.lens,0,32,Ph,0,i.work,{bits:5}),y3=!1}i.lencode=kh,i.lenbits=9,i.distcode=Ph,i.distbits=5},g_=(i,e,r,t)=>{let a;const n=i.state;return n.window===null&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),t>=n.wsize?(n.window.set(e.subarray(r-n.wsize,r),0),n.wnext=0,n.whave=n.wsize):(a=n.wsize-n.wnext,a>t&&(a=t),n.window.set(e.subarray(r-t,r-t+a),n.wnext),t-=a,t?(n.window.set(e.subarray(r-t,r),0),n.wnext=t,n.whave=n.wsize):(n.wnext+=a,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=a))),0},hI=(i,e)=>{let r,t,a,n,c,u,v,o,h,g,y,_,A,S,T=0,B,M,R,P,D,q,k,U;const O=new Uint8Array(4);let G,E;const s=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ya(i)||!i.output||!i.input&&i.avail_in!==0)return Qi;r=i.state,r.mode===Rn&&(r.mode=Th),c=i.next_out,a=i.output,v=i.avail_out,n=i.next_in,t=i.input,u=i.avail_in,o=r.hold,h=r.bits,g=u,y=v,U=Qa;t:for(;;)switch(r.mode){case Jl:if(r.wrap===0){r.mode=Th;break}for(;h<16;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}if(r.wrap&2&&o===35615){r.wbits===0&&(r.wbits=15),r.check=0,O[0]=o&255,O[1]=o>>>8&255,r.check=dn(r.check,O,2,0),o=0,h=0,r.mode=Wm;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((o&255)<<8)+(o>>8))%31){i.msg="incorrect header check",r.mode=Ur;break}if((o&15)!==jm){i.msg="unknown compression method",r.mode=Ur;break}if(o>>>=4,h-=4,k=(o&15)+8,r.wbits===0&&(r.wbits=k),k>15||k>r.wbits){i.msg="invalid window size",r.mode=Ur;break}r.dmax=1<<r.wbits,r.flags=0,i.adler=r.check=1,r.mode=o&512?n3:Rn,o=0,h=0;break;case Wm:for(;h<16;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}if(r.flags=o,(r.flags&255)!==jm){i.msg="unknown compression method",r.mode=Ur;break}if(r.flags&57344){i.msg="unknown header flags set",r.mode=Ur;break}r.head&&(r.head.text=o>>8&1),r.flags&512&&r.wrap&4&&(O[0]=o&255,O[1]=o>>>8&255,r.check=dn(r.check,O,2,0)),o=0,h=0,r.mode=Ym;case Ym:for(;h<32;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}r.head&&(r.head.time=o),r.flags&512&&r.wrap&4&&(O[0]=o&255,O[1]=o>>>8&255,O[2]=o>>>16&255,O[3]=o>>>24&255,r.check=dn(r.check,O,4,0)),o=0,h=0,r.mode=Xm;case Xm:for(;h<16;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}r.head&&(r.head.xflags=o&255,r.head.os=o>>8),r.flags&512&&r.wrap&4&&(O[0]=o&255,O[1]=o>>>8&255,r.check=dn(r.check,O,2,0)),o=0,h=0,r.mode=Jm;case Jm:if(r.flags&1024){for(;h<16;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}r.length=o,r.head&&(r.head.extra_len=o),r.flags&512&&r.wrap&4&&(O[0]=o&255,O[1]=o>>>8&255,r.check=dn(r.check,O,2,0)),o=0,h=0}else r.head&&(r.head.extra=null);r.mode=t3;case t3:if(r.flags&1024&&(_=r.length,_>u&&(_=u),_&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(t.subarray(n,n+_),k)),r.flags&512&&r.wrap&4&&(r.check=dn(r.check,t,_,n)),u-=_,n+=_,r.length-=_),r.length))break t;r.length=0,r.mode=e3;case e3:if(r.flags&2048){if(u===0)break t;_=0;do k=t[n+_++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k));while(k&&_<u);if(r.flags&512&&r.wrap&4&&(r.check=dn(r.check,t,_,n)),u-=_,n+=_,k)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=r3;case r3:if(r.flags&4096){if(u===0)break t;_=0;do k=t[n+_++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k));while(k&&_<u);if(r.flags&512&&r.wrap&4&&(r.check=dn(r.check,t,_,n)),u-=_,n+=_,k)break t}else r.head&&(r.head.comment=null);r.mode=i3;case i3:if(r.flags&512){for(;h<16;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}if(r.wrap&4&&o!==(r.check&65535)){i.msg="header crc mismatch",r.mode=Ur;break}o=0,h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),i.adler=r.check=0,r.mode=Rn;break;case n3:for(;h<32;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}i.adler=r.check=m3(o),o=0,h=0,r.mode=hl;case hl:if(r.havedict===0)return i.next_out=c,i.avail_out=v,i.next_in=n,i.avail_in=u,r.hold=o,r.bits=h,iI;i.adler=r.check=1,r.mode=Rn;case Rn:if(e===eI||e===Nf)break t;case Th:if(r.last){o>>>=h&7,h-=h&7,r.mode=Nh;break}for(;h<3;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}switch(r.last=o&1,o>>>=1,h-=1,o&3){case 0:r.mode=a3;break;case 1:if(uI(r),r.mode=kf,e===Nf){o>>>=2,h-=2;break t}break;case 2:r.mode=o3;break;case 3:i.msg="invalid block type",r.mode=Ur}o>>>=2,h-=2;break;case a3:for(o>>>=h&7,h-=h&7;h<32;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}if((o&65535)!==(o>>>16^65535)){i.msg="invalid stored block lengths",r.mode=Ur;break}if(r.length=o&65535,o=0,h=0,r.mode=Rh,e===Nf)break t;case Rh:r.mode=s3;case s3:if(_=r.length,_){if(_>u&&(_=u),_>v&&(_=v),_===0)break t;a.set(t.subarray(n,n+_),c),u-=_,n+=_,v-=_,c+=_,r.length-=_;break}r.mode=Rn;break;case o3:for(;h<14;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}if(r.nlen=(o&31)+257,o>>>=5,h-=5,r.ndist=(o&31)+1,o>>>=5,h-=5,r.ncode=(o&15)+4,o>>>=4,h-=4,r.nlen>286||r.ndist>30){i.msg="too many length or distance symbols",r.mode=Ur;break}r.have=0,r.mode=f3;case f3:for(;r.have<r.ncode;){for(;h<3;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}r.lens[s[r.have++]]=o&7,o>>>=3,h-=3}for(;r.have<19;)r.lens[s[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,G={bits:r.lenbits},U=Eo(tI,r.lens,0,19,r.lencode,0,r.work,G),r.lenbits=G.bits,U){i.msg="invalid code lengths set",r.mode=Ur;break}r.have=0,r.mode=l3;case l3:for(;r.have<r.nlen+r.ndist;){for(;T=r.lencode[o&(1<<r.lenbits)-1],B=T>>>24,M=T>>>16&255,R=T&65535,!(B<=h);){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}if(R<16)o>>>=B,h-=B,r.lens[r.have++]=R;else{if(R===16){for(E=B+2;h<E;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}if(o>>>=B,h-=B,r.have===0){i.msg="invalid bit length repeat",r.mode=Ur;break}k=r.lens[r.have-1],_=3+(o&3),o>>>=2,h-=2}else if(R===17){for(E=B+3;h<E;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}o>>>=B,h-=B,k=0,_=3+(o&7),o>>>=3,h-=3}else{for(E=B+7;h<E;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}o>>>=B,h-=B,k=0,_=11+(o&127),o>>>=7,h-=7}if(r.have+_>r.nlen+r.ndist){i.msg="invalid bit length repeat",r.mode=Ur;break}for(;_--;)r.lens[r.have++]=k}}if(r.mode===Ur)break;if(r.lens[256]===0){i.msg="invalid code -- missing end-of-block",r.mode=Ur;break}if(r.lenbits=9,G={bits:r.lenbits},U=Eo(s_,r.lens,0,r.nlen,r.lencode,0,r.work,G),r.lenbits=G.bits,U){i.msg="invalid literal/lengths set",r.mode=Ur;break}if(r.distbits=6,r.distcode=r.distdyn,G={bits:r.distbits},U=Eo(o_,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,G),r.distbits=G.bits,U){i.msg="invalid distances set",r.mode=Ur;break}if(r.mode=kf,e===Nf)break t;case kf:r.mode=Pf;case Pf:if(u>=6&&v>=258){i.next_out=c,i.avail_out=v,i.next_in=n,i.avail_in=u,r.hold=o,r.bits=h,Jx(i,y),c=i.next_out,a=i.output,v=i.avail_out,n=i.next_in,t=i.input,u=i.avail_in,o=r.hold,h=r.bits,r.mode===Rn&&(r.back=-1);break}for(r.back=0;T=r.lencode[o&(1<<r.lenbits)-1],B=T>>>24,M=T>>>16&255,R=T&65535,!(B<=h);){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}if(M&&!(M&240)){for(P=B,D=M,q=R;T=r.lencode[q+((o&(1<<P+D)-1)>>P)],B=T>>>24,M=T>>>16&255,R=T&65535,!(P+B<=h);){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}o>>>=P,h-=P,r.back+=P}if(o>>>=B,h-=B,r.back+=B,r.length=R,M===0){r.mode=p3;break}if(M&32){r.back=-1,r.mode=Rn;break}if(M&64){i.msg="invalid literal/length code",r.mode=Ur;break}r.extra=M&15,r.mode=c3;case c3:if(r.extra){for(E=r.extra;h<E;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}r.length+=o&(1<<r.extra)-1,o>>>=r.extra,h-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=u3;case u3:for(;T=r.distcode[o&(1<<r.distbits)-1],B=T>>>24,M=T>>>16&255,R=T&65535,!(B<=h);){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}if(!(M&240)){for(P=B,D=M,q=R;T=r.distcode[q+((o&(1<<P+D)-1)>>P)],B=T>>>24,M=T>>>16&255,R=T&65535,!(P+B<=h);){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}o>>>=P,h-=P,r.back+=P}if(o>>>=B,h-=B,r.back+=B,M&64){i.msg="invalid distance code",r.mode=Ur;break}r.offset=R,r.extra=M&15,r.mode=h3;case h3:if(r.extra){for(E=r.extra;h<E;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}r.offset+=o&(1<<r.extra)-1,o>>>=r.extra,h-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){i.msg="invalid distance too far back",r.mode=Ur;break}r.mode=d3;case d3:if(v===0)break t;if(_=y-v,r.offset>_){if(_=r.offset-_,_>r.whave&&r.sane){i.msg="invalid distance too far back",r.mode=Ur;break}_>r.wnext?(_-=r.wnext,A=r.wsize-_):A=r.wnext-_,_>r.length&&(_=r.length),S=r.window}else S=a,A=c-r.offset,_=r.length;_>v&&(_=v),v-=_,r.length-=_;do a[c++]=S[A++];while(--_);r.length===0&&(r.mode=Pf);break;case p3:if(v===0)break t;a[c++]=r.length,v--,r.mode=Pf;break;case Nh:if(r.wrap){for(;h<32;){if(u===0)break t;u--,o|=t[n++]<<h,h+=8}if(y-=v,i.total_out+=y,r.total+=y,r.wrap&4&&y&&(i.adler=r.check=r.flags?dn(r.check,a,y,c-y):Md(r.check,a,y,c-y)),y=v,r.wrap&4&&(r.flags?o:m3(o))!==r.check){i.msg="incorrect data check",r.mode=Ur;break}o=0,h=0}r.mode=v3;case v3:if(r.wrap&&r.flags){for(;h<32;){if(u===0)break t;u--,o+=t[n++]<<h,h+=8}if(r.wrap&4&&o!==(r.total&4294967295)){i.msg="incorrect length check",r.mode=Ur;break}o=0,h=0}r.mode=g3;case g3:U=rI;break t;case Ur:U=f_;break t;case c_:return l_;case u_:default:return Qi}return i.next_out=c,i.avail_out=v,i.next_in=n,i.avail_in=u,r.hold=o,r.bits=h,(r.wsize||y!==i.avail_out&&r.mode<Ur&&(r.mode<Nh||e!==Zm))&&g_(i,i.output,i.next_out,y-i.avail_out),g-=i.avail_in,y-=i.avail_out,i.total_in+=g,i.total_out+=y,r.total+=y,r.wrap&4&&y&&(i.adler=r.check=r.flags?dn(r.check,a,y,i.next_out-y):Md(r.check,a,y,i.next_out-y)),i.data_type=r.bits+(r.last?64:0)+(r.mode===Rn?128:0)+(r.mode===kf||r.mode===Rh?256:0),(g===0&&y===0||e===Zm)&&U===Qa&&(U=nI),U},dI=i=>{if(Ya(i))return Qi;let e=i.state;return e.window&&(e.window=null),i.state=null,Qa},pI=(i,e)=>{if(Ya(i))return Qi;const r=i.state;return r.wrap&2?(r.head=e,e.done=!1,Qa):Qi},vI=(i,e)=>{const r=e.length;let t,a,n;return Ya(i)||(t=i.state,t.wrap!==0&&t.mode!==hl)?Qi:t.mode===hl&&(a=1,a=Md(a,e,r,0),a!==t.check)?f_:(n=g_(i,e,r,r),n?(t.mode=c_,l_):(t.havedict=1,Qa))};on.inflateReset=d_;on.inflateReset2=p_;on.inflateResetKeep=h_;on.inflateInit=cI;on.inflateInit2=v_;on.inflate=hI;on.inflateEnd=dI;on.inflateGetHeader=pI;on.inflateSetDictionary=vI;on.inflateInfo="pako inflate (from Nodeca project)";function gI(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var mI=gI;const Fn=on,m_=Xl,Bd=ef,Ld=q1,yI=r_,bI=mI,y_=Object.prototype.toString,{Z_NO_FLUSH:_I,Z_FINISH:wI,Z_OK:Po,Z_STREAM_END:Uh,Z_NEED_DICT:Dh,Z_STREAM_ERROR:CI,Z_DATA_ERROR:b3,Z_MEM_ERROR:EI}=Wa;function nf(i){this.options=m_.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(i&&i.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yI,this.strm.avail_out=0;let r=Fn.inflateInit2(this.strm,e.windowBits);if(r!==Po)throw new Error(Ld[r]);if(this.header=new bI,Fn.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Bd.string2buf(e.dictionary):y_.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Fn.inflateSetDictionary(this.strm,e.dictionary),r!==Po)))throw new Error(Ld[r])}nf.prototype.push=function(i,e){const r=this.strm,t=this.options.chunkSize,a=this.options.dictionary;let n,c,u;if(this.ended)return!1;for(e===~~e?c=e:c=e===!0?wI:_I,y_.call(i)==="[object ArrayBuffer]"?r.input=new Uint8Array(i):r.input=i,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(t),r.next_out=0,r.avail_out=t),n=Fn.inflate(r,c),n===Dh&&a&&(n=Fn.inflateSetDictionary(r,a),n===Po?n=Fn.inflate(r,c):n===b3&&(n=Dh));r.avail_in>0&&n===Uh&&r.state.wrap>0&&i[r.next_in]!==0;)Fn.inflateReset(r),n=Fn.inflate(r,c);switch(n){case CI:case b3:case Dh:case EI:return this.onEnd(n),this.ended=!0,!1}if(u=r.avail_out,r.next_out&&(r.avail_out===0||n===Uh))if(this.options.to==="string"){let v=Bd.utf8border(r.output,r.next_out),o=r.next_out-v,h=Bd.buf2string(r.output,v);r.next_out=o,r.avail_out=t-o,o&&r.output.set(r.output.subarray(v,v+o),0),this.onData(h)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(n===Po&&u===0)){if(n===Uh)return n=Fn.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};nf.prototype.onData=function(i){this.chunks.push(i)};nf.prototype.onEnd=function(i){i===Po&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m_.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function G1(i,e){const r=new nf(e);if(r.push(i),r.err)throw r.msg||Ld[r.err];return r.result}function AI(i,e){return e=e||{},e.raw=!0,G1(i,e)}qs.Inflate=nf;qs.inflate=G1;qs.inflateRaw=AI;qs.ungzip=G1;qs.constants=Wa;const{Deflate:SI,deflate:xI,deflateRaw:II,gzip:MI}=Ps,{Inflate:BI,inflate:LI,inflateRaw:TI,ungzip:RI}=qs,NI=Wa;sn.Deflate=SI;sn.deflate=xI;sn.deflateRaw=II;sn.gzip=MI;sn.Inflate=BI;sn.inflate=LI;sn.inflateRaw=TI;sn.ungzip=RI;sn.constants=NI;var Dr={},li={},_3;function kI(){return _3||(_3=1,Object.defineProperty(li,"__esModule",{value:!0}),li.CIRCOM_LEVELS=li.CIRCOM_BIGINT_K=li.CIRCOM_BIGINT_N=li.MAX_BODY_PADDED_BYTES=li.MAX_HEADER_PADDED_BYTES=li.CIRCOM_FIELD_MODULUS=void 0,li.CIRCOM_FIELD_MODULUS=21888242871839275222246405745257275088548364400416034343698204186575808495617n,li.MAX_HEADER_PADDED_BYTES=1024,li.MAX_BODY_PADDED_BYTES=1536,li.CIRCOM_BIGINT_N=121,li.CIRCOM_BIGINT_K=17,li.CIRCOM_LEVELS=30),li}var w3;function b_(){if(w3)return Dr;w3=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.bytesToString=e,Dr.stringToBytes=r,Dr.bufferToUint8Array=t,Dr.bufferToHex=a,Dr.Uint8ArrayToCharArray=n,Dr.Uint8ArrayToString=c,Dr.Uint8ArrayToHex=u,Dr.bufferToString=v,Dr.bytesToBigInt=o,Dr.bigIntToChunkedBytes=h,Dr.toCircomBigIntBytes=g,Dr.toHex=A,Dr.fromHex=S,Dr.int64toBytes=T,Dr.int8toBytes=B,Dr.bitsToUint8=M,Dr.uint8ToBits=R,Dr.mergeUInt8Arrays=P,Dr.assert=D,Dr.packedNBytesToString=q,Dr.packBytesIntoNBytes=k;const i=kI();function e(U){return new TextDecoder().decode(U)}function r(U){return Uint8Array.from(U,G=>G.charCodeAt(0))}function t(U){const O=new ArrayBuffer(U.length),G=new Uint8Array(O);for(let E=0;E<U.length;++E)G[E]=U[E];return Uint8Array.from(G)}function a(U){return U.toString("hex")}function n(U){return Array.from(U).map(O=>O.toString())}async function c(U){return Array.from(U).map(O=>O.toString()).join(";")}async function u(U){return Buffer.from(U).toString("hex")}function v(U){const O=t(U);return e(O)}function o(U){let O=0n;for(let G=0;G<U.length;++G)O=(O<<8n)+BigInt(U[G]);return O}function h(U,O,G){const E=[],s=typeof U=="bigint"?U:U.valueOf(),l=(1n<<BigInt(O))-1n;for(let d=0;d<G;++d)E.push((s>>BigInt(d*O)&l).toString());return E}function g(U){return h(U,i.CIRCOM_BIGINT_N,i.CIRCOM_BIGINT_K)}const y="0123456789abcdef",_={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15};function A(U){return Array.from(U||[]).map(O=>y[O>>4]+y[O&15]).join("")}function S(U){let O=U;U[0]==="0"&&U[1]==="x"&&(O=U.slice(2));const G=new Uint8Array(Math.floor((O||"").length/2));let E;for(E=0;E<G.length;E++){const s=_[O[E*2]],l=_[O[E*2+1]];if(s===void 0||l===void 0)break;G[E]=s<<4|l}return E===G.length?G:G.slice(0,E)}function T(U){const O=new ArrayBuffer(8);return new DataView(O).setInt32(4,U,!1),new Uint8Array(O)}function B(U){const O=new ArrayBuffer(1);return new DataView(O).setUint8(0,U),new Uint8Array(O)}function M(U){const O=new Uint8Array(U.length);for(let G=0;G<U.length;G+=1)O[G]=parseInt(U[G],2);return O}function R(U){return U.reduce((O,G)=>O+G.toString(2).padStart(8,"0"),"")}function P(U,O){const G=new Uint8Array(U.length+O.length);return G.set(U),G.set(O,U.length),G}function D(U,O){if(!U)throw new Error(O)}function q(U,O=31){const G=[];for(let E=0;E<U.length;E++)for(let s=0n;s<O;s++)G.push(Number((U[E]>>s*8n)%256n));return e(Uint8Array.from(G))}function k(U,O=7){const G=typeof U=="string"?r(U):U,E=[];for(let s=0;s<G.length;s++){s%O===0&&E.push(0n);const l=s/O|0;console.assert(l===E.length-1,"Not editing the index of the last element -- packing loop invariants bug!"),E[l]+=BigInt(G[s])<<BigInt(s%O*8)}return E}return Dr}var Nn={},Oh={},C3;function PI(){return C3||(C3=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.HMAC=i.Hash=i.blockSize=i.digestLength=void 0,i.hash=n,i.hmac=c,i.hkdf=o,i.pbkdf2=h,i.digestLength=32,i.blockSize=64;const e=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function r(g,y,_,A,S){let T,B,M,R,P,D,q,k,U,O,G,E,s;for(;S>=64;){for(T=y[0],B=y[1],M=y[2],R=y[3],P=y[4],D=y[5],q=y[6],k=y[7],O=0;O<16;O++)G=A+O*4,g[O]=(_[G]&255)<<24|(_[G+1]&255)<<16|(_[G+2]&255)<<8|_[G+3]&255;for(O=16;O<64;O++)U=g[O-2],E=(U>>>17|U<<15)^(U>>>19|U<<13)^U>>>10,U=g[O-15],s=(U>>>7|U<<25)^(U>>>18|U<<14)^U>>>3,g[O]=(E+g[O-7]|0)+(s+g[O-16]|0);for(O=0;O<64;O++)E=(((P>>>6|P<<26)^(P>>>11|P<<21)^(P>>>25|P<<7))+(P&D^~P&q)|0)+(k+(e[O]+g[O]|0)|0)|0,s=((T>>>2|T<<30)^(T>>>13|T<<19)^(T>>>22|T<<10))+(T&B^T&M^B&M)|0,k=q,q=D,D=P,P=R+E|0,R=M,M=B,B=T,T=E+s|0;y[0]+=T,y[1]+=B,y[2]+=M,y[3]+=R,y[4]+=P,y[5]+=D,y[6]+=q,y[7]+=k,A+=64,S-=64}return A}class t{constructor(){this.digestLength=i.digestLength,this.blockSize=i.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}reset(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this}clean(){for(let y=0;y<this.buffer.length;y++)this.buffer[y]=0;for(let y=0;y<this.temp.length;y++)this.temp[y]=0;this.reset()}update(y,_=y.length){if(this.finished)throw new Error("SHA256: can't update because hash was finished.");let A=0;if(this.bytesHashed+=_,this.bufferLength>0){for(;this.bufferLength<64&&_>0;)this.buffer[this.bufferLength++]=y[A++],_--;this.bufferLength===64&&(r(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(_>=64&&(A=r(this.temp,this.state,y,A,_),_%=64);_>0;)this.buffer[this.bufferLength++]=y[A++],_--;return this}finish(y){if(!this.finished){const _=this.bytesHashed,A=this.bufferLength,S=_/536870912|0,T=_<<3,B=_%64<56?64:128;this.buffer[A]=128;for(let M=A+1;M<B-8;M++)this.buffer[M]=0;this.buffer[B-8]=S>>>24&255,this.buffer[B-7]=S>>>16&255,this.buffer[B-6]=S>>>8&255,this.buffer[B-5]=S>>>0&255,this.buffer[B-4]=T>>>24&255,this.buffer[B-3]=T>>>16&255,this.buffer[B-2]=T>>>8&255,this.buffer[B-1]=T>>>0&255,r(this.temp,this.state,this.buffer,0,B),this.finished=!0}for(let _=0;_<8;_++)y[_*4+0]=this.state[_]>>>24&255,y[_*4+1]=this.state[_]>>>16&255,y[_*4+2]=this.state[_]>>>8&255,y[_*4+3]=this.state[_]>>>0&255;return this}digest(){const y=new Uint8Array(this.digestLength);return this.finish(y),y}cacheState(){const y=new Uint32Array(this.state.length);this._saveState(y);const _=new Uint8Array(this.state.length*4);for(let A=0;A<8;A++)_[A*4+0]=this.state[A]>>>24&255,_[A*4+1]=this.state[A]>>>16&255,_[A*4+2]=this.state[A]>>>8&255,_[A*4+3]=this.state[A]>>>0&255;return _}_saveState(y){for(let _=0;_<this.state.length;_++)y[_]=this.state[_]}_restoreState(y,_){for(let A=0;A<this.state.length;A++)this.state[A]=y[A];this.bytesHashed=_,this.finished=!1,this.bufferLength=0}}i.Hash=t;class a{constructor(y){this.inner=new t,this.outer=new t,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;const _=new Uint8Array(this.blockSize);if(y.length>this.blockSize)new t().update(y).finish(_).clean();else for(let A=0;A<y.length;A++)_[A]=y[A];for(let A=0;A<_.length;A++)_[A]^=54;this.inner.update(_);for(let A=0;A<_.length;A++)_[A]^=106;this.outer.update(_),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate);for(let A=0;A<_.length;A++)_[A]=0}reset(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this}clean(){for(let y=0;y<this.istate.length;y++)this.ostate[y]=this.istate[y]=0;this.inner.clean(),this.outer.clean()}update(y){return this.inner.update(y),this}finish(y){return this.outer.finished?this.outer.finish(y):(this.inner.finish(y),this.outer.update(y,this.digestLength).finish(y)),this}digest(){const y=new Uint8Array(this.digestLength);return this.finish(y),y}}i.HMAC=a;function n(g){const y=new t().update(g),_=y.digest();return y.clean(),_}i.default=n;function c(g,y){const _=new a(g).update(y),A=_.digest();return _.clean(),A}function u(g,y,_,A){const S=A[0];if(S===0)throw new Error("hkdf: cannot expand more");y.reset(),S>1&&y.update(g),_&&y.update(_),y.update(A),y.finish(g),A[0]++}const v=new Uint8Array(i.digestLength);function o(g,y=v,_,A=32){const S=new Uint8Array([1]),T=c(y,g),B=new a(T),M=new Uint8Array(B.digestLength);let R=M.length;const P=new Uint8Array(A);for(let D=0;D<A;D++)R===M.length&&(u(M,B,_,S),R=0),P[D]=M[R++];return B.clean(),M.fill(0),S.fill(0),P}function h(g,y,_,A){const S=new a(g),T=S.digestLength,B=new Uint8Array(4),M=new Uint8Array(T),R=new Uint8Array(T),P=new Uint8Array(A);for(let D=0;D*T<A;D++){let q=D+1;B[0]=q>>>24&255,B[1]=q>>>16&255,B[2]=q>>>8&255,B[3]=q>>>0&255,S.reset(),S.update(y),S.update(B),S.finish(R);for(let k=0;k<T;k++)M[k]=R[k];for(let k=2;k<=_;k++){S.reset(),S.update(R).finish(R);for(let U=0;U<T;U++)M[U]^=R[U]}for(let k=0;k<T&&D*T+k<A;k++)P[D*T+k]=M[k]}for(let D=0;D<T;D++)M[D]=R[D]=0;for(let D=0;D<4;D++)B[D]=0;return S.clean(),P}}(Oh)),Oh}var E3;function UI(){if(E3)return Nn;E3=1;var i=di&&di.__createBinding||(Object.create?function(y,_,A,S){S===void 0&&(S=A);var T=Object.getOwnPropertyDescriptor(_,A);(!T||("get"in T?!_.__esModule:T.writable||T.configurable))&&(T={enumerable:!0,get:function(){return _[A]}}),Object.defineProperty(y,S,T)}:function(y,_,A,S){S===void 0&&(S=A),y[S]=_[A]}),e=di&&di.__setModuleDefault||(Object.create?function(y,_){Object.defineProperty(y,"default",{enumerable:!0,value:_})}:function(y,_){y.default=_}),r=di&&di.__importStar||function(y){if(y&&y.__esModule)return y;var _={};if(y!=null)for(var A in y)A!=="default"&&Object.prototype.hasOwnProperty.call(y,A)&&i(_,y,A);return e(_,y),_};Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.findIndexInUint8Array=c,Nn.padUint8ArrayWithZeros=u,Nn.generatePartialSHA=v,Nn.shaHash=o,Nn.partialSha=h,Nn.sha256Pad=g;const t=r(ba()),a=b_(),n=PI();function c(y,_){let A=0,S=0;for(;A<y.length;){if(y[A]===_[S]){if(S++,S===_.length)return A-S+1}else S=0;A++}return-1}function u(y,_){for(;y.length<_;)y=(0,a.mergeUInt8Arrays)(y,(0,a.int8toBytes)(0));return y}function v({body:y,bodyLength:_,selectorString:A,maxRemainingBodyLength:S}){let T=0;if(A){const q=new TextEncoder().encode(A);if(T=c(y,q),T===-1)throw new Error(`SHA precompute selector "${A}" not found in the body`)}const B=Math.floor(T/64)*64,M=y.slice(0,B);let R=y.slice(B);const P=_-M.length;if(P>S)throw new Error(`Remaining body ${P} after the selector is longer than max (${S})`);if(R.length%64!==0)throw new Error("Remaining body was not padded correctly with int64s");return R=u(R,S),{precomputedSha:h(M,B),bodyRemaining:R,bodyRemainingLength:P}}function o(y){return t.createHash("sha256").update(y).digest()}function h(y,_){return new n.Hash().update(y,_).cacheState()}function g(y,_){const A=y.length*8,S=(0,a.int64toBytes)(A);let T=(0,a.mergeUInt8Arrays)(y,(0,a.int8toBytes)(2**7));for(;(T.length*8+S.length*8)%512!==0;)T=(0,a.mergeUInt8Arrays)(T,(0,a.int8toBytes)(0));T=(0,a.mergeUInt8Arrays)(T,S),(0,a.assert)(T.length*8%512===0,"Padding did not complete properly!");const B=T.length;for(;T.length<_;)T=(0,a.mergeUInt8Arrays)(T,(0,a.int64toBytes)(0));return(0,a.assert)(T.length===_,`Padding to max length did not complete properly! Your padded message is ${T.length} long but max is ${_}!`),[T,B]}return Nn}var Fh,A3;function DI(){if(A3)return Fh;A3=1;var i=Object.defineProperty,e=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,t=Object.prototype.hasOwnProperty,a=(M,R)=>{for(var P in R)i(M,P,{get:R[P],enumerable:!0})},n=(M,R,P,D)=>{if(R&&typeof R=="object"||typeof R=="function")for(let q of r(R))!t.call(M,q)&&q!==P&&i(M,q,{get:()=>R[q],enumerable:!(D=e(R,q))||D.enumerable});return M},c=M=>n(i({},"__esModule",{value:!0}),M),u={};a(u,{ArgumentTypeName:()=>v,isBigIntArgument:()=>g,isBooleanArgument:()=>y,isNumberArgument:()=>h,isObjectArgument:()=>_,isPCDArgument:()=>S,isRevealListArgument:()=>B,isStringArgument:()=>o,isStringArrayArgument:()=>A,isToggleListArgument:()=>T}),Fh=c(u);var v=(M=>(M.String="String",M.Number="Number",M.BigInt="BigInt",M.Boolean="Boolean",M.Object="Object",M.StringArray="StringArray",M.PCD="PCD",M.ToggleList="ToggleList",M.Unknown="Unknown",M))(v||{});function o(M){return M.argumentType==="String"}function h(M){return M.argumentType==="Number"}function g(M){return M.argumentType==="BigInt"}function y(M){return M.argumentType==="Boolean"}function _(M){return M.argumentType==="Object"}function A(M){return M.argumentType==="StringArray"}function S(M){return M.argumentType==="PCD"}function T(M){return M.argumentType==="ToggleList"&&M.value!==void 0&&M.value!==null&&typeof M.value=="object"&&Object.values(M.value).every(R=>typeof R=="boolean")}function B(M){return M.value!==void 0&&Object.keys(M.value).every(R=>R.startsWith("reveal"))}return Fh}var OI=Object.create,tc=Object.defineProperty,FI=Object.getOwnPropertyDescriptor,__=Object.getOwnPropertyNames,qI=Object.getPrototypeOf,zI=Object.prototype.hasOwnProperty,Ve=(i,e)=>function(){return e||(0,i[__(i)[0]])((e={exports:{}}).exports,e),e.exports},VI=(i,e)=>{for(var r in e)tc(i,r,{get:e[r],enumerable:!0})},w_=(i,e,r,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of __(e))!zI.call(i,a)&&a!==r&&tc(i,a,{get:()=>e[a],enumerable:!(t=FI(e,a))||t.enumerable});return i},Xa=(i,e,r)=>(r=i!=null?OI(qI(i)):{},w_(!i||!i.__esModule?tc(r,"default",{value:i,enumerable:!0}):r,i)),GI=i=>w_(tc({},"__esModule",{value:!0}),i),mi=(i,e,r)=>new Promise((t,a)=>{var n=v=>{try{u(r.next(v))}catch(o){a(o)}},c=v=>{try{u(r.throw(v))}catch(o){a(o)}},u=v=>v.done?t(v.value):Promise.resolve(v.value).then(n,c);u((r=r.apply(i,e)).next())}),sr=Ve({"../../node_modules/node-forge/lib/forge.js"(i,e){e.exports={options:{usePureJavaScript:!1}}}}),KI=Ve({"../../node_modules/node-forge/lib/baseN.js"(i,e){var r={};e.exports=r;var t={};r.encode=function(n,c,u){if(typeof c!="string")throw new TypeError('"alphabet" must be a string.');if(u!==void 0&&typeof u!="number")throw new TypeError('"maxline" must be a number.');var v="";if(!(n instanceof Uint8Array))v=a(n,c);else{var o=0,h=c.length,g=c.charAt(0),y=[0];for(o=0;o<n.length;++o){for(var _=0,A=n[o];_<y.length;++_)A+=y[_]<<8,y[_]=A%h,A=A/h|0;for(;A>0;)y.push(A%h),A=A/h|0}for(o=0;n[o]===0&&o<n.length-1;++o)v+=g;for(o=y.length-1;o>=0;--o)v+=c[y[o]]}if(u){var S=new RegExp(".{1,"+u+"}","g");v=v.match(S).join(`\r
`)}return v},r.decode=function(n,c){if(typeof n!="string")throw new TypeError('"input" must be a string.');if(typeof c!="string")throw new TypeError('"alphabet" must be a string.');var u=t[c];if(!u){u=t[c]=[];for(var v=0;v<c.length;++v)u[c.charCodeAt(v)]=v}n=n.replace(/\s/g,"");for(var o=c.length,h=c.charAt(0),g=[0],v=0;v<n.length;v++){var y=u[n.charCodeAt(v)];if(y===void 0)return;for(var _=0,A=y;_<g.length;++_)A+=g[_]*o,g[_]=A&255,A>>=8;for(;A>0;)g.push(A&255),A>>=8}for(var S=0;n[S]===h&&S<n.length-1;++S)g.push(0);return typeof Buffer<"u"?Buffer.from(g.reverse()):new Uint8Array(g.reverse())};function a(n,c){var u=0,v=c.length,o=c.charAt(0),h=[0];for(u=0;u<n.length();++u){for(var g=0,y=n.at(u);g<h.length;++g)y+=h[g]<<8,h[g]=y%v,y=y/v|0;for(;y>0;)h.push(y%v),y=y/v|0}var _="";for(u=0;n.at(u)===0&&u<n.length()-1;++u)_+=o;for(u=h.length-1;u>=0;--u)_+=c[h[u]];return _}}}),wr=Ve({"../../node_modules/node-forge/lib/util.js"(i,e){var r=sr(),t=KI(),a=e.exports=r.util=r.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){a.nextTick=process.nextTick,typeof setImmediate=="function"?a.setImmediate=setImmediate:a.setImmediate=a.nextTick;return}if(typeof setImmediate=="function"){a.setImmediate=function(){return setImmediate.apply(void 0,arguments)},a.nextTick=function(O){return setImmediate(O)};return}if(a.setImmediate=function(O){setTimeout(O,0)},typeof window<"u"&&typeof window.postMessage=="function"){let O=function(G){if(G.source===window&&G.data===R){G.stopPropagation();var E=P.slice();P.length=0,E.forEach(function(s){s()})}};var R="forge.setImmediate",P=[];a.setImmediate=function(G){P.push(G),P.length===1&&window.postMessage(R,"*")},window.addEventListener("message",O,!0)}if(typeof MutationObserver<"u"){var D=Date.now(),q=!0,k=document.createElement("div"),P=[];new MutationObserver(function(){var G=P.slice();P.length=0,G.forEach(function(E){E()})}).observe(k,{attributes:!0});var U=a.setImmediate;a.setImmediate=function(G){Date.now()-D>15?(D=Date.now(),U(G)):(P.push(G),P.length===1&&k.setAttribute("a",q=!q))}}a.nextTick=a.setImmediate})(),a.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,a.globalScope=function(){return a.isNodejs?globalThis:typeof self>"u"?window:self}(),a.isArray=Array.isArray||function(R){return Object.prototype.toString.call(R)==="[object Array]"},a.isArrayBuffer=function(R){return typeof ArrayBuffer<"u"&&R instanceof ArrayBuffer},a.isArrayBufferView=function(R){return R&&a.isArrayBuffer(R.buffer)&&R.byteLength!==void 0};function n(R){if(!(R===8||R===16||R===24||R===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+R)}a.ByteBuffer=c;function c(R){if(this.data="",this.read=0,typeof R=="string")this.data=R;else if(a.isArrayBuffer(R)||a.isArrayBufferView(R))if(typeof Buffer<"u"&&R instanceof Buffer)this.data=R.toString("binary");else{var P=new Uint8Array(R);try{this.data=String.fromCharCode.apply(null,P)}catch{for(var D=0;D<P.length;++D)this.putByte(P[D])}}else(R instanceof c||typeof R=="object"&&typeof R.data=="string"&&typeof R.read=="number")&&(this.data=R.data,this.read=R.read);this._constructedStringLength=0}a.ByteStringBuffer=c;var u=4096;a.ByteStringBuffer.prototype._optimizeConstructedString=function(R){this._constructedStringLength+=R,this._constructedStringLength>u&&(this.data.substr(0,1),this._constructedStringLength=0)},a.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},a.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},a.ByteStringBuffer.prototype.putByte=function(R){return this.putBytes(String.fromCharCode(R))},a.ByteStringBuffer.prototype.fillWithByte=function(R,P){R=String.fromCharCode(R);for(var D=this.data;P>0;)P&1&&(D+=R),P>>>=1,P>0&&(R+=R);return this.data=D,this._optimizeConstructedString(P),this},a.ByteStringBuffer.prototype.putBytes=function(R){return this.data+=R,this._optimizeConstructedString(R.length),this},a.ByteStringBuffer.prototype.putString=function(R){return this.putBytes(a.encodeUtf8(R))},a.ByteStringBuffer.prototype.putInt16=function(R){return this.putBytes(String.fromCharCode(R>>8&255)+String.fromCharCode(R&255))},a.ByteStringBuffer.prototype.putInt24=function(R){return this.putBytes(String.fromCharCode(R>>16&255)+String.fromCharCode(R>>8&255)+String.fromCharCode(R&255))},a.ByteStringBuffer.prototype.putInt32=function(R){return this.putBytes(String.fromCharCode(R>>24&255)+String.fromCharCode(R>>16&255)+String.fromCharCode(R>>8&255)+String.fromCharCode(R&255))},a.ByteStringBuffer.prototype.putInt16Le=function(R){return this.putBytes(String.fromCharCode(R&255)+String.fromCharCode(R>>8&255))},a.ByteStringBuffer.prototype.putInt24Le=function(R){return this.putBytes(String.fromCharCode(R&255)+String.fromCharCode(R>>8&255)+String.fromCharCode(R>>16&255))},a.ByteStringBuffer.prototype.putInt32Le=function(R){return this.putBytes(String.fromCharCode(R&255)+String.fromCharCode(R>>8&255)+String.fromCharCode(R>>16&255)+String.fromCharCode(R>>24&255))},a.ByteStringBuffer.prototype.putInt=function(R,P){n(P);var D="";do P-=8,D+=String.fromCharCode(R>>P&255);while(P>0);return this.putBytes(D)},a.ByteStringBuffer.prototype.putSignedInt=function(R,P){return R<0&&(R+=2<<P-1),this.putInt(R,P)},a.ByteStringBuffer.prototype.putBuffer=function(R){return this.putBytes(R.getBytes())},a.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},a.ByteStringBuffer.prototype.getInt16=function(){var R=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,R},a.ByteStringBuffer.prototype.getInt24=function(){var R=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,R},a.ByteStringBuffer.prototype.getInt32=function(){var R=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,R},a.ByteStringBuffer.prototype.getInt16Le=function(){var R=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,R},a.ByteStringBuffer.prototype.getInt24Le=function(){var R=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,R},a.ByteStringBuffer.prototype.getInt32Le=function(){var R=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,R},a.ByteStringBuffer.prototype.getInt=function(R){n(R);var P=0;do P=(P<<8)+this.data.charCodeAt(this.read++),R-=8;while(R>0);return P},a.ByteStringBuffer.prototype.getSignedInt=function(R){var P=this.getInt(R),D=2<<R-2;return P>=D&&(P-=D<<1),P},a.ByteStringBuffer.prototype.getBytes=function(R){var P;return R?(R=Math.min(this.length(),R),P=this.data.slice(this.read,this.read+R),this.read+=R):R===0?P="":(P=this.read===0?this.data:this.data.slice(this.read),this.clear()),P},a.ByteStringBuffer.prototype.bytes=function(R){return typeof R>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+R)},a.ByteStringBuffer.prototype.at=function(R){return this.data.charCodeAt(this.read+R)},a.ByteStringBuffer.prototype.setAt=function(R,P){return this.data=this.data.substr(0,this.read+R)+String.fromCharCode(P)+this.data.substr(this.read+R+1),this},a.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},a.ByteStringBuffer.prototype.copy=function(){var R=a.createBuffer(this.data);return R.read=this.read,R},a.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},a.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},a.ByteStringBuffer.prototype.truncate=function(R){var P=Math.max(0,this.length()-R);return this.data=this.data.substr(this.read,P),this.read=0,this},a.ByteStringBuffer.prototype.toHex=function(){for(var R="",P=this.read;P<this.data.length;++P){var D=this.data.charCodeAt(P);D<16&&(R+="0"),R+=D.toString(16)}return R},a.ByteStringBuffer.prototype.toString=function(){return a.decodeUtf8(this.bytes())};function v(R,P){P=P||{},this.read=P.readOffset||0,this.growSize=P.growSize||1024;var D=a.isArrayBuffer(R),q=a.isArrayBufferView(R);if(D||q){D?this.data=new DataView(R):this.data=new DataView(R.buffer,R.byteOffset,R.byteLength),this.write="writeOffset"in P?P.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,R!=null&&this.putBytes(R),"writeOffset"in P&&(this.write=P.writeOffset)}a.DataBuffer=v,a.DataBuffer.prototype.length=function(){return this.write-this.read},a.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},a.DataBuffer.prototype.accommodate=function(R,P){if(this.length()>=R)return this;P=Math.max(P||this.growSize,R);var D=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),q=new Uint8Array(this.length()+P);return q.set(D),this.data=new DataView(q.buffer),this},a.DataBuffer.prototype.putByte=function(R){return this.accommodate(1),this.data.setUint8(this.write++,R),this},a.DataBuffer.prototype.fillWithByte=function(R,P){this.accommodate(P);for(var D=0;D<P;++D)this.data.setUint8(R);return this},a.DataBuffer.prototype.putBytes=function(R,P){if(a.isArrayBufferView(R)){var D=new Uint8Array(R.buffer,R.byteOffset,R.byteLength),q=D.byteLength-D.byteOffset;this.accommodate(q);var k=new Uint8Array(this.data.buffer,this.write);return k.set(D),this.write+=q,this}if(a.isArrayBuffer(R)){var D=new Uint8Array(R);this.accommodate(D.byteLength);var k=new Uint8Array(this.data.buffer);return k.set(D,this.write),this.write+=D.byteLength,this}if(R instanceof a.DataBuffer||typeof R=="object"&&typeof R.read=="number"&&typeof R.write=="number"&&a.isArrayBufferView(R.data)){var D=new Uint8Array(R.data.byteLength,R.read,R.length());this.accommodate(D.byteLength);var k=new Uint8Array(R.data.byteLength,this.write);return k.set(D),this.write+=D.byteLength,this}if(R instanceof a.ByteStringBuffer&&(R=R.data,P="binary"),P=P||"binary",typeof R=="string"){var U;if(P==="hex")return this.accommodate(Math.ceil(R.length/2)),U=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.hex.decode(R,U,this.write),this;if(P==="base64")return this.accommodate(Math.ceil(R.length/4)*3),U=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.base64.decode(R,U,this.write),this;if(P==="utf8"&&(R=a.encodeUtf8(R),P="binary"),P==="binary"||P==="raw")return this.accommodate(R.length),U=new Uint8Array(this.data.buffer,this.write),this.write+=a.binary.raw.decode(U),this;if(P==="utf16")return this.accommodate(R.length*2),U=new Uint16Array(this.data.buffer,this.write),this.write+=a.text.utf16.encode(U),this;throw new Error("Invalid encoding: "+P)}throw Error("Invalid parameter: "+R)},a.DataBuffer.prototype.putBuffer=function(R){return this.putBytes(R),R.clear(),this},a.DataBuffer.prototype.putString=function(R){return this.putBytes(R,"utf16")},a.DataBuffer.prototype.putInt16=function(R){return this.accommodate(2),this.data.setInt16(this.write,R),this.write+=2,this},a.DataBuffer.prototype.putInt24=function(R){return this.accommodate(3),this.data.setInt16(this.write,R>>8&65535),this.data.setInt8(this.write,R>>16&255),this.write+=3,this},a.DataBuffer.prototype.putInt32=function(R){return this.accommodate(4),this.data.setInt32(this.write,R),this.write+=4,this},a.DataBuffer.prototype.putInt16Le=function(R){return this.accommodate(2),this.data.setInt16(this.write,R,!0),this.write+=2,this},a.DataBuffer.prototype.putInt24Le=function(R){return this.accommodate(3),this.data.setInt8(this.write,R>>16&255),this.data.setInt16(this.write,R>>8&65535,!0),this.write+=3,this},a.DataBuffer.prototype.putInt32Le=function(R){return this.accommodate(4),this.data.setInt32(this.write,R,!0),this.write+=4,this},a.DataBuffer.prototype.putInt=function(R,P){n(P),this.accommodate(P/8);do P-=8,this.data.setInt8(this.write++,R>>P&255);while(P>0);return this},a.DataBuffer.prototype.putSignedInt=function(R,P){return n(P),this.accommodate(P/8),R<0&&(R+=2<<P-1),this.putInt(R,P)},a.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},a.DataBuffer.prototype.getInt16=function(){var R=this.data.getInt16(this.read);return this.read+=2,R},a.DataBuffer.prototype.getInt24=function(){var R=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,R},a.DataBuffer.prototype.getInt32=function(){var R=this.data.getInt32(this.read);return this.read+=4,R},a.DataBuffer.prototype.getInt16Le=function(){var R=this.data.getInt16(this.read,!0);return this.read+=2,R},a.DataBuffer.prototype.getInt24Le=function(){var R=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,R},a.DataBuffer.prototype.getInt32Le=function(){var R=this.data.getInt32(this.read,!0);return this.read+=4,R},a.DataBuffer.prototype.getInt=function(R){n(R);var P=0;do P=(P<<8)+this.data.getInt8(this.read++),R-=8;while(R>0);return P},a.DataBuffer.prototype.getSignedInt=function(R){var P=this.getInt(R),D=2<<R-2;return P>=D&&(P-=D<<1),P},a.DataBuffer.prototype.getBytes=function(R){var P;return R?(R=Math.min(this.length(),R),P=this.data.slice(this.read,this.read+R),this.read+=R):R===0?P="":(P=this.read===0?this.data:this.data.slice(this.read),this.clear()),P},a.DataBuffer.prototype.bytes=function(R){return typeof R>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+R)},a.DataBuffer.prototype.at=function(R){return this.data.getUint8(this.read+R)},a.DataBuffer.prototype.setAt=function(R,P){return this.data.setUint8(R,P),this},a.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},a.DataBuffer.prototype.copy=function(){return new a.DataBuffer(this)},a.DataBuffer.prototype.compact=function(){if(this.read>0){var R=new Uint8Array(this.data.buffer,this.read),P=new Uint8Array(R.byteLength);P.set(R),this.data=new DataView(P),this.write-=this.read,this.read=0}return this},a.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},a.DataBuffer.prototype.truncate=function(R){return this.write=Math.max(0,this.length()-R),this.read=Math.min(this.read,this.write),this},a.DataBuffer.prototype.toHex=function(){for(var R="",P=this.read;P<this.data.byteLength;++P){var D=this.data.getUint8(P);D<16&&(R+="0"),R+=D.toString(16)}return R},a.DataBuffer.prototype.toString=function(R){var P=new Uint8Array(this.data,this.read,this.length());if(R=R||"utf8",R==="binary"||R==="raw")return a.binary.raw.encode(P);if(R==="hex")return a.binary.hex.encode(P);if(R==="base64")return a.binary.base64.encode(P);if(R==="utf8")return a.text.utf8.decode(P);if(R==="utf16")return a.text.utf16.decode(P);throw new Error("Invalid encoding: "+R)},a.createBuffer=function(R,P){return P=P||"raw",R!==void 0&&P==="utf8"&&(R=a.encodeUtf8(R)),new a.ByteBuffer(R)},a.fillString=function(R,P){for(var D="";P>0;)P&1&&(D+=R),P>>>=1,P>0&&(R+=R);return D},a.xorBytes=function(R,P,D){for(var q="",k="",U="",O=0,G=0;D>0;--D,++O)k=R.charCodeAt(O)^P.charCodeAt(O),G>=10&&(q+=U,U="",G=0),U+=String.fromCharCode(k),++G;return q+=U,q},a.hexToBytes=function(R){var P="",D=0;for(R.length&!0&&(D=1,P+=String.fromCharCode(parseInt(R[0],16)));D<R.length;D+=2)P+=String.fromCharCode(parseInt(R.substr(D,2),16));return P},a.bytesToHex=function(R){return a.createBuffer(R).toHex()},a.int32ToBytes=function(R){return String.fromCharCode(R>>24&255)+String.fromCharCode(R>>16&255)+String.fromCharCode(R>>8&255)+String.fromCharCode(R&255)};var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],g="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";a.encode64=function(R,P){for(var D="",q="",k,U,O,G=0;G<R.length;)k=R.charCodeAt(G++),U=R.charCodeAt(G++),O=R.charCodeAt(G++),D+=o.charAt(k>>2),D+=o.charAt((k&3)<<4|U>>4),isNaN(U)?D+="==":(D+=o.charAt((U&15)<<2|O>>6),D+=isNaN(O)?"=":o.charAt(O&63)),P&&D.length>P&&(q+=D.substr(0,P)+`\r
`,D=D.substr(P));return q+=D,q},a.decode64=function(R){R=R.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var P="",D,q,k,U,O=0;O<R.length;)D=h[R.charCodeAt(O++)-43],q=h[R.charCodeAt(O++)-43],k=h[R.charCodeAt(O++)-43],U=h[R.charCodeAt(O++)-43],P+=String.fromCharCode(D<<2|q>>4),k!==64&&(P+=String.fromCharCode((q&15)<<4|k>>2),U!==64&&(P+=String.fromCharCode((k&3)<<6|U)));return P},a.encodeUtf8=function(R){return unescape(encodeURIComponent(R))},a.decodeUtf8=function(R){return decodeURIComponent(escape(R))},a.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:t.encode,decode:t.decode}},a.binary.raw.encode=function(R){return String.fromCharCode.apply(null,R)},a.binary.raw.decode=function(R,P,D){var q=P;q||(q=new Uint8Array(R.length)),D=D||0;for(var k=D,U=0;U<R.length;++U)q[k++]=R.charCodeAt(U);return P?k-D:q},a.binary.hex.encode=a.bytesToHex,a.binary.hex.decode=function(R,P,D){var q=P;q||(q=new Uint8Array(Math.ceil(R.length/2))),D=D||0;var k=0,U=D;for(R.length&1&&(k=1,q[U++]=parseInt(R[0],16));k<R.length;k+=2)q[U++]=parseInt(R.substr(k,2),16);return P?U-D:q},a.binary.base64.encode=function(R,P){for(var D="",q="",k,U,O,G=0;G<R.byteLength;)k=R[G++],U=R[G++],O=R[G++],D+=o.charAt(k>>2),D+=o.charAt((k&3)<<4|U>>4),isNaN(U)?D+="==":(D+=o.charAt((U&15)<<2|O>>6),D+=isNaN(O)?"=":o.charAt(O&63)),P&&D.length>P&&(q+=D.substr(0,P)+`\r
`,D=D.substr(P));return q+=D,q},a.binary.base64.decode=function(R,P,D){var q=P;q||(q=new Uint8Array(Math.ceil(R.length/4)*3)),R=R.replace(/[^A-Za-z0-9\+\/\=]/g,""),D=D||0;for(var k,U,O,G,E=0,s=D;E<R.length;)k=h[R.charCodeAt(E++)-43],U=h[R.charCodeAt(E++)-43],O=h[R.charCodeAt(E++)-43],G=h[R.charCodeAt(E++)-43],q[s++]=k<<2|U>>4,O!==64&&(q[s++]=(U&15)<<4|O>>2,G!==64&&(q[s++]=(O&3)<<6|G));return P?s-D:q.subarray(0,s)},a.binary.base58.encode=function(R,P){return a.binary.baseN.encode(R,g,P)},a.binary.base58.decode=function(R,P){return a.binary.baseN.decode(R,g,P)},a.text={utf8:{},utf16:{}},a.text.utf8.encode=function(R,P,D){R=a.encodeUtf8(R);var q=P;q||(q=new Uint8Array(R.length)),D=D||0;for(var k=D,U=0;U<R.length;++U)q[k++]=R.charCodeAt(U);return P?k-D:q},a.text.utf8.decode=function(R){return a.decodeUtf8(String.fromCharCode.apply(null,R))},a.text.utf16.encode=function(R,P,D){var q=P;q||(q=new Uint8Array(R.length*2));var k=new Uint16Array(q.buffer);D=D||0;for(var U=D,O=D,G=0;G<R.length;++G)k[O++]=R.charCodeAt(G),U+=2;return P?U-D:q},a.text.utf16.decode=function(R){return String.fromCharCode.apply(null,new Uint16Array(R.buffer))},a.deflate=function(R,P,D){if(P=a.decode64(R.deflate(a.encode64(P)).rval),D){var q=2,k=P.charCodeAt(1);k&32&&(q=6),P=P.substring(q,P.length-4)}return P},a.inflate=function(R,P,D){var q=R.inflate(a.encode64(P)).rval;return q===null?null:a.decode64(q)};var y=function(R,P,D){if(!R)throw new Error("WebStorage not available.");var q;if(D===null?q=R.removeItem(P):(D=a.encode64(JSON.stringify(D)),q=R.setItem(P,D)),typeof q<"u"&&q.rval!==!0){var k=new Error(q.error.message);throw k.id=q.error.id,k.name=q.error.name,k}},_=function(R,P){if(!R)throw new Error("WebStorage not available.");var D=R.getItem(P);if(R.init)if(D.rval===null){if(D.error){var q=new Error(D.error.message);throw q.id=D.error.id,q.name=D.error.name,q}D=null}else D=D.rval;return D!==null&&(D=JSON.parse(a.decode64(D))),D},A=function(R,P,D,q){var k=_(R,P);k===null&&(k={}),k[D]=q,y(R,P,k)},S=function(R,P,D){var q=_(R,P);return q!==null&&(q=D in q?q[D]:null),q},T=function(R,P,D){var q=_(R,P);if(q!==null&&D in q){delete q[D];var k=!0;for(var U in q){k=!1;break}k&&(q=null),y(R,P,q)}},B=function(R,P){y(R,P,null)},M=function(R,P,D){var q=null;typeof D>"u"&&(D=["web","flash"]);var k,U=!1,O=null;for(var G in D){k=D[G];try{if(k==="flash"||k==="both"){if(P[0]===null)throw new Error("Flash local storage not available.");q=R.apply(this,P),U=k==="flash"}(k==="web"||k==="both")&&(P[0]=localStorage,q=R.apply(this,P),U=!0)}catch(E){O=E}if(U)break}if(!U)throw O;return q};a.setItem=function(R,P,D,q,k){M(A,arguments,k)},a.getItem=function(R,P,D,q){return M(S,arguments,q)},a.removeItem=function(R,P,D,q){M(T,arguments,q)},a.clearItems=function(R,P,D){M(B,arguments,D)},a.isEmpty=function(R){for(var P in R)if(R.hasOwnProperty(P))return!1;return!0},a.format=function(R){for(var P=/%./g,D,q,k=0,U=[],O=0;D=P.exec(R);){q=R.substring(O,P.lastIndex-2),q.length>0&&U.push(q),O=P.lastIndex;var G=D[0][1];switch(G){case"s":case"o":k<arguments.length?U.push(arguments[k+++1]):U.push("<?>");break;case"%":U.push("%");break;default:U.push("<%"+G+"?>")}}return U.push(R.substring(O)),U.join("")},a.formatNumber=function(R,P,D,q){var k=R,U=isNaN(P=Math.abs(P))?2:P,O=D===void 0?",":D,G=q===void 0?".":q,E=k<0?"-":"",s=parseInt(k=Math.abs(+k||0).toFixed(U),10)+"",l=s.length>3?s.length%3:0;return E+(l?s.substr(0,l)+G:"")+s.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+G)+(U?O+Math.abs(k-s).toFixed(U).slice(2):"")},a.formatSize=function(R){return R>=1073741824?R=a.formatNumber(R/1073741824,2,".","")+" GiB":R>=1048576?R=a.formatNumber(R/1048576,2,".","")+" MiB":R>=1024?R=a.formatNumber(R/1024,0)+" KiB":R=a.formatNumber(R,0)+" bytes",R},a.bytesFromIP=function(R){return R.indexOf(".")!==-1?a.bytesFromIPv4(R):R.indexOf(":")!==-1?a.bytesFromIPv6(R):null},a.bytesFromIPv4=function(R){if(R=R.split("."),R.length!==4)return null;for(var P=a.createBuffer(),D=0;D<R.length;++D){var q=parseInt(R[D],10);if(isNaN(q))return null;P.putByte(q)}return P.getBytes()},a.bytesFromIPv6=function(R){var P=0;R=R.split(":").filter(function(O){return O.length===0&&++P,!0});for(var D=(8-R.length+P)*2,q=a.createBuffer(),k=0;k<8;++k){if(!R[k]||R[k].length===0){q.fillWithByte(0,D),D=0;continue}var U=a.hexToBytes(R[k]);U.length<2&&q.putByte(0),q.putBytes(U)}return q.getBytes()},a.bytesToIP=function(R){return R.length===4?a.bytesToIPv4(R):R.length===16?a.bytesToIPv6(R):null},a.bytesToIPv4=function(R){if(R.length!==4)return null;for(var P=[],D=0;D<R.length;++D)P.push(R.charCodeAt(D));return P.join(".")},a.bytesToIPv6=function(R){if(R.length!==16)return null;for(var P=[],D=[],q=0,k=0;k<R.length;k+=2){for(var U=a.bytesToHex(R[k]+R[k+1]);U[0]==="0"&&U!=="0";)U=U.substr(1);if(U==="0"){var O=D[D.length-1],G=P.length;!O||G!==O.end+1?D.push({start:G,end:G}):(O.end=G,O.end-O.start>D[q].end-D[q].start&&(q=D.length-1))}P.push(U)}if(D.length>0){var E=D[q];E.end-E.start>0&&(P.splice(E.start,E.end-E.start+1,""),E.start===0&&P.unshift(""),E.end===7&&P.push(""))}return P.join(":")},a.estimateCores=function(R,P){if(typeof R=="function"&&(P=R,R={}),R=R||{},"cores"in a&&!R.update)return P(null,a.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return a.cores=navigator.hardwareConcurrency,P(null,a.cores);if(typeof Worker>"u")return a.cores=1,P(null,a.cores);if(typeof Blob>"u")return a.cores=2,P(null,a.cores);var D=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(O){var G=Date.now(),E=G+4;self.postMessage({st:G,et:E})})}).toString(),")()"],{type:"application/javascript"}));q([],5,16);function q(O,G,E){if(G===0){var s=Math.floor(O.reduce(function(l,d){return l+d},0)/O.length);return a.cores=Math.max(1,s),URL.revokeObjectURL(D),P(null,a.cores)}k(E,function(l,d){O.push(U(E,d)),q(O,G-1,E)})}function k(O,G){for(var E=[],s=[],l=0;l<O;++l){var d=new Worker(D);d.addEventListener("message",function(p){if(s.push(p.data),s.length===O){for(var m=0;m<O;++m)E[m].terminate();G(null,s)}}),E.push(d)}for(var l=0;l<O;++l)E[l].postMessage(l)}function U(O,G){for(var E=[],s=0;s<O;++s)for(var l=G[s],d=E[s]=[],p=0;p<O;++p)if(s!==p){var m=G[p];(l.st>m.st&&l.st<m.et||m.st>l.st&&m.st<l.et)&&d.push(p)}return E.reduce(function(w,x){return Math.max(w,x.length)},0)}}}}),K1=Ve({"../../node_modules/node-forge/lib/cipher.js"(i,e){var r=sr();wr(),e.exports=r.cipher=r.cipher||{},r.cipher.algorithms=r.cipher.algorithms||{},r.cipher.createCipher=function(a,n){var c=a;if(typeof c=="string"&&(c=r.cipher.getAlgorithm(c),c&&(c=c())),!c)throw new Error("Unsupported algorithm: "+a);return new r.cipher.BlockCipher({algorithm:c,key:n,decrypt:!1})},r.cipher.createDecipher=function(a,n){var c=a;if(typeof c=="string"&&(c=r.cipher.getAlgorithm(c),c&&(c=c())),!c)throw new Error("Unsupported algorithm: "+a);return new r.cipher.BlockCipher({algorithm:c,key:n,decrypt:!0})},r.cipher.registerAlgorithm=function(a,n){a=a.toUpperCase(),r.cipher.algorithms[a]=n},r.cipher.getAlgorithm=function(a){return a=a.toUpperCase(),a in r.cipher.algorithms?r.cipher.algorithms[a]:null};var t=r.cipher.BlockCipher=function(a){this.algorithm=a.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=a.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=a.decrypt,this.algorithm.initialize(a)};t.prototype.start=function(a){a=a||{};var n={};for(var c in a)n[c]=a[c];n.decrypt=this._decrypt,this._finish=!1,this._input=r.util.createBuffer(),this.output=a.output||r.util.createBuffer(),this.mode.start(n)},t.prototype.update=function(a){for(a&&this._input.putBuffer(a);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},t.prototype.finish=function(a){a&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(c){return a(this.blockSize,c,!1)},this.mode.unpad=function(c){return a(this.blockSize,c,!0)});var n={};return n.decrypt=this._decrypt,n.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,n)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,n))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,n))}}}),C_=Ve({"../../node_modules/node-forge/lib/cipherModes.js"(i,e){var r=sr();wr(),r.cipher=r.cipher||{};var t=e.exports=r.cipher.modes=r.cipher.modes||{};t.ecb=function(u){u=u||{},this.name="ECB",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},t.ecb.prototype.start=function(u){},t.ecb.prototype.encrypt=function(u,v,o){if(u.length()<this.blockSize&&!(o&&u.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=u.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)v.putInt32(this._outBlock[h])},t.ecb.prototype.decrypt=function(u,v,o){if(u.length()<this.blockSize&&!(o&&u.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=u.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)v.putInt32(this._outBlock[h])},t.ecb.prototype.pad=function(u,v){var o=u.length()===this.blockSize?this.blockSize:this.blockSize-u.length();return u.fillWithByte(o,o),!0},t.ecb.prototype.unpad=function(u,v){if(v.overflow>0)return!1;var o=u.length(),h=u.at(o-1);return h>this.blockSize<<2?!1:(u.truncate(h),!0)},t.cbc=function(u){u=u||{},this.name="CBC",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},t.cbc.prototype.start=function(u){if(u.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in u)this._iv=a(u.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},t.cbc.prototype.encrypt=function(u,v,o){if(u.length()<this.blockSize&&!(o&&u.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=this._prev[h]^u.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)v.putInt32(this._outBlock[h]);this._prev=this._outBlock},t.cbc.prototype.decrypt=function(u,v,o){if(u.length()<this.blockSize&&!(o&&u.length()>0))return!0;for(var h=0;h<this._ints;++h)this._inBlock[h]=u.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var h=0;h<this._ints;++h)v.putInt32(this._prev[h]^this._outBlock[h]);this._prev=this._inBlock.slice(0)},t.cbc.prototype.pad=function(u,v){var o=u.length()===this.blockSize?this.blockSize:this.blockSize-u.length();return u.fillWithByte(o,o),!0},t.cbc.prototype.unpad=function(u,v){if(v.overflow>0)return!1;var o=u.length(),h=u.at(o-1);return h>this.blockSize<<2?!1:(u.truncate(h),!0)},t.cfb=function(u){u=u||{},this.name="CFB",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},t.cfb.prototype.start=function(u){if(!("iv"in u))throw new Error("Invalid IV parameter.");this._iv=a(u.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.cfb.prototype.encrypt=function(u,v,o){var h=u.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var g=0;g<this._ints;++g)this._inBlock[g]=u.getInt32()^this._outBlock[g],v.putInt32(this._inBlock[g]);return}var y=(this.blockSize-h)%this.blockSize;y>0&&(y=this.blockSize-y),this._partialOutput.clear();for(var g=0;g<this._ints;++g)this._partialBlock[g]=u.getInt32()^this._outBlock[g],this._partialOutput.putInt32(this._partialBlock[g]);if(y>0)u.read-=this.blockSize;else for(var g=0;g<this._ints;++g)this._inBlock[g]=this._partialBlock[g];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),y>0&&!o)return v.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=y,!0;v.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0},t.cfb.prototype.decrypt=function(u,v,o){var h=u.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var g=0;g<this._ints;++g)this._inBlock[g]=u.getInt32(),v.putInt32(this._inBlock[g]^this._outBlock[g]);return}var y=(this.blockSize-h)%this.blockSize;y>0&&(y=this.blockSize-y),this._partialOutput.clear();for(var g=0;g<this._ints;++g)this._partialBlock[g]=u.getInt32(),this._partialOutput.putInt32(this._partialBlock[g]^this._outBlock[g]);if(y>0)u.read-=this.blockSize;else for(var g=0;g<this._ints;++g)this._inBlock[g]=this._partialBlock[g];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),y>0&&!o)return v.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=y,!0;v.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0},t.ofb=function(u){u=u||{},this.name="OFB",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},t.ofb.prototype.start=function(u){if(!("iv"in u))throw new Error("Invalid IV parameter.");this._iv=a(u.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.ofb.prototype.encrypt=function(u,v,o){var h=u.length();if(u.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var g=0;g<this._ints;++g)v.putInt32(u.getInt32()^this._outBlock[g]),this._inBlock[g]=this._outBlock[g];return}var y=(this.blockSize-h)%this.blockSize;y>0&&(y=this.blockSize-y),this._partialOutput.clear();for(var g=0;g<this._ints;++g)this._partialOutput.putInt32(u.getInt32()^this._outBlock[g]);if(y>0)u.read-=this.blockSize;else for(var g=0;g<this._ints;++g)this._inBlock[g]=this._outBlock[g];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),y>0&&!o)return v.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=y,!0;v.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0},t.ofb.prototype.decrypt=t.ofb.prototype.encrypt,t.ctr=function(u){u=u||{},this.name="CTR",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0},t.ctr.prototype.start=function(u){if(!("iv"in u))throw new Error("Invalid IV parameter.");this._iv=a(u.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},t.ctr.prototype.encrypt=function(u,v,o){var h=u.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize)for(var g=0;g<this._ints;++g)v.putInt32(u.getInt32()^this._outBlock[g]);else{var y=(this.blockSize-h)%this.blockSize;y>0&&(y=this.blockSize-y),this._partialOutput.clear();for(var g=0;g<this._ints;++g)this._partialOutput.putInt32(u.getInt32()^this._outBlock[g]);if(y>0&&(u.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),y>0&&!o)return v.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=y,!0;v.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0}n(this._inBlock)},t.ctr.prototype.decrypt=t.ctr.prototype.encrypt,t.gcm=function(u){u=u||{},this.name="GCM",this.cipher=u.cipher,this.blockSize=u.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=r.util.createBuffer(),this._partialBytes=0,this._R=3774873600},t.gcm.prototype.start=function(u){if(!("iv"in u))throw new Error("Invalid IV parameter.");var v=r.util.createBuffer(u.iv);this._cipherLength=0;var o;if("additionalData"in u?o=r.util.createBuffer(u.additionalData):o=r.util.createBuffer(),"tagLength"in u?this._tagLength=u.tagLength:this._tagLength=128,this._tag=null,u.decrypt&&(this._tag=r.util.createBuffer(u.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var h=v.length();if(h===12)this._j0=[v.getInt32(),v.getInt32(),v.getInt32(),1];else{for(this._j0=[0,0,0,0];v.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[v.getInt32(),v.getInt32(),v.getInt32(),v.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(c(h*8)))}this._inBlock=this._j0.slice(0),n(this._inBlock),this._partialBytes=0,o=r.util.createBuffer(o),this._aDataLength=c(o.length()*8);var g=o.length()%this.blockSize;for(g&&o.fillWithByte(0,this.blockSize-g),this._s=[0,0,0,0];o.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[o.getInt32(),o.getInt32(),o.getInt32(),o.getInt32()])},t.gcm.prototype.encrypt=function(u,v,o){var h=u.length();if(h===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&h>=this.blockSize){for(var g=0;g<this._ints;++g)v.putInt32(this._outBlock[g]^=u.getInt32());this._cipherLength+=this.blockSize}else{var y=(this.blockSize-h)%this.blockSize;y>0&&(y=this.blockSize-y),this._partialOutput.clear();for(var g=0;g<this._ints;++g)this._partialOutput.putInt32(u.getInt32()^this._outBlock[g]);if(y<=0||o){if(o){var _=h%this.blockSize;this._cipherLength+=_,this._partialOutput.truncate(this.blockSize-_)}else this._cipherLength+=this.blockSize;for(var g=0;g<this._ints;++g)this._outBlock[g]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),y>0&&!o)return u.read-=this.blockSize,v.putBytes(this._partialOutput.getBytes(y-this._partialBytes)),this._partialBytes=y,!0;v.putBytes(this._partialOutput.getBytes(h-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),n(this._inBlock)},t.gcm.prototype.decrypt=function(u,v,o){var h=u.length();if(h<this.blockSize&&!(o&&h>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),n(this._inBlock),this._hashBlock[0]=u.getInt32(),this._hashBlock[1]=u.getInt32(),this._hashBlock[2]=u.getInt32(),this._hashBlock[3]=u.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var g=0;g<this._ints;++g)v.putInt32(this._outBlock[g]^this._hashBlock[g]);h<this.blockSize?this._cipherLength+=h%this.blockSize:this._cipherLength+=this.blockSize},t.gcm.prototype.afterFinish=function(u,v){var o=!0;v.decrypt&&v.overflow&&u.truncate(this.blockSize-v.overflow),this.tag=r.util.createBuffer();var h=this._aDataLength.concat(c(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,h);var g=[];this.cipher.encrypt(this._j0,g);for(var y=0;y<this._ints;++y)this.tag.putInt32(this._s[y]^g[y]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),v.decrypt&&this.tag.bytes()!==this._tag&&(o=!1),o},t.gcm.prototype.multiply=function(u,v){for(var o=[0,0,0,0],h=v.slice(0),g=0;g<128;++g){var y=u[g/32|0]&1<<31-g%32;y&&(o[0]^=h[0],o[1]^=h[1],o[2]^=h[2],o[3]^=h[3]),this.pow(h,h)}return o},t.gcm.prototype.pow=function(u,v){for(var o=u[3]&1,h=3;h>0;--h)v[h]=u[h]>>>1|(u[h-1]&1)<<31;v[0]=u[0]>>>1,o&&(v[0]^=this._R)},t.gcm.prototype.tableMultiply=function(u){for(var v=[0,0,0,0],o=0;o<32;++o){var h=o/8|0,g=u[h]>>>(7-o%8)*4&15,y=this._m[o][g];v[0]^=y[0],v[1]^=y[1],v[2]^=y[2],v[3]^=y[3]}return v},t.gcm.prototype.ghash=function(u,v,o){return v[0]^=o[0],v[1]^=o[1],v[2]^=o[2],v[3]^=o[3],this.tableMultiply(v)},t.gcm.prototype.generateHashTable=function(u,v){for(var o=8/v,h=4*o,g=16*o,y=new Array(g),_=0;_<g;++_){var A=[0,0,0,0],S=_/h|0,T=(h-1-_%h)*v;A[S]=1<<v-1<<T,y[_]=this.generateSubHashTable(this.multiply(A,u),v)}return y},t.gcm.prototype.generateSubHashTable=function(u,v){var o=1<<v,h=o>>>1,g=new Array(o);g[h]=u.slice(0);for(var y=h>>>1;y>0;)this.pow(g[2*y],g[y]=[]),y>>=1;for(y=2;y<h;){for(var _=1;_<y;++_){var A=g[y],S=g[_];g[y+_]=[A[0]^S[0],A[1]^S[1],A[2]^S[2],A[3]^S[3]]}y*=2}for(g[0]=[0,0,0,0],y=h+1;y<o;++y){var T=g[y^h];g[y]=[u[0]^T[0],u[1]^T[1],u[2]^T[2],u[3]^T[3]]}return g};function a(u,v){if(typeof u=="string"&&(u=r.util.createBuffer(u)),r.util.isArray(u)&&u.length>4){var o=u;u=r.util.createBuffer();for(var h=0;h<o.length;++h)u.putByte(o[h])}if(u.length()<v)throw new Error("Invalid IV length; got "+u.length()+" bytes and expected "+v+" bytes.");if(!r.util.isArray(u)){for(var g=[],y=v/4,h=0;h<y;++h)g.push(u.getInt32());u=g}return u}function n(u){u[u.length-1]=u[u.length-1]+1&4294967295}function c(u){return[u/4294967296|0,u&4294967295]}}}),Ja=Ve({"../../node_modules/node-forge/lib/aes.js"(i,e){var r=sr();K1(),C_(),wr(),e.exports=r.aes=r.aes||{},r.aes.startEncrypting=function(S,T,B,M){var R=A({key:S,output:B,decrypt:!1,mode:M});return R.start(T),R},r.aes.createEncryptionCipher=function(S,T){return A({key:S,output:null,decrypt:!1,mode:T})},r.aes.startDecrypting=function(S,T,B,M){var R=A({key:S,output:B,decrypt:!0,mode:M});return R.start(T),R},r.aes.createDecryptionCipher=function(S,T){return A({key:S,output:null,decrypt:!0,mode:T})},r.aes.Algorithm=function(S,T){a||g();var B=this;B.name=S,B.mode=new T({blockSize:16,cipher:{encrypt:function(M,R){return _(B._w,M,R,!1)},decrypt:function(M,R){return _(B._w,M,R,!0)}}}),B._init=!1},r.aes.Algorithm.prototype.initialize=function(S){if(!this._init){var T=S.key,B;if(typeof T=="string"&&(T.length===16||T.length===24||T.length===32))T=r.util.createBuffer(T);else if(r.util.isArray(T)&&(T.length===16||T.length===24||T.length===32)){B=T,T=r.util.createBuffer();for(var M=0;M<B.length;++M)T.putByte(B[M])}if(!r.util.isArray(T)){B=T,T=[];var R=B.length();if(R===16||R===24||R===32){R=R>>>2;for(var M=0;M<R;++M)T.push(B.getInt32())}}if(!r.util.isArray(T)||!(T.length===4||T.length===6||T.length===8))throw new Error("Invalid key parameter.");var P=this.mode.name,D=["CFB","OFB","CTR","GCM"].indexOf(P)!==-1;this._w=y(T,S.decrypt&&!D),this._init=!0}},r.aes._expandKey=function(S,T){return a||g(),y(S,T)},r.aes._updateBlock=_,t("AES-ECB",r.cipher.modes.ecb),t("AES-CBC",r.cipher.modes.cbc),t("AES-CFB",r.cipher.modes.cfb),t("AES-OFB",r.cipher.modes.ofb),t("AES-CTR",r.cipher.modes.ctr),t("AES-GCM",r.cipher.modes.gcm);function t(S,T){var B=function(){return new r.aes.Algorithm(S,T)};r.cipher.registerAlgorithm(S,B)}var a=!1,n=4,c,u,v,o,h;function g(){a=!0,v=[0,1,2,4,8,16,32,64,128,27,54];for(var S=new Array(256),T=0;T<128;++T)S[T]=T<<1,S[T+128]=T+128<<1^283;c=new Array(256),u=new Array(256),o=new Array(4),h=new Array(4);for(var T=0;T<4;++T)o[T]=new Array(256),h[T]=new Array(256);for(var B=0,M=0,R,P,D,q,k,U,O,T=0;T<256;++T){q=M^M<<1^M<<2^M<<3^M<<4,q=q>>8^q&255^99,c[B]=q,u[q]=B,k=S[q],R=S[B],P=S[R],D=S[P],U=k<<24^q<<16^q<<8^(q^k),O=(R^P^D)<<24^(B^D)<<16^(B^P^D)<<8^(B^R^D);for(var G=0;G<4;++G)o[G][B]=U,h[G][q]=O,U=U<<24|U>>>8,O=O<<24|O>>>8;B===0?B=M=1:(B=R^S[S[S[R^D]]],M^=S[S[M]])}}function y(S,T){for(var B=S.slice(0),M,R=1,P=B.length,D=P+6+1,q=n*D,k=P;k<q;++k)M=B[k-1],k%P===0?(M=c[M>>>16&255]<<24^c[M>>>8&255]<<16^c[M&255]<<8^c[M>>>24]^v[R]<<24,R++):P>6&&k%P===4&&(M=c[M>>>24]<<24^c[M>>>16&255]<<16^c[M>>>8&255]<<8^c[M&255]),B[k]=B[k-P]^M;if(T){var U,O=h[0],G=h[1],E=h[2],s=h[3],l=B.slice(0);q=B.length;for(var k=0,d=q-n;k<q;k+=n,d-=n)if(k===0||k===q-n)l[k]=B[d],l[k+1]=B[d+3],l[k+2]=B[d+2],l[k+3]=B[d+1];else for(var p=0;p<n;++p)U=B[d+p],l[k+(3&-p)]=O[c[U>>>24]]^G[c[U>>>16&255]]^E[c[U>>>8&255]]^s[c[U&255]];B=l}return B}function _(S,T,B,M){var R=S.length/4-1,P,D,q,k,U;M?(P=h[0],D=h[1],q=h[2],k=h[3],U=u):(P=o[0],D=o[1],q=o[2],k=o[3],U=c);var O,G,E,s,l,d,p;O=T[0]^S[0],G=T[M?3:1]^S[1],E=T[2]^S[2],s=T[M?1:3]^S[3];for(var m=3,w=1;w<R;++w)l=P[O>>>24]^D[G>>>16&255]^q[E>>>8&255]^k[s&255]^S[++m],d=P[G>>>24]^D[E>>>16&255]^q[s>>>8&255]^k[O&255]^S[++m],p=P[E>>>24]^D[s>>>16&255]^q[O>>>8&255]^k[G&255]^S[++m],s=P[s>>>24]^D[O>>>16&255]^q[G>>>8&255]^k[E&255]^S[++m],O=l,G=d,E=p;B[0]=U[O>>>24]<<24^U[G>>>16&255]<<16^U[E>>>8&255]<<8^U[s&255]^S[++m],B[M?3:1]=U[G>>>24]<<24^U[E>>>16&255]<<16^U[s>>>8&255]<<8^U[O&255]^S[++m],B[2]=U[E>>>24]<<24^U[s>>>16&255]<<16^U[O>>>8&255]<<8^U[G&255]^S[++m],B[M?1:3]=U[s>>>24]<<24^U[O>>>16&255]<<16^U[G>>>8&255]<<8^U[E&255]^S[++m]}function A(S){S=S||{};var T=(S.mode||"CBC").toUpperCase(),B="AES-"+T,M;S.decrypt?M=r.cipher.createDecipher(B,S.key):M=r.cipher.createCipher(B,S.key);var R=M.start;return M.start=function(P,D){var q=null;D instanceof r.util.ByteBuffer&&(q=D,D={}),D=D||{},D.output=q,D.iv=P,R.call(M,D)},M}}}),ts=Ve({"../../node_modules/node-forge/lib/oids.js"(i,e){var r=sr();r.pki=r.pki||{};var t=e.exports=r.pki.oids=r.oids=r.oids||{};function a(c,u){t[c]=u,t[u]=c}function n(c,u){t[c]=u}a("1.2.840.113549.1.1.1","rsaEncryption"),a("1.2.840.113549.1.1.4","md5WithRSAEncryption"),a("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),a("1.2.840.113549.1.1.7","RSAES-OAEP"),a("1.2.840.113549.1.1.8","mgf1"),a("1.2.840.113549.1.1.9","pSpecified"),a("1.2.840.113549.1.1.10","RSASSA-PSS"),a("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),a("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),a("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),a("1.3.101.112","EdDSA25519"),a("1.2.840.10040.4.3","dsa-with-sha1"),a("1.3.14.3.2.7","desCBC"),a("1.3.14.3.2.26","sha1"),a("1.3.14.3.2.29","sha1WithRSASignature"),a("2.16.840.1.101.3.4.2.1","sha256"),a("2.16.840.1.101.3.4.2.2","sha384"),a("2.16.840.1.101.3.4.2.3","sha512"),a("2.16.840.1.101.3.4.2.4","sha224"),a("2.16.840.1.101.3.4.2.5","sha512-224"),a("2.16.840.1.101.3.4.2.6","sha512-256"),a("1.2.840.113549.2.2","md2"),a("1.2.840.113549.2.5","md5"),a("1.2.840.113549.1.7.1","data"),a("1.2.840.113549.1.7.2","signedData"),a("1.2.840.113549.1.7.3","envelopedData"),a("1.2.840.113549.1.7.4","signedAndEnvelopedData"),a("1.2.840.113549.1.7.5","digestedData"),a("1.2.840.113549.1.7.6","encryptedData"),a("1.2.840.113549.1.9.1","emailAddress"),a("1.2.840.113549.1.9.2","unstructuredName"),a("1.2.840.113549.1.9.3","contentType"),a("1.2.840.113549.1.9.4","messageDigest"),a("1.2.840.113549.1.9.5","signingTime"),a("1.2.840.113549.1.9.6","counterSignature"),a("1.2.840.113549.1.9.7","challengePassword"),a("1.2.840.113549.1.9.8","unstructuredAddress"),a("1.2.840.113549.1.9.14","extensionRequest"),a("1.2.840.113549.1.9.20","friendlyName"),a("1.2.840.113549.1.9.21","localKeyId"),a("1.2.840.113549.1.9.22.1","x509Certificate"),a("1.2.840.113549.1.12.10.1.1","keyBag"),a("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),a("1.2.840.113549.1.12.10.1.3","certBag"),a("1.2.840.113549.1.12.10.1.4","crlBag"),a("1.2.840.113549.1.12.10.1.5","secretBag"),a("1.2.840.113549.1.12.10.1.6","safeContentsBag"),a("1.2.840.113549.1.5.13","pkcs5PBES2"),a("1.2.840.113549.1.5.12","pkcs5PBKDF2"),a("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),a("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),a("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),a("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),a("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),a("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),a("1.2.840.113549.2.7","hmacWithSHA1"),a("1.2.840.113549.2.8","hmacWithSHA224"),a("1.2.840.113549.2.9","hmacWithSHA256"),a("1.2.840.113549.2.10","hmacWithSHA384"),a("1.2.840.113549.2.11","hmacWithSHA512"),a("1.2.840.113549.3.7","des-EDE3-CBC"),a("2.16.840.1.101.3.4.1.2","aes128-CBC"),a("2.16.840.1.101.3.4.1.22","aes192-CBC"),a("2.16.840.1.101.3.4.1.42","aes256-CBC"),a("2.5.4.3","commonName"),a("2.5.4.4","surname"),a("2.5.4.5","serialNumber"),a("2.5.4.6","countryName"),a("2.5.4.7","localityName"),a("2.5.4.8","stateOrProvinceName"),a("2.5.4.9","streetAddress"),a("2.5.4.10","organizationName"),a("2.5.4.11","organizationalUnitName"),a("2.5.4.12","title"),a("2.5.4.13","description"),a("2.5.4.15","businessCategory"),a("2.5.4.17","postalCode"),a("2.5.4.42","givenName"),a("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),a("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),a("2.16.840.1.113730.1.1","nsCertType"),a("2.16.840.1.113730.1.13","nsComment"),n("2.5.29.1","authorityKeyIdentifier"),n("2.5.29.2","keyAttributes"),n("2.5.29.3","certificatePolicies"),n("2.5.29.4","keyUsageRestriction"),n("2.5.29.5","policyMapping"),n("2.5.29.6","subtreesConstraint"),n("2.5.29.7","subjectAltName"),n("2.5.29.8","issuerAltName"),n("2.5.29.9","subjectDirectoryAttributes"),n("2.5.29.10","basicConstraints"),n("2.5.29.11","nameConstraints"),n("2.5.29.12","policyConstraints"),n("2.5.29.13","basicConstraints"),a("2.5.29.14","subjectKeyIdentifier"),a("2.5.29.15","keyUsage"),n("2.5.29.16","privateKeyUsagePeriod"),a("2.5.29.17","subjectAltName"),a("2.5.29.18","issuerAltName"),a("2.5.29.19","basicConstraints"),n("2.5.29.20","cRLNumber"),n("2.5.29.21","cRLReason"),n("2.5.29.22","expirationDate"),n("2.5.29.23","instructionCode"),n("2.5.29.24","invalidityDate"),n("2.5.29.25","cRLDistributionPoints"),n("2.5.29.26","issuingDistributionPoint"),n("2.5.29.27","deltaCRLIndicator"),n("2.5.29.28","issuingDistributionPoint"),n("2.5.29.29","certificateIssuer"),n("2.5.29.30","nameConstraints"),a("2.5.29.31","cRLDistributionPoints"),a("2.5.29.32","certificatePolicies"),n("2.5.29.33","policyMappings"),n("2.5.29.34","policyConstraints"),a("2.5.29.35","authorityKeyIdentifier"),n("2.5.29.36","policyConstraints"),a("2.5.29.37","extKeyUsage"),n("2.5.29.46","freshestCRL"),n("2.5.29.54","inhibitAnyPolicy"),a("1.3.6.1.4.1.11129.2.4.2","timestampList"),a("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),a("1.3.6.1.5.5.7.3.1","serverAuth"),a("1.3.6.1.5.5.7.3.2","clientAuth"),a("1.3.6.1.5.5.7.3.3","codeSigning"),a("1.3.6.1.5.5.7.3.4","emailProtection"),a("1.3.6.1.5.5.7.3.8","timeStamping")}}),Mn=Ve({"../../node_modules/node-forge/lib/asn1.js"(i,e){var r=sr();wr(),ts();var t=e.exports=r.asn1=r.asn1||{};t.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},t.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},t.create=function(v,o,h,g,y){if(r.util.isArray(g)){for(var _=[],A=0;A<g.length;++A)g[A]!==void 0&&_.push(g[A]);g=_}var S={tagClass:v,type:o,constructed:h,composed:h||r.util.isArray(g),value:g};return y&&"bitStringContents"in y&&(S.bitStringContents=y.bitStringContents,S.original=t.copy(S)),S},t.copy=function(v,o){var h;if(r.util.isArray(v)){h=[];for(var g=0;g<v.length;++g)h.push(t.copy(v[g],o));return h}return typeof v=="string"?v:(h={tagClass:v.tagClass,type:v.type,constructed:v.constructed,composed:v.composed,value:t.copy(v.value,o)},o&&!o.excludeBitStringContents&&(h.bitStringContents=v.bitStringContents),h)},t.equals=function(v,o,h){if(r.util.isArray(v)){if(!r.util.isArray(o)||v.length!==o.length)return!1;for(var g=0;g<v.length;++g)if(!t.equals(v[g],o[g]))return!1;return!0}if(typeof v!=typeof o)return!1;if(typeof v=="string")return v===o;var y=v.tagClass===o.tagClass&&v.type===o.type&&v.constructed===o.constructed&&v.composed===o.composed&&t.equals(v.value,o.value);return h&&h.includeBitStringContents&&(y=y&&v.bitStringContents===o.bitStringContents),y},t.getBerValueLength=function(v){var o=v.getByte();if(o!==128){var h,g=o&128;return g?h=v.getInt((o&127)<<3):h=o,h}};function a(v,o,h){if(h>o){var g=new Error("Too few bytes to parse DER.");throw g.available=v.length(),g.remaining=o,g.requested=h,g}}var n=function(v,o){var h=v.getByte();if(o--,h!==128){var g,y=h&128;if(!y)g=h;else{var _=h&127;a(v,o,_),g=v.getInt(_<<3)}if(g<0)throw new Error("Negative length: "+g);return g}};t.fromDer=function(v,o){o===void 0&&(o={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof o=="boolean"&&(o={strict:o,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in o||(o.strict=!0),"parseAllBytes"in o||(o.parseAllBytes=!0),"decodeBitStrings"in o||(o.decodeBitStrings=!0),typeof v=="string"&&(v=r.util.createBuffer(v));var h=v.length(),g=c(v,v.length(),0,o);if(o.parseAllBytes&&v.length()!==0){var y=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw y.byteCount=h,y.remaining=v.length(),y}return g};function c(v,o,h,g){var y;a(v,o,2);var _=v.getByte();o--;var A=_&192,S=_&31;y=v.length();var T=n(v,o);if(o-=y-v.length(),T!==void 0&&T>o){if(g.strict){var B=new Error("Too few bytes to read ASN.1 value.");throw B.available=v.length(),B.remaining=o,B.requested=T,B}T=o}var M,R,P=(_&32)===32;if(P)if(M=[],T===void 0)for(;;){if(a(v,o,2),v.bytes(2)==="\0\0"){v.getBytes(2),o-=2;break}y=v.length(),M.push(c(v,o,h+1,g)),o-=y-v.length()}else for(;T>0;)y=v.length(),M.push(c(v,T,h+1,g)),o-=y-v.length(),T-=y-v.length();if(M===void 0&&A===t.Class.UNIVERSAL&&S===t.Type.BITSTRING&&(R=v.bytes(T)),M===void 0&&g.decodeBitStrings&&A===t.Class.UNIVERSAL&&S===t.Type.BITSTRING&&T>1){var D=v.read,q=o,k=0;if(S===t.Type.BITSTRING&&(a(v,o,1),k=v.getByte(),o--),k===0)try{y=v.length();var U={strict:!0,decodeBitStrings:!0},O=c(v,o,h+1,U),G=y-v.length();o-=G,S==t.Type.BITSTRING&&G++;var E=O.tagClass;G===T&&(E===t.Class.UNIVERSAL||E===t.Class.CONTEXT_SPECIFIC)&&(M=[O])}catch{}M===void 0&&(v.read=D,o=q)}if(M===void 0){if(T===void 0){if(g.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");T=o}if(S===t.Type.BMPSTRING)for(M="";T>0;T-=2)a(v,o,2),M+=String.fromCharCode(v.getInt16()),o-=2;else M=v.getBytes(T),o-=T}var s=R===void 0?null:{bitStringContents:R};return t.create(A,S,P,M,s)}t.toDer=function(v){var o=r.util.createBuffer(),h=v.tagClass|v.type,g=r.util.createBuffer(),y=!1;if("bitStringContents"in v&&(y=!0,v.original&&(y=t.equals(v,v.original))),y)g.putBytes(v.bitStringContents);else if(v.composed){v.constructed?h|=32:g.putByte(0);for(var _=0;_<v.value.length;++_)v.value[_]!==void 0&&g.putBuffer(t.toDer(v.value[_]))}else if(v.type===t.Type.BMPSTRING)for(var _=0;_<v.value.length;++_)g.putInt16(v.value.charCodeAt(_));else v.type===t.Type.INTEGER&&v.value.length>1&&(v.value.charCodeAt(0)===0&&!(v.value.charCodeAt(1)&128)||v.value.charCodeAt(0)===255&&(v.value.charCodeAt(1)&128)===128)?g.putBytes(v.value.substr(1)):g.putBytes(v.value);if(o.putByte(h),g.length()<=127)o.putByte(g.length()&127);else{var A=g.length(),S="";do S+=String.fromCharCode(A&255),A=A>>>8;while(A>0);o.putByte(S.length|128);for(var _=S.length-1;_>=0;--_)o.putByte(S.charCodeAt(_))}return o.putBuffer(g),o},t.oidToDer=function(v){var o=v.split("."),h=r.util.createBuffer();h.putByte(40*parseInt(o[0],10)+parseInt(o[1],10));for(var g,y,_,A,S=2;S<o.length;++S){g=!0,y=[],_=parseInt(o[S],10);do A=_&127,_=_>>>7,g||(A|=128),y.push(A),g=!1;while(_>0);for(var T=y.length-1;T>=0;--T)h.putByte(y[T])}return h},t.derToOid=function(v){var o;typeof v=="string"&&(v=r.util.createBuffer(v));var h=v.getByte();o=Math.floor(h/40)+"."+h%40;for(var g=0;v.length()>0;)h=v.getByte(),g=g<<7,h&128?g+=h&127:(o+="."+(g+h),g=0);return o},t.utcTimeToDate=function(v){var o=new Date,h=parseInt(v.substr(0,2),10);h=h>=50?1900+h:2e3+h;var g=parseInt(v.substr(2,2),10)-1,y=parseInt(v.substr(4,2),10),_=parseInt(v.substr(6,2),10),A=parseInt(v.substr(8,2),10),S=0;if(v.length>11){var T=v.charAt(10),B=10;T!=="+"&&T!=="-"&&(S=parseInt(v.substr(10,2),10),B+=2)}if(o.setUTCFullYear(h,g,y),o.setUTCHours(_,A,S,0),B&&(T=v.charAt(B),T==="+"||T==="-")){var M=parseInt(v.substr(B+1,2),10),R=parseInt(v.substr(B+4,2),10),P=M*60+R;P*=6e4,T==="+"?o.setTime(+o-P):o.setTime(+o+P)}return o},t.generalizedTimeToDate=function(v){var o=new Date,h=parseInt(v.substr(0,4),10),g=parseInt(v.substr(4,2),10)-1,y=parseInt(v.substr(6,2),10),_=parseInt(v.substr(8,2),10),A=parseInt(v.substr(10,2),10),S=parseInt(v.substr(12,2),10),T=0,B=0,M=!1;v.charAt(v.length-1)==="Z"&&(M=!0);var R=v.length-5,P=v.charAt(R);if(P==="+"||P==="-"){var D=parseInt(v.substr(R+1,2),10),q=parseInt(v.substr(R+4,2),10);B=D*60+q,B*=6e4,P==="+"&&(B*=-1),M=!0}return v.charAt(14)==="."&&(T=parseFloat(v.substr(14),10)*1e3),M?(o.setUTCFullYear(h,g,y),o.setUTCHours(_,A,S,T),o.setTime(+o+B)):(o.setFullYear(h,g,y),o.setHours(_,A,S,T)),o},t.dateToUtcTime=function(v){if(typeof v=="string")return v;var o="",h=[];h.push((""+v.getUTCFullYear()).substr(2)),h.push(""+(v.getUTCMonth()+1)),h.push(""+v.getUTCDate()),h.push(""+v.getUTCHours()),h.push(""+v.getUTCMinutes()),h.push(""+v.getUTCSeconds());for(var g=0;g<h.length;++g)h[g].length<2&&(o+="0"),o+=h[g];return o+="Z",o},t.dateToGeneralizedTime=function(v){if(typeof v=="string")return v;var o="",h=[];h.push(""+v.getUTCFullYear()),h.push(""+(v.getUTCMonth()+1)),h.push(""+v.getUTCDate()),h.push(""+v.getUTCHours()),h.push(""+v.getUTCMinutes()),h.push(""+v.getUTCSeconds());for(var g=0;g<h.length;++g)h[g].length<2&&(o+="0"),o+=h[g];return o+="Z",o},t.integerToDer=function(v){var o=r.util.createBuffer();if(v>=-128&&v<128)return o.putSignedInt(v,8);if(v>=-32768&&v<32768)return o.putSignedInt(v,16);if(v>=-8388608&&v<8388608)return o.putSignedInt(v,24);if(v>=-2147483648&&v<2147483648)return o.putSignedInt(v,32);var h=new Error("Integer too large; max is 32-bits.");throw h.integer=v,h},t.derToInteger=function(v){typeof v=="string"&&(v=r.util.createBuffer(v));var o=v.length()*8;if(o>32)throw new Error("Integer too large; max is 32-bits.");return v.getSignedInt(o)},t.validate=function(v,o,h,g){var y=!1;if((v.tagClass===o.tagClass||typeof o.tagClass>"u")&&(v.type===o.type||typeof o.type>"u"))if(v.constructed===o.constructed||typeof o.constructed>"u"){if(y=!0,o.value&&r.util.isArray(o.value))for(var _=0,A=0;y&&A<o.value.length;++A)y=o.value[A].optional||!1,v.value[_]&&(y=t.validate(v.value[_],o.value[A],h,g),y?++_:o.value[A].optional&&(y=!0)),!y&&g&&g.push("["+o.name+'] Tag class "'+o.tagClass+'", type "'+o.type+'" expected value length "'+o.value.length+'", got "'+v.value.length+'"');if(y&&h&&(o.capture&&(h[o.capture]=v.value),o.captureAsn1&&(h[o.captureAsn1]=v),o.captureBitStringContents&&"bitStringContents"in v&&(h[o.captureBitStringContents]=v.bitStringContents),o.captureBitStringValue&&"bitStringContents"in v))if(v.bitStringContents.length<2)h[o.captureBitStringValue]="";else{var S=v.bitStringContents.charCodeAt(0);if(S!==0)throw new Error("captureBitStringValue only supported for zero unused bits");h[o.captureBitStringValue]=v.bitStringContents.slice(1)}}else g&&g.push("["+o.name+'] Expected constructed "'+o.constructed+'", got "'+v.constructed+'"');else g&&(v.tagClass!==o.tagClass&&g.push("["+o.name+'] Expected tag class "'+o.tagClass+'", got "'+v.tagClass+'"'),v.type!==o.type&&g.push("["+o.name+'] Expected type "'+o.type+'", got "'+v.type+'"'));return y};var u=/[^\\u0000-\\u00ff]/;t.prettyPrint=function(v,o,h){var g="";o=o||0,h=h||2,o>0&&(g+=`
`);for(var y="",_=0;_<o*h;++_)y+=" ";switch(g+=y+"Tag: ",v.tagClass){case t.Class.UNIVERSAL:g+="Universal:";break;case t.Class.APPLICATION:g+="Application:";break;case t.Class.CONTEXT_SPECIFIC:g+="Context-Specific:";break;case t.Class.PRIVATE:g+="Private:";break}if(v.tagClass===t.Class.UNIVERSAL)switch(g+=v.type,v.type){case t.Type.NONE:g+=" (None)";break;case t.Type.BOOLEAN:g+=" (Boolean)";break;case t.Type.INTEGER:g+=" (Integer)";break;case t.Type.BITSTRING:g+=" (Bit string)";break;case t.Type.OCTETSTRING:g+=" (Octet string)";break;case t.Type.NULL:g+=" (Null)";break;case t.Type.OID:g+=" (Object Identifier)";break;case t.Type.ODESC:g+=" (Object Descriptor)";break;case t.Type.EXTERNAL:g+=" (External or Instance of)";break;case t.Type.REAL:g+=" (Real)";break;case t.Type.ENUMERATED:g+=" (Enumerated)";break;case t.Type.EMBEDDED:g+=" (Embedded PDV)";break;case t.Type.UTF8:g+=" (UTF8)";break;case t.Type.ROID:g+=" (Relative Object Identifier)";break;case t.Type.SEQUENCE:g+=" (Sequence)";break;case t.Type.SET:g+=" (Set)";break;case t.Type.PRINTABLESTRING:g+=" (Printable String)";break;case t.Type.IA5String:g+=" (IA5String (ASCII))";break;case t.Type.UTCTIME:g+=" (UTC time)";break;case t.Type.GENERALIZEDTIME:g+=" (Generalized time)";break;case t.Type.BMPSTRING:g+=" (BMP String)";break}else g+=v.type;if(g+=`
`,g+=y+"Constructed: "+v.constructed+`
`,v.composed){for(var A=0,S="",_=0;_<v.value.length;++_)v.value[_]!==void 0&&(A+=1,S+=t.prettyPrint(v.value[_],o+1,h),_+1<v.value.length&&(S+=","));g+=y+"Sub values: "+A+S}else{if(g+=y+"Value: ",v.type===t.Type.OID){var T=t.derToOid(v.value);g+=T,r.pki&&r.pki.oids&&T in r.pki.oids&&(g+=" ("+r.pki.oids[T]+") ")}if(v.type===t.Type.INTEGER)try{g+=t.derToInteger(v.value)}catch{g+="0x"+r.util.bytesToHex(v.value)}else if(v.type===t.Type.BITSTRING){if(v.value.length>1?g+="0x"+r.util.bytesToHex(v.value.slice(1)):g+="(none)",v.value.length>0){var B=v.value.charCodeAt(0);B==1?g+=" (1 unused bit shown)":B>1&&(g+=" ("+B+" unused bits shown)")}}else if(v.type===t.Type.OCTETSTRING)u.test(v.value)||(g+="("+v.value+") "),g+="0x"+r.util.bytesToHex(v.value);else if(v.type===t.Type.UTF8)try{g+=r.util.decodeUtf8(v.value)}catch(M){if(M.message==="URI malformed")g+="0x"+r.util.bytesToHex(v.value)+" (malformed UTF8)";else throw M}else v.type===t.Type.PRINTABLESTRING||v.type===t.Type.IA5String?g+=v.value:u.test(v.value)?g+="0x"+r.util.bytesToHex(v.value):v.value.length===0?g+="[null]":g+=v.value}return g}}}),jn=Ve({"../../node_modules/node-forge/lib/md.js"(i,e){var r=sr();e.exports=r.md=r.md||{},r.md.algorithms=r.md.algorithms||{}}}),af=Ve({"../../node_modules/node-forge/lib/hmac.js"(i,e){var r=sr();jn(),wr();var t=e.exports=r.hmac=r.hmac||{};t.create=function(){var a=null,n=null,c=null,u=null,v={};return v.start=function(o,h){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in r.md.algorithms)n=r.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else n=o;if(h===null)h=a;else{if(typeof h=="string")h=r.util.createBuffer(h);else if(r.util.isArray(h)){var g=h;h=r.util.createBuffer();for(var y=0;y<g.length;++y)h.putByte(g[y])}var _=h.length();_>n.blockLength&&(n.start(),n.update(h.bytes()),h=n.digest()),c=r.util.createBuffer(),u=r.util.createBuffer(),_=h.length();for(var y=0;y<_;++y){var g=h.at(y);c.putByte(54^g),u.putByte(92^g)}if(_<n.blockLength)for(var g=n.blockLength-_,y=0;y<g;++y)c.putByte(54),u.putByte(92);a=h,c=c.bytes(),u=u.bytes()}n.start(),n.update(c)},v.update=function(o){n.update(o)},v.getMac=function(){var o=n.digest().bytes();return n.start(),n.update(u),n.update(o),n.digest()},v.digest=v.getMac,v}}}),H1=Ve({"../../node_modules/node-forge/lib/md5.js"(i,e){var r=sr();jn(),wr();var t=e.exports=r.md5=r.md5||{};r.md.md5=r.md.algorithms.md5=t,t.create=function(){v||o();var g=null,y=r.util.createBuffer(),_=new Array(16),A={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return A.start=function(){A.messageLength=0,A.fullMessageLength=A.messageLength64=[];for(var S=A.messageLengthSize/4,T=0;T<S;++T)A.fullMessageLength.push(0);return y=r.util.createBuffer(),g={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},A},A.start(),A.update=function(S,T){T==="utf8"&&(S=r.util.encodeUtf8(S));var B=S.length;A.messageLength+=B,B=[B/4294967296>>>0,B>>>0];for(var M=A.fullMessageLength.length-1;M>=0;--M)A.fullMessageLength[M]+=B[1],B[1]=B[0]+(A.fullMessageLength[M]/4294967296>>>0),A.fullMessageLength[M]=A.fullMessageLength[M]>>>0,B[0]=B[1]/4294967296>>>0;return y.putBytes(S),h(g,_,y),(y.read>2048||y.length()===0)&&y.compact(),A},A.digest=function(){var S=r.util.createBuffer();S.putBytes(y.bytes());var T=A.fullMessageLength[A.fullMessageLength.length-1]+A.messageLengthSize,B=T&A.blockLength-1;S.putBytes(a.substr(0,A.blockLength-B));for(var M,R=0,P=A.fullMessageLength.length-1;P>=0;--P)M=A.fullMessageLength[P]*8+R,R=M/4294967296>>>0,S.putInt32Le(M>>>0);var D={h0:g.h0,h1:g.h1,h2:g.h2,h3:g.h3};h(D,_,S);var q=r.util.createBuffer();return q.putInt32Le(D.h0),q.putInt32Le(D.h1),q.putInt32Le(D.h2),q.putInt32Le(D.h3),q},A};var a=null,n=null,c=null,u=null,v=!1;function o(){a="",a+=r.util.fillString("\0",64),n=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],c=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],u=new Array(64);for(var g=0;g<64;++g)u[g]=Math.floor(Math.abs(Math.sin(g+1))*4294967296);v=!0}function h(g,y,_){for(var A,S,T,B,M,R,P,D,q=_.length();q>=64;){for(S=g.h0,T=g.h1,B=g.h2,M=g.h3,D=0;D<16;++D)y[D]=_.getInt32Le(),R=M^T&(B^M),A=S+R+u[D]+y[D],P=c[D],S=M,M=B,B=T,T+=A<<P|A>>>32-P;for(;D<32;++D)R=B^M&(T^B),A=S+R+u[D]+y[n[D]],P=c[D],S=M,M=B,B=T,T+=A<<P|A>>>32-P;for(;D<48;++D)R=T^B^M,A=S+R+u[D]+y[n[D]],P=c[D],S=M,M=B,B=T,T+=A<<P|A>>>32-P;for(;D<64;++D)R=B^(T|~M),A=S+R+u[D]+y[n[D]],P=c[D],S=M,M=B,B=T,T+=A<<P|A>>>32-P;g.h0=g.h0+S|0,g.h1=g.h1+T|0,g.h2=g.h2+B|0,g.h3=g.h3+M|0,q-=64}}}}),zs=Ve({"../../node_modules/node-forge/lib/pem.js"(i,e){var r=sr();wr();var t=e.exports=r.pem=r.pem||{};t.encode=function(c,u){u=u||{};var v="-----BEGIN "+c.type+`-----\r
`,o;if(c.procType&&(o={name:"Proc-Type",values:[String(c.procType.version),c.procType.type]},v+=a(o)),c.contentDomain&&(o={name:"Content-Domain",values:[c.contentDomain]},v+=a(o)),c.dekInfo&&(o={name:"DEK-Info",values:[c.dekInfo.algorithm]},c.dekInfo.parameters&&o.values.push(c.dekInfo.parameters),v+=a(o)),c.headers)for(var h=0;h<c.headers.length;++h)v+=a(c.headers[h]);return c.procType&&(v+=`\r
`),v+=r.util.encode64(c.body,u.maxline||64)+`\r
`,v+="-----END "+c.type+`-----\r
`,v},t.decode=function(c){for(var u=[],v=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,o=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,h=/\r?\n/,g;g=v.exec(c),!!g;){var y=g[1];y==="NEW CERTIFICATE REQUEST"&&(y="CERTIFICATE REQUEST");var _={type:y,procType:null,contentDomain:null,dekInfo:null,headers:[],body:r.util.decode64(g[3])};if(u.push(_),!!g[2]){for(var A=g[2].split(h),S=0;g&&S<A.length;){for(var T=A[S].replace(/\s+$/,""),B=S+1;B<A.length;++B){var M=A[B];if(!/\s/.test(M[0]))break;T+=M,S=B}if(g=T.match(o),g){for(var R={name:g[1],values:[]},P=g[2].split(","),D=0;D<P.length;++D)R.values.push(n(P[D]));if(_.procType)if(!_.contentDomain&&R.name==="Content-Domain")_.contentDomain=P[0]||"";else if(!_.dekInfo&&R.name==="DEK-Info"){if(R.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');_.dekInfo={algorithm:P[0],parameters:P[1]||null}}else _.headers.push(R);else{if(R.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(R.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');_.procType={version:P[0],type:P[1]}}}++S}if(_.procType==="ENCRYPTED"&&!_.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(u.length===0)throw new Error("Invalid PEM formatted message.");return u};function a(c){for(var u=c.name+": ",v=[],o=function(A,S){return" "+S},h=0;h<c.values.length;++h)v.push(c.values[h].replace(/^(\S+\r\n)/,o));u+=v.join(",")+`\r
`;for(var g=0,y=-1,h=0;h<u.length;++h,++g)if(g>65&&y!==-1){var _=u[y];_===","?(++y,u=u.substr(0,y)+`\r
 `+u.substr(y)):u=u.substr(0,y)+`\r
`+_+u.substr(y+1),g=h-y-1,y=-1,++h}else(u[h]===" "||u[h]==="	"||u[h]===",")&&(y=h);return u}function n(c){return c.replace(/^\s+/,"")}}}),ec=Ve({"../../node_modules/node-forge/lib/des.js"(i,e){var r=sr();K1(),C_(),wr(),e.exports=r.des=r.des||{},r.des.startEncrypting=function(S,T,B,M){var R=A({key:S,output:B,decrypt:!1,mode:M||(T===null?"ECB":"CBC")});return R.start(T),R},r.des.createEncryptionCipher=function(S,T){return A({key:S,output:null,decrypt:!1,mode:T})},r.des.startDecrypting=function(S,T,B,M){var R=A({key:S,output:B,decrypt:!0,mode:M||(T===null?"ECB":"CBC")});return R.start(T),R},r.des.createDecryptionCipher=function(S,T){return A({key:S,output:null,decrypt:!0,mode:T})},r.des.Algorithm=function(S,T){var B=this;B.name=S,B.mode=new T({blockSize:8,cipher:{encrypt:function(M,R){return _(B._keys,M,R,!1)},decrypt:function(M,R){return _(B._keys,M,R,!0)}}}),B._init=!1},r.des.Algorithm.prototype.initialize=function(S){if(!this._init){var T=r.util.createBuffer(S.key);if(this.name.indexOf("3DES")===0&&T.length()!==24)throw new Error("Invalid Triple-DES key size: "+T.length()*8);this._keys=y(T),this._init=!0}},t("DES-ECB",r.cipher.modes.ecb),t("DES-CBC",r.cipher.modes.cbc),t("DES-CFB",r.cipher.modes.cfb),t("DES-OFB",r.cipher.modes.ofb),t("DES-CTR",r.cipher.modes.ctr),t("3DES-ECB",r.cipher.modes.ecb),t("3DES-CBC",r.cipher.modes.cbc),t("3DES-CFB",r.cipher.modes.cfb),t("3DES-OFB",r.cipher.modes.ofb),t("3DES-CTR",r.cipher.modes.ctr);function t(S,T){var B=function(){return new r.des.Algorithm(S,T)};r.cipher.registerAlgorithm(S,B)}var a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],n=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],v=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],o=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],g=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function y(S){for(var T=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],B=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],M=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],R=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],P=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],D=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],q=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],k=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],U=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],O=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],G=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],E=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],s=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],l=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=S.length()>8?3:1,p=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],w=0,x,b=0;b<d;b++){var f=S.getInt32(),C=S.getInt32();x=(f>>>4^C)&252645135,C^=x,f^=x<<4,x=(C>>>-16^f)&65535,f^=x,C^=x<<-16,x=(f>>>2^C)&858993459,C^=x,f^=x<<2,x=(C>>>-16^f)&65535,f^=x,C^=x<<-16,x=(f>>>1^C)&1431655765,C^=x,f^=x<<1,x=(C>>>8^f)&16711935,f^=x,C^=x<<8,x=(f>>>1^C)&1431655765,C^=x,f^=x<<1,x=f<<8|C>>>20&240,f=C<<24|C<<8&16711680|C>>>8&65280|C>>>24&240,C=x;for(var F=0;F<m.length;++F){m[F]?(f=f<<2|f>>>26,C=C<<2|C>>>26):(f=f<<1|f>>>27,C=C<<1|C>>>27),f&=-15,C&=-15;var z=T[f>>>28]|B[f>>>24&15]|M[f>>>20&15]|R[f>>>16&15]|P[f>>>12&15]|D[f>>>8&15]|q[f>>>4&15],W=k[C>>>28]|U[C>>>24&15]|O[C>>>20&15]|G[C>>>16&15]|E[C>>>12&15]|s[C>>>8&15]|l[C>>>4&15];x=(W>>>16^z)&65535,p[w++]=z^x,p[w++]=W^x<<16}}return p}function _(S,T,B,M){var R=S.length===32?3:9,P;R===3?P=M?[30,-2,-2]:[0,32,2]:P=M?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var D,q=T[0],k=T[1];D=(q>>>4^k)&252645135,k^=D,q^=D<<4,D=(q>>>16^k)&65535,k^=D,q^=D<<16,D=(k>>>2^q)&858993459,q^=D,k^=D<<2,D=(k>>>8^q)&16711935,q^=D,k^=D<<8,D=(q>>>1^k)&1431655765,k^=D,q^=D<<1,q=q<<1|q>>>31,k=k<<1|k>>>31;for(var U=0;U<R;U+=3){for(var O=P[U+1],G=P[U+2],E=P[U];E!=O;E+=G){var s=k^S[E],l=(k>>>4|k<<28)^S[E+1];D=q,q=k,k=D^(n[s>>>24&63]|u[s>>>16&63]|o[s>>>8&63]|g[s&63]|a[l>>>24&63]|c[l>>>16&63]|v[l>>>8&63]|h[l&63])}D=q,q=k,k=D}q=q>>>1|q<<31,k=k>>>1|k<<31,D=(q>>>1^k)&1431655765,k^=D,q^=D<<1,D=(k>>>8^q)&16711935,q^=D,k^=D<<8,D=(k>>>2^q)&858993459,q^=D,k^=D<<2,D=(q>>>16^k)&65535,k^=D,q^=D<<16,D=(q>>>4^k)&252645135,k^=D,q^=D<<4,B[0]=q,B[1]=k}function A(S){S=S||{};var T=(S.mode||"CBC").toUpperCase(),B="DES-"+T,M;S.decrypt?M=r.cipher.createDecipher(B,S.key):M=r.cipher.createCipher(B,S.key);var R=M.start;return M.start=function(P,D){var q=null;D instanceof r.util.ByteBuffer&&(q=D,D={}),D=D||{},D.output=q,D.iv=P,R.call(M,D)},M}}}),Q1=Ve({"../../node_modules/node-forge/lib/pbkdf2.js"(i,e){var r=sr();af(),jn(),wr();var t=r.pkcs5=r.pkcs5||{},a;r.util.isNodejs&&!r.options.usePureJavaScript&&(a=ba()),e.exports=r.pbkdf2=t.pbkdf2=function(n,c,u,v,o,h){if(typeof o=="function"&&(h=o,o=null),r.util.isNodejs&&!r.options.usePureJavaScript&&a.pbkdf2&&(o===null||typeof o!="object")&&(a.pbkdf2Sync.length>4||!o||o==="sha1"))return typeof o!="string"&&(o="sha1"),n=Buffer.from(n,"binary"),c=Buffer.from(c,"binary"),h?a.pbkdf2Sync.length===4?a.pbkdf2(n,c,u,v,function(U,O){if(U)return h(U);h(null,O.toString("binary"))}):a.pbkdf2(n,c,u,v,o,function(U,O){if(U)return h(U);h(null,O.toString("binary"))}):a.pbkdf2Sync.length===4?a.pbkdf2Sync(n,c,u,v).toString("binary"):a.pbkdf2Sync(n,c,u,v,o).toString("binary");if((typeof o>"u"||o===null)&&(o="sha1"),typeof o=="string"){if(!(o in r.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=r.md[o].create()}var g=o.digestLength;if(v>4294967295*g){var y=new Error("Derived key is too long.");if(h)return h(y);throw y}var _=Math.ceil(v/g),A=v-(_-1)*g,S=r.hmac.create();S.start(o,n);var T="",B,M,R;if(!h){for(var P=1;P<=_;++P){S.start(null,null),S.update(c),S.update(r.util.int32ToBytes(P)),B=R=S.digest().getBytes();for(var D=2;D<=u;++D)S.start(null,null),S.update(R),M=S.digest().getBytes(),B=r.util.xorBytes(B,M,g),R=M;T+=P<_?B:B.substr(0,A)}return T}var P=1,D;function q(){if(P>_)return h(null,T);S.start(null,null),S.update(c),S.update(r.util.int32ToBytes(P)),B=R=S.digest().getBytes(),D=2,k()}function k(){if(D<=u)return S.start(null,null),S.update(R),M=S.digest().getBytes(),B=r.util.xorBytes(B,M,g),R=M,++D,r.util.setImmediate(k);T+=P<_?B:B.substr(0,A),++P,q()}q()}}}),E_=Ve({"../../node_modules/node-forge/lib/sha256.js"(i,e){var r=sr();jn(),wr();var t=e.exports=r.sha256=r.sha256||{};r.md.sha256=r.md.algorithms.sha256=t,t.create=function(){n||u();var o=null,h=r.util.createBuffer(),g=new Array(64),y={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return y.start=function(){y.messageLength=0,y.fullMessageLength=y.messageLength64=[];for(var _=y.messageLengthSize/4,A=0;A<_;++A)y.fullMessageLength.push(0);return h=r.util.createBuffer(),o={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},y},y.start(),y.update=function(_,A){A==="utf8"&&(_=r.util.encodeUtf8(_));var S=_.length;y.messageLength+=S,S=[S/4294967296>>>0,S>>>0];for(var T=y.fullMessageLength.length-1;T>=0;--T)y.fullMessageLength[T]+=S[1],S[1]=S[0]+(y.fullMessageLength[T]/4294967296>>>0),y.fullMessageLength[T]=y.fullMessageLength[T]>>>0,S[0]=S[1]/4294967296>>>0;return h.putBytes(_),v(o,g,h),(h.read>2048||h.length()===0)&&h.compact(),y},y.digest=function(){var _=r.util.createBuffer();_.putBytes(h.bytes());var A=y.fullMessageLength[y.fullMessageLength.length-1]+y.messageLengthSize,S=A&y.blockLength-1;_.putBytes(a.substr(0,y.blockLength-S));for(var T,B,M=y.fullMessageLength[0]*8,R=0;R<y.fullMessageLength.length-1;++R)T=y.fullMessageLength[R+1]*8,B=T/4294967296>>>0,M+=B,_.putInt32(M>>>0),M=T>>>0;_.putInt32(M);var P={h0:o.h0,h1:o.h1,h2:o.h2,h3:o.h3,h4:o.h4,h5:o.h5,h6:o.h6,h7:o.h7};v(P,g,_);var D=r.util.createBuffer();return D.putInt32(P.h0),D.putInt32(P.h1),D.putInt32(P.h2),D.putInt32(P.h3),D.putInt32(P.h4),D.putInt32(P.h5),D.putInt32(P.h6),D.putInt32(P.h7),D},y};var a=null,n=!1,c=null;function u(){a="",a+=r.util.fillString("\0",64),c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],n=!0}function v(o,h,g){for(var y,_,A,S,T,B,M,R,P,D,q,k,U,O,G,E=g.length();E>=64;){for(M=0;M<16;++M)h[M]=g.getInt32();for(;M<64;++M)y=h[M-2],y=(y>>>17|y<<15)^(y>>>19|y<<13)^y>>>10,_=h[M-15],_=(_>>>7|_<<25)^(_>>>18|_<<14)^_>>>3,h[M]=y+h[M-7]+_+h[M-16]|0;for(R=o.h0,P=o.h1,D=o.h2,q=o.h3,k=o.h4,U=o.h5,O=o.h6,G=o.h7,M=0;M<64;++M)S=(k>>>6|k<<26)^(k>>>11|k<<21)^(k>>>25|k<<7),T=O^k&(U^O),A=(R>>>2|R<<30)^(R>>>13|R<<19)^(R>>>22|R<<10),B=R&P|D&(R^P),y=G+S+T+c[M]+h[M],_=A+B,G=O,O=U,U=k,k=q+y>>>0,q=D,D=P,P=R,R=y+_>>>0;o.h0=o.h0+R|0,o.h1=o.h1+P|0,o.h2=o.h2+D|0,o.h3=o.h3+q|0,o.h4=o.h4+k|0,o.h5=o.h5+U|0,o.h6=o.h6+O|0,o.h7=o.h7+G|0,E-=64}}}}),A_=Ve({"../../node_modules/node-forge/lib/prng.js"(i,e){var r=sr();wr();var t=null;r.util.isNodejs&&!r.options.usePureJavaScript&&!process.versions["node-webkit"]&&(t=ba());var a=e.exports=r.prng=r.prng||{};a.create=function(n){for(var c={plugin:n,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},u=n.md,v=new Array(32),o=0;o<32;++o)v[o]=u.create();c.pools=v,c.pool=0,c.generate=function(A,S){if(!S)return c.generateSync(A);var T=c.plugin.cipher,B=c.plugin.increment,M=c.plugin.formatKey,R=c.plugin.formatSeed,P=r.util.createBuffer();c.key=null,D();function D(q){if(q)return S(q);if(P.length()>=A)return S(null,P.getBytes(A));if(c.generated>1048575&&(c.key=null),c.key===null)return r.util.nextTick(function(){h(D)});var k=T(c.key,c.seed);c.generated+=k.length,P.putBytes(k),c.key=M(T(c.key,B(c.seed))),c.seed=R(T(c.key,c.seed)),r.util.setImmediate(D)}},c.generateSync=function(A){var S=c.plugin.cipher,T=c.plugin.increment,B=c.plugin.formatKey,M=c.plugin.formatSeed;c.key=null;for(var R=r.util.createBuffer();R.length()<A;){c.generated>1048575&&(c.key=null),c.key===null&&g();var P=S(c.key,c.seed);c.generated+=P.length,R.putBytes(P),c.key=B(S(c.key,T(c.seed))),c.seed=M(S(c.key,c.seed))}return R.getBytes(A)};function h(A){if(c.pools[0].messageLength>=32)return y(),A();var S=32-c.pools[0].messageLength<<5;c.seedFile(S,function(T,B){if(T)return A(T);c.collect(B),y(),A()})}function g(){if(c.pools[0].messageLength>=32)return y();var A=32-c.pools[0].messageLength<<5;c.collect(c.seedFileSync(A)),y()}function y(){c.reseeds=c.reseeds===4294967295?0:c.reseeds+1;var A=c.plugin.md.create();A.update(c.keyBytes);for(var S=1,T=0;T<32;++T)c.reseeds%S===0&&(A.update(c.pools[T].digest().getBytes()),c.pools[T].start()),S=S<<1;c.keyBytes=A.digest().getBytes(),A.start(),A.update(c.keyBytes);var B=A.digest().getBytes();c.key=c.plugin.formatKey(c.keyBytes),c.seed=c.plugin.formatSeed(B),c.generated=0}function _(A){var S=null,T=r.util.globalScope,B=T.crypto||T.msCrypto;B&&B.getRandomValues&&(S=function(G){return B.getRandomValues(G)});var M=r.util.createBuffer();if(S)for(;M.length()<A;){var R=Math.max(1,Math.min(A-M.length(),65536)/4),P=new Uint32Array(Math.floor(R));try{S(P);for(var D=0;D<P.length;++D)M.putInt32(P[D])}catch(G){if(!(typeof QuotaExceededError<"u"&&G instanceof QuotaExceededError))throw G}}if(M.length()<A)for(var q,k,U,O=Math.floor(Math.random()*65536);M.length()<A;){k=16807*(O&65535),q=16807*(O>>16),k+=(q&32767)<<16,k+=q>>15,k=(k&2147483647)+(k>>31),O=k&4294967295;for(var D=0;D<3;++D)U=O>>>(D<<3),U^=Math.floor(Math.random()*256),M.putByte(U&255)}return M.getBytes(A)}return t?(c.seedFile=function(A,S){t.randomBytes(A,function(T,B){if(T)return S(T);S(null,B.toString())})},c.seedFileSync=function(A){return t.randomBytes(A).toString()}):(c.seedFile=function(A,S){try{S(null,_(A))}catch(T){S(T)}},c.seedFileSync=_),c.collect=function(A){for(var S=A.length,T=0;T<S;++T)c.pools[c.pool].update(A.substr(T,1)),c.pool=c.pool===31?0:c.pool+1},c.collectInt=function(A,S){for(var T="",B=0;B<S;B+=8)T+=String.fromCharCode(A>>B&255);c.collect(T)},c.registerWorker=function(A){if(A===self)c.seedFile=function(T,B){function M(R){var P=R.data;P.forge&&P.forge.prng&&(self.removeEventListener("message",M),B(P.forge.prng.err,P.forge.prng.bytes))}self.addEventListener("message",M),self.postMessage({forge:{prng:{needed:T}}})};else{var S=function(T){var B=T.data;B.forge&&B.forge.prng&&c.seedFile(B.forge.prng.needed,function(M,R){A.postMessage({forge:{prng:{err:M,bytes:R}}})})};A.addEventListener("message",S)}},c}}}),fn=Ve({"../../node_modules/node-forge/lib/random.js"(i,e){var r=sr();Ja(),E_(),A_(),wr(),function(){if(r.random&&r.random.getBytes){e.exports=r.random;return}(function(t){var a={},n=new Array(4),c=r.util.createBuffer();a.formatKey=function(A){var S=r.util.createBuffer(A);return A=new Array(4),A[0]=S.getInt32(),A[1]=S.getInt32(),A[2]=S.getInt32(),A[3]=S.getInt32(),r.aes._expandKey(A,!1)},a.formatSeed=function(A){var S=r.util.createBuffer(A);return A=new Array(4),A[0]=S.getInt32(),A[1]=S.getInt32(),A[2]=S.getInt32(),A[3]=S.getInt32(),A},a.cipher=function(A,S){return r.aes._updateBlock(A,S,n,!1),c.putInt32(n[0]),c.putInt32(n[1]),c.putInt32(n[2]),c.putInt32(n[3]),c.getBytes()},a.increment=function(A){return++A[3],A},a.md=r.md.sha256;function u(){var A=r.prng.create(a);return A.getBytes=function(S,T){return A.generate(S,T)},A.getBytesSync=function(S){return A.generate(S)},A}var v=u(),o=null,h=r.util.globalScope,g=h.crypto||h.msCrypto;if(g&&g.getRandomValues&&(o=function(A){return g.getRandomValues(A)}),r.options.usePureJavaScript||!r.util.isNodejs&&!o){if(v.collectInt(+new Date,32),typeof navigator<"u"){var y="";for(var _ in navigator)try{typeof navigator[_]=="string"&&(y+=navigator[_])}catch{}v.collect(y),y=null}t&&(t().mousemove(function(A){v.collectInt(A.clientX,16),v.collectInt(A.clientY,16)}),t().keypress(function(A){v.collectInt(A.charCode,8)}))}if(!r.random)r.random=v;else for(var _ in v)r.random[_]=v[_];r.random.createInstance=u,e.exports=r.random})(typeof jQuery<"u"?jQuery:null)}()}}),S_=Ve({"../../node_modules/node-forge/lib/rc2.js"(i,e){var r=sr();wr();var t=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],a=[1,2,3,5],n=function(v,o){return v<<o&65535|(v&65535)>>16-o},c=function(v,o){return(v&65535)>>o|v<<16-o&65535};e.exports=r.rc2=r.rc2||{},r.rc2.expandKey=function(v,o){typeof v=="string"&&(v=r.util.createBuffer(v)),o=o||128;var h=v,g=v.length(),y=o,_=Math.ceil(y/8),A=255>>(y&7),S;for(S=g;S<128;S++)h.putByte(t[h.at(S-1)+h.at(S-g)&255]);for(h.setAt(128-_,t[h.at(128-_)&A]),S=127-_;S>=0;S--)h.setAt(S,t[h.at(S+1)^h.at(S+_)]);return h};var u=function(v,o,h){var g=!1,y=null,_=null,A=null,S,T,B,M,R=[];for(v=r.rc2.expandKey(v,o),B=0;B<64;B++)R.push(v.getInt16Le());h?(S=function(q){for(B=0;B<4;B++)q[B]+=R[M]+(q[(B+3)%4]&q[(B+2)%4])+(~q[(B+3)%4]&q[(B+1)%4]),q[B]=n(q[B],a[B]),M++},T=function(q){for(B=0;B<4;B++)q[B]+=R[q[(B+3)%4]&63]}):(S=function(q){for(B=3;B>=0;B--)q[B]=c(q[B],a[B]),q[B]-=R[M]+(q[(B+3)%4]&q[(B+2)%4])+(~q[(B+3)%4]&q[(B+1)%4]),M--},T=function(q){for(B=3;B>=0;B--)q[B]-=R[q[(B+3)%4]&63]});var P=function(q){var k=[];for(B=0;B<4;B++){var U=y.getInt16Le();A!==null&&(h?U^=A.getInt16Le():A.putInt16Le(U)),k.push(U&65535)}M=h?0:63;for(var O=0;O<q.length;O++)for(var G=0;G<q[O][0];G++)q[O][1](k);for(B=0;B<4;B++)A!==null&&(h?A.putInt16Le(k[B]):k[B]^=A.getInt16Le()),_.putInt16Le(k[B])},D=null;return D={start:function(q,k){q&&typeof q=="string"&&(q=r.util.createBuffer(q)),g=!1,y=r.util.createBuffer(),_=k||new r.util.createBuffer,A=q,D.output=_},update:function(q){for(g||y.putBuffer(q);y.length()>=8;)P([[5,S],[1,T],[6,S],[1,T],[5,S]])},finish:function(q){var k=!0;if(h)if(q)k=q(8,y,!h);else{var U=y.length()===8?8:8-y.length();y.fillWithByte(U,U)}if(k&&(g=!0,D.update()),!h&&(k=y.length()===0,k))if(q)k=q(8,_,!h);else{var O=_.length(),G=_.at(O-1);G>O?k=!1:_.truncate(G)}return k}},D};r.rc2.startEncrypting=function(v,o,h){var g=r.rc2.createEncryptionCipher(v,128);return g.start(o,h),g},r.rc2.createEncryptionCipher=function(v,o){return u(v,o,!0)},r.rc2.startDecrypting=function(v,o,h){var g=r.rc2.createDecryptionCipher(v,128);return g.start(o,h),g},r.rc2.createDecryptionCipher=function(v,o){return u(v,o,!1)}}}),rc=Ve({"../../node_modules/node-forge/lib/jsbn.js"(i,e){var r=sr();e.exports=r.jsbn=r.jsbn||{};var t;function a(yt,it,ct){this.data=[],yt!=null&&(typeof yt=="number"?this.fromNumber(yt,it,ct):it==null&&typeof yt!="string"?this.fromString(yt,256):this.fromString(yt,it))}r.jsbn.BigInteger=a;function n(){return new a(null)}function c(yt,it,ct,ht,Tt,Nt){for(;--Nt>=0;){var Pt=it*this.data[yt++]+ct.data[ht]+Tt;Tt=Math.floor(Pt/67108864),ct.data[ht++]=Pt&67108863}return Tt}function u(yt,it,ct,ht,Tt,Nt){for(var Pt=it&32767,Yt=it>>15;--Nt>=0;){var ne=this.data[yt]&32767,se=this.data[yt++]>>15,le=Yt*ne+se*Pt;ne=Pt*ne+((le&32767)<<15)+ct.data[ht]+(Tt&1073741823),Tt=(ne>>>30)+(le>>>15)+Yt*se+(Tt>>>30),ct.data[ht++]=ne&1073741823}return Tt}function v(yt,it,ct,ht,Tt,Nt){for(var Pt=it&16383,Yt=it>>14;--Nt>=0;){var ne=this.data[yt]&16383,se=this.data[yt++]>>14,le=Yt*ne+se*Pt;ne=Pt*ne+((le&16383)<<14)+ct.data[ht]+Tt,Tt=(ne>>28)+(le>>14)+Yt*se,ct.data[ht++]=ne&268435455}return Tt}typeof navigator>"u"?(a.prototype.am=v,t=28):navigator.appName=="Microsoft Internet Explorer"?(a.prototype.am=u,t=30):navigator.appName!="Netscape"?(a.prototype.am=c,t=26):(a.prototype.am=v,t=28),a.prototype.DB=t,a.prototype.DM=(1<<t)-1,a.prototype.DV=1<<t;var o=52;a.prototype.FV=Math.pow(2,o),a.prototype.F1=o-t,a.prototype.F2=2*t-o;var h="0123456789abcdefghijklmnopqrstuvwxyz",g=new Array,y,_;for(y=48,_=0;_<=9;++_)g[y++]=_;for(y=97,_=10;_<36;++_)g[y++]=_;for(y=65,_=10;_<36;++_)g[y++]=_;function A(yt){return h.charAt(yt)}function S(yt,it){var ct=g[yt.charCodeAt(it)];return ct??-1}function T(yt){for(var it=this.t-1;it>=0;--it)yt.data[it]=this.data[it];yt.t=this.t,yt.s=this.s}function B(yt){this.t=1,this.s=yt<0?-1:0,yt>0?this.data[0]=yt:yt<-1?this.data[0]=yt+this.DV:this.t=0}function M(yt){var it=n();return it.fromInt(yt),it}function R(yt,it){var ct;if(it==16)ct=4;else if(it==8)ct=3;else if(it==256)ct=8;else if(it==2)ct=1;else if(it==32)ct=5;else if(it==4)ct=2;else{this.fromRadix(yt,it);return}this.t=0,this.s=0;for(var ht=yt.length,Tt=!1,Nt=0;--ht>=0;){var Pt=ct==8?yt[ht]&255:S(yt,ht);if(Pt<0){yt.charAt(ht)=="-"&&(Tt=!0);continue}Tt=!1,Nt==0?this.data[this.t++]=Pt:Nt+ct>this.DB?(this.data[this.t-1]|=(Pt&(1<<this.DB-Nt)-1)<<Nt,this.data[this.t++]=Pt>>this.DB-Nt):this.data[this.t-1]|=Pt<<Nt,Nt+=ct,Nt>=this.DB&&(Nt-=this.DB)}ct==8&&yt[0]&128&&(this.s=-1,Nt>0&&(this.data[this.t-1]|=(1<<this.DB-Nt)-1<<Nt)),this.clamp(),Tt&&a.ZERO.subTo(this,this)}function P(){for(var yt=this.s&this.DM;this.t>0&&this.data[this.t-1]==yt;)--this.t}function D(yt){if(this.s<0)return"-"+this.negate().toString(yt);var it;if(yt==16)it=4;else if(yt==8)it=3;else if(yt==2)it=1;else if(yt==32)it=5;else if(yt==4)it=2;else return this.toRadix(yt);var ct=(1<<it)-1,ht,Tt=!1,Nt="",Pt=this.t,Yt=this.DB-Pt*this.DB%it;if(Pt-- >0)for(Yt<this.DB&&(ht=this.data[Pt]>>Yt)>0&&(Tt=!0,Nt=A(ht));Pt>=0;)Yt<it?(ht=(this.data[Pt]&(1<<Yt)-1)<<it-Yt,ht|=this.data[--Pt]>>(Yt+=this.DB-it)):(ht=this.data[Pt]>>(Yt-=it)&ct,Yt<=0&&(Yt+=this.DB,--Pt)),ht>0&&(Tt=!0),Tt&&(Nt+=A(ht));return Tt?Nt:"0"}function q(){var yt=n();return a.ZERO.subTo(this,yt),yt}function k(){return this.s<0?this.negate():this}function U(yt){var it=this.s-yt.s;if(it!=0)return it;var ct=this.t;if(it=ct-yt.t,it!=0)return this.s<0?-it:it;for(;--ct>=0;)if((it=this.data[ct]-yt.data[ct])!=0)return it;return 0}function O(yt){var it=1,ct;return(ct=yt>>>16)!=0&&(yt=ct,it+=16),(ct=yt>>8)!=0&&(yt=ct,it+=8),(ct=yt>>4)!=0&&(yt=ct,it+=4),(ct=yt>>2)!=0&&(yt=ct,it+=2),(ct=yt>>1)!=0&&(yt=ct,it+=1),it}function G(){return this.t<=0?0:this.DB*(this.t-1)+O(this.data[this.t-1]^this.s&this.DM)}function E(yt,it){var ct;for(ct=this.t-1;ct>=0;--ct)it.data[ct+yt]=this.data[ct];for(ct=yt-1;ct>=0;--ct)it.data[ct]=0;it.t=this.t+yt,it.s=this.s}function s(yt,it){for(var ct=yt;ct<this.t;++ct)it.data[ct-yt]=this.data[ct];it.t=Math.max(this.t-yt,0),it.s=this.s}function l(yt,it){var ct=yt%this.DB,ht=this.DB-ct,Tt=(1<<ht)-1,Nt=Math.floor(yt/this.DB),Pt=this.s<<ct&this.DM,Yt;for(Yt=this.t-1;Yt>=0;--Yt)it.data[Yt+Nt+1]=this.data[Yt]>>ht|Pt,Pt=(this.data[Yt]&Tt)<<ct;for(Yt=Nt-1;Yt>=0;--Yt)it.data[Yt]=0;it.data[Nt]=Pt,it.t=this.t+Nt+1,it.s=this.s,it.clamp()}function d(yt,it){it.s=this.s;var ct=Math.floor(yt/this.DB);if(ct>=this.t){it.t=0;return}var ht=yt%this.DB,Tt=this.DB-ht,Nt=(1<<ht)-1;it.data[0]=this.data[ct]>>ht;for(var Pt=ct+1;Pt<this.t;++Pt)it.data[Pt-ct-1]|=(this.data[Pt]&Nt)<<Tt,it.data[Pt-ct]=this.data[Pt]>>ht;ht>0&&(it.data[this.t-ct-1]|=(this.s&Nt)<<Tt),it.t=this.t-ct,it.clamp()}function p(yt,it){for(var ct=0,ht=0,Tt=Math.min(yt.t,this.t);ct<Tt;)ht+=this.data[ct]-yt.data[ct],it.data[ct++]=ht&this.DM,ht>>=this.DB;if(yt.t<this.t){for(ht-=yt.s;ct<this.t;)ht+=this.data[ct],it.data[ct++]=ht&this.DM,ht>>=this.DB;ht+=this.s}else{for(ht+=this.s;ct<yt.t;)ht-=yt.data[ct],it.data[ct++]=ht&this.DM,ht>>=this.DB;ht-=yt.s}it.s=ht<0?-1:0,ht<-1?it.data[ct++]=this.DV+ht:ht>0&&(it.data[ct++]=ht),it.t=ct,it.clamp()}function m(yt,it){var ct=this.abs(),ht=yt.abs(),Tt=ct.t;for(it.t=Tt+ht.t;--Tt>=0;)it.data[Tt]=0;for(Tt=0;Tt<ht.t;++Tt)it.data[Tt+ct.t]=ct.am(0,ht.data[Tt],it,Tt,0,ct.t);it.s=0,it.clamp(),this.s!=yt.s&&a.ZERO.subTo(it,it)}function w(yt){for(var it=this.abs(),ct=yt.t=2*it.t;--ct>=0;)yt.data[ct]=0;for(ct=0;ct<it.t-1;++ct){var ht=it.am(ct,it.data[ct],yt,2*ct,0,1);(yt.data[ct+it.t]+=it.am(ct+1,2*it.data[ct],yt,2*ct+1,ht,it.t-ct-1))>=it.DV&&(yt.data[ct+it.t]-=it.DV,yt.data[ct+it.t+1]=1)}yt.t>0&&(yt.data[yt.t-1]+=it.am(ct,it.data[ct],yt,2*ct,0,1)),yt.s=0,yt.clamp()}function x(yt,it,ct){var ht=yt.abs();if(!(ht.t<=0)){var Tt=this.abs();if(Tt.t<ht.t){it!=null&&it.fromInt(0),ct!=null&&this.copyTo(ct);return}ct==null&&(ct=n());var Nt=n(),Pt=this.s,Yt=yt.s,ne=this.DB-O(ht.data[ht.t-1]);ne>0?(ht.lShiftTo(ne,Nt),Tt.lShiftTo(ne,ct)):(ht.copyTo(Nt),Tt.copyTo(ct));var se=Nt.t,le=Nt.data[se-1];if(le!=0){var ue=le*(1<<this.F1)+(se>1?Nt.data[se-2]>>this.F2:0),we=this.FV/ue,Ke=(1<<this.F1)/ue,$e=1<<this.F2,je=ct.t,Lr=je-se,Er=it??n();for(Nt.dlShiftTo(Lr,Er),ct.compareTo(Er)>=0&&(ct.data[ct.t++]=1,ct.subTo(Er,ct)),a.ONE.dlShiftTo(se,Er),Er.subTo(Nt,Nt);Nt.t<se;)Nt.data[Nt.t++]=0;for(;--Lr>=0;){var ii=ct.data[--je]==le?this.DM:Math.floor(ct.data[je]*we+(ct.data[je-1]+$e)*Ke);if((ct.data[je]+=Nt.am(0,ii,ct,Lr,0,se))<ii)for(Nt.dlShiftTo(Lr,Er),ct.subTo(Er,ct);ct.data[je]<--ii;)ct.subTo(Er,ct)}it!=null&&(ct.drShiftTo(se,it),Pt!=Yt&&a.ZERO.subTo(it,it)),ct.t=se,ct.clamp(),ne>0&&ct.rShiftTo(ne,ct),Pt<0&&a.ZERO.subTo(ct,ct)}}}function b(yt){var it=n();return this.abs().divRemTo(yt,null,it),this.s<0&&it.compareTo(a.ZERO)>0&&yt.subTo(it,it),it}function f(yt){this.m=yt}function C(yt){return yt.s<0||yt.compareTo(this.m)>=0?yt.mod(this.m):yt}function F(yt){return yt}function z(yt){yt.divRemTo(this.m,null,yt)}function W(yt,it,ct){yt.multiplyTo(it,ct),this.reduce(ct)}function $(yt,it){yt.squareTo(it),this.reduce(it)}f.prototype.convert=C,f.prototype.revert=F,f.prototype.reduce=z,f.prototype.mulTo=W,f.prototype.sqrTo=$;function I(){if(this.t<1)return 0;var yt=this.data[0];if(!(yt&1))return 0;var it=yt&3;return it=it*(2-(yt&15)*it)&15,it=it*(2-(yt&255)*it)&255,it=it*(2-((yt&65535)*it&65535))&65535,it=it*(2-yt*it%this.DV)%this.DV,it>0?this.DV-it:-it}function K(yt){this.m=yt,this.mp=yt.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<yt.DB-15)-1,this.mt2=2*yt.t}function N(yt){var it=n();return yt.abs().dlShiftTo(this.m.t,it),it.divRemTo(this.m,null,it),yt.s<0&&it.compareTo(a.ZERO)>0&&this.m.subTo(it,it),it}function X(yt){var it=n();return yt.copyTo(it),this.reduce(it),it}function Q(yt){for(;yt.t<=this.mt2;)yt.data[yt.t++]=0;for(var it=0;it<this.m.t;++it){var ct=yt.data[it]&32767,ht=ct*this.mpl+((ct*this.mph+(yt.data[it]>>15)*this.mpl&this.um)<<15)&yt.DM;for(ct=it+this.m.t,yt.data[ct]+=this.m.am(0,ht,yt,it,0,this.m.t);yt.data[ct]>=yt.DV;)yt.data[ct]-=yt.DV,yt.data[++ct]++}yt.clamp(),yt.drShiftTo(this.m.t,yt),yt.compareTo(this.m)>=0&&yt.subTo(this.m,yt)}function L(yt,it){yt.squareTo(it),this.reduce(it)}function V(yt,it,ct){yt.multiplyTo(it,ct),this.reduce(ct)}K.prototype.convert=N,K.prototype.revert=X,K.prototype.reduce=Q,K.prototype.mulTo=V,K.prototype.sqrTo=L;function Z(){return(this.t>0?this.data[0]&1:this.s)==0}function H(yt,it){if(yt>4294967295||yt<1)return a.ONE;var ct=n(),ht=n(),Tt=it.convert(this),Nt=O(yt)-1;for(Tt.copyTo(ct);--Nt>=0;)if(it.sqrTo(ct,ht),(yt&1<<Nt)>0)it.mulTo(ht,Tt,ct);else{var Pt=ct;ct=ht,ht=Pt}return it.revert(ct)}function j(yt,it){var ct;return yt<256||it.isEven()?ct=new f(it):ct=new K(it),this.exp(yt,ct)}a.prototype.copyTo=T,a.prototype.fromInt=B,a.prototype.fromString=R,a.prototype.clamp=P,a.prototype.dlShiftTo=E,a.prototype.drShiftTo=s,a.prototype.lShiftTo=l,a.prototype.rShiftTo=d,a.prototype.subTo=p,a.prototype.multiplyTo=m,a.prototype.squareTo=w,a.prototype.divRemTo=x,a.prototype.invDigit=I,a.prototype.isEven=Z,a.prototype.exp=H,a.prototype.toString=D,a.prototype.negate=q,a.prototype.abs=k,a.prototype.compareTo=U,a.prototype.bitLength=G,a.prototype.mod=b,a.prototype.modPowInt=j,a.ZERO=M(0),a.ONE=M(1);function et(){var yt=n();return this.copyTo(yt),yt}function nt(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function st(){return this.t==0?this.s:this.data[0]<<24>>24}function ft(){return this.t==0?this.s:this.data[0]<<16>>16}function vt(yt){return Math.floor(Math.LN2*this.DB/Math.log(yt))}function ot(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function pt(yt){if(yt==null&&(yt=10),this.signum()==0||yt<2||yt>36)return"0";var it=this.chunkSize(yt),ct=Math.pow(yt,it),ht=M(ct),Tt=n(),Nt=n(),Pt="";for(this.divRemTo(ht,Tt,Nt);Tt.signum()>0;)Pt=(ct+Nt.intValue()).toString(yt).substr(1)+Pt,Tt.divRemTo(ht,Tt,Nt);return Nt.intValue().toString(yt)+Pt}function Ut(yt,it){this.fromInt(0),it==null&&(it=10);for(var ct=this.chunkSize(it),ht=Math.pow(it,ct),Tt=!1,Nt=0,Pt=0,Yt=0;Yt<yt.length;++Yt){var ne=S(yt,Yt);if(ne<0){yt.charAt(Yt)=="-"&&this.signum()==0&&(Tt=!0);continue}Pt=it*Pt+ne,++Nt>=ct&&(this.dMultiply(ht),this.dAddOffset(Pt,0),Nt=0,Pt=0)}Nt>0&&(this.dMultiply(Math.pow(it,Nt)),this.dAddOffset(Pt,0)),Tt&&a.ZERO.subTo(this,this)}function At(yt,it,ct){if(typeof it=="number")if(yt<2)this.fromInt(1);else for(this.fromNumber(yt,ct),this.testBit(yt-1)||this.bitwiseTo(a.ONE.shiftLeft(yt-1),Dt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(it);)this.dAddOffset(2,0),this.bitLength()>yt&&this.subTo(a.ONE.shiftLeft(yt-1),this);else{var ht=new Array,Tt=yt&7;ht.length=(yt>>3)+1,it.nextBytes(ht),Tt>0?ht[0]&=(1<<Tt)-1:ht[0]=0,this.fromString(ht,256)}}function It(){var yt=this.t,it=new Array;it[0]=this.s;var ct=this.DB-yt*this.DB%8,ht,Tt=0;if(yt-- >0)for(ct<this.DB&&(ht=this.data[yt]>>ct)!=(this.s&this.DM)>>ct&&(it[Tt++]=ht|this.s<<this.DB-ct);yt>=0;)ct<8?(ht=(this.data[yt]&(1<<ct)-1)<<8-ct,ht|=this.data[--yt]>>(ct+=this.DB-8)):(ht=this.data[yt]>>(ct-=8)&255,ct<=0&&(ct+=this.DB,--yt)),ht&128&&(ht|=-256),Tt==0&&(this.s&128)!=(ht&128)&&++Tt,(Tt>0||ht!=this.s)&&(it[Tt++]=ht);return it}function Jt(yt){return this.compareTo(yt)==0}function at(yt){return this.compareTo(yt)<0?this:yt}function J(yt){return this.compareTo(yt)>0?this:yt}function rt(yt,it,ct){var ht,Tt,Nt=Math.min(yt.t,this.t);for(ht=0;ht<Nt;++ht)ct.data[ht]=it(this.data[ht],yt.data[ht]);if(yt.t<this.t){for(Tt=yt.s&this.DM,ht=Nt;ht<this.t;++ht)ct.data[ht]=it(this.data[ht],Tt);ct.t=this.t}else{for(Tt=this.s&this.DM,ht=Nt;ht<yt.t;++ht)ct.data[ht]=it(Tt,yt.data[ht]);ct.t=yt.t}ct.s=it(this.s,yt.s),ct.clamp()}function lt(yt,it){return yt&it}function gt(yt){var it=n();return this.bitwiseTo(yt,lt,it),it}function Dt(yt,it){return yt|it}function ut(yt){var it=n();return this.bitwiseTo(yt,Dt,it),it}function Y(yt,it){return yt^it}function tt(yt){var it=n();return this.bitwiseTo(yt,Y,it),it}function dt(yt,it){return yt&~it}function mt(yt){var it=n();return this.bitwiseTo(yt,dt,it),it}function xt(){for(var yt=n(),it=0;it<this.t;++it)yt.data[it]=this.DM&~this.data[it];return yt.t=this.t,yt.s=~this.s,yt}function bt(yt){var it=n();return yt<0?this.rShiftTo(-yt,it):this.lShiftTo(yt,it),it}function _t(yt){var it=n();return yt<0?this.lShiftTo(-yt,it):this.rShiftTo(yt,it),it}function Ht(yt){if(yt==0)return-1;var it=0;return yt&65535||(yt>>=16,it+=16),yt&255||(yt>>=8,it+=8),yt&15||(yt>>=4,it+=4),yt&3||(yt>>=2,it+=2),yt&1||++it,it}function St(){for(var yt=0;yt<this.t;++yt)if(this.data[yt]!=0)return yt*this.DB+Ht(this.data[yt]);return this.s<0?this.t*this.DB:-1}function Mt(yt){for(var it=0;yt!=0;)yt&=yt-1,++it;return it}function jt(){for(var yt=0,it=this.s&this.DM,ct=0;ct<this.t;++ct)yt+=Mt(this.data[ct]^it);return yt}function Lt(yt){var it=Math.floor(yt/this.DB);return it>=this.t?this.s!=0:(this.data[it]&1<<yt%this.DB)!=0}function Ft(yt,it){var ct=a.ONE.shiftLeft(yt);return this.bitwiseTo(ct,it,ct),ct}function te(yt){return this.changeBit(yt,Dt)}function Bt(yt){return this.changeBit(yt,dt)}function Ot(yt){return this.changeBit(yt,Y)}function ie(yt,it){for(var ct=0,ht=0,Tt=Math.min(yt.t,this.t);ct<Tt;)ht+=this.data[ct]+yt.data[ct],it.data[ct++]=ht&this.DM,ht>>=this.DB;if(yt.t<this.t){for(ht+=yt.s;ct<this.t;)ht+=this.data[ct],it.data[ct++]=ht&this.DM,ht>>=this.DB;ht+=this.s}else{for(ht+=this.s;ct<yt.t;)ht+=yt.data[ct],it.data[ct++]=ht&this.DM,ht>>=this.DB;ht+=yt.s}it.s=ht<0?-1:0,ht>0?it.data[ct++]=ht:ht<-1&&(it.data[ct++]=this.DV+ht),it.t=ct,it.clamp()}function kt(yt){var it=n();return this.addTo(yt,it),it}function qt(yt){var it=n();return this.subTo(yt,it),it}function ae(yt){var it=n();return this.multiplyTo(yt,it),it}function Rt(yt){var it=n();return this.divRemTo(yt,it,null),it}function zt(yt){var it=n();return this.divRemTo(yt,null,it),it}function he(yt){var it=n(),ct=n();return this.divRemTo(yt,it,ct),new Array(it,ct)}function Vt(yt){this.data[this.t]=this.am(0,yt-1,this,0,0,this.t),++this.t,this.clamp()}function Qt(yt,it){if(yt!=0){for(;this.t<=it;)this.data[this.t++]=0;for(this.data[it]+=yt;this.data[it]>=this.DV;)this.data[it]-=this.DV,++it>=this.t&&(this.data[this.t++]=0),++this.data[it]}}function ge(){}function Gt(yt){return yt}function $t(yt,it,ct){yt.multiplyTo(it,ct)}function pe(yt,it){yt.squareTo(it)}ge.prototype.convert=Gt,ge.prototype.revert=Gt,ge.prototype.mulTo=$t,ge.prototype.sqrTo=pe;function de(yt){return this.exp(yt,new ge)}function Ee(yt,it,ct){var ht=Math.min(this.t+yt.t,it);for(ct.s=0,ct.t=ht;ht>0;)ct.data[--ht]=0;var Tt;for(Tt=ct.t-this.t;ht<Tt;++ht)ct.data[ht+this.t]=this.am(0,yt.data[ht],ct,ht,0,this.t);for(Tt=Math.min(yt.t,it);ht<Tt;++ht)this.am(0,yt.data[ht],ct,ht,0,it-ht);ct.clamp()}function xe(yt,it,ct){--it;var ht=ct.t=this.t+yt.t-it;for(ct.s=0;--ht>=0;)ct.data[ht]=0;for(ht=Math.max(it-this.t,0);ht<yt.t;++ht)ct.data[this.t+ht-it]=this.am(it-ht,yt.data[ht],ct,0,0,this.t+ht-it);ct.clamp(),ct.drShiftTo(1,ct)}function Se(yt){this.r2=n(),this.q3=n(),a.ONE.dlShiftTo(2*yt.t,this.r2),this.mu=this.r2.divide(yt),this.m=yt}function Be(yt){if(yt.s<0||yt.t>2*this.m.t)return yt.mod(this.m);if(yt.compareTo(this.m)<0)return yt;var it=n();return yt.copyTo(it),this.reduce(it),it}function Ne(yt){return yt}function qe(yt){for(yt.drShiftTo(this.m.t-1,this.r2),yt.t>this.m.t+1&&(yt.t=this.m.t+1,yt.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);yt.compareTo(this.r2)<0;)yt.dAddOffset(1,this.m.t+1);for(yt.subTo(this.r2,yt);yt.compareTo(this.m)>=0;)yt.subTo(this.m,yt)}function Xe(yt,it){yt.squareTo(it),this.reduce(it)}function Ge(yt,it,ct){yt.multiplyTo(it,ct),this.reduce(ct)}Se.prototype.convert=Be,Se.prototype.revert=Ne,Se.prototype.reduce=qe,Se.prototype.mulTo=Ge,Se.prototype.sqrTo=Xe;function Je(yt,it){var ct=yt.bitLength(),ht,Tt=M(1),Nt;if(ct<=0)return Tt;ct<18?ht=1:ct<48?ht=3:ct<144?ht=4:ct<768?ht=5:ht=6,ct<8?Nt=new f(it):it.isEven()?Nt=new Se(it):Nt=new K(it);var Pt=new Array,Yt=3,ne=ht-1,se=(1<<ht)-1;if(Pt[1]=Nt.convert(this),ht>1){var le=n();for(Nt.sqrTo(Pt[1],le);Yt<=se;)Pt[Yt]=n(),Nt.mulTo(le,Pt[Yt-2],Pt[Yt]),Yt+=2}var ue=yt.t-1,we,Ke=!0,$e=n(),je;for(ct=O(yt.data[ue])-1;ue>=0;){for(ct>=ne?we=yt.data[ue]>>ct-ne&se:(we=(yt.data[ue]&(1<<ct+1)-1)<<ne-ct,ue>0&&(we|=yt.data[ue-1]>>this.DB+ct-ne)),Yt=ht;!(we&1);)we>>=1,--Yt;if((ct-=Yt)<0&&(ct+=this.DB,--ue),Ke)Pt[we].copyTo(Tt),Ke=!1;else{for(;Yt>1;)Nt.sqrTo(Tt,$e),Nt.sqrTo($e,Tt),Yt-=2;Yt>0?Nt.sqrTo(Tt,$e):(je=Tt,Tt=$e,$e=je),Nt.mulTo($e,Pt[we],Tt)}for(;ue>=0&&!(yt.data[ue]&1<<ct);)Nt.sqrTo(Tt,$e),je=Tt,Tt=$e,$e=je,--ct<0&&(ct=this.DB-1,--ue)}return Nt.revert(Tt)}function ze(yt){var it=this.s<0?this.negate():this.clone(),ct=yt.s<0?yt.negate():yt.clone();if(it.compareTo(ct)<0){var ht=it;it=ct,ct=ht}var Tt=it.getLowestSetBit(),Nt=ct.getLowestSetBit();if(Nt<0)return it;for(Tt<Nt&&(Nt=Tt),Nt>0&&(it.rShiftTo(Nt,it),ct.rShiftTo(Nt,ct));it.signum()>0;)(Tt=it.getLowestSetBit())>0&&it.rShiftTo(Tt,it),(Tt=ct.getLowestSetBit())>0&&ct.rShiftTo(Tt,ct),it.compareTo(ct)>=0?(it.subTo(ct,it),it.rShiftTo(1,it)):(ct.subTo(it,ct),ct.rShiftTo(1,ct));return Nt>0&&ct.lShiftTo(Nt,ct),ct}function rr(yt){if(yt<=0)return 0;var it=this.DV%yt,ct=this.s<0?yt-1:0;if(this.t>0)if(it==0)ct=this.data[0]%yt;else for(var ht=this.t-1;ht>=0;--ht)ct=(it*ct+this.data[ht])%yt;return ct}function Qe(yt){var it=yt.isEven();if(this.isEven()&&it||yt.signum()==0)return a.ZERO;for(var ct=yt.clone(),ht=this.clone(),Tt=M(1),Nt=M(0),Pt=M(0),Yt=M(1);ct.signum()!=0;){for(;ct.isEven();)ct.rShiftTo(1,ct),it?((!Tt.isEven()||!Nt.isEven())&&(Tt.addTo(this,Tt),Nt.subTo(yt,Nt)),Tt.rShiftTo(1,Tt)):Nt.isEven()||Nt.subTo(yt,Nt),Nt.rShiftTo(1,Nt);for(;ht.isEven();)ht.rShiftTo(1,ht),it?((!Pt.isEven()||!Yt.isEven())&&(Pt.addTo(this,Pt),Yt.subTo(yt,Yt)),Pt.rShiftTo(1,Pt)):Yt.isEven()||Yt.subTo(yt,Yt),Yt.rShiftTo(1,Yt);ct.compareTo(ht)>=0?(ct.subTo(ht,ct),it&&Tt.subTo(Pt,Tt),Nt.subTo(Yt,Nt)):(ht.subTo(ct,ht),it&&Pt.subTo(Tt,Pt),Yt.subTo(Nt,Yt))}if(ht.compareTo(a.ONE)!=0)return a.ZERO;if(Yt.compareTo(yt)>=0)return Yt.subtract(yt);if(Yt.signum()<0)Yt.addTo(yt,Yt);else return Yt;return Yt.signum()<0?Yt.add(yt):Yt}var Le=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ir=(1<<26)/Le[Le.length-1];function nr(yt){var it,ct=this.abs();if(ct.t==1&&ct.data[0]<=Le[Le.length-1]){for(it=0;it<Le.length;++it)if(ct.data[0]==Le[it])return!0;return!1}if(ct.isEven())return!1;for(it=1;it<Le.length;){for(var ht=Le[it],Tt=it+1;Tt<Le.length&&ht<ir;)ht*=Le[Tt++];for(ht=ct.modInt(ht);it<Tt;)if(ht%Le[it++]==0)return!1}return ct.millerRabin(yt)}function Ze(yt){var it=this.subtract(a.ONE),ct=it.getLowestSetBit();if(ct<=0)return!1;for(var ht=it.shiftRight(ct),Tt=ar(),Nt,Pt=0;Pt<yt;++Pt){do Nt=new a(this.bitLength(),Tt);while(Nt.compareTo(a.ONE)<=0||Nt.compareTo(it)>=0);var Yt=Nt.modPow(ht,this);if(Yt.compareTo(a.ONE)!=0&&Yt.compareTo(it)!=0){for(var ne=1;ne++<ct&&Yt.compareTo(it)!=0;)if(Yt=Yt.modPowInt(2,this),Yt.compareTo(a.ONE)==0)return!1;if(Yt.compareTo(it)!=0)return!1}}return!0}function ar(){return{nextBytes:function(yt){for(var it=0;it<yt.length;++it)yt[it]=Math.floor(Math.random()*256)}}}a.prototype.chunkSize=vt,a.prototype.toRadix=pt,a.prototype.fromRadix=Ut,a.prototype.fromNumber=At,a.prototype.bitwiseTo=rt,a.prototype.changeBit=Ft,a.prototype.addTo=ie,a.prototype.dMultiply=Vt,a.prototype.dAddOffset=Qt,a.prototype.multiplyLowerTo=Ee,a.prototype.multiplyUpperTo=xe,a.prototype.modInt=rr,a.prototype.millerRabin=Ze,a.prototype.clone=et,a.prototype.intValue=nt,a.prototype.byteValue=st,a.prototype.shortValue=ft,a.prototype.signum=ot,a.prototype.toByteArray=It,a.prototype.equals=Jt,a.prototype.min=at,a.prototype.max=J,a.prototype.and=gt,a.prototype.or=ut,a.prototype.xor=tt,a.prototype.andNot=mt,a.prototype.not=xt,a.prototype.shiftLeft=bt,a.prototype.shiftRight=_t,a.prototype.getLowestSetBit=St,a.prototype.bitCount=jt,a.prototype.testBit=Lt,a.prototype.setBit=te,a.prototype.clearBit=Bt,a.prototype.flipBit=Ot,a.prototype.add=kt,a.prototype.subtract=qt,a.prototype.multiply=ae,a.prototype.divide=Rt,a.prototype.remainder=zt,a.prototype.divideAndRemainder=he,a.prototype.modPow=Je,a.prototype.modInverse=Qe,a.prototype.pow=de,a.prototype.gcd=ze,a.prototype.isProbablePrime=nr}}),sf=Ve({"../../node_modules/node-forge/lib/sha1.js"(i,e){var r=sr();jn(),wr();var t=e.exports=r.sha1=r.sha1||{};r.md.sha1=r.md.algorithms.sha1=t,t.create=function(){n||c();var v=null,o=r.util.createBuffer(),h=new Array(80),g={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return g.start=function(){g.messageLength=0,g.fullMessageLength=g.messageLength64=[];for(var y=g.messageLengthSize/4,_=0;_<y;++_)g.fullMessageLength.push(0);return o=r.util.createBuffer(),v={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},g},g.start(),g.update=function(y,_){_==="utf8"&&(y=r.util.encodeUtf8(y));var A=y.length;g.messageLength+=A,A=[A/4294967296>>>0,A>>>0];for(var S=g.fullMessageLength.length-1;S>=0;--S)g.fullMessageLength[S]+=A[1],A[1]=A[0]+(g.fullMessageLength[S]/4294967296>>>0),g.fullMessageLength[S]=g.fullMessageLength[S]>>>0,A[0]=A[1]/4294967296>>>0;return o.putBytes(y),u(v,h,o),(o.read>2048||o.length()===0)&&o.compact(),g},g.digest=function(){var y=r.util.createBuffer();y.putBytes(o.bytes());var _=g.fullMessageLength[g.fullMessageLength.length-1]+g.messageLengthSize,A=_&g.blockLength-1;y.putBytes(a.substr(0,g.blockLength-A));for(var S,T,B=g.fullMessageLength[0]*8,M=0;M<g.fullMessageLength.length-1;++M)S=g.fullMessageLength[M+1]*8,T=S/4294967296>>>0,B+=T,y.putInt32(B>>>0),B=S>>>0;y.putInt32(B);var R={h0:v.h0,h1:v.h1,h2:v.h2,h3:v.h3,h4:v.h4};u(R,h,y);var P=r.util.createBuffer();return P.putInt32(R.h0),P.putInt32(R.h1),P.putInt32(R.h2),P.putInt32(R.h3),P.putInt32(R.h4),P},g};var a=null,n=!1;function c(){a="",a+=r.util.fillString("\0",64),n=!0}function u(v,o,h){for(var g,y,_,A,S,T,B,M,R=h.length();R>=64;){for(y=v.h0,_=v.h1,A=v.h2,S=v.h3,T=v.h4,M=0;M<16;++M)g=h.getInt32(),o[M]=g,B=S^_&(A^S),g=(y<<5|y>>>27)+B+T+1518500249+g,T=S,S=A,A=(_<<30|_>>>2)>>>0,_=y,y=g;for(;M<20;++M)g=o[M-3]^o[M-8]^o[M-14]^o[M-16],g=g<<1|g>>>31,o[M]=g,B=S^_&(A^S),g=(y<<5|y>>>27)+B+T+1518500249+g,T=S,S=A,A=(_<<30|_>>>2)>>>0,_=y,y=g;for(;M<32;++M)g=o[M-3]^o[M-8]^o[M-14]^o[M-16],g=g<<1|g>>>31,o[M]=g,B=_^A^S,g=(y<<5|y>>>27)+B+T+1859775393+g,T=S,S=A,A=(_<<30|_>>>2)>>>0,_=y,y=g;for(;M<40;++M)g=o[M-6]^o[M-16]^o[M-28]^o[M-32],g=g<<2|g>>>30,o[M]=g,B=_^A^S,g=(y<<5|y>>>27)+B+T+1859775393+g,T=S,S=A,A=(_<<30|_>>>2)>>>0,_=y,y=g;for(;M<60;++M)g=o[M-6]^o[M-16]^o[M-28]^o[M-32],g=g<<2|g>>>30,o[M]=g,B=_&A|S&(_^A),g=(y<<5|y>>>27)+B+T+2400959708+g,T=S,S=A,A=(_<<30|_>>>2)>>>0,_=y,y=g;for(;M<80;++M)g=o[M-6]^o[M-16]^o[M-28]^o[M-32],g=g<<2|g>>>30,o[M]=g,B=_^A^S,g=(y<<5|y>>>27)+B+T+3395469782+g,T=S,S=A,A=(_<<30|_>>>2)>>>0,_=y,y=g;v.h0=v.h0+y|0,v.h1=v.h1+_|0,v.h2=v.h2+A|0,v.h3=v.h3+S|0,v.h4=v.h4+T|0,R-=64}}}}),x_=Ve({"../../node_modules/node-forge/lib/pkcs1.js"(i,e){var r=sr();wr(),fn(),sf();var t=e.exports=r.pkcs1=r.pkcs1||{};t.encode_rsa_oaep=function(n,c,u){var v,o,h,g;typeof u=="string"?(v=u,o=arguments[3]||void 0,h=arguments[4]||void 0):u&&(v=u.label||void 0,o=u.seed||void 0,h=u.md||void 0,u.mgf1&&u.mgf1.md&&(g=u.mgf1.md)),h?h.start():h=r.md.sha1.create(),g||(g=h);var y=Math.ceil(n.n.bitLength()/8),_=y-2*h.digestLength-2;if(c.length>_){var A=new Error("RSAES-OAEP input message length is too long.");throw A.length=c.length,A.maxLength=_,A}v||(v=""),h.update(v,"raw");for(var S=h.digest(),T="",B=_-c.length,M=0;M<B;M++)T+="\0";var R=S.getBytes()+T+""+c;if(!o)o=r.random.getBytes(h.digestLength);else if(o.length!==h.digestLength){var A=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw A.seedLength=o.length,A.digestLength=h.digestLength,A}var P=a(o,y-h.digestLength-1,g),D=r.util.xorBytes(R,P,R.length),q=a(D,h.digestLength,g),k=r.util.xorBytes(o,q,o.length);return"\0"+k+D},t.decode_rsa_oaep=function(n,c,u){var v,o,h;typeof u=="string"?(v=u,o=arguments[3]||void 0):u&&(v=u.label||void 0,o=u.md||void 0,u.mgf1&&u.mgf1.md&&(h=u.mgf1.md));var g=Math.ceil(n.n.bitLength()/8);if(c.length!==g){var D=new Error("RSAES-OAEP encoded message length is invalid.");throw D.length=c.length,D.expectedLength=g,D}if(o===void 0?o=r.md.sha1.create():o.start(),h||(h=o),g<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");v||(v=""),o.update(v,"raw");for(var y=o.digest().getBytes(),_=c.charAt(0),A=c.substring(1,o.digestLength+1),S=c.substring(1+o.digestLength),T=a(S,o.digestLength,h),B=r.util.xorBytes(A,T,A.length),M=a(B,g-o.digestLength-1,h),R=r.util.xorBytes(S,M,S.length),P=R.substring(0,o.digestLength),D=_!=="\0",q=0;q<o.digestLength;++q)D|=y.charAt(q)!==P.charAt(q);for(var k=1,U=o.digestLength,O=o.digestLength;O<R.length;O++){var G=R.charCodeAt(O),E=G&1^1,s=k?65534:0;D|=G&s,k=k&E,U+=k}if(D||R.charCodeAt(U)!==1)throw new Error("Invalid RSAES-OAEP padding.");return R.substring(U+1)};function a(n,c,u){u||(u=r.md.sha1.create());for(var v="",o=Math.ceil(c/u.digestLength),h=0;h<o;++h){var g=String.fromCharCode(h>>24&255,h>>16&255,h>>8&255,h&255);u.start(),u.update(n+g),v+=u.digest().getBytes()}return v.substring(0,c)}}}),I_=Ve({"../../node_modules/node-forge/lib/prime.js"(i,e){var r=sr();wr(),rc(),fn(),function(){if(r.prime){e.exports=r.prime;return}var t=e.exports=r.prime=r.prime||{},a=r.jsbn.BigInteger,n=[6,4,2,4,2,4,6,2],c=new a(null);c.fromInt(30);var u=function(A,S){return A|S};t.generateProbablePrime=function(A,S,T){typeof S=="function"&&(T=S,S={}),S=S||{};var B=S.algorithm||"PRIMEINC";typeof B=="string"&&(B={name:B}),B.options=B.options||{};var M=S.prng||r.random,R={nextBytes:function(P){for(var D=M.getBytesSync(P.length),q=0;q<P.length;++q)P[q]=D.charCodeAt(q)}};if(B.name==="PRIMEINC")return v(A,R,B.options,T);throw new Error("Invalid prime generation algorithm: "+B.name)};function v(A,S,T,B){return"workers"in T?g(A,S,T,B):o(A,S,T,B)}function o(A,S,T,B){var M=y(A,S),R=0,P=_(M.bitLength());"millerRabinTests"in T&&(P=T.millerRabinTests);var D=10;"maxBlockTime"in T&&(D=T.maxBlockTime),h(M,A,S,R,P,D,B)}function h(A,S,T,B,M,R,P){var D=+new Date;do{if(A.bitLength()>S&&(A=y(S,T)),A.isProbablePrime(M))return P(null,A);A.dAddOffset(n[B++%8],0)}while(R<0||+new Date-D<R);r.util.setImmediate(function(){h(A,S,T,B,M,R,P)})}function g(A,S,T,B){if(typeof Worker>"u")return o(A,S,T,B);var M=y(A,S),R=T.workers,P=T.workLoad||100,D=P*30/8,q=T.workerScript||"forge/prime.worker.js";if(R===-1)return r.util.estimateCores(function(U,O){U&&(O=2),R=O-1,k()});k();function k(){R=Math.max(1,R);for(var U=[],O=0;O<R;++O)U[O]=new Worker(q);for(var O=0;O<R;++O)U[O].addEventListener("message",E);var G=!1;function E(s){if(!G){var l=s.data;if(l.found){for(var d=0;d<U.length;++d)U[d].terminate();return G=!0,B(null,new a(l.prime,16))}M.bitLength()>A&&(M=y(A,S));var p=M.toString(16);s.target.postMessage({hex:p,workLoad:P}),M.dAddOffset(D,0)}}}}function y(A,S){var T=new a(A,S),B=A-1;return T.testBit(B)||T.bitwiseTo(a.ONE.shiftLeft(B),u,T),T.dAddOffset(31-T.mod(c).byteValue(),0),T}function _(A){return A<=100?27:A<=150?18:A<=200?15:A<=250?12:A<=300?9:A<=350?8:A<=400?7:A<=500?6:A<=600?5:A<=800?4:A<=1250?3:2}}()}}),ic=Ve({"../../node_modules/node-forge/lib/rsa.js"(i,e){var r=sr();Mn(),rc(),ts(),x_(),I_(),fn(),wr(),typeof t>"u"&&(t=r.jsbn.BigInteger);var t,a=r.util.isNodejs?ba():null,n=r.asn1,c=r.util;r.pki=r.pki||{},e.exports=r.pki.rsa=r.rsa=r.rsa||{};var u=r.pki,v=[6,4,2,4,2,4,6,2],o={name:"PrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},h={name:"RSAPrivateKey",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},g={name:"RSAPublicKey",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},y=r.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:n.Class.UNIVERSAL,type:n.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},_={name:"DigestInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:n.Class.UNIVERSAL,type:n.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},A=function(O){var G;if(O.algorithm in u.oids)G=u.oids[O.algorithm];else{var E=new Error("Unknown message digest algorithm.");throw E.algorithm=O.algorithm,E}var s=n.oidToDer(G).getBytes(),l=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]),d=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[]);d.value.push(n.create(n.Class.UNIVERSAL,n.Type.OID,!1,s)),d.value.push(n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,""));var p=n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,O.digest().getBytes());return l.value.push(d),l.value.push(p),n.toDer(l).getBytes()},S=function(O,G,E){if(E)return O.modPow(G.e,G.n);if(!G.p||!G.q)return O.modPow(G.d,G.n);G.dP||(G.dP=G.d.mod(G.p.subtract(t.ONE))),G.dQ||(G.dQ=G.d.mod(G.q.subtract(t.ONE))),G.qInv||(G.qInv=G.q.modInverse(G.p));var s;do s=new t(r.util.bytesToHex(r.random.getBytes(G.n.bitLength()/8)),16);while(s.compareTo(G.n)>=0||!s.gcd(G.n).equals(t.ONE));O=O.multiply(s.modPow(G.e,G.n)).mod(G.n);for(var l=O.mod(G.p).modPow(G.dP,G.p),d=O.mod(G.q).modPow(G.dQ,G.q);l.compareTo(d)<0;)l=l.add(G.p);var p=l.subtract(d).multiply(G.qInv).mod(G.p).multiply(G.q).add(d);return p=p.multiply(s.modInverse(G.n)).mod(G.n),p};u.rsa.encrypt=function(O,G,E){var s=E,l,d=Math.ceil(G.n.bitLength()/8);E!==!1&&E!==!0?(s=E===2,l=T(O,G,E)):(l=r.util.createBuffer(),l.putBytes(O));for(var p=new t(l.toHex(),16),m=S(p,G,s),w=m.toString(16),x=r.util.createBuffer(),b=d-Math.ceil(w.length/2);b>0;)x.putByte(0),--b;return x.putBytes(r.util.hexToBytes(w)),x.getBytes()},u.rsa.decrypt=function(O,G,E,s){var l=Math.ceil(G.n.bitLength()/8);if(O.length!==l){var d=new Error("Encrypted message length is invalid.");throw d.length=O.length,d.expected=l,d}var p=new t(r.util.createBuffer(O).toHex(),16);if(p.compareTo(G.n)>=0)throw new Error("Encrypted message is invalid.");for(var m=S(p,G,E),w=m.toString(16),x=r.util.createBuffer(),b=l-Math.ceil(w.length/2);b>0;)x.putByte(0),--b;return x.putBytes(r.util.hexToBytes(w)),s!==!1?B(x.getBytes(),G,E):x.getBytes()},u.rsa.createKeyPairGenerationState=function(O,G,E){typeof O=="string"&&(O=parseInt(O,10)),O=O||2048,E=E||{};var s=E.prng||r.random,l={nextBytes:function(m){for(var w=s.getBytesSync(m.length),x=0;x<m.length;++x)m[x]=w.charCodeAt(x)}},d=E.algorithm||"PRIMEINC",p;if(d==="PRIMEINC")p={algorithm:d,state:0,bits:O,rng:l,eInt:G||65537,e:new t(null),p:null,q:null,qBits:O>>1,pBits:O-(O>>1),pqState:0,num:null,keys:null},p.e.fromInt(p.eInt);else throw new Error("Invalid key generation algorithm: "+d);return p},u.rsa.stepKeyPairGenerationState=function(O,G){"algorithm"in O||(O.algorithm="PRIMEINC");var E=new t(null);E.fromInt(30);for(var s=0,l=function(f,C){return f|C},d=+new Date,p,m=0;O.keys===null&&(G<=0||m<G);){if(O.state===0){var w=O.p===null?O.pBits:O.qBits,x=w-1;O.pqState===0?(O.num=new t(w,O.rng),O.num.testBit(x)||O.num.bitwiseTo(t.ONE.shiftLeft(x),l,O.num),O.num.dAddOffset(31-O.num.mod(E).byteValue(),0),s=0,++O.pqState):O.pqState===1?O.num.bitLength()>w?O.pqState=0:O.num.isProbablePrime(P(O.num.bitLength()))?++O.pqState:O.num.dAddOffset(v[s++%8],0):O.pqState===2?O.pqState=O.num.subtract(t.ONE).gcd(O.e).compareTo(t.ONE)===0?3:0:O.pqState===3&&(O.pqState=0,O.p===null?O.p=O.num:O.q=O.num,O.p!==null&&O.q!==null&&++O.state,O.num=null)}else if(O.state===1)O.p.compareTo(O.q)<0&&(O.num=O.p,O.p=O.q,O.q=O.num),++O.state;else if(O.state===2)O.p1=O.p.subtract(t.ONE),O.q1=O.q.subtract(t.ONE),O.phi=O.p1.multiply(O.q1),++O.state;else if(O.state===3)O.phi.gcd(O.e).compareTo(t.ONE)===0?++O.state:(O.p=null,O.q=null,O.state=0);else if(O.state===4)O.n=O.p.multiply(O.q),O.n.bitLength()===O.bits?++O.state:(O.q=null,O.state=0);else if(O.state===5){var b=O.e.modInverse(O.phi);O.keys={privateKey:u.rsa.setPrivateKey(O.n,O.e,b,O.p,O.q,b.mod(O.p1),b.mod(O.q1),O.q.modInverse(O.p)),publicKey:u.rsa.setPublicKey(O.n,O.e)}}p=+new Date,m+=p-d,d=p}return O.keys!==null},u.rsa.generateKeyPair=function(O,G,E,s){if(arguments.length===1?typeof O=="object"?(E=O,O=void 0):typeof O=="function"&&(s=O,O=void 0):arguments.length===2?typeof O=="number"?typeof G=="function"?(s=G,G=void 0):typeof G!="number"&&(E=G,G=void 0):(E=O,s=G,O=void 0,G=void 0):arguments.length===3&&(typeof G=="number"?typeof E=="function"&&(s=E,E=void 0):(s=E,E=G,G=void 0)),E=E||{},O===void 0&&(O=E.bits||2048),G===void 0&&(G=E.e||65537),!r.options.usePureJavaScript&&!E.prng&&O>=256&&O<=16384&&(G===65537||G===3)){if(s){if(D("generateKeyPair"))return a.generateKeyPair("rsa",{modulusLength:O,publicExponent:G,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(m,w,x){if(m)return s(m);s(null,{privateKey:u.privateKeyFromPem(x),publicKey:u.publicKeyFromPem(w)})});if(q("generateKey")&&q("exportKey"))return c.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:O,publicExponent:U(G),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(m){return c.globalScope.crypto.subtle.exportKey("pkcs8",m.privateKey)}).then(void 0,function(m){s(m)}).then(function(m){if(m){var w=u.privateKeyFromAsn1(n.fromDer(r.util.createBuffer(m)));s(null,{privateKey:w,publicKey:u.setRsaPublicKey(w.n,w.e)})}});if(k("generateKey")&&k("exportKey")){var l=c.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:O,publicExponent:U(G),hash:{name:"SHA-256"}},!0,["sign","verify"]);l.oncomplete=function(m){var w=m.target.result,x=c.globalScope.msCrypto.subtle.exportKey("pkcs8",w.privateKey);x.oncomplete=function(b){var f=b.target.result,C=u.privateKeyFromAsn1(n.fromDer(r.util.createBuffer(f)));s(null,{privateKey:C,publicKey:u.setRsaPublicKey(C.n,C.e)})},x.onerror=function(b){s(b)}},l.onerror=function(m){s(m)};return}}else if(D("generateKeyPairSync")){var d=a.generateKeyPairSync("rsa",{modulusLength:O,publicExponent:G,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:u.privateKeyFromPem(d.privateKey),publicKey:u.publicKeyFromPem(d.publicKey)}}}var p=u.rsa.createKeyPairGenerationState(O,G,E);if(!s)return u.rsa.stepKeyPairGenerationState(p,0),p.keys;M(p,E,s)},u.setRsaPublicKey=u.rsa.setPublicKey=function(O,G){var E={n:O,e:G};return E.encrypt=function(s,l,d){if(typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5"),l==="RSAES-PKCS1-V1_5")l={encode:function(m,w,x){return T(m,w,2).getBytes()}};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={encode:function(m,w){return r.pkcs1.encode_rsa_oaep(w,m,d)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={encode:function(m){return m}};else if(typeof l=="string")throw new Error('Unsupported encryption scheme: "'+l+'".');var p=l.encode(s,E,!0);return u.rsa.encrypt(p,E,!0)},E.verify=function(s,l,d,p){typeof d=="string"?d=d.toUpperCase():d===void 0&&(d="RSASSA-PKCS1-V1_5"),p===void 0&&(p={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in p||(p._parseAllDigestBytes=!0),d==="RSASSA-PKCS1-V1_5"?d={verify:function(w,x){x=B(x,E,!0);var b=n.fromDer(x,{parseAllBytes:p._parseAllDigestBytes}),f={},C=[];if(!n.validate(b,_,f,C)){var F=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw F.errors=C,F}var z=n.derToOid(f.algorithmIdentifier);if(!(z===r.oids.md2||z===r.oids.md5||z===r.oids.sha1||z===r.oids.sha224||z===r.oids.sha256||z===r.oids.sha384||z===r.oids.sha512||z===r.oids["sha512-224"]||z===r.oids["sha512-256"])){var F=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw F.oid=z,F}if((z===r.oids.md2||z===r.oids.md5)&&!("parameters"in f))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return w===f.digest}}:(d==="NONE"||d==="NULL"||d===null)&&(d={verify:function(w,x){return x=B(x,E,!0),w===x}});var m=u.rsa.decrypt(l,E,!0,!1);return d.verify(s,m,E.n.bitLength())},E},u.setRsaPrivateKey=u.rsa.setPrivateKey=function(O,G,E,s,l,d,p,m){var w={n:O,e:G,d:E,p:s,q:l,dP:d,dQ:p,qInv:m};return w.decrypt=function(x,b,f){typeof b=="string"?b=b.toUpperCase():b===void 0&&(b="RSAES-PKCS1-V1_5");var C=u.rsa.decrypt(x,w,!1,!1);if(b==="RSAES-PKCS1-V1_5")b={decode:B};else if(b==="RSA-OAEP"||b==="RSAES-OAEP")b={decode:function(F,z){return r.pkcs1.decode_rsa_oaep(z,F,f)}};else if(["RAW","NONE","NULL",null].indexOf(b)!==-1)b={decode:function(F){return F}};else throw new Error('Unsupported encryption scheme: "'+b+'".');return b.decode(C,w,!1)},w.sign=function(x,b){var f=!1;typeof b=="string"&&(b=b.toUpperCase()),b===void 0||b==="RSASSA-PKCS1-V1_5"?(b={encode:A},f=1):(b==="NONE"||b==="NULL"||b===null)&&(b={encode:function(){return x}},f=1);var C=b.encode(x,w.n.bitLength());return u.rsa.encrypt(C,w,f)},w},u.wrapRsaPrivateKey=function(O){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(0).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(u.oids.rsaEncryption).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,n.toDer(O).getBytes())])},u.privateKeyFromAsn1=function(O){var G={},E=[];if(n.validate(O,o,G,E)&&(O=n.fromDer(r.util.createBuffer(G.privateKey))),G={},E=[],!n.validate(O,h,G,E)){var s=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw s.errors=E,s}var l,d,p,m,w,x,b,f;return l=r.util.createBuffer(G.privateKeyModulus).toHex(),d=r.util.createBuffer(G.privateKeyPublicExponent).toHex(),p=r.util.createBuffer(G.privateKeyPrivateExponent).toHex(),m=r.util.createBuffer(G.privateKeyPrime1).toHex(),w=r.util.createBuffer(G.privateKeyPrime2).toHex(),x=r.util.createBuffer(G.privateKeyExponent1).toHex(),b=r.util.createBuffer(G.privateKeyExponent2).toHex(),f=r.util.createBuffer(G.privateKeyCoefficient).toHex(),u.setRsaPrivateKey(new t(l,16),new t(d,16),new t(p,16),new t(m,16),new t(w,16),new t(x,16),new t(b,16),new t(f,16))},u.privateKeyToAsn1=u.privateKeyToRSAPrivateKey=function(O){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,n.integerToDer(0).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,R(O.n)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,R(O.e)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,R(O.d)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,R(O.p)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,R(O.q)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,R(O.dP)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,R(O.dQ)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,R(O.qInv))])},u.publicKeyFromAsn1=function(O){var G={},E=[];if(n.validate(O,y,G,E)){var s=n.derToOid(G.publicKeyOid);if(s!==u.oids.rsaEncryption){var l=new Error("Cannot read public key. Unknown OID.");throw l.oid=s,l}O=G.rsaPublicKey}if(E=[],!n.validate(O,g,G,E)){var l=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw l.errors=E,l}var d=r.util.createBuffer(G.publicKeyModulus).toHex(),p=r.util.createBuffer(G.publicKeyExponent).toHex();return u.setRsaPublicKey(new t(d,16),new t(p,16))},u.publicKeyToAsn1=u.publicKeyToSubjectPublicKeyInfo=function(O){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(u.oids.rsaEncryption).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")]),n.create(n.Class.UNIVERSAL,n.Type.BITSTRING,!1,[u.publicKeyToRSAPublicKey(O)])])},u.publicKeyToRSAPublicKey=function(O){return n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,R(O.n)),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,R(O.e))])};function T(O,G,E){var s=r.util.createBuffer(),l=Math.ceil(G.n.bitLength()/8);if(O.length>l-11){var d=new Error("Message is too long for PKCS#1 v1.5 padding.");throw d.length=O.length,d.max=l-11,d}s.putByte(0),s.putByte(E);var p=l-3-O.length,m;if(E===0||E===1){m=E===0?0:255;for(var w=0;w<p;++w)s.putByte(m)}else for(;p>0;){for(var x=0,b=r.random.getBytes(p),w=0;w<p;++w)m=b.charCodeAt(w),m===0?++x:s.putByte(m);p=x}return s.putByte(0),s.putBytes(O),s}function B(O,G,E,s){var l=Math.ceil(G.n.bitLength()/8),d=r.util.createBuffer(O),p=d.getByte(),m=d.getByte();if(p!==0||E&&m!==0&&m!==1||!E&&m!=2||E&&m===0&&typeof s>"u")throw new Error("Encryption block is invalid.");var w=0;if(m===0){w=l-3-s;for(var x=0;x<w;++x)if(d.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(m===1)for(w=0;d.length()>1;){if(d.getByte()!==255){--d.read;break}++w}else if(m===2)for(w=0;d.length()>1;){if(d.getByte()===0){--d.read;break}++w}var b=d.getByte();if(b!==0||w!==l-3-d.length())throw new Error("Encryption block is invalid.");return d.getBytes()}function M(O,G,E){typeof G=="function"&&(E=G,G={}),G=G||{};var s={algorithm:{name:G.algorithm||"PRIMEINC",options:{workers:G.workers||2,workLoad:G.workLoad||100,workerScript:G.workerScript}}};"prng"in G&&(s.prng=G.prng),l();function l(){d(O.pBits,function(m,w){if(m)return E(m);if(O.p=w,O.q!==null)return p(m,O.q);d(O.qBits,p)})}function d(m,w){r.prime.generateProbablePrime(m,s,w)}function p(m,w){if(m)return E(m);if(O.q=w,O.p.compareTo(O.q)<0){var x=O.p;O.p=O.q,O.q=x}if(O.p.subtract(t.ONE).gcd(O.e).compareTo(t.ONE)!==0){O.p=null,l();return}if(O.q.subtract(t.ONE).gcd(O.e).compareTo(t.ONE)!==0){O.q=null,d(O.qBits,p);return}if(O.p1=O.p.subtract(t.ONE),O.q1=O.q.subtract(t.ONE),O.phi=O.p1.multiply(O.q1),O.phi.gcd(O.e).compareTo(t.ONE)!==0){O.p=O.q=null,l();return}if(O.n=O.p.multiply(O.q),O.n.bitLength()!==O.bits){O.q=null,d(O.qBits,p);return}var b=O.e.modInverse(O.phi);O.keys={privateKey:u.rsa.setPrivateKey(O.n,O.e,b,O.p,O.q,b.mod(O.p1),b.mod(O.q1),O.q.modInverse(O.p)),publicKey:u.rsa.setPublicKey(O.n,O.e)},E(null,O.keys)}}function R(O){var G=O.toString(16);G[0]>="8"&&(G="00"+G);var E=r.util.hexToBytes(G);return E.length>1&&(E.charCodeAt(0)===0&&!(E.charCodeAt(1)&128)||E.charCodeAt(0)===255&&(E.charCodeAt(1)&128)===128)?E.substr(1):E}function P(O){return O<=100?27:O<=150?18:O<=200?15:O<=250?12:O<=300?9:O<=350?8:O<=400?7:O<=500?6:O<=600?5:O<=800?4:O<=1250?3:2}function D(O){return r.util.isNodejs&&typeof a[O]=="function"}function q(O){return typeof c.globalScope<"u"&&typeof c.globalScope.crypto=="object"&&typeof c.globalScope.crypto.subtle=="object"&&typeof c.globalScope.crypto.subtle[O]=="function"}function k(O){return typeof c.globalScope<"u"&&typeof c.globalScope.msCrypto=="object"&&typeof c.globalScope.msCrypto.subtle=="object"&&typeof c.globalScope.msCrypto.subtle[O]=="function"}function U(O){for(var G=r.util.hexToBytes(O.toString(16)),E=new Uint8Array(G.length),s=0;s<G.length;++s)E[s]=G.charCodeAt(s);return E}}}),M_=Ve({"../../node_modules/node-forge/lib/pbe.js"(i,e){var r=sr();Ja(),Mn(),ec(),jn(),ts(),Q1(),zs(),fn(),S_(),ic(),wr(),typeof t>"u"&&(t=r.jsbn.BigInteger);var t,a=r.asn1,n=r.pki=r.pki||{};e.exports=n.pbe=r.pbe=r.pbe||{};var c=n.oids,u={name:"EncryptedPrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},v={name:"PBES2Algorithms",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},o={name:"pkcs-12PbeParams",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"iterations"}]};n.encryptPrivateKeyInfo=function(A,S,T){T=T||{},T.saltSize=T.saltSize||8,T.count=T.count||2048,T.algorithm=T.algorithm||"aes128",T.prfAlgorithm=T.prfAlgorithm||"sha1";var B=r.random.getBytesSync(T.saltSize),M=T.count,R=a.integerToDer(M),P,D,q;if(T.algorithm.indexOf("aes")===0||T.algorithm==="des"){var k,U,O;switch(T.algorithm){case"aes128":P=16,k=16,U=c["aes128-CBC"],O=r.aes.createEncryptionCipher;break;case"aes192":P=24,k=16,U=c["aes192-CBC"],O=r.aes.createEncryptionCipher;break;case"aes256":P=32,k=16,U=c["aes256-CBC"],O=r.aes.createEncryptionCipher;break;case"des":P=8,k=8,U=c.desCBC,O=r.des.createEncryptionCipher;break;default:var G=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw G.algorithm=T.algorithm,G}var E="hmacWith"+T.prfAlgorithm.toUpperCase(),s=y(E),l=r.pkcs5.pbkdf2(S,B,M,P,s),d=r.random.getBytesSync(k),p=O(l);p.start(d),p.update(a.toDer(A)),p.finish(),q=p.output.getBytes();var m=_(B,R,P,E);D=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(c.pkcs5PBES2).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(c.pkcs5PBKDF2).getBytes()),m]),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(U).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,d)])])])}else if(T.algorithm==="3des"){P=24;var w=new r.util.ByteBuffer(B),l=n.pbe.generatePkcs12Key(S,w,1,M,P),d=n.pbe.generatePkcs12Key(S,w,2,M,P),p=r.des.createEncryptionCipher(l);p.start(d),p.update(a.toDer(A)),p.finish(),q=p.output.getBytes(),D=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(c["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,B),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,R.getBytes())])])}else{var G=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw G.algorithm=T.algorithm,G}var x=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[D,a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,q)]);return x},n.decryptPrivateKeyInfo=function(A,S){var T=null,B={},M=[];if(!a.validate(A,u,B,M)){var R=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw R.errors=M,R}var P=a.derToOid(B.encryptionOid),D=n.pbe.getCipher(P,B.encryptionParams,S),q=r.util.createBuffer(B.encryptedData);return D.update(q),D.finish()&&(T=a.fromDer(D.output)),T},n.encryptedPrivateKeyToPem=function(A,S){var T={type:"ENCRYPTED PRIVATE KEY",body:a.toDer(A).getBytes()};return r.pem.encode(T,{maxline:S})},n.encryptedPrivateKeyFromPem=function(A){var S=r.pem.decode(A)[0];if(S.type!=="ENCRYPTED PRIVATE KEY"){var T=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw T.headerType=S.type,T}if(S.procType&&S.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return a.fromDer(S.body)},n.encryptRsaPrivateKey=function(A,S,T){if(T=T||{},!T.legacy){var B=n.wrapRsaPrivateKey(n.privateKeyToAsn1(A));return B=n.encryptPrivateKeyInfo(B,S,T),n.encryptedPrivateKeyToPem(B)}var M,R,P,D;switch(T.algorithm){case"aes128":M="AES-128-CBC",P=16,R=r.random.getBytesSync(16),D=r.aes.createEncryptionCipher;break;case"aes192":M="AES-192-CBC",P=24,R=r.random.getBytesSync(16),D=r.aes.createEncryptionCipher;break;case"aes256":M="AES-256-CBC",P=32,R=r.random.getBytesSync(16),D=r.aes.createEncryptionCipher;break;case"3des":M="DES-EDE3-CBC",P=24,R=r.random.getBytesSync(8),D=r.des.createEncryptionCipher;break;case"des":M="DES-CBC",P=8,R=r.random.getBytesSync(8),D=r.des.createEncryptionCipher;break;default:var q=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+T.algorithm+'".');throw q.algorithm=T.algorithm,q}var k=r.pbe.opensslDeriveBytes(S,R.substr(0,8),P),U=D(k);U.start(R),U.update(a.toDer(n.privateKeyToAsn1(A))),U.finish();var O={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:M,parameters:r.util.bytesToHex(R).toUpperCase()},body:U.output.getBytes()};return r.pem.encode(O)},n.decryptRsaPrivateKey=function(A,S){var T=null,B=r.pem.decode(A)[0];if(B.type!=="ENCRYPTED PRIVATE KEY"&&B.type!=="PRIVATE KEY"&&B.type!=="RSA PRIVATE KEY"){var M=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw M.headerType=M,M}if(B.procType&&B.procType.type==="ENCRYPTED"){var R,P;switch(B.dekInfo.algorithm){case"DES-CBC":R=8,P=r.des.createDecryptionCipher;break;case"DES-EDE3-CBC":R=24,P=r.des.createDecryptionCipher;break;case"AES-128-CBC":R=16,P=r.aes.createDecryptionCipher;break;case"AES-192-CBC":R=24,P=r.aes.createDecryptionCipher;break;case"AES-256-CBC":R=32,P=r.aes.createDecryptionCipher;break;case"RC2-40-CBC":R=5,P=function(O){return r.rc2.createDecryptionCipher(O,40)};break;case"RC2-64-CBC":R=8,P=function(O){return r.rc2.createDecryptionCipher(O,64)};break;case"RC2-128-CBC":R=16,P=function(O){return r.rc2.createDecryptionCipher(O,128)};break;default:var M=new Error('Could not decrypt private key; unsupported encryption algorithm "'+B.dekInfo.algorithm+'".');throw M.algorithm=B.dekInfo.algorithm,M}var D=r.util.hexToBytes(B.dekInfo.parameters),q=r.pbe.opensslDeriveBytes(S,D.substr(0,8),R),k=P(q);if(k.start(D),k.update(r.util.createBuffer(B.body)),k.finish())T=k.output.getBytes();else return T}else T=B.body;return B.type==="ENCRYPTED PRIVATE KEY"?T=n.decryptPrivateKeyInfo(a.fromDer(T),S):T=a.fromDer(T),T!==null&&(T=n.privateKeyFromAsn1(T)),T},n.pbe.generatePkcs12Key=function(A,S,T,B,M,R){var P,D;if(typeof R>"u"||R===null){if(!("sha1"in r.md))throw new Error('"sha1" hash algorithm unavailable.');R=r.md.sha1.create()}var q=R.digestLength,k=R.blockLength,U=new r.util.ByteBuffer,O=new r.util.ByteBuffer;if(A!=null){for(D=0;D<A.length;D++)O.putInt16(A.charCodeAt(D));O.putInt16(0)}var G=O.length(),E=S.length(),s=new r.util.ByteBuffer;s.fillWithByte(T,k);var l=k*Math.ceil(E/k),d=new r.util.ByteBuffer;for(D=0;D<l;D++)d.putByte(S.at(D%E));var p=k*Math.ceil(G/k),m=new r.util.ByteBuffer;for(D=0;D<p;D++)m.putByte(O.at(D%G));var w=d;w.putBuffer(m);for(var x=Math.ceil(M/q),b=1;b<=x;b++){var f=new r.util.ByteBuffer;f.putBytes(s.bytes()),f.putBytes(w.bytes());for(var C=0;C<B;C++)R.start(),R.update(f.getBytes()),f=R.digest();var F=new r.util.ByteBuffer;for(D=0;D<k;D++)F.putByte(f.at(D%q));var z=Math.ceil(E/k)+Math.ceil(G/k),W=new r.util.ByteBuffer;for(P=0;P<z;P++){var $=new r.util.ByteBuffer(w.getBytes(k)),I=511;for(D=F.length()-1;D>=0;D--)I=I>>8,I+=F.at(D)+$.at(D),$.setAt(D,I&255);W.putBuffer($)}w=W,U.putBuffer(f)}return U.truncate(U.length()-M),U},n.pbe.getCipher=function(A,S,T){switch(A){case n.oids.pkcs5PBES2:return n.pbe.getCipherForPBES2(A,S,T);case n.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case n.oids["pbewithSHAAnd40BitRC2-CBC"]:return n.pbe.getCipherForPKCS12PBE(A,S,T);default:var B=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw B.oid=A,B.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],B}},n.pbe.getCipherForPBES2=function(A,S,T){var B={},M=[];if(!a.validate(S,v,B,M)){var R=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw R.errors=M,R}if(A=a.derToOid(B.kdfOid),A!==n.oids.pkcs5PBKDF2){var R=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw R.oid=A,R.supportedOids=["pkcs5PBKDF2"],R}if(A=a.derToOid(B.encOid),A!==n.oids["aes128-CBC"]&&A!==n.oids["aes192-CBC"]&&A!==n.oids["aes256-CBC"]&&A!==n.oids["des-EDE3-CBC"]&&A!==n.oids.desCBC){var R=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw R.oid=A,R.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],R}var P=B.kdfSalt,D=r.util.createBuffer(B.kdfIterationCount);D=D.getInt(D.length()<<3);var q,k;switch(n.oids[A]){case"aes128-CBC":q=16,k=r.aes.createDecryptionCipher;break;case"aes192-CBC":q=24,k=r.aes.createDecryptionCipher;break;case"aes256-CBC":q=32,k=r.aes.createDecryptionCipher;break;case"des-EDE3-CBC":q=24,k=r.des.createDecryptionCipher;break;case"desCBC":q=8,k=r.des.createDecryptionCipher;break}var U=g(B.prfOid),O=r.pkcs5.pbkdf2(T,P,D,q,U),G=B.encIv,E=k(O);return E.start(G),E},n.pbe.getCipherForPKCS12PBE=function(A,S,T){var B={},M=[];if(!a.validate(S,o,B,M)){var R=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw R.errors=M,R}var P=r.util.createBuffer(B.salt),D=r.util.createBuffer(B.iterations);D=D.getInt(D.length()<<3);var q,k,U;switch(A){case n.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:q=24,k=8,U=r.des.startDecrypting;break;case n.oids["pbewithSHAAnd40BitRC2-CBC"]:q=5,k=8,U=function(l,d){var p=r.rc2.createDecryptionCipher(l,40);return p.start(d,null),p};break;default:var R=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw R.oid=A,R}var O=g(B.prfOid),G=n.pbe.generatePkcs12Key(T,P,1,D,q,O);O.start();var E=n.pbe.generatePkcs12Key(T,P,2,D,k,O);return U(G,E)},n.pbe.opensslDeriveBytes=function(A,S,T,B){if(typeof B>"u"||B===null){if(!("md5"in r.md))throw new Error('"md5" hash algorithm unavailable.');B=r.md.md5.create()}S===null&&(S="");for(var M=[h(B,A+S)],R=16,P=1;R<T;++P,R+=16)M.push(h(B,M[P-1]+A+S));return M.join("").substr(0,T)};function h(A,S){return A.start().update(S).digest().getBytes()}function g(A){var S;if(!A)S="hmacWithSHA1";else if(S=n.oids[a.derToOid(A)],!S){var T=new Error("Unsupported PRF OID.");throw T.oid=A,T.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],T}return y(S)}function y(A){var S=r.md;switch(A){case"hmacWithSHA224":S=r.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":A=A.substr(8).toLowerCase();break;default:var T=new Error("Unsupported PRF algorithm.");throw T.algorithm=A,T.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],T}if(!S||!(A in S))throw new Error("Unknown hash algorithm: "+A);return S[A].create()}function _(A,S,T,B){var M=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,A),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,S.getBytes())]);return B!=="hmacWithSHA1"&&M.value.push(a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,r.util.hexToBytes(T.toString(16))),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(n.oids[B]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")])),M}}}),B_=Ve({"../../node_modules/node-forge/lib/pkcs7asn1.js"(i,e){var r=sr();Mn(),wr();var t=r.asn1,a=e.exports=r.pkcs7asn1=r.pkcs7asn1||{};r.pkcs7=r.pkcs7||{},r.pkcs7.asn1=a;var n={name:"ContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};a.contentInfoValidator=n;var c={name:"EncryptedContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};a.envelopedDataValidator={name:"EnvelopedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(c)},a.encryptedDataValidator={name:"EncryptedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"}].concat(c)};var u={name:"SignerInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};a.signedDataValidator={name:"SignedData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},n,{name:"SignedData.Certificates",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,capture:"signerInfos",optional:!0,value:[u]}]},a.recipientInfoValidator={name:"RecipientInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:t.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}}),L_=Ve({"../../node_modules/node-forge/lib/mgf1.js"(i,e){var r=sr();wr(),r.mgf=r.mgf||{};var t=e.exports=r.mgf.mgf1=r.mgf1=r.mgf1||{};t.create=function(a){var n={generate:function(c,u){for(var v=new r.util.ByteBuffer,o=Math.ceil(u/a.digestLength),h=0;h<o;h++){var g=new r.util.ByteBuffer;g.putInt32(h),a.start(),a.update(c+g.getBytes()),v.putBuffer(a.digest())}return v.truncate(v.length()-u),v.getBytes()}};return n}}}),HI=Ve({"../../node_modules/node-forge/lib/mgf.js"(i,e){var r=sr();L_(),e.exports=r.mgf=r.mgf||{},r.mgf.mgf1=r.mgf1}}),$1=Ve({"../../node_modules/node-forge/lib/pss.js"(i,e){var r=sr();fn(),wr();var t=e.exports=r.pss=r.pss||{};t.create=function(a){arguments.length===3&&(a={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var n=a.md,c=a.mgf,u=n.digestLength,v=a.salt||null;typeof v=="string"&&(v=r.util.createBuffer(v));var o;if("saltLength"in a)o=a.saltLength;else if(v!==null)o=v.length();else throw new Error("Salt length not specified or specific salt not given.");if(v!==null&&v.length()!==o)throw new Error("Given salt length does not match length of given salt.");var h=a.prng||r.random,g={};return g.encode=function(y,_){var A,S=_-1,T=Math.ceil(S/8),B=y.digest().getBytes();if(T<u+o+2)throw new Error("Message is too long to encrypt.");var M;v===null?M=h.getBytesSync(o):M=v.bytes();var R=new r.util.ByteBuffer;R.fillWithByte(0,8),R.putBytes(B),R.putBytes(M),n.start(),n.update(R.getBytes());var P=n.digest().getBytes(),D=new r.util.ByteBuffer;D.fillWithByte(0,T-o-u-2),D.putByte(1),D.putBytes(M);var q=D.getBytes(),k=T-u-1,U=c.generate(P,k),O="";for(A=0;A<k;A++)O+=String.fromCharCode(q.charCodeAt(A)^U.charCodeAt(A));var G=65280>>8*T-S&255;return O=String.fromCharCode(O.charCodeAt(0)&~G)+O.substr(1),O+P+""},g.verify=function(y,_,A){var S,T=A-1,B=Math.ceil(T/8);if(_=_.substr(-B),B<u+o+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(_.charCodeAt(B-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var M=B-u-1,R=_.substr(0,M),P=_.substr(M,u),D=65280>>8*B-T&255;if(R.charCodeAt(0)&D)throw new Error("Bits beyond keysize not zero as expected.");var q=c.generate(P,M),k="";for(S=0;S<M;S++)k+=String.fromCharCode(R.charCodeAt(S)^q.charCodeAt(S));k=String.fromCharCode(k.charCodeAt(0)&~D)+k.substr(1);var U=B-u-o-2;for(S=0;S<U;S++)if(k.charCodeAt(S)!==0)throw new Error("Leftmost octets not zero as expected");if(k.charCodeAt(U)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var O=k.substr(-o),G=new r.util.ByteBuffer;G.fillWithByte(0,8),G.putBytes(y),G.putBytes(O),n.start(),n.update(G.getBytes());var E=n.digest().getBytes();return P===E},g}}}),Z1=Ve({"../../node_modules/node-forge/lib/x509.js"(i,e){var r=sr();Ja(),Mn(),ec(),jn(),HI(),ts(),zs(),$1(),ic(),wr();var t=r.asn1,a=e.exports=r.pki=r.pki||{},n=a.oids,c={};c.CN=n.commonName,c.commonName="CN",c.C=n.countryName,c.countryName="C",c.L=n.localityName,c.localityName="L",c.ST=n.stateOrProvinceName,c.stateOrProvinceName="ST",c.O=n.organizationName,c.organizationName="O",c.OU=n.organizationalUnitName,c.organizationalUnitName="OU",c.E=n.emailAddress,c.emailAddress="E";var u=r.pki.rsa.publicKeyValidator,v={name:"Certificate",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:t.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:t.Class.UNIVERSAL,type:t.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:t.Class.UNIVERSAL,type:t.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:t.Class.UNIVERSAL,type:t.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:t.Class.UNIVERSAL,type:t.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},u,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:t.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:t.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:t.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},o={name:"rsapss",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:t.Class.UNIVERSAL,type:t.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:t.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:t.Class.UNIVERSAL,type:t.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:t.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:t.Class.UNIVERSAL,type:t.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:t.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:t.Class.UNIVERSAL,type:t.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},h={name:"CertificationRequestInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},u,{name:"CertificationRequestInfo.attributes",tagClass:t.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0}]}]}]},g={name:"CertificationRequest",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[h,{name:"CertificationRequest.signatureAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:t.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:t.Class.UNIVERSAL,type:t.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};a.RDNAttributesAsArray=function(U,O){for(var G=[],E,s,l,d=0;d<U.value.length;++d){E=U.value[d];for(var p=0;p<E.value.length;++p)l={},s=E.value[p],l.type=t.derToOid(s.value[0].value),l.value=s.value[1].value,l.valueTagClass=s.value[1].type,l.type in n&&(l.name=n[l.type],l.name in c&&(l.shortName=c[l.name])),O&&(O.update(l.type),O.update(l.value)),G.push(l)}return G},a.CRIAttributesAsArray=function(U){for(var O=[],G=0;G<U.length;++G)for(var E=U[G],s=t.derToOid(E.value[0].value),l=E.value[1].value,d=0;d<l.length;++d){var p={};if(p.type=s,p.value=l[d].value,p.valueTagClass=l[d].type,p.type in n&&(p.name=n[p.type],p.name in c&&(p.shortName=c[p.name])),p.type===n.extensionRequest){p.extensions=[];for(var m=0;m<p.value.length;++m)p.extensions.push(a.certificateExtensionFromAsn1(p.value[m]))}O.push(p)}return O};function y(U,O){typeof O=="string"&&(O={shortName:O});for(var G=null,E,s=0;G===null&&s<U.attributes.length;++s)E=U.attributes[s],(O.type&&O.type===E.type||O.name&&O.name===E.name||O.shortName&&O.shortName===E.shortName)&&(G=E);return G}var _=function(U,O,G){var E={};if(U!==n["RSASSA-PSS"])return E;G&&(E={hash:{algorithmOid:n.sha1},mgf:{algorithmOid:n.mgf1,hash:{algorithmOid:n.sha1}},saltLength:20});var s={},l=[];if(!t.validate(O,o,s,l)){var d=new Error("Cannot read RSASSA-PSS parameter block.");throw d.errors=l,d}return s.hashOid!==void 0&&(E.hash=E.hash||{},E.hash.algorithmOid=t.derToOid(s.hashOid)),s.maskGenOid!==void 0&&(E.mgf=E.mgf||{},E.mgf.algorithmOid=t.derToOid(s.maskGenOid),E.mgf.hash=E.mgf.hash||{},E.mgf.hash.algorithmOid=t.derToOid(s.maskGenHashOid)),s.saltLength!==void 0&&(E.saltLength=s.saltLength.charCodeAt(0)),E},A=function(U){switch(n[U.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return r.md.sha1.create();case"md5WithRSAEncryption":return r.md.md5.create();case"sha256WithRSAEncryption":return r.md.sha256.create();case"sha384WithRSAEncryption":return r.md.sha384.create();case"sha512WithRSAEncryption":return r.md.sha512.create();case"RSASSA-PSS":return r.md.sha256.create();default:var O=new Error("Could not compute "+U.type+" digest. Unknown signature OID.");throw O.signatureOid=U.signatureOid,O}},S=function(U){var O=U.certificate,G;switch(O.signatureOid){case n.sha1WithRSAEncryption:case n.sha1WithRSASignature:break;case n["RSASSA-PSS"]:var E,s;if(E=n[O.signatureParameters.mgf.hash.algorithmOid],E===void 0||r.md[E]===void 0){var l=new Error("Unsupported MGF hash function.");throw l.oid=O.signatureParameters.mgf.hash.algorithmOid,l.name=E,l}if(s=n[O.signatureParameters.mgf.algorithmOid],s===void 0||r.mgf[s]===void 0){var l=new Error("Unsupported MGF function.");throw l.oid=O.signatureParameters.mgf.algorithmOid,l.name=s,l}if(s=r.mgf[s].create(r.md[E].create()),E=n[O.signatureParameters.hash.algorithmOid],E===void 0||r.md[E]===void 0){var l=new Error("Unsupported RSASSA-PSS hash function.");throw l.oid=O.signatureParameters.hash.algorithmOid,l.name=E,l}G=r.pss.create(r.md[E].create(),s,O.signatureParameters.saltLength);break}return O.publicKey.verify(U.md.digest().getBytes(),U.signature,G)};a.certificateFromPem=function(U,O,G){var E=r.pem.decode(U)[0];if(E.type!=="CERTIFICATE"&&E.type!=="X509 CERTIFICATE"&&E.type!=="TRUSTED CERTIFICATE"){var s=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw s.headerType=E.type,s}if(E.procType&&E.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var l=t.fromDer(E.body,G);return a.certificateFromAsn1(l,O)},a.certificateToPem=function(U,O){var G={type:"CERTIFICATE",body:t.toDer(a.certificateToAsn1(U)).getBytes()};return r.pem.encode(G,{maxline:O})},a.publicKeyFromPem=function(U){var O=r.pem.decode(U)[0];if(O.type!=="PUBLIC KEY"&&O.type!=="RSA PUBLIC KEY"){var G=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw G.headerType=O.type,G}if(O.procType&&O.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var E=t.fromDer(O.body);return a.publicKeyFromAsn1(E)},a.publicKeyToPem=function(U,O){var G={type:"PUBLIC KEY",body:t.toDer(a.publicKeyToAsn1(U)).getBytes()};return r.pem.encode(G,{maxline:O})},a.publicKeyToRSAPublicKeyPem=function(U,O){var G={type:"RSA PUBLIC KEY",body:t.toDer(a.publicKeyToRSAPublicKey(U)).getBytes()};return r.pem.encode(G,{maxline:O})},a.getPublicKeyFingerprint=function(U,O){O=O||{};var G=O.md||r.md.sha1.create(),E=O.type||"RSAPublicKey",s;switch(E){case"RSAPublicKey":s=t.toDer(a.publicKeyToRSAPublicKey(U)).getBytes();break;case"SubjectPublicKeyInfo":s=t.toDer(a.publicKeyToAsn1(U)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+O.type+'".')}G.start(),G.update(s);var l=G.digest();if(O.encoding==="hex"){var d=l.toHex();return O.delimiter?d.match(/.{2}/g).join(O.delimiter):d}else{if(O.encoding==="binary")return l.getBytes();if(O.encoding)throw new Error('Unknown encoding "'+O.encoding+'".')}return l},a.certificationRequestFromPem=function(U,O,G){var E=r.pem.decode(U)[0];if(E.type!=="CERTIFICATE REQUEST"){var s=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw s.headerType=E.type,s}if(E.procType&&E.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var l=t.fromDer(E.body,G);return a.certificationRequestFromAsn1(l,O)},a.certificationRequestToPem=function(U,O){var G={type:"CERTIFICATE REQUEST",body:t.toDer(a.certificationRequestToAsn1(U)).getBytes()};return r.pem.encode(G,{maxline:O})},a.createCertificate=function(){var U={};return U.version=2,U.serialNumber="00",U.signatureOid=null,U.signature=null,U.siginfo={},U.siginfo.algorithmOid=null,U.validity={},U.validity.notBefore=new Date,U.validity.notAfter=new Date,U.issuer={},U.issuer.getField=function(O){return y(U.issuer,O)},U.issuer.addField=function(O){B([O]),U.issuer.attributes.push(O)},U.issuer.attributes=[],U.issuer.hash=null,U.subject={},U.subject.getField=function(O){return y(U.subject,O)},U.subject.addField=function(O){B([O]),U.subject.attributes.push(O)},U.subject.attributes=[],U.subject.hash=null,U.extensions=[],U.publicKey=null,U.md=null,U.setSubject=function(O,G){B(O),U.subject.attributes=O,delete U.subject.uniqueId,G&&(U.subject.uniqueId=G),U.subject.hash=null},U.setIssuer=function(O,G){B(O),U.issuer.attributes=O,delete U.issuer.uniqueId,G&&(U.issuer.uniqueId=G),U.issuer.hash=null},U.setExtensions=function(O){for(var G=0;G<O.length;++G)M(O[G],{cert:U});U.extensions=O},U.getExtension=function(O){typeof O=="string"&&(O={name:O});for(var G=null,E,s=0;G===null&&s<U.extensions.length;++s)E=U.extensions[s],(O.id&&E.id===O.id||O.name&&E.name===O.name)&&(G=E);return G},U.sign=function(O,G){U.md=G||r.md.sha1.create();var E=n[U.md.algorithm+"WithRSAEncryption"];if(!E){var s=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw s.algorithm=U.md.algorithm,s}U.signatureOid=U.siginfo.algorithmOid=E,U.tbsCertificate=a.getTBSCertificate(U);var l=t.toDer(U.tbsCertificate);U.md.update(l.getBytes()),U.signature=O.sign(U.md)},U.verify=function(O){var G=!1;if(!U.issued(O)){var E=O.issuer,s=U.subject,l=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw l.expectedIssuer=s.attributes,l.actualIssuer=E.attributes,l}var d=O.md;if(d===null){d=A({signatureOid:O.signatureOid,type:"certificate"});var p=O.tbsCertificate||a.getTBSCertificate(O),m=t.toDer(p);d.update(m.getBytes())}return d!==null&&(G=S({certificate:U,md:d,signature:O.signature})),G},U.isIssuer=function(O){var G=!1,E=U.issuer,s=O.subject;if(E.hash&&s.hash)G=E.hash===s.hash;else if(E.attributes.length===s.attributes.length){G=!0;for(var l,d,p=0;G&&p<E.attributes.length;++p)l=E.attributes[p],d=s.attributes[p],(l.type!==d.type||l.value!==d.value)&&(G=!1)}return G},U.issued=function(O){return O.isIssuer(U)},U.generateSubjectKeyIdentifier=function(){return a.getPublicKeyFingerprint(U.publicKey,{type:"RSAPublicKey"})},U.verifySubjectKeyIdentifier=function(){for(var O=n.subjectKeyIdentifier,G=0;G<U.extensions.length;++G){var E=U.extensions[G];if(E.id===O){var s=U.generateSubjectKeyIdentifier().getBytes();return r.util.hexToBytes(E.subjectKeyIdentifier)===s}}return!1},U},a.certificateFromAsn1=function(U,O){var G={},E=[];if(!t.validate(U,v,G,E)){var s=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw s.errors=E,s}var l=t.derToOid(G.publicKeyOid);if(l!==a.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var d=a.createCertificate();d.version=G.certVersion?G.certVersion.charCodeAt(0):0;var p=r.util.createBuffer(G.certSerialNumber);d.serialNumber=p.toHex(),d.signatureOid=r.asn1.derToOid(G.certSignatureOid),d.signatureParameters=_(d.signatureOid,G.certSignatureParams,!0),d.siginfo.algorithmOid=r.asn1.derToOid(G.certinfoSignatureOid),d.siginfo.parameters=_(d.siginfo.algorithmOid,G.certinfoSignatureParams,!1),d.signature=G.certSignature;var m=[];if(G.certValidity1UTCTime!==void 0&&m.push(t.utcTimeToDate(G.certValidity1UTCTime)),G.certValidity2GeneralizedTime!==void 0&&m.push(t.generalizedTimeToDate(G.certValidity2GeneralizedTime)),G.certValidity3UTCTime!==void 0&&m.push(t.utcTimeToDate(G.certValidity3UTCTime)),G.certValidity4GeneralizedTime!==void 0&&m.push(t.generalizedTimeToDate(G.certValidity4GeneralizedTime)),m.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(m.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(d.validity.notBefore=m[0],d.validity.notAfter=m[1],d.tbsCertificate=G.tbsCertificate,O){d.md=A({signatureOid:d.signatureOid,type:"certificate"});var w=t.toDer(d.tbsCertificate);d.md.update(w.getBytes())}var x=r.md.sha1.create(),b=t.toDer(G.certIssuer);x.update(b.getBytes()),d.issuer.getField=function(F){return y(d.issuer,F)},d.issuer.addField=function(F){B([F]),d.issuer.attributes.push(F)},d.issuer.attributes=a.RDNAttributesAsArray(G.certIssuer),G.certIssuerUniqueId&&(d.issuer.uniqueId=G.certIssuerUniqueId),d.issuer.hash=x.digest().toHex();var f=r.md.sha1.create(),C=t.toDer(G.certSubject);return f.update(C.getBytes()),d.subject.getField=function(F){return y(d.subject,F)},d.subject.addField=function(F){B([F]),d.subject.attributes.push(F)},d.subject.attributes=a.RDNAttributesAsArray(G.certSubject),G.certSubjectUniqueId&&(d.subject.uniqueId=G.certSubjectUniqueId),d.subject.hash=f.digest().toHex(),G.certExtensions?d.extensions=a.certificateExtensionsFromAsn1(G.certExtensions):d.extensions=[],d.publicKey=a.publicKeyFromAsn1(G.subjectPublicKeyInfo),d},a.certificateExtensionsFromAsn1=function(U){for(var O=[],G=0;G<U.value.length;++G)for(var E=U.value[G],s=0;s<E.value.length;++s)O.push(a.certificateExtensionFromAsn1(E.value[s]));return O},a.certificateExtensionFromAsn1=function(U){var O={};if(O.id=t.derToOid(U.value[0].value),O.critical=!1,U.value[1].type===t.Type.BOOLEAN?(O.critical=U.value[1].value.charCodeAt(0)!==0,O.value=U.value[2].value):O.value=U.value[1].value,O.id in n){if(O.name=n[O.id],O.name==="keyUsage"){var G=t.fromDer(O.value),E=0,s=0;G.value.length>1&&(E=G.value.charCodeAt(1),s=G.value.length>2?G.value.charCodeAt(2):0),O.digitalSignature=(E&128)===128,O.nonRepudiation=(E&64)===64,O.keyEncipherment=(E&32)===32,O.dataEncipherment=(E&16)===16,O.keyAgreement=(E&8)===8,O.keyCertSign=(E&4)===4,O.cRLSign=(E&2)===2,O.encipherOnly=(E&1)===1,O.decipherOnly=(s&128)===128}else if(O.name==="basicConstraints"){var G=t.fromDer(O.value);G.value.length>0&&G.value[0].type===t.Type.BOOLEAN?O.cA=G.value[0].value.charCodeAt(0)!==0:O.cA=!1;var l=null;G.value.length>0&&G.value[0].type===t.Type.INTEGER?l=G.value[0].value:G.value.length>1&&(l=G.value[1].value),l!==null&&(O.pathLenConstraint=t.derToInteger(l))}else if(O.name==="extKeyUsage")for(var G=t.fromDer(O.value),d=0;d<G.value.length;++d){var p=t.derToOid(G.value[d].value);p in n?O[n[p]]=!0:O[p]=!0}else if(O.name==="nsCertType"){var G=t.fromDer(O.value),E=0;G.value.length>1&&(E=G.value.charCodeAt(1)),O.client=(E&128)===128,O.server=(E&64)===64,O.email=(E&32)===32,O.objsign=(E&16)===16,O.reserved=(E&8)===8,O.sslCA=(E&4)===4,O.emailCA=(E&2)===2,O.objCA=(E&1)===1}else if(O.name==="subjectAltName"||O.name==="issuerAltName"){O.altNames=[];for(var m,G=t.fromDer(O.value),w=0;w<G.value.length;++w){m=G.value[w];var x={type:m.type,value:m.value};switch(O.altNames.push(x),m.type){case 1:case 2:case 6:break;case 7:x.ip=r.util.bytesToIP(m.value);break;case 8:x.oid=t.derToOid(m.value);break}}}else if(O.name==="subjectKeyIdentifier"){var G=t.fromDer(O.value);O.subjectKeyIdentifier=r.util.bytesToHex(G.value)}}return O},a.certificationRequestFromAsn1=function(U,O){var G={},E=[];if(!t.validate(U,g,G,E)){var s=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw s.errors=E,s}var l=t.derToOid(G.publicKeyOid);if(l!==a.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var d=a.createCertificationRequest();if(d.version=G.csrVersion?G.csrVersion.charCodeAt(0):0,d.signatureOid=r.asn1.derToOid(G.csrSignatureOid),d.signatureParameters=_(d.signatureOid,G.csrSignatureParams,!0),d.siginfo.algorithmOid=r.asn1.derToOid(G.csrSignatureOid),d.siginfo.parameters=_(d.siginfo.algorithmOid,G.csrSignatureParams,!1),d.signature=G.csrSignature,d.certificationRequestInfo=G.certificationRequestInfo,O){d.md=A({signatureOid:d.signatureOid,type:"certification request"});var p=t.toDer(d.certificationRequestInfo);d.md.update(p.getBytes())}var m=r.md.sha1.create();return d.subject.getField=function(w){return y(d.subject,w)},d.subject.addField=function(w){B([w]),d.subject.attributes.push(w)},d.subject.attributes=a.RDNAttributesAsArray(G.certificationRequestInfoSubject,m),d.subject.hash=m.digest().toHex(),d.publicKey=a.publicKeyFromAsn1(G.subjectPublicKeyInfo),d.getAttribute=function(w){return y(d,w)},d.addAttribute=function(w){B([w]),d.attributes.push(w)},d.attributes=a.CRIAttributesAsArray(G.certificationRequestInfoAttributes||[]),d},a.createCertificationRequest=function(){var U={};return U.version=0,U.signatureOid=null,U.signature=null,U.siginfo={},U.siginfo.algorithmOid=null,U.subject={},U.subject.getField=function(O){return y(U.subject,O)},U.subject.addField=function(O){B([O]),U.subject.attributes.push(O)},U.subject.attributes=[],U.subject.hash=null,U.publicKey=null,U.attributes=[],U.getAttribute=function(O){return y(U,O)},U.addAttribute=function(O){B([O]),U.attributes.push(O)},U.md=null,U.setSubject=function(O){B(O),U.subject.attributes=O,U.subject.hash=null},U.setAttributes=function(O){B(O),U.attributes=O},U.sign=function(O,G){U.md=G||r.md.sha1.create();var E=n[U.md.algorithm+"WithRSAEncryption"];if(!E){var s=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw s.algorithm=U.md.algorithm,s}U.signatureOid=U.siginfo.algorithmOid=E,U.certificationRequestInfo=a.getCertificationRequestInfo(U);var l=t.toDer(U.certificationRequestInfo);U.md.update(l.getBytes()),U.signature=O.sign(U.md)},U.verify=function(){var O=!1,G=U.md;if(G===null){G=A({signatureOid:U.signatureOid,type:"certification request"});var E=U.certificationRequestInfo||a.getCertificationRequestInfo(U),s=t.toDer(E);G.update(s.getBytes())}return G!==null&&(O=S({certificate:U,md:G,signature:U.signature})),O},U};function T(U){for(var O=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),G,E,s=U.attributes,l=0;l<s.length;++l){G=s[l];var d=G.value,p=t.Type.PRINTABLESTRING;"valueTagClass"in G&&(p=G.valueTagClass,p===t.Type.UTF8&&(d=r.util.encodeUtf8(d))),E=t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(G.type).getBytes()),t.create(t.Class.UNIVERSAL,p,!1,d)])]),O.value.push(E)}return O}function B(U){for(var O,G=0;G<U.length;++G){if(O=U[G],typeof O.name>"u"&&(O.type&&O.type in a.oids?O.name=a.oids[O.type]:O.shortName&&O.shortName in c&&(O.name=a.oids[c[O.shortName]])),typeof O.type>"u")if(O.name&&O.name in a.oids)O.type=a.oids[O.name];else{var E=new Error("Attribute type not specified.");throw E.attribute=O,E}if(typeof O.shortName>"u"&&O.name&&O.name in c&&(O.shortName=c[O.name]),O.type===n.extensionRequest&&(O.valueConstructed=!0,O.valueTagClass=t.Type.SEQUENCE,!O.value&&O.extensions)){O.value=[];for(var s=0;s<O.extensions.length;++s)O.value.push(a.certificateExtensionToAsn1(M(O.extensions[s])))}if(typeof O.value>"u"){var E=new Error("Attribute value not specified.");throw E.attribute=O,E}}}function M(U,O){if(O=O||{},typeof U.name>"u"&&U.id&&U.id in a.oids&&(U.name=a.oids[U.id]),typeof U.id>"u")if(U.name&&U.name in a.oids)U.id=a.oids[U.name];else{var G=new Error("Extension ID not specified.");throw G.extension=U,G}if(typeof U.value<"u")return U;if(U.name==="keyUsage"){var E=0,s=0,l=0;U.digitalSignature&&(s|=128,E=7),U.nonRepudiation&&(s|=64,E=6),U.keyEncipherment&&(s|=32,E=5),U.dataEncipherment&&(s|=16,E=4),U.keyAgreement&&(s|=8,E=3),U.keyCertSign&&(s|=4,E=2),U.cRLSign&&(s|=2,E=1),U.encipherOnly&&(s|=1,E=0),U.decipherOnly&&(l|=128,E=7);var d=String.fromCharCode(E);l!==0?d+=String.fromCharCode(s)+String.fromCharCode(l):s!==0&&(d+=String.fromCharCode(s)),U.value=t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,d)}else if(U.name==="basicConstraints")U.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),U.cA&&U.value.value.push(t.create(t.Class.UNIVERSAL,t.Type.BOOLEAN,!1,"")),"pathLenConstraint"in U&&U.value.value.push(t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(U.pathLenConstraint).getBytes()));else if(U.name==="extKeyUsage"){U.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);var p=U.value.value;for(var m in U)U[m]===!0&&(m in n?p.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(n[m]).getBytes())):m.indexOf(".")!==-1&&p.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(m).getBytes())))}else if(U.name==="nsCertType"){var E=0,s=0;U.client&&(s|=128,E=7),U.server&&(s|=64,E=6),U.email&&(s|=32,E=5),U.objsign&&(s|=16,E=4),U.reserved&&(s|=8,E=3),U.sslCA&&(s|=4,E=2),U.emailCA&&(s|=2,E=1),U.objCA&&(s|=1,E=0);var d=String.fromCharCode(E);s!==0&&(d+=String.fromCharCode(s)),U.value=t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,d)}else if(U.name==="subjectAltName"||U.name==="issuerAltName"){U.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);for(var w,x=0;x<U.altNames.length;++x){w=U.altNames[x];var d=w.value;if(w.type===7&&w.ip){if(d=r.util.bytesFromIP(w.ip),d===null){var G=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw G.extension=U,G}}else w.type===8&&(w.oid?d=t.oidToDer(t.oidToDer(w.oid)):d=t.oidToDer(d));U.value.value.push(t.create(t.Class.CONTEXT_SPECIFIC,w.type,!1,d))}}else if(U.name==="nsComment"&&O.cert){if(!/^[\x00-\x7F]*$/.test(U.comment)||U.comment.length<1||U.comment.length>128)throw new Error('Invalid "nsComment" content.');U.value=t.create(t.Class.UNIVERSAL,t.Type.IA5STRING,!1,U.comment)}else if(U.name==="subjectKeyIdentifier"&&O.cert){var b=O.cert.generateSubjectKeyIdentifier();U.subjectKeyIdentifier=b.toHex(),U.value=t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,b.getBytes())}else if(U.name==="authorityKeyIdentifier"&&O.cert){U.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);var p=U.value.value;if(U.keyIdentifier){var f=U.keyIdentifier===!0?O.cert.generateSubjectKeyIdentifier().getBytes():U.keyIdentifier;p.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!1,f))}if(U.authorityCertIssuer){var C=[t.create(t.Class.CONTEXT_SPECIFIC,4,!0,[T(U.authorityCertIssuer===!0?O.cert.issuer:U.authorityCertIssuer)])];p.push(t.create(t.Class.CONTEXT_SPECIFIC,1,!0,C))}if(U.serialNumber){var F=r.util.hexToBytes(U.serialNumber===!0?O.cert.serialNumber:U.serialNumber);p.push(t.create(t.Class.CONTEXT_SPECIFIC,2,!1,F))}}else if(U.name==="cRLDistributionPoints"){U.value=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);for(var p=U.value.value,z=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]),W=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[]),w,x=0;x<U.altNames.length;++x){w=U.altNames[x];var d=w.value;if(w.type===7&&w.ip){if(d=r.util.bytesFromIP(w.ip),d===null){var G=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw G.extension=U,G}}else w.type===8&&(w.oid?d=t.oidToDer(t.oidToDer(w.oid)):d=t.oidToDer(d));W.value.push(t.create(t.Class.CONTEXT_SPECIFIC,w.type,!1,d))}z.value.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[W])),p.push(z)}if(typeof U.value>"u"){var G=new Error("Extension value not specified.");throw G.extension=U,G}return U}function R(U,O){switch(U){case n["RSASSA-PSS"]:var G=[];return O.hash.algorithmOid!==void 0&&G.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(O.hash.algorithmOid).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")])])),O.mgf.algorithmOid!==void 0&&G.push(t.create(t.Class.CONTEXT_SPECIFIC,1,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(O.mgf.algorithmOid).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(O.mgf.hash.algorithmOid).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")])])])),O.saltLength!==void 0&&G.push(t.create(t.Class.CONTEXT_SPECIFIC,2,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(O.saltLength).getBytes())])),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,G);default:return t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")}}function P(U){var O=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[]);if(U.attributes.length===0)return O;for(var G=U.attributes,E=0;E<G.length;++E){var s=G[E],l=s.value,d=t.Type.UTF8;"valueTagClass"in s&&(d=s.valueTagClass),d===t.Type.UTF8&&(l=r.util.encodeUtf8(l));var p=!1;"valueConstructed"in s&&(p=s.valueConstructed);var m=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(s.type).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,d,p,l)])]);O.value.push(m)}return O}var D=new Date("1950-01-01T00:00:00Z"),q=new Date("2050-01-01T00:00:00Z");function k(U){return U>=D&&U<q?t.create(t.Class.UNIVERSAL,t.Type.UTCTIME,!1,t.dateToUtcTime(U)):t.create(t.Class.UNIVERSAL,t.Type.GENERALIZEDTIME,!1,t.dateToGeneralizedTime(U))}a.getTBSCertificate=function(U){var O=k(U.validity.notBefore),G=k(U.validity.notAfter),E=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(U.version).getBytes())]),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,r.util.hexToBytes(U.serialNumber)),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(U.siginfo.algorithmOid).getBytes()),R(U.siginfo.algorithmOid,U.siginfo.parameters)]),T(U.issuer),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[O,G]),T(U.subject),a.publicKeyToAsn1(U.publicKey)]);return U.issuer.uniqueId&&E.value.push(t.create(t.Class.CONTEXT_SPECIFIC,1,!0,[t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,"\0"+U.issuer.uniqueId)])),U.subject.uniqueId&&E.value.push(t.create(t.Class.CONTEXT_SPECIFIC,2,!0,[t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,"\0"+U.subject.uniqueId)])),U.extensions.length>0&&E.value.push(a.certificateExtensionsToAsn1(U.extensions)),E},a.getCertificationRequestInfo=function(U){var O=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(U.version).getBytes()),T(U.subject),a.publicKeyToAsn1(U.publicKey),P(U)]);return O},a.distinguishedNameToAsn1=function(U){return T(U)},a.certificateToAsn1=function(U){var O=U.tbsCertificate||a.getTBSCertificate(U);return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[O,t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(U.signatureOid).getBytes()),R(U.signatureOid,U.signatureParameters)]),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,"\0"+U.signature)])},a.certificateExtensionsToAsn1=function(U){var O=t.create(t.Class.CONTEXT_SPECIFIC,3,!0,[]),G=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);O.value.push(G);for(var E=0;E<U.length;++E)G.value.push(a.certificateExtensionToAsn1(U[E]));return O},a.certificateExtensionToAsn1=function(U){var O=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[]);O.value.push(t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(U.id).getBytes())),U.critical&&O.value.push(t.create(t.Class.UNIVERSAL,t.Type.BOOLEAN,!1,""));var G=U.value;return typeof U.value!="string"&&(G=t.toDer(G).getBytes()),O.value.push(t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,G)),O},a.certificationRequestToAsn1=function(U){var O=U.certificationRequestInfo||a.getCertificationRequestInfo(U);return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[O,t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(U.signatureOid).getBytes()),R(U.signatureOid,U.signatureParameters)]),t.create(t.Class.UNIVERSAL,t.Type.BITSTRING,!1,"\0"+U.signature)])},a.createCaStore=function(U){var O={certs:{}};O.getIssuer=function(d){var p=G(d.issuer);return p},O.addCertificate=function(d){if(typeof d=="string"&&(d=r.pki.certificateFromPem(d)),E(d.subject),!O.hasCertificate(d))if(d.subject.hash in O.certs){var p=O.certs[d.subject.hash];r.util.isArray(p)||(p=[p]),p.push(d),O.certs[d.subject.hash]=p}else O.certs[d.subject.hash]=d},O.hasCertificate=function(d){typeof d=="string"&&(d=r.pki.certificateFromPem(d));var p=G(d.subject);if(!p)return!1;r.util.isArray(p)||(p=[p]);for(var m=t.toDer(a.certificateToAsn1(d)).getBytes(),w=0;w<p.length;++w){var x=t.toDer(a.certificateToAsn1(p[w])).getBytes();if(m===x)return!0}return!1},O.listAllCertificates=function(){var d=[];for(var p in O.certs)if(O.certs.hasOwnProperty(p)){var m=O.certs[p];if(!r.util.isArray(m))d.push(m);else for(var w=0;w<m.length;++w)d.push(m[w])}return d},O.removeCertificate=function(d){var p;if(typeof d=="string"&&(d=r.pki.certificateFromPem(d)),E(d.subject),!O.hasCertificate(d))return null;var m=G(d.subject);if(!r.util.isArray(m))return p=O.certs[d.subject.hash],delete O.certs[d.subject.hash],p;for(var w=t.toDer(a.certificateToAsn1(d)).getBytes(),x=0;x<m.length;++x){var b=t.toDer(a.certificateToAsn1(m[x])).getBytes();w===b&&(p=m[x],m.splice(x,1))}return m.length===0&&delete O.certs[d.subject.hash],p};function G(d){return E(d),O.certs[d.hash]||null}function E(d){if(!d.hash){var p=r.md.sha1.create();d.attributes=a.RDNAttributesAsArray(T(d),p),d.hash=p.digest().toHex()}}if(U)for(var s=0;s<U.length;++s){var l=U[s];O.addCertificate(l)}return O},a.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},a.verifyCertificateChain=function(U,O,G){typeof G=="function"&&(G={verify:G}),G=G||{},O=O.slice(0);var E=O.slice(0),s=G.validityCheckDate;typeof s>"u"&&(s=new Date);var l=!0,d=null,p=0;do{var m=O.shift(),w=null,x=!1;if(s&&(s<m.validity.notBefore||s>m.validity.notAfter)&&(d={message:"Certificate is not valid yet or has expired.",error:a.certificateError.certificate_expired,notBefore:m.validity.notBefore,notAfter:m.validity.notAfter,now:s}),d===null){if(w=O[0]||U.getIssuer(m),w===null&&m.isIssuer(m)&&(x=!0,w=m),w){var b=w;r.util.isArray(b)||(b=[b]);for(var f=!1;!f&&b.length>0;){w=b.shift();try{f=w.verify(m)}catch{}}f||(d={message:"Certificate signature is invalid.",error:a.certificateError.bad_certificate})}d===null&&(!w||x)&&!U.hasCertificate(m)&&(d={message:"Certificate is not trusted.",error:a.certificateError.unknown_ca})}if(d===null&&w&&!m.isIssuer(w)&&(d={message:"Certificate issuer is invalid.",error:a.certificateError.bad_certificate}),d===null)for(var C={keyUsage:!0,basicConstraints:!0},F=0;d===null&&F<m.extensions.length;++F){var z=m.extensions[F];z.critical&&!(z.name in C)&&(d={message:"Certificate has an unsupported critical extension.",error:a.certificateError.unsupported_certificate})}if(d===null&&(!l||O.length===0&&(!w||x))){var W=m.getExtension("basicConstraints"),$=m.getExtension("keyUsage");if($!==null&&(!$.keyCertSign||W===null)&&(d={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:a.certificateError.bad_certificate}),d===null&&W!==null&&!W.cA&&(d={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:a.certificateError.bad_certificate}),d===null&&$!==null&&"pathLenConstraint"in W){var I=p-1;I>W.pathLenConstraint&&(d={message:"Certificate basicConstraints pathLenConstraint violated.",error:a.certificateError.bad_certificate})}}var K=d===null?!0:d.error,N=G.verify?G.verify(K,p,E):K;if(N===!0)d=null;else throw K===!0&&(d={message:"The application rejected the certificate.",error:a.certificateError.bad_certificate}),(N||N===0)&&(typeof N=="object"&&!r.util.isArray(N)?(N.message&&(d.message=N.message),N.error&&(d.error=N.error)):typeof N=="string"&&(d.error=N)),d;l=!1,++p}while(O.length>0);return!0}}}),T_=Ve({"../../node_modules/node-forge/lib/pkcs12.js"(i,e){var r=sr();Mn(),af(),ts(),B_(),M_(),fn(),ic(),sf(),wr(),Z1();var t=r.asn1,a=r.pki,n=e.exports=r.pkcs12=r.pkcs12||{},c={name:"ContentInfo",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:t.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},u={name:"PFX",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,capture:"version"},c,{name:"PFX.macData",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:t.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:t.Class.UNIVERSAL,type:t.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:t.Class.UNIVERSAL,type:t.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},v={name:"SafeBag",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:t.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},o={name:"Attribute",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:t.Class.UNIVERSAL,type:t.Type.SET,constructed:!0,capture:"values"}]},h={name:"CertBag",tagClass:t.Class.UNIVERSAL,type:t.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:t.Class.UNIVERSAL,type:t.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:t.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:t.Class.UNIVERSAL,type:t.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function g(B,M,R,P){for(var D=[],q=0;q<B.length;q++)for(var k=0;k<B[q].safeBags.length;k++){var U=B[q].safeBags[k];if(!(P!==void 0&&U.type!==P)){if(M===null){D.push(U);continue}U.attributes[M]!==void 0&&U.attributes[M].indexOf(R)>=0&&D.push(U)}}return D}n.pkcs12FromAsn1=function(B,M,R){typeof M=="string"?(R=M,M=!0):M===void 0&&(M=!0);var P={},D=[];if(!t.validate(B,u,P,D)){var q=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw q.errors=q,q}var k={version:P.version.charCodeAt(0),safeContents:[],getBags:function(w){var x={},b;return"localKeyId"in w?b=w.localKeyId:"localKeyIdHex"in w&&(b=r.util.hexToBytes(w.localKeyIdHex)),b===void 0&&!("friendlyName"in w)&&"bagType"in w&&(x[w.bagType]=g(k.safeContents,null,null,w.bagType)),b!==void 0&&(x.localKeyId=g(k.safeContents,"localKeyId",b,w.bagType)),"friendlyName"in w&&(x.friendlyName=g(k.safeContents,"friendlyName",w.friendlyName,w.bagType)),x},getBagsByFriendlyName:function(w,x){return g(k.safeContents,"friendlyName",w,x)},getBagsByLocalKeyId:function(w,x){return g(k.safeContents,"localKeyId",w,x)}};if(P.version.charCodeAt(0)!==3){var q=new Error("PKCS#12 PFX of version other than 3 not supported.");throw q.version=P.version.charCodeAt(0),q}if(t.derToOid(P.contentType)!==a.oids.data){var q=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw q.oid=t.derToOid(P.contentType),q}var U=P.content.value[0];if(U.tagClass!==t.Class.UNIVERSAL||U.type!==t.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(U=y(U),P.mac){var O=null,G=0,E=t.derToOid(P.macAlgorithm);switch(E){case a.oids.sha1:O=r.md.sha1.create(),G=20;break;case a.oids.sha256:O=r.md.sha256.create(),G=32;break;case a.oids.sha384:O=r.md.sha384.create(),G=48;break;case a.oids.sha512:O=r.md.sha512.create(),G=64;break;case a.oids.md5:O=r.md.md5.create(),G=16;break}if(O===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+E);var s=new r.util.ByteBuffer(P.macSalt),l="macIterations"in P?parseInt(r.util.bytesToHex(P.macIterations),16):1,d=n.generateKey(R,s,3,l,G,O),p=r.hmac.create();p.start(O,d),p.update(U.value);var m=p.getMac();if(m.getBytes()!==P.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return _(k,U.value,M,R),k};function y(B){if(B.composed||B.constructed){for(var M=r.util.createBuffer(),R=0;R<B.value.length;++R)M.putBytes(B.value[R].value);B.composed=B.constructed=!1,B.value=M.getBytes()}return B}function _(B,M,R,P){if(M=t.fromDer(M,R),M.tagClass!==t.Class.UNIVERSAL||M.type!==t.Type.SEQUENCE||M.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var D=0;D<M.value.length;D++){var q=M.value[D],k={},U=[];if(!t.validate(q,c,k,U)){var O=new Error("Cannot read ContentInfo.");throw O.errors=U,O}var G={encrypted:!1},E=null,s=k.content.value[0];switch(t.derToOid(k.contentType)){case a.oids.data:if(s.tagClass!==t.Class.UNIVERSAL||s.type!==t.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");E=y(s).value;break;case a.oids.encryptedData:E=A(s,P),G.encrypted=!0;break;default:var O=new Error("Unsupported PKCS#12 contentType.");throw O.contentType=t.derToOid(k.contentType),O}G.safeBags=S(E,R,P),B.safeContents.push(G)}}function A(B,M){var R={},P=[];if(!t.validate(B,r.pkcs7.asn1.encryptedDataValidator,R,P)){var D=new Error("Cannot read EncryptedContentInfo.");throw D.errors=P,D}var q=t.derToOid(R.contentType);if(q!==a.oids.data){var D=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw D.oid=q,D}q=t.derToOid(R.encAlgorithm);var k=a.pbe.getCipher(q,R.encParameter,M),U=y(R.encryptedContentAsn1),O=r.util.createBuffer(U.value);if(k.update(O),!k.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return k.output.getBytes()}function S(B,M,R){if(!M&&B.length===0)return[];if(B=t.fromDer(B,M),B.tagClass!==t.Class.UNIVERSAL||B.type!==t.Type.SEQUENCE||B.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var P=[],D=0;D<B.value.length;D++){var q=B.value[D],k={},U=[];if(!t.validate(q,v,k,U)){var O=new Error("Cannot read SafeBag.");throw O.errors=U,O}var G={type:t.derToOid(k.bagId),attributes:T(k.bagAttributes)};P.push(G);var E,s,l=k.bagValue.value[0];switch(G.type){case a.oids.pkcs8ShroudedKeyBag:if(l=a.decryptPrivateKeyInfo(l,R),l===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case a.oids.keyBag:try{G.key=a.privateKeyFromAsn1(l)}catch{G.key=null,G.asn1=l}continue;case a.oids.certBag:E=h,s=function(){if(t.derToOid(k.certId)!==a.oids.x509Certificate){var p=new Error("Unsupported certificate type, only X.509 supported.");throw p.oid=t.derToOid(k.certId),p}var m=t.fromDer(k.cert,M);try{G.cert=a.certificateFromAsn1(m,!0)}catch{G.cert=null,G.asn1=m}};break;default:var O=new Error("Unsupported PKCS#12 SafeBag type.");throw O.oid=G.type,O}if(E!==void 0&&!t.validate(l,E,k,U)){var O=new Error("Cannot read PKCS#12 "+E.name);throw O.errors=U,O}s()}return P}function T(B){var M={};if(B!==void 0)for(var R=0;R<B.length;++R){var P={},D=[];if(!t.validate(B[R],o,P,D)){var q=new Error("Cannot read PKCS#12 BagAttribute.");throw q.errors=D,q}var k=t.derToOid(P.oid);if(a.oids[k]!==void 0){M[a.oids[k]]=[];for(var U=0;U<P.values.length;++U)M[a.oids[k]].push(P.values[U].value)}}return M}n.toPkcs12Asn1=function(B,M,R,P){P=P||{},P.saltSize=P.saltSize||8,P.count=P.count||2048,P.algorithm=P.algorithm||P.encAlgorithm||"aes128","useMac"in P||(P.useMac=!0),"localKeyId"in P||(P.localKeyId=null),"generateLocalKeyId"in P||(P.generateLocalKeyId=!0);var D=P.localKeyId,q;if(D!==null)D=r.util.hexToBytes(D);else if(P.generateLocalKeyId)if(M){var k=r.util.isArray(M)?M[0]:M;typeof k=="string"&&(k=a.certificateFromPem(k));var U=r.md.sha1.create();U.update(t.toDer(a.certificateToAsn1(k)).getBytes()),D=U.digest().getBytes()}else D=r.random.getBytes(20);var O=[];D!==null&&O.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a.oids.localKeyId).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,D)])])),"friendlyName"in P&&O.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a.oids.friendlyName).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[t.create(t.Class.UNIVERSAL,t.Type.BMPSTRING,!1,P.friendlyName)])])),O.length>0&&(q=t.create(t.Class.UNIVERSAL,t.Type.SET,!0,O));var G=[],E=[];M!==null&&(r.util.isArray(M)?E=M:E=[M]);for(var s=[],l=0;l<E.length;++l){M=E[l],typeof M=="string"&&(M=a.certificateFromPem(M));var d=l===0?q:void 0,p=a.certificateToAsn1(M),m=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a.oids.certBag).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a.oids.x509Certificate).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(p).getBytes())])])]),d]);s.push(m)}if(s.length>0){var w=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,s),x=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a.oids.data).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(w).getBytes())])]);G.push(x)}var b=null;if(B!==null){var f=a.wrapRsaPrivateKey(a.privateKeyToAsn1(B));R===null?b=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a.oids.keyBag).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[f]),q]):b=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a.oids.pkcs8ShroudedKeyBag).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[a.encryptPrivateKeyInfo(f,R,P)]),q]);var C=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[b]),F=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a.oids.data).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(C).getBytes())])]);G.push(F)}var z=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,G),W;if(P.useMac){var U=r.md.sha1.create(),$=new r.util.ByteBuffer(r.random.getBytes(P.saltSize)),I=P.count,B=n.generateKey(R,$,3,I,20),K=r.hmac.create();K.start(U,B),K.update(t.toDer(z).getBytes());var N=K.getMac();W=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a.oids.sha1).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")]),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,N.getBytes())]),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,$.getBytes()),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(I).getBytes())])}return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(3).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(a.oids.data).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,t.toDer(z).getBytes())])]),W])},n.generateKey=r.pbe.generatePkcs12Key}}),R_=Ve({"../../node_modules/node-forge/lib/pki.js"(i,e){var r=sr();Mn(),ts(),M_(),zs(),Q1(),T_(),$1(),ic(),wr(),Z1();var t=r.asn1,a=e.exports=r.pki=r.pki||{};a.pemToDer=function(n){var c=r.pem.decode(n)[0];if(c.procType&&c.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return r.util.createBuffer(c.body)},a.privateKeyFromPem=function(n){var c=r.pem.decode(n)[0];if(c.type!=="PRIVATE KEY"&&c.type!=="RSA PRIVATE KEY"){var u=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw u.headerType=c.type,u}if(c.procType&&c.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var v=t.fromDer(c.body);return a.privateKeyFromAsn1(v)},a.privateKeyToPem=function(n,c){var u={type:"RSA PRIVATE KEY",body:t.toDer(a.privateKeyToAsn1(n)).getBytes()};return r.pem.encode(u,{maxline:c})},a.privateKeyInfoToPem=function(n,c){var u={type:"PRIVATE KEY",body:t.toDer(n).getBytes()};return r.pem.encode(u,{maxline:c})}}}),N_=Ve({"../../node_modules/node-forge/lib/tls.js"(i,e){var r=sr();Mn(),af(),H1(),zs(),R_(),fn(),sf(),wr();var t=function(L,V,Z,H){var j=r.util.createBuffer(),et=L.length>>1,nt=et+(L.length&1),st=L.substr(0,nt),ft=L.substr(et,nt),vt=r.util.createBuffer(),ot=r.hmac.create();Z=V+Z;var pt=Math.ceil(H/16),Ut=Math.ceil(H/20);ot.start("MD5",st);var At=r.util.createBuffer();vt.putBytes(Z);for(var It=0;It<pt;++It)ot.start(null,null),ot.update(vt.getBytes()),vt.putBuffer(ot.digest()),ot.start(null,null),ot.update(vt.bytes()+Z),At.putBuffer(ot.digest());ot.start("SHA1",ft);var Jt=r.util.createBuffer();vt.clear(),vt.putBytes(Z);for(var It=0;It<Ut;++It)ot.start(null,null),ot.update(vt.getBytes()),vt.putBuffer(ot.digest()),ot.start(null,null),ot.update(vt.bytes()+Z),Jt.putBuffer(ot.digest());return j.putBytes(r.util.xorBytes(At.getBytes(),Jt.getBytes(),H)),j},a=function(L,V,Z){var H=r.hmac.create();H.start("SHA1",L);var j=r.util.createBuffer();return j.putInt32(V[0]),j.putInt32(V[1]),j.putByte(Z.type),j.putByte(Z.version.major),j.putByte(Z.version.minor),j.putInt16(Z.length),j.putBytes(Z.fragment.bytes()),H.update(j.getBytes()),H.digest().getBytes()},n=function(L,V,Z){var H=!1;try{var j=L.deflate(V.fragment.getBytes());V.fragment=r.util.createBuffer(j),V.length=j.length,H=!0}catch{}return H},c=function(L,V,Z){var H=!1;try{var j=L.inflate(V.fragment.getBytes());V.fragment=r.util.createBuffer(j),V.length=j.length,H=!0}catch{}return H},u=function(L,V){var Z=0;switch(V){case 1:Z=L.getByte();break;case 2:Z=L.getInt16();break;case 3:Z=L.getInt24();break;case 4:Z=L.getInt32();break}return r.util.createBuffer(L.getBytes(Z))},v=function(L,V,Z){L.putInt(Z.length(),V<<3),L.putBuffer(Z)},o={};o.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},o.SupportedVersions=[o.Versions.TLS_1_1,o.Versions.TLS_1_0],o.Version=o.SupportedVersions[0],o.MaxFragment=15360,o.ConnectionEnd={server:0,client:1},o.PRFAlgorithm={tls_prf_sha256:0},o.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},o.CipherType={stream:0,block:1,aead:2},o.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},o.CompressionMethod={none:0,deflate:1},o.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},o.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},o.Alert={},o.Alert.Level={warning:1,fatal:2},o.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},o.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},o.CipherSuites={},o.getCipherSuite=function(L){var V=null;for(var Z in o.CipherSuites){var H=o.CipherSuites[Z];if(H.id[0]===L.charCodeAt(0)&&H.id[1]===L.charCodeAt(1)){V=H;break}}return V},o.handleUnexpected=function(L,V){var Z=!L.open&&L.entity===o.ConnectionEnd.client;Z||L.error(L,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unexpected_message}})},o.handleHelloRequest=function(L,V,Z){!L.handshaking&&L.handshakes>0&&(o.queue(L,o.createAlert(L,{level:o.Alert.Level.warning,description:o.Alert.Description.no_renegotiation})),o.flush(L)),L.process()},o.parseHelloMessage=function(L,V,Z){var H=null,j=L.entity===o.ConnectionEnd.client;if(Z<38)L.error(L,{message:j?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});else{var et=V.fragment,nt=et.length();if(H={version:{major:et.getByte(),minor:et.getByte()},random:r.util.createBuffer(et.getBytes(32)),session_id:u(et,1),extensions:[]},j?(H.cipher_suite=et.getBytes(2),H.compression_method=et.getByte()):(H.cipher_suites=u(et,2),H.compression_methods=u(et,1)),nt=Z-(nt-et.length()),nt>0){for(var st=u(et,2);st.length()>0;)H.extensions.push({type:[st.getByte(),st.getByte()],data:u(st,2)});if(!j)for(var ft=0;ft<H.extensions.length;++ft){var vt=H.extensions[ft];if(vt.type[0]===0&&vt.type[1]===0)for(var ot=u(vt.data,2);ot.length()>0;){var pt=ot.getByte();if(pt!==0)break;L.session.extensions.server_name.serverNameList.push(u(ot,2).getBytes())}}}if(L.session.version&&(H.version.major!==L.session.version.major||H.version.minor!==L.session.version.minor))return L.error(L,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}});if(j)L.session.cipherSuite=o.getCipherSuite(H.cipher_suite);else for(var Ut=r.util.createBuffer(H.cipher_suites.bytes());Ut.length()>0&&(L.session.cipherSuite=o.getCipherSuite(Ut.getBytes(2)),L.session.cipherSuite===null););if(L.session.cipherSuite===null)return L.error(L,{message:"No cipher suites in common.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.handshake_failure},cipherSuite:r.util.bytesToHex(H.cipher_suite)});j?L.session.compressionMethod=H.compression_method:L.session.compressionMethod=o.CompressionMethod.none}return H},o.createSecurityParameters=function(L,V){var Z=L.entity===o.ConnectionEnd.client,H=V.random.bytes(),j=Z?L.session.sp.client_random:H,et=Z?H:o.createRandom().getBytes();L.session.sp={entity:L.entity,prf_algorithm:o.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:L.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:j,server_random:et}},o.handleServerHello=function(L,V,Z){var H=o.parseHelloMessage(L,V,Z);if(!L.fail){if(H.version.minor<=L.version.minor)L.version.minor=H.version.minor;else return L.error(L,{message:"Incompatible TLS version.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}});L.session.version=L.version;var j=H.session_id.bytes();j.length>0&&j===L.session.id?(L.expect=S,L.session.resuming=!0,L.session.sp.server_random=H.random.bytes()):(L.expect=g,L.session.resuming=!1,o.createSecurityParameters(L,H)),L.session.id=j,L.process()}},o.handleClientHello=function(L,V,Z){var H=o.parseHelloMessage(L,V,Z);if(!L.fail){var j=H.session_id.bytes(),et=null;if(L.sessionCache&&(et=L.sessionCache.getSession(j),et===null?j="":(et.version.major!==H.version.major||et.version.minor>H.version.minor)&&(et=null,j="")),j.length===0&&(j=r.random.getBytes(32)),L.session.id=j,L.session.clientHelloVersion=H.version,L.session.sp={},et)L.version=L.session.version=et.version,L.session.sp=et.sp;else{for(var nt,st=1;st<o.SupportedVersions.length&&(nt=o.SupportedVersions[st],!(nt.minor<=H.version.minor));++st);L.version={major:nt.major,minor:nt.minor},L.session.version=L.version}et!==null?(L.expect=k,L.session.resuming=!0,L.session.sp.client_random=H.random.bytes()):(L.expect=L.verifyClient!==!1?P:D,L.session.resuming=!1,o.createSecurityParameters(L,H)),L.open=!0,o.queue(L,o.createRecord(L,{type:o.ContentType.handshake,data:o.createServerHello(L)})),L.session.resuming?(o.queue(L,o.createRecord(L,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()})),L.state.pending=o.createConnectionState(L),L.state.current.write=L.state.pending.write,o.queue(L,o.createRecord(L,{type:o.ContentType.handshake,data:o.createFinished(L)}))):(o.queue(L,o.createRecord(L,{type:o.ContentType.handshake,data:o.createCertificate(L)})),L.fail||(o.queue(L,o.createRecord(L,{type:o.ContentType.handshake,data:o.createServerKeyExchange(L)})),L.verifyClient!==!1&&o.queue(L,o.createRecord(L,{type:o.ContentType.handshake,data:o.createCertificateRequest(L)})),o.queue(L,o.createRecord(L,{type:o.ContentType.handshake,data:o.createServerHelloDone(L)})))),o.flush(L),L.process()}},o.handleCertificate=function(L,V,Z){if(Z<3)return L.error(L,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var H=V.fragment,j={certificate_list:u(H,3)},et,nt,st=[];try{for(;j.certificate_list.length()>0;)et=u(j.certificate_list,3),nt=r.asn1.fromDer(et),et=r.pki.certificateFromAsn1(nt,!0),st.push(et)}catch(vt){return L.error(L,{message:"Could not parse certificate list.",cause:vt,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate}})}var ft=L.entity===o.ConnectionEnd.client;(ft||L.verifyClient===!0)&&st.length===0?L.error(L,{message:ft?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}}):st.length===0?L.expect=ft?y:D:(ft?L.session.serverCertificate=st[0]:L.session.clientCertificate=st[0],o.verifyCertificateChain(L,st)&&(L.expect=ft?y:D)),L.process()},o.handleServerKeyExchange=function(L,V,Z){if(Z>0)return L.error(L,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unsupported_certificate}});L.expect=_,L.process()},o.handleClientKeyExchange=function(L,V,Z){if(Z<48)return L.error(L,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unsupported_certificate}});var H=V.fragment,j={enc_pre_master_secret:u(H,2).getBytes()},et=null;if(L.getPrivateKey)try{et=L.getPrivateKey(L,L.session.serverCertificate),et=r.pki.privateKeyFromPem(et)}catch(ft){L.error(L,{message:"Could not get private key.",cause:ft,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}})}if(et===null)return L.error(L,{message:"No private key set.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}});try{var nt=L.session.sp;nt.pre_master_secret=et.decrypt(j.enc_pre_master_secret);var st=L.session.clientHelloVersion;if(st.major!==nt.pre_master_secret.charCodeAt(0)||st.minor!==nt.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{nt.pre_master_secret=r.random.getBytes(48)}L.expect=k,L.session.clientCertificate!==null&&(L.expect=q),L.process()},o.handleCertificateRequest=function(L,V,Z){if(Z<3)return L.error(L,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var H=V.fragment,j={certificate_types:u(H,1),certificate_authorities:u(H,2)};L.session.certificateRequest=j,L.expect=A,L.process()},o.handleCertificateVerify=function(L,V,Z){if(Z<2)return L.error(L,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var H=V.fragment;H.read-=4;var j=H.bytes();H.read+=4;var et={signature:u(H,2).getBytes()},nt=r.util.createBuffer();nt.putBuffer(L.session.md5.digest()),nt.putBuffer(L.session.sha1.digest()),nt=nt.getBytes();try{var st=L.session.clientCertificate;if(!st.publicKey.verify(nt,et.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");L.session.md5.update(j),L.session.sha1.update(j)}catch{return L.error(L,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.handshake_failure}})}L.expect=k,L.process()},o.handleServerHelloDone=function(L,V,Z){if(Z>0)return L.error(L,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.record_overflow}});if(L.serverCertificate===null){var H={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.insufficient_security}},j=0,et=L.verify(L,H.alert.description,j,[]);if(et!==!0)return(et||et===0)&&(typeof et=="object"&&!r.util.isArray(et)?(et.message&&(H.message=et.message),et.alert&&(H.alert.description=et.alert)):typeof et=="number"&&(H.alert.description=et)),L.error(L,H)}L.session.certificateRequest!==null&&(V=o.createRecord(L,{type:o.ContentType.handshake,data:o.createCertificate(L)}),o.queue(L,V)),V=o.createRecord(L,{type:o.ContentType.handshake,data:o.createClientKeyExchange(L)}),o.queue(L,V),L.expect=M;var nt=function(st,ft){st.session.certificateRequest!==null&&st.session.clientCertificate!==null&&o.queue(st,o.createRecord(st,{type:o.ContentType.handshake,data:o.createCertificateVerify(st,ft)})),o.queue(st,o.createRecord(st,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()})),st.state.pending=o.createConnectionState(st),st.state.current.write=st.state.pending.write,o.queue(st,o.createRecord(st,{type:o.ContentType.handshake,data:o.createFinished(st)})),st.expect=S,o.flush(st),st.process()};if(L.session.certificateRequest===null||L.session.clientCertificate===null)return nt(L,null);o.getClientSignature(L,nt)},o.handleChangeCipherSpec=function(L,V){if(V.fragment.getByte()!==1)return L.error(L,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.illegal_parameter}});var Z=L.entity===o.ConnectionEnd.client;(L.session.resuming&&Z||!L.session.resuming&&!Z)&&(L.state.pending=o.createConnectionState(L)),L.state.current.read=L.state.pending.read,(!L.session.resuming&&Z||L.session.resuming&&!Z)&&(L.state.pending=null),L.expect=Z?T:U,L.process()},o.handleFinished=function(L,V,Z){var H=V.fragment;H.read-=4;var j=H.bytes();H.read+=4;var et=V.fragment.getBytes();H=r.util.createBuffer(),H.putBuffer(L.session.md5.digest()),H.putBuffer(L.session.sha1.digest());var nt=L.entity===o.ConnectionEnd.client,st=nt?"server finished":"client finished",ft=L.session.sp,vt=12,ot=t;if(H=ot(ft.master_secret,st,H.getBytes(),vt),H.getBytes()!==et)return L.error(L,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.decrypt_error}});L.session.md5.update(j),L.session.sha1.update(j),(L.session.resuming&&nt||!L.session.resuming&&!nt)&&(o.queue(L,o.createRecord(L,{type:o.ContentType.change_cipher_spec,data:o.createChangeCipherSpec()})),L.state.current.write=L.state.pending.write,L.state.pending=null,o.queue(L,o.createRecord(L,{type:o.ContentType.handshake,data:o.createFinished(L)}))),L.expect=nt?B:O,L.handshaking=!1,++L.handshakes,L.peerCertificate=nt?L.session.serverCertificate:L.session.clientCertificate,o.flush(L),L.isConnected=!0,L.connected(L),L.process()},o.handleAlert=function(L,V){var Z=V.fragment,H={level:Z.getByte(),description:Z.getByte()},j;switch(H.description){case o.Alert.Description.close_notify:j="Connection closed.";break;case o.Alert.Description.unexpected_message:j="Unexpected message.";break;case o.Alert.Description.bad_record_mac:j="Bad record MAC.";break;case o.Alert.Description.decryption_failed:j="Decryption failed.";break;case o.Alert.Description.record_overflow:j="Record overflow.";break;case o.Alert.Description.decompression_failure:j="Decompression failed.";break;case o.Alert.Description.handshake_failure:j="Handshake failure.";break;case o.Alert.Description.bad_certificate:j="Bad certificate.";break;case o.Alert.Description.unsupported_certificate:j="Unsupported certificate.";break;case o.Alert.Description.certificate_revoked:j="Certificate revoked.";break;case o.Alert.Description.certificate_expired:j="Certificate expired.";break;case o.Alert.Description.certificate_unknown:j="Certificate unknown.";break;case o.Alert.Description.illegal_parameter:j="Illegal parameter.";break;case o.Alert.Description.unknown_ca:j="Unknown certificate authority.";break;case o.Alert.Description.access_denied:j="Access denied.";break;case o.Alert.Description.decode_error:j="Decode error.";break;case o.Alert.Description.decrypt_error:j="Decrypt error.";break;case o.Alert.Description.export_restriction:j="Export restriction.";break;case o.Alert.Description.protocol_version:j="Unsupported protocol version.";break;case o.Alert.Description.insufficient_security:j="Insufficient security.";break;case o.Alert.Description.internal_error:j="Internal error.";break;case o.Alert.Description.user_canceled:j="User canceled.";break;case o.Alert.Description.no_renegotiation:j="Renegotiation not supported.";break;default:j="Unknown error.";break}if(H.description===o.Alert.Description.close_notify)return L.close();L.error(L,{message:j,send:!1,origin:L.entity===o.ConnectionEnd.client?"server":"client",alert:H}),L.process()},o.handleHandshake=function(L,V){var Z=V.fragment,H=Z.getByte(),j=Z.getInt24();if(j>Z.length())return L.fragmented=V,V.fragment=r.util.createBuffer(),Z.read-=4,L.process();L.fragmented=null,Z.read-=4;var et=Z.bytes(j+4);Z.read+=4,H in W[L.entity][L.expect]?(L.entity===o.ConnectionEnd.server&&!L.open&&!L.fail&&(L.handshaking=!0,L.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:r.md.md5.create(),sha1:r.md.sha1.create()}),H!==o.HandshakeType.hello_request&&H!==o.HandshakeType.certificate_verify&&H!==o.HandshakeType.finished&&(L.session.md5.update(et),L.session.sha1.update(et)),W[L.entity][L.expect][H](L,V,j)):o.handleUnexpected(L,V)},o.handleApplicationData=function(L,V){L.data.putBuffer(V.fragment),L.dataReady(L),L.process()},o.handleHeartbeat=function(L,V){var Z=V.fragment,H=Z.getByte(),j=Z.getInt16(),et=Z.getBytes(j);if(H===o.HeartbeatMessageType.heartbeat_request){if(L.handshaking||j>et.length)return L.process();o.queue(L,o.createRecord(L,{type:o.ContentType.heartbeat,data:o.createHeartbeat(o.HeartbeatMessageType.heartbeat_response,et)})),o.flush(L)}else if(H===o.HeartbeatMessageType.heartbeat_response){if(et!==L.expectedHeartbeatPayload)return L.process();L.heartbeatReceived&&L.heartbeatReceived(L,r.util.createBuffer(et))}L.process()};var h=0,g=1,y=2,_=3,A=4,S=5,T=6,B=7,M=8,R=0,P=1,D=2,q=3,k=4,U=5,O=6,G=o.handleUnexpected,E=o.handleChangeCipherSpec,s=o.handleAlert,l=o.handleHandshake,d=o.handleApplicationData,p=o.handleHeartbeat,m=[];m[o.ConnectionEnd.client]=[[G,s,l,G,p],[G,s,l,G,p],[G,s,l,G,p],[G,s,l,G,p],[G,s,l,G,p],[E,s,G,G,p],[G,s,l,G,p],[G,s,l,d,p],[G,s,l,G,p]],m[o.ConnectionEnd.server]=[[G,s,l,G,p],[G,s,l,G,p],[G,s,l,G,p],[G,s,l,G,p],[E,s,G,G,p],[G,s,l,G,p],[G,s,l,d,p],[G,s,l,G,p]];var w=o.handleHelloRequest,x=o.handleServerHello,b=o.handleCertificate,f=o.handleServerKeyExchange,C=o.handleCertificateRequest,F=o.handleServerHelloDone,z=o.handleFinished,W=[];W[o.ConnectionEnd.client]=[[G,G,x,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[w,G,G,G,G,G,G,G,G,G,G,b,f,C,F,G,G,G,G,G,G],[w,G,G,G,G,G,G,G,G,G,G,G,f,C,F,G,G,G,G,G,G],[w,G,G,G,G,G,G,G,G,G,G,G,G,C,F,G,G,G,G,G,G],[w,G,G,G,G,G,G,G,G,G,G,G,G,G,F,G,G,G,G,G,G],[w,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[w,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,z],[w,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[w,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G]];var $=o.handleClientHello,I=o.handleClientKeyExchange,K=o.handleCertificateVerify;W[o.ConnectionEnd.server]=[[G,$,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,b,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,I,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,K,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,z],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G],[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G]],o.generateKeys=function(L,V){var Z=t,H=V.client_random+V.server_random;L.session.resuming||(V.master_secret=Z(V.pre_master_secret,"master secret",H,48).bytes(),V.pre_master_secret=null),H=V.server_random+V.client_random;var j=2*V.mac_key_length+2*V.enc_key_length,et=L.version.major===o.Versions.TLS_1_0.major&&L.version.minor===o.Versions.TLS_1_0.minor;et&&(j+=2*V.fixed_iv_length);var nt=Z(V.master_secret,"key expansion",H,j),st={client_write_MAC_key:nt.getBytes(V.mac_key_length),server_write_MAC_key:nt.getBytes(V.mac_key_length),client_write_key:nt.getBytes(V.enc_key_length),server_write_key:nt.getBytes(V.enc_key_length)};return et&&(st.client_write_IV=nt.getBytes(V.fixed_iv_length),st.server_write_IV=nt.getBytes(V.fixed_iv_length)),st},o.createConnectionState=function(L){var V=L.entity===o.ConnectionEnd.client,Z=function(){var et={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(nt){return!0},compressionState:null,compressFunction:function(nt){return!0},updateSequenceNumber:function(){et.sequenceNumber[1]===4294967295?(et.sequenceNumber[1]=0,++et.sequenceNumber[0]):++et.sequenceNumber[1]}};return et},H={read:Z(),write:Z()};if(H.read.update=function(et,nt){return H.read.cipherFunction(nt,H.read)?H.read.compressFunction(et,nt,H.read)||et.error(et,{message:"Could not decompress record.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.decompression_failure}}):et.error(et,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_record_mac}}),!et.fail},H.write.update=function(et,nt){return H.write.compressFunction(et,nt,H.write)?H.write.cipherFunction(nt,H.write)||et.error(et,{message:"Could not encrypt record.",send:!1,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}}):et.error(et,{message:"Could not compress record.",send:!1,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}}),!et.fail},L.session){var j=L.session.sp;switch(L.session.cipherSuite.initSecurityParameters(j),j.keys=o.generateKeys(L,j),H.read.macKey=V?j.keys.server_write_MAC_key:j.keys.client_write_MAC_key,H.write.macKey=V?j.keys.client_write_MAC_key:j.keys.server_write_MAC_key,L.session.cipherSuite.initConnectionState(H,L,j),j.compression_algorithm){case o.CompressionMethod.none:break;case o.CompressionMethod.deflate:H.read.compressFunction=c,H.write.compressFunction=n;break;default:throw new Error("Unsupported compression algorithm.")}}return H},o.createRandom=function(){var L=new Date,V=+L+L.getTimezoneOffset()*6e4,Z=r.util.createBuffer();return Z.putInt32(V),Z.putBytes(r.random.getBytes(28)),Z},o.createRecord=function(L,V){if(!V.data)return null;var Z={type:V.type,version:{major:L.version.major,minor:L.version.minor},length:V.data.length(),fragment:V.data};return Z},o.createAlert=function(L,V){var Z=r.util.createBuffer();return Z.putByte(V.level),Z.putByte(V.description),o.createRecord(L,{type:o.ContentType.alert,data:Z})},o.createClientHello=function(L){L.session.clientHelloVersion={major:L.version.major,minor:L.version.minor};for(var V=r.util.createBuffer(),Z=0;Z<L.cipherSuites.length;++Z){var H=L.cipherSuites[Z];V.putByte(H.id[0]),V.putByte(H.id[1])}var j=V.length(),et=r.util.createBuffer();et.putByte(o.CompressionMethod.none);var nt=et.length(),st=r.util.createBuffer();if(L.virtualHost){var ft=r.util.createBuffer();ft.putByte(0),ft.putByte(0);var vt=r.util.createBuffer();vt.putByte(0),v(vt,2,r.util.createBuffer(L.virtualHost));var ot=r.util.createBuffer();v(ot,2,vt),v(ft,2,ot),st.putBuffer(ft)}var pt=st.length();pt>0&&(pt+=2);var Ut=L.session.id,At=Ut.length+1+2+4+28+2+j+1+nt+pt,It=r.util.createBuffer();return It.putByte(o.HandshakeType.client_hello),It.putInt24(At),It.putByte(L.version.major),It.putByte(L.version.minor),It.putBytes(L.session.sp.client_random),v(It,1,r.util.createBuffer(Ut)),v(It,2,V),v(It,1,et),pt>0&&v(It,2,st),It},o.createServerHello=function(L){var V=L.session.id,Z=V.length+1+2+4+28+2+1,H=r.util.createBuffer();return H.putByte(o.HandshakeType.server_hello),H.putInt24(Z),H.putByte(L.version.major),H.putByte(L.version.minor),H.putBytes(L.session.sp.server_random),v(H,1,r.util.createBuffer(V)),H.putByte(L.session.cipherSuite.id[0]),H.putByte(L.session.cipherSuite.id[1]),H.putByte(L.session.compressionMethod),H},o.createCertificate=function(L){var V=L.entity===o.ConnectionEnd.client,Z=null;if(L.getCertificate){var H;V?H=L.session.certificateRequest:H=L.session.extensions.server_name.serverNameList,Z=L.getCertificate(L,H)}var j=r.util.createBuffer();if(Z!==null)try{r.util.isArray(Z)||(Z=[Z]);for(var et=null,nt=0;nt<Z.length;++nt){var st=r.pem.decode(Z[nt])[0];if(st.type!=="CERTIFICATE"&&st.type!=="X509 CERTIFICATE"&&st.type!=="TRUSTED CERTIFICATE"){var ft=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw ft.headerType=st.type,ft}if(st.procType&&st.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var vt=r.util.createBuffer(st.body);et===null&&(et=r.asn1.fromDer(vt.bytes(),!1));var ot=r.util.createBuffer();v(ot,3,vt),j.putBuffer(ot)}Z=r.pki.certificateFromAsn1(et),V?L.session.clientCertificate=Z:L.session.serverCertificate=Z}catch(At){return L.error(L,{message:"Could not send certificate list.",cause:At,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate}})}var pt=3+j.length(),Ut=r.util.createBuffer();return Ut.putByte(o.HandshakeType.certificate),Ut.putInt24(pt),v(Ut,3,j),Ut},o.createClientKeyExchange=function(L){var V=r.util.createBuffer();V.putByte(L.session.clientHelloVersion.major),V.putByte(L.session.clientHelloVersion.minor),V.putBytes(r.random.getBytes(46));var Z=L.session.sp;Z.pre_master_secret=V.getBytes();var H=L.session.serverCertificate.publicKey;V=H.encrypt(Z.pre_master_secret);var j=V.length+2,et=r.util.createBuffer();return et.putByte(o.HandshakeType.client_key_exchange),et.putInt24(j),et.putInt16(V.length),et.putBytes(V),et},o.createServerKeyExchange=function(L){var V=r.util.createBuffer();return V},o.getClientSignature=function(L,V){var Z=r.util.createBuffer();Z.putBuffer(L.session.md5.digest()),Z.putBuffer(L.session.sha1.digest()),Z=Z.getBytes(),L.getSignature=L.getSignature||function(H,j,et){var nt=null;if(H.getPrivateKey)try{nt=H.getPrivateKey(H,H.session.clientCertificate),nt=r.pki.privateKeyFromPem(nt)}catch(st){H.error(H,{message:"Could not get private key.",cause:st,send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}})}nt===null?H.error(H,{message:"No private key set.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.internal_error}}):j=nt.sign(j,null),et(H,j)},L.getSignature(L,Z,V)},o.createCertificateVerify=function(L,V){var Z=V.length+2,H=r.util.createBuffer();return H.putByte(o.HandshakeType.certificate_verify),H.putInt24(Z),H.putInt16(V.length),H.putBytes(V),H},o.createCertificateRequest=function(L){var V=r.util.createBuffer();V.putByte(1);var Z=r.util.createBuffer();for(var H in L.caStore.certs){var j=L.caStore.certs[H],et=r.pki.distinguishedNameToAsn1(j.subject),nt=r.asn1.toDer(et);Z.putInt16(nt.length()),Z.putBuffer(nt)}var st=1+V.length()+2+Z.length(),ft=r.util.createBuffer();return ft.putByte(o.HandshakeType.certificate_request),ft.putInt24(st),v(ft,1,V),v(ft,2,Z),ft},o.createServerHelloDone=function(L){var V=r.util.createBuffer();return V.putByte(o.HandshakeType.server_hello_done),V.putInt24(0),V},o.createChangeCipherSpec=function(){var L=r.util.createBuffer();return L.putByte(1),L},o.createFinished=function(L){var V=r.util.createBuffer();V.putBuffer(L.session.md5.digest()),V.putBuffer(L.session.sha1.digest());var Z=L.entity===o.ConnectionEnd.client,H=L.session.sp,j=12,et=t,nt=Z?"client finished":"server finished";V=et(H.master_secret,nt,V.getBytes(),j);var st=r.util.createBuffer();return st.putByte(o.HandshakeType.finished),st.putInt24(V.length()),st.putBuffer(V),st},o.createHeartbeat=function(L,V,Z){typeof Z>"u"&&(Z=V.length);var H=r.util.createBuffer();H.putByte(L),H.putInt16(Z),H.putBytes(V);var j=H.length(),et=Math.max(16,j-Z-3);return H.putBytes(r.random.getBytes(et)),H},o.queue=function(L,V){if(V&&!(V.fragment.length()===0&&(V.type===o.ContentType.handshake||V.type===o.ContentType.alert||V.type===o.ContentType.change_cipher_spec))){if(V.type===o.ContentType.handshake){var Z=V.fragment.bytes();L.session.md5.update(Z),L.session.sha1.update(Z),Z=null}var H;if(V.fragment.length()<=o.MaxFragment)H=[V];else{H=[];for(var j=V.fragment.bytes();j.length>o.MaxFragment;)H.push(o.createRecord(L,{type:V.type,data:r.util.createBuffer(j.slice(0,o.MaxFragment))})),j=j.slice(o.MaxFragment);j.length>0&&H.push(o.createRecord(L,{type:V.type,data:r.util.createBuffer(j)}))}for(var et=0;et<H.length&&!L.fail;++et){var nt=H[et],st=L.state.current.write;st.update(L,nt)&&L.records.push(nt)}}},o.flush=function(L){for(var V=0;V<L.records.length;++V){var Z=L.records[V];L.tlsData.putByte(Z.type),L.tlsData.putByte(Z.version.major),L.tlsData.putByte(Z.version.minor),L.tlsData.putInt16(Z.fragment.length()),L.tlsData.putBuffer(L.records[V].fragment)}return L.records=[],L.tlsDataReady(L)};var N=function(L){switch(L){case!0:return!0;case r.pki.certificateError.bad_certificate:return o.Alert.Description.bad_certificate;case r.pki.certificateError.unsupported_certificate:return o.Alert.Description.unsupported_certificate;case r.pki.certificateError.certificate_revoked:return o.Alert.Description.certificate_revoked;case r.pki.certificateError.certificate_expired:return o.Alert.Description.certificate_expired;case r.pki.certificateError.certificate_unknown:return o.Alert.Description.certificate_unknown;case r.pki.certificateError.unknown_ca:return o.Alert.Description.unknown_ca;default:return o.Alert.Description.bad_certificate}},X=function(L){switch(L){case!0:return!0;case o.Alert.Description.bad_certificate:return r.pki.certificateError.bad_certificate;case o.Alert.Description.unsupported_certificate:return r.pki.certificateError.unsupported_certificate;case o.Alert.Description.certificate_revoked:return r.pki.certificateError.certificate_revoked;case o.Alert.Description.certificate_expired:return r.pki.certificateError.certificate_expired;case o.Alert.Description.certificate_unknown:return r.pki.certificateError.certificate_unknown;case o.Alert.Description.unknown_ca:return r.pki.certificateError.unknown_ca;default:return r.pki.certificateError.bad_certificate}};o.verifyCertificateChain=function(L,V){try{var Z={};for(var H in L.verifyOptions)Z[H]=L.verifyOptions[H];Z.verify=function(et,nt,st){var ft=N(et),vt=L.verify(L,et,nt,st);if(vt!==!0){if(typeof vt=="object"&&!r.util.isArray(vt)){var ot=new Error("The application rejected the certificate.");throw ot.send=!0,ot.alert={level:o.Alert.Level.fatal,description:o.Alert.Description.bad_certificate},vt.message&&(ot.message=vt.message),vt.alert&&(ot.alert.description=vt.alert),ot}vt!==et&&(vt=X(vt))}return vt},r.pki.verifyCertificateChain(L.caStore,V,Z)}catch(et){var j=et;(typeof j!="object"||r.util.isArray(j))&&(j={send:!0,alert:{level:o.Alert.Level.fatal,description:N(et)}}),"send"in j||(j.send=!0),"alert"in j||(j.alert={level:o.Alert.Level.fatal,description:N(j.error)}),L.error(L,j)}return!L.fail},o.createSessionCache=function(L,V){var Z=null;if(L&&L.getSession&&L.setSession&&L.order)Z=L;else{Z={},Z.cache=L||{},Z.capacity=Math.max(V||100,1),Z.order=[];for(var H in L)Z.order.length<=V?Z.order.push(H):delete L[H];Z.getSession=function(j){var et=null,nt=null;if(j?nt=r.util.bytesToHex(j):Z.order.length>0&&(nt=Z.order[0]),nt!==null&&nt in Z.cache){et=Z.cache[nt],delete Z.cache[nt];for(var st in Z.order)if(Z.order[st]===nt){Z.order.splice(st,1);break}}return et},Z.setSession=function(j,et){if(Z.order.length===Z.capacity){var nt=Z.order.shift();delete Z.cache[nt]}var nt=r.util.bytesToHex(j);Z.order.push(nt),Z.cache[nt]=et}}return Z},o.createConnection=function(L){var V=null;L.caStore?r.util.isArray(L.caStore)?V=r.pki.createCaStore(L.caStore):V=L.caStore:V=r.pki.createCaStore();var Z=L.cipherSuites||null;if(Z===null){Z=[];for(var H in o.CipherSuites)Z.push(o.CipherSuites[H])}var j=L.server?o.ConnectionEnd.server:o.ConnectionEnd.client,et=L.sessionCache?o.createSessionCache(L.sessionCache):null,nt={version:{major:o.Version.major,minor:o.Version.minor},entity:j,sessionId:L.sessionId,caStore:V,sessionCache:et,cipherSuites:Z,connected:L.connected,virtualHost:L.virtualHost||null,verifyClient:L.verifyClient||!1,verify:L.verify||function(ot,pt,Ut,At){return pt},verifyOptions:L.verifyOptions||{},getCertificate:L.getCertificate||null,getPrivateKey:L.getPrivateKey||null,getSignature:L.getSignature||null,input:r.util.createBuffer(),tlsData:r.util.createBuffer(),data:r.util.createBuffer(),tlsDataReady:L.tlsDataReady,dataReady:L.dataReady,heartbeatReceived:L.heartbeatReceived,closed:L.closed,error:function(ot,pt){pt.origin=pt.origin||(ot.entity===o.ConnectionEnd.client?"client":"server"),pt.send&&(o.queue(ot,o.createAlert(ot,pt.alert)),o.flush(ot));var Ut=pt.fatal!==!1;Ut&&(ot.fail=!0),L.error(ot,pt),Ut&&ot.close(!1)},deflate:L.deflate||null,inflate:L.inflate||null};nt.reset=function(ot){nt.version={major:o.Version.major,minor:o.Version.minor},nt.record=null,nt.session=null,nt.peerCertificate=null,nt.state={pending:null,current:null},nt.expect=nt.entity===o.ConnectionEnd.client?h:R,nt.fragmented=null,nt.records=[],nt.open=!1,nt.handshakes=0,nt.handshaking=!1,nt.isConnected=!1,nt.fail=!(ot||typeof ot>"u"),nt.input.clear(),nt.tlsData.clear(),nt.data.clear(),nt.state.current=o.createConnectionState(nt)},nt.reset();var st=function(ot,pt){var Ut=pt.type-o.ContentType.change_cipher_spec,At=m[ot.entity][ot.expect];Ut in At?At[Ut](ot,pt):o.handleUnexpected(ot,pt)},ft=function(ot){var pt=0,Ut=ot.input,At=Ut.length();if(At<5)pt=5-At;else{ot.record={type:Ut.getByte(),version:{major:Ut.getByte(),minor:Ut.getByte()},length:Ut.getInt16(),fragment:r.util.createBuffer(),ready:!1};var It=ot.record.version.major===ot.version.major;It&&ot.session&&ot.session.version&&(It=ot.record.version.minor===ot.version.minor),It||ot.error(ot,{message:"Incompatible TLS version.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.protocol_version}})}return pt},vt=function(ot){var pt=0,Ut=ot.input,At=Ut.length();if(At<ot.record.length)pt=ot.record.length-At;else{ot.record.fragment.putBytes(Ut.getBytes(ot.record.length)),Ut.compact();var It=ot.state.current.read;It.update(ot,ot.record)&&(ot.fragmented!==null&&(ot.fragmented.type===ot.record.type?(ot.fragmented.fragment.putBuffer(ot.record.fragment),ot.record=ot.fragmented):ot.error(ot,{message:"Invalid fragmented record.",send:!0,alert:{level:o.Alert.Level.fatal,description:o.Alert.Description.unexpected_message}})),ot.record.ready=!0)}return pt};return nt.handshake=function(ot){if(nt.entity!==o.ConnectionEnd.client)nt.error(nt,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(nt.handshaking)nt.error(nt,{message:"Handshake already in progress.",fatal:!1});else{nt.fail&&!nt.open&&nt.handshakes===0&&(nt.fail=!1),nt.handshaking=!0,ot=ot||"";var pt=null;ot.length>0&&(nt.sessionCache&&(pt=nt.sessionCache.getSession(ot)),pt===null&&(ot="")),ot.length===0&&nt.sessionCache&&(pt=nt.sessionCache.getSession(),pt!==null&&(ot=pt.id)),nt.session={id:ot,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:r.md.md5.create(),sha1:r.md.sha1.create()},pt&&(nt.version=pt.version,nt.session.sp=pt.sp),nt.session.sp.client_random=o.createRandom().getBytes(),nt.open=!0,o.queue(nt,o.createRecord(nt,{type:o.ContentType.handshake,data:o.createClientHello(nt)})),o.flush(nt)}},nt.process=function(ot){var pt=0;return ot&&nt.input.putBytes(ot),nt.fail||(nt.record!==null&&nt.record.ready&&nt.record.fragment.isEmpty()&&(nt.record=null),nt.record===null&&(pt=ft(nt)),!nt.fail&&nt.record!==null&&!nt.record.ready&&(pt=vt(nt)),!nt.fail&&nt.record!==null&&nt.record.ready&&st(nt,nt.record)),pt},nt.prepare=function(ot){return o.queue(nt,o.createRecord(nt,{type:o.ContentType.application_data,data:r.util.createBuffer(ot)})),o.flush(nt)},nt.prepareHeartbeatRequest=function(ot,pt){return ot instanceof r.util.ByteBuffer&&(ot=ot.bytes()),typeof pt>"u"&&(pt=ot.length),nt.expectedHeartbeatPayload=ot,o.queue(nt,o.createRecord(nt,{type:o.ContentType.heartbeat,data:o.createHeartbeat(o.HeartbeatMessageType.heartbeat_request,ot,pt)})),o.flush(nt)},nt.close=function(ot){if(!nt.fail&&nt.sessionCache&&nt.session){var pt={id:nt.session.id,version:nt.session.version,sp:nt.session.sp};pt.sp.keys=null,nt.sessionCache.setSession(pt.id,pt)}nt.open&&(nt.open=!1,nt.input.clear(),(nt.isConnected||nt.handshaking)&&(nt.isConnected=nt.handshaking=!1,o.queue(nt,o.createAlert(nt,{level:o.Alert.Level.warning,description:o.Alert.Description.close_notify})),o.flush(nt)),nt.closed(nt)),nt.reset(ot)},nt},e.exports=r.tls=r.tls||{};for(Q in o)typeof o[Q]!="function"&&(r.tls[Q]=o[Q]);var Q;r.tls.prf_tls1=t,r.tls.hmac_sha1=a,r.tls.createSessionCache=o.createSessionCache,r.tls.createConnection=o.createConnection}}),QI=Ve({"../../node_modules/node-forge/lib/aesCipherSuites.js"(i,e){var r=sr();Ja(),N_();var t=e.exports=r.tls;t.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(h){h.bulk_cipher_algorithm=t.BulkCipherAlgorithm.aes,h.cipher_type=t.CipherType.block,h.enc_key_length=16,h.block_length=16,h.fixed_iv_length=16,h.record_iv_length=16,h.mac_algorithm=t.MACAlgorithm.hmac_sha1,h.mac_length=20,h.mac_key_length=20},initConnectionState:a},t.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(h){h.bulk_cipher_algorithm=t.BulkCipherAlgorithm.aes,h.cipher_type=t.CipherType.block,h.enc_key_length=32,h.block_length=16,h.fixed_iv_length=16,h.record_iv_length=16,h.mac_algorithm=t.MACAlgorithm.hmac_sha1,h.mac_length=20,h.mac_key_length=20},initConnectionState:a};function a(h,g,y){var _=g.entity===r.tls.ConnectionEnd.client;h.read.cipherState={init:!1,cipher:r.cipher.createDecipher("AES-CBC",_?y.keys.server_write_key:y.keys.client_write_key),iv:_?y.keys.server_write_IV:y.keys.client_write_IV},h.write.cipherState={init:!1,cipher:r.cipher.createCipher("AES-CBC",_?y.keys.client_write_key:y.keys.server_write_key),iv:_?y.keys.client_write_IV:y.keys.server_write_IV},h.read.cipherFunction=v,h.write.cipherFunction=n,h.read.macLength=h.write.macLength=y.mac_length,h.read.macFunction=h.write.macFunction=t.hmac_sha1}function n(h,g){var y=!1,_=g.macFunction(g.macKey,g.sequenceNumber,h);h.fragment.putBytes(_),g.updateSequenceNumber();var A;h.version.minor===t.Versions.TLS_1_0.minor?A=g.cipherState.init?null:g.cipherState.iv:A=r.random.getBytesSync(16),g.cipherState.init=!0;var S=g.cipherState.cipher;return S.start({iv:A}),h.version.minor>=t.Versions.TLS_1_1.minor&&S.output.putBytes(A),S.update(h.fragment),S.finish(c)&&(h.fragment=S.output,h.length=h.fragment.length(),y=!0),y}function c(h,g,y){if(!y){var _=h-g.length()%h;g.fillWithByte(_-1,_)}return!0}function u(h,g,y){var _=!0;if(y){for(var A=g.length(),S=g.last(),T=A-1-S;T<A-1;++T)_=_&&g.at(T)==S;_&&g.truncate(S+1)}return _}function v(h,g){var y=!1,_;h.version.minor===t.Versions.TLS_1_0.minor?_=g.cipherState.init?null:g.cipherState.iv:_=h.fragment.getBytes(16),g.cipherState.init=!0;var A=g.cipherState.cipher;A.start({iv:_}),A.update(h.fragment),y=A.finish(u);var S=g.macLength,T=r.random.getBytesSync(S),B=A.output.length();B>=S?(h.fragment=A.output.getBytes(B-S),T=A.output.getBytes(S)):h.fragment=A.output.getBytes(),h.fragment=r.util.createBuffer(h.fragment),h.length=h.fragment.length();var M=g.macFunction(g.macKey,g.sequenceNumber,h);return g.updateSequenceNumber(),y=o(g.macKey,T,M)&&y,y}function o(h,g,y){var _=r.hmac.create();return _.start("SHA1",h),_.update(g),g=_.digest().getBytes(),_.start(null,null),_.update(y),y=_.digest().getBytes(),g===y}}}),k_=Ve({"../../node_modules/node-forge/lib/sha512.js"(i,e){var r=sr();jn(),wr();var t=e.exports=r.sha512=r.sha512||{};r.md.sha512=r.md.algorithms.sha512=t;var a=r.sha384=r.sha512.sha384=r.sha512.sha384||{};a.create=function(){return t.create("SHA-384")},r.md.sha384=r.md.algorithms.sha384=a,r.sha512.sha256=r.sha512.sha256||{create:function(){return t.create("SHA-512/256")}},r.md["sha512/256"]=r.md.algorithms["sha512/256"]=r.sha512.sha256,r.sha512.sha224=r.sha512.sha224||{create:function(){return t.create("SHA-512/224")}},r.md["sha512/224"]=r.md.algorithms["sha512/224"]=r.sha512.sha224,t.create=function(g){if(c||o(),typeof g>"u"&&(g="SHA-512"),!(g in v))throw new Error("Invalid SHA-512 algorithm: "+g);for(var y=v[g],_=null,A=r.util.createBuffer(),S=new Array(80),T=0;T<80;++T)S[T]=new Array(2);var B=64;switch(g){case"SHA-384":B=48;break;case"SHA-512/256":B=32;break;case"SHA-512/224":B=28;break}var M={algorithm:g.replace("-","").toLowerCase(),blockLength:128,digestLength:B,messageLength:0,fullMessageLength:null,messageLengthSize:16};return M.start=function(){M.messageLength=0,M.fullMessageLength=M.messageLength128=[];for(var R=M.messageLengthSize/4,P=0;P<R;++P)M.fullMessageLength.push(0);A=r.util.createBuffer(),_=new Array(y.length);for(var P=0;P<y.length;++P)_[P]=y[P].slice(0);return M},M.start(),M.update=function(R,P){P==="utf8"&&(R=r.util.encodeUtf8(R));var D=R.length;M.messageLength+=D,D=[D/4294967296>>>0,D>>>0];for(var q=M.fullMessageLength.length-1;q>=0;--q)M.fullMessageLength[q]+=D[1],D[1]=D[0]+(M.fullMessageLength[q]/4294967296>>>0),M.fullMessageLength[q]=M.fullMessageLength[q]>>>0,D[0]=D[1]/4294967296>>>0;return A.putBytes(R),h(_,S,A),(A.read>2048||A.length()===0)&&A.compact(),M},M.digest=function(){var R=r.util.createBuffer();R.putBytes(A.bytes());var P=M.fullMessageLength[M.fullMessageLength.length-1]+M.messageLengthSize,D=P&M.blockLength-1;R.putBytes(n.substr(0,M.blockLength-D));for(var q,k,U=M.fullMessageLength[0]*8,O=0;O<M.fullMessageLength.length-1;++O)q=M.fullMessageLength[O+1]*8,k=q/4294967296>>>0,U+=k,R.putInt32(U>>>0),U=q>>>0;R.putInt32(U);for(var G=new Array(_.length),O=0;O<_.length;++O)G[O]=_[O].slice(0);h(G,S,R);var E=r.util.createBuffer(),s;g==="SHA-512"?s=G.length:g==="SHA-384"?s=G.length-2:s=G.length-4;for(var O=0;O<s;++O)E.putInt32(G[O][0]),(O!==s-1||g!=="SHA-512/224")&&E.putInt32(G[O][1]);return E},M};var n=null,c=!1,u=null,v=null;function o(){n="",n+=r.util.fillString("\0",128),u=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],v={},v["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],v["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],v["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],v["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],c=!0}function h(g,y,_){for(var A,S,T,B,M,R,P,D,q,k,U,O,G,E,s,l,d,p,m,w,x,b,f,C,F,z,W,$,I,K,N,X,Q,L,V,Z=_.length();Z>=128;){for(I=0;I<16;++I)y[I][0]=_.getInt32()>>>0,y[I][1]=_.getInt32()>>>0;for(;I<80;++I)X=y[I-2],K=X[0],N=X[1],A=((K>>>19|N<<13)^(N>>>29|K<<3)^K>>>6)>>>0,S=((K<<13|N>>>19)^(N<<3|K>>>29)^(K<<26|N>>>6))>>>0,L=y[I-15],K=L[0],N=L[1],T=((K>>>1|N<<31)^(K>>>8|N<<24)^K>>>7)>>>0,B=((K<<31|N>>>1)^(K<<24|N>>>8)^(K<<25|N>>>7))>>>0,Q=y[I-7],V=y[I-16],N=S+Q[1]+B+V[1],y[I][0]=A+Q[0]+T+V[0]+(N/4294967296>>>0)>>>0,y[I][1]=N>>>0;for(G=g[0][0],E=g[0][1],s=g[1][0],l=g[1][1],d=g[2][0],p=g[2][1],m=g[3][0],w=g[3][1],x=g[4][0],b=g[4][1],f=g[5][0],C=g[5][1],F=g[6][0],z=g[6][1],W=g[7][0],$=g[7][1],I=0;I<80;++I)P=((x>>>14|b<<18)^(x>>>18|b<<14)^(b>>>9|x<<23))>>>0,D=((x<<18|b>>>14)^(x<<14|b>>>18)^(b<<23|x>>>9))>>>0,q=(F^x&(f^F))>>>0,k=(z^b&(C^z))>>>0,M=((G>>>28|E<<4)^(E>>>2|G<<30)^(E>>>7|G<<25))>>>0,R=((G<<4|E>>>28)^(E<<30|G>>>2)^(E<<25|G>>>7))>>>0,U=(G&s|d&(G^s))>>>0,O=(E&l|p&(E^l))>>>0,N=$+D+k+u[I][1]+y[I][1],A=W+P+q+u[I][0]+y[I][0]+(N/4294967296>>>0)>>>0,S=N>>>0,N=R+O,T=M+U+(N/4294967296>>>0)>>>0,B=N>>>0,W=F,$=z,F=f,z=C,f=x,C=b,N=w+S,x=m+A+(N/4294967296>>>0)>>>0,b=N>>>0,m=d,w=p,d=s,p=l,s=G,l=E,N=S+B,G=A+T+(N/4294967296>>>0)>>>0,E=N>>>0;N=g[0][1]+E,g[0][0]=g[0][0]+G+(N/4294967296>>>0)>>>0,g[0][1]=N>>>0,N=g[1][1]+l,g[1][0]=g[1][0]+s+(N/4294967296>>>0)>>>0,g[1][1]=N>>>0,N=g[2][1]+p,g[2][0]=g[2][0]+d+(N/4294967296>>>0)>>>0,g[2][1]=N>>>0,N=g[3][1]+w,g[3][0]=g[3][0]+m+(N/4294967296>>>0)>>>0,g[3][1]=N>>>0,N=g[4][1]+b,g[4][0]=g[4][0]+x+(N/4294967296>>>0)>>>0,g[4][1]=N>>>0,N=g[5][1]+C,g[5][0]=g[5][0]+f+(N/4294967296>>>0)>>>0,g[5][1]=N>>>0,N=g[6][1]+z,g[6][0]=g[6][0]+F+(N/4294967296>>>0)>>>0,g[6][1]=N>>>0,N=g[7][1]+$,g[7][0]=g[7][0]+W+(N/4294967296>>>0)>>>0,g[7][1]=N>>>0,Z-=128}}}}),$I=Ve({"../../node_modules/node-forge/lib/asn1-validator.js"(i){var e=sr();Mn();var r=e.asn1;i.privateKeyValidator={name:"PrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:r.Class.UNIVERSAL,type:r.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},i.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:r.Class.UNIVERSAL,type:r.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:r.Class.UNIVERSAL,type:r.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:r.Class.UNIVERSAL,type:r.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}}}),ZI=Ve({"../../node_modules/node-forge/lib/ed25519.js"(i,e){var r=sr();rc(),fn(),k_(),wr();var t=$I(),a=t.publicKeyValidator,n=t.privateKeyValidator;typeof c>"u"&&(c=r.jsbn.BigInteger);var c,u=r.util.ByteBuffer,v=typeof Buffer>"u"?Uint8Array:Buffer;r.pki=r.pki||{},e.exports=r.pki.ed25519=r.ed25519=r.ed25519||{};var o=r.ed25519;o.constants={},o.constants.PUBLIC_KEY_BYTE_LENGTH=32,o.constants.PRIVATE_KEY_BYTE_LENGTH=64,o.constants.SEED_BYTE_LENGTH=32,o.constants.SIGN_BYTE_LENGTH=64,o.constants.HASH_BYTE_LENGTH=64,o.generateKeyPair=function(L){L=L||{};var V=L.seed;if(V===void 0)V=r.random.getBytesSync(o.constants.SEED_BYTE_LENGTH);else if(typeof V=="string"){if(V.length!==o.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+o.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(V instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');V=h({message:V,encoding:"binary"});for(var Z=new v(o.constants.PUBLIC_KEY_BYTE_LENGTH),H=new v(o.constants.PRIVATE_KEY_BYTE_LENGTH),j=0;j<32;++j)H[j]=V[j];return P(Z,H),{publicKey:Z,privateKey:H}},o.privateKeyFromAsn1=function(L){var V={},Z=[],H=r.asn1.validate(L,n,V,Z);if(!H){var j=new Error("Invalid Key.");throw j.errors=Z,j}var et=r.asn1.derToOid(V.privateKeyOid),nt=r.oids.EdDSA25519;if(et!==nt)throw new Error('Invalid OID "'+et+'"; OID must be "'+nt+'".');var st=V.privateKey,ft=h({message:r.asn1.fromDer(st).value,encoding:"binary"});return{privateKeyBytes:ft}},o.publicKeyFromAsn1=function(L){var V={},Z=[],H=r.asn1.validate(L,a,V,Z);if(!H){var j=new Error("Invalid Key.");throw j.errors=Z,j}var et=r.asn1.derToOid(V.publicKeyOid),nt=r.oids.EdDSA25519;if(et!==nt)throw new Error('Invalid OID "'+et+'"; OID must be "'+nt+'".');var st=V.ed25519PublicKey;if(st.length!==o.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return h({message:st,encoding:"binary"})},o.publicKeyFromPrivateKey=function(L){L=L||{};var V=h({message:L.privateKey,encoding:"binary"});if(V.length!==o.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+o.constants.PRIVATE_KEY_BYTE_LENGTH);for(var Z=new v(o.constants.PUBLIC_KEY_BYTE_LENGTH),H=0;H<Z.length;++H)Z[H]=V[32+H];return Z},o.sign=function(L){L=L||{};var V=h(L),Z=h({message:L.privateKey,encoding:"binary"});if(Z.length===o.constants.SEED_BYTE_LENGTH){var H=o.generateKeyPair({seed:Z});Z=H.privateKey}else if(Z.length!==o.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+o.constants.SEED_BYTE_LENGTH+" or "+o.constants.PRIVATE_KEY_BYTE_LENGTH);var j=new v(o.constants.SIGN_BYTE_LENGTH+V.length);D(j,V,V.length,Z);for(var et=new v(o.constants.SIGN_BYTE_LENGTH),nt=0;nt<et.length;++nt)et[nt]=j[nt];return et},o.verify=function(L){L=L||{};var V=h(L);if(L.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var Z=h({message:L.signature,encoding:"binary"});if(Z.length!==o.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+o.constants.SIGN_BYTE_LENGTH);var H=h({message:L.publicKey,encoding:"binary"});if(H.length!==o.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+o.constants.PUBLIC_KEY_BYTE_LENGTH);var j=new v(o.constants.SIGN_BYTE_LENGTH+V.length),et=new v(o.constants.SIGN_BYTE_LENGTH+V.length),nt;for(nt=0;nt<o.constants.SIGN_BYTE_LENGTH;++nt)j[nt]=Z[nt];for(nt=0;nt<V.length;++nt)j[nt+o.constants.SIGN_BYTE_LENGTH]=V[nt];return q(et,j,j.length,H)>=0};function h(L){var V=L.message;if(V instanceof Uint8Array||V instanceof v)return V;var Z=L.encoding;if(V===void 0)if(L.md)V=L.md.digest().getBytes(),Z="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof V=="string"&&!Z)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof V=="string"){if(typeof Buffer<"u")return Buffer.from(V,Z);V=new u(V,Z)}else if(!(V instanceof u))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var H=new v(V.length()),j=0;j<H.length;++j)H[j]=V.at(j);return H}var g=I(),y=I([1]),_=I([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),A=I([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),S=I([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),T=I([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),B=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),M=I([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function R(L,V){var Z=r.md.sha512.create(),H=new u(L);Z.update(H.getBytes(V),"binary");var j=Z.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(j,"binary");for(var et=new v(o.constants.HASH_BYTE_LENGTH),nt=0;nt<64;++nt)et[nt]=j.charCodeAt(nt);return et}function P(L,V){var Z=[I(),I(),I(),I()],H,j=R(V,32);for(j[0]&=248,j[31]&=127,j[31]|=64,C(Z,j),E(L,Z),H=0;H<32;++H)V[H+32]=L[H];return 0}function D(L,V,Z,H){var j,et,nt=new Float64Array(64),st=[I(),I(),I(),I()],ft=R(H,32);ft[0]&=248,ft[31]&=127,ft[31]|=64;var vt=Z+64;for(j=0;j<Z;++j)L[64+j]=V[j];for(j=0;j<32;++j)L[32+j]=ft[32+j];var ot=R(L.subarray(32),Z+32);for(U(ot),C(st,ot),E(L,st),j=32;j<64;++j)L[j]=H[j];var pt=R(L,Z+64);for(U(pt),j=32;j<64;++j)nt[j]=0;for(j=0;j<32;++j)nt[j]=ot[j];for(j=0;j<32;++j)for(et=0;et<32;et++)nt[j+et]+=pt[j]*ft[et];return k(L.subarray(32),nt),vt}function q(L,V,Z,H){var j,et,nt=new v(32),st=[I(),I(),I(),I()],ft=[I(),I(),I(),I()];if(et=-1,Z<64||l(ft,H))return-1;for(j=0;j<Z;++j)L[j]=V[j];for(j=0;j<32;++j)L[j+32]=H[j];var vt=R(L,Z);if(U(vt),f(st,ft,vt),C(ft,V.subarray(32)),O(st,ft),E(nt,st),Z-=64,w(V,0,nt,0)){for(j=0;j<Z;++j)L[j]=0;return-1}for(j=0;j<Z;++j)L[j]=V[j+64];return et=Z,et}function k(L,V){var Z,H,j,et;for(H=63;H>=32;--H){for(Z=0,j=H-32,et=H-12;j<et;++j)V[j]+=Z-16*V[H]*B[j-(H-32)],Z=V[j]+128>>8,V[j]-=Z*256;V[j]+=Z,V[H]=0}for(Z=0,j=0;j<32;++j)V[j]+=Z-(V[31]>>4)*B[j],Z=V[j]>>8,V[j]&=255;for(j=0;j<32;++j)V[j]-=Z*B[j];for(H=0;H<32;++H)V[H+1]+=V[H]>>8,L[H]=V[H]&255}function U(L){for(var V=new Float64Array(64),Z=0;Z<64;++Z)V[Z]=L[Z],L[Z]=0;k(L,V)}function O(L,V){var Z=I(),H=I(),j=I(),et=I(),nt=I(),st=I(),ft=I(),vt=I(),ot=I();N(Z,L[1],L[0]),N(ot,V[1],V[0]),Q(Z,Z,ot),K(H,L[0],L[1]),K(ot,V[0],V[1]),Q(H,H,ot),Q(j,L[3],V[3]),Q(j,j,A),Q(et,L[2],V[2]),K(et,et,et),N(nt,H,Z),N(st,et,j),K(ft,et,j),K(vt,H,Z),Q(L[0],nt,st),Q(L[1],vt,ft),Q(L[2],ft,st),Q(L[3],nt,vt)}function G(L,V,Z){for(var H=0;H<4;++H)$(L[H],V[H],Z)}function E(L,V){var Z=I(),H=I(),j=I();z(j,V[2]),Q(Z,V[0],j),Q(H,V[1],j),s(L,H),L[31]^=b(Z)<<7}function s(L,V){var Z,H,j,et=I(),nt=I();for(Z=0;Z<16;++Z)nt[Z]=V[Z];for(W(nt),W(nt),W(nt),H=0;H<2;++H){for(et[0]=nt[0]-65517,Z=1;Z<15;++Z)et[Z]=nt[Z]-65535-(et[Z-1]>>16&1),et[Z-1]&=65535;et[15]=nt[15]-32767-(et[14]>>16&1),j=et[15]>>16&1,et[14]&=65535,$(nt,et,1-j)}for(Z=0;Z<16;Z++)L[2*Z]=nt[Z]&255,L[2*Z+1]=nt[Z]>>8}function l(L,V){var Z=I(),H=I(),j=I(),et=I(),nt=I(),st=I(),ft=I();return F(L[2],y),d(L[1],V),X(j,L[1]),Q(et,j,_),N(j,j,L[2]),K(et,L[2],et),X(nt,et),X(st,nt),Q(ft,st,nt),Q(Z,ft,j),Q(Z,Z,et),p(Z,Z),Q(Z,Z,j),Q(Z,Z,et),Q(Z,Z,et),Q(L[0],Z,et),X(H,L[0]),Q(H,H,et),m(H,j)&&Q(L[0],L[0],M),X(H,L[0]),Q(H,H,et),m(H,j)?-1:(b(L[0])===V[31]>>7&&N(L[0],g,L[0]),Q(L[3],L[0],L[1]),0)}function d(L,V){var Z;for(Z=0;Z<16;++Z)L[Z]=V[2*Z]+(V[2*Z+1]<<8);L[15]&=32767}function p(L,V){var Z=I(),H;for(H=0;H<16;++H)Z[H]=V[H];for(H=250;H>=0;--H)X(Z,Z),H!==1&&Q(Z,Z,V);for(H=0;H<16;++H)L[H]=Z[H]}function m(L,V){var Z=new v(32),H=new v(32);return s(Z,L),s(H,V),w(Z,0,H,0)}function w(L,V,Z,H){return x(L,V,Z,H,32)}function x(L,V,Z,H,j){var et,nt=0;for(et=0;et<j;++et)nt|=L[V+et]^Z[H+et];return(1&nt-1>>>8)-1}function b(L){var V=new v(32);return s(V,L),V[0]&1}function f(L,V,Z){var H,j;for(F(L[0],g),F(L[1],y),F(L[2],y),F(L[3],g),j=255;j>=0;--j)H=Z[j/8|0]>>(j&7)&1,G(L,V,H),O(V,L),O(L,L),G(L,V,H)}function C(L,V){var Z=[I(),I(),I(),I()];F(Z[0],S),F(Z[1],T),F(Z[2],y),Q(Z[3],S,T),f(L,Z,V)}function F(L,V){var Z;for(Z=0;Z<16;Z++)L[Z]=V[Z]|0}function z(L,V){var Z=I(),H;for(H=0;H<16;++H)Z[H]=V[H];for(H=253;H>=0;--H)X(Z,Z),H!==2&&H!==4&&Q(Z,Z,V);for(H=0;H<16;++H)L[H]=Z[H]}function W(L){var V,Z,H=1;for(V=0;V<16;++V)Z=L[V]+H+65535,H=Math.floor(Z/65536),L[V]=Z-H*65536;L[0]+=H-1+37*(H-1)}function $(L,V,Z){for(var H,j=~(Z-1),et=0;et<16;++et)H=j&(L[et]^V[et]),L[et]^=H,V[et]^=H}function I(L){var V,Z=new Float64Array(16);if(L)for(V=0;V<L.length;++V)Z[V]=L[V];return Z}function K(L,V,Z){for(var H=0;H<16;++H)L[H]=V[H]+Z[H]}function N(L,V,Z){for(var H=0;H<16;++H)L[H]=V[H]-Z[H]}function X(L,V){Q(L,V,V)}function Q(L,V,Z){var H,j,et=0,nt=0,st=0,ft=0,vt=0,ot=0,pt=0,Ut=0,At=0,It=0,Jt=0,at=0,J=0,rt=0,lt=0,gt=0,Dt=0,ut=0,Y=0,tt=0,dt=0,mt=0,xt=0,bt=0,_t=0,Ht=0,St=0,Mt=0,jt=0,Lt=0,Ft=0,te=Z[0],Bt=Z[1],Ot=Z[2],ie=Z[3],kt=Z[4],qt=Z[5],ae=Z[6],Rt=Z[7],zt=Z[8],he=Z[9],Vt=Z[10],Qt=Z[11],ge=Z[12],Gt=Z[13],$t=Z[14],pe=Z[15];H=V[0],et+=H*te,nt+=H*Bt,st+=H*Ot,ft+=H*ie,vt+=H*kt,ot+=H*qt,pt+=H*ae,Ut+=H*Rt,At+=H*zt,It+=H*he,Jt+=H*Vt,at+=H*Qt,J+=H*ge,rt+=H*Gt,lt+=H*$t,gt+=H*pe,H=V[1],nt+=H*te,st+=H*Bt,ft+=H*Ot,vt+=H*ie,ot+=H*kt,pt+=H*qt,Ut+=H*ae,At+=H*Rt,It+=H*zt,Jt+=H*he,at+=H*Vt,J+=H*Qt,rt+=H*ge,lt+=H*Gt,gt+=H*$t,Dt+=H*pe,H=V[2],st+=H*te,ft+=H*Bt,vt+=H*Ot,ot+=H*ie,pt+=H*kt,Ut+=H*qt,At+=H*ae,It+=H*Rt,Jt+=H*zt,at+=H*he,J+=H*Vt,rt+=H*Qt,lt+=H*ge,gt+=H*Gt,Dt+=H*$t,ut+=H*pe,H=V[3],ft+=H*te,vt+=H*Bt,ot+=H*Ot,pt+=H*ie,Ut+=H*kt,At+=H*qt,It+=H*ae,Jt+=H*Rt,at+=H*zt,J+=H*he,rt+=H*Vt,lt+=H*Qt,gt+=H*ge,Dt+=H*Gt,ut+=H*$t,Y+=H*pe,H=V[4],vt+=H*te,ot+=H*Bt,pt+=H*Ot,Ut+=H*ie,At+=H*kt,It+=H*qt,Jt+=H*ae,at+=H*Rt,J+=H*zt,rt+=H*he,lt+=H*Vt,gt+=H*Qt,Dt+=H*ge,ut+=H*Gt,Y+=H*$t,tt+=H*pe,H=V[5],ot+=H*te,pt+=H*Bt,Ut+=H*Ot,At+=H*ie,It+=H*kt,Jt+=H*qt,at+=H*ae,J+=H*Rt,rt+=H*zt,lt+=H*he,gt+=H*Vt,Dt+=H*Qt,ut+=H*ge,Y+=H*Gt,tt+=H*$t,dt+=H*pe,H=V[6],pt+=H*te,Ut+=H*Bt,At+=H*Ot,It+=H*ie,Jt+=H*kt,at+=H*qt,J+=H*ae,rt+=H*Rt,lt+=H*zt,gt+=H*he,Dt+=H*Vt,ut+=H*Qt,Y+=H*ge,tt+=H*Gt,dt+=H*$t,mt+=H*pe,H=V[7],Ut+=H*te,At+=H*Bt,It+=H*Ot,Jt+=H*ie,at+=H*kt,J+=H*qt,rt+=H*ae,lt+=H*Rt,gt+=H*zt,Dt+=H*he,ut+=H*Vt,Y+=H*Qt,tt+=H*ge,dt+=H*Gt,mt+=H*$t,xt+=H*pe,H=V[8],At+=H*te,It+=H*Bt,Jt+=H*Ot,at+=H*ie,J+=H*kt,rt+=H*qt,lt+=H*ae,gt+=H*Rt,Dt+=H*zt,ut+=H*he,Y+=H*Vt,tt+=H*Qt,dt+=H*ge,mt+=H*Gt,xt+=H*$t,bt+=H*pe,H=V[9],It+=H*te,Jt+=H*Bt,at+=H*Ot,J+=H*ie,rt+=H*kt,lt+=H*qt,gt+=H*ae,Dt+=H*Rt,ut+=H*zt,Y+=H*he,tt+=H*Vt,dt+=H*Qt,mt+=H*ge,xt+=H*Gt,bt+=H*$t,_t+=H*pe,H=V[10],Jt+=H*te,at+=H*Bt,J+=H*Ot,rt+=H*ie,lt+=H*kt,gt+=H*qt,Dt+=H*ae,ut+=H*Rt,Y+=H*zt,tt+=H*he,dt+=H*Vt,mt+=H*Qt,xt+=H*ge,bt+=H*Gt,_t+=H*$t,Ht+=H*pe,H=V[11],at+=H*te,J+=H*Bt,rt+=H*Ot,lt+=H*ie,gt+=H*kt,Dt+=H*qt,ut+=H*ae,Y+=H*Rt,tt+=H*zt,dt+=H*he,mt+=H*Vt,xt+=H*Qt,bt+=H*ge,_t+=H*Gt,Ht+=H*$t,St+=H*pe,H=V[12],J+=H*te,rt+=H*Bt,lt+=H*Ot,gt+=H*ie,Dt+=H*kt,ut+=H*qt,Y+=H*ae,tt+=H*Rt,dt+=H*zt,mt+=H*he,xt+=H*Vt,bt+=H*Qt,_t+=H*ge,Ht+=H*Gt,St+=H*$t,Mt+=H*pe,H=V[13],rt+=H*te,lt+=H*Bt,gt+=H*Ot,Dt+=H*ie,ut+=H*kt,Y+=H*qt,tt+=H*ae,dt+=H*Rt,mt+=H*zt,xt+=H*he,bt+=H*Vt,_t+=H*Qt,Ht+=H*ge,St+=H*Gt,Mt+=H*$t,jt+=H*pe,H=V[14],lt+=H*te,gt+=H*Bt,Dt+=H*Ot,ut+=H*ie,Y+=H*kt,tt+=H*qt,dt+=H*ae,mt+=H*Rt,xt+=H*zt,bt+=H*he,_t+=H*Vt,Ht+=H*Qt,St+=H*ge,Mt+=H*Gt,jt+=H*$t,Lt+=H*pe,H=V[15],gt+=H*te,Dt+=H*Bt,ut+=H*Ot,Y+=H*ie,tt+=H*kt,dt+=H*qt,mt+=H*ae,xt+=H*Rt,bt+=H*zt,_t+=H*he,Ht+=H*Vt,St+=H*Qt,Mt+=H*ge,jt+=H*Gt,Lt+=H*$t,Ft+=H*pe,et+=38*Dt,nt+=38*ut,st+=38*Y,ft+=38*tt,vt+=38*dt,ot+=38*mt,pt+=38*xt,Ut+=38*bt,At+=38*_t,It+=38*Ht,Jt+=38*St,at+=38*Mt,J+=38*jt,rt+=38*Lt,lt+=38*Ft,j=1,H=et+j+65535,j=Math.floor(H/65536),et=H-j*65536,H=nt+j+65535,j=Math.floor(H/65536),nt=H-j*65536,H=st+j+65535,j=Math.floor(H/65536),st=H-j*65536,H=ft+j+65535,j=Math.floor(H/65536),ft=H-j*65536,H=vt+j+65535,j=Math.floor(H/65536),vt=H-j*65536,H=ot+j+65535,j=Math.floor(H/65536),ot=H-j*65536,H=pt+j+65535,j=Math.floor(H/65536),pt=H-j*65536,H=Ut+j+65535,j=Math.floor(H/65536),Ut=H-j*65536,H=At+j+65535,j=Math.floor(H/65536),At=H-j*65536,H=It+j+65535,j=Math.floor(H/65536),It=H-j*65536,H=Jt+j+65535,j=Math.floor(H/65536),Jt=H-j*65536,H=at+j+65535,j=Math.floor(H/65536),at=H-j*65536,H=J+j+65535,j=Math.floor(H/65536),J=H-j*65536,H=rt+j+65535,j=Math.floor(H/65536),rt=H-j*65536,H=lt+j+65535,j=Math.floor(H/65536),lt=H-j*65536,H=gt+j+65535,j=Math.floor(H/65536),gt=H-j*65536,et+=j-1+37*(j-1),j=1,H=et+j+65535,j=Math.floor(H/65536),et=H-j*65536,H=nt+j+65535,j=Math.floor(H/65536),nt=H-j*65536,H=st+j+65535,j=Math.floor(H/65536),st=H-j*65536,H=ft+j+65535,j=Math.floor(H/65536),ft=H-j*65536,H=vt+j+65535,j=Math.floor(H/65536),vt=H-j*65536,H=ot+j+65535,j=Math.floor(H/65536),ot=H-j*65536,H=pt+j+65535,j=Math.floor(H/65536),pt=H-j*65536,H=Ut+j+65535,j=Math.floor(H/65536),Ut=H-j*65536,H=At+j+65535,j=Math.floor(H/65536),At=H-j*65536,H=It+j+65535,j=Math.floor(H/65536),It=H-j*65536,H=Jt+j+65535,j=Math.floor(H/65536),Jt=H-j*65536,H=at+j+65535,j=Math.floor(H/65536),at=H-j*65536,H=J+j+65535,j=Math.floor(H/65536),J=H-j*65536,H=rt+j+65535,j=Math.floor(H/65536),rt=H-j*65536,H=lt+j+65535,j=Math.floor(H/65536),lt=H-j*65536,H=gt+j+65535,j=Math.floor(H/65536),gt=H-j*65536,et+=j-1+37*(j-1),L[0]=et,L[1]=nt,L[2]=st,L[3]=ft,L[4]=vt,L[5]=ot,L[6]=pt,L[7]=Ut,L[8]=At,L[9]=It,L[10]=Jt,L[11]=at,L[12]=J,L[13]=rt,L[14]=lt,L[15]=gt}}}),jI=Ve({"../../node_modules/node-forge/lib/kem.js"(i,e){var r=sr();wr(),fn(),rc(),e.exports=r.kem=r.kem||{};var t=r.jsbn.BigInteger;r.kem.rsa={},r.kem.rsa.create=function(n,c){c=c||{};var u=c.prng||r.random,v={};return v.encrypt=function(o,h){var g=Math.ceil(o.n.bitLength()/8),y;do y=new t(r.util.bytesToHex(u.getBytesSync(g)),16).mod(o.n);while(y.compareTo(t.ONE)<=0);y=r.util.hexToBytes(y.toString(16));var _=g-y.length;_>0&&(y=r.util.fillString("\0",_)+y);var A=o.encrypt(y,"NONE"),S=n.generate(y,h);return{encapsulation:A,key:S}},v.decrypt=function(o,h,g){var y=o.decrypt(h,"NONE");return n.generate(y,g)},v},r.kem.kdf1=function(n,c){a(this,n,0,c||n.digestLength)},r.kem.kdf2=function(n,c){a(this,n,1,c||n.digestLength)};function a(n,c,u,v){n.generate=function(o,h){for(var g=new r.util.ByteBuffer,y=Math.ceil(h/v)+u,_=new r.util.ByteBuffer,A=u;A<y;++A){_.putInt32(A),c.start(),c.update(o+_.getBytes());var S=c.digest();g.putBytes(S.getBytes(v))}return g.truncate(g.length()-h),g.getBytes()}}}}),WI=Ve({"../../node_modules/node-forge/lib/log.js"(i,e){var r=sr();wr(),e.exports=r.log=r.log||{},r.log.levels=["none","error","warning","info","debug","verbose","max"];var t={},a=[],n=null;for(r.log.LEVEL_LOCKED=2,r.log.NO_LEVEL_CHECK=4,r.log.INTERPOLATE=8,v=0;v<r.log.levels.length;++v)c=r.log.levels[v],t[c]={index:v,name:c.toUpperCase()};var c,v;for(r.log.logMessage=function(A){for(var S=t[A.level].index,T=0;T<a.length;++T){var B=a[T];if(B.flags&r.log.NO_LEVEL_CHECK)B.f(A);else{var M=t[B.level].index;S<=M&&B.f(B,A)}}},r.log.prepareStandard=function(A){"standard"in A||(A.standard=t[A.level].name+" ["+A.category+"] "+A.message)},r.log.prepareFull=function(A){if(!("full"in A)){var S=[A.message];S=S.concat([]),A.full=r.util.format.apply(this,S)}},r.log.prepareStandardFull=function(A){"standardFull"in A||(r.log.prepareStandard(A),A.standardFull=A.standard)},u=["error","warning","info","debug","verbose"],v=0;v<u.length;++v)(function(A){r.log[A]=function(S,T){var B=Array.prototype.slice.call(arguments).slice(2),M={timestamp:new Date,level:A,category:S,message:T,arguments:B};r.log.logMessage(M)}})(u[v]);var u,v;r.log.makeLogger=function(A){var S={flags:0,f:A};return r.log.setLevel(S,"none"),S},r.log.setLevel=function(A,S){var T=!1;if(A&&!(A.flags&r.log.LEVEL_LOCKED))for(var B=0;B<r.log.levels.length;++B){var M=r.log.levels[B];if(S==M){A.level=S,T=!0;break}}return T},r.log.lock=function(A,S){typeof S>"u"||S?A.flags|=r.log.LEVEL_LOCKED:A.flags&=~r.log.LEVEL_LOCKED},r.log.addLogger=function(A){a.push(A)},typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(h={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},g=function(A,S){r.log.prepareStandard(S);var T=h[S.level],B=[S.standard];B=B.concat(S.arguments.slice()),T.apply(console,B)},o=r.log.makeLogger(g)):(g=function(A,S){r.log.prepareStandardFull(S),console.log(S.standardFull)},o=r.log.makeLogger(g)),r.log.setLevel(o,"debug"),r.log.addLogger(o),n=o):console={log:function(){}};var o,h,g;n!==null&&typeof window<"u"&&window.location&&(y=new URL(window.location.href).searchParams,y.has("console.level")&&r.log.setLevel(n,y.get("console.level").slice(-1)[0]),y.has("console.lock")&&(_=y.get("console.lock").slice(-1)[0],_=="true"&&r.log.lock(n)));var y,_;r.log.consoleLogger=n}}),YI=Ve({"../../node_modules/node-forge/lib/md.all.js"(i,e){e.exports=jn(),H1(),sf(),E_(),k_()}}),XI=Ve({"../../node_modules/node-forge/lib/pkcs7.js"(i,e){var r=sr();Ja(),Mn(),ec(),ts(),zs(),B_(),fn(),wr(),Z1();var t=r.asn1,a=e.exports=r.pkcs7=r.pkcs7||{};a.messageFromPem=function(S){var T=r.pem.decode(S)[0];if(T.type!=="PKCS7"){var B=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw B.headerType=T.type,B}if(T.procType&&T.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var M=t.fromDer(T.body);return a.messageFromAsn1(M)},a.messageToPem=function(S,T){var B={type:"PKCS7",body:t.toDer(S.toAsn1()).getBytes()};return r.pem.encode(B,{maxline:T})},a.messageFromAsn1=function(S){var T={},B=[];if(!t.validate(S,a.asn1.contentInfoValidator,T,B)){var M=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw M.errors=B,M}var R=t.derToOid(T.contentType),P;switch(R){case r.pki.oids.envelopedData:P=a.createEnvelopedData();break;case r.pki.oids.encryptedData:P=a.createEncryptedData();break;case r.pki.oids.signedData:P=a.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+R+" is not (yet) supported.")}return P.fromAsn1(T.content.value[0]),P},a.createSignedData=function(){var S=null;return S={type:r.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(M){if(_(S,M,a.asn1.signedDataValidator),S.certificates=[],S.crls=[],S.digestAlgorithmIdentifiers=[],S.contentInfo=null,S.signerInfos=[],S.rawCapture.certificates)for(var R=S.rawCapture.certificates.value,P=0;P<R.length;++P)S.certificates.push(r.pki.certificateFromAsn1(R[P]))},toAsn1:function(){S.contentInfo||S.sign();for(var M=[],R=0;R<S.certificates.length;++R)M.push(r.pki.certificateToAsn1(S.certificates[R]));var P=[],D=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(S.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,S.digestAlgorithmIdentifiers),S.contentInfo])]);return M.length>0&&D.value[0].value.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,M)),P.length>0&&D.value[0].value.push(t.create(t.Class.CONTEXT_SPECIFIC,1,!0,P)),D.value[0].value.push(t.create(t.Class.UNIVERSAL,t.Type.SET,!0,S.signerInfos)),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(S.type).getBytes()),D])},addSigner:function(M){var R=M.issuer,P=M.serialNumber;if(M.certificate){var D=M.certificate;typeof D=="string"&&(D=r.pki.certificateFromPem(D)),R=D.issuer.attributes,P=D.serialNumber}var q=M.key;if(!q)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof q=="string"&&(q=r.pki.privateKeyFromPem(q));var k=M.digestAlgorithm||r.pki.oids.sha1;switch(k){case r.pki.oids.sha1:case r.pki.oids.sha256:case r.pki.oids.sha384:case r.pki.oids.sha512:case r.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+k)}var U=M.authenticatedAttributes||[];if(U.length>0){for(var O=!1,G=!1,E=0;E<U.length;++E){var s=U[E];if(!O&&s.type===r.pki.oids.contentType){if(O=!0,G)break;continue}if(!G&&s.type===r.pki.oids.messageDigest){if(G=!0,O)break;continue}}if(!O||!G)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}S.signers.push({key:q,version:1,issuer:R,serialNumber:P,digestAlgorithm:k,signatureAlgorithm:r.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:U,unauthenticatedAttributes:[]})},sign:function(M){if(M=M||{},(typeof S.content!="object"||S.contentInfo===null)&&(S.contentInfo=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.pki.oids.data).getBytes())]),"content"in S)){var R;S.content instanceof r.util.ByteBuffer?R=S.content.bytes():typeof S.content=="string"&&(R=r.util.encodeUtf8(S.content)),M.detached?S.detachedContent=t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,R):S.contentInfo.value.push(t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,R)]))}if(S.signers.length!==0){var P=T();B(P)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(M){typeof M=="string"&&(M=r.pki.certificateFromPem(M)),S.certificates.push(M)},addCertificateRevokationList:function(M){throw new Error("PKCS#7 CRL support not yet implemented.")}},S;function T(){for(var M={},R=0;R<S.signers.length;++R){var P=S.signers[R],D=P.digestAlgorithm;D in M||(M[D]=r.md[r.pki.oids[D]].create()),P.authenticatedAttributes.length===0?P.md=M[D]:P.md=r.md[r.pki.oids[D]].create()}S.digestAlgorithmIdentifiers=[];for(var D in M)S.digestAlgorithmIdentifiers.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(D).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")]));return M}function B(M){var R;if(S.detachedContent?R=S.detachedContent:(R=S.contentInfo.value[1],R=R.value[0]),!R)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var P=t.derToOid(S.contentInfo.value[0].value),D=t.toDer(R);D.getByte(),t.getBerValueLength(D),D=D.getBytes();for(var q in M)M[q].start().update(D);for(var k=new Date,U=0;U<S.signers.length;++U){var O=S.signers[U];if(O.authenticatedAttributes.length===0){if(P!==r.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{O.authenticatedAttributesAsn1=t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var G=t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[]),E=0;E<O.authenticatedAttributes.length;++E){var s=O.authenticatedAttributes[E];s.type===r.pki.oids.messageDigest?s.value=M[O.digestAlgorithm].digest():s.type===r.pki.oids.signingTime&&(s.value||(s.value=k)),G.value.push(g(s)),O.authenticatedAttributesAsn1.value.push(g(s))}D=t.toDer(G).getBytes(),O.md.start().update(D)}O.signature=O.key.sign(O.md,"RSASSA-PKCS1-V1_5")}S.signerInfos=h(S.signers)}},a.createEncryptedData=function(){var S=null;return S={type:r.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(T){_(S,T,a.asn1.encryptedDataValidator)},decrypt:function(T){T!==void 0&&(S.encryptedContent.key=T),A(S)}},S},a.createEnvelopedData=function(){var S=null;return S={type:r.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:r.pki.oids["aes256-CBC"]},fromAsn1:function(T){var B=_(S,T,a.asn1.envelopedDataValidator);S.recipients=u(B.recipientInfos.value)},toAsn1:function(){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(S.type).getBytes()),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(S.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,v(S.recipients)),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,y(S.encryptedContent))])])])},findRecipient:function(T){for(var B=T.issuer.attributes,M=0;M<S.recipients.length;++M){var R=S.recipients[M],P=R.issuer;if(R.serialNumber===T.serialNumber&&P.length===B.length){for(var D=!0,q=0;q<B.length;++q)if(P[q].type!==B[q].type||P[q].value!==B[q].value){D=!1;break}if(D)return R}}return null},decrypt:function(T,B){if(S.encryptedContent.key===void 0&&T!==void 0&&B!==void 0)switch(T.encryptedContent.algorithm){case r.pki.oids.rsaEncryption:case r.pki.oids.desCBC:var M=B.decrypt(T.encryptedContent.content);S.encryptedContent.key=r.util.createBuffer(M);break;default:throw new Error("Unsupported asymmetric cipher, OID "+T.encryptedContent.algorithm)}A(S)},addRecipient:function(T){S.recipients.push({version:0,issuer:T.issuer.attributes,serialNumber:T.serialNumber,encryptedContent:{algorithm:r.pki.oids.rsaEncryption,key:T.publicKey}})},encrypt:function(T,B){if(S.encryptedContent.content===void 0){B=B||S.encryptedContent.algorithm,T=T||S.encryptedContent.key;var M,R,P;switch(B){case r.pki.oids["aes128-CBC"]:M=16,R=16,P=r.aes.createEncryptionCipher;break;case r.pki.oids["aes192-CBC"]:M=24,R=16,P=r.aes.createEncryptionCipher;break;case r.pki.oids["aes256-CBC"]:M=32,R=16,P=r.aes.createEncryptionCipher;break;case r.pki.oids["des-EDE3-CBC"]:M=24,R=8,P=r.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+B)}if(T===void 0)T=r.util.createBuffer(r.random.getBytes(M));else if(T.length()!=M)throw new Error("Symmetric key has wrong length; got "+T.length()+" bytes, expected "+M+".");S.encryptedContent.algorithm=B,S.encryptedContent.key=T,S.encryptedContent.parameter=r.util.createBuffer(r.random.getBytes(R));var D=P(T);if(D.start(S.encryptedContent.parameter.copy()),D.update(S.content),!D.finish())throw new Error("Symmetric encryption failed.");S.encryptedContent.content=D.output}for(var q=0;q<S.recipients.length;++q){var k=S.recipients[q];if(k.encryptedContent.content===void 0)switch(k.encryptedContent.algorithm){case r.pki.oids.rsaEncryption:k.encryptedContent.content=k.encryptedContent.key.encrypt(S.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+k.encryptedContent.algorithm)}}}},S};function n(S){var T={},B=[];if(!t.validate(S,a.asn1.recipientInfoValidator,T,B)){var M=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw M.errors=B,M}return{version:T.version.charCodeAt(0),issuer:r.pki.RDNAttributesAsArray(T.issuer),serialNumber:r.util.createBuffer(T.serial).toHex(),encryptedContent:{algorithm:t.derToOid(T.encAlgorithm),parameter:T.encParameter?T.encParameter.value:void 0,content:T.encKey}}}function c(S){return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(S.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[r.pki.distinguishedNameToAsn1({attributes:S.issuer}),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,r.util.hexToBytes(S.serialNumber))]),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(S.encryptedContent.algorithm).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")]),t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,S.encryptedContent.content)])}function u(S){for(var T=[],B=0;B<S.length;++B)T.push(n(S[B]));return T}function v(S){for(var T=[],B=0;B<S.length;++B)T.push(c(S[B]));return T}function o(S){var T=t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,t.integerToDer(S.version).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[r.pki.distinguishedNameToAsn1({attributes:S.issuer}),t.create(t.Class.UNIVERSAL,t.Type.INTEGER,!1,r.util.hexToBytes(S.serialNumber))]),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(S.digestAlgorithm).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")])]);if(S.authenticatedAttributesAsn1&&T.value.push(S.authenticatedAttributesAsn1),T.value.push(t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(S.signatureAlgorithm).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.NULL,!1,"")])),T.value.push(t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,S.signature)),S.unauthenticatedAttributes.length>0){for(var B=t.create(t.Class.CONTEXT_SPECIFIC,1,!0,[]),M=0;M<S.unauthenticatedAttributes.length;++M){var R=S.unauthenticatedAttributes[M];B.values.push(g(R))}T.value.push(B)}return T}function h(S){for(var T=[],B=0;B<S.length;++B)T.push(o(S[B]));return T}function g(S){var T;if(S.type===r.pki.oids.contentType)T=t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(S.value).getBytes());else if(S.type===r.pki.oids.messageDigest)T=t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,S.value.bytes());else if(S.type===r.pki.oids.signingTime){var B=new Date("1950-01-01T00:00:00Z"),M=new Date("2050-01-01T00:00:00Z"),R=S.value;if(typeof R=="string"){var P=Date.parse(R);isNaN(P)?R.length===13?R=t.utcTimeToDate(R):R=t.generalizedTimeToDate(R):R=new Date(P)}R>=B&&R<M?T=t.create(t.Class.UNIVERSAL,t.Type.UTCTIME,!1,t.dateToUtcTime(R)):T=t.create(t.Class.UNIVERSAL,t.Type.GENERALIZEDTIME,!1,t.dateToGeneralizedTime(R))}return t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(S.type).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SET,!0,[T])])}function y(S){return[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(r.pki.oids.data).getBytes()),t.create(t.Class.UNIVERSAL,t.Type.SEQUENCE,!0,[t.create(t.Class.UNIVERSAL,t.Type.OID,!1,t.oidToDer(S.algorithm).getBytes()),S.parameter?t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,S.parameter.getBytes()):void 0]),t.create(t.Class.CONTEXT_SPECIFIC,0,!0,[t.create(t.Class.UNIVERSAL,t.Type.OCTETSTRING,!1,S.content.getBytes())])]}function _(S,T,B){var M={},R=[];if(!t.validate(T,B,M,R)){var P=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw P.errors=P,P}var D=t.derToOid(M.contentType);if(D!==r.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(M.encryptedContent){var q="";if(r.util.isArray(M.encryptedContent))for(var k=0;k<M.encryptedContent.length;++k){if(M.encryptedContent[k].type!==t.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");q+=M.encryptedContent[k].value}else q=M.encryptedContent;S.encryptedContent={algorithm:t.derToOid(M.encAlgorithm),parameter:r.util.createBuffer(M.encParameter.value),content:r.util.createBuffer(q)}}if(M.content){var q="";if(r.util.isArray(M.content))for(var k=0;k<M.content.length;++k){if(M.content[k].type!==t.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");q+=M.content[k].value}else q=M.content;S.content=r.util.createBuffer(q)}return S.version=M.version.charCodeAt(0),S.rawCapture=M,M}function A(S){if(S.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(S.content===void 0){var T;switch(S.encryptedContent.algorithm){case r.pki.oids["aes128-CBC"]:case r.pki.oids["aes192-CBC"]:case r.pki.oids["aes256-CBC"]:T=r.aes.createDecryptionCipher(S.encryptedContent.key);break;case r.pki.oids.desCBC:case r.pki.oids["des-EDE3-CBC"]:T=r.des.createDecryptionCipher(S.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+S.encryptedContent.algorithm)}if(T.start(S.encryptedContent.parameter),T.update(S.encryptedContent.content),!T.finish())throw new Error("Symmetric decryption failed.");S.content=T.output}}}}),JI=Ve({"../../node_modules/node-forge/lib/ssh.js"(i,e){var r=sr();Ja(),af(),H1(),sf(),wr();var t=e.exports=r.ssh=r.ssh||{};t.privateKeyToPutty=function(u,v,o){o=o||"",v=v||"";var h="ssh-rsa",g=v===""?"none":"aes256-cbc",y="PuTTY-User-Key-File-2: "+h+`\r
`;y+="Encryption: "+g+`\r
`,y+="Comment: "+o+`\r
`;var _=r.util.createBuffer();n(_,h),a(_,u.e),a(_,u.n);var A=r.util.encode64(_.bytes(),64),S=Math.floor(A.length/66)+1;y+="Public-Lines: "+S+`\r
`,y+=A;var T=r.util.createBuffer();a(T,u.d),a(T,u.p),a(T,u.q),a(T,u.qInv);var B;if(!v)B=r.util.encode64(T.bytes(),64);else{var M=T.length()+16-1;M-=M%16;var R=c(T.bytes());R.truncate(R.length()-M+T.length()),T.putBuffer(R);var P=r.util.createBuffer();P.putBuffer(c("\0\0\0\0",v)),P.putBuffer(c("\0\0\0",v));var D=r.aes.createEncryptionCipher(P.truncate(8),"CBC");D.start(r.util.createBuffer().fillWithByte(0,16)),D.update(T.copy()),D.finish();var q=D.output;q.truncate(16),B=r.util.encode64(q.bytes(),64)}S=Math.floor(B.length/66)+1,y+=`\r
Private-Lines: `+S+`\r
`,y+=B;var k=c("putty-private-key-file-mac-key",v),U=r.util.createBuffer();n(U,h),n(U,g),n(U,o),U.putInt32(_.length()),U.putBuffer(_),U.putInt32(T.length()),U.putBuffer(T);var O=r.hmac.create();return O.start("sha1",k),O.update(U.bytes()),y+=`\r
Private-MAC: `+O.digest().toHex()+`\r
`,y},t.publicKeyToOpenSSH=function(u,v){var o="ssh-rsa";v=v||"";var h=r.util.createBuffer();return n(h,o),a(h,u.e),a(h,u.n),o+" "+r.util.encode64(h.bytes())+" "+v},t.privateKeyToOpenSSH=function(u,v){return v?r.pki.encryptRsaPrivateKey(u,v,{legacy:!0,algorithm:"aes128"}):r.pki.privateKeyToPem(u)},t.getPublicKeyFingerprint=function(u,v){v=v||{};var o=v.md||r.md.md5.create(),h="ssh-rsa",g=r.util.createBuffer();n(g,h),a(g,u.e),a(g,u.n),o.start(),o.update(g.getBytes());var y=o.digest();if(v.encoding==="hex"){var _=y.toHex();return v.delimiter?_.match(/.{2}/g).join(v.delimiter):_}else{if(v.encoding==="binary")return y.getBytes();if(v.encoding)throw new Error('Unknown encoding "'+v.encoding+'".')}return y};function a(u,v){var o=v.toString(16);o[0]>="8"&&(o="00"+o);var h=r.util.hexToBytes(o);u.putInt32(h.length),u.putBytes(h)}function n(u,v){u.putInt32(v.length),u.putString(v)}function c(){for(var u=r.md.sha1.create(),v=arguments.length,o=0;o<v;++o)u.update(arguments[o]);return u.digest()}}}),tM=Ve({"../../node_modules/node-forge/lib/index.js"(i,e){e.exports=sr(),Ja(),QI(),Mn(),K1(),ec(),ZI(),af(),jI(),WI(),YI(),L_(),Q1(),zs(),x_(),T_(),XI(),R_(),I_(),A_(),$1(),fn(),S_(),JI(),N_(),wr()}}),eM=Ve({"../../node_modules/bn.js/lib/bn.js"(i,e){(function(r,t){function a(d,p){if(!d)throw new Error(p||"Assertion failed")}function n(d,p){d.super_=p;var m=function(){};m.prototype=p.prototype,d.prototype=new m,d.prototype.constructor=d}function c(d,p,m){if(c.isBN(d))return d;this.negative=0,this.words=null,this.length=0,this.red=null,d!==null&&((p==="le"||p==="be")&&(m=p,p=10),this._init(d||0,p||10,m||"be"))}typeof r=="object"?r.exports=c:t.BN=c,c.BN=c,c.wordSize=26;var u;try{typeof window<"u"&&typeof window.Buffer<"u"?u=window.Buffer:u=Ni().Buffer}catch{}c.isBN=function(p){return p instanceof c?!0:p!==null&&typeof p=="object"&&p.constructor.wordSize===c.wordSize&&Array.isArray(p.words)},c.max=function(p,m){return p.cmp(m)>0?p:m},c.min=function(p,m){return p.cmp(m)<0?p:m},c.prototype._init=function(p,m,w){if(typeof p=="number")return this._initNumber(p,m,w);if(typeof p=="object")return this._initArray(p,m,w);m==="hex"&&(m=16),a(m===(m|0)&&m>=2&&m<=36),p=p.toString().replace(/\s+/g,"");var x=0;p[0]==="-"&&(x++,this.negative=1),x<p.length&&(m===16?this._parseHex(p,x,w):(this._parseBase(p,m,x),w==="le"&&this._initArray(this.toArray(),m,w)))},c.prototype._initNumber=function(p,m,w){p<0&&(this.negative=1,p=-p),p<67108864?(this.words=[p&67108863],this.length=1):p<4503599627370496?(this.words=[p&67108863,p/67108864&67108863],this.length=2):(a(p<9007199254740992),this.words=[p&67108863,p/67108864&67108863,1],this.length=3),w==="le"&&this._initArray(this.toArray(),m,w)},c.prototype._initArray=function(p,m,w){if(a(typeof p.length=="number"),p.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(p.length/3),this.words=new Array(this.length);for(var x=0;x<this.length;x++)this.words[x]=0;var b,f,C=0;if(w==="be")for(x=p.length-1,b=0;x>=0;x-=3)f=p[x]|p[x-1]<<8|p[x-2]<<16,this.words[b]|=f<<C&67108863,this.words[b+1]=f>>>26-C&67108863,C+=24,C>=26&&(C-=26,b++);else if(w==="le")for(x=0,b=0;x<p.length;x+=3)f=p[x]|p[x+1]<<8|p[x+2]<<16,this.words[b]|=f<<C&67108863,this.words[b+1]=f>>>26-C&67108863,C+=24,C>=26&&(C-=26,b++);return this._strip()};function v(d,p){var m=d.charCodeAt(p);if(m>=48&&m<=57)return m-48;if(m>=65&&m<=70)return m-55;if(m>=97&&m<=102)return m-87;a(!1,"Invalid character in "+d)}function o(d,p,m){var w=v(d,m);return m-1>=p&&(w|=v(d,m-1)<<4),w}c.prototype._parseHex=function(p,m,w){this.length=Math.ceil((p.length-m)/6),this.words=new Array(this.length);for(var x=0;x<this.length;x++)this.words[x]=0;var b=0,f=0,C;if(w==="be")for(x=p.length-1;x>=m;x-=2)C=o(p,m,x)<<b,this.words[f]|=C&67108863,b>=18?(b-=18,f+=1,this.words[f]|=C>>>26):b+=8;else{var F=p.length-m;for(x=F%2===0?m+1:m;x<p.length;x+=2)C=o(p,m,x)<<b,this.words[f]|=C&67108863,b>=18?(b-=18,f+=1,this.words[f]|=C>>>26):b+=8}this._strip()};function h(d,p,m,w){for(var x=0,b=0,f=Math.min(d.length,m),C=p;C<f;C++){var F=d.charCodeAt(C)-48;x*=w,F>=49?b=F-49+10:F>=17?b=F-17+10:b=F,a(F>=0&&b<w,"Invalid character"),x+=b}return x}c.prototype._parseBase=function(p,m,w){this.words=[0],this.length=1;for(var x=0,b=1;b<=67108863;b*=m)x++;x--,b=b/m|0;for(var f=p.length-w,C=f%x,F=Math.min(f,f-C)+w,z=0,W=w;W<F;W+=x)z=h(p,W,W+x,m),this.imuln(b),this.words[0]+z<67108864?this.words[0]+=z:this._iaddn(z);if(C!==0){var $=1;for(z=h(p,W,p.length,m),W=0;W<C;W++)$*=m;this.imuln($),this.words[0]+z<67108864?this.words[0]+=z:this._iaddn(z)}this._strip()},c.prototype.copy=function(p){p.words=new Array(this.length);for(var m=0;m<this.length;m++)p.words[m]=this.words[m];p.length=this.length,p.negative=this.negative,p.red=this.red};function g(d,p){d.words=p.words,d.length=p.length,d.negative=p.negative,d.red=p.red}if(c.prototype._move=function(p){g(p,this)},c.prototype.clone=function(){var p=new c(null);return this.copy(p),p},c.prototype._expand=function(p){for(;this.length<p;)this.words[this.length++]=0;return this},c.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},c.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{c.prototype[Symbol.for("nodejs.util.inspect.custom")]=y}catch{c.prototype.inspect=y}else c.prototype.inspect=y;function y(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var _=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],A=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],S=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];c.prototype.toString=function(p,m){p=p||10,m=m|0||1;var w;if(p===16||p==="hex"){w="";for(var x=0,b=0,f=0;f<this.length;f++){var C=this.words[f],F=((C<<x|b)&16777215).toString(16);b=C>>>24-x&16777215,x+=2,x>=26&&(x-=26,f--),b!==0||f!==this.length-1?w=_[6-F.length]+F+w:w=F+w}for(b!==0&&(w=b.toString(16)+w);w.length%m!==0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}if(p===(p|0)&&p>=2&&p<=36){var z=A[p],W=S[p];w="";var $=this.clone();for($.negative=0;!$.isZero();){var I=$.modrn(W).toString(p);$=$.idivn(W),$.isZero()?w=I+w:w=_[z-I.length]+I+w}for(this.isZero()&&(w="0"+w);w.length%m!==0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}a(!1,"Base should be between 2 and 36")},c.prototype.toNumber=function(){var p=this.words[0];return this.length===2?p+=this.words[1]*67108864:this.length===3&&this.words[2]===1?p+=4503599627370496+this.words[1]*67108864:this.length>2&&a(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-p:p},c.prototype.toJSON=function(){return this.toString(16,2)},u&&(c.prototype.toBuffer=function(p,m){return this.toArrayLike(u,p,m)}),c.prototype.toArray=function(p,m){return this.toArrayLike(Array,p,m)};var T=function(p,m){return p.allocUnsafe?p.allocUnsafe(m):new p(m)};c.prototype.toArrayLike=function(p,m,w){this._strip();var x=this.byteLength(),b=w||Math.max(1,x);a(x<=b,"byte array longer than desired length"),a(b>0,"Requested array length <= 0");var f=T(p,b),C=m==="le"?"LE":"BE";return this["_toArrayLike"+C](f,x),f},c.prototype._toArrayLikeLE=function(p,m){for(var w=0,x=0,b=0,f=0;b<this.length;b++){var C=this.words[b]<<f|x;p[w++]=C&255,w<p.length&&(p[w++]=C>>8&255),w<p.length&&(p[w++]=C>>16&255),f===6?(w<p.length&&(p[w++]=C>>24&255),x=0,f=0):(x=C>>>24,f+=2)}if(w<p.length)for(p[w++]=x;w<p.length;)p[w++]=0},c.prototype._toArrayLikeBE=function(p,m){for(var w=p.length-1,x=0,b=0,f=0;b<this.length;b++){var C=this.words[b]<<f|x;p[w--]=C&255,w>=0&&(p[w--]=C>>8&255),w>=0&&(p[w--]=C>>16&255),f===6?(w>=0&&(p[w--]=C>>24&255),x=0,f=0):(x=C>>>24,f+=2)}if(w>=0)for(p[w--]=x;w>=0;)p[w--]=0},Math.clz32?c.prototype._countBits=function(p){return 32-Math.clz32(p)}:c.prototype._countBits=function(p){var m=p,w=0;return m>=4096&&(w+=13,m>>>=13),m>=64&&(w+=7,m>>>=7),m>=8&&(w+=4,m>>>=4),m>=2&&(w+=2,m>>>=2),w+m},c.prototype._zeroBits=function(p){if(p===0)return 26;var m=p,w=0;return m&8191||(w+=13,m>>>=13),m&127||(w+=7,m>>>=7),m&15||(w+=4,m>>>=4),m&3||(w+=2,m>>>=2),m&1||w++,w},c.prototype.bitLength=function(){var p=this.words[this.length-1],m=this._countBits(p);return(this.length-1)*26+m};function B(d){for(var p=new Array(d.bitLength()),m=0;m<p.length;m++){var w=m/26|0,x=m%26;p[m]=d.words[w]>>>x&1}return p}c.prototype.zeroBits=function(){if(this.isZero())return 0;for(var p=0,m=0;m<this.length;m++){var w=this._zeroBits(this.words[m]);if(p+=w,w!==26)break}return p},c.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},c.prototype.toTwos=function(p){return this.negative!==0?this.abs().inotn(p).iaddn(1):this.clone()},c.prototype.fromTwos=function(p){return this.testn(p-1)?this.notn(p).iaddn(1).ineg():this.clone()},c.prototype.isNeg=function(){return this.negative!==0},c.prototype.neg=function(){return this.clone().ineg()},c.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},c.prototype.iuor=function(p){for(;this.length<p.length;)this.words[this.length++]=0;for(var m=0;m<p.length;m++)this.words[m]=this.words[m]|p.words[m];return this._strip()},c.prototype.ior=function(p){return a((this.negative|p.negative)===0),this.iuor(p)},c.prototype.or=function(p){return this.length>p.length?this.clone().ior(p):p.clone().ior(this)},c.prototype.uor=function(p){return this.length>p.length?this.clone().iuor(p):p.clone().iuor(this)},c.prototype.iuand=function(p){var m;this.length>p.length?m=p:m=this;for(var w=0;w<m.length;w++)this.words[w]=this.words[w]&p.words[w];return this.length=m.length,this._strip()},c.prototype.iand=function(p){return a((this.negative|p.negative)===0),this.iuand(p)},c.prototype.and=function(p){return this.length>p.length?this.clone().iand(p):p.clone().iand(this)},c.prototype.uand=function(p){return this.length>p.length?this.clone().iuand(p):p.clone().iuand(this)},c.prototype.iuxor=function(p){var m,w;this.length>p.length?(m=this,w=p):(m=p,w=this);for(var x=0;x<w.length;x++)this.words[x]=m.words[x]^w.words[x];if(this!==m)for(;x<m.length;x++)this.words[x]=m.words[x];return this.length=m.length,this._strip()},c.prototype.ixor=function(p){return a((this.negative|p.negative)===0),this.iuxor(p)},c.prototype.xor=function(p){return this.length>p.length?this.clone().ixor(p):p.clone().ixor(this)},c.prototype.uxor=function(p){return this.length>p.length?this.clone().iuxor(p):p.clone().iuxor(this)},c.prototype.inotn=function(p){a(typeof p=="number"&&p>=0);var m=Math.ceil(p/26)|0,w=p%26;this._expand(m),w>0&&m--;for(var x=0;x<m;x++)this.words[x]=~this.words[x]&67108863;return w>0&&(this.words[x]=~this.words[x]&67108863>>26-w),this._strip()},c.prototype.notn=function(p){return this.clone().inotn(p)},c.prototype.setn=function(p,m){a(typeof p=="number"&&p>=0);var w=p/26|0,x=p%26;return this._expand(w+1),m?this.words[w]=this.words[w]|1<<x:this.words[w]=this.words[w]&~(1<<x),this._strip()},c.prototype.iadd=function(p){var m;if(this.negative!==0&&p.negative===0)return this.negative=0,m=this.isub(p),this.negative^=1,this._normSign();if(this.negative===0&&p.negative!==0)return p.negative=0,m=this.isub(p),p.negative=1,m._normSign();var w,x;this.length>p.length?(w=this,x=p):(w=p,x=this);for(var b=0,f=0;f<x.length;f++)m=(w.words[f]|0)+(x.words[f]|0)+b,this.words[f]=m&67108863,b=m>>>26;for(;b!==0&&f<w.length;f++)m=(w.words[f]|0)+b,this.words[f]=m&67108863,b=m>>>26;if(this.length=w.length,b!==0)this.words[this.length]=b,this.length++;else if(w!==this)for(;f<w.length;f++)this.words[f]=w.words[f];return this},c.prototype.add=function(p){var m;return p.negative!==0&&this.negative===0?(p.negative=0,m=this.sub(p),p.negative^=1,m):p.negative===0&&this.negative!==0?(this.negative=0,m=p.sub(this),this.negative=1,m):this.length>p.length?this.clone().iadd(p):p.clone().iadd(this)},c.prototype.isub=function(p){if(p.negative!==0){p.negative=0;var m=this.iadd(p);return p.negative=1,m._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(p),this.negative=1,this._normSign();var w=this.cmp(p);if(w===0)return this.negative=0,this.length=1,this.words[0]=0,this;var x,b;w>0?(x=this,b=p):(x=p,b=this);for(var f=0,C=0;C<b.length;C++)m=(x.words[C]|0)-(b.words[C]|0)+f,f=m>>26,this.words[C]=m&67108863;for(;f!==0&&C<x.length;C++)m=(x.words[C]|0)+f,f=m>>26,this.words[C]=m&67108863;if(f===0&&C<x.length&&x!==this)for(;C<x.length;C++)this.words[C]=x.words[C];return this.length=Math.max(this.length,C),x!==this&&(this.negative=1),this._strip()},c.prototype.sub=function(p){return this.clone().isub(p)};function M(d,p,m){m.negative=p.negative^d.negative;var w=d.length+p.length|0;m.length=w,w=w-1|0;var x=d.words[0]|0,b=p.words[0]|0,f=x*b,C=f&67108863,F=f/67108864|0;m.words[0]=C;for(var z=1;z<w;z++){for(var W=F>>>26,$=F&67108863,I=Math.min(z,p.length-1),K=Math.max(0,z-d.length+1);K<=I;K++){var N=z-K|0;x=d.words[N]|0,b=p.words[K]|0,f=x*b+$,W+=f/67108864|0,$=f&67108863}m.words[z]=$|0,F=W|0}return F!==0?m.words[z]=F|0:m.length--,m._strip()}var R=function(p,m,w){var x=p.words,b=m.words,f=w.words,C=0,F,z,W,$=x[0]|0,I=$&8191,K=$>>>13,N=x[1]|0,X=N&8191,Q=N>>>13,L=x[2]|0,V=L&8191,Z=L>>>13,H=x[3]|0,j=H&8191,et=H>>>13,nt=x[4]|0,st=nt&8191,ft=nt>>>13,vt=x[5]|0,ot=vt&8191,pt=vt>>>13,Ut=x[6]|0,At=Ut&8191,It=Ut>>>13,Jt=x[7]|0,at=Jt&8191,J=Jt>>>13,rt=x[8]|0,lt=rt&8191,gt=rt>>>13,Dt=x[9]|0,ut=Dt&8191,Y=Dt>>>13,tt=b[0]|0,dt=tt&8191,mt=tt>>>13,xt=b[1]|0,bt=xt&8191,_t=xt>>>13,Ht=b[2]|0,St=Ht&8191,Mt=Ht>>>13,jt=b[3]|0,Lt=jt&8191,Ft=jt>>>13,te=b[4]|0,Bt=te&8191,Ot=te>>>13,ie=b[5]|0,kt=ie&8191,qt=ie>>>13,ae=b[6]|0,Rt=ae&8191,zt=ae>>>13,he=b[7]|0,Vt=he&8191,Qt=he>>>13,ge=b[8]|0,Gt=ge&8191,$t=ge>>>13,pe=b[9]|0,de=pe&8191,Ee=pe>>>13;w.negative=p.negative^m.negative,w.length=19,F=Math.imul(I,dt),z=Math.imul(I,mt),z=z+Math.imul(K,dt)|0,W=Math.imul(K,mt);var xe=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(xe>>>26)|0,xe&=67108863,F=Math.imul(X,dt),z=Math.imul(X,mt),z=z+Math.imul(Q,dt)|0,W=Math.imul(Q,mt),F=F+Math.imul(I,bt)|0,z=z+Math.imul(I,_t)|0,z=z+Math.imul(K,bt)|0,W=W+Math.imul(K,_t)|0;var Se=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(Se>>>26)|0,Se&=67108863,F=Math.imul(V,dt),z=Math.imul(V,mt),z=z+Math.imul(Z,dt)|0,W=Math.imul(Z,mt),F=F+Math.imul(X,bt)|0,z=z+Math.imul(X,_t)|0,z=z+Math.imul(Q,bt)|0,W=W+Math.imul(Q,_t)|0,F=F+Math.imul(I,St)|0,z=z+Math.imul(I,Mt)|0,z=z+Math.imul(K,St)|0,W=W+Math.imul(K,Mt)|0;var Be=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(Be>>>26)|0,Be&=67108863,F=Math.imul(j,dt),z=Math.imul(j,mt),z=z+Math.imul(et,dt)|0,W=Math.imul(et,mt),F=F+Math.imul(V,bt)|0,z=z+Math.imul(V,_t)|0,z=z+Math.imul(Z,bt)|0,W=W+Math.imul(Z,_t)|0,F=F+Math.imul(X,St)|0,z=z+Math.imul(X,Mt)|0,z=z+Math.imul(Q,St)|0,W=W+Math.imul(Q,Mt)|0,F=F+Math.imul(I,Lt)|0,z=z+Math.imul(I,Ft)|0,z=z+Math.imul(K,Lt)|0,W=W+Math.imul(K,Ft)|0;var Ne=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,F=Math.imul(st,dt),z=Math.imul(st,mt),z=z+Math.imul(ft,dt)|0,W=Math.imul(ft,mt),F=F+Math.imul(j,bt)|0,z=z+Math.imul(j,_t)|0,z=z+Math.imul(et,bt)|0,W=W+Math.imul(et,_t)|0,F=F+Math.imul(V,St)|0,z=z+Math.imul(V,Mt)|0,z=z+Math.imul(Z,St)|0,W=W+Math.imul(Z,Mt)|0,F=F+Math.imul(X,Lt)|0,z=z+Math.imul(X,Ft)|0,z=z+Math.imul(Q,Lt)|0,W=W+Math.imul(Q,Ft)|0,F=F+Math.imul(I,Bt)|0,z=z+Math.imul(I,Ot)|0,z=z+Math.imul(K,Bt)|0,W=W+Math.imul(K,Ot)|0;var qe=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(qe>>>26)|0,qe&=67108863,F=Math.imul(ot,dt),z=Math.imul(ot,mt),z=z+Math.imul(pt,dt)|0,W=Math.imul(pt,mt),F=F+Math.imul(st,bt)|0,z=z+Math.imul(st,_t)|0,z=z+Math.imul(ft,bt)|0,W=W+Math.imul(ft,_t)|0,F=F+Math.imul(j,St)|0,z=z+Math.imul(j,Mt)|0,z=z+Math.imul(et,St)|0,W=W+Math.imul(et,Mt)|0,F=F+Math.imul(V,Lt)|0,z=z+Math.imul(V,Ft)|0,z=z+Math.imul(Z,Lt)|0,W=W+Math.imul(Z,Ft)|0,F=F+Math.imul(X,Bt)|0,z=z+Math.imul(X,Ot)|0,z=z+Math.imul(Q,Bt)|0,W=W+Math.imul(Q,Ot)|0,F=F+Math.imul(I,kt)|0,z=z+Math.imul(I,qt)|0,z=z+Math.imul(K,kt)|0,W=W+Math.imul(K,qt)|0;var Xe=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,F=Math.imul(At,dt),z=Math.imul(At,mt),z=z+Math.imul(It,dt)|0,W=Math.imul(It,mt),F=F+Math.imul(ot,bt)|0,z=z+Math.imul(ot,_t)|0,z=z+Math.imul(pt,bt)|0,W=W+Math.imul(pt,_t)|0,F=F+Math.imul(st,St)|0,z=z+Math.imul(st,Mt)|0,z=z+Math.imul(ft,St)|0,W=W+Math.imul(ft,Mt)|0,F=F+Math.imul(j,Lt)|0,z=z+Math.imul(j,Ft)|0,z=z+Math.imul(et,Lt)|0,W=W+Math.imul(et,Ft)|0,F=F+Math.imul(V,Bt)|0,z=z+Math.imul(V,Ot)|0,z=z+Math.imul(Z,Bt)|0,W=W+Math.imul(Z,Ot)|0,F=F+Math.imul(X,kt)|0,z=z+Math.imul(X,qt)|0,z=z+Math.imul(Q,kt)|0,W=W+Math.imul(Q,qt)|0,F=F+Math.imul(I,Rt)|0,z=z+Math.imul(I,zt)|0,z=z+Math.imul(K,Rt)|0,W=W+Math.imul(K,zt)|0;var Ge=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,F=Math.imul(at,dt),z=Math.imul(at,mt),z=z+Math.imul(J,dt)|0,W=Math.imul(J,mt),F=F+Math.imul(At,bt)|0,z=z+Math.imul(At,_t)|0,z=z+Math.imul(It,bt)|0,W=W+Math.imul(It,_t)|0,F=F+Math.imul(ot,St)|0,z=z+Math.imul(ot,Mt)|0,z=z+Math.imul(pt,St)|0,W=W+Math.imul(pt,Mt)|0,F=F+Math.imul(st,Lt)|0,z=z+Math.imul(st,Ft)|0,z=z+Math.imul(ft,Lt)|0,W=W+Math.imul(ft,Ft)|0,F=F+Math.imul(j,Bt)|0,z=z+Math.imul(j,Ot)|0,z=z+Math.imul(et,Bt)|0,W=W+Math.imul(et,Ot)|0,F=F+Math.imul(V,kt)|0,z=z+Math.imul(V,qt)|0,z=z+Math.imul(Z,kt)|0,W=W+Math.imul(Z,qt)|0,F=F+Math.imul(X,Rt)|0,z=z+Math.imul(X,zt)|0,z=z+Math.imul(Q,Rt)|0,W=W+Math.imul(Q,zt)|0,F=F+Math.imul(I,Vt)|0,z=z+Math.imul(I,Qt)|0,z=z+Math.imul(K,Vt)|0,W=W+Math.imul(K,Qt)|0;var Je=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(Je>>>26)|0,Je&=67108863,F=Math.imul(lt,dt),z=Math.imul(lt,mt),z=z+Math.imul(gt,dt)|0,W=Math.imul(gt,mt),F=F+Math.imul(at,bt)|0,z=z+Math.imul(at,_t)|0,z=z+Math.imul(J,bt)|0,W=W+Math.imul(J,_t)|0,F=F+Math.imul(At,St)|0,z=z+Math.imul(At,Mt)|0,z=z+Math.imul(It,St)|0,W=W+Math.imul(It,Mt)|0,F=F+Math.imul(ot,Lt)|0,z=z+Math.imul(ot,Ft)|0,z=z+Math.imul(pt,Lt)|0,W=W+Math.imul(pt,Ft)|0,F=F+Math.imul(st,Bt)|0,z=z+Math.imul(st,Ot)|0,z=z+Math.imul(ft,Bt)|0,W=W+Math.imul(ft,Ot)|0,F=F+Math.imul(j,kt)|0,z=z+Math.imul(j,qt)|0,z=z+Math.imul(et,kt)|0,W=W+Math.imul(et,qt)|0,F=F+Math.imul(V,Rt)|0,z=z+Math.imul(V,zt)|0,z=z+Math.imul(Z,Rt)|0,W=W+Math.imul(Z,zt)|0,F=F+Math.imul(X,Vt)|0,z=z+Math.imul(X,Qt)|0,z=z+Math.imul(Q,Vt)|0,W=W+Math.imul(Q,Qt)|0,F=F+Math.imul(I,Gt)|0,z=z+Math.imul(I,$t)|0,z=z+Math.imul(K,Gt)|0,W=W+Math.imul(K,$t)|0;var ze=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(ze>>>26)|0,ze&=67108863,F=Math.imul(ut,dt),z=Math.imul(ut,mt),z=z+Math.imul(Y,dt)|0,W=Math.imul(Y,mt),F=F+Math.imul(lt,bt)|0,z=z+Math.imul(lt,_t)|0,z=z+Math.imul(gt,bt)|0,W=W+Math.imul(gt,_t)|0,F=F+Math.imul(at,St)|0,z=z+Math.imul(at,Mt)|0,z=z+Math.imul(J,St)|0,W=W+Math.imul(J,Mt)|0,F=F+Math.imul(At,Lt)|0,z=z+Math.imul(At,Ft)|0,z=z+Math.imul(It,Lt)|0,W=W+Math.imul(It,Ft)|0,F=F+Math.imul(ot,Bt)|0,z=z+Math.imul(ot,Ot)|0,z=z+Math.imul(pt,Bt)|0,W=W+Math.imul(pt,Ot)|0,F=F+Math.imul(st,kt)|0,z=z+Math.imul(st,qt)|0,z=z+Math.imul(ft,kt)|0,W=W+Math.imul(ft,qt)|0,F=F+Math.imul(j,Rt)|0,z=z+Math.imul(j,zt)|0,z=z+Math.imul(et,Rt)|0,W=W+Math.imul(et,zt)|0,F=F+Math.imul(V,Vt)|0,z=z+Math.imul(V,Qt)|0,z=z+Math.imul(Z,Vt)|0,W=W+Math.imul(Z,Qt)|0,F=F+Math.imul(X,Gt)|0,z=z+Math.imul(X,$t)|0,z=z+Math.imul(Q,Gt)|0,W=W+Math.imul(Q,$t)|0,F=F+Math.imul(I,de)|0,z=z+Math.imul(I,Ee)|0,z=z+Math.imul(K,de)|0,W=W+Math.imul(K,Ee)|0;var rr=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(rr>>>26)|0,rr&=67108863,F=Math.imul(ut,bt),z=Math.imul(ut,_t),z=z+Math.imul(Y,bt)|0,W=Math.imul(Y,_t),F=F+Math.imul(lt,St)|0,z=z+Math.imul(lt,Mt)|0,z=z+Math.imul(gt,St)|0,W=W+Math.imul(gt,Mt)|0,F=F+Math.imul(at,Lt)|0,z=z+Math.imul(at,Ft)|0,z=z+Math.imul(J,Lt)|0,W=W+Math.imul(J,Ft)|0,F=F+Math.imul(At,Bt)|0,z=z+Math.imul(At,Ot)|0,z=z+Math.imul(It,Bt)|0,W=W+Math.imul(It,Ot)|0,F=F+Math.imul(ot,kt)|0,z=z+Math.imul(ot,qt)|0,z=z+Math.imul(pt,kt)|0,W=W+Math.imul(pt,qt)|0,F=F+Math.imul(st,Rt)|0,z=z+Math.imul(st,zt)|0,z=z+Math.imul(ft,Rt)|0,W=W+Math.imul(ft,zt)|0,F=F+Math.imul(j,Vt)|0,z=z+Math.imul(j,Qt)|0,z=z+Math.imul(et,Vt)|0,W=W+Math.imul(et,Qt)|0,F=F+Math.imul(V,Gt)|0,z=z+Math.imul(V,$t)|0,z=z+Math.imul(Z,Gt)|0,W=W+Math.imul(Z,$t)|0,F=F+Math.imul(X,de)|0,z=z+Math.imul(X,Ee)|0,z=z+Math.imul(Q,de)|0,W=W+Math.imul(Q,Ee)|0;var Qe=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,F=Math.imul(ut,St),z=Math.imul(ut,Mt),z=z+Math.imul(Y,St)|0,W=Math.imul(Y,Mt),F=F+Math.imul(lt,Lt)|0,z=z+Math.imul(lt,Ft)|0,z=z+Math.imul(gt,Lt)|0,W=W+Math.imul(gt,Ft)|0,F=F+Math.imul(at,Bt)|0,z=z+Math.imul(at,Ot)|0,z=z+Math.imul(J,Bt)|0,W=W+Math.imul(J,Ot)|0,F=F+Math.imul(At,kt)|0,z=z+Math.imul(At,qt)|0,z=z+Math.imul(It,kt)|0,W=W+Math.imul(It,qt)|0,F=F+Math.imul(ot,Rt)|0,z=z+Math.imul(ot,zt)|0,z=z+Math.imul(pt,Rt)|0,W=W+Math.imul(pt,zt)|0,F=F+Math.imul(st,Vt)|0,z=z+Math.imul(st,Qt)|0,z=z+Math.imul(ft,Vt)|0,W=W+Math.imul(ft,Qt)|0,F=F+Math.imul(j,Gt)|0,z=z+Math.imul(j,$t)|0,z=z+Math.imul(et,Gt)|0,W=W+Math.imul(et,$t)|0,F=F+Math.imul(V,de)|0,z=z+Math.imul(V,Ee)|0,z=z+Math.imul(Z,de)|0,W=W+Math.imul(Z,Ee)|0;var Le=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(Le>>>26)|0,Le&=67108863,F=Math.imul(ut,Lt),z=Math.imul(ut,Ft),z=z+Math.imul(Y,Lt)|0,W=Math.imul(Y,Ft),F=F+Math.imul(lt,Bt)|0,z=z+Math.imul(lt,Ot)|0,z=z+Math.imul(gt,Bt)|0,W=W+Math.imul(gt,Ot)|0,F=F+Math.imul(at,kt)|0,z=z+Math.imul(at,qt)|0,z=z+Math.imul(J,kt)|0,W=W+Math.imul(J,qt)|0,F=F+Math.imul(At,Rt)|0,z=z+Math.imul(At,zt)|0,z=z+Math.imul(It,Rt)|0,W=W+Math.imul(It,zt)|0,F=F+Math.imul(ot,Vt)|0,z=z+Math.imul(ot,Qt)|0,z=z+Math.imul(pt,Vt)|0,W=W+Math.imul(pt,Qt)|0,F=F+Math.imul(st,Gt)|0,z=z+Math.imul(st,$t)|0,z=z+Math.imul(ft,Gt)|0,W=W+Math.imul(ft,$t)|0,F=F+Math.imul(j,de)|0,z=z+Math.imul(j,Ee)|0,z=z+Math.imul(et,de)|0,W=W+Math.imul(et,Ee)|0;var ir=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(ir>>>26)|0,ir&=67108863,F=Math.imul(ut,Bt),z=Math.imul(ut,Ot),z=z+Math.imul(Y,Bt)|0,W=Math.imul(Y,Ot),F=F+Math.imul(lt,kt)|0,z=z+Math.imul(lt,qt)|0,z=z+Math.imul(gt,kt)|0,W=W+Math.imul(gt,qt)|0,F=F+Math.imul(at,Rt)|0,z=z+Math.imul(at,zt)|0,z=z+Math.imul(J,Rt)|0,W=W+Math.imul(J,zt)|0,F=F+Math.imul(At,Vt)|0,z=z+Math.imul(At,Qt)|0,z=z+Math.imul(It,Vt)|0,W=W+Math.imul(It,Qt)|0,F=F+Math.imul(ot,Gt)|0,z=z+Math.imul(ot,$t)|0,z=z+Math.imul(pt,Gt)|0,W=W+Math.imul(pt,$t)|0,F=F+Math.imul(st,de)|0,z=z+Math.imul(st,Ee)|0,z=z+Math.imul(ft,de)|0,W=W+Math.imul(ft,Ee)|0;var nr=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(nr>>>26)|0,nr&=67108863,F=Math.imul(ut,kt),z=Math.imul(ut,qt),z=z+Math.imul(Y,kt)|0,W=Math.imul(Y,qt),F=F+Math.imul(lt,Rt)|0,z=z+Math.imul(lt,zt)|0,z=z+Math.imul(gt,Rt)|0,W=W+Math.imul(gt,zt)|0,F=F+Math.imul(at,Vt)|0,z=z+Math.imul(at,Qt)|0,z=z+Math.imul(J,Vt)|0,W=W+Math.imul(J,Qt)|0,F=F+Math.imul(At,Gt)|0,z=z+Math.imul(At,$t)|0,z=z+Math.imul(It,Gt)|0,W=W+Math.imul(It,$t)|0,F=F+Math.imul(ot,de)|0,z=z+Math.imul(ot,Ee)|0,z=z+Math.imul(pt,de)|0,W=W+Math.imul(pt,Ee)|0;var Ze=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,F=Math.imul(ut,Rt),z=Math.imul(ut,zt),z=z+Math.imul(Y,Rt)|0,W=Math.imul(Y,zt),F=F+Math.imul(lt,Vt)|0,z=z+Math.imul(lt,Qt)|0,z=z+Math.imul(gt,Vt)|0,W=W+Math.imul(gt,Qt)|0,F=F+Math.imul(at,Gt)|0,z=z+Math.imul(at,$t)|0,z=z+Math.imul(J,Gt)|0,W=W+Math.imul(J,$t)|0,F=F+Math.imul(At,de)|0,z=z+Math.imul(At,Ee)|0,z=z+Math.imul(It,de)|0,W=W+Math.imul(It,Ee)|0;var ar=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(ar>>>26)|0,ar&=67108863,F=Math.imul(ut,Vt),z=Math.imul(ut,Qt),z=z+Math.imul(Y,Vt)|0,W=Math.imul(Y,Qt),F=F+Math.imul(lt,Gt)|0,z=z+Math.imul(lt,$t)|0,z=z+Math.imul(gt,Gt)|0,W=W+Math.imul(gt,$t)|0,F=F+Math.imul(at,de)|0,z=z+Math.imul(at,Ee)|0,z=z+Math.imul(J,de)|0,W=W+Math.imul(J,Ee)|0;var yt=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(yt>>>26)|0,yt&=67108863,F=Math.imul(ut,Gt),z=Math.imul(ut,$t),z=z+Math.imul(Y,Gt)|0,W=Math.imul(Y,$t),F=F+Math.imul(lt,de)|0,z=z+Math.imul(lt,Ee)|0,z=z+Math.imul(gt,de)|0,W=W+Math.imul(gt,Ee)|0;var it=(C+F|0)+((z&8191)<<13)|0;C=(W+(z>>>13)|0)+(it>>>26)|0,it&=67108863,F=Math.imul(ut,de),z=Math.imul(ut,Ee),z=z+Math.imul(Y,de)|0,W=Math.imul(Y,Ee);var ct=(C+F|0)+((z&8191)<<13)|0;return C=(W+(z>>>13)|0)+(ct>>>26)|0,ct&=67108863,f[0]=xe,f[1]=Se,f[2]=Be,f[3]=Ne,f[4]=qe,f[5]=Xe,f[6]=Ge,f[7]=Je,f[8]=ze,f[9]=rr,f[10]=Qe,f[11]=Le,f[12]=ir,f[13]=nr,f[14]=Ze,f[15]=ar,f[16]=yt,f[17]=it,f[18]=ct,C!==0&&(f[19]=C,w.length++),w};Math.imul||(R=M);function P(d,p,m){m.negative=p.negative^d.negative,m.length=d.length+p.length;for(var w=0,x=0,b=0;b<m.length-1;b++){var f=x;x=0;for(var C=w&67108863,F=Math.min(b,p.length-1),z=Math.max(0,b-d.length+1);z<=F;z++){var W=b-z,$=d.words[W]|0,I=p.words[z]|0,K=$*I,N=K&67108863;f=f+(K/67108864|0)|0,N=N+C|0,C=N&67108863,f=f+(N>>>26)|0,x+=f>>>26,f&=67108863}m.words[b]=C,w=f,f=x}return w!==0?m.words[b]=w:m.length--,m._strip()}function D(d,p,m){return P(d,p,m)}c.prototype.mulTo=function(p,m){var w,x=this.length+p.length;return this.length===10&&p.length===10?w=R(this,p,m):x<63?w=M(this,p,m):x<1024?w=P(this,p,m):w=D(this,p,m),w},c.prototype.mul=function(p){var m=new c(null);return m.words=new Array(this.length+p.length),this.mulTo(p,m)},c.prototype.mulf=function(p){var m=new c(null);return m.words=new Array(this.length+p.length),D(this,p,m)},c.prototype.imul=function(p){return this.clone().mulTo(p,this)},c.prototype.imuln=function(p){var m=p<0;m&&(p=-p),a(typeof p=="number"),a(p<67108864);for(var w=0,x=0;x<this.length;x++){var b=(this.words[x]|0)*p,f=(b&67108863)+(w&67108863);w>>=26,w+=b/67108864|0,w+=f>>>26,this.words[x]=f&67108863}return w!==0&&(this.words[x]=w,this.length++),m?this.ineg():this},c.prototype.muln=function(p){return this.clone().imuln(p)},c.prototype.sqr=function(){return this.mul(this)},c.prototype.isqr=function(){return this.imul(this.clone())},c.prototype.pow=function(p){var m=B(p);if(m.length===0)return new c(1);for(var w=this,x=0;x<m.length&&m[x]===0;x++,w=w.sqr());if(++x<m.length)for(var b=w.sqr();x<m.length;x++,b=b.sqr())m[x]!==0&&(w=w.mul(b));return w},c.prototype.iushln=function(p){a(typeof p=="number"&&p>=0);var m=p%26,w=(p-m)/26,x=67108863>>>26-m<<26-m,b;if(m!==0){var f=0;for(b=0;b<this.length;b++){var C=this.words[b]&x,F=(this.words[b]|0)-C<<m;this.words[b]=F|f,f=C>>>26-m}f&&(this.words[b]=f,this.length++)}if(w!==0){for(b=this.length-1;b>=0;b--)this.words[b+w]=this.words[b];for(b=0;b<w;b++)this.words[b]=0;this.length+=w}return this._strip()},c.prototype.ishln=function(p){return a(this.negative===0),this.iushln(p)},c.prototype.iushrn=function(p,m,w){a(typeof p=="number"&&p>=0);var x;m?x=(m-m%26)/26:x=0;var b=p%26,f=Math.min((p-b)/26,this.length),C=67108863^67108863>>>b<<b,F=w;if(x-=f,x=Math.max(0,x),F){for(var z=0;z<f;z++)F.words[z]=this.words[z];F.length=f}if(f!==0)if(this.length>f)for(this.length-=f,z=0;z<this.length;z++)this.words[z]=this.words[z+f];else this.words[0]=0,this.length=1;var W=0;for(z=this.length-1;z>=0&&(W!==0||z>=x);z--){var $=this.words[z]|0;this.words[z]=W<<26-b|$>>>b,W=$&C}return F&&W!==0&&(F.words[F.length++]=W),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},c.prototype.ishrn=function(p,m,w){return a(this.negative===0),this.iushrn(p,m,w)},c.prototype.shln=function(p){return this.clone().ishln(p)},c.prototype.ushln=function(p){return this.clone().iushln(p)},c.prototype.shrn=function(p){return this.clone().ishrn(p)},c.prototype.ushrn=function(p){return this.clone().iushrn(p)},c.prototype.testn=function(p){a(typeof p=="number"&&p>=0);var m=p%26,w=(p-m)/26,x=1<<m;if(this.length<=w)return!1;var b=this.words[w];return!!(b&x)},c.prototype.imaskn=function(p){a(typeof p=="number"&&p>=0);var m=p%26,w=(p-m)/26;if(a(this.negative===0,"imaskn works only with positive numbers"),this.length<=w)return this;if(m!==0&&w++,this.length=Math.min(w,this.length),m!==0){var x=67108863^67108863>>>m<<m;this.words[this.length-1]&=x}return this._strip()},c.prototype.maskn=function(p){return this.clone().imaskn(p)},c.prototype.iaddn=function(p){return a(typeof p=="number"),a(p<67108864),p<0?this.isubn(-p):this.negative!==0?this.length===1&&(this.words[0]|0)<=p?(this.words[0]=p-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(p),this.negative=1,this):this._iaddn(p)},c.prototype._iaddn=function(p){this.words[0]+=p;for(var m=0;m<this.length&&this.words[m]>=67108864;m++)this.words[m]-=67108864,m===this.length-1?this.words[m+1]=1:this.words[m+1]++;return this.length=Math.max(this.length,m+1),this},c.prototype.isubn=function(p){if(a(typeof p=="number"),a(p<67108864),p<0)return this.iaddn(-p);if(this.negative!==0)return this.negative=0,this.iaddn(p),this.negative=1,this;if(this.words[0]-=p,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var m=0;m<this.length&&this.words[m]<0;m++)this.words[m]+=67108864,this.words[m+1]-=1;return this._strip()},c.prototype.addn=function(p){return this.clone().iaddn(p)},c.prototype.subn=function(p){return this.clone().isubn(p)},c.prototype.iabs=function(){return this.negative=0,this},c.prototype.abs=function(){return this.clone().iabs()},c.prototype._ishlnsubmul=function(p,m,w){var x=p.length+w,b;this._expand(x);var f,C=0;for(b=0;b<p.length;b++){f=(this.words[b+w]|0)+C;var F=(p.words[b]|0)*m;f-=F&67108863,C=(f>>26)-(F/67108864|0),this.words[b+w]=f&67108863}for(;b<this.length-w;b++)f=(this.words[b+w]|0)+C,C=f>>26,this.words[b+w]=f&67108863;if(C===0)return this._strip();for(a(C===-1),C=0,b=0;b<this.length;b++)f=-(this.words[b]|0)+C,C=f>>26,this.words[b]=f&67108863;return this.negative=1,this._strip()},c.prototype._wordDiv=function(p,m){var w=this.length-p.length,x=this.clone(),b=p,f=b.words[b.length-1]|0,C=this._countBits(f);w=26-C,w!==0&&(b=b.ushln(w),x.iushln(w),f=b.words[b.length-1]|0);var F=x.length-b.length,z;if(m!=="mod"){z=new c(null),z.length=F+1,z.words=new Array(z.length);for(var W=0;W<z.length;W++)z.words[W]=0}var $=x.clone()._ishlnsubmul(b,1,F);$.negative===0&&(x=$,z&&(z.words[F]=1));for(var I=F-1;I>=0;I--){var K=(x.words[b.length+I]|0)*67108864+(x.words[b.length+I-1]|0);for(K=Math.min(K/f|0,67108863),x._ishlnsubmul(b,K,I);x.negative!==0;)K--,x.negative=0,x._ishlnsubmul(b,1,I),x.isZero()||(x.negative^=1);z&&(z.words[I]=K)}return z&&z._strip(),x._strip(),m!=="div"&&w!==0&&x.iushrn(w),{div:z||null,mod:x}},c.prototype.divmod=function(p,m,w){if(a(!p.isZero()),this.isZero())return{div:new c(0),mod:new c(0)};var x,b,f;return this.negative!==0&&p.negative===0?(f=this.neg().divmod(p,m),m!=="mod"&&(x=f.div.neg()),m!=="div"&&(b=f.mod.neg(),w&&b.negative!==0&&b.iadd(p)),{div:x,mod:b}):this.negative===0&&p.negative!==0?(f=this.divmod(p.neg(),m),m!=="mod"&&(x=f.div.neg()),{div:x,mod:f.mod}):this.negative&p.negative?(f=this.neg().divmod(p.neg(),m),m!=="div"&&(b=f.mod.neg(),w&&b.negative!==0&&b.isub(p)),{div:f.div,mod:b}):p.length>this.length||this.cmp(p)<0?{div:new c(0),mod:this}:p.length===1?m==="div"?{div:this.divn(p.words[0]),mod:null}:m==="mod"?{div:null,mod:new c(this.modrn(p.words[0]))}:{div:this.divn(p.words[0]),mod:new c(this.modrn(p.words[0]))}:this._wordDiv(p,m)},c.prototype.div=function(p){return this.divmod(p,"div",!1).div},c.prototype.mod=function(p){return this.divmod(p,"mod",!1).mod},c.prototype.umod=function(p){return this.divmod(p,"mod",!0).mod},c.prototype.divRound=function(p){var m=this.divmod(p);if(m.mod.isZero())return m.div;var w=m.div.negative!==0?m.mod.isub(p):m.mod,x=p.ushrn(1),b=p.andln(1),f=w.cmp(x);return f<0||b===1&&f===0?m.div:m.div.negative!==0?m.div.isubn(1):m.div.iaddn(1)},c.prototype.modrn=function(p){var m=p<0;m&&(p=-p),a(p<=67108863);for(var w=(1<<26)%p,x=0,b=this.length-1;b>=0;b--)x=(w*x+(this.words[b]|0))%p;return m?-x:x},c.prototype.modn=function(p){return this.modrn(p)},c.prototype.idivn=function(p){var m=p<0;m&&(p=-p),a(p<=67108863);for(var w=0,x=this.length-1;x>=0;x--){var b=(this.words[x]|0)+w*67108864;this.words[x]=b/p|0,w=b%p}return this._strip(),m?this.ineg():this},c.prototype.divn=function(p){return this.clone().idivn(p)},c.prototype.egcd=function(p){a(p.negative===0),a(!p.isZero());var m=this,w=p.clone();m.negative!==0?m=m.umod(p):m=m.clone();for(var x=new c(1),b=new c(0),f=new c(0),C=new c(1),F=0;m.isEven()&&w.isEven();)m.iushrn(1),w.iushrn(1),++F;for(var z=w.clone(),W=m.clone();!m.isZero();){for(var $=0,I=1;!(m.words[0]&I)&&$<26;++$,I<<=1);if($>0)for(m.iushrn($);$-- >0;)(x.isOdd()||b.isOdd())&&(x.iadd(z),b.isub(W)),x.iushrn(1),b.iushrn(1);for(var K=0,N=1;!(w.words[0]&N)&&K<26;++K,N<<=1);if(K>0)for(w.iushrn(K);K-- >0;)(f.isOdd()||C.isOdd())&&(f.iadd(z),C.isub(W)),f.iushrn(1),C.iushrn(1);m.cmp(w)>=0?(m.isub(w),x.isub(f),b.isub(C)):(w.isub(m),f.isub(x),C.isub(b))}return{a:f,b:C,gcd:w.iushln(F)}},c.prototype._invmp=function(p){a(p.negative===0),a(!p.isZero());var m=this,w=p.clone();m.negative!==0?m=m.umod(p):m=m.clone();for(var x=new c(1),b=new c(0),f=w.clone();m.cmpn(1)>0&&w.cmpn(1)>0;){for(var C=0,F=1;!(m.words[0]&F)&&C<26;++C,F<<=1);if(C>0)for(m.iushrn(C);C-- >0;)x.isOdd()&&x.iadd(f),x.iushrn(1);for(var z=0,W=1;!(w.words[0]&W)&&z<26;++z,W<<=1);if(z>0)for(w.iushrn(z);z-- >0;)b.isOdd()&&b.iadd(f),b.iushrn(1);m.cmp(w)>=0?(m.isub(w),x.isub(b)):(w.isub(m),b.isub(x))}var $;return m.cmpn(1)===0?$=x:$=b,$.cmpn(0)<0&&$.iadd(p),$},c.prototype.gcd=function(p){if(this.isZero())return p.abs();if(p.isZero())return this.abs();var m=this.clone(),w=p.clone();m.negative=0,w.negative=0;for(var x=0;m.isEven()&&w.isEven();x++)m.iushrn(1),w.iushrn(1);do{for(;m.isEven();)m.iushrn(1);for(;w.isEven();)w.iushrn(1);var b=m.cmp(w);if(b<0){var f=m;m=w,w=f}else if(b===0||w.cmpn(1)===0)break;m.isub(w)}while(!0);return w.iushln(x)},c.prototype.invm=function(p){return this.egcd(p).a.umod(p)},c.prototype.isEven=function(){return(this.words[0]&1)===0},c.prototype.isOdd=function(){return(this.words[0]&1)===1},c.prototype.andln=function(p){return this.words[0]&p},c.prototype.bincn=function(p){a(typeof p=="number");var m=p%26,w=(p-m)/26,x=1<<m;if(this.length<=w)return this._expand(w+1),this.words[w]|=x,this;for(var b=x,f=w;b!==0&&f<this.length;f++){var C=this.words[f]|0;C+=b,b=C>>>26,C&=67108863,this.words[f]=C}return b!==0&&(this.words[f]=b,this.length++),this},c.prototype.isZero=function(){return this.length===1&&this.words[0]===0},c.prototype.cmpn=function(p){var m=p<0;if(this.negative!==0&&!m)return-1;if(this.negative===0&&m)return 1;this._strip();var w;if(this.length>1)w=1;else{m&&(p=-p),a(p<=67108863,"Number is too big");var x=this.words[0]|0;w=x===p?0:x<p?-1:1}return this.negative!==0?-w|0:w},c.prototype.cmp=function(p){if(this.negative!==0&&p.negative===0)return-1;if(this.negative===0&&p.negative!==0)return 1;var m=this.ucmp(p);return this.negative!==0?-m|0:m},c.prototype.ucmp=function(p){if(this.length>p.length)return 1;if(this.length<p.length)return-1;for(var m=0,w=this.length-1;w>=0;w--){var x=this.words[w]|0,b=p.words[w]|0;if(x!==b){x<b?m=-1:x>b&&(m=1);break}}return m},c.prototype.gtn=function(p){return this.cmpn(p)===1},c.prototype.gt=function(p){return this.cmp(p)===1},c.prototype.gten=function(p){return this.cmpn(p)>=0},c.prototype.gte=function(p){return this.cmp(p)>=0},c.prototype.ltn=function(p){return this.cmpn(p)===-1},c.prototype.lt=function(p){return this.cmp(p)===-1},c.prototype.lten=function(p){return this.cmpn(p)<=0},c.prototype.lte=function(p){return this.cmp(p)<=0},c.prototype.eqn=function(p){return this.cmpn(p)===0},c.prototype.eq=function(p){return this.cmp(p)===0},c.red=function(p){return new s(p)},c.prototype.toRed=function(p){return a(!this.red,"Already a number in reduction context"),a(this.negative===0,"red works only with positives"),p.convertTo(this)._forceRed(p)},c.prototype.fromRed=function(){return a(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},c.prototype._forceRed=function(p){return this.red=p,this},c.prototype.forceRed=function(p){return a(!this.red,"Already a number in reduction context"),this._forceRed(p)},c.prototype.redAdd=function(p){return a(this.red,"redAdd works only with red numbers"),this.red.add(this,p)},c.prototype.redIAdd=function(p){return a(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,p)},c.prototype.redSub=function(p){return a(this.red,"redSub works only with red numbers"),this.red.sub(this,p)},c.prototype.redISub=function(p){return a(this.red,"redISub works only with red numbers"),this.red.isub(this,p)},c.prototype.redShl=function(p){return a(this.red,"redShl works only with red numbers"),this.red.shl(this,p)},c.prototype.redMul=function(p){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,p),this.red.mul(this,p)},c.prototype.redIMul=function(p){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,p),this.red.imul(this,p)},c.prototype.redSqr=function(){return a(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},c.prototype.redISqr=function(){return a(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},c.prototype.redSqrt=function(){return a(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},c.prototype.redInvm=function(){return a(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},c.prototype.redNeg=function(){return a(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},c.prototype.redPow=function(p){return a(this.red&&!p.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,p)};var q={k256:null,p224:null,p192:null,p25519:null};function k(d,p){this.name=d,this.p=new c(p,16),this.n=this.p.bitLength(),this.k=new c(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}k.prototype._tmp=function(){var p=new c(null);return p.words=new Array(Math.ceil(this.n/13)),p},k.prototype.ireduce=function(p){var m=p,w;do this.split(m,this.tmp),m=this.imulK(m),m=m.iadd(this.tmp),w=m.bitLength();while(w>this.n);var x=w<this.n?-1:m.ucmp(this.p);return x===0?(m.words[0]=0,m.length=1):x>0?m.isub(this.p):m.strip!==void 0?m.strip():m._strip(),m},k.prototype.split=function(p,m){p.iushrn(this.n,0,m)},k.prototype.imulK=function(p){return p.imul(this.k)};function U(){k.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(U,k),U.prototype.split=function(p,m){for(var w=4194303,x=Math.min(p.length,9),b=0;b<x;b++)m.words[b]=p.words[b];if(m.length=x,p.length<=9){p.words[0]=0,p.length=1;return}var f=p.words[9];for(m.words[m.length++]=f&w,b=10;b<p.length;b++){var C=p.words[b]|0;p.words[b-10]=(C&w)<<4|f>>>22,f=C}f>>>=22,p.words[b-10]=f,f===0&&p.length>10?p.length-=10:p.length-=9},U.prototype.imulK=function(p){p.words[p.length]=0,p.words[p.length+1]=0,p.length+=2;for(var m=0,w=0;w<p.length;w++){var x=p.words[w]|0;m+=x*977,p.words[w]=m&67108863,m=x*64+(m/67108864|0)}return p.words[p.length-1]===0&&(p.length--,p.words[p.length-1]===0&&p.length--),p};function O(){k.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(O,k);function G(){k.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(G,k);function E(){k.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(E,k),E.prototype.imulK=function(p){for(var m=0,w=0;w<p.length;w++){var x=(p.words[w]|0)*19+m,b=x&67108863;x>>>=26,p.words[w]=b,m=x}return m!==0&&(p.words[p.length++]=m),p},c._prime=function(p){if(q[p])return q[p];var m;if(p==="k256")m=new U;else if(p==="p224")m=new O;else if(p==="p192")m=new G;else if(p==="p25519")m=new E;else throw new Error("Unknown prime "+p);return q[p]=m,m};function s(d){if(typeof d=="string"){var p=c._prime(d);this.m=p.p,this.prime=p}else a(d.gtn(1),"modulus must be greater than 1"),this.m=d,this.prime=null}s.prototype._verify1=function(p){a(p.negative===0,"red works only with positives"),a(p.red,"red works only with red numbers")},s.prototype._verify2=function(p,m){a((p.negative|m.negative)===0,"red works only with positives"),a(p.red&&p.red===m.red,"red works only with red numbers")},s.prototype.imod=function(p){return this.prime?this.prime.ireduce(p)._forceRed(this):(g(p,p.umod(this.m)._forceRed(this)),p)},s.prototype.neg=function(p){return p.isZero()?p.clone():this.m.sub(p)._forceRed(this)},s.prototype.add=function(p,m){this._verify2(p,m);var w=p.add(m);return w.cmp(this.m)>=0&&w.isub(this.m),w._forceRed(this)},s.prototype.iadd=function(p,m){this._verify2(p,m);var w=p.iadd(m);return w.cmp(this.m)>=0&&w.isub(this.m),w},s.prototype.sub=function(p,m){this._verify2(p,m);var w=p.sub(m);return w.cmpn(0)<0&&w.iadd(this.m),w._forceRed(this)},s.prototype.isub=function(p,m){this._verify2(p,m);var w=p.isub(m);return w.cmpn(0)<0&&w.iadd(this.m),w},s.prototype.shl=function(p,m){return this._verify1(p),this.imod(p.ushln(m))},s.prototype.imul=function(p,m){return this._verify2(p,m),this.imod(p.imul(m))},s.prototype.mul=function(p,m){return this._verify2(p,m),this.imod(p.mul(m))},s.prototype.isqr=function(p){return this.imul(p,p.clone())},s.prototype.sqr=function(p){return this.mul(p,p)},s.prototype.sqrt=function(p){if(p.isZero())return p.clone();var m=this.m.andln(3);if(a(m%2===1),m===3){var w=this.m.add(new c(1)).iushrn(2);return this.pow(p,w)}for(var x=this.m.subn(1),b=0;!x.isZero()&&x.andln(1)===0;)b++,x.iushrn(1);a(!x.isZero());var f=new c(1).toRed(this),C=f.redNeg(),F=this.m.subn(1).iushrn(1),z=this.m.bitLength();for(z=new c(2*z*z).toRed(this);this.pow(z,F).cmp(C)!==0;)z.redIAdd(C);for(var W=this.pow(z,x),$=this.pow(p,x.addn(1).iushrn(1)),I=this.pow(p,x),K=b;I.cmp(f)!==0;){for(var N=I,X=0;N.cmp(f)!==0;X++)N=N.redSqr();a(X<K);var Q=this.pow(W,new c(1).iushln(K-X-1));$=$.redMul(Q),W=Q.redSqr(),I=I.redMul(W),K=X}return $},s.prototype.invm=function(p){var m=p._invmp(this.m);return m.negative!==0?(m.negative=0,this.imod(m).redNeg()):this.imod(m)},s.prototype.pow=function(p,m){if(m.isZero())return new c(1).toRed(this);if(m.cmpn(1)===0)return p.clone();var w=4,x=new Array(1<<w);x[0]=new c(1).toRed(this),x[1]=p;for(var b=2;b<x.length;b++)x[b]=this.mul(x[b-1],p);var f=x[0],C=0,F=0,z=m.bitLength()%26;for(z===0&&(z=26),b=m.length-1;b>=0;b--){for(var W=m.words[b],$=z-1;$>=0;$--){var I=W>>$&1;if(f!==x[0]&&(f=this.sqr(f)),I===0&&C===0){F=0;continue}C<<=1,C|=I,F++,!(F!==w&&(b!==0||$!==0))&&(f=this.mul(f,x[C]),F=0,C=0)}z=26}return f},s.prototype.convertTo=function(p){var m=p.umod(this.m);return m===p?m.clone():m},s.prototype.convertFrom=function(p){var m=p.clone();return m.red=null,m},c.mont=function(p){return new l(p)};function l(d){s.call(this,d),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new c(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(l,s),l.prototype.convertTo=function(p){return this.imod(p.ushln(this.shift))},l.prototype.convertFrom=function(p){var m=this.imod(p.mul(this.rinv));return m.red=null,m},l.prototype.imul=function(p,m){if(p.isZero()||m.isZero())return p.words[0]=0,p.length=1,p;var w=p.imul(m),x=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=w.isub(x).iushrn(this.shift),f=b;return b.cmp(this.m)>=0?f=b.isub(this.m):b.cmpn(0)<0&&(f=b.iadd(this.m)),f._forceRed(this)},l.prototype.mul=function(p,m){if(p.isZero()||m.isZero())return new c(0)._forceRed(this);var w=p.mul(m),x=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),b=w.isub(x).iushrn(this.shift),f=b;return b.cmp(this.m)>=0?f=b.isub(this.m):b.cmpn(0)<0&&(f=b.iadd(this.m)),f._forceRed(this)},l.prototype.invm=function(p){var m=this.imod(p._invmp(this.m).mul(this.r2));return m._forceRed(this)}})(typeof e>"u"||e,i)}}),rM=Ve({"../../node_modules/js-sha3/src/sha3.js"(i,e){(function(){var r="input is invalid type",t="finalize already called",a=typeof window=="object",n=a?window:{};n.JS_SHA3_NO_WINDOW&&(a=!1);var c=!a&&typeof self=="object",u=!n.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;u?n=globalThis:c&&(n=self);var v=!n.JS_SHA3_NO_COMMON_JS&&typeof e=="object"&&e.exports,o=!n.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",h="0123456789abcdef".split(""),g=[31,7936,2031616,520093696],y=[4,1024,262144,67108864],_=[1,256,65536,16777216],A=[6,1536,393216,100663296],S=[0,8,16,24],T=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],B=[224,256,384,512],M=[128,256],R=["hex","buffer","arrayBuffer","array","digest"],P={128:168,256:136};(n.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(I){return Object.prototype.toString.call(I)==="[object Array]"}),o&&(n.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(I){return typeof I=="object"&&I.buffer&&I.buffer.constructor===ArrayBuffer});for(var D=function(I,K,N){return function(X){return new z(I,K,I).update(X)[N]()}},q=function(I,K,N){return function(X,Q){return new z(I,K,Q).update(X)[N]()}},k=function(I,K,N){return function(X,Q,L,V){return p["cshake"+I].update(X,Q,L,V)[N]()}},U=function(I,K,N){return function(X,Q,L,V){return p["kmac"+I].update(X,Q,L,V)[N]()}},O=function(I,K,N,X){for(var Q=0;Q<R.length;++Q){var L=R[Q];I[L]=K(N,X,L)}return I},G=function(I,K){var N=D(I,K,"hex");return N.create=function(){return new z(I,K,I)},N.update=function(X){return N.create().update(X)},O(N,D,I,K)},E=function(I,K){var N=q(I,K,"hex");return N.create=function(X){return new z(I,K,X)},N.update=function(X,Q){return N.create(Q).update(X)},O(N,q,I,K)},s=function(I,K){var N=P[I],X=k(I,K,"hex");return X.create=function(Q,L,V){return!L&&!V?p["shake"+I].create(Q):new z(I,K,Q).bytepad([L,V],N)},X.update=function(Q,L,V,Z){return X.create(L,V,Z).update(Q)},O(X,k,I,K)},l=function(I,K){var N=P[I],X=U(I,K,"hex");return X.create=function(Q,L,V){return new W(I,K,L).bytepad(["KMAC",V],N).bytepad([Q],N)},X.update=function(Q,L,V,Z){return X.create(Q,V,Z).update(L)},O(X,U,I,K)},d=[{name:"keccak",padding:_,bits:B,createMethod:G},{name:"sha3",padding:A,bits:B,createMethod:G},{name:"shake",padding:g,bits:M,createMethod:E},{name:"cshake",padding:y,bits:M,createMethod:s},{name:"kmac",padding:y,bits:M,createMethod:l}],p={},m=[],w=0;w<d.length;++w)for(var x=d[w],b=x.bits,f=0;f<b.length;++f){var C=x.name+"_"+b[f];if(m.push(C),p[C]=x.createMethod(b[f],x.padding),x.name!=="sha3"){var F=x.name+b[f];m.push(F),p[F]=p[C]}}function z(I,K,N){this.blocks=[],this.s=[],this.padding=K,this.outputBits=N,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(I<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=N>>5,this.extraBytes=(N&31)>>3;for(var X=0;X<50;++X)this.s[X]=0}z.prototype.update=function(I){if(this.finalized)throw new Error(t);var K,N=typeof I;if(N!=="string"){if(N==="object"){if(I===null)throw new Error(r);if(o&&I.constructor===ArrayBuffer)I=new Uint8Array(I);else if(!Array.isArray(I)&&(!o||!ArrayBuffer.isView(I)))throw new Error(r)}else throw new Error(r);K=!0}for(var X=this.blocks,Q=this.byteCount,L=I.length,V=this.blockCount,Z=0,H=this.s,j,et;Z<L;){if(this.reset)for(this.reset=!1,X[0]=this.block,j=1;j<V+1;++j)X[j]=0;if(K)for(j=this.start;Z<L&&j<Q;++Z)X[j>>2]|=I[Z]<<S[j++&3];else for(j=this.start;Z<L&&j<Q;++Z)et=I.charCodeAt(Z),et<128?X[j>>2]|=et<<S[j++&3]:et<2048?(X[j>>2]|=(192|et>>6)<<S[j++&3],X[j>>2]|=(128|et&63)<<S[j++&3]):et<55296||et>=57344?(X[j>>2]|=(224|et>>12)<<S[j++&3],X[j>>2]|=(128|et>>6&63)<<S[j++&3],X[j>>2]|=(128|et&63)<<S[j++&3]):(et=65536+((et&1023)<<10|I.charCodeAt(++Z)&1023),X[j>>2]|=(240|et>>18)<<S[j++&3],X[j>>2]|=(128|et>>12&63)<<S[j++&3],X[j>>2]|=(128|et>>6&63)<<S[j++&3],X[j>>2]|=(128|et&63)<<S[j++&3]);if(this.lastByteIndex=j,j>=Q){for(this.start=j-Q,this.block=X[V],j=0;j<V;++j)H[j]^=X[j];$(H),this.reset=!0}else this.start=j}return this},z.prototype.encode=function(I,K){var N=I&255,X=1,Q=[N];for(I=I>>8,N=I&255;N>0;)Q.unshift(N),I=I>>8,N=I&255,++X;return K?Q.push(X):Q.unshift(X),this.update(Q),Q.length},z.prototype.encodeString=function(I){var K,N=typeof I;if(N!=="string"){if(N==="object"){if(I===null)throw new Error(r);if(o&&I.constructor===ArrayBuffer)I=new Uint8Array(I);else if(!Array.isArray(I)&&(!o||!ArrayBuffer.isView(I)))throw new Error(r)}else throw new Error(r);K=!0}var X=0,Q=I.length;if(K)X=Q;else for(var L=0;L<I.length;++L){var V=I.charCodeAt(L);V<128?X+=1:V<2048?X+=2:V<55296||V>=57344?X+=3:(V=65536+((V&1023)<<10|I.charCodeAt(++L)&1023),X+=4)}return X+=this.encode(X*8),this.update(I),X},z.prototype.bytepad=function(I,K){for(var N=this.encode(K),X=0;X<I.length;++X)N+=this.encodeString(I[X]);var Q=K-N%K,L=[];return L.length=Q,this.update(L),this},z.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var I=this.blocks,K=this.lastByteIndex,N=this.blockCount,X=this.s;if(I[K>>2]|=this.padding[K&3],this.lastByteIndex===this.byteCount)for(I[0]=I[N],K=1;K<N+1;++K)I[K]=0;for(I[N-1]|=2147483648,K=0;K<N;++K)X[K]^=I[K];$(X)}},z.prototype.toString=z.prototype.hex=function(){this.finalize();for(var I=this.blockCount,K=this.s,N=this.outputBlocks,X=this.extraBytes,Q=0,L=0,V="",Z;L<N;){for(Q=0;Q<I&&L<N;++Q,++L)Z=K[Q],V+=h[Z>>4&15]+h[Z&15]+h[Z>>12&15]+h[Z>>8&15]+h[Z>>20&15]+h[Z>>16&15]+h[Z>>28&15]+h[Z>>24&15];L%I===0&&($(K),Q=0)}return X&&(Z=K[Q],V+=h[Z>>4&15]+h[Z&15],X>1&&(V+=h[Z>>12&15]+h[Z>>8&15]),X>2&&(V+=h[Z>>20&15]+h[Z>>16&15])),V},z.prototype.arrayBuffer=function(){this.finalize();var I=this.blockCount,K=this.s,N=this.outputBlocks,X=this.extraBytes,Q=0,L=0,V=this.outputBits>>3,Z;X?Z=new ArrayBuffer(N+1<<2):Z=new ArrayBuffer(V);for(var H=new Uint32Array(Z);L<N;){for(Q=0;Q<I&&L<N;++Q,++L)H[L]=K[Q];L%I===0&&$(K)}return X&&(H[Q]=K[Q],Z=Z.slice(0,V)),Z},z.prototype.buffer=z.prototype.arrayBuffer,z.prototype.digest=z.prototype.array=function(){this.finalize();for(var I=this.blockCount,K=this.s,N=this.outputBlocks,X=this.extraBytes,Q=0,L=0,V=[],Z,H;L<N;){for(Q=0;Q<I&&L<N;++Q,++L)Z=L<<2,H=K[Q],V[Z]=H&255,V[Z+1]=H>>8&255,V[Z+2]=H>>16&255,V[Z+3]=H>>24&255;L%I===0&&$(K)}return X&&(Z=L<<2,H=K[Q],V[Z]=H&255,X>1&&(V[Z+1]=H>>8&255),X>2&&(V[Z+2]=H>>16&255)),V};function W(I,K,N){z.call(this,I,K,N)}W.prototype=new z,W.prototype.finalize=function(){return this.encode(this.outputBits,!0),z.prototype.finalize.call(this)};var $=function(I){var K,N,X,Q,L,V,Z,H,j,et,nt,st,ft,vt,ot,pt,Ut,At,It,Jt,at,J,rt,lt,gt,Dt,ut,Y,tt,dt,mt,xt,bt,_t,Ht,St,Mt,jt,Lt,Ft,te,Bt,Ot,ie,kt,qt,ae,Rt,zt,he,Vt,Qt,ge,Gt,$t,pe,de,Ee,xe,Se,Be,Ne,qe;for(X=0;X<48;X+=2)Q=I[0]^I[10]^I[20]^I[30]^I[40],L=I[1]^I[11]^I[21]^I[31]^I[41],V=I[2]^I[12]^I[22]^I[32]^I[42],Z=I[3]^I[13]^I[23]^I[33]^I[43],H=I[4]^I[14]^I[24]^I[34]^I[44],j=I[5]^I[15]^I[25]^I[35]^I[45],et=I[6]^I[16]^I[26]^I[36]^I[46],nt=I[7]^I[17]^I[27]^I[37]^I[47],st=I[8]^I[18]^I[28]^I[38]^I[48],ft=I[9]^I[19]^I[29]^I[39]^I[49],K=st^(V<<1|Z>>>31),N=ft^(Z<<1|V>>>31),I[0]^=K,I[1]^=N,I[10]^=K,I[11]^=N,I[20]^=K,I[21]^=N,I[30]^=K,I[31]^=N,I[40]^=K,I[41]^=N,K=Q^(H<<1|j>>>31),N=L^(j<<1|H>>>31),I[2]^=K,I[3]^=N,I[12]^=K,I[13]^=N,I[22]^=K,I[23]^=N,I[32]^=K,I[33]^=N,I[42]^=K,I[43]^=N,K=V^(et<<1|nt>>>31),N=Z^(nt<<1|et>>>31),I[4]^=K,I[5]^=N,I[14]^=K,I[15]^=N,I[24]^=K,I[25]^=N,I[34]^=K,I[35]^=N,I[44]^=K,I[45]^=N,K=H^(st<<1|ft>>>31),N=j^(ft<<1|st>>>31),I[6]^=K,I[7]^=N,I[16]^=K,I[17]^=N,I[26]^=K,I[27]^=N,I[36]^=K,I[37]^=N,I[46]^=K,I[47]^=N,K=et^(Q<<1|L>>>31),N=nt^(L<<1|Q>>>31),I[8]^=K,I[9]^=N,I[18]^=K,I[19]^=N,I[28]^=K,I[29]^=N,I[38]^=K,I[39]^=N,I[48]^=K,I[49]^=N,vt=I[0],ot=I[1],qt=I[11]<<4|I[10]>>>28,ae=I[10]<<4|I[11]>>>28,Y=I[20]<<3|I[21]>>>29,tt=I[21]<<3|I[20]>>>29,Se=I[31]<<9|I[30]>>>23,Be=I[30]<<9|I[31]>>>23,Bt=I[40]<<18|I[41]>>>14,Ot=I[41]<<18|I[40]>>>14,_t=I[2]<<1|I[3]>>>31,Ht=I[3]<<1|I[2]>>>31,pt=I[13]<<12|I[12]>>>20,Ut=I[12]<<12|I[13]>>>20,Rt=I[22]<<10|I[23]>>>22,zt=I[23]<<10|I[22]>>>22,dt=I[33]<<13|I[32]>>>19,mt=I[32]<<13|I[33]>>>19,Ne=I[42]<<2|I[43]>>>30,qe=I[43]<<2|I[42]>>>30,Gt=I[5]<<30|I[4]>>>2,$t=I[4]<<30|I[5]>>>2,St=I[14]<<6|I[15]>>>26,Mt=I[15]<<6|I[14]>>>26,At=I[25]<<11|I[24]>>>21,It=I[24]<<11|I[25]>>>21,he=I[34]<<15|I[35]>>>17,Vt=I[35]<<15|I[34]>>>17,xt=I[45]<<29|I[44]>>>3,bt=I[44]<<29|I[45]>>>3,lt=I[6]<<28|I[7]>>>4,gt=I[7]<<28|I[6]>>>4,pe=I[17]<<23|I[16]>>>9,de=I[16]<<23|I[17]>>>9,jt=I[26]<<25|I[27]>>>7,Lt=I[27]<<25|I[26]>>>7,Jt=I[36]<<21|I[37]>>>11,at=I[37]<<21|I[36]>>>11,Qt=I[47]<<24|I[46]>>>8,ge=I[46]<<24|I[47]>>>8,ie=I[8]<<27|I[9]>>>5,kt=I[9]<<27|I[8]>>>5,Dt=I[18]<<20|I[19]>>>12,ut=I[19]<<20|I[18]>>>12,Ee=I[29]<<7|I[28]>>>25,xe=I[28]<<7|I[29]>>>25,Ft=I[38]<<8|I[39]>>>24,te=I[39]<<8|I[38]>>>24,J=I[48]<<14|I[49]>>>18,rt=I[49]<<14|I[48]>>>18,I[0]=vt^~pt&At,I[1]=ot^~Ut&It,I[10]=lt^~Dt&Y,I[11]=gt^~ut&tt,I[20]=_t^~St&jt,I[21]=Ht^~Mt&Lt,I[30]=ie^~qt&Rt,I[31]=kt^~ae&zt,I[40]=Gt^~pe&Ee,I[41]=$t^~de&xe,I[2]=pt^~At&Jt,I[3]=Ut^~It&at,I[12]=Dt^~Y&dt,I[13]=ut^~tt&mt,I[22]=St^~jt&Ft,I[23]=Mt^~Lt&te,I[32]=qt^~Rt&he,I[33]=ae^~zt&Vt,I[42]=pe^~Ee&Se,I[43]=de^~xe&Be,I[4]=At^~Jt&J,I[5]=It^~at&rt,I[14]=Y^~dt&xt,I[15]=tt^~mt&bt,I[24]=jt^~Ft&Bt,I[25]=Lt^~te&Ot,I[34]=Rt^~he&Qt,I[35]=zt^~Vt&ge,I[44]=Ee^~Se&Ne,I[45]=xe^~Be&qe,I[6]=Jt^~J&vt,I[7]=at^~rt&ot,I[16]=dt^~xt&lt,I[17]=mt^~bt&gt,I[26]=Ft^~Bt&_t,I[27]=te^~Ot&Ht,I[36]=he^~Qt&ie,I[37]=Vt^~ge&kt,I[46]=Se^~Ne&Gt,I[47]=Be^~qe&$t,I[8]=J^~vt&pt,I[9]=rt^~ot&Ut,I[18]=xt^~lt&Dt,I[19]=bt^~gt&ut,I[28]=Bt^~_t&St,I[29]=Ot^~Ht&Mt,I[38]=Qt^~ie&qt,I[39]=ge^~kt&ae,I[48]=Ne^~Gt&pe,I[49]=qe^~$t&de,I[0]^=T[X],I[1]^=T[X+1]};if(v)e.exports=p;else for(w=0;w<m.length;++w)n[m[w]]=p[m[w]]})()}}),P_={};VI(P_,{AnonAadhaarCore:()=>j_,AnonAadhaarCorePackage:()=>mM,AnonAadhaarTypeName:()=>nc,ArtifactsOrigin:()=>U_,CIRCOM_FIELD_P:()=>Q_,IdFields:()=>W1,ProverState:()=>D_,artifactUrls:()=>pM,compressByteArray:()=>n4,convertBigIntToByteArray:()=>q_,convertByteArrayToBigInt:()=>s4,convertRevealBigIntToString:()=>Rd,createCustomV2TestData:()=>RM,dateToUnixTimestamp:()=>kM,decompressByteArray:()=>z_,deserialize:()=>t4,extractFieldByIndex:()=>UM,extractPhoto:()=>V_,fetchPublicKey:()=>fM,fieldsLabel:()=>iM,generateArgs:()=>LM,getDisplayOptions:()=>e4,getEndIndex:()=>Ud,getRandomBytes:()=>H_,handleError:()=>dl,hash:()=>Pd,init:()=>W_,packGroth16Proof:()=>oM,productionPublicKeyHash:()=>$_,prove:()=>Y_,rawDataToCompressedQR:()=>DM,readData:()=>lM,replaceBytesBetween:()=>La,retrieveFileExtension:()=>K_,returnFullId:()=>PM,returnNewDateString:()=>a4,searchZkeyChunks:()=>G_,serialize:()=>J_,splitToWords:()=>Td,testCertificateUrl:()=>vM,testPublicKeyHash:()=>Z_,timestampToUTCUnix:()=>NM,verify:()=>X_});var IR=GI(P_),nc="anon-aadhaar",U_=(i=>(i[i.server=0]="server",i[i.local=1]="local",i[i.chunked=2]="chunked",i))(U_||{}),D_=(i=>(i.Initializing="initializing",i.FetchingWasm="fetching-wasm",i.FetchingZkey="fetching-zkey",i.Proving="proving",i.Completed="completed",i.Error="error",i))(D_||{}),iM=[{key:"revealAgeAbove18",label:"Age Above 18"},{key:"revealGender",label:"Gender"},{key:"revealPinCode",label:"PIN Code"},{key:"revealState",label:"State"}],nM=rb,aM=S6,O_=Xa(SS),sM=S6,S3=Xa(xS),j1={setItem(i,e){return mi(this,null,function*(){return yield S3.default.setItem(i,e)})},getItem(i){return mi(this,null,function*(){return yield S3.default.getItem(i)})}},F_=Xa(sn),dl=(i,e)=>{if(i instanceof Error)return i;let r=e;try{r=JSON.stringify(i)}catch{}return new Error(`This value was thrown as is, not through an Error: ${r}`)};function Td(i,e,r){let t=i;const a=[];for(let n=BigInt(0);n<r;++n){const c=BigInt(2);a.push(`${t%BigInt(Math.pow(Number(c),Number(e)))}`),t=BigInt(t/BigInt(Math.pow(Number(BigInt(2)),Number(e))))}if(t!=BigInt(0))throw`Number ${i} does not fit in ${(e*r).toString()} bits`;return a}function oM(i){return[i.pi_a[0],i.pi_a[1],i.pi_b[0][1],i.pi_b[0][0],i.pi_b[1][1],i.pi_b[1][0],i.pi_c[0],i.pi_c[1]]}var fM=i=>mi(void 0,null,function*(){try{const e=yield fetch(`https://nodejs-serverless-function-express-eight-iota.vercel.app/api/get-public-key?url=${i}`);if(!e.ok)throw new Error("Failed to fetch public key from server");return(yield e.json()).publicKey||null}catch(e){return console.error("Error fetching public key:",e),null}});function q_(i){const e=Math.max(1,Math.ceil(i.toString(2).length/8)),r=new Uint8Array(e);let t=0;for(;i>0;)r[t]=Number(i%BigInt(256)),i=i/BigInt(256),t+=1;return r.reverse()}function Rd(i){typeof i=="string"&&(i=BigInt(i));let e="";for(;i>0;)e+=String.fromCharCode(Number(i%BigInt(256))),i=i/BigInt(256);return e}function z_(i){return F_.default.inflate(i)}var W1=(i=>(i[i.Email_mobile_present_bit_indicator_value=0]="Email_mobile_present_bit_indicator_value",i[i.ReferenceId=1]="ReferenceId",i[i.Name=2]="Name",i[i.DOB=3]="DOB",i[i.Gender=4]="Gender",i[i.CareOf=5]="CareOf",i[i.District=6]="District",i[i.Landmark=7]="Landmark",i[i.House=8]="House",i[i.Location=9]="Location",i[i.PinCode=10]="PinCode",i[i.PostOffice=11]="PostOffice",i[i.State=12]="State",i[i.Street=13]="Street",i[i.SubDistrict=14]="SubDistrict",i[i.VTC=15]="VTC",i[i.PhoneNumberLast4=16]="PhoneNumberLast4",i))(W1||{});function lM(i,e){let r=0,t=0,a=i.indexOf(255,t);for(;r!=e;)t=a+1,a=i.indexOf(255,t),r++;return i.slice(t,a)}function V_(i,e){let r=0;for(let t=0;t<18;++t)r=i.indexOf(255,r+1);return{begin:r,dataLength:e,bytes:i.slice(r+1,e)}}var G_=(i,...e)=>mi(void 0,[i,...e],function*(r,t=j1){const a=[];for(let n=0;n<10;n++){const c=`circuit_final_${n}.zkey`;(yield t.getItem(c))||a.push(cM(r,n,c,t))}yield Promise.all(a)}),cM=(i,e,r,...t)=>mi(void 0,[i,e,r,...t],function*(a,n,c,u=j1){try{const v=yield fetch(a+`/circuit_final_${n}.gz`);if(!v.ok)throw Error("Error while fetching compressed chunked zkey");const o=yield v.arrayBuffer(),h=F_.default.ungzip(o);yield u.setItem(c,h)}catch(v){dl(v,"Error while dowloading the zkey chunks")}}),K_=i=>{const e=new URL(i);return e.pathname.substring(e.pathname.lastIndexOf(".")+1)};function H_(i){const e=new Uint8Array(i);for(let r=0;r<i;r++)e[r]=Math.floor(Math.random()*256);return e}var uM=(i,...e)=>mi(void 0,[i,...e],function*(r,t=j1){try{yield G_(r,t)}catch(v){dl(v,"Error while searching for the zkey chunks")}const a=[];try{for(let v=0;v<10;v++){const o=`circuit_final_${v}.zkey`,h=yield t.getItem(o);if(!h)throw Error(`${o} missing in LocalForage!`);a.push(h)}}catch(v){dl(v,"Error while retrieving zkey chunks from localforage")}const n=a.reduce((v,o)=>v+o.length,0),c=new Uint8Array(n);let u=0;for(const v of a)c.set(v,u),u+=v.length;return c});function hM(i,e=3){return mi(this,null,function*(){let r=0;for(;r<e;)try{const t=yield fetch(i);if(!t.ok)throw new Error(`Error while fetching ${K_(i)} artifacts from prover: ${t.statusText}`);return yield t.arrayBuffer()}catch(t){if(r++,r>=e)throw t;yield new Promise(a=>setTimeout(a,1e3*r))}return i})}var x3=class{constructor(i,e){this.keyURL=i,this.artifactsOrigin=e}getKey(){return mi(this,null,function*(){switch(this.artifactsOrigin){case 1:return this.keyURL;case 0:return yield hM(this.keyURL);case 2:return yield uM(this.keyURL)}})}},dM=class{constructor(i,e,r){this.wasm=new x3(i,r===2?0:r),this.zkey=new x3(e,r),this.proverType=r}proving(i,e){return mi(this,null,function*(){let r,t;switch(this.proverType){case 1:e&&e("fetching-wasm"),r=yield this.wasm.getKey(),e&&e("fetching-zkey"),t=yield this.zkey.getKey();break;case 0:e&&e("fetching-wasm"),r=new Uint8Array(yield this.wasm.getKey()),e&&e("fetching-zkey"),t=new Uint8Array(yield this.zkey.getKey());break;case 2:e&&e("fetching-wasm"),r=new Uint8Array(yield this.wasm.getKey()),e&&e("fetching-zkey"),t=yield this.zkey.getKey();break}const a={qrDataPadded:i.qrDataPadded.value,qrDataPaddedLength:i.qrDataPaddedLength.value,delimiterIndices:i.delimiterIndices.value,signature:i.signature.value,pubKey:i.pubKey.value,nullifierSeed:i.nullifierSeed.value,signalHash:i.signalHash.value,revealAgeAbove18:i.revealAgeAbove18.value,revealGender:i.revealGender.value,revealPinCode:i.revealPinCode.value,revealState:i.revealState.value};e&&e("proving");let n;try{n=yield sM.groth16.fullProve(a,r,t)}catch(v){throw console.error(v),e&&e("error"),new Error("[AnonAAdhaarProver]: Error while generating the proof")}const c=n.proof,u=n.publicSignals;return e&&e("completed"),{groth16Proof:c,pubkeyHash:u[0],timestamp:u[2],nullifierSeed:i.nullifierSeed.value,nullifier:u[1],signalHash:i.signalHash.value,ageAbove18:u[3],gender:u[4],pincode:u[5],state:u[6]}})}},pM={V1:{wasm:"https://anon-aadhaar-artifacts.s3.eu-central-1.amazonaws.com/v1.0.0/aadhaar-verifier.wasm",zkey:"https://anon-aadhaar-artifacts.s3.eu-central-1.amazonaws.com/v1.0.0/circuit_final.zkey",vk:"https://anon-aadhaar-artifacts.s3.eu-central-1.amazonaws.com/v1.0.0/vkey.json",chunked:"https://anon-aadhaar-artifacts.s3.eu-central-1.amazonaws.com/v1.0.0/chunked_zkey"},v2:{wasm:"https://anon-aadhaar-artifacts.s3.eu-central-1.amazonaws.com/v2.0.0/aadhaar-verifier.wasm",zkey:"https://anon-aadhaar-artifacts.s3.eu-central-1.amazonaws.com/v2.0.0/circuit_final.zkey",vk:"https://anon-aadhaar-artifacts.s3.eu-central-1.amazonaws.com/v2.0.0/vkey.json",chunked:"https://anon-aadhaar-artifacts.s3.eu-central-1.amazonaws.com/v2.0.0/chunked_zkey"}},vM="https://anon-aadhaar.s3.ap-south-1.amazonaws.com/testCertificate.pem",Q_=BigInt("21888242871839275222246405745257275088548364400416034343698204186575808495617"),$_="18063425702624337643644061197836918910810808173893535653269228433734128853484",Z_="15134874015316324267425466444584014077184337590635665158241104437045239495873",j_=class{constructor(i,e,r){this.type=nc,this.id=i,this.claim=e,this.proof=r}},zn=void 0;function W_(i){return mi(this,null,function*(){zn=i})}function Y_(i,e){return mi(this,null,function*(){if(!zn)throw new Error("cannot make Anon Aadhaar proof: init has not been called yet");if(!i.pubKey.value)throw new Error("Invalid pubKey argument");if(!i.signalHash.value)throw new Error("Invalid signalHash argument");if(!i.revealAgeAbove18.value)throw new Error("Invalid revealAgeAbove18 argument");const r=(0,nM.v4)(),a=yield new dM(zn.wasmURL,zn.zkeyURL,zn.artifactsOrigin).proving(i,e),n={pubKey:i.pubKey.value,signalHash:i.signalHash.value,ageAbove18:i.revealAgeAbove18.value==="1"?a.ageAbove18==="1":null,gender:Rd(a.gender)||null,pincode:a.pincode==="0"?null:a.pincode,state:Rd(a.state)||null};return new j_(r,n,a)})}function gM(){return mi(this,null,function*(){let i;if(!zn)throw new Error("cannot make Anon Aadhaar proof: init has not been called yet");if(zn.artifactsOrigin===1)i=ao(zn.vkeyURL);else{const e=yield fetch(zn.vkeyURL);if(!e.ok)throw new Error("Failed to fetch the verify key from server");i=yield e.json()}return i})}function X_(i,e){return mi(this,null,function*(){let r=$_;if(e&&(r=Z_),i.proof.pubkeyHash!==r)throw new Error("VerificationError: public key mismatch.");const t=yield gM();return aM.groth16.verify(t,[i.proof.pubkeyHash,i.proof.nullifier,i.proof.timestamp,i.proof.ageAbove18,i.proof.gender,i.proof.pincode,i.proof.state,i.proof.nullifierSeed,i.proof.signalHash],i.proof.groth16Proof)})}function J_(i){return Promise.resolve({type:nc,pcd:(0,O_.default)().stringify({type:i.type,id:i.id,claim:i.claim,proof:i.proof})})}function t4(i){return mi(this,null,function*(){return(0,O_.default)().parse(i)})}function e4(i){return{header:"Anon Aadhaar Signature",displayName:"pcd-"+i.type}}var mM={name:nc,getDisplayOptions:e4,prove:Y_,init:W_,verify:X_,serialize:J_,deserialize:t4},I3=b_(),yM=UI(),bM=Ni(),_M=Xa(tM()),Yi=DI(),wM=Xa(eM()),CM="logger/5.7.0",M3=!1,B3=!1,Xf={debug:1,default:2,info:2,warning:3,error:4,off:5},L3=Xf.default,qh=null;function EM(){try{const i=[];if(["NFD","NFC","NFKD","NFKC"].forEach(e=>{try{if("test".normalize(e)!=="test")throw new Error("bad normalize")}catch{i.push(e)}}),i.length)throw new Error("missing "+i.join(", "));if("".normalize("NFD")!=="e")throw new Error("broken implementation")}catch(i){return i.message}return null}var T3=EM(),Nd;(function(i){i.DEBUG="DEBUG",i.INFO="INFO",i.WARNING="WARNING",i.ERROR="ERROR",i.OFF="OFF"})(Nd||(Nd={}));var tn;(function(i){i.UNKNOWN_ERROR="UNKNOWN_ERROR",i.NOT_IMPLEMENTED="NOT_IMPLEMENTED",i.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",i.NETWORK_ERROR="NETWORK_ERROR",i.SERVER_ERROR="SERVER_ERROR",i.TIMEOUT="TIMEOUT",i.BUFFER_OVERRUN="BUFFER_OVERRUN",i.NUMERIC_FAULT="NUMERIC_FAULT",i.MISSING_NEW="MISSING_NEW",i.INVALID_ARGUMENT="INVALID_ARGUMENT",i.MISSING_ARGUMENT="MISSING_ARGUMENT",i.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",i.CALL_EXCEPTION="CALL_EXCEPTION",i.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",i.NONCE_EXPIRED="NONCE_EXPIRED",i.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",i.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",i.TRANSACTION_REPLACED="TRANSACTION_REPLACED",i.ACTION_REJECTED="ACTION_REJECTED"})(tn||(tn={}));var R3="0123456789abcdef",Vn=class Gr{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,r){const t=e.toLowerCase();Xf[t]==null&&this.throwArgumentError("invalid log level name","logLevel",e),!(L3>Xf[t])&&console.log.apply(console,r)}debug(...e){this._log(Gr.levels.DEBUG,e)}info(...e){this._log(Gr.levels.INFO,e)}warn(...e){this._log(Gr.levels.WARNING,e)}makeError(e,r,t){if(B3)return this.makeError("censored error",r,{});r||(r=Gr.errors.UNKNOWN_ERROR),t||(t={});const a=[];Object.keys(t).forEach(v=>{const o=t[v];try{if(o instanceof Uint8Array){let h="";for(let g=0;g<o.length;g++)h+=R3[o[g]>>4],h+=R3[o[g]&15];a.push(v+"=Uint8Array(0x"+h+")")}else a.push(v+"="+JSON.stringify(o))}catch{a.push(v+"="+JSON.stringify(t[v].toString()))}}),a.push(`code=${r}`),a.push(`version=${this.version}`);const n=e;let c="";switch(r){case tn.NUMERIC_FAULT:{c="NUMERIC_FAULT";const v=e;switch(v){case"overflow":case"underflow":case"division-by-zero":c+="-"+v;break;case"negative-power":case"negative-width":c+="-unsupported";break;case"unbound-bitwise-result":c+="-unbound-result";break}break}case tn.CALL_EXCEPTION:case tn.INSUFFICIENT_FUNDS:case tn.MISSING_NEW:case tn.NONCE_EXPIRED:case tn.REPLACEMENT_UNDERPRICED:case tn.TRANSACTION_REPLACED:case tn.UNPREDICTABLE_GAS_LIMIT:c=r;break}c&&(e+=" [ See: https://links.ethers.org/v5-errors-"+c+" ]"),a.length&&(e+=" ("+a.join(", ")+")");const u=new Error(e);return u.reason=n,u.code=r,Object.keys(t).forEach(function(v){u[v]=t[v]}),u}throwError(e,r,t){throw this.makeError(e,r,t)}throwArgumentError(e,r,t){return this.throwError(e,Gr.errors.INVALID_ARGUMENT,{argument:r,value:t})}assert(e,r,t,a){e||this.throwError(r,t,a)}assertArgument(e,r,t,a){e||this.throwArgumentError(r,t,a)}checkNormalize(e){T3&&this.throwError("platform missing String.prototype.normalize",Gr.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:T3})}checkSafeUint53(e,r){typeof e=="number"&&(r==null&&(r="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(r,Gr.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(r,Gr.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,r,t){t?t=": "+t:t="",e<r&&this.throwError("missing argument"+t,Gr.errors.MISSING_ARGUMENT,{count:e,expectedCount:r}),e>r&&this.throwError("too many arguments"+t,Gr.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:r})}checkNew(e,r){(e===Object||e==null)&&this.throwError("missing new",Gr.errors.MISSING_NEW,{name:r.name})}checkAbstract(e,r){e===r?this.throwError("cannot instantiate abstract class "+JSON.stringify(r.name)+" directly; use a sub-class",Gr.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||e==null)&&this.throwError("missing new",Gr.errors.MISSING_NEW,{name:r.name})}static globalLogger(){return qh||(qh=new Gr(CM)),qh}static setCensorship(e,r){if(!e&&r&&this.globalLogger().throwError("cannot permanently disable censorship",Gr.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),M3){if(!e)return;this.globalLogger().throwError("error censorship permanent",Gr.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}B3=!!e,M3=!!r}static setLogLevel(e){const r=Xf[e.toLowerCase()];if(r==null){Gr.globalLogger().warn("invalid log level - "+e);return}L3=r}static from(e){return new Gr(e)}};Vn.errors=tn;Vn.levels=Nd;var AM="bytes/5.7.0",Va=new Vn(AM);function r4(i){return!!i.toHexString}function Ao(i){return i.slice||(i.slice=function(){const e=Array.prototype.slice.call(arguments);return Ao(new Uint8Array(Array.prototype.slice.apply(i,e)))}),i}function N3(i){return typeof i=="number"&&i==i&&i%1===0}function Y1(i){if(i==null)return!1;if(i.constructor===Uint8Array)return!0;if(typeof i=="string"||!N3(i.length)||i.length<0)return!1;for(let e=0;e<i.length;e++){const r=i[e];if(!N3(r)||r<0||r>=256)return!1}return!0}function i4(i,e){if(e||(e={}),typeof i=="number"){Va.checkSafeUint53(i,"invalid arrayify value");const r=[];for(;i;)r.unshift(i&255),i=parseInt(String(i/256));return r.length===0&&r.push(0),Ao(new Uint8Array(r))}if(e.allowMissingPrefix&&typeof i=="string"&&i.substring(0,2)!=="0x"&&(i="0x"+i),r4(i)&&(i=i.toHexString()),pl(i)){let r=i.substring(2);r.length%2&&(e.hexPad==="left"?r="0"+r:e.hexPad==="right"?r+="0":Va.throwArgumentError("hex data is odd-length","value",i));const t=[];for(let a=0;a<r.length;a+=2)t.push(parseInt(r.substring(a,a+2),16));return Ao(new Uint8Array(t))}return Y1(i)?Ao(new Uint8Array(i)):Va.throwArgumentError("invalid arrayify value","value",i)}function SM(i,e){i=i4(i),i.length>e&&Va.throwArgumentError("value out of range","value",arguments[0]);const r=new Uint8Array(e);return r.set(i,e-i.length),Ao(r)}function pl(i,e){return!(typeof i!="string"||!i.match(/^0x[0-9A-Fa-f]*$/))}var zh="0123456789abcdef";function xM(i,e){if(e||(e={}),typeof i=="number"){Va.checkSafeUint53(i,"invalid hexlify value");let r="";for(;i;)r=zh[i&15]+r,i=Math.floor(i/16);return r.length?(r.length%2&&(r="0"+r),"0x"+r):"0x00"}if(typeof i=="bigint")return i=i.toString(16),i.length%2?"0x0"+i:"0x"+i;if(e.allowMissingPrefix&&typeof i=="string"&&i.substring(0,2)!=="0x"&&(i="0x"+i),r4(i))return i.toHexString();if(pl(i))return i.length%2&&(e.hexPad==="left"?i="0x0"+i.substring(2):e.hexPad==="right"?i+="0":Va.throwArgumentError("hex data is odd-length","value",i)),i.toLowerCase();if(Y1(i)){let r="0x";for(let t=0;t<i.length;t++){let a=i[t];r+=zh[(a&240)>>4]+zh[a&15]}return r}return Va.throwArgumentError("invalid hexlify value","value",i)}var IM="bignumber/5.7.0",kd=wM.default.BN,Pn=new Vn(IM),Vh={},k3=9007199254740991,P3=!1,X1=class Xi{constructor(e,r){e!==Vh&&Pn.throwError("cannot call constructor directly; use BigNumber.from",Vn.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=r,this._isBigNumber=!0,Object.freeze(this)}fromTwos(e){return wi(hr(this).fromTwos(e))}toTwos(e){return wi(hr(this).toTwos(e))}abs(){return this._hex[0]==="-"?Xi.from(this._hex.substring(1)):this}add(e){return wi(hr(this).add(hr(e)))}sub(e){return wi(hr(this).sub(hr(e)))}div(e){return Xi.from(e).isZero()&&Oi("division-by-zero","div"),wi(hr(this).div(hr(e)))}mul(e){return wi(hr(this).mul(hr(e)))}mod(e){const r=hr(e);return r.isNeg()&&Oi("division-by-zero","mod"),wi(hr(this).umod(r))}pow(e){const r=hr(e);return r.isNeg()&&Oi("negative-power","pow"),wi(hr(this).pow(r))}and(e){const r=hr(e);return(this.isNegative()||r.isNeg())&&Oi("unbound-bitwise-result","and"),wi(hr(this).and(r))}or(e){const r=hr(e);return(this.isNegative()||r.isNeg())&&Oi("unbound-bitwise-result","or"),wi(hr(this).or(r))}xor(e){const r=hr(e);return(this.isNegative()||r.isNeg())&&Oi("unbound-bitwise-result","xor"),wi(hr(this).xor(r))}mask(e){return(this.isNegative()||e<0)&&Oi("negative-width","mask"),wi(hr(this).maskn(e))}shl(e){return(this.isNegative()||e<0)&&Oi("negative-width","shl"),wi(hr(this).shln(e))}shr(e){return(this.isNegative()||e<0)&&Oi("negative-width","shr"),wi(hr(this).shrn(e))}eq(e){return hr(this).eq(hr(e))}lt(e){return hr(this).lt(hr(e))}lte(e){return hr(this).lte(hr(e))}gt(e){return hr(this).gt(hr(e))}gte(e){return hr(this).gte(hr(e))}isNegative(){return this._hex[0]==="-"}isZero(){return hr(this).isZero()}toNumber(){try{return hr(this).toNumber()}catch{Oi("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return Pn.throwError("this platform does not support BigInt",Vn.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?P3||(P3=!0,Pn.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?Pn.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",Vn.errors.UNEXPECTED_ARGUMENT,{}):Pn.throwError("BigNumber.toString does not accept parameters",Vn.errors.UNEXPECTED_ARGUMENT,{})),hr(this).toString(10)}toHexString(){return this._hex}toJSON(e){return{type:"BigNumber",hex:this.toHexString()}}static from(e){if(e instanceof Xi)return e;if(typeof e=="string")return e.match(/^-?0x[0-9a-f]+$/i)?new Xi(Vh,Uo(e)):e.match(/^-?[0-9]+$/)?new Xi(Vh,Uo(new kd(e))):Pn.throwArgumentError("invalid BigNumber string","value",e);if(typeof e=="number")return e%1&&Oi("underflow","BigNumber.from",e),(e>=k3||e<=-k3)&&Oi("overflow","BigNumber.from",e),Xi.from(String(e));const r=e;if(typeof r=="bigint")return Xi.from(r.toString());if(Y1(r))return Xi.from(xM(r));if(r)if(r.toHexString){const t=r.toHexString();if(typeof t=="string")return Xi.from(t)}else{let t=r._hex;if(t==null&&r.type==="BigNumber"&&(t=r.hex),typeof t=="string"&&(pl(t)||t[0]==="-"&&pl(t.substring(1))))return Xi.from(t)}return Pn.throwArgumentError("invalid BigNumber value","value",e)}static isBigNumber(e){return!!(e&&e._isBigNumber)}};function Uo(i){if(typeof i!="string")return Uo(i.toString(16));if(i[0]==="-")return i=i.substring(1),i[0]==="-"&&Pn.throwArgumentError("invalid hex","value",i),i=Uo(i),i==="0x00"?i:"-"+i;if(i.substring(0,2)!=="0x"&&(i="0x"+i),i==="0x")return"0x00";for(i.length%2&&(i="0x0"+i.substring(2));i.length>4&&i.substring(0,4)==="0x00";)i="0x"+i.substring(4);return i}function wi(i){return X1.from(Uo(i))}function hr(i){const e=X1.from(i).toHexString();return e[0]==="-"?new kd("-"+e.substring(3),16):new kd(e.substring(2),16)}function Oi(i,e,r){const t={fault:i,operation:e};return r!=null&&(t.value=r),Pn.throwError(i,Vn.errors.NUMERIC_FAULT,t)}var MM=Xa(rM());function BM(i){return"0x"+MM.default.keccak_256(i4(i))}function Pd(i){return i=X1.from(i).toTwos(256).toHexString(),i=SM(i,32),(BigInt(BM(i))>>BigInt(3)).toString()}var LM=i=>mi(void 0,[i],function*({qrData:e,certificateFile:r,nullifierSeed:t,fieldsToRevealArray:a,signal:n}){const c=BigInt(e),u=q_(c),v=z_(u),o=v.slice(v.length-256,v.length),h=v.slice(0,v.length-256),y=_M.pki.certificateFromPem(r).publicKey.n.toString(16),_=BigInt("0x"+y),A=BigInt("0x"+(0,I3.bufferToHex)(bM.Buffer.from(o)).toString()),[S,T]=(0,yM.sha256Pad)(h,512*3),B=[];for(let q=0;q<S.length&&(S[q]===255&&B.push(q),B.length!==18);q++);a||(a=[]);const M={revealAgeAbove18:a.includes("revealAgeAbove18"),revealGender:a.includes("revealGender"),revealPinCode:a.includes("revealPinCode"),revealState:a.includes("revealState")},R=BigInt(t);if(R>Q_)throw new Error("Nullifier seed is larger than the max field size");const P=Pd(n||1);return{qrDataPadded:{argumentType:Yi.ArgumentTypeName.StringArray,value:(0,I3.Uint8ArrayToCharArray)(S)},qrDataPaddedLength:{argumentType:Yi.ArgumentTypeName.Number,value:T.toString()},delimiterIndices:{argumentType:Yi.ArgumentTypeName.StringArray,value:B.map(q=>q.toString())},signature:{argumentType:Yi.ArgumentTypeName.StringArray,value:Td(A,BigInt(121),BigInt(17))},pubKey:{argumentType:Yi.ArgumentTypeName.StringArray,value:Td(_,BigInt(121),BigInt(17))},nullifierSeed:{argumentType:Yi.ArgumentTypeName.String,value:R.toString()},signalHash:{argumentType:Yi.ArgumentTypeName.String,value:P},revealAgeAbove18:{argumentType:Yi.ArgumentTypeName.Number,value:M.revealAgeAbove18?"1":"0"},revealGender:{argumentType:Yi.ArgumentTypeName.Number,value:M.revealGender?"1":"0"},revealPinCode:{argumentType:Yi.ArgumentTypeName.Number,value:M.revealPinCode?"1":"0"},revealState:{argumentType:Yi.ArgumentTypeName.Number,value:M.revealState?"1":"0"}}}),TM=Xa(sn),RM=({signedData:i,dob:e,pincode:r,gender:t,state:a,photo:n})=>{const c=[],u=[];let v=0,o=[];for(let R=0;R<i.length&&v<16;R++)i[R]!==255?o.push(i[R]):(v+=1,c.push(o),u.push(R),o=[]);const h=a4(),g=new TextEncoder().encode(h);let _=La(i,g,6,5+g.length);if(e){const R=new TextEncoder().encode(e);_=La(_,R,u[2]+1,u[2]+c[3].length)}if(t){const R=new TextEncoder().encode(t);_=La(_,R,u[3]+1,u[3]+c[4].length)}if(r){const R=new TextEncoder().encode(r);_=La(_,R,u[9]+1,u[9]+c[10].length)}if(a){const R=new TextEncoder().encode(a);_=La(_,R,u[11]+1,u[11]+c[12].length)}if(n){const{begin:R,dataLength:P}=V_(Array.from(_),_.length),D=P-R;_=La(_,H_(D-1),R+1,R+D-1)}const A=new Uint8Array([86,50,255]),S=new Uint8Array([49,50,51,52,255]),T=new Uint8Array(_.slice(0,Ud(_))),B=new Uint8Array(_.slice(Ud(_))),M=new Uint8Array(A.length+T.length+S.length+B.length);return M.set(A,0),M.set(T,A.length),M.set(S,A.length+T.length),M.set(B,A.length+T.length+S.length),M};function NM(i){const e=new Uint8Array(10);for(let n=0;n<10;n++)e[n]=i[n+9];const r=Buffer.from(e).toString(),t=`${r.slice(0,4)}-${r.slice(4,6)}-${r.slice(6,8)}T${r.slice(8,10)}:00:00.000Z`,a=new Date(t);return a.setUTCHours(a.getUTCHours()-5),a.setUTCMinutes(a.getUTCMinutes()-30),Math.floor(a.getTime()/1e3)}function kM(i){const e=i.split("-"),r=parseInt(e[0],10),t=parseInt(e[1],10)-1,a=parseInt(e[2],10);return new Date(Date.UTC(a,t,r,0,0,0,0)).getTime()/1e3+19800}function PM(i){const e=[];let r=0,t=[];for(let n=0;n<i.length;n++)r<18&&(i[n]!==255?t.push(i[n]):(r+=1,e.push(t),t=[]));const a={};for(let n=0;n<e.length;n++){let c="";for(let u=0;u<e[n].length;u++)c+=String.fromCharCode(e[n][u]);a[W1[n-1]]=c}return a}function UM(i,e){let r=-1,t=i.length,a=-1;for(let n=0;n<i.length;n++)if(i[n]===255){if(a++,a===e)r=n;else if(a===e+1){t=n;break}}return r!==-1&&r<t?i.slice(r,t):new Uint8Array}function n4(i){const e=TM.default.deflate(i);return new Uint8Array(e)}function Ud(i){let e=0,r=0;for(let t=0;t<i.length;t++)if(e<16){if(i[t]!==255)continue;e+=1}else{r=t;break}return r}function La(i,e,r,t){if(r<0||t>=i.length||r>t)return console.error("Invalid start or end index."),i;const a=i.subarray(0,r),n=i.subarray(t+1),c=new Uint8Array(a.length+e.length+n.length);return c.set(a,0),c.set(e,a.length),c.set(n,a.length+e.length),c}function a4(){const i=new Date,e=5,r=30;return i.setUTCHours(i.getUTCHours()+e),i.setUTCMinutes(i.getUTCMinutes()+r),i.getUTCFullYear().toString()+(i.getUTCMonth()+1).toString().padStart(2,"0")+i.getUTCDate().toString().padStart(2,"0")+i.getUTCHours().toString().padStart(2,"0")+i.getUTCMinutes().toString().padStart(2,"0")+i.getUTCSeconds().toString().padStart(2,"0")+i.getUTCMilliseconds().toString().padStart(3,"0")}function s4(i){let e=BigInt(0);for(let r=0;r<i.length;r++)e=e*BigInt(256)+BigInt(i[r]);return e}var DM=i=>{const e=n4(i);return s4(e)},or={options:{usePureJavaScript:!1}},J1={},OM=J1,U3={};J1.encode=function(i,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var t="";if(!(i instanceof Uint8Array))t=FM(i,e);else{var a=0,n=e.length,c=e.charAt(0),u=[0];for(a=0;a<i.length;++a){for(var v=0,o=i[a];v<u.length;++v)o+=u[v]<<8,u[v]=o%n,o=o/n|0;for(;o>0;)u.push(o%n),o=o/n|0}for(a=0;i[a]===0&&a<i.length-1;++a)t+=c;for(a=u.length-1;a>=0;--a)t+=e[u[a]]}if(r){var h=new RegExp(".{1,"+r+"}","g");t=t.match(h).join(`\r
`)}return t};J1.decode=function(i,e){if(typeof i!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=U3[e];if(!r){r=U3[e]=[];for(var t=0;t<e.length;++t)r[e.charCodeAt(t)]=t}i=i.replace(/\s/g,"");for(var a=e.length,n=e.charAt(0),c=[0],t=0;t<i.length;t++){var u=r[i.charCodeAt(t)];if(u===void 0)return;for(var v=0,o=u;v<c.length;++v)o+=c[v]*a,c[v]=o&255,o>>=8;for(;o>0;)c.push(o&255),o>>=8}for(var h=0;i[h]===n&&h<i.length-1;++h)c.push(0);return typeof Buffer<"u"?Buffer.from(c.reverse()):new Uint8Array(c.reverse())};function FM(i,e){var r=0,t=e.length,a=e.charAt(0),n=[0];for(r=0;r<i.length();++r){for(var c=0,u=i.at(r);c<n.length;++c)u+=n[c]<<8,n[c]=u%t,u=u/t|0;for(;u>0;)n.push(u%t),u=u/t|0}var v="";for(r=0;i.at(r)===0&&r<i.length()-1;++r)v+=a;for(r=n.length-1;r>=0;--r)v+=e[n[r]];return v}var D3=or,O3=OM,Wt=D3.util=D3.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){Wt.nextTick=process.nextTick,typeof setImmediate=="function"?Wt.setImmediate=setImmediate:Wt.setImmediate=Wt.nextTick;return}if(typeof setImmediate=="function"){Wt.setImmediate=function(){return setImmediate.apply(void 0,arguments)},Wt.nextTick=function(c){return setImmediate(c)};return}if(Wt.setImmediate=function(c){setTimeout(c,0)},typeof window<"u"&&typeof window.postMessage=="function"){let c=function(u){if(u.source===window&&u.data===i){u.stopPropagation();var v=e.slice();e.length=0,v.forEach(function(o){o()})}};var i="forge.setImmediate",e=[];Wt.setImmediate=function(u){e.push(u),e.length===1&&window.postMessage(i,"*")},window.addEventListener("message",c,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),t=!0,a=document.createElement("div"),e=[];new MutationObserver(function(){var u=e.slice();e.length=0,u.forEach(function(v){v()})}).observe(a,{attributes:!0});var n=Wt.setImmediate;Wt.setImmediate=function(u){Date.now()-r>15?(r=Date.now(),n(u)):(e.push(u),e.length===1&&a.setAttribute("a",t=!t))}}Wt.nextTick=Wt.setImmediate})();Wt.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;Wt.globalScope=function(){return Wt.isNodejs?globalThis:typeof self>"u"?window:self}();Wt.isArray=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"};Wt.isArrayBuffer=function(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer};Wt.isArrayBufferView=function(i){return i&&Wt.isArrayBuffer(i.buffer)&&i.byteLength!==void 0};function of(i){if(!(i===8||i===16||i===24||i===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+i)}Wt.ByteBuffer=tp;function tp(i){if(this.data="",this.read=0,typeof i=="string")this.data=i;else if(Wt.isArrayBuffer(i)||Wt.isArrayBufferView(i))if(typeof Buffer<"u"&&i instanceof Buffer)this.data=i.toString("binary");else{var e=new Uint8Array(i);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(i instanceof tp||typeof i=="object"&&typeof i.data=="string"&&typeof i.read=="number")&&(this.data=i.data,this.read=i.read);this._constructedStringLength=0}Wt.ByteStringBuffer=tp;var qM=4096;Wt.ByteStringBuffer.prototype._optimizeConstructedString=function(i){this._constructedStringLength+=i,this._constructedStringLength>qM&&(this.data.substr(0,1),this._constructedStringLength=0)};Wt.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};Wt.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};Wt.ByteStringBuffer.prototype.putByte=function(i){return this.putBytes(String.fromCharCode(i))};Wt.ByteStringBuffer.prototype.fillWithByte=function(i,e){i=String.fromCharCode(i);for(var r=this.data;e>0;)e&1&&(r+=i),e>>>=1,e>0&&(i+=i);return this.data=r,this._optimizeConstructedString(e),this};Wt.ByteStringBuffer.prototype.putBytes=function(i){return this.data+=i,this._optimizeConstructedString(i.length),this};Wt.ByteStringBuffer.prototype.putString=function(i){return this.putBytes(Wt.encodeUtf8(i))};Wt.ByteStringBuffer.prototype.putInt16=function(i){return this.putBytes(String.fromCharCode(i>>8&255)+String.fromCharCode(i&255))};Wt.ByteStringBuffer.prototype.putInt24=function(i){return this.putBytes(String.fromCharCode(i>>16&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(i&255))};Wt.ByteStringBuffer.prototype.putInt32=function(i){return this.putBytes(String.fromCharCode(i>>24&255)+String.fromCharCode(i>>16&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(i&255))};Wt.ByteStringBuffer.prototype.putInt16Le=function(i){return this.putBytes(String.fromCharCode(i&255)+String.fromCharCode(i>>8&255))};Wt.ByteStringBuffer.prototype.putInt24Le=function(i){return this.putBytes(String.fromCharCode(i&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(i>>16&255))};Wt.ByteStringBuffer.prototype.putInt32Le=function(i){return this.putBytes(String.fromCharCode(i&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(i>>16&255)+String.fromCharCode(i>>24&255))};Wt.ByteStringBuffer.prototype.putInt=function(i,e){of(e);var r="";do e-=8,r+=String.fromCharCode(i>>e&255);while(e>0);return this.putBytes(r)};Wt.ByteStringBuffer.prototype.putSignedInt=function(i,e){return i<0&&(i+=2<<e-1),this.putInt(i,e)};Wt.ByteStringBuffer.prototype.putBuffer=function(i){return this.putBytes(i.getBytes())};Wt.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};Wt.ByteStringBuffer.prototype.getInt16=function(){var i=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,i};Wt.ByteStringBuffer.prototype.getInt24=function(){var i=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,i};Wt.ByteStringBuffer.prototype.getInt32=function(){var i=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,i};Wt.ByteStringBuffer.prototype.getInt16Le=function(){var i=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,i};Wt.ByteStringBuffer.prototype.getInt24Le=function(){var i=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,i};Wt.ByteStringBuffer.prototype.getInt32Le=function(){var i=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,i};Wt.ByteStringBuffer.prototype.getInt=function(i){of(i);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),i-=8;while(i>0);return e};Wt.ByteStringBuffer.prototype.getSignedInt=function(i){var e=this.getInt(i),r=2<<i-2;return e>=r&&(e-=r<<1),e};Wt.ByteStringBuffer.prototype.getBytes=function(i){var e;return i?(i=Math.min(this.length(),i),e=this.data.slice(this.read,this.read+i),this.read+=i):i===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};Wt.ByteStringBuffer.prototype.bytes=function(i){return typeof i>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+i)};Wt.ByteStringBuffer.prototype.at=function(i){return this.data.charCodeAt(this.read+i)};Wt.ByteStringBuffer.prototype.setAt=function(i,e){return this.data=this.data.substr(0,this.read+i)+String.fromCharCode(e)+this.data.substr(this.read+i+1),this};Wt.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};Wt.ByteStringBuffer.prototype.copy=function(){var i=Wt.createBuffer(this.data);return i.read=this.read,i};Wt.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};Wt.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};Wt.ByteStringBuffer.prototype.truncate=function(i){var e=Math.max(0,this.length()-i);return this.data=this.data.substr(this.read,e),this.read=0,this};Wt.ByteStringBuffer.prototype.toHex=function(){for(var i="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(i+="0"),i+=r.toString(16)}return i};Wt.ByteStringBuffer.prototype.toString=function(){return Wt.decodeUtf8(this.bytes())};function zM(i,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=Wt.isArrayBuffer(i),t=Wt.isArrayBufferView(i);if(r||t){r?this.data=new DataView(i):this.data=new DataView(i.buffer,i.byteOffset,i.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,i!=null&&this.putBytes(i),"writeOffset"in e&&(this.write=e.writeOffset)}Wt.DataBuffer=zM;Wt.DataBuffer.prototype.length=function(){return this.write-this.read};Wt.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};Wt.DataBuffer.prototype.accommodate=function(i,e){if(this.length()>=i)return this;e=Math.max(e||this.growSize,i);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),t=new Uint8Array(this.length()+e);return t.set(r),this.data=new DataView(t.buffer),this};Wt.DataBuffer.prototype.putByte=function(i){return this.accommodate(1),this.data.setUint8(this.write++,i),this};Wt.DataBuffer.prototype.fillWithByte=function(i,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(i);return this};Wt.DataBuffer.prototype.putBytes=function(i,e){if(Wt.isArrayBufferView(i)){var r=new Uint8Array(i.buffer,i.byteOffset,i.byteLength),t=r.byteLength-r.byteOffset;this.accommodate(t);var a=new Uint8Array(this.data.buffer,this.write);return a.set(r),this.write+=t,this}if(Wt.isArrayBuffer(i)){var r=new Uint8Array(i);this.accommodate(r.byteLength);var a=new Uint8Array(this.data.buffer);return a.set(r,this.write),this.write+=r.byteLength,this}if(i instanceof Wt.DataBuffer||typeof i=="object"&&typeof i.read=="number"&&typeof i.write=="number"&&Wt.isArrayBufferView(i.data)){var r=new Uint8Array(i.data.byteLength,i.read,i.length());this.accommodate(r.byteLength);var a=new Uint8Array(i.data.byteLength,this.write);return a.set(r),this.write+=r.byteLength,this}if(i instanceof Wt.ByteStringBuffer&&(i=i.data,e="binary"),e=e||"binary",typeof i=="string"){var n;if(e==="hex")return this.accommodate(Math.ceil(i.length/2)),n=new Uint8Array(this.data.buffer,this.write),this.write+=Wt.binary.hex.decode(i,n,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(i.length/4)*3),n=new Uint8Array(this.data.buffer,this.write),this.write+=Wt.binary.base64.decode(i,n,this.write),this;if(e==="utf8"&&(i=Wt.encodeUtf8(i),e="binary"),e==="binary"||e==="raw")return this.accommodate(i.length),n=new Uint8Array(this.data.buffer,this.write),this.write+=Wt.binary.raw.decode(n),this;if(e==="utf16")return this.accommodate(i.length*2),n=new Uint16Array(this.data.buffer,this.write),this.write+=Wt.text.utf16.encode(n),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+i)};Wt.DataBuffer.prototype.putBuffer=function(i){return this.putBytes(i),i.clear(),this};Wt.DataBuffer.prototype.putString=function(i){return this.putBytes(i,"utf16")};Wt.DataBuffer.prototype.putInt16=function(i){return this.accommodate(2),this.data.setInt16(this.write,i),this.write+=2,this};Wt.DataBuffer.prototype.putInt24=function(i){return this.accommodate(3),this.data.setInt16(this.write,i>>8&65535),this.data.setInt8(this.write,i>>16&255),this.write+=3,this};Wt.DataBuffer.prototype.putInt32=function(i){return this.accommodate(4),this.data.setInt32(this.write,i),this.write+=4,this};Wt.DataBuffer.prototype.putInt16Le=function(i){return this.accommodate(2),this.data.setInt16(this.write,i,!0),this.write+=2,this};Wt.DataBuffer.prototype.putInt24Le=function(i){return this.accommodate(3),this.data.setInt8(this.write,i>>16&255),this.data.setInt16(this.write,i>>8&65535,!0),this.write+=3,this};Wt.DataBuffer.prototype.putInt32Le=function(i){return this.accommodate(4),this.data.setInt32(this.write,i,!0),this.write+=4,this};Wt.DataBuffer.prototype.putInt=function(i,e){of(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,i>>e&255);while(e>0);return this};Wt.DataBuffer.prototype.putSignedInt=function(i,e){return of(e),this.accommodate(e/8),i<0&&(i+=2<<e-1),this.putInt(i,e)};Wt.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};Wt.DataBuffer.prototype.getInt16=function(){var i=this.data.getInt16(this.read);return this.read+=2,i};Wt.DataBuffer.prototype.getInt24=function(){var i=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,i};Wt.DataBuffer.prototype.getInt32=function(){var i=this.data.getInt32(this.read);return this.read+=4,i};Wt.DataBuffer.prototype.getInt16Le=function(){var i=this.data.getInt16(this.read,!0);return this.read+=2,i};Wt.DataBuffer.prototype.getInt24Le=function(){var i=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,i};Wt.DataBuffer.prototype.getInt32Le=function(){var i=this.data.getInt32(this.read,!0);return this.read+=4,i};Wt.DataBuffer.prototype.getInt=function(i){of(i);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),i-=8;while(i>0);return e};Wt.DataBuffer.prototype.getSignedInt=function(i){var e=this.getInt(i),r=2<<i-2;return e>=r&&(e-=r<<1),e};Wt.DataBuffer.prototype.getBytes=function(i){var e;return i?(i=Math.min(this.length(),i),e=this.data.slice(this.read,this.read+i),this.read+=i):i===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};Wt.DataBuffer.prototype.bytes=function(i){return typeof i>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+i)};Wt.DataBuffer.prototype.at=function(i){return this.data.getUint8(this.read+i)};Wt.DataBuffer.prototype.setAt=function(i,e){return this.data.setUint8(i,e),this};Wt.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};Wt.DataBuffer.prototype.copy=function(){return new Wt.DataBuffer(this)};Wt.DataBuffer.prototype.compact=function(){if(this.read>0){var i=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(i.byteLength);e.set(i),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};Wt.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};Wt.DataBuffer.prototype.truncate=function(i){return this.write=Math.max(0,this.length()-i),this.read=Math.min(this.read,this.write),this};Wt.DataBuffer.prototype.toHex=function(){for(var i="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(i+="0"),i+=r.toString(16)}return i};Wt.DataBuffer.prototype.toString=function(i){var e=new Uint8Array(this.data,this.read,this.length());if(i=i||"utf8",i==="binary"||i==="raw")return Wt.binary.raw.encode(e);if(i==="hex")return Wt.binary.hex.encode(e);if(i==="base64")return Wt.binary.base64.encode(e);if(i==="utf8")return Wt.text.utf8.decode(e);if(i==="utf16")return Wt.text.utf16.decode(e);throw new Error("Invalid encoding: "+i)};Wt.createBuffer=function(i,e){return e=e||"raw",i!==void 0&&e==="utf8"&&(i=Wt.encodeUtf8(i)),new Wt.ByteBuffer(i)};Wt.fillString=function(i,e){for(var r="";e>0;)e&1&&(r+=i),e>>>=1,e>0&&(i+=i);return r};Wt.xorBytes=function(i,e,r){for(var t="",a="",n="",c=0,u=0;r>0;--r,++c)a=i.charCodeAt(c)^e.charCodeAt(c),u>=10&&(t+=n,n="",u=0),n+=String.fromCharCode(a),++u;return t+=n,t};Wt.hexToBytes=function(i){var e="",r=0;for(i.length&!0&&(r=1,e+=String.fromCharCode(parseInt(i[0],16)));r<i.length;r+=2)e+=String.fromCharCode(parseInt(i.substr(r,2),16));return e};Wt.bytesToHex=function(i){return Wt.createBuffer(i).toHex()};Wt.int32ToBytes=function(i){return String.fromCharCode(i>>24&255)+String.fromCharCode(i>>16&255)+String.fromCharCode(i>>8&255)+String.fromCharCode(i&255)};var na="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",aa=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],o4="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";Wt.encode64=function(i,e){for(var r="",t="",a,n,c,u=0;u<i.length;)a=i.charCodeAt(u++),n=i.charCodeAt(u++),c=i.charCodeAt(u++),r+=na.charAt(a>>2),r+=na.charAt((a&3)<<4|n>>4),isNaN(n)?r+="==":(r+=na.charAt((n&15)<<2|c>>6),r+=isNaN(c)?"=":na.charAt(c&63)),e&&r.length>e&&(t+=r.substr(0,e)+`\r
`,r=r.substr(e));return t+=r,t};Wt.decode64=function(i){i=i.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,t,a,n,c=0;c<i.length;)r=aa[i.charCodeAt(c++)-43],t=aa[i.charCodeAt(c++)-43],a=aa[i.charCodeAt(c++)-43],n=aa[i.charCodeAt(c++)-43],e+=String.fromCharCode(r<<2|t>>4),a!==64&&(e+=String.fromCharCode((t&15)<<4|a>>2),n!==64&&(e+=String.fromCharCode((a&3)<<6|n)));return e};Wt.encodeUtf8=function(i){return unescape(encodeURIComponent(i))};Wt.decodeUtf8=function(i){return decodeURIComponent(escape(i))};Wt.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:O3.encode,decode:O3.decode}};Wt.binary.raw.encode=function(i){return String.fromCharCode.apply(null,i)};Wt.binary.raw.decode=function(i,e,r){var t=e;t||(t=new Uint8Array(i.length)),r=r||0;for(var a=r,n=0;n<i.length;++n)t[a++]=i.charCodeAt(n);return e?a-r:t};Wt.binary.hex.encode=Wt.bytesToHex;Wt.binary.hex.decode=function(i,e,r){var t=e;t||(t=new Uint8Array(Math.ceil(i.length/2))),r=r||0;var a=0,n=r;for(i.length&1&&(a=1,t[n++]=parseInt(i[0],16));a<i.length;a+=2)t[n++]=parseInt(i.substr(a,2),16);return e?n-r:t};Wt.binary.base64.encode=function(i,e){for(var r="",t="",a,n,c,u=0;u<i.byteLength;)a=i[u++],n=i[u++],c=i[u++],r+=na.charAt(a>>2),r+=na.charAt((a&3)<<4|n>>4),isNaN(n)?r+="==":(r+=na.charAt((n&15)<<2|c>>6),r+=isNaN(c)?"=":na.charAt(c&63)),e&&r.length>e&&(t+=r.substr(0,e)+`\r
`,r=r.substr(e));return t+=r,t};Wt.binary.base64.decode=function(i,e,r){var t=e;t||(t=new Uint8Array(Math.ceil(i.length/4)*3)),i=i.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var a,n,c,u,v=0,o=r;v<i.length;)a=aa[i.charCodeAt(v++)-43],n=aa[i.charCodeAt(v++)-43],c=aa[i.charCodeAt(v++)-43],u=aa[i.charCodeAt(v++)-43],t[o++]=a<<2|n>>4,c!==64&&(t[o++]=(n&15)<<4|c>>2,u!==64&&(t[o++]=(c&3)<<6|u));return e?o-r:t.subarray(0,o)};Wt.binary.base58.encode=function(i,e){return Wt.binary.baseN.encode(i,o4,e)};Wt.binary.base58.decode=function(i,e){return Wt.binary.baseN.decode(i,o4,e)};Wt.text={utf8:{},utf16:{}};Wt.text.utf8.encode=function(i,e,r){i=Wt.encodeUtf8(i);var t=e;t||(t=new Uint8Array(i.length)),r=r||0;for(var a=r,n=0;n<i.length;++n)t[a++]=i.charCodeAt(n);return e?a-r:t};Wt.text.utf8.decode=function(i){return Wt.decodeUtf8(String.fromCharCode.apply(null,i))};Wt.text.utf16.encode=function(i,e,r){var t=e;t||(t=new Uint8Array(i.length*2));var a=new Uint16Array(t.buffer);r=r||0;for(var n=r,c=r,u=0;u<i.length;++u)a[c++]=i.charCodeAt(u),n+=2;return e?n-r:t};Wt.text.utf16.decode=function(i){return String.fromCharCode.apply(null,new Uint16Array(i.buffer))};Wt.deflate=function(i,e,r){if(e=Wt.decode64(i.deflate(Wt.encode64(e)).rval),r){var t=2,a=e.charCodeAt(1);a&32&&(t=6),e=e.substring(t,e.length-4)}return e};Wt.inflate=function(i,e,r){var t=i.inflate(Wt.encode64(e)).rval;return t===null?null:Wt.decode64(t)};var ep=function(i,e,r){if(!i)throw new Error("WebStorage not available.");var t;if(r===null?t=i.removeItem(e):(r=Wt.encode64(JSON.stringify(r)),t=i.setItem(e,r)),typeof t<"u"&&t.rval!==!0){var a=new Error(t.error.message);throw a.id=t.error.id,a.name=t.error.name,a}},rp=function(i,e){if(!i)throw new Error("WebStorage not available.");var r=i.getItem(e);if(i.init)if(r.rval===null){if(r.error){var t=new Error(r.error.message);throw t.id=r.error.id,t.name=r.error.name,t}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(Wt.decode64(r))),r},VM=function(i,e,r,t){var a=rp(i,e);a===null&&(a={}),a[r]=t,ep(i,e,a)},GM=function(i,e,r){var t=rp(i,e);return t!==null&&(t=r in t?t[r]:null),t},KM=function(i,e,r){var t=rp(i,e);if(t!==null&&r in t){delete t[r];var a=!0;for(var n in t){a=!1;break}a&&(t=null),ep(i,e,t)}},HM=function(i,e){ep(i,e,null)},ac=function(i,e,r){var t=null;typeof r>"u"&&(r=["web","flash"]);var a,n=!1,c=null;for(var u in r){a=r[u];try{if(a==="flash"||a==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");t=i.apply(this,e),n=a==="flash"}(a==="web"||a==="both")&&(e[0]=localStorage,t=i.apply(this,e),n=!0)}catch(v){c=v}if(n)break}if(!n)throw c;return t};Wt.setItem=function(i,e,r,t,a){ac(VM,arguments,a)};Wt.getItem=function(i,e,r,t){return ac(GM,arguments,t)};Wt.removeItem=function(i,e,r,t){ac(KM,arguments,t)};Wt.clearItems=function(i,e,r){ac(HM,arguments,r)};Wt.isEmpty=function(i){for(var e in i)if(i.hasOwnProperty(e))return!1;return!0};Wt.format=function(i){for(var e=/%./g,r,t,a=0,n=[],c=0;r=e.exec(i);){t=i.substring(c,e.lastIndex-2),t.length>0&&n.push(t),c=e.lastIndex;var u=r[0][1];switch(u){case"s":case"o":a<arguments.length?n.push(arguments[a+++1]):n.push("<?>");break;case"%":n.push("%");break;default:n.push("<%"+u+"?>")}}return n.push(i.substring(c)),n.join("")};Wt.formatNumber=function(i,e,r,t){var a=i,n=isNaN(e=Math.abs(e))?2:e,c=r===void 0?",":r,u=t===void 0?".":t,v=a<0?"-":"",o=parseInt(a=Math.abs(+a||0).toFixed(n),10)+"",h=o.length>3?o.length%3:0;return v+(h?o.substr(0,h)+u:"")+o.substr(h).replace(/(\d{3})(?=\d)/g,"$1"+u)+(n?c+Math.abs(a-o).toFixed(n).slice(2):"")};Wt.formatSize=function(i){return i>=1073741824?i=Wt.formatNumber(i/1073741824,2,".","")+" GiB":i>=1048576?i=Wt.formatNumber(i/1048576,2,".","")+" MiB":i>=1024?i=Wt.formatNumber(i/1024,0)+" KiB":i=Wt.formatNumber(i,0)+" bytes",i};Wt.bytesFromIP=function(i){return i.indexOf(".")!==-1?Wt.bytesFromIPv4(i):i.indexOf(":")!==-1?Wt.bytesFromIPv6(i):null};Wt.bytesFromIPv4=function(i){if(i=i.split("."),i.length!==4)return null;for(var e=Wt.createBuffer(),r=0;r<i.length;++r){var t=parseInt(i[r],10);if(isNaN(t))return null;e.putByte(t)}return e.getBytes()};Wt.bytesFromIPv6=function(i){var e=0;i=i.split(":").filter(function(c){return c.length===0&&++e,!0});for(var r=(8-i.length+e)*2,t=Wt.createBuffer(),a=0;a<8;++a){if(!i[a]||i[a].length===0){t.fillWithByte(0,r),r=0;continue}var n=Wt.hexToBytes(i[a]);n.length<2&&t.putByte(0),t.putBytes(n)}return t.getBytes()};Wt.bytesToIP=function(i){return i.length===4?Wt.bytesToIPv4(i):i.length===16?Wt.bytesToIPv6(i):null};Wt.bytesToIPv4=function(i){if(i.length!==4)return null;for(var e=[],r=0;r<i.length;++r)e.push(i.charCodeAt(r));return e.join(".")};Wt.bytesToIPv6=function(i){if(i.length!==16)return null;for(var e=[],r=[],t=0,a=0;a<i.length;a+=2){for(var n=Wt.bytesToHex(i[a]+i[a+1]);n[0]==="0"&&n!=="0";)n=n.substr(1);if(n==="0"){var c=r[r.length-1],u=e.length;!c||u!==c.end+1?r.push({start:u,end:u}):(c.end=u,c.end-c.start>r[t].end-r[t].start&&(t=r.length-1))}e.push(n)}if(r.length>0){var v=r[t];v.end-v.start>0&&(e.splice(v.start,v.end-v.start+1,""),v.start===0&&e.unshift(""),v.end===7&&e.push(""))}return e.join(":")};Wt.estimateCores=function(i,e){if(typeof i=="function"&&(e=i,i={}),i=i||{},"cores"in Wt&&!i.update)return e(null,Wt.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return Wt.cores=navigator.hardwareConcurrency,e(null,Wt.cores);if(typeof Worker>"u")return Wt.cores=1,e(null,Wt.cores);if(typeof Blob>"u")return Wt.cores=2,e(null,Wt.cores);var r=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(c){var u=Date.now(),v=u+4;self.postMessage({st:u,et:v})})}).toString(),")()"],{type:"application/javascript"}));t([],5,16);function t(c,u,v){if(u===0){var o=Math.floor(c.reduce(function(h,g){return h+g},0)/c.length);return Wt.cores=Math.max(1,o),URL.revokeObjectURL(r),e(null,Wt.cores)}a(v,function(h,g){c.push(n(v,g)),t(c,u-1,v)})}function a(c,u){for(var v=[],o=[],h=0;h<c;++h){var g=new Worker(r);g.addEventListener("message",function(y){if(o.push(y.data),o.length===c){for(var _=0;_<c;++_)v[_].terminate();u(null,o)}}),v.push(g)}for(var h=0;h<c;++h)v[h].postMessage(h)}function n(c,u){for(var v=[],o=0;o<c;++o)for(var h=u[o],g=v[o]=[],y=0;y<c;++y)if(o!==y){var _=u[y];(h.st>_.st&&h.st<_.et||_.st>h.st&&_.st<h.et)&&g.push(y)}return v.reduce(function(A,S){return Math.max(A,S.length)},0)}};var Zr=or;Zr.cipher=Zr.cipher||{};Zr.cipher.algorithms=Zr.cipher.algorithms||{};Zr.cipher.createCipher=function(i,e){var r=i;if(typeof r=="string"&&(r=Zr.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+i);return new Zr.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Zr.cipher.createDecipher=function(i,e){var r=i;if(typeof r=="string"&&(r=Zr.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+i);return new Zr.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Zr.cipher.registerAlgorithm=function(i,e){i=i.toUpperCase(),Zr.cipher.algorithms[i]=e};Zr.cipher.getAlgorithm=function(i){return i=i.toUpperCase(),i in Zr.cipher.algorithms?Zr.cipher.algorithms[i]:null};var ip=Zr.cipher.BlockCipher=function(i){this.algorithm=i.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=i.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=i.decrypt,this.algorithm.initialize(i)};ip.prototype.start=function(i){i=i||{};var e={};for(var r in i)e[r]=i[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Zr.util.createBuffer(),this.output=i.output||Zr.util.createBuffer(),this.mode.start(e)};ip.prototype.update=function(i){for(i&&this._input.putBuffer(i);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ip.prototype.finish=function(i){i&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return i(this.blockSize,r,!1)},this.mode.unpad=function(r){return i(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))};var $r=or;$r.cipher=$r.cipher||{};var ur=$r.cipher.modes=$r.cipher.modes||{};ur.ecb=function(i){i=i||{},this.name="ECB",this.cipher=i.cipher,this.blockSize=i.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};ur.ecb.prototype.start=function(i){};ur.ecb.prototype.encrypt=function(i,e,r){if(i.length()<this.blockSize&&!(r&&i.length()>0))return!0;for(var t=0;t<this._ints;++t)this._inBlock[t]=i.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var t=0;t<this._ints;++t)e.putInt32(this._outBlock[t])};ur.ecb.prototype.decrypt=function(i,e,r){if(i.length()<this.blockSize&&!(r&&i.length()>0))return!0;for(var t=0;t<this._ints;++t)this._inBlock[t]=i.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var t=0;t<this._ints;++t)e.putInt32(this._outBlock[t])};ur.ecb.prototype.pad=function(i,e){var r=i.length()===this.blockSize?this.blockSize:this.blockSize-i.length();return i.fillWithByte(r,r),!0};ur.ecb.prototype.unpad=function(i,e){if(e.overflow>0)return!1;var r=i.length(),t=i.at(r-1);return t>this.blockSize<<2?!1:(i.truncate(t),!0)};ur.cbc=function(i){i=i||{},this.name="CBC",this.cipher=i.cipher,this.blockSize=i.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};ur.cbc.prototype.start=function(i){if(i.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in i)this._iv=sc(i.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};ur.cbc.prototype.encrypt=function(i,e,r){if(i.length()<this.blockSize&&!(r&&i.length()>0))return!0;for(var t=0;t<this._ints;++t)this._inBlock[t]=this._prev[t]^i.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var t=0;t<this._ints;++t)e.putInt32(this._outBlock[t]);this._prev=this._outBlock};ur.cbc.prototype.decrypt=function(i,e,r){if(i.length()<this.blockSize&&!(r&&i.length()>0))return!0;for(var t=0;t<this._ints;++t)this._inBlock[t]=i.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var t=0;t<this._ints;++t)e.putInt32(this._prev[t]^this._outBlock[t]);this._prev=this._inBlock.slice(0)};ur.cbc.prototype.pad=function(i,e){var r=i.length()===this.blockSize?this.blockSize:this.blockSize-i.length();return i.fillWithByte(r,r),!0};ur.cbc.prototype.unpad=function(i,e){if(e.overflow>0)return!1;var r=i.length(),t=i.at(r-1);return t>this.blockSize<<2?!1:(i.truncate(t),!0)};ur.cfb=function(i){i=i||{},this.name="CFB",this.cipher=i.cipher,this.blockSize=i.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=$r.util.createBuffer(),this._partialBytes=0};ur.cfb.prototype.start=function(i){if(!("iv"in i))throw new Error("Invalid IV parameter.");this._iv=sc(i.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ur.cfb.prototype.encrypt=function(i,e,r){var t=i.length();if(t===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&t>=this.blockSize){for(var a=0;a<this._ints;++a)this._inBlock[a]=i.getInt32()^this._outBlock[a],e.putInt32(this._inBlock[a]);return}var n=(this.blockSize-t)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialBlock[a]=i.getInt32()^this._outBlock[a],this._partialOutput.putInt32(this._partialBlock[a]);if(n>0)i.read-=this.blockSize;else for(var a=0;a<this._ints;++a)this._inBlock[a]=this._partialBlock[a];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!r)return e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;e.putBytes(this._partialOutput.getBytes(t-this._partialBytes)),this._partialBytes=0};ur.cfb.prototype.decrypt=function(i,e,r){var t=i.length();if(t===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&t>=this.blockSize){for(var a=0;a<this._ints;++a)this._inBlock[a]=i.getInt32(),e.putInt32(this._inBlock[a]^this._outBlock[a]);return}var n=(this.blockSize-t)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialBlock[a]=i.getInt32(),this._partialOutput.putInt32(this._partialBlock[a]^this._outBlock[a]);if(n>0)i.read-=this.blockSize;else for(var a=0;a<this._ints;++a)this._inBlock[a]=this._partialBlock[a];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!r)return e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;e.putBytes(this._partialOutput.getBytes(t-this._partialBytes)),this._partialBytes=0};ur.ofb=function(i){i=i||{},this.name="OFB",this.cipher=i.cipher,this.blockSize=i.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=$r.util.createBuffer(),this._partialBytes=0};ur.ofb.prototype.start=function(i){if(!("iv"in i))throw new Error("Invalid IV parameter.");this._iv=sc(i.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ur.ofb.prototype.encrypt=function(i,e,r){var t=i.length();if(i.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&t>=this.blockSize){for(var a=0;a<this._ints;++a)e.putInt32(i.getInt32()^this._outBlock[a]),this._inBlock[a]=this._outBlock[a];return}var n=(this.blockSize-t)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(i.getInt32()^this._outBlock[a]);if(n>0)i.read-=this.blockSize;else for(var a=0;a<this._ints;++a)this._inBlock[a]=this._outBlock[a];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!r)return e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;e.putBytes(this._partialOutput.getBytes(t-this._partialBytes)),this._partialBytes=0};ur.ofb.prototype.decrypt=ur.ofb.prototype.encrypt;ur.ctr=function(i){i=i||{},this.name="CTR",this.cipher=i.cipher,this.blockSize=i.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=$r.util.createBuffer(),this._partialBytes=0};ur.ctr.prototype.start=function(i){if(!("iv"in i))throw new Error("Invalid IV parameter.");this._iv=sc(i.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ur.ctr.prototype.encrypt=function(i,e,r){var t=i.length();if(t===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&t>=this.blockSize)for(var a=0;a<this._ints;++a)e.putInt32(i.getInt32()^this._outBlock[a]);else{var n=(this.blockSize-t)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(i.getInt32()^this._outBlock[a]);if(n>0&&(i.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!r)return e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;e.putBytes(this._partialOutput.getBytes(t-this._partialBytes)),this._partialBytes=0}oc(this._inBlock)};ur.ctr.prototype.decrypt=ur.ctr.prototype.encrypt;ur.gcm=function(i){i=i||{},this.name="GCM",this.cipher=i.cipher,this.blockSize=i.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=$r.util.createBuffer(),this._partialBytes=0,this._R=3774873600};ur.gcm.prototype.start=function(i){if(!("iv"in i))throw new Error("Invalid IV parameter.");var e=$r.util.createBuffer(i.iv);this._cipherLength=0;var r;if("additionalData"in i?r=$r.util.createBuffer(i.additionalData):r=$r.util.createBuffer(),"tagLength"in i?this._tagLength=i.tagLength:this._tagLength=128,this._tag=null,i.decrypt&&(this._tag=$r.util.createBuffer(i.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var t=e.length();if(t===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Dd(t*8)))}this._inBlock=this._j0.slice(0),oc(this._inBlock),this._partialBytes=0,r=$r.util.createBuffer(r),this._aDataLength=Dd(r.length()*8);var a=r.length()%this.blockSize;for(a&&r.fillWithByte(0,this.blockSize-a),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};ur.gcm.prototype.encrypt=function(i,e,r){var t=i.length();if(t===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&t>=this.blockSize){for(var a=0;a<this._ints;++a)e.putInt32(this._outBlock[a]^=i.getInt32());this._cipherLength+=this.blockSize}else{var n=(this.blockSize-t)%this.blockSize;n>0&&(n=this.blockSize-n),this._partialOutput.clear();for(var a=0;a<this._ints;++a)this._partialOutput.putInt32(i.getInt32()^this._outBlock[a]);if(n<=0||r){if(r){var c=t%this.blockSize;this._cipherLength+=c,this._partialOutput.truncate(this.blockSize-c)}else this._cipherLength+=this.blockSize;for(var a=0;a<this._ints;++a)this._outBlock[a]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),n>0&&!r)return i.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=n,!0;e.putBytes(this._partialOutput.getBytes(t-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),oc(this._inBlock)};ur.gcm.prototype.decrypt=function(i,e,r){var t=i.length();if(t<this.blockSize&&!(r&&t>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),oc(this._inBlock),this._hashBlock[0]=i.getInt32(),this._hashBlock[1]=i.getInt32(),this._hashBlock[2]=i.getInt32(),this._hashBlock[3]=i.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var a=0;a<this._ints;++a)e.putInt32(this._outBlock[a]^this._hashBlock[a]);t<this.blockSize?this._cipherLength+=t%this.blockSize:this._cipherLength+=this.blockSize};ur.gcm.prototype.afterFinish=function(i,e){var r=!0;e.decrypt&&e.overflow&&i.truncate(this.blockSize-e.overflow),this.tag=$r.util.createBuffer();var t=this._aDataLength.concat(Dd(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,t);var a=[];this.cipher.encrypt(this._j0,a);for(var n=0;n<this._ints;++n)this.tag.putInt32(this._s[n]^a[n]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};ur.gcm.prototype.multiply=function(i,e){for(var r=[0,0,0,0],t=e.slice(0),a=0;a<128;++a){var n=i[a/32|0]&1<<31-a%32;n&&(r[0]^=t[0],r[1]^=t[1],r[2]^=t[2],r[3]^=t[3]),this.pow(t,t)}return r};ur.gcm.prototype.pow=function(i,e){for(var r=i[3]&1,t=3;t>0;--t)e[t]=i[t]>>>1|(i[t-1]&1)<<31;e[0]=i[0]>>>1,r&&(e[0]^=this._R)};ur.gcm.prototype.tableMultiply=function(i){for(var e=[0,0,0,0],r=0;r<32;++r){var t=r/8|0,a=i[t]>>>(7-r%8)*4&15,n=this._m[r][a];e[0]^=n[0],e[1]^=n[1],e[2]^=n[2],e[3]^=n[3]}return e};ur.gcm.prototype.ghash=function(i,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};ur.gcm.prototype.generateHashTable=function(i,e){for(var r=8/e,t=4*r,a=16*r,n=new Array(a),c=0;c<a;++c){var u=[0,0,0,0],v=c/t|0,o=(t-1-c%t)*e;u[v]=1<<e-1<<o,n[c]=this.generateSubHashTable(this.multiply(u,i),e)}return n};ur.gcm.prototype.generateSubHashTable=function(i,e){var r=1<<e,t=r>>>1,a=new Array(r);a[t]=i.slice(0);for(var n=t>>>1;n>0;)this.pow(a[2*n],a[n]=[]),n>>=1;for(n=2;n<t;){for(var c=1;c<n;++c){var u=a[n],v=a[c];a[n+c]=[u[0]^v[0],u[1]^v[1],u[2]^v[2],u[3]^v[3]]}n*=2}for(a[0]=[0,0,0,0],n=t+1;n<r;++n){var o=a[n^t];a[n]=[i[0]^o[0],i[1]^o[1],i[2]^o[2],i[3]^o[3]]}return a};function sc(i,e){if(typeof i=="string"&&(i=$r.util.createBuffer(i)),$r.util.isArray(i)&&i.length>4){var r=i;i=$r.util.createBuffer();for(var t=0;t<r.length;++t)i.putByte(r[t])}if(i.length()<e)throw new Error("Invalid IV length; got "+i.length()+" bytes and expected "+e+" bytes.");if(!$r.util.isArray(i)){for(var a=[],n=e/4,t=0;t<n;++t)a.push(i.getInt32());i=a}return i}function oc(i){i[i.length-1]=i[i.length-1]+1&4294967295}function Dd(i){return[i/4294967296|0,i&4294967295]}var Br=or;Br.aes=Br.aes||{};Br.aes.startEncrypting=function(i,e,r,t){var a=fc({key:i,output:r,decrypt:!1,mode:t});return a.start(e),a};Br.aes.createEncryptionCipher=function(i,e){return fc({key:i,output:null,decrypt:!1,mode:e})};Br.aes.startDecrypting=function(i,e,r,t){var a=fc({key:i,output:r,decrypt:!0,mode:t});return a.start(e),a};Br.aes.createDecryptionCipher=function(i,e){return fc({key:i,output:null,decrypt:!0,mode:e})};Br.aes.Algorithm=function(i,e){np||l4();var r=this;r.name=i,r.mode=new e({blockSize:16,cipher:{encrypt:function(t,a){return Fd(r._w,t,a,!1)},decrypt:function(t,a){return Fd(r._w,t,a,!0)}}}),r._init=!1};Br.aes.Algorithm.prototype.initialize=function(i){if(!this._init){var e=i.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Br.util.createBuffer(e);else if(Br.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=Br.util.createBuffer();for(var t=0;t<r.length;++t)e.putByte(r[t])}if(!Br.util.isArray(e)){r=e,e=[];var a=r.length();if(a===16||a===24||a===32){a=a>>>2;for(var t=0;t<a;++t)e.push(r.getInt32())}}if(!Br.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var n=this.mode.name,c=["CFB","OFB","CTR","GCM"].indexOf(n)!==-1;this._w=c4(e,i.decrypt&&!c),this._init=!0}};Br.aes._expandKey=function(i,e){return np||l4(),c4(i,e)};Br.aes._updateBlock=Fd;Vs("AES-ECB",Br.cipher.modes.ecb);Vs("AES-CBC",Br.cipher.modes.cbc);Vs("AES-CFB",Br.cipher.modes.cfb);Vs("AES-OFB",Br.cipher.modes.ofb);Vs("AES-CTR",Br.cipher.modes.ctr);Vs("AES-GCM",Br.cipher.modes.gcm);function Vs(i,e){var r=function(){return new Br.aes.Algorithm(i,e)};Br.cipher.registerAlgorithm(i,r)}var np=!1,ss=4,ci,Od,f4,qa,en;function l4(){np=!0,f4=[0,1,2,4,8,16,32,64,128,27,54];for(var i=new Array(256),e=0;e<128;++e)i[e]=e<<1,i[e+128]=e+128<<1^283;ci=new Array(256),Od=new Array(256),qa=new Array(4),en=new Array(4);for(var e=0;e<4;++e)qa[e]=new Array(256),en[e]=new Array(256);for(var r=0,t=0,a,n,c,u,v,o,h,e=0;e<256;++e){u=t^t<<1^t<<2^t<<3^t<<4,u=u>>8^u&255^99,ci[r]=u,Od[u]=r,v=i[u],a=i[r],n=i[a],c=i[n],o=v<<24^u<<16^u<<8^(u^v),h=(a^n^c)<<24^(r^c)<<16^(r^n^c)<<8^(r^a^c);for(var g=0;g<4;++g)qa[g][r]=o,en[g][u]=h,o=o<<24|o>>>8,h=h<<24|h>>>8;r===0?r=t=1:(r=a^i[i[i[a^c]]],t^=i[i[t]])}}function c4(i,e){for(var r=i.slice(0),t,a=1,n=r.length,c=n+6+1,u=ss*c,v=n;v<u;++v)t=r[v-1],v%n===0?(t=ci[t>>>16&255]<<24^ci[t>>>8&255]<<16^ci[t&255]<<8^ci[t>>>24]^f4[a]<<24,a++):n>6&&v%n===4&&(t=ci[t>>>24]<<24^ci[t>>>16&255]<<16^ci[t>>>8&255]<<8^ci[t&255]),r[v]=r[v-n]^t;if(e){var o,h=en[0],g=en[1],y=en[2],_=en[3],A=r.slice(0);u=r.length;for(var v=0,S=u-ss;v<u;v+=ss,S-=ss)if(v===0||v===u-ss)A[v]=r[S],A[v+1]=r[S+3],A[v+2]=r[S+2],A[v+3]=r[S+1];else for(var T=0;T<ss;++T)o=r[S+T],A[v+(3&-T)]=h[ci[o>>>24]]^g[ci[o>>>16&255]]^y[ci[o>>>8&255]]^_[ci[o&255]];r=A}return r}function Fd(i,e,r,t){var a=i.length/4-1,n,c,u,v,o;t?(n=en[0],c=en[1],u=en[2],v=en[3],o=Od):(n=qa[0],c=qa[1],u=qa[2],v=qa[3],o=ci);var h,g,y,_,A,S,T;h=e[0]^i[0],g=e[t?3:1]^i[1],y=e[2]^i[2],_=e[t?1:3]^i[3];for(var B=3,M=1;M<a;++M)A=n[h>>>24]^c[g>>>16&255]^u[y>>>8&255]^v[_&255]^i[++B],S=n[g>>>24]^c[y>>>16&255]^u[_>>>8&255]^v[h&255]^i[++B],T=n[y>>>24]^c[_>>>16&255]^u[h>>>8&255]^v[g&255]^i[++B],_=n[_>>>24]^c[h>>>16&255]^u[g>>>8&255]^v[y&255]^i[++B],h=A,g=S,y=T;r[0]=o[h>>>24]<<24^o[g>>>16&255]<<16^o[y>>>8&255]<<8^o[_&255]^i[++B],r[t?3:1]=o[g>>>24]<<24^o[y>>>16&255]<<16^o[_>>>8&255]<<8^o[h&255]^i[++B],r[2]=o[y>>>24]<<24^o[_>>>16&255]<<16^o[h>>>8&255]<<8^o[g&255]^i[++B],r[t?1:3]=o[_>>>24]<<24^o[h>>>16&255]<<16^o[g>>>8&255]<<8^o[y&255]^i[++B]}function fc(i){i=i||{};var e=(i.mode||"CBC").toUpperCase(),r="AES-"+e,t;i.decrypt?t=Br.cipher.createDecipher(r,i.key):t=Br.cipher.createCipher(r,i.key);var a=t.start;return t.start=function(n,c){var u=null;c instanceof Br.util.ByteBuffer&&(u=c,c={}),c=c||{},c.output=u,c.iv=n,a.call(t,c)},t}var So=or;So.pki=So.pki||{};var qd=So.pki.oids=So.oids=So.oids||{};function ce(i,e){qd[i]=e,qd[e]=i}function Sr(i,e){qd[i]=e}ce("1.2.840.113549.1.1.1","rsaEncryption");ce("1.2.840.113549.1.1.4","md5WithRSAEncryption");ce("1.2.840.113549.1.1.5","sha1WithRSAEncryption");ce("1.2.840.113549.1.1.7","RSAES-OAEP");ce("1.2.840.113549.1.1.8","mgf1");ce("1.2.840.113549.1.1.9","pSpecified");ce("1.2.840.113549.1.1.10","RSASSA-PSS");ce("1.2.840.113549.1.1.11","sha256WithRSAEncryption");ce("1.2.840.113549.1.1.12","sha384WithRSAEncryption");ce("1.2.840.113549.1.1.13","sha512WithRSAEncryption");ce("1.3.101.112","EdDSA25519");ce("1.2.840.10040.4.3","dsa-with-sha1");ce("1.3.14.3.2.7","desCBC");ce("1.3.14.3.2.26","sha1");ce("1.3.14.3.2.29","sha1WithRSASignature");ce("2.16.840.1.101.3.4.2.1","sha256");ce("2.16.840.1.101.3.4.2.2","sha384");ce("2.16.840.1.101.3.4.2.3","sha512");ce("2.16.840.1.101.3.4.2.4","sha224");ce("2.16.840.1.101.3.4.2.5","sha512-224");ce("2.16.840.1.101.3.4.2.6","sha512-256");ce("1.2.840.113549.2.2","md2");ce("1.2.840.113549.2.5","md5");ce("1.2.840.113549.1.7.1","data");ce("1.2.840.113549.1.7.2","signedData");ce("1.2.840.113549.1.7.3","envelopedData");ce("1.2.840.113549.1.7.4","signedAndEnvelopedData");ce("1.2.840.113549.1.7.5","digestedData");ce("1.2.840.113549.1.7.6","encryptedData");ce("1.2.840.113549.1.9.1","emailAddress");ce("1.2.840.113549.1.9.2","unstructuredName");ce("1.2.840.113549.1.9.3","contentType");ce("1.2.840.113549.1.9.4","messageDigest");ce("1.2.840.113549.1.9.5","signingTime");ce("1.2.840.113549.1.9.6","counterSignature");ce("1.2.840.113549.1.9.7","challengePassword");ce("1.2.840.113549.1.9.8","unstructuredAddress");ce("1.2.840.113549.1.9.14","extensionRequest");ce("1.2.840.113549.1.9.20","friendlyName");ce("1.2.840.113549.1.9.21","localKeyId");ce("1.2.840.113549.1.9.22.1","x509Certificate");ce("1.2.840.113549.1.12.10.1.1","keyBag");ce("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");ce("1.2.840.113549.1.12.10.1.3","certBag");ce("1.2.840.113549.1.12.10.1.4","crlBag");ce("1.2.840.113549.1.12.10.1.5","secretBag");ce("1.2.840.113549.1.12.10.1.6","safeContentsBag");ce("1.2.840.113549.1.5.13","pkcs5PBES2");ce("1.2.840.113549.1.5.12","pkcs5PBKDF2");ce("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");ce("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");ce("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");ce("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");ce("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");ce("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");ce("1.2.840.113549.2.7","hmacWithSHA1");ce("1.2.840.113549.2.8","hmacWithSHA224");ce("1.2.840.113549.2.9","hmacWithSHA256");ce("1.2.840.113549.2.10","hmacWithSHA384");ce("1.2.840.113549.2.11","hmacWithSHA512");ce("1.2.840.113549.3.7","des-EDE3-CBC");ce("2.16.840.1.101.3.4.1.2","aes128-CBC");ce("2.16.840.1.101.3.4.1.22","aes192-CBC");ce("2.16.840.1.101.3.4.1.42","aes256-CBC");ce("2.5.4.3","commonName");ce("2.5.4.4","surname");ce("2.5.4.5","serialNumber");ce("2.5.4.6","countryName");ce("2.5.4.7","localityName");ce("2.5.4.8","stateOrProvinceName");ce("2.5.4.9","streetAddress");ce("2.5.4.10","organizationName");ce("2.5.4.11","organizationalUnitName");ce("2.5.4.12","title");ce("2.5.4.13","description");ce("2.5.4.15","businessCategory");ce("2.5.4.17","postalCode");ce("2.5.4.42","givenName");ce("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");ce("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");ce("2.16.840.1.113730.1.1","nsCertType");ce("2.16.840.1.113730.1.13","nsComment");Sr("2.5.29.1","authorityKeyIdentifier");Sr("2.5.29.2","keyAttributes");Sr("2.5.29.3","certificatePolicies");Sr("2.5.29.4","keyUsageRestriction");Sr("2.5.29.5","policyMapping");Sr("2.5.29.6","subtreesConstraint");Sr("2.5.29.7","subjectAltName");Sr("2.5.29.8","issuerAltName");Sr("2.5.29.9","subjectDirectoryAttributes");Sr("2.5.29.10","basicConstraints");Sr("2.5.29.11","nameConstraints");Sr("2.5.29.12","policyConstraints");Sr("2.5.29.13","basicConstraints");ce("2.5.29.14","subjectKeyIdentifier");ce("2.5.29.15","keyUsage");Sr("2.5.29.16","privateKeyUsagePeriod");ce("2.5.29.17","subjectAltName");ce("2.5.29.18","issuerAltName");ce("2.5.29.19","basicConstraints");Sr("2.5.29.20","cRLNumber");Sr("2.5.29.21","cRLReason");Sr("2.5.29.22","expirationDate");Sr("2.5.29.23","instructionCode");Sr("2.5.29.24","invalidityDate");Sr("2.5.29.25","cRLDistributionPoints");Sr("2.5.29.26","issuingDistributionPoint");Sr("2.5.29.27","deltaCRLIndicator");Sr("2.5.29.28","issuingDistributionPoint");Sr("2.5.29.29","certificateIssuer");Sr("2.5.29.30","nameConstraints");ce("2.5.29.31","cRLDistributionPoints");ce("2.5.29.32","certificatePolicies");Sr("2.5.29.33","policyMappings");Sr("2.5.29.34","policyConstraints");ce("2.5.29.35","authorityKeyIdentifier");Sr("2.5.29.36","policyConstraints");ce("2.5.29.37","extKeyUsage");Sr("2.5.29.46","freshestCRL");Sr("2.5.29.54","inhibitAnyPolicy");ce("1.3.6.1.4.1.11129.2.4.2","timestampList");ce("1.3.6.1.5.5.7.1.1","authorityInfoAccess");ce("1.3.6.1.5.5.7.3.1","serverAuth");ce("1.3.6.1.5.5.7.3.2","clientAuth");ce("1.3.6.1.5.5.7.3.3","codeSigning");ce("1.3.6.1.5.5.7.3.4","emailProtection");ce("1.3.6.1.5.5.7.3.8","timeStamping");var Nr=or,ye=Nr.asn1=Nr.asn1||{};ye.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};ye.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};ye.create=function(i,e,r,t,a){if(Nr.util.isArray(t)){for(var n=[],c=0;c<t.length;++c)t[c]!==void 0&&n.push(t[c]);t=n}var u={tagClass:i,type:e,constructed:r,composed:r||Nr.util.isArray(t),value:t};return a&&"bitStringContents"in a&&(u.bitStringContents=a.bitStringContents,u.original=ye.copy(u)),u};ye.copy=function(i,e){var r;if(Nr.util.isArray(i)){r=[];for(var t=0;t<i.length;++t)r.push(ye.copy(i[t],e));return r}return typeof i=="string"?i:(r={tagClass:i.tagClass,type:i.type,constructed:i.constructed,composed:i.composed,value:ye.copy(i.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=i.bitStringContents),r)};ye.equals=function(i,e,r){if(Nr.util.isArray(i)){if(!Nr.util.isArray(e)||i.length!==e.length)return!1;for(var t=0;t<i.length;++t)if(!ye.equals(i[t],e[t]))return!1;return!0}if(typeof i!=typeof e)return!1;if(typeof i=="string")return i===e;var a=i.tagClass===e.tagClass&&i.type===e.type&&i.constructed===e.constructed&&i.composed===e.composed&&ye.equals(i.value,e.value);return r&&r.includeBitStringContents&&(a=a&&i.bitStringContents===e.bitStringContents),a};ye.getBerValueLength=function(i){var e=i.getByte();if(e!==128){var r,t=e&128;return t?r=i.getInt((e&127)<<3):r=e,r}};function lo(i,e,r){if(r>e){var t=new Error("Too few bytes to parse DER.");throw t.available=i.length(),t.remaining=e,t.requested=r,t}}var QM=function(i,e){var r=i.getByte();if(e--,r!==128){var t,a=r&128;if(!a)t=r;else{var n=r&127;lo(i,e,n),t=i.getInt(n<<3)}if(t<0)throw new Error("Negative length: "+t);return t}};ye.fromDer=function(i,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof i=="string"&&(i=Nr.util.createBuffer(i));var r=i.length(),t=Jf(i,i.length(),0,e);if(e.parseAllBytes&&i.length()!==0){var a=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw a.byteCount=r,a.remaining=i.length(),a}return t};function Jf(i,e,r,t){var a;lo(i,e,2);var n=i.getByte();e--;var c=n&192,u=n&31;a=i.length();var v=QM(i,e);if(e-=a-i.length(),v!==void 0&&v>e){if(t.strict){var o=new Error("Too few bytes to read ASN.1 value.");throw o.available=i.length(),o.remaining=e,o.requested=v,o}v=e}var h,g,y=(n&32)===32;if(y)if(h=[],v===void 0)for(;;){if(lo(i,e,2),i.bytes(2)==="\0\0"){i.getBytes(2),e-=2;break}a=i.length(),h.push(Jf(i,e,r+1,t)),e-=a-i.length()}else for(;v>0;)a=i.length(),h.push(Jf(i,v,r+1,t)),e-=a-i.length(),v-=a-i.length();if(h===void 0&&c===ye.Class.UNIVERSAL&&u===ye.Type.BITSTRING&&(g=i.bytes(v)),h===void 0&&t.decodeBitStrings&&c===ye.Class.UNIVERSAL&&u===ye.Type.BITSTRING&&v>1){var _=i.read,A=e,S=0;if(u===ye.Type.BITSTRING&&(lo(i,e,1),S=i.getByte(),e--),S===0)try{a=i.length();var T={strict:!0,decodeBitStrings:!0},B=Jf(i,e,r+1,T),M=a-i.length();e-=M,u==ye.Type.BITSTRING&&M++;var R=B.tagClass;M===v&&(R===ye.Class.UNIVERSAL||R===ye.Class.CONTEXT_SPECIFIC)&&(h=[B])}catch{}h===void 0&&(i.read=_,e=A)}if(h===void 0){if(v===void 0){if(t.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");v=e}if(u===ye.Type.BMPSTRING)for(h="";v>0;v-=2)lo(i,e,2),h+=String.fromCharCode(i.getInt16()),e-=2;else h=i.getBytes(v),e-=v}var P=g===void 0?null:{bitStringContents:g};return ye.create(c,u,y,h,P)}ye.toDer=function(i){var e=Nr.util.createBuffer(),r=i.tagClass|i.type,t=Nr.util.createBuffer(),a=!1;if("bitStringContents"in i&&(a=!0,i.original&&(a=ye.equals(i,i.original))),a)t.putBytes(i.bitStringContents);else if(i.composed){i.constructed?r|=32:t.putByte(0);for(var n=0;n<i.value.length;++n)i.value[n]!==void 0&&t.putBuffer(ye.toDer(i.value[n]))}else if(i.type===ye.Type.BMPSTRING)for(var n=0;n<i.value.length;++n)t.putInt16(i.value.charCodeAt(n));else i.type===ye.Type.INTEGER&&i.value.length>1&&(i.value.charCodeAt(0)===0&&!(i.value.charCodeAt(1)&128)||i.value.charCodeAt(0)===255&&(i.value.charCodeAt(1)&128)===128)?t.putBytes(i.value.substr(1)):t.putBytes(i.value);if(e.putByte(r),t.length()<=127)e.putByte(t.length()&127);else{var c=t.length(),u="";do u+=String.fromCharCode(c&255),c=c>>>8;while(c>0);e.putByte(u.length|128);for(var n=u.length-1;n>=0;--n)e.putByte(u.charCodeAt(n))}return e.putBuffer(t),e};ye.oidToDer=function(i){var e=i.split("."),r=Nr.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var t,a,n,c,u=2;u<e.length;++u){t=!0,a=[],n=parseInt(e[u],10);do c=n&127,n=n>>>7,t||(c|=128),a.push(c),t=!1;while(n>0);for(var v=a.length-1;v>=0;--v)r.putByte(a[v])}return r};ye.derToOid=function(i){var e;typeof i=="string"&&(i=Nr.util.createBuffer(i));var r=i.getByte();e=Math.floor(r/40)+"."+r%40;for(var t=0;i.length()>0;)r=i.getByte(),t=t<<7,r&128?t+=r&127:(e+="."+(t+r),t=0);return e};ye.utcTimeToDate=function(i){var e=new Date,r=parseInt(i.substr(0,2),10);r=r>=50?1900+r:2e3+r;var t=parseInt(i.substr(2,2),10)-1,a=parseInt(i.substr(4,2),10),n=parseInt(i.substr(6,2),10),c=parseInt(i.substr(8,2),10),u=0;if(i.length>11){var v=i.charAt(10),o=10;v!=="+"&&v!=="-"&&(u=parseInt(i.substr(10,2),10),o+=2)}if(e.setUTCFullYear(r,t,a),e.setUTCHours(n,c,u,0),o&&(v=i.charAt(o),v==="+"||v==="-")){var h=parseInt(i.substr(o+1,2),10),g=parseInt(i.substr(o+4,2),10),y=h*60+g;y*=6e4,v==="+"?e.setTime(+e-y):e.setTime(+e+y)}return e};ye.generalizedTimeToDate=function(i){var e=new Date,r=parseInt(i.substr(0,4),10),t=parseInt(i.substr(4,2),10)-1,a=parseInt(i.substr(6,2),10),n=parseInt(i.substr(8,2),10),c=parseInt(i.substr(10,2),10),u=parseInt(i.substr(12,2),10),v=0,o=0,h=!1;i.charAt(i.length-1)==="Z"&&(h=!0);var g=i.length-5,y=i.charAt(g);if(y==="+"||y==="-"){var _=parseInt(i.substr(g+1,2),10),A=parseInt(i.substr(g+4,2),10);o=_*60+A,o*=6e4,y==="+"&&(o*=-1),h=!0}return i.charAt(14)==="."&&(v=parseFloat(i.substr(14),10)*1e3),h?(e.setUTCFullYear(r,t,a),e.setUTCHours(n,c,u,v),e.setTime(+e+o)):(e.setFullYear(r,t,a),e.setHours(n,c,u,v)),e};ye.dateToUtcTime=function(i){if(typeof i=="string")return i;var e="",r=[];r.push((""+i.getUTCFullYear()).substr(2)),r.push(""+(i.getUTCMonth()+1)),r.push(""+i.getUTCDate()),r.push(""+i.getUTCHours()),r.push(""+i.getUTCMinutes()),r.push(""+i.getUTCSeconds());for(var t=0;t<r.length;++t)r[t].length<2&&(e+="0"),e+=r[t];return e+="Z",e};ye.dateToGeneralizedTime=function(i){if(typeof i=="string")return i;var e="",r=[];r.push(""+i.getUTCFullYear()),r.push(""+(i.getUTCMonth()+1)),r.push(""+i.getUTCDate()),r.push(""+i.getUTCHours()),r.push(""+i.getUTCMinutes()),r.push(""+i.getUTCSeconds());for(var t=0;t<r.length;++t)r[t].length<2&&(e+="0"),e+=r[t];return e+="Z",e};ye.integerToDer=function(i){var e=Nr.util.createBuffer();if(i>=-128&&i<128)return e.putSignedInt(i,8);if(i>=-32768&&i<32768)return e.putSignedInt(i,16);if(i>=-8388608&&i<8388608)return e.putSignedInt(i,24);if(i>=-2147483648&&i<2147483648)return e.putSignedInt(i,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=i,r};ye.derToInteger=function(i){typeof i=="string"&&(i=Nr.util.createBuffer(i));var e=i.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return i.getSignedInt(e)};ye.validate=function(i,e,r,t){var a=!1;if((i.tagClass===e.tagClass||typeof e.tagClass>"u")&&(i.type===e.type||typeof e.type>"u"))if(i.constructed===e.constructed||typeof e.constructed>"u"){if(a=!0,e.value&&Nr.util.isArray(e.value))for(var n=0,c=0;a&&c<e.value.length;++c)a=e.value[c].optional||!1,i.value[n]&&(a=ye.validate(i.value[n],e.value[c],r,t),a?++n:e.value[c].optional&&(a=!0)),!a&&t&&t.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+i.value.length+'"');if(a&&r&&(e.capture&&(r[e.capture]=i.value),e.captureAsn1&&(r[e.captureAsn1]=i),e.captureBitStringContents&&"bitStringContents"in i&&(r[e.captureBitStringContents]=i.bitStringContents),e.captureBitStringValue&&"bitStringContents"in i))if(i.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var u=i.bitStringContents.charCodeAt(0);if(u!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=i.bitStringContents.slice(1)}}else t&&t.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+i.constructed+'"');else t&&(i.tagClass!==e.tagClass&&t.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+i.tagClass+'"'),i.type!==e.type&&t.push("["+e.name+'] Expected type "'+e.type+'", got "'+i.type+'"'));return a};var F3=/[^\\u0000-\\u00ff]/;ye.prettyPrint=function(i,e,r){var t="";e=e||0,r=r||2,e>0&&(t+=`
`);for(var a="",n=0;n<e*r;++n)a+=" ";switch(t+=a+"Tag: ",i.tagClass){case ye.Class.UNIVERSAL:t+="Universal:";break;case ye.Class.APPLICATION:t+="Application:";break;case ye.Class.CONTEXT_SPECIFIC:t+="Context-Specific:";break;case ye.Class.PRIVATE:t+="Private:";break}if(i.tagClass===ye.Class.UNIVERSAL)switch(t+=i.type,i.type){case ye.Type.NONE:t+=" (None)";break;case ye.Type.BOOLEAN:t+=" (Boolean)";break;case ye.Type.INTEGER:t+=" (Integer)";break;case ye.Type.BITSTRING:t+=" (Bit string)";break;case ye.Type.OCTETSTRING:t+=" (Octet string)";break;case ye.Type.NULL:t+=" (Null)";break;case ye.Type.OID:t+=" (Object Identifier)";break;case ye.Type.ODESC:t+=" (Object Descriptor)";break;case ye.Type.EXTERNAL:t+=" (External or Instance of)";break;case ye.Type.REAL:t+=" (Real)";break;case ye.Type.ENUMERATED:t+=" (Enumerated)";break;case ye.Type.EMBEDDED:t+=" (Embedded PDV)";break;case ye.Type.UTF8:t+=" (UTF8)";break;case ye.Type.ROID:t+=" (Relative Object Identifier)";break;case ye.Type.SEQUENCE:t+=" (Sequence)";break;case ye.Type.SET:t+=" (Set)";break;case ye.Type.PRINTABLESTRING:t+=" (Printable String)";break;case ye.Type.IA5String:t+=" (IA5String (ASCII))";break;case ye.Type.UTCTIME:t+=" (UTC time)";break;case ye.Type.GENERALIZEDTIME:t+=" (Generalized time)";break;case ye.Type.BMPSTRING:t+=" (BMP String)";break}else t+=i.type;if(t+=`
`,t+=a+"Constructed: "+i.constructed+`
`,i.composed){for(var c=0,u="",n=0;n<i.value.length;++n)i.value[n]!==void 0&&(c+=1,u+=ye.prettyPrint(i.value[n],e+1,r),n+1<i.value.length&&(u+=","));t+=a+"Sub values: "+c+u}else{if(t+=a+"Value: ",i.type===ye.Type.OID){var v=ye.derToOid(i.value);t+=v,Nr.pki&&Nr.pki.oids&&v in Nr.pki.oids&&(t+=" ("+Nr.pki.oids[v]+") ")}if(i.type===ye.Type.INTEGER)try{t+=ye.derToInteger(i.value)}catch{t+="0x"+Nr.util.bytesToHex(i.value)}else if(i.type===ye.Type.BITSTRING){if(i.value.length>1?t+="0x"+Nr.util.bytesToHex(i.value.slice(1)):t+="(none)",i.value.length>0){var o=i.value.charCodeAt(0);o==1?t+=" (1 unused bit shown)":o>1&&(t+=" ("+o+" unused bits shown)")}}else if(i.type===ye.Type.OCTETSTRING)F3.test(i.value)||(t+="("+i.value+") "),t+="0x"+Nr.util.bytesToHex(i.value);else if(i.type===ye.Type.UTF8)try{t+=Nr.util.decodeUtf8(i.value)}catch(h){if(h.message==="URI malformed")t+="0x"+Nr.util.bytesToHex(i.value)+" (malformed UTF8)";else throw h}else i.type===ye.Type.PRINTABLESTRING||i.type===ye.Type.IA5String?t+=i.value:F3.test(i.value)?t+="0x"+Nr.util.bytesToHex(i.value):i.value.length===0?t+="[null]":t+=i.value}return t};var vl=or;vl.md=vl.md||{};vl.md.algorithms=vl.md.algorithms||{};var Un=or,$M=Un.hmac=Un.hmac||{};$M.create=function(){var i=null,e=null,r=null,t=null,a={};return a.start=function(n,c){if(n!==null)if(typeof n=="string")if(n=n.toLowerCase(),n in Un.md.algorithms)e=Un.md.algorithms[n].create();else throw new Error('Unknown hash algorithm "'+n+'"');else e=n;if(c===null)c=i;else{if(typeof c=="string")c=Un.util.createBuffer(c);else if(Un.util.isArray(c)){var u=c;c=Un.util.createBuffer();for(var v=0;v<u.length;++v)c.putByte(u[v])}var o=c.length();o>e.blockLength&&(e.start(),e.update(c.bytes()),c=e.digest()),r=Un.util.createBuffer(),t=Un.util.createBuffer(),o=c.length();for(var v=0;v<o;++v){var u=c.at(v);r.putByte(54^u),t.putByte(92^u)}if(o<e.blockLength)for(var u=e.blockLength-o,v=0;v<u;++v)r.putByte(54),t.putByte(92);i=c,r=r.bytes(),t=t.bytes()}e.start(),e.update(r)},a.update=function(n){e.update(n)},a.getMac=function(){var n=e.digest().bytes();return e.start(),e.update(t),e.update(n),e.digest()},a.digest=a.getMac,a};var bn=or,u4=bn.md5=bn.md5||{};bn.md.md5=bn.md.algorithms.md5=u4;u4.create=function(){h4||ZM();var i=null,e=bn.util.createBuffer(),r=new Array(16),t={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return t.start=function(){t.messageLength=0,t.fullMessageLength=t.messageLength64=[];for(var a=t.messageLengthSize/4,n=0;n<a;++n)t.fullMessageLength.push(0);return e=bn.util.createBuffer(),i={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},t},t.start(),t.update=function(a,n){n==="utf8"&&(a=bn.util.encodeUtf8(a));var c=a.length;t.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var u=t.fullMessageLength.length-1;u>=0;--u)t.fullMessageLength[u]+=c[1],c[1]=c[0]+(t.fullMessageLength[u]/4294967296>>>0),t.fullMessageLength[u]=t.fullMessageLength[u]>>>0,c[0]=c[1]/4294967296>>>0;return e.putBytes(a),q3(i,r,e),(e.read>2048||e.length()===0)&&e.compact(),t},t.digest=function(){var a=bn.util.createBuffer();a.putBytes(e.bytes());var n=t.fullMessageLength[t.fullMessageLength.length-1]+t.messageLengthSize,c=n&t.blockLength-1;a.putBytes(zd.substr(0,t.blockLength-c));for(var u,v=0,o=t.fullMessageLength.length-1;o>=0;--o)u=t.fullMessageLength[o]*8+v,v=u/4294967296>>>0,a.putInt32Le(u>>>0);var h={h0:i.h0,h1:i.h1,h2:i.h2,h3:i.h3};q3(h,r,a);var g=bn.util.createBuffer();return g.putInt32Le(h.h0),g.putInt32Le(h.h1),g.putInt32Le(h.h2),g.putInt32Le(h.h3),g},t};var zd=null,tl=null,co=null,ls=null,h4=!1;function ZM(){zd="",zd+=bn.util.fillString("\0",64),tl=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],co=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],ls=new Array(64);for(var i=0;i<64;++i)ls[i]=Math.floor(Math.abs(Math.sin(i+1))*4294967296);h4=!0}function q3(i,e,r){for(var t,a,n,c,u,v,o,h,g=r.length();g>=64;){for(a=i.h0,n=i.h1,c=i.h2,u=i.h3,h=0;h<16;++h)e[h]=r.getInt32Le(),v=u^n&(c^u),t=a+v+ls[h]+e[h],o=co[h],a=u,u=c,c=n,n+=t<<o|t>>>32-o;for(;h<32;++h)v=c^u&(n^c),t=a+v+ls[h]+e[tl[h]],o=co[h],a=u,u=c,c=n,n+=t<<o|t>>>32-o;for(;h<48;++h)v=n^c^u,t=a+v+ls[h]+e[tl[h]],o=co[h],a=u,u=c,c=n,n+=t<<o|t>>>32-o;for(;h<64;++h)v=c^(n|~u),t=a+v+ls[h]+e[tl[h]],o=co[h],a=u,u=c,c=n,n+=t<<o|t>>>32-o;i.h0=i.h0+a|0,i.h1=i.h1+n|0,i.h2=i.h2+c|0,i.h3=i.h3+u|0,g-=64}}var gl=or,d4=gl.pem=gl.pem||{};d4.encode=function(i,e){e=e||{};var r="-----BEGIN "+i.type+`-----\r
`,t;if(i.procType&&(t={name:"Proc-Type",values:[String(i.procType.version),i.procType.type]},r+=Uf(t)),i.contentDomain&&(t={name:"Content-Domain",values:[i.contentDomain]},r+=Uf(t)),i.dekInfo&&(t={name:"DEK-Info",values:[i.dekInfo.algorithm]},i.dekInfo.parameters&&t.values.push(i.dekInfo.parameters),r+=Uf(t)),i.headers)for(var a=0;a<i.headers.length;++a)r+=Uf(i.headers[a]);return i.procType&&(r+=`\r
`),r+=gl.util.encode64(i.body,e.maxline||64)+`\r
`,r+="-----END "+i.type+`-----\r
`,r};d4.decode=function(i){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,t=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,a=/\r?\n/,n;n=r.exec(i),!!n;){var c=n[1];c==="NEW CERTIFICATE REQUEST"&&(c="CERTIFICATE REQUEST");var u={type:c,procType:null,contentDomain:null,dekInfo:null,headers:[],body:gl.util.decode64(n[3])};if(e.push(u),!!n[2]){for(var v=n[2].split(a),o=0;n&&o<v.length;){for(var h=v[o].replace(/\s+$/,""),g=o+1;g<v.length;++g){var y=v[g];if(!/\s/.test(y[0]))break;h+=y,o=g}if(n=h.match(t),n){for(var _={name:n[1],values:[]},A=n[2].split(","),S=0;S<A.length;++S)_.values.push(jM(A[S]));if(u.procType)if(!u.contentDomain&&_.name==="Content-Domain")u.contentDomain=A[0]||"";else if(!u.dekInfo&&_.name==="DEK-Info"){if(_.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');u.dekInfo={algorithm:A[0],parameters:A[1]||null}}else u.headers.push(_);else{if(_.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(_.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');u.procType={version:A[0],type:A[1]}}}++o}if(u.procType==="ENCRYPTED"&&!u.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Uf(i){for(var e=i.name+": ",r=[],t=function(v,o){return" "+o},a=0;a<i.values.length;++a)r.push(i.values[a].replace(/^(\S+\r\n)/,t));e+=r.join(",")+`\r
`;for(var n=0,c=-1,a=0;a<e.length;++a,++n)if(n>65&&c!==-1){var u=e[c];u===","?(++c,e=e.substr(0,c)+`\r
 `+e.substr(c)):e=e.substr(0,c)+`\r
`+u+e.substr(c+1),n=a-c-1,c=-1,++a}else(e[a]===" "||e[a]==="	"||e[a]===",")&&(c=a);return e}function jM(i){return i.replace(/^\s+/,"")}var Or=or;Or.des=Or.des||{};Or.des.startEncrypting=function(i,e,r,t){var a=lc({key:i,output:r,decrypt:!1,mode:t||(e===null?"ECB":"CBC")});return a.start(e),a};Or.des.createEncryptionCipher=function(i,e){return lc({key:i,output:null,decrypt:!1,mode:e})};Or.des.startDecrypting=function(i,e,r,t){var a=lc({key:i,output:r,decrypt:!0,mode:t||(e===null?"ECB":"CBC")});return a.start(e),a};Or.des.createDecryptionCipher=function(i,e){return lc({key:i,output:null,decrypt:!0,mode:e})};Or.des.Algorithm=function(i,e){var r=this;r.name=i,r.mode=new e({blockSize:8,cipher:{encrypt:function(t,a){return z3(r._keys,t,a,!1)},decrypt:function(t,a){return z3(r._keys,t,a,!0)}}}),r._init=!1};Or.des.Algorithm.prototype.initialize=function(i){if(!this._init){var e=Or.util.createBuffer(i.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=nB(e),this._init=!0}};Bn("DES-ECB",Or.cipher.modes.ecb);Bn("DES-CBC",Or.cipher.modes.cbc);Bn("DES-CFB",Or.cipher.modes.cfb);Bn("DES-OFB",Or.cipher.modes.ofb);Bn("DES-CTR",Or.cipher.modes.ctr);Bn("3DES-ECB",Or.cipher.modes.ecb);Bn("3DES-CBC",Or.cipher.modes.cbc);Bn("3DES-CFB",Or.cipher.modes.cfb);Bn("3DES-OFB",Or.cipher.modes.ofb);Bn("3DES-CTR",Or.cipher.modes.ctr);function Bn(i,e){var r=function(){return new Or.des.Algorithm(i,e)};Or.cipher.registerAlgorithm(i,r)}var WM=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],YM=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],XM=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],JM=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],tB=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],eB=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],rB=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],iB=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function nB(i){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],t=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],a=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],n=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],c=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],u=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],v=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],o=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],g=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],y=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],_=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],A=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],S=i.length()>8?3:1,T=[],B=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],M=0,R,P=0;P<S;P++){var D=i.getInt32(),q=i.getInt32();R=(D>>>4^q)&252645135,q^=R,D^=R<<4,R=(q>>>-16^D)&65535,D^=R,q^=R<<-16,R=(D>>>2^q)&858993459,q^=R,D^=R<<2,R=(q>>>-16^D)&65535,D^=R,q^=R<<-16,R=(D>>>1^q)&1431655765,q^=R,D^=R<<1,R=(q>>>8^D)&16711935,D^=R,q^=R<<8,R=(D>>>1^q)&1431655765,q^=R,D^=R<<1,R=D<<8|q>>>20&240,D=q<<24|q<<8&16711680|q>>>8&65280|q>>>24&240,q=R;for(var k=0;k<B.length;++k){B[k]?(D=D<<2|D>>>26,q=q<<2|q>>>26):(D=D<<1|D>>>27,q=q<<1|q>>>27),D&=-15,q&=-15;var U=e[D>>>28]|r[D>>>24&15]|t[D>>>20&15]|a[D>>>16&15]|n[D>>>12&15]|c[D>>>8&15]|u[D>>>4&15],O=v[q>>>28]|o[q>>>24&15]|h[q>>>20&15]|g[q>>>16&15]|y[q>>>12&15]|_[q>>>8&15]|A[q>>>4&15];R=(O>>>16^U)&65535,T[M++]=U^R,T[M++]=O^R<<16}}return T}function z3(i,e,r,t){var a=i.length===32?3:9,n;a===3?n=t?[30,-2,-2]:[0,32,2]:n=t?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var c,u=e[0],v=e[1];c=(u>>>4^v)&252645135,v^=c,u^=c<<4,c=(u>>>16^v)&65535,v^=c,u^=c<<16,c=(v>>>2^u)&858993459,u^=c,v^=c<<2,c=(v>>>8^u)&16711935,u^=c,v^=c<<8,c=(u>>>1^v)&1431655765,v^=c,u^=c<<1,u=u<<1|u>>>31,v=v<<1|v>>>31;for(var o=0;o<a;o+=3){for(var h=n[o+1],g=n[o+2],y=n[o];y!=h;y+=g){var _=v^i[y],A=(v>>>4|v<<28)^i[y+1];c=u,u=v,v=c^(YM[_>>>24&63]|JM[_>>>16&63]|eB[_>>>8&63]|iB[_&63]|WM[A>>>24&63]|XM[A>>>16&63]|tB[A>>>8&63]|rB[A&63])}c=u,u=v,v=c}u=u>>>1|u<<31,v=v>>>1|v<<31,c=(u>>>1^v)&1431655765,v^=c,u^=c<<1,c=(v>>>8^u)&16711935,u^=c,v^=c<<8,c=(v>>>2^u)&858993459,u^=c,v^=c<<2,c=(u>>>16^v)&65535,v^=c,u^=c<<16,c=(u>>>4^v)&252645135,v^=c,u^=c<<4,r[0]=u,r[1]=v}function lc(i){i=i||{};var e=(i.mode||"CBC").toUpperCase(),r="DES-"+e,t;i.decrypt?t=Or.cipher.createDecipher(r,i.key):t=Or.cipher.createCipher(r,i.key);var a=t.start;return t.start=function(n,c){var u=null;c instanceof Or.util.ByteBuffer&&(u=c,c={}),c=c||{},c.output=u,c.iv=n,a.call(t,c)},t}var ui=or,aB=ui.pkcs5=ui.pkcs5||{},kn;ui.util.isNodejs&&!ui.options.usePureJavaScript&&(kn=ba());ui.pbkdf2=aB.pbkdf2=function(i,e,r,t,a,n){if(typeof a=="function"&&(n=a,a=null),ui.util.isNodejs&&!ui.options.usePureJavaScript&&kn.pbkdf2&&(a===null||typeof a!="object")&&(kn.pbkdf2Sync.length>4||!a||a==="sha1"))return typeof a!="string"&&(a="sha1"),i=Buffer.from(i,"binary"),e=Buffer.from(e,"binary"),n?kn.pbkdf2Sync.length===4?kn.pbkdf2(i,e,r,t,function(R,P){if(R)return n(R);n(null,P.toString("binary"))}):kn.pbkdf2(i,e,r,t,a,function(R,P){if(R)return n(R);n(null,P.toString("binary"))}):kn.pbkdf2Sync.length===4?kn.pbkdf2Sync(i,e,r,t).toString("binary"):kn.pbkdf2Sync(i,e,r,t,a).toString("binary");if((typeof a>"u"||a===null)&&(a="sha1"),typeof a=="string"){if(!(a in ui.md.algorithms))throw new Error("Unknown hash algorithm: "+a);a=ui.md[a].create()}var c=a.digestLength;if(t>4294967295*c){var u=new Error("Derived key is too long.");if(n)return n(u);throw u}var v=Math.ceil(t/c),o=t-(v-1)*c,h=ui.hmac.create();h.start(a,i);var g="",y,_,A;if(!n){for(var S=1;S<=v;++S){h.start(null,null),h.update(e),h.update(ui.util.int32ToBytes(S)),y=A=h.digest().getBytes();for(var T=2;T<=r;++T)h.start(null,null),h.update(A),_=h.digest().getBytes(),y=ui.util.xorBytes(y,_,c),A=_;g+=S<v?y:y.substr(0,o)}return g}var S=1,T;function B(){if(S>v)return n(null,g);h.start(null,null),h.update(e),h.update(ui.util.int32ToBytes(S)),y=A=h.digest().getBytes(),T=2,M()}function M(){if(T<=r)return h.start(null,null),h.update(A),_=h.digest().getBytes(),y=ui.util.xorBytes(y,_,c),A=_,++T,ui.util.setImmediate(M);g+=S<v?y:y.substr(0,o),++S,B()}B()};var _n=or,p4=_n.sha256=_n.sha256||{};_n.md.sha256=_n.md.algorithms.sha256=p4;p4.create=function(){v4||sB();var i=null,e=_n.util.createBuffer(),r=new Array(64),t={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return t.start=function(){t.messageLength=0,t.fullMessageLength=t.messageLength64=[];for(var a=t.messageLengthSize/4,n=0;n<a;++n)t.fullMessageLength.push(0);return e=_n.util.createBuffer(),i={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},t},t.start(),t.update=function(a,n){n==="utf8"&&(a=_n.util.encodeUtf8(a));var c=a.length;t.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var u=t.fullMessageLength.length-1;u>=0;--u)t.fullMessageLength[u]+=c[1],c[1]=c[0]+(t.fullMessageLength[u]/4294967296>>>0),t.fullMessageLength[u]=t.fullMessageLength[u]>>>0,c[0]=c[1]/4294967296>>>0;return e.putBytes(a),V3(i,r,e),(e.read>2048||e.length()===0)&&e.compact(),t},t.digest=function(){var a=_n.util.createBuffer();a.putBytes(e.bytes());var n=t.fullMessageLength[t.fullMessageLength.length-1]+t.messageLengthSize,c=n&t.blockLength-1;a.putBytes(Vd.substr(0,t.blockLength-c));for(var u,v,o=t.fullMessageLength[0]*8,h=0;h<t.fullMessageLength.length-1;++h)u=t.fullMessageLength[h+1]*8,v=u/4294967296>>>0,o+=v,a.putInt32(o>>>0),o=u>>>0;a.putInt32(o);var g={h0:i.h0,h1:i.h1,h2:i.h2,h3:i.h3,h4:i.h4,h5:i.h5,h6:i.h6,h7:i.h7};V3(g,r,a);var y=_n.util.createBuffer();return y.putInt32(g.h0),y.putInt32(g.h1),y.putInt32(g.h2),y.putInt32(g.h3),y.putInt32(g.h4),y.putInt32(g.h5),y.putInt32(g.h6),y.putInt32(g.h7),y},t};var Vd=null,v4=!1,g4=null;function sB(){Vd="",Vd+=_n.util.fillString("\0",64),g4=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],v4=!0}function V3(i,e,r){for(var t,a,n,c,u,v,o,h,g,y,_,A,S,T,B,M=r.length();M>=64;){for(o=0;o<16;++o)e[o]=r.getInt32();for(;o<64;++o)t=e[o-2],t=(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10,a=e[o-15],a=(a>>>7|a<<25)^(a>>>18|a<<14)^a>>>3,e[o]=t+e[o-7]+a+e[o-16]|0;for(h=i.h0,g=i.h1,y=i.h2,_=i.h3,A=i.h4,S=i.h5,T=i.h6,B=i.h7,o=0;o<64;++o)c=(A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7),u=T^A&(S^T),n=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),v=h&g|y&(h^g),t=B+c+u+g4[o]+e[o],a=n+v,B=T,T=S,S=A,A=_+t>>>0,_=y,y=g,g=h,h=t+a>>>0;i.h0=i.h0+h|0,i.h1=i.h1+g|0,i.h2=i.h2+y|0,i.h3=i.h3+_|0,i.h4=i.h4+A|0,i.h5=i.h5+S|0,i.h6=i.h6+T|0,i.h7=i.h7+B|0,M-=64}}var gn=or,el=null;gn.util.isNodejs&&!gn.options.usePureJavaScript&&!process.versions["node-webkit"]&&(el=ba());var oB=gn.prng=gn.prng||{};oB.create=function(i){for(var e={plugin:i,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=i.md,t=new Array(32),a=0;a<32;++a)t[a]=r.create();e.pools=t,e.pool=0,e.generate=function(o,h){if(!h)return e.generateSync(o);var g=e.plugin.cipher,y=e.plugin.increment,_=e.plugin.formatKey,A=e.plugin.formatSeed,S=gn.util.createBuffer();e.key=null,T();function T(B){if(B)return h(B);if(S.length()>=o)return h(null,S.getBytes(o));if(e.generated>1048575&&(e.key=null),e.key===null)return gn.util.nextTick(function(){n(T)});var M=g(e.key,e.seed);e.generated+=M.length,S.putBytes(M),e.key=_(g(e.key,y(e.seed))),e.seed=A(g(e.key,e.seed)),gn.util.setImmediate(T)}},e.generateSync=function(o){var h=e.plugin.cipher,g=e.plugin.increment,y=e.plugin.formatKey,_=e.plugin.formatSeed;e.key=null;for(var A=gn.util.createBuffer();A.length()<o;){e.generated>1048575&&(e.key=null),e.key===null&&c();var S=h(e.key,e.seed);e.generated+=S.length,A.putBytes(S),e.key=y(h(e.key,g(e.seed))),e.seed=_(h(e.key,e.seed))}return A.getBytes(o)};function n(o){if(e.pools[0].messageLength>=32)return u(),o();var h=32-e.pools[0].messageLength<<5;e.seedFile(h,function(g,y){if(g)return o(g);e.collect(y),u(),o()})}function c(){if(e.pools[0].messageLength>=32)return u();var o=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(o)),u()}function u(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var o=e.plugin.md.create();o.update(e.keyBytes);for(var h=1,g=0;g<32;++g)e.reseeds%h===0&&(o.update(e.pools[g].digest().getBytes()),e.pools[g].start()),h=h<<1;e.keyBytes=o.digest().getBytes(),o.start(),o.update(e.keyBytes);var y=o.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(y),e.generated=0}function v(o){var h=null,g=gn.util.globalScope,y=g.crypto||g.msCrypto;y&&y.getRandomValues&&(h=function(D){return y.getRandomValues(D)});var _=gn.util.createBuffer();if(h)for(;_.length()<o;){var A=Math.max(1,Math.min(o-_.length(),65536)/4),S=new Uint32Array(Math.floor(A));try{h(S);for(var T=0;T<S.length;++T)_.putInt32(S[T])}catch(D){if(!(typeof QuotaExceededError<"u"&&D instanceof QuotaExceededError))throw D}}if(_.length()<o)for(var B,M,R,P=Math.floor(Math.random()*65536);_.length()<o;){M=16807*(P&65535),B=16807*(P>>16),M+=(B&32767)<<16,M+=B>>15,M=(M&2147483647)+(M>>31),P=M&4294967295;for(var T=0;T<3;++T)R=P>>>(T<<3),R^=Math.floor(Math.random()*256),_.putByte(R&255)}return _.getBytes(o)}return el?(e.seedFile=function(o,h){el.randomBytes(o,function(g,y){if(g)return h(g);h(null,y.toString())})},e.seedFileSync=function(o){return el.randomBytes(o).toString()}):(e.seedFile=function(o,h){try{h(null,v(o))}catch(g){h(g)}},e.seedFileSync=v),e.collect=function(o){for(var h=o.length,g=0;g<h;++g)e.pools[e.pool].update(o.substr(g,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(o,h){for(var g="",y=0;y<h;y+=8)g+=String.fromCharCode(o>>y&255);e.collect(g)},e.registerWorker=function(o){if(o===self)e.seedFile=function(g,y){function _(A){var S=A.data;S.forge&&S.forge.prng&&(self.removeEventListener("message",_),y(S.forge.prng.err,S.forge.prng.bytes))}self.addEventListener("message",_),self.postMessage({forge:{prng:{needed:g}}})};else{var h=function(g){var y=g.data;y.forge&&y.forge.prng&&e.seedFile(y.forge.prng.needed,function(_,A){o.postMessage({forge:{prng:{err:_,bytes:A}}})})};o.addEventListener("message",h)}},e};var Hr=or;(function(){if(Hr.random&&Hr.random.getBytes){Hr.random;return}(function(i){var e={},r=new Array(4),t=Hr.util.createBuffer();e.formatKey=function(g){var y=Hr.util.createBuffer(g);return g=new Array(4),g[0]=y.getInt32(),g[1]=y.getInt32(),g[2]=y.getInt32(),g[3]=y.getInt32(),Hr.aes._expandKey(g,!1)},e.formatSeed=function(g){var y=Hr.util.createBuffer(g);return g=new Array(4),g[0]=y.getInt32(),g[1]=y.getInt32(),g[2]=y.getInt32(),g[3]=y.getInt32(),g},e.cipher=function(g,y){return Hr.aes._updateBlock(g,y,r,!1),t.putInt32(r[0]),t.putInt32(r[1]),t.putInt32(r[2]),t.putInt32(r[3]),t.getBytes()},e.increment=function(g){return++g[3],g},e.md=Hr.md.sha256;function a(){var g=Hr.prng.create(e);return g.getBytes=function(y,_){return g.generate(y,_)},g.getBytesSync=function(y){return g.generate(y)},g}var n=a(),c=null,u=Hr.util.globalScope,v=u.crypto||u.msCrypto;if(v&&v.getRandomValues&&(c=function(g){return v.getRandomValues(g)}),Hr.options.usePureJavaScript||!Hr.util.isNodejs&&!c){if(n.collectInt(+new Date,32),typeof navigator<"u"){var o="";for(var h in navigator)try{typeof navigator[h]=="string"&&(o+=navigator[h])}catch{}n.collect(o),o=null}i&&(i().mousemove(function(g){n.collectInt(g.clientX,16),n.collectInt(g.clientY,16)}),i().keypress(function(g){n.collectInt(g.charCode,8)}))}if(!Hr.random)Hr.random=n;else for(var h in n)Hr.random[h]=n[h];Hr.random.createInstance=a,Hr.random})(typeof jQuery<"u"?jQuery:null)})();var Ai=or,Gh=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],G3=[1,2,3,5],fB=function(i,e){return i<<e&65535|(i&65535)>>16-e},lB=function(i,e){return(i&65535)>>e|i<<16-e&65535};Ai.rc2=Ai.rc2||{};Ai.rc2.expandKey=function(i,e){typeof i=="string"&&(i=Ai.util.createBuffer(i)),e=e||128;var r=i,t=i.length(),a=e,n=Math.ceil(a/8),c=255>>(a&7),u;for(u=t;u<128;u++)r.putByte(Gh[r.at(u-1)+r.at(u-t)&255]);for(r.setAt(128-n,Gh[r.at(128-n)&c]),u=127-n;u>=0;u--)r.setAt(u,Gh[r.at(u+1)^r.at(u+n)]);return r};var m4=function(i,e,r){var t=!1,a=null,n=null,c=null,u,v,o,h,g=[];for(i=Ai.rc2.expandKey(i,e),o=0;o<64;o++)g.push(i.getInt16Le());r?(u=function(A){for(o=0;o<4;o++)A[o]+=g[h]+(A[(o+3)%4]&A[(o+2)%4])+(~A[(o+3)%4]&A[(o+1)%4]),A[o]=fB(A[o],G3[o]),h++},v=function(A){for(o=0;o<4;o++)A[o]+=g[A[(o+3)%4]&63]}):(u=function(A){for(o=3;o>=0;o--)A[o]=lB(A[o],G3[o]),A[o]-=g[h]+(A[(o+3)%4]&A[(o+2)%4])+(~A[(o+3)%4]&A[(o+1)%4]),h--},v=function(A){for(o=3;o>=0;o--)A[o]-=g[A[(o+3)%4]&63]});var y=function(A){var S=[];for(o=0;o<4;o++){var T=a.getInt16Le();c!==null&&(r?T^=c.getInt16Le():c.putInt16Le(T)),S.push(T&65535)}h=r?0:63;for(var B=0;B<A.length;B++)for(var M=0;M<A[B][0];M++)A[B][1](S);for(o=0;o<4;o++)c!==null&&(r?c.putInt16Le(S[o]):S[o]^=c.getInt16Le()),n.putInt16Le(S[o])},_=null;return _={start:function(A,S){A&&typeof A=="string"&&(A=Ai.util.createBuffer(A)),t=!1,a=Ai.util.createBuffer(),n=S||new Ai.util.createBuffer,c=A,_.output=n},update:function(A){for(t||a.putBuffer(A);a.length()>=8;)y([[5,u],[1,v],[6,u],[1,v],[5,u]])},finish:function(A){var S=!0;if(r)if(A)S=A(8,a,!r);else{var T=a.length()===8?8:8-a.length();a.fillWithByte(T,T)}if(S&&(t=!0,_.update()),!r&&(S=a.length()===0,S))if(A)S=A(8,n,!r);else{var B=n.length(),M=n.at(B-1);M>B?S=!1:n.truncate(M)}return S}},_};Ai.rc2.startEncrypting=function(i,e,r){var t=Ai.rc2.createEncryptionCipher(i,128);return t.start(e,r),t};Ai.rc2.createEncryptionCipher=function(i,e){return m4(i,e,!0)};Ai.rc2.startDecrypting=function(i,e,r){var t=Ai.rc2.createDecryptionCipher(i,128);return t.start(e,r),t};Ai.rc2.createDecryptionCipher=function(i,e){return m4(i,e,!1)};var Gd=or;Gd.jsbn=Gd.jsbn||{};var Gn;function fe(i,e,r){this.data=[],i!=null&&(typeof i=="number"?this.fromNumber(i,e,r):e==null&&typeof i!="string"?this.fromString(i,256):this.fromString(i,e))}Gd.jsbn.BigInteger=fe;function _r(){return new fe(null)}function cB(i,e,r,t,a,n){for(;--n>=0;){var c=e*this.data[i++]+r.data[t]+a;a=Math.floor(c/67108864),r.data[t++]=c&67108863}return a}function uB(i,e,r,t,a,n){for(var c=e&32767,u=e>>15;--n>=0;){var v=this.data[i]&32767,o=this.data[i++]>>15,h=u*v+o*c;v=c*v+((h&32767)<<15)+r.data[t]+(a&1073741823),a=(v>>>30)+(h>>>15)+u*o+(a>>>30),r.data[t++]=v&1073741823}return a}function K3(i,e,r,t,a,n){for(var c=e&16383,u=e>>14;--n>=0;){var v=this.data[i]&16383,o=this.data[i++]>>14,h=u*v+o*c;v=c*v+((h&16383)<<14)+r.data[t]+a,a=(v>>28)+(h>>14)+u*o,r.data[t++]=v&268435455}return a}typeof navigator>"u"?(fe.prototype.am=K3,Gn=28):navigator.appName=="Microsoft Internet Explorer"?(fe.prototype.am=uB,Gn=30):navigator.appName!="Netscape"?(fe.prototype.am=cB,Gn=26):(fe.prototype.am=K3,Gn=28);fe.prototype.DB=Gn;fe.prototype.DM=(1<<Gn)-1;fe.prototype.DV=1<<Gn;var ap=52;fe.prototype.FV=Math.pow(2,ap);fe.prototype.F1=ap-Gn;fe.prototype.F2=2*Gn-ap;var hB="0123456789abcdefghijklmnopqrstuvwxyz",cc=new Array,Gs,Vi;Gs=48;for(Vi=0;Vi<=9;++Vi)cc[Gs++]=Vi;Gs=97;for(Vi=10;Vi<36;++Vi)cc[Gs++]=Vi;Gs=65;for(Vi=10;Vi<36;++Vi)cc[Gs++]=Vi;function H3(i){return hB.charAt(i)}function y4(i,e){var r=cc[i.charCodeAt(e)];return r??-1}function dB(i){for(var e=this.t-1;e>=0;--e)i.data[e]=this.data[e];i.t=this.t,i.s=this.s}function pB(i){this.t=1,this.s=i<0?-1:0,i>0?this.data[0]=i:i<-1?this.data[0]=i+this.DV:this.t=0}function sa(i){var e=_r();return e.fromInt(i),e}function vB(i,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(i,e);return}this.t=0,this.s=0;for(var t=i.length,a=!1,n=0;--t>=0;){var c=r==8?i[t]&255:y4(i,t);if(c<0){i.charAt(t)=="-"&&(a=!0);continue}a=!1,n==0?this.data[this.t++]=c:n+r>this.DB?(this.data[this.t-1]|=(c&(1<<this.DB-n)-1)<<n,this.data[this.t++]=c>>this.DB-n):this.data[this.t-1]|=c<<n,n+=r,n>=this.DB&&(n-=this.DB)}r==8&&i[0]&128&&(this.s=-1,n>0&&(this.data[this.t-1]|=(1<<this.DB-n)-1<<n)),this.clamp(),a&&fe.ZERO.subTo(this,this)}function gB(){for(var i=this.s&this.DM;this.t>0&&this.data[this.t-1]==i;)--this.t}function mB(i){if(this.s<0)return"-"+this.negate().toString(i);var e;if(i==16)e=4;else if(i==8)e=3;else if(i==2)e=1;else if(i==32)e=5;else if(i==4)e=2;else return this.toRadix(i);var r=(1<<e)-1,t,a=!1,n="",c=this.t,u=this.DB-c*this.DB%e;if(c-- >0)for(u<this.DB&&(t=this.data[c]>>u)>0&&(a=!0,n=H3(t));c>=0;)u<e?(t=(this.data[c]&(1<<u)-1)<<e-u,t|=this.data[--c]>>(u+=this.DB-e)):(t=this.data[c]>>(u-=e)&r,u<=0&&(u+=this.DB,--c)),t>0&&(a=!0),a&&(n+=H3(t));return a?n:"0"}function yB(){var i=_r();return fe.ZERO.subTo(this,i),i}function bB(){return this.s<0?this.negate():this}function _B(i){var e=this.s-i.s;if(e!=0)return e;var r=this.t;if(e=r-i.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-i.data[r])!=0)return e;return 0}function uc(i){var e=1,r;return(r=i>>>16)!=0&&(i=r,e+=16),(r=i>>8)!=0&&(i=r,e+=8),(r=i>>4)!=0&&(i=r,e+=4),(r=i>>2)!=0&&(i=r,e+=2),(r=i>>1)!=0&&(i=r,e+=1),e}function wB(){return this.t<=0?0:this.DB*(this.t-1)+uc(this.data[this.t-1]^this.s&this.DM)}function CB(i,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+i]=this.data[r];for(r=i-1;r>=0;--r)e.data[r]=0;e.t=this.t+i,e.s=this.s}function EB(i,e){for(var r=i;r<this.t;++r)e.data[r-i]=this.data[r];e.t=Math.max(this.t-i,0),e.s=this.s}function AB(i,e){var r=i%this.DB,t=this.DB-r,a=(1<<t)-1,n=Math.floor(i/this.DB),c=this.s<<r&this.DM,u;for(u=this.t-1;u>=0;--u)e.data[u+n+1]=this.data[u]>>t|c,c=(this.data[u]&a)<<r;for(u=n-1;u>=0;--u)e.data[u]=0;e.data[n]=c,e.t=this.t+n+1,e.s=this.s,e.clamp()}function SB(i,e){e.s=this.s;var r=Math.floor(i/this.DB);if(r>=this.t){e.t=0;return}var t=i%this.DB,a=this.DB-t,n=(1<<t)-1;e.data[0]=this.data[r]>>t;for(var c=r+1;c<this.t;++c)e.data[c-r-1]|=(this.data[c]&n)<<a,e.data[c-r]=this.data[c]>>t;t>0&&(e.data[this.t-r-1]|=(this.s&n)<<a),e.t=this.t-r,e.clamp()}function xB(i,e){for(var r=0,t=0,a=Math.min(i.t,this.t);r<a;)t+=this.data[r]-i.data[r],e.data[r++]=t&this.DM,t>>=this.DB;if(i.t<this.t){for(t-=i.s;r<this.t;)t+=this.data[r],e.data[r++]=t&this.DM,t>>=this.DB;t+=this.s}else{for(t+=this.s;r<i.t;)t-=i.data[r],e.data[r++]=t&this.DM,t>>=this.DB;t-=i.s}e.s=t<0?-1:0,t<-1?e.data[r++]=this.DV+t:t>0&&(e.data[r++]=t),e.t=r,e.clamp()}function IB(i,e){var r=this.abs(),t=i.abs(),a=r.t;for(e.t=a+t.t;--a>=0;)e.data[a]=0;for(a=0;a<t.t;++a)e.data[a+r.t]=r.am(0,t.data[a],e,a,0,r.t);e.s=0,e.clamp(),this.s!=i.s&&fe.ZERO.subTo(e,e)}function MB(i){for(var e=this.abs(),r=i.t=2*e.t;--r>=0;)i.data[r]=0;for(r=0;r<e.t-1;++r){var t=e.am(r,e.data[r],i,2*r,0,1);(i.data[r+e.t]+=e.am(r+1,2*e.data[r],i,2*r+1,t,e.t-r-1))>=e.DV&&(i.data[r+e.t]-=e.DV,i.data[r+e.t+1]=1)}i.t>0&&(i.data[i.t-1]+=e.am(r,e.data[r],i,2*r,0,1)),i.s=0,i.clamp()}function BB(i,e,r){var t=i.abs();if(!(t.t<=0)){var a=this.abs();if(a.t<t.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=_r());var n=_r(),c=this.s,u=i.s,v=this.DB-uc(t.data[t.t-1]);v>0?(t.lShiftTo(v,n),a.lShiftTo(v,r)):(t.copyTo(n),a.copyTo(r));var o=n.t,h=n.data[o-1];if(h!=0){var g=h*(1<<this.F1)+(o>1?n.data[o-2]>>this.F2:0),y=this.FV/g,_=(1<<this.F1)/g,A=1<<this.F2,S=r.t,T=S-o,B=e??_r();for(n.dlShiftTo(T,B),r.compareTo(B)>=0&&(r.data[r.t++]=1,r.subTo(B,r)),fe.ONE.dlShiftTo(o,B),B.subTo(n,n);n.t<o;)n.data[n.t++]=0;for(;--T>=0;){var M=r.data[--S]==h?this.DM:Math.floor(r.data[S]*y+(r.data[S-1]+A)*_);if((r.data[S]+=n.am(0,M,r,T,0,o))<M)for(n.dlShiftTo(T,B),r.subTo(B,r);r.data[S]<--M;)r.subTo(B,r)}e!=null&&(r.drShiftTo(o,e),c!=u&&fe.ZERO.subTo(e,e)),r.t=o,r.clamp(),v>0&&r.rShiftTo(v,r),c<0&&fe.ZERO.subTo(r,r)}}}function LB(i){var e=_r();return this.abs().divRemTo(i,null,e),this.s<0&&e.compareTo(fe.ZERO)>0&&i.subTo(e,e),e}function es(i){this.m=i}function TB(i){return i.s<0||i.compareTo(this.m)>=0?i.mod(this.m):i}function RB(i){return i}function NB(i){i.divRemTo(this.m,null,i)}function kB(i,e,r){i.multiplyTo(e,r),this.reduce(r)}function PB(i,e){i.squareTo(e),this.reduce(e)}es.prototype.convert=TB;es.prototype.revert=RB;es.prototype.reduce=NB;es.prototype.mulTo=kB;es.prototype.sqrTo=PB;function UB(){if(this.t<1)return 0;var i=this.data[0];if(!(i&1))return 0;var e=i&3;return e=e*(2-(i&15)*e)&15,e=e*(2-(i&255)*e)&255,e=e*(2-((i&65535)*e&65535))&65535,e=e*(2-i*e%this.DV)%this.DV,e>0?this.DV-e:-e}function rs(i){this.m=i,this.mp=i.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<i.DB-15)-1,this.mt2=2*i.t}function DB(i){var e=_r();return i.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),i.s<0&&e.compareTo(fe.ZERO)>0&&this.m.subTo(e,e),e}function OB(i){var e=_r();return i.copyTo(e),this.reduce(e),e}function FB(i){for(;i.t<=this.mt2;)i.data[i.t++]=0;for(var e=0;e<this.m.t;++e){var r=i.data[e]&32767,t=r*this.mpl+((r*this.mph+(i.data[e]>>15)*this.mpl&this.um)<<15)&i.DM;for(r=e+this.m.t,i.data[r]+=this.m.am(0,t,i,e,0,this.m.t);i.data[r]>=i.DV;)i.data[r]-=i.DV,i.data[++r]++}i.clamp(),i.drShiftTo(this.m.t,i),i.compareTo(this.m)>=0&&i.subTo(this.m,i)}function qB(i,e){i.squareTo(e),this.reduce(e)}function zB(i,e,r){i.multiplyTo(e,r),this.reduce(r)}rs.prototype.convert=DB;rs.prototype.revert=OB;rs.prototype.reduce=FB;rs.prototype.mulTo=zB;rs.prototype.sqrTo=qB;function VB(){return(this.t>0?this.data[0]&1:this.s)==0}function GB(i,e){if(i>4294967295||i<1)return fe.ONE;var r=_r(),t=_r(),a=e.convert(this),n=uc(i)-1;for(a.copyTo(r);--n>=0;)if(e.sqrTo(r,t),(i&1<<n)>0)e.mulTo(t,a,r);else{var c=r;r=t,t=c}return e.revert(r)}function KB(i,e){var r;return i<256||e.isEven()?r=new es(e):r=new rs(e),this.exp(i,r)}fe.prototype.copyTo=dB;fe.prototype.fromInt=pB;fe.prototype.fromString=vB;fe.prototype.clamp=gB;fe.prototype.dlShiftTo=CB;fe.prototype.drShiftTo=EB;fe.prototype.lShiftTo=AB;fe.prototype.rShiftTo=SB;fe.prototype.subTo=xB;fe.prototype.multiplyTo=IB;fe.prototype.squareTo=MB;fe.prototype.divRemTo=BB;fe.prototype.invDigit=UB;fe.prototype.isEven=VB;fe.prototype.exp=GB;fe.prototype.toString=mB;fe.prototype.negate=yB;fe.prototype.abs=bB;fe.prototype.compareTo=_B;fe.prototype.bitLength=wB;fe.prototype.mod=LB;fe.prototype.modPowInt=KB;fe.ZERO=sa(0);fe.ONE=sa(1);function HB(){var i=_r();return this.copyTo(i),i}function QB(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function $B(){return this.t==0?this.s:this.data[0]<<24>>24}function ZB(){return this.t==0?this.s:this.data[0]<<16>>16}function jB(i){return Math.floor(Math.LN2*this.DB/Math.log(i))}function WB(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function YB(i){if(i==null&&(i=10),this.signum()==0||i<2||i>36)return"0";var e=this.chunkSize(i),r=Math.pow(i,e),t=sa(r),a=_r(),n=_r(),c="";for(this.divRemTo(t,a,n);a.signum()>0;)c=(r+n.intValue()).toString(i).substr(1)+c,a.divRemTo(t,a,n);return n.intValue().toString(i)+c}function XB(i,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),t=Math.pow(e,r),a=!1,n=0,c=0,u=0;u<i.length;++u){var v=y4(i,u);if(v<0){i.charAt(u)=="-"&&this.signum()==0&&(a=!0);continue}c=e*c+v,++n>=r&&(this.dMultiply(t),this.dAddOffset(c,0),n=0,c=0)}n>0&&(this.dMultiply(Math.pow(e,n)),this.dAddOffset(c,0)),a&&fe.ZERO.subTo(this,this)}function JB(i,e,r){if(typeof e=="number")if(i<2)this.fromInt(1);else for(this.fromNumber(i,r),this.testBit(i-1)||this.bitwiseTo(fe.ONE.shiftLeft(i-1),sp,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>i&&this.subTo(fe.ONE.shiftLeft(i-1),this);else{var t=new Array,a=i&7;t.length=(i>>3)+1,e.nextBytes(t),a>0?t[0]&=(1<<a)-1:t[0]=0,this.fromString(t,256)}}function tL(){var i=this.t,e=new Array;e[0]=this.s;var r=this.DB-i*this.DB%8,t,a=0;if(i-- >0)for(r<this.DB&&(t=this.data[i]>>r)!=(this.s&this.DM)>>r&&(e[a++]=t|this.s<<this.DB-r);i>=0;)r<8?(t=(this.data[i]&(1<<r)-1)<<8-r,t|=this.data[--i]>>(r+=this.DB-8)):(t=this.data[i]>>(r-=8)&255,r<=0&&(r+=this.DB,--i)),t&128&&(t|=-256),a==0&&(this.s&128)!=(t&128)&&++a,(a>0||t!=this.s)&&(e[a++]=t);return e}function eL(i){return this.compareTo(i)==0}function rL(i){return this.compareTo(i)<0?this:i}function iL(i){return this.compareTo(i)>0?this:i}function nL(i,e,r){var t,a,n=Math.min(i.t,this.t);for(t=0;t<n;++t)r.data[t]=e(this.data[t],i.data[t]);if(i.t<this.t){for(a=i.s&this.DM,t=n;t<this.t;++t)r.data[t]=e(this.data[t],a);r.t=this.t}else{for(a=this.s&this.DM,t=n;t<i.t;++t)r.data[t]=e(a,i.data[t]);r.t=i.t}r.s=e(this.s,i.s),r.clamp()}function aL(i,e){return i&e}function sL(i){var e=_r();return this.bitwiseTo(i,aL,e),e}function sp(i,e){return i|e}function oL(i){var e=_r();return this.bitwiseTo(i,sp,e),e}function b4(i,e){return i^e}function fL(i){var e=_r();return this.bitwiseTo(i,b4,e),e}function _4(i,e){return i&~e}function lL(i){var e=_r();return this.bitwiseTo(i,_4,e),e}function cL(){for(var i=_r(),e=0;e<this.t;++e)i.data[e]=this.DM&~this.data[e];return i.t=this.t,i.s=~this.s,i}function uL(i){var e=_r();return i<0?this.rShiftTo(-i,e):this.lShiftTo(i,e),e}function hL(i){var e=_r();return i<0?this.lShiftTo(-i,e):this.rShiftTo(i,e),e}function dL(i){if(i==0)return-1;var e=0;return i&65535||(i>>=16,e+=16),i&255||(i>>=8,e+=8),i&15||(i>>=4,e+=4),i&3||(i>>=2,e+=2),i&1||++e,e}function pL(){for(var i=0;i<this.t;++i)if(this.data[i]!=0)return i*this.DB+dL(this.data[i]);return this.s<0?this.t*this.DB:-1}function vL(i){for(var e=0;i!=0;)i&=i-1,++e;return e}function gL(){for(var i=0,e=this.s&this.DM,r=0;r<this.t;++r)i+=vL(this.data[r]^e);return i}function mL(i){var e=Math.floor(i/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<i%this.DB)!=0}function yL(i,e){var r=fe.ONE.shiftLeft(i);return this.bitwiseTo(r,e,r),r}function bL(i){return this.changeBit(i,sp)}function _L(i){return this.changeBit(i,_4)}function wL(i){return this.changeBit(i,b4)}function CL(i,e){for(var r=0,t=0,a=Math.min(i.t,this.t);r<a;)t+=this.data[r]+i.data[r],e.data[r++]=t&this.DM,t>>=this.DB;if(i.t<this.t){for(t+=i.s;r<this.t;)t+=this.data[r],e.data[r++]=t&this.DM,t>>=this.DB;t+=this.s}else{for(t+=this.s;r<i.t;)t+=i.data[r],e.data[r++]=t&this.DM,t>>=this.DB;t+=i.s}e.s=t<0?-1:0,t>0?e.data[r++]=t:t<-1&&(e.data[r++]=this.DV+t),e.t=r,e.clamp()}function EL(i){var e=_r();return this.addTo(i,e),e}function AL(i){var e=_r();return this.subTo(i,e),e}function SL(i){var e=_r();return this.multiplyTo(i,e),e}function xL(i){var e=_r();return this.divRemTo(i,e,null),e}function IL(i){var e=_r();return this.divRemTo(i,null,e),e}function ML(i){var e=_r(),r=_r();return this.divRemTo(i,e,r),new Array(e,r)}function BL(i){this.data[this.t]=this.am(0,i-1,this,0,0,this.t),++this.t,this.clamp()}function LL(i,e){if(i!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=i;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function ff(){}function w4(i){return i}function TL(i,e,r){i.multiplyTo(e,r)}function RL(i,e){i.squareTo(e)}ff.prototype.convert=w4;ff.prototype.revert=w4;ff.prototype.mulTo=TL;ff.prototype.sqrTo=RL;function NL(i){return this.exp(i,new ff)}function kL(i,e,r){var t=Math.min(this.t+i.t,e);for(r.s=0,r.t=t;t>0;)r.data[--t]=0;var a;for(a=r.t-this.t;t<a;++t)r.data[t+this.t]=this.am(0,i.data[t],r,t,0,this.t);for(a=Math.min(i.t,e);t<a;++t)this.am(0,i.data[t],r,t,0,e-t);r.clamp()}function PL(i,e,r){--e;var t=r.t=this.t+i.t-e;for(r.s=0;--t>=0;)r.data[t]=0;for(t=Math.max(e-this.t,0);t<i.t;++t)r.data[this.t+t-e]=this.am(e-t,i.data[t],r,0,0,this.t+t-e);r.clamp(),r.drShiftTo(1,r)}function Ks(i){this.r2=_r(),this.q3=_r(),fe.ONE.dlShiftTo(2*i.t,this.r2),this.mu=this.r2.divide(i),this.m=i}function UL(i){if(i.s<0||i.t>2*this.m.t)return i.mod(this.m);if(i.compareTo(this.m)<0)return i;var e=_r();return i.copyTo(e),this.reduce(e),e}function DL(i){return i}function OL(i){for(i.drShiftTo(this.m.t-1,this.r2),i.t>this.m.t+1&&(i.t=this.m.t+1,i.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);i.compareTo(this.r2)<0;)i.dAddOffset(1,this.m.t+1);for(i.subTo(this.r2,i);i.compareTo(this.m)>=0;)i.subTo(this.m,i)}function FL(i,e){i.squareTo(e),this.reduce(e)}function qL(i,e,r){i.multiplyTo(e,r),this.reduce(r)}Ks.prototype.convert=UL;Ks.prototype.revert=DL;Ks.prototype.reduce=OL;Ks.prototype.mulTo=qL;Ks.prototype.sqrTo=FL;function zL(i,e){var r=i.bitLength(),t,a=sa(1),n;if(r<=0)return a;r<18?t=1:r<48?t=3:r<144?t=4:r<768?t=5:t=6,r<8?n=new es(e):e.isEven()?n=new Ks(e):n=new rs(e);var c=new Array,u=3,v=t-1,o=(1<<t)-1;if(c[1]=n.convert(this),t>1){var h=_r();for(n.sqrTo(c[1],h);u<=o;)c[u]=_r(),n.mulTo(h,c[u-2],c[u]),u+=2}var g=i.t-1,y,_=!0,A=_r(),S;for(r=uc(i.data[g])-1;g>=0;){for(r>=v?y=i.data[g]>>r-v&o:(y=(i.data[g]&(1<<r+1)-1)<<v-r,g>0&&(y|=i.data[g-1]>>this.DB+r-v)),u=t;!(y&1);)y>>=1,--u;if((r-=u)<0&&(r+=this.DB,--g),_)c[y].copyTo(a),_=!1;else{for(;u>1;)n.sqrTo(a,A),n.sqrTo(A,a),u-=2;u>0?n.sqrTo(a,A):(S=a,a=A,A=S),n.mulTo(A,c[y],a)}for(;g>=0&&!(i.data[g]&1<<r);)n.sqrTo(a,A),S=a,a=A,A=S,--r<0&&(r=this.DB-1,--g)}return n.revert(a)}function VL(i){var e=this.s<0?this.negate():this.clone(),r=i.s<0?i.negate():i.clone();if(e.compareTo(r)<0){var t=e;e=r,r=t}var a=e.getLowestSetBit(),n=r.getLowestSetBit();if(n<0)return e;for(a<n&&(n=a),n>0&&(e.rShiftTo(n,e),r.rShiftTo(n,r));e.signum()>0;)(a=e.getLowestSetBit())>0&&e.rShiftTo(a,e),(a=r.getLowestSetBit())>0&&r.rShiftTo(a,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return n>0&&r.lShiftTo(n,r),r}function GL(i){if(i<=0)return 0;var e=this.DV%i,r=this.s<0?i-1:0;if(this.t>0)if(e==0)r=this.data[0]%i;else for(var t=this.t-1;t>=0;--t)r=(e*r+this.data[t])%i;return r}function KL(i){var e=i.isEven();if(this.isEven()&&e||i.signum()==0)return fe.ZERO;for(var r=i.clone(),t=this.clone(),a=sa(1),n=sa(0),c=sa(0),u=sa(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!a.isEven()||!n.isEven())&&(a.addTo(this,a),n.subTo(i,n)),a.rShiftTo(1,a)):n.isEven()||n.subTo(i,n),n.rShiftTo(1,n);for(;t.isEven();)t.rShiftTo(1,t),e?((!c.isEven()||!u.isEven())&&(c.addTo(this,c),u.subTo(i,u)),c.rShiftTo(1,c)):u.isEven()||u.subTo(i,u),u.rShiftTo(1,u);r.compareTo(t)>=0?(r.subTo(t,r),e&&a.subTo(c,a),n.subTo(u,n)):(t.subTo(r,t),e&&c.subTo(a,c),u.subTo(n,u))}if(t.compareTo(fe.ONE)!=0)return fe.ZERO;if(u.compareTo(i)>=0)return u.subtract(i);if(u.signum()<0)u.addTo(i,u);else return u;return u.signum()<0?u.add(i):u}var Ji=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],HL=(1<<26)/Ji[Ji.length-1];function QL(i){var e,r=this.abs();if(r.t==1&&r.data[0]<=Ji[Ji.length-1]){for(e=0;e<Ji.length;++e)if(r.data[0]==Ji[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Ji.length;){for(var t=Ji[e],a=e+1;a<Ji.length&&t<HL;)t*=Ji[a++];for(t=r.modInt(t);e<a;)if(t%Ji[e++]==0)return!1}return r.millerRabin(i)}function $L(i){var e=this.subtract(fe.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var t=e.shiftRight(r),a=ZL(),n,c=0;c<i;++c){do n=new fe(this.bitLength(),a);while(n.compareTo(fe.ONE)<=0||n.compareTo(e)>=0);var u=n.modPow(t,this);if(u.compareTo(fe.ONE)!=0&&u.compareTo(e)!=0){for(var v=1;v++<r&&u.compareTo(e)!=0;)if(u=u.modPowInt(2,this),u.compareTo(fe.ONE)==0)return!1;if(u.compareTo(e)!=0)return!1}}return!0}function ZL(){return{nextBytes:function(i){for(var e=0;e<i.length;++e)i[e]=Math.floor(Math.random()*256)}}}fe.prototype.chunkSize=jB;fe.prototype.toRadix=YB;fe.prototype.fromRadix=XB;fe.prototype.fromNumber=JB;fe.prototype.bitwiseTo=nL;fe.prototype.changeBit=yL;fe.prototype.addTo=CL;fe.prototype.dMultiply=BL;fe.prototype.dAddOffset=LL;fe.prototype.multiplyLowerTo=kL;fe.prototype.multiplyUpperTo=PL;fe.prototype.modInt=GL;fe.prototype.millerRabin=$L;fe.prototype.clone=HB;fe.prototype.intValue=QB;fe.prototype.byteValue=$B;fe.prototype.shortValue=ZB;fe.prototype.signum=WB;fe.prototype.toByteArray=tL;fe.prototype.equals=eL;fe.prototype.min=rL;fe.prototype.max=iL;fe.prototype.and=sL;fe.prototype.or=oL;fe.prototype.xor=fL;fe.prototype.andNot=lL;fe.prototype.not=cL;fe.prototype.shiftLeft=uL;fe.prototype.shiftRight=hL;fe.prototype.getLowestSetBit=pL;fe.prototype.bitCount=gL;fe.prototype.testBit=mL;fe.prototype.setBit=bL;fe.prototype.clearBit=_L;fe.prototype.flipBit=wL;fe.prototype.add=EL;fe.prototype.subtract=AL;fe.prototype.multiply=SL;fe.prototype.divide=xL;fe.prototype.remainder=IL;fe.prototype.divideAndRemainder=ML;fe.prototype.modPow=zL;fe.prototype.modInverse=KL;fe.prototype.pow=NL;fe.prototype.gcd=VL;fe.prototype.isProbablePrime=QL;var wn=or,C4=wn.sha1=wn.sha1||{};wn.md.sha1=wn.md.algorithms.sha1=C4;C4.create=function(){E4||jL();var i=null,e=wn.util.createBuffer(),r=new Array(80),t={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return t.start=function(){t.messageLength=0,t.fullMessageLength=t.messageLength64=[];for(var a=t.messageLengthSize/4,n=0;n<a;++n)t.fullMessageLength.push(0);return e=wn.util.createBuffer(),i={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},t},t.start(),t.update=function(a,n){n==="utf8"&&(a=wn.util.encodeUtf8(a));var c=a.length;t.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var u=t.fullMessageLength.length-1;u>=0;--u)t.fullMessageLength[u]+=c[1],c[1]=c[0]+(t.fullMessageLength[u]/4294967296>>>0),t.fullMessageLength[u]=t.fullMessageLength[u]>>>0,c[0]=c[1]/4294967296>>>0;return e.putBytes(a),Q3(i,r,e),(e.read>2048||e.length()===0)&&e.compact(),t},t.digest=function(){var a=wn.util.createBuffer();a.putBytes(e.bytes());var n=t.fullMessageLength[t.fullMessageLength.length-1]+t.messageLengthSize,c=n&t.blockLength-1;a.putBytes(Kd.substr(0,t.blockLength-c));for(var u,v,o=t.fullMessageLength[0]*8,h=0;h<t.fullMessageLength.length-1;++h)u=t.fullMessageLength[h+1]*8,v=u/4294967296>>>0,o+=v,a.putInt32(o>>>0),o=u>>>0;a.putInt32(o);var g={h0:i.h0,h1:i.h1,h2:i.h2,h3:i.h3,h4:i.h4};Q3(g,r,a);var y=wn.util.createBuffer();return y.putInt32(g.h0),y.putInt32(g.h1),y.putInt32(g.h2),y.putInt32(g.h3),y.putInt32(g.h4),y},t};var Kd=null,E4=!1;function jL(){Kd="",Kd+=wn.util.fillString("\0",64),E4=!0}function Q3(i,e,r){for(var t,a,n,c,u,v,o,h,g=r.length();g>=64;){for(a=i.h0,n=i.h1,c=i.h2,u=i.h3,v=i.h4,h=0;h<16;++h)t=r.getInt32(),e[h]=t,o=u^n&(c^u),t=(a<<5|a>>>27)+o+v+1518500249+t,v=u,u=c,c=(n<<30|n>>>2)>>>0,n=a,a=t;for(;h<20;++h)t=e[h-3]^e[h-8]^e[h-14]^e[h-16],t=t<<1|t>>>31,e[h]=t,o=u^n&(c^u),t=(a<<5|a>>>27)+o+v+1518500249+t,v=u,u=c,c=(n<<30|n>>>2)>>>0,n=a,a=t;for(;h<32;++h)t=e[h-3]^e[h-8]^e[h-14]^e[h-16],t=t<<1|t>>>31,e[h]=t,o=n^c^u,t=(a<<5|a>>>27)+o+v+1859775393+t,v=u,u=c,c=(n<<30|n>>>2)>>>0,n=a,a=t;for(;h<40;++h)t=e[h-6]^e[h-16]^e[h-28]^e[h-32],t=t<<2|t>>>30,e[h]=t,o=n^c^u,t=(a<<5|a>>>27)+o+v+1859775393+t,v=u,u=c,c=(n<<30|n>>>2)>>>0,n=a,a=t;for(;h<60;++h)t=e[h-6]^e[h-16]^e[h-28]^e[h-32],t=t<<2|t>>>30,e[h]=t,o=n&c|u&(n^c),t=(a<<5|a>>>27)+o+v+2400959708+t,v=u,u=c,c=(n<<30|n>>>2)>>>0,n=a,a=t;for(;h<80;++h)t=e[h-6]^e[h-16]^e[h-28]^e[h-32],t=t<<2|t>>>30,e[h]=t,o=n^c^u,t=(a<<5|a>>>27)+o+v+3395469782+t,v=u,u=c,c=(n<<30|n>>>2)>>>0,n=a,a=t;i.h0=i.h0+a|0,i.h1=i.h1+n|0,i.h2=i.h2+c|0,i.h3=i.h3+u|0,i.h4=i.h4+v|0,g-=64}}var Cn=or,A4=Cn.pkcs1=Cn.pkcs1||{};A4.encode_rsa_oaep=function(i,e,r){var t,a,n,c;typeof r=="string"?(t=r,a=arguments[3]||void 0,n=arguments[4]||void 0):r&&(t=r.label||void 0,a=r.seed||void 0,n=r.md||void 0,r.mgf1&&r.mgf1.md&&(c=r.mgf1.md)),n?n.start():n=Cn.md.sha1.create(),c||(c=n);var u=Math.ceil(i.n.bitLength()/8),v=u-2*n.digestLength-2;if(e.length>v){var o=new Error("RSAES-OAEP input message length is too long.");throw o.length=e.length,o.maxLength=v,o}t||(t=""),n.update(t,"raw");for(var h=n.digest(),g="",y=v-e.length,_=0;_<y;_++)g+="\0";var A=h.getBytes()+g+""+e;if(!a)a=Cn.random.getBytes(n.digestLength);else if(a.length!==n.digestLength){var o=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw o.seedLength=a.length,o.digestLength=n.digestLength,o}var S=ml(a,u-n.digestLength-1,c),T=Cn.util.xorBytes(A,S,A.length),B=ml(T,n.digestLength,c),M=Cn.util.xorBytes(a,B,a.length);return"\0"+M+T};A4.decode_rsa_oaep=function(i,e,r){var t,a,n;typeof r=="string"?(t=r,a=arguments[3]||void 0):r&&(t=r.label||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(n=r.mgf1.md));var c=Math.ceil(i.n.bitLength()/8);if(e.length!==c){var T=new Error("RSAES-OAEP encoded message length is invalid.");throw T.length=e.length,T.expectedLength=c,T}if(a===void 0?a=Cn.md.sha1.create():a.start(),n||(n=a),c<2*a.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");t||(t=""),a.update(t,"raw");for(var u=a.digest().getBytes(),v=e.charAt(0),o=e.substring(1,a.digestLength+1),h=e.substring(1+a.digestLength),g=ml(h,a.digestLength,n),y=Cn.util.xorBytes(o,g,o.length),_=ml(y,c-a.digestLength-1,n),A=Cn.util.xorBytes(h,_,h.length),S=A.substring(0,a.digestLength),T=v!=="\0",B=0;B<a.digestLength;++B)T|=u.charAt(B)!==S.charAt(B);for(var M=1,R=a.digestLength,P=a.digestLength;P<A.length;P++){var D=A.charCodeAt(P),q=D&1^1,k=M?65534:0;T|=D&k,M=M&q,R+=M}if(T||A.charCodeAt(R)!==1)throw new Error("Invalid RSAES-OAEP padding.");return A.substring(R+1)};function ml(i,e,r){r||(r=Cn.md.sha1.create());for(var t="",a=Math.ceil(e/r.digestLength),n=0;n<a;++n){var c=String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255);r.start(),r.update(i+c),t+=r.digest().getBytes()}return t.substring(0,e)}var Yn=or;(function(){if(Yn.prime){Yn.prime;return}var i=Yn.prime=Yn.prime||{},e=Yn.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],t=new e(null);t.fromInt(30);var a=function(g,y){return g|y};i.generateProbablePrime=function(g,y,_){typeof y=="function"&&(_=y,y={}),y=y||{};var A=y.algorithm||"PRIMEINC";typeof A=="string"&&(A={name:A}),A.options=A.options||{};var S=y.prng||Yn.random,T={nextBytes:function(B){for(var M=S.getBytesSync(B.length),R=0;R<B.length;++R)B[R]=M.charCodeAt(R)}};if(A.name==="PRIMEINC")return n(g,T,A.options,_);throw new Error("Invalid prime generation algorithm: "+A.name)};function n(g,y,_,A){return"workers"in _?v(g,y,_,A):c(g,y,_,A)}function c(g,y,_,A){var S=o(g,y),T=0,B=h(S.bitLength());"millerRabinTests"in _&&(B=_.millerRabinTests);var M=10;"maxBlockTime"in _&&(M=_.maxBlockTime),u(S,g,y,T,B,M,A)}function u(g,y,_,A,S,T,B){var M=+new Date;do{if(g.bitLength()>y&&(g=o(y,_)),g.isProbablePrime(S))return B(null,g);g.dAddOffset(r[A++%8],0)}while(T<0||+new Date-M<T);Yn.util.setImmediate(function(){u(g,y,_,A,S,T,B)})}function v(g,y,_,A){if(typeof Worker>"u")return c(g,y,_,A);var S=o(g,y),T=_.workers,B=_.workLoad||100,M=B*30/8,R=_.workerScript||"forge/prime.worker.js";if(T===-1)return Yn.util.estimateCores(function(D,q){D&&(q=2),T=q-1,P()});P();function P(){T=Math.max(1,T);for(var D=[],q=0;q<T;++q)D[q]=new Worker(R);for(var q=0;q<T;++q)D[q].addEventListener("message",U);var k=!1;function U(O){if(!k){var G=O.data;if(G.found){for(var E=0;E<D.length;++E)D[E].terminate();return k=!0,A(null,new e(G.prime,16))}S.bitLength()>g&&(S=o(g,y));var s=S.toString(16);O.target.postMessage({hex:s,workLoad:B}),S.dAddOffset(M,0)}}}}function o(g,y){var _=new e(g,y),A=g-1;return _.testBit(A)||_.bitwiseTo(e.ONE.shiftLeft(A),a,_),_.dAddOffset(31-_.mod(t).byteValue(),0),_}function h(g){return g<=100?27:g<=150?18:g<=200?15:g<=250?12:g<=300?9:g<=350?8:g<=400?7:g<=500?6:g<=600?5:g<=800?4:g<=1250?3:2}})();var Ie=or;if(typeof mr>"u")var mr=Ie.jsbn.BigInteger;var Hd=Ie.util.isNodejs?ba():null,Xt=Ie.asn1,Gi=Ie.util;Ie.pki=Ie.pki||{};Ie.pki.rsa=Ie.rsa=Ie.rsa||{};var He=Ie.pki,WL=[6,4,2,4,2,4,6,2],YL={name:"PrivateKeyInfo",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},XL={name:"RSAPrivateKey",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},JL={name:"RSAPublicKey",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},tT=Ie.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},eT={name:"DigestInfo",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:Xt.Class.UNIVERSAL,type:Xt.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},rT=function(i){var e;if(i.algorithm in He.oids)e=He.oids[i.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=i.algorithm,r}var t=Xt.oidToDer(e).getBytes(),a=Xt.create(Xt.Class.UNIVERSAL,Xt.Type.SEQUENCE,!0,[]),n=Xt.create(Xt.Class.UNIVERSAL,Xt.Type.SEQUENCE,!0,[]);n.value.push(Xt.create(Xt.Class.UNIVERSAL,Xt.Type.OID,!1,t)),n.value.push(Xt.create(Xt.Class.UNIVERSAL,Xt.Type.NULL,!1,""));var c=Xt.create(Xt.Class.UNIVERSAL,Xt.Type.OCTETSTRING,!1,i.digest().getBytes());return a.value.push(n),a.value.push(c),Xt.toDer(a).getBytes()},S4=function(i,e,r){if(r)return i.modPow(e.e,e.n);if(!e.p||!e.q)return i.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(mr.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(mr.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var t;do t=new mr(Ie.util.bytesToHex(Ie.random.getBytes(e.n.bitLength()/8)),16);while(t.compareTo(e.n)>=0||!t.gcd(e.n).equals(mr.ONE));i=i.multiply(t.modPow(e.e,e.n)).mod(e.n);for(var a=i.mod(e.p).modPow(e.dP,e.p),n=i.mod(e.q).modPow(e.dQ,e.q);a.compareTo(n)<0;)a=a.add(e.p);var c=a.subtract(n).multiply(e.qInv).mod(e.p).multiply(e.q).add(n);return c=c.multiply(t.modInverse(e.n)).mod(e.n),c};He.rsa.encrypt=function(i,e,r){var t=r,a,n=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(t=r===2,a=x4(i,e,r)):(a=Ie.util.createBuffer(),a.putBytes(i));for(var c=new mr(a.toHex(),16),u=S4(c,e,t),v=u.toString(16),o=Ie.util.createBuffer(),h=n-Math.ceil(v.length/2);h>0;)o.putByte(0),--h;return o.putBytes(Ie.util.hexToBytes(v)),o.getBytes()};He.rsa.decrypt=function(i,e,r,t){var a=Math.ceil(e.n.bitLength()/8);if(i.length!==a){var n=new Error("Encrypted message length is invalid.");throw n.length=i.length,n.expected=a,n}var c=new mr(Ie.util.createBuffer(i).toHex(),16);if(c.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var u=S4(c,e,r),v=u.toString(16),o=Ie.util.createBuffer(),h=a-Math.ceil(v.length/2);h>0;)o.putByte(0),--h;return o.putBytes(Ie.util.hexToBytes(v)),t!==!1?yl(o.getBytes(),e,r):o.getBytes()};He.rsa.createKeyPairGenerationState=function(i,e,r){typeof i=="string"&&(i=parseInt(i,10)),i=i||2048,r=r||{};var t=r.prng||Ie.random,a={nextBytes:function(u){for(var v=t.getBytesSync(u.length),o=0;o<u.length;++o)u[o]=v.charCodeAt(o)}},n=r.algorithm||"PRIMEINC",c;if(n==="PRIMEINC")c={algorithm:n,state:0,bits:i,rng:a,eInt:e||65537,e:new mr(null),p:null,q:null,qBits:i>>1,pBits:i-(i>>1),pqState:0,num:null,keys:null},c.e.fromInt(c.eInt);else throw new Error("Invalid key generation algorithm: "+n);return c};He.rsa.stepKeyPairGenerationState=function(i,e){"algorithm"in i||(i.algorithm="PRIMEINC");var r=new mr(null);r.fromInt(30);for(var t=0,a=function(g,y){return g|y},n=+new Date,c,u=0;i.keys===null&&(e<=0||u<e);){if(i.state===0){var v=i.p===null?i.pBits:i.qBits,o=v-1;i.pqState===0?(i.num=new mr(v,i.rng),i.num.testBit(o)||i.num.bitwiseTo(mr.ONE.shiftLeft(o),a,i.num),i.num.dAddOffset(31-i.num.mod(r).byteValue(),0),t=0,++i.pqState):i.pqState===1?i.num.bitLength()>v?i.pqState=0:i.num.isProbablePrime(nT(i.num.bitLength()))?++i.pqState:i.num.dAddOffset(WL[t++%8],0):i.pqState===2?i.pqState=i.num.subtract(mr.ONE).gcd(i.e).compareTo(mr.ONE)===0?3:0:i.pqState===3&&(i.pqState=0,i.p===null?i.p=i.num:i.q=i.num,i.p!==null&&i.q!==null&&++i.state,i.num=null)}else if(i.state===1)i.p.compareTo(i.q)<0&&(i.num=i.p,i.p=i.q,i.q=i.num),++i.state;else if(i.state===2)i.p1=i.p.subtract(mr.ONE),i.q1=i.q.subtract(mr.ONE),i.phi=i.p1.multiply(i.q1),++i.state;else if(i.state===3)i.phi.gcd(i.e).compareTo(mr.ONE)===0?++i.state:(i.p=null,i.q=null,i.state=0);else if(i.state===4)i.n=i.p.multiply(i.q),i.n.bitLength()===i.bits?++i.state:(i.q=null,i.state=0);else if(i.state===5){var h=i.e.modInverse(i.phi);i.keys={privateKey:He.rsa.setPrivateKey(i.n,i.e,h,i.p,i.q,h.mod(i.p1),h.mod(i.q1),i.q.modInverse(i.p)),publicKey:He.rsa.setPublicKey(i.n,i.e)}}c=+new Date,u+=c-n,n=c}return i.keys!==null};He.rsa.generateKeyPair=function(i,e,r,t){if(arguments.length===1?typeof i=="object"?(r=i,i=void 0):typeof i=="function"&&(t=i,i=void 0):arguments.length===2?typeof i=="number"?typeof e=="function"?(t=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=i,t=e,i=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(t=r,r=void 0):(t=r,r=e,e=void 0)),r=r||{},i===void 0&&(i=r.bits||2048),e===void 0&&(e=r.e||65537),!Ie.options.usePureJavaScript&&!r.prng&&i>=256&&i<=16384&&(e===65537||e===3)){if(t){if($3("generateKeyPair"))return Hd.generateKeyPair("rsa",{modulusLength:i,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(u,v,o){if(u)return t(u);t(null,{privateKey:He.privateKeyFromPem(o),publicKey:He.publicKeyFromPem(v)})});if(Z3("generateKey")&&Z3("exportKey"))return Gi.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:i,publicExponent:W3(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(u){return Gi.globalScope.crypto.subtle.exportKey("pkcs8",u.privateKey)}).then(void 0,function(u){t(u)}).then(function(u){if(u){var v=He.privateKeyFromAsn1(Xt.fromDer(Ie.util.createBuffer(u)));t(null,{privateKey:v,publicKey:He.setRsaPublicKey(v.n,v.e)})}});if(j3("generateKey")&&j3("exportKey")){var a=Gi.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:i,publicExponent:W3(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);a.oncomplete=function(u){var v=u.target.result,o=Gi.globalScope.msCrypto.subtle.exportKey("pkcs8",v.privateKey);o.oncomplete=function(h){var g=h.target.result,y=He.privateKeyFromAsn1(Xt.fromDer(Ie.util.createBuffer(g)));t(null,{privateKey:y,publicKey:He.setRsaPublicKey(y.n,y.e)})},o.onerror=function(h){t(h)}},a.onerror=function(u){t(u)};return}}else if($3("generateKeyPairSync")){var n=Hd.generateKeyPairSync("rsa",{modulusLength:i,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:He.privateKeyFromPem(n.privateKey),publicKey:He.publicKeyFromPem(n.publicKey)}}}var c=He.rsa.createKeyPairGenerationState(i,e,r);if(!t)return He.rsa.stepKeyPairGenerationState(c,0),c.keys;iT(c,r,t)};He.setRsaPublicKey=He.rsa.setPublicKey=function(i,e){var r={n:i,e};return r.encrypt=function(t,a,n){if(typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSAES-PKCS1-V1_5"),a==="RSAES-PKCS1-V1_5")a={encode:function(u,v,o){return x4(u,v,2).getBytes()}};else if(a==="RSA-OAEP"||a==="RSAES-OAEP")a={encode:function(u,v){return Ie.pkcs1.encode_rsa_oaep(v,u,n)}};else if(["RAW","NONE","NULL",null].indexOf(a)!==-1)a={encode:function(u){return u}};else if(typeof a=="string")throw new Error('Unsupported encryption scheme: "'+a+'".');var c=a.encode(t,r,!0);return He.rsa.encrypt(c,r,!0)},r.verify=function(t,a,n,c){typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSASSA-PKCS1-V1_5"),c===void 0&&(c={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in c||(c._parseAllDigestBytes=!0),n==="RSASSA-PKCS1-V1_5"?n={verify:function(v,o){o=yl(o,r,!0);var h=Xt.fromDer(o,{parseAllBytes:c._parseAllDigestBytes}),g={},y=[];if(!Xt.validate(h,eT,g,y)){var _=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw _.errors=y,_}var A=Xt.derToOid(g.algorithmIdentifier);if(!(A===Ie.oids.md2||A===Ie.oids.md5||A===Ie.oids.sha1||A===Ie.oids.sha224||A===Ie.oids.sha256||A===Ie.oids.sha384||A===Ie.oids.sha512||A===Ie.oids["sha512-224"]||A===Ie.oids["sha512-256"])){var _=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw _.oid=A,_}if((A===Ie.oids.md2||A===Ie.oids.md5)&&!("parameters"in g))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return v===g.digest}}:(n==="NONE"||n==="NULL"||n===null)&&(n={verify:function(v,o){return o=yl(o,r,!0),v===o}});var u=He.rsa.decrypt(a,r,!0,!1);return n.verify(t,u,r.n.bitLength())},r};He.setRsaPrivateKey=He.rsa.setPrivateKey=function(i,e,r,t,a,n,c,u){var v={n:i,e,d:r,p:t,q:a,dP:n,dQ:c,qInv:u};return v.decrypt=function(o,h,g){typeof h=="string"?h=h.toUpperCase():h===void 0&&(h="RSAES-PKCS1-V1_5");var y=He.rsa.decrypt(o,v,!1,!1);if(h==="RSAES-PKCS1-V1_5")h={decode:yl};else if(h==="RSA-OAEP"||h==="RSAES-OAEP")h={decode:function(_,A){return Ie.pkcs1.decode_rsa_oaep(A,_,g)}};else if(["RAW","NONE","NULL",null].indexOf(h)!==-1)h={decode:function(_){return _}};else throw new Error('Unsupported encryption scheme: "'+h+'".');return h.decode(y,v,!1)},v.sign=function(o,h){var g=!1;typeof h=="string"&&(h=h.toUpperCase()),h===void 0||h==="RSASSA-PKCS1-V1_5"?(h={encode:rT},g=1):(h==="NONE"||h==="NULL"||h===null)&&(h={encode:function(){return o}},g=1);var y=h.encode(o,v.n.bitLength());return He.rsa.encrypt(y,v,g)},v};He.wrapRsaPrivateKey=function(i){return Xt.create(Xt.Class.UNIVERSAL,Xt.Type.SEQUENCE,!0,[Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,Xt.integerToDer(0).getBytes()),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.SEQUENCE,!0,[Xt.create(Xt.Class.UNIVERSAL,Xt.Type.OID,!1,Xt.oidToDer(He.oids.rsaEncryption).getBytes()),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.NULL,!1,"")]),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.OCTETSTRING,!1,Xt.toDer(i).getBytes())])};He.privateKeyFromAsn1=function(i){var e={},r=[];if(Xt.validate(i,YL,e,r)&&(i=Xt.fromDer(Ie.util.createBuffer(e.privateKey))),e={},r=[],!Xt.validate(i,XL,e,r)){var t=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw t.errors=r,t}var a,n,c,u,v,o,h,g;return a=Ie.util.createBuffer(e.privateKeyModulus).toHex(),n=Ie.util.createBuffer(e.privateKeyPublicExponent).toHex(),c=Ie.util.createBuffer(e.privateKeyPrivateExponent).toHex(),u=Ie.util.createBuffer(e.privateKeyPrime1).toHex(),v=Ie.util.createBuffer(e.privateKeyPrime2).toHex(),o=Ie.util.createBuffer(e.privateKeyExponent1).toHex(),h=Ie.util.createBuffer(e.privateKeyExponent2).toHex(),g=Ie.util.createBuffer(e.privateKeyCoefficient).toHex(),He.setRsaPrivateKey(new mr(a,16),new mr(n,16),new mr(c,16),new mr(u,16),new mr(v,16),new mr(o,16),new mr(h,16),new mr(g,16))};He.privateKeyToAsn1=He.privateKeyToRSAPrivateKey=function(i){return Xt.create(Xt.Class.UNIVERSAL,Xt.Type.SEQUENCE,!0,[Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,Xt.integerToDer(0).getBytes()),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,pn(i.n)),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,pn(i.e)),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,pn(i.d)),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,pn(i.p)),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,pn(i.q)),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,pn(i.dP)),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,pn(i.dQ)),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,pn(i.qInv))])};He.publicKeyFromAsn1=function(i){var e={},r=[];if(Xt.validate(i,tT,e,r)){var t=Xt.derToOid(e.publicKeyOid);if(t!==He.oids.rsaEncryption){var a=new Error("Cannot read public key. Unknown OID.");throw a.oid=t,a}i=e.rsaPublicKey}if(r=[],!Xt.validate(i,JL,e,r)){var a=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw a.errors=r,a}var n=Ie.util.createBuffer(e.publicKeyModulus).toHex(),c=Ie.util.createBuffer(e.publicKeyExponent).toHex();return He.setRsaPublicKey(new mr(n,16),new mr(c,16))};He.publicKeyToAsn1=He.publicKeyToSubjectPublicKeyInfo=function(i){return Xt.create(Xt.Class.UNIVERSAL,Xt.Type.SEQUENCE,!0,[Xt.create(Xt.Class.UNIVERSAL,Xt.Type.SEQUENCE,!0,[Xt.create(Xt.Class.UNIVERSAL,Xt.Type.OID,!1,Xt.oidToDer(He.oids.rsaEncryption).getBytes()),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.NULL,!1,"")]),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.BITSTRING,!1,[He.publicKeyToRSAPublicKey(i)])])};He.publicKeyToRSAPublicKey=function(i){return Xt.create(Xt.Class.UNIVERSAL,Xt.Type.SEQUENCE,!0,[Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,pn(i.n)),Xt.create(Xt.Class.UNIVERSAL,Xt.Type.INTEGER,!1,pn(i.e))])};function x4(i,e,r){var t=Ie.util.createBuffer(),a=Math.ceil(e.n.bitLength()/8);if(i.length>a-11){var n=new Error("Message is too long for PKCS#1 v1.5 padding.");throw n.length=i.length,n.max=a-11,n}t.putByte(0),t.putByte(r);var c=a-3-i.length,u;if(r===0||r===1){u=r===0?0:255;for(var v=0;v<c;++v)t.putByte(u)}else for(;c>0;){for(var o=0,h=Ie.random.getBytes(c),v=0;v<c;++v)u=h.charCodeAt(v),u===0?++o:t.putByte(u);c=o}return t.putByte(0),t.putBytes(i),t}function yl(i,e,r,t){var a=Math.ceil(e.n.bitLength()/8),n=Ie.util.createBuffer(i),c=n.getByte(),u=n.getByte();if(c!==0||r&&u!==0&&u!==1||!r&&u!=2||r&&u===0&&typeof t>"u")throw new Error("Encryption block is invalid.");var v=0;if(u===0){v=a-3-t;for(var o=0;o<v;++o)if(n.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(u===1)for(v=0;n.length()>1;){if(n.getByte()!==255){--n.read;break}++v}else if(u===2)for(v=0;n.length()>1;){if(n.getByte()===0){--n.read;break}++v}var h=n.getByte();if(h!==0||v!==a-3-n.length())throw new Error("Encryption block is invalid.");return n.getBytes()}function iT(i,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var t={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(t.prng=e.prng),a();function a(){n(i.pBits,function(u,v){if(u)return r(u);if(i.p=v,i.q!==null)return c(u,i.q);n(i.qBits,c)})}function n(u,v){Ie.prime.generateProbablePrime(u,t,v)}function c(u,v){if(u)return r(u);if(i.q=v,i.p.compareTo(i.q)<0){var o=i.p;i.p=i.q,i.q=o}if(i.p.subtract(mr.ONE).gcd(i.e).compareTo(mr.ONE)!==0){i.p=null,a();return}if(i.q.subtract(mr.ONE).gcd(i.e).compareTo(mr.ONE)!==0){i.q=null,n(i.qBits,c);return}if(i.p1=i.p.subtract(mr.ONE),i.q1=i.q.subtract(mr.ONE),i.phi=i.p1.multiply(i.q1),i.phi.gcd(i.e).compareTo(mr.ONE)!==0){i.p=i.q=null,a();return}if(i.n=i.p.multiply(i.q),i.n.bitLength()!==i.bits){i.q=null,n(i.qBits,c);return}var h=i.e.modInverse(i.phi);i.keys={privateKey:He.rsa.setPrivateKey(i.n,i.e,h,i.p,i.q,h.mod(i.p1),h.mod(i.q1),i.q.modInverse(i.p)),publicKey:He.rsa.setPublicKey(i.n,i.e)},r(null,i.keys)}}function pn(i){var e=i.toString(16);e[0]>="8"&&(e="00"+e);var r=Ie.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function nT(i){return i<=100?27:i<=150?18:i<=200?15:i<=250?12:i<=300?9:i<=350?8:i<=400?7:i<=500?6:i<=600?5:i<=800?4:i<=1250?3:2}function $3(i){return Ie.util.isNodejs&&typeof Hd[i]=="function"}function Z3(i){return typeof Gi.globalScope<"u"&&typeof Gi.globalScope.crypto=="object"&&typeof Gi.globalScope.crypto.subtle=="object"&&typeof Gi.globalScope.crypto.subtle[i]=="function"}function j3(i){return typeof Gi.globalScope<"u"&&typeof Gi.globalScope.msCrypto=="object"&&typeof Gi.globalScope.msCrypto.subtle=="object"&&typeof Gi.globalScope.msCrypto.subtle[i]=="function"}function W3(i){for(var e=Ie.util.hexToBytes(i.toString(16)),r=new Uint8Array(e.length),t=0;t<e.length;++t)r[t]=e.charCodeAt(t);return r}var Ce=or;if(typeof aT>"u")var aT=Ce.jsbn.BigInteger;var re=Ce.asn1,Ye=Ce.pki=Ce.pki||{};Ye.pbe=Ce.pbe=Ce.pbe||{};var Ma=Ye.oids,sT={name:"EncryptedPrivateKeyInfo",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:re.Class.UNIVERSAL,type:re.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:re.Class.UNIVERSAL,type:re.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},oT={name:"PBES2Algorithms",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:re.Class.UNIVERSAL,type:re.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:re.Class.UNIVERSAL,type:re.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:re.Class.UNIVERSAL,type:re.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:re.Class.UNIVERSAL,type:re.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:re.Class.UNIVERSAL,type:re.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},fT={name:"pkcs-12PbeParams",tagClass:re.Class.UNIVERSAL,type:re.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:re.Class.UNIVERSAL,type:re.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:re.Class.UNIVERSAL,type:re.Type.INTEGER,constructed:!1,capture:"iterations"}]};Ye.encryptPrivateKeyInfo=function(i,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var t=Ce.random.getBytesSync(r.saltSize),a=r.count,n=re.integerToDer(a),c,u,v;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var o,h,g;switch(r.algorithm){case"aes128":c=16,o=16,h=Ma["aes128-CBC"],g=Ce.aes.createEncryptionCipher;break;case"aes192":c=24,o=16,h=Ma["aes192-CBC"],g=Ce.aes.createEncryptionCipher;break;case"aes256":c=32,o=16,h=Ma["aes256-CBC"],g=Ce.aes.createEncryptionCipher;break;case"des":c=8,o=8,h=Ma.desCBC,g=Ce.des.createEncryptionCipher;break;default:var y=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw y.algorithm=r.algorithm,y}var _="hmacWith"+r.prfAlgorithm.toUpperCase(),A=M4(_),S=Ce.pkcs5.pbkdf2(e,t,a,c,A),T=Ce.random.getBytesSync(o),B=g(S);B.start(T),B.update(re.toDer(i)),B.finish(),v=B.output.getBytes();var M=lT(t,n,c,_);u=re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.OID,!1,re.oidToDer(Ma.pkcs5PBES2).getBytes()),re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.OID,!1,re.oidToDer(Ma.pkcs5PBKDF2).getBytes()),M]),re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.OID,!1,re.oidToDer(h).getBytes()),re.create(re.Class.UNIVERSAL,re.Type.OCTETSTRING,!1,T)])])])}else if(r.algorithm==="3des"){c=24;var R=new Ce.util.ByteBuffer(t),S=Ye.pbe.generatePkcs12Key(e,R,1,a,c),T=Ye.pbe.generatePkcs12Key(e,R,2,a,c),B=Ce.des.createEncryptionCipher(S);B.start(T),B.update(re.toDer(i)),B.finish(),v=B.output.getBytes(),u=re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.OID,!1,re.oidToDer(Ma["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.OCTETSTRING,!1,t),re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,n.getBytes())])])}else{var y=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw y.algorithm=r.algorithm,y}var P=re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[u,re.create(re.Class.UNIVERSAL,re.Type.OCTETSTRING,!1,v)]);return P};Ye.decryptPrivateKeyInfo=function(i,e){var r=null,t={},a=[];if(!re.validate(i,sT,t,a)){var n=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=a,n}var c=re.derToOid(t.encryptionOid),u=Ye.pbe.getCipher(c,t.encryptionParams,e),v=Ce.util.createBuffer(t.encryptedData);return u.update(v),u.finish()&&(r=re.fromDer(u.output)),r};Ye.encryptedPrivateKeyToPem=function(i,e){var r={type:"ENCRYPTED PRIVATE KEY",body:re.toDer(i).getBytes()};return Ce.pem.encode(r,{maxline:e})};Ye.encryptedPrivateKeyFromPem=function(i){var e=Ce.pem.decode(i)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return re.fromDer(e.body)};Ye.encryptRsaPrivateKey=function(i,e,r){if(r=r||{},!r.legacy){var t=Ye.wrapRsaPrivateKey(Ye.privateKeyToAsn1(i));return t=Ye.encryptPrivateKeyInfo(t,e,r),Ye.encryptedPrivateKeyToPem(t)}var a,n,c,u;switch(r.algorithm){case"aes128":a="AES-128-CBC",c=16,n=Ce.random.getBytesSync(16),u=Ce.aes.createEncryptionCipher;break;case"aes192":a="AES-192-CBC",c=24,n=Ce.random.getBytesSync(16),u=Ce.aes.createEncryptionCipher;break;case"aes256":a="AES-256-CBC",c=32,n=Ce.random.getBytesSync(16),u=Ce.aes.createEncryptionCipher;break;case"3des":a="DES-EDE3-CBC",c=24,n=Ce.random.getBytesSync(8),u=Ce.des.createEncryptionCipher;break;case"des":a="DES-CBC",c=8,n=Ce.random.getBytesSync(8),u=Ce.des.createEncryptionCipher;break;default:var v=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw v.algorithm=r.algorithm,v}var o=Ce.pbe.opensslDeriveBytes(e,n.substr(0,8),c),h=u(o);h.start(n),h.update(re.toDer(Ye.privateKeyToAsn1(i))),h.finish();var g={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:a,parameters:Ce.util.bytesToHex(n).toUpperCase()},body:h.output.getBytes()};return Ce.pem.encode(g)};Ye.decryptRsaPrivateKey=function(i,e){var r=null,t=Ce.pem.decode(i)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"&&t.type!=="PRIVATE KEY"&&t.type!=="RSA PRIVATE KEY"){var a=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw a.headerType=a,a}if(t.procType&&t.procType.type==="ENCRYPTED"){var n,c;switch(t.dekInfo.algorithm){case"DES-CBC":n=8,c=Ce.des.createDecryptionCipher;break;case"DES-EDE3-CBC":n=24,c=Ce.des.createDecryptionCipher;break;case"AES-128-CBC":n=16,c=Ce.aes.createDecryptionCipher;break;case"AES-192-CBC":n=24,c=Ce.aes.createDecryptionCipher;break;case"AES-256-CBC":n=32,c=Ce.aes.createDecryptionCipher;break;case"RC2-40-CBC":n=5,c=function(g){return Ce.rc2.createDecryptionCipher(g,40)};break;case"RC2-64-CBC":n=8,c=function(g){return Ce.rc2.createDecryptionCipher(g,64)};break;case"RC2-128-CBC":n=16,c=function(g){return Ce.rc2.createDecryptionCipher(g,128)};break;default:var a=new Error('Could not decrypt private key; unsupported encryption algorithm "'+t.dekInfo.algorithm+'".');throw a.algorithm=t.dekInfo.algorithm,a}var u=Ce.util.hexToBytes(t.dekInfo.parameters),v=Ce.pbe.opensslDeriveBytes(e,u.substr(0,8),n),o=c(v);if(o.start(u),o.update(Ce.util.createBuffer(t.body)),o.finish())r=o.output.getBytes();else return r}else r=t.body;return t.type==="ENCRYPTED PRIVATE KEY"?r=Ye.decryptPrivateKeyInfo(re.fromDer(r),e):r=re.fromDer(r),r!==null&&(r=Ye.privateKeyFromAsn1(r)),r};Ye.pbe.generatePkcs12Key=function(i,e,r,t,a,n){var c,u;if(typeof n>"u"||n===null){if(!("sha1"in Ce.md))throw new Error('"sha1" hash algorithm unavailable.');n=Ce.md.sha1.create()}var v=n.digestLength,o=n.blockLength,h=new Ce.util.ByteBuffer,g=new Ce.util.ByteBuffer;if(i!=null){for(u=0;u<i.length;u++)g.putInt16(i.charCodeAt(u));g.putInt16(0)}var y=g.length(),_=e.length(),A=new Ce.util.ByteBuffer;A.fillWithByte(r,o);var S=o*Math.ceil(_/o),T=new Ce.util.ByteBuffer;for(u=0;u<S;u++)T.putByte(e.at(u%_));var B=o*Math.ceil(y/o),M=new Ce.util.ByteBuffer;for(u=0;u<B;u++)M.putByte(g.at(u%y));var R=T;R.putBuffer(M);for(var P=Math.ceil(a/v),D=1;D<=P;D++){var q=new Ce.util.ByteBuffer;q.putBytes(A.bytes()),q.putBytes(R.bytes());for(var k=0;k<t;k++)n.start(),n.update(q.getBytes()),q=n.digest();var U=new Ce.util.ByteBuffer;for(u=0;u<o;u++)U.putByte(q.at(u%v));var O=Math.ceil(_/o)+Math.ceil(y/o),G=new Ce.util.ByteBuffer;for(c=0;c<O;c++){var E=new Ce.util.ByteBuffer(R.getBytes(o)),s=511;for(u=U.length()-1;u>=0;u--)s=s>>8,s+=U.at(u)+E.at(u),E.setAt(u,s&255);G.putBuffer(E)}R=G,h.putBuffer(q)}return h.truncate(h.length()-a),h};Ye.pbe.getCipher=function(i,e,r){switch(i){case Ye.oids.pkcs5PBES2:return Ye.pbe.getCipherForPBES2(i,e,r);case Ye.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Ye.oids["pbewithSHAAnd40BitRC2-CBC"]:return Ye.pbe.getCipherForPKCS12PBE(i,e,r);default:var t=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw t.oid=i,t.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],t}};Ye.pbe.getCipherForPBES2=function(i,e,r){var t={},a=[];if(!re.validate(e,oT,t,a)){var n=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=a,n}if(i=re.derToOid(t.kdfOid),i!==Ye.oids.pkcs5PBKDF2){var n=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw n.oid=i,n.supportedOids=["pkcs5PBKDF2"],n}if(i=re.derToOid(t.encOid),i!==Ye.oids["aes128-CBC"]&&i!==Ye.oids["aes192-CBC"]&&i!==Ye.oids["aes256-CBC"]&&i!==Ye.oids["des-EDE3-CBC"]&&i!==Ye.oids.desCBC){var n=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw n.oid=i,n.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],n}var c=t.kdfSalt,u=Ce.util.createBuffer(t.kdfIterationCount);u=u.getInt(u.length()<<3);var v,o;switch(Ye.oids[i]){case"aes128-CBC":v=16,o=Ce.aes.createDecryptionCipher;break;case"aes192-CBC":v=24,o=Ce.aes.createDecryptionCipher;break;case"aes256-CBC":v=32,o=Ce.aes.createDecryptionCipher;break;case"des-EDE3-CBC":v=24,o=Ce.des.createDecryptionCipher;break;case"desCBC":v=8,o=Ce.des.createDecryptionCipher;break}var h=I4(t.prfOid),g=Ce.pkcs5.pbkdf2(r,c,u,v,h),y=t.encIv,_=o(g);return _.start(y),_};Ye.pbe.getCipherForPKCS12PBE=function(i,e,r){var t={},a=[];if(!re.validate(e,fT,t,a)){var n=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw n.errors=a,n}var c=Ce.util.createBuffer(t.salt),u=Ce.util.createBuffer(t.iterations);u=u.getInt(u.length()<<3);var v,o,h;switch(i){case Ye.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:v=24,o=8,h=Ce.des.startDecrypting;break;case Ye.oids["pbewithSHAAnd40BitRC2-CBC"]:v=5,o=8,h=function(S,T){var B=Ce.rc2.createDecryptionCipher(S,40);return B.start(T,null),B};break;default:var n=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw n.oid=i,n}var g=I4(t.prfOid),y=Ye.pbe.generatePkcs12Key(r,c,1,u,v,g);g.start();var _=Ye.pbe.generatePkcs12Key(r,c,2,u,o,g);return h(y,_)};Ye.pbe.opensslDeriveBytes=function(i,e,r,t){if(typeof t>"u"||t===null){if(!("md5"in Ce.md))throw new Error('"md5" hash algorithm unavailable.');t=Ce.md.md5.create()}e===null&&(e="");for(var a=[Y3(t,i+e)],n=16,c=1;n<r;++c,n+=16)a.push(Y3(t,a[c-1]+i+e));return a.join("").substr(0,r)};function Y3(i,e){return i.start().update(e).digest().getBytes()}function I4(i){var e;if(!i)e="hmacWithSHA1";else if(e=Ye.oids[re.derToOid(i)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=i,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return M4(e)}function M4(i){var e=Ce.md;switch(i){case"hmacWithSHA224":e=Ce.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":i=i.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=i,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(i in e))throw new Error("Unknown hash algorithm: "+i);return e[i].create()}function lT(i,e,r,t){var a=re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.OCTETSTRING,!1,i),re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,e.getBytes())]);return t!=="hmacWithSHA1"&&a.value.push(re.create(re.Class.UNIVERSAL,re.Type.INTEGER,!1,Ce.util.hexToBytes(r.toString(16))),re.create(re.Class.UNIVERSAL,re.Type.SEQUENCE,!0,[re.create(re.Class.UNIVERSAL,re.Type.OID,!1,re.oidToDer(Ye.oids[t]).getBytes()),re.create(re.Class.UNIVERSAL,re.Type.NULL,!1,"")])),a}var As=or,be=As.asn1,Hs=As.pkcs7asn1=As.pkcs7asn1||{};As.pkcs7=As.pkcs7||{};As.pkcs7.asn1=Hs;var B4={name:"ContentInfo",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:be.Class.UNIVERSAL,type:be.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:be.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};Hs.contentInfoValidator=B4;var L4={name:"EncryptedContentInfo",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:be.Class.UNIVERSAL,type:be.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:be.Class.UNIVERSAL,type:be.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:be.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:be.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};Hs.envelopedDataValidator={name:"EnvelopedData",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:be.Class.UNIVERSAL,type:be.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:be.Class.UNIVERSAL,type:be.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(L4)};Hs.encryptedDataValidator={name:"EncryptedData",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:be.Class.UNIVERSAL,type:be.Type.INTEGER,constructed:!1,capture:"version"}].concat(L4)};var cT={name:"SignerInfo",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:be.Class.UNIVERSAL,type:be.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:be.Class.UNIVERSAL,type:be.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:be.Class.UNIVERSAL,type:be.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:be.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:be.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:be.Class.UNIVERSAL,type:be.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:be.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};Hs.signedDataValidator={name:"SignedData",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:be.Class.UNIVERSAL,type:be.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:be.Class.UNIVERSAL,type:be.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},B4,{name:"SignedData.Certificates",tagClass:be.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:be.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:be.Class.UNIVERSAL,type:be.Type.SET,capture:"signerInfos",optional:!0,value:[cT]}]};Hs.recipientInfoValidator={name:"RecipientInfo",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:be.Class.UNIVERSAL,type:be.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:be.Class.UNIVERSAL,type:be.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:be.Class.UNIVERSAL,type:be.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:be.Class.UNIVERSAL,type:be.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:be.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:be.Class.UNIVERSAL,type:be.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]};var Ga=or;Ga.mgf=Ga.mgf||{};var uT=Ga.mgf.mgf1=Ga.mgf1=Ga.mgf1||{};uT.create=function(i){var e={generate:function(r,t){for(var a=new Ga.util.ByteBuffer,n=Math.ceil(t/i.digestLength),c=0;c<n;c++){var u=new Ga.util.ByteBuffer;u.putInt32(c),i.start(),i.update(r+u.getBytes()),a.putBuffer(i.digest())}return a.truncate(a.length()-t),a.getBytes()}};return e};var bl=or;bl.mgf=bl.mgf||{};bl.mgf.mgf1=bl.mgf1;var Ra=or,hT=Ra.pss=Ra.pss||{};hT.create=function(i){arguments.length===3&&(i={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=i.md,r=i.mgf,t=e.digestLength,a=i.salt||null;typeof a=="string"&&(a=Ra.util.createBuffer(a));var n;if("saltLength"in i)n=i.saltLength;else if(a!==null)n=a.length();else throw new Error("Salt length not specified or specific salt not given.");if(a!==null&&a.length()!==n)throw new Error("Given salt length does not match length of given salt.");var c=i.prng||Ra.random,u={};return u.encode=function(v,o){var h,g=o-1,y=Math.ceil(g/8),_=v.digest().getBytes();if(y<t+n+2)throw new Error("Message is too long to encrypt.");var A;a===null?A=c.getBytesSync(n):A=a.bytes();var S=new Ra.util.ByteBuffer;S.fillWithByte(0,8),S.putBytes(_),S.putBytes(A),e.start(),e.update(S.getBytes());var T=e.digest().getBytes(),B=new Ra.util.ByteBuffer;B.fillWithByte(0,y-n-t-2),B.putByte(1),B.putBytes(A);var M=B.getBytes(),R=y-t-1,P=r.generate(T,R),D="";for(h=0;h<R;h++)D+=String.fromCharCode(M.charCodeAt(h)^P.charCodeAt(h));var q=65280>>8*y-g&255;return D=String.fromCharCode(D.charCodeAt(0)&~q)+D.substr(1),D+T+""},u.verify=function(v,o,h){var g,y=h-1,_=Math.ceil(y/8);if(o=o.substr(-_),_<t+n+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(o.charCodeAt(_-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var A=_-t-1,S=o.substr(0,A),T=o.substr(A,t),B=65280>>8*_-y&255;if(S.charCodeAt(0)&B)throw new Error("Bits beyond keysize not zero as expected.");var M=r.generate(T,A),R="";for(g=0;g<A;g++)R+=String.fromCharCode(S.charCodeAt(g)^M.charCodeAt(g));R=String.fromCharCode(R.charCodeAt(0)&~B)+R.substr(1);var P=_-t-n-2;for(g=0;g<P;g++)if(R.charCodeAt(g)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(P)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var D=R.substr(-n),q=new Ra.util.ByteBuffer;q.fillWithByte(0,8),q.putBytes(v),q.putBytes(D),e.start(),e.update(q.getBytes());var k=e.digest().getBytes();return T===k},u};var Me=or,wt=Me.asn1,ve=Me.pki=Me.pki||{},vr=ve.oids,Fr={};Fr.CN=vr.commonName;Fr.commonName="CN";Fr.C=vr.countryName;Fr.countryName="C";Fr.L=vr.localityName;Fr.localityName="L";Fr.ST=vr.stateOrProvinceName;Fr.stateOrProvinceName="ST";Fr.O=vr.organizationName;Fr.organizationName="O";Fr.OU=vr.organizationalUnitName;Fr.organizationalUnitName="OU";Fr.E=vr.emailAddress;Fr.emailAddress="E";var T4=Me.pki.rsa.publicKeyValidator,dT={name:"Certificate",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:wt.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:wt.Class.UNIVERSAL,type:wt.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:wt.Class.UNIVERSAL,type:wt.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:wt.Class.UNIVERSAL,type:wt.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:wt.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:wt.Class.UNIVERSAL,type:wt.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:wt.Class.UNIVERSAL,type:wt.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:wt.Class.UNIVERSAL,type:wt.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:wt.Class.UNIVERSAL,type:wt.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},T4,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:wt.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:wt.Class.UNIVERSAL,type:wt.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:wt.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:wt.Class.UNIVERSAL,type:wt.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:wt.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:wt.Class.UNIVERSAL,type:wt.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:wt.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:wt.Class.UNIVERSAL,type:wt.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},pT={name:"rsapss",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:wt.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:wt.Class.UNIVERSAL,type:wt.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:wt.Class.UNIVERSAL,type:wt.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:wt.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:wt.Class.UNIVERSAL,type:wt.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:wt.Class.UNIVERSAL,type:wt.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:wt.Class.UNIVERSAL,type:wt.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:wt.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:wt.Class.UNIVERSAL,type:wt.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:wt.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:wt.Class.UNIVERSAL,type:wt.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},vT={name:"CertificationRequestInfo",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:wt.Class.UNIVERSAL,type:wt.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},T4,{name:"CertificationRequestInfo.attributes",tagClass:wt.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:wt.Class.UNIVERSAL,type:wt.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SET,constructed:!0}]}]}]},gT={name:"CertificationRequest",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[vT,{name:"CertificationRequest.signatureAlgorithm",tagClass:wt.Class.UNIVERSAL,type:wt.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:wt.Class.UNIVERSAL,type:wt.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:wt.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:wt.Class.UNIVERSAL,type:wt.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};ve.RDNAttributesAsArray=function(i,e){for(var r=[],t,a,n,c=0;c<i.value.length;++c){t=i.value[c];for(var u=0;u<t.value.length;++u)n={},a=t.value[u],n.type=wt.derToOid(a.value[0].value),n.value=a.value[1].value,n.valueTagClass=a.value[1].type,n.type in vr&&(n.name=vr[n.type],n.name in Fr&&(n.shortName=Fr[n.name])),e&&(e.update(n.type),e.update(n.value)),r.push(n)}return r};ve.CRIAttributesAsArray=function(i){for(var e=[],r=0;r<i.length;++r)for(var t=i[r],a=wt.derToOid(t.value[0].value),n=t.value[1].value,c=0;c<n.length;++c){var u={};if(u.type=a,u.value=n[c].value,u.valueTagClass=n[c].type,u.type in vr&&(u.name=vr[u.type],u.name in Fr&&(u.shortName=Fr[u.name])),u.type===vr.extensionRequest){u.extensions=[];for(var v=0;v<u.value.length;++v)u.extensions.push(ve.certificateExtensionFromAsn1(u.value[v]))}e.push(u)}return e};function ga(i,e){typeof e=="string"&&(e={shortName:e});for(var r=null,t,a=0;r===null&&a<i.attributes.length;++a)t=i.attributes[a],(e.type&&e.type===t.type||e.name&&e.name===t.name||e.shortName&&e.shortName===t.shortName)&&(r=t);return r}var _l=function(i,e,r){var t={};if(i!==vr["RSASSA-PSS"])return t;r&&(t={hash:{algorithmOid:vr.sha1},mgf:{algorithmOid:vr.mgf1,hash:{algorithmOid:vr.sha1}},saltLength:20});var a={},n=[];if(!wt.validate(e,pT,a,n)){var c=new Error("Cannot read RSASSA-PSS parameter block.");throw c.errors=n,c}return a.hashOid!==void 0&&(t.hash=t.hash||{},t.hash.algorithmOid=wt.derToOid(a.hashOid)),a.maskGenOid!==void 0&&(t.mgf=t.mgf||{},t.mgf.algorithmOid=wt.derToOid(a.maskGenOid),t.mgf.hash=t.mgf.hash||{},t.mgf.hash.algorithmOid=wt.derToOid(a.maskGenHashOid)),a.saltLength!==void 0&&(t.saltLength=a.saltLength.charCodeAt(0)),t},hc=function(i){switch(vr[i.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return Me.md.sha1.create();case"md5WithRSAEncryption":return Me.md.md5.create();case"sha256WithRSAEncryption":return Me.md.sha256.create();case"sha384WithRSAEncryption":return Me.md.sha384.create();case"sha512WithRSAEncryption":return Me.md.sha512.create();case"RSASSA-PSS":return Me.md.sha256.create();default:var e=new Error("Could not compute "+i.type+" digest. Unknown signature OID.");throw e.signatureOid=i.signatureOid,e}},R4=function(i){var e=i.certificate,r;switch(e.signatureOid){case vr.sha1WithRSAEncryption:case vr.sha1WithRSASignature:break;case vr["RSASSA-PSS"]:var t,a;if(t=vr[e.signatureParameters.mgf.hash.algorithmOid],t===void 0||Me.md[t]===void 0){var n=new Error("Unsupported MGF hash function.");throw n.oid=e.signatureParameters.mgf.hash.algorithmOid,n.name=t,n}if(a=vr[e.signatureParameters.mgf.algorithmOid],a===void 0||Me.mgf[a]===void 0){var n=new Error("Unsupported MGF function.");throw n.oid=e.signatureParameters.mgf.algorithmOid,n.name=a,n}if(a=Me.mgf[a].create(Me.md[t].create()),t=vr[e.signatureParameters.hash.algorithmOid],t===void 0||Me.md[t]===void 0){var n=new Error("Unsupported RSASSA-PSS hash function.");throw n.oid=e.signatureParameters.hash.algorithmOid,n.name=t,n}r=Me.pss.create(Me.md[t].create(),a,e.signatureParameters.saltLength);break}return e.publicKey.verify(i.md.digest().getBytes(),i.signature,r)};ve.certificateFromPem=function(i,e,r){var t=Me.pem.decode(i)[0];if(t.type!=="CERTIFICATE"&&t.type!=="X509 CERTIFICATE"&&t.type!=="TRUSTED CERTIFICATE"){var a=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var n=wt.fromDer(t.body,r);return ve.certificateFromAsn1(n,e)};ve.certificateToPem=function(i,e){var r={type:"CERTIFICATE",body:wt.toDer(ve.certificateToAsn1(i)).getBytes()};return Me.pem.encode(r,{maxline:e})};ve.publicKeyFromPem=function(i){var e=Me.pem.decode(i)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var t=wt.fromDer(e.body);return ve.publicKeyFromAsn1(t)};ve.publicKeyToPem=function(i,e){var r={type:"PUBLIC KEY",body:wt.toDer(ve.publicKeyToAsn1(i)).getBytes()};return Me.pem.encode(r,{maxline:e})};ve.publicKeyToRSAPublicKeyPem=function(i,e){var r={type:"RSA PUBLIC KEY",body:wt.toDer(ve.publicKeyToRSAPublicKey(i)).getBytes()};return Me.pem.encode(r,{maxline:e})};ve.getPublicKeyFingerprint=function(i,e){e=e||{};var r=e.md||Me.md.sha1.create(),t=e.type||"RSAPublicKey",a;switch(t){case"RSAPublicKey":a=wt.toDer(ve.publicKeyToRSAPublicKey(i)).getBytes();break;case"SubjectPublicKeyInfo":a=wt.toDer(ve.publicKeyToAsn1(i)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(a);var n=r.digest();if(e.encoding==="hex"){var c=n.toHex();return e.delimiter?c.match(/.{2}/g).join(e.delimiter):c}else{if(e.encoding==="binary")return n.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return n};ve.certificationRequestFromPem=function(i,e,r){var t=Me.pem.decode(i)[0];if(t.type!=="CERTIFICATE REQUEST"){var a=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw a.headerType=t.type,a}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var n=wt.fromDer(t.body,r);return ve.certificationRequestFromAsn1(n,e)};ve.certificationRequestToPem=function(i,e){var r={type:"CERTIFICATE REQUEST",body:wt.toDer(ve.certificationRequestToAsn1(i)).getBytes()};return Me.pem.encode(r,{maxline:e})};ve.createCertificate=function(){var i={};return i.version=2,i.serialNumber="00",i.signatureOid=null,i.signature=null,i.siginfo={},i.siginfo.algorithmOid=null,i.validity={},i.validity.notBefore=new Date,i.validity.notAfter=new Date,i.issuer={},i.issuer.getField=function(e){return ga(i.issuer,e)},i.issuer.addField=function(e){Ki([e]),i.issuer.attributes.push(e)},i.issuer.attributes=[],i.issuer.hash=null,i.subject={},i.subject.getField=function(e){return ga(i.subject,e)},i.subject.addField=function(e){Ki([e]),i.subject.attributes.push(e)},i.subject.attributes=[],i.subject.hash=null,i.extensions=[],i.publicKey=null,i.md=null,i.setSubject=function(e,r){Ki(e),i.subject.attributes=e,delete i.subject.uniqueId,r&&(i.subject.uniqueId=r),i.subject.hash=null},i.setIssuer=function(e,r){Ki(e),i.issuer.attributes=e,delete i.issuer.uniqueId,r&&(i.issuer.uniqueId=r),i.issuer.hash=null},i.setExtensions=function(e){for(var r=0;r<e.length;++r)N4(e[r],{cert:i});i.extensions=e},i.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,t,a=0;r===null&&a<i.extensions.length;++a)t=i.extensions[a],(e.id&&t.id===e.id||e.name&&t.name===e.name)&&(r=t);return r},i.sign=function(e,r){i.md=r||Me.md.sha1.create();var t=vr[i.md.algorithm+"WithRSAEncryption"];if(!t){var a=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw a.algorithm=i.md.algorithm,a}i.signatureOid=i.siginfo.algorithmOid=t,i.tbsCertificate=ve.getTBSCertificate(i);var n=wt.toDer(i.tbsCertificate);i.md.update(n.getBytes()),i.signature=e.sign(i.md)},i.verify=function(e){var r=!1;if(!i.issued(e)){var t=e.issuer,a=i.subject,n=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw n.expectedIssuer=a.attributes,n.actualIssuer=t.attributes,n}var c=e.md;if(c===null){c=hc({signatureOid:e.signatureOid,type:"certificate"});var u=e.tbsCertificate||ve.getTBSCertificate(e),v=wt.toDer(u);c.update(v.getBytes())}return c!==null&&(r=R4({certificate:i,md:c,signature:e.signature})),r},i.isIssuer=function(e){var r=!1,t=i.issuer,a=e.subject;if(t.hash&&a.hash)r=t.hash===a.hash;else if(t.attributes.length===a.attributes.length){r=!0;for(var n,c,u=0;r&&u<t.attributes.length;++u)n=t.attributes[u],c=a.attributes[u],(n.type!==c.type||n.value!==c.value)&&(r=!1)}return r},i.issued=function(e){return e.isIssuer(i)},i.generateSubjectKeyIdentifier=function(){return ve.getPublicKeyFingerprint(i.publicKey,{type:"RSAPublicKey"})},i.verifySubjectKeyIdentifier=function(){for(var e=vr.subjectKeyIdentifier,r=0;r<i.extensions.length;++r){var t=i.extensions[r];if(t.id===e){var a=i.generateSubjectKeyIdentifier().getBytes();return Me.util.hexToBytes(t.subjectKeyIdentifier)===a}}return!1},i};ve.certificateFromAsn1=function(i,e){var r={},t=[];if(!wt.validate(i,dT,r,t)){var a=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw a.errors=t,a}var n=wt.derToOid(r.publicKeyOid);if(n!==ve.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=ve.createCertificate();c.version=r.certVersion?r.certVersion.charCodeAt(0):0;var u=Me.util.createBuffer(r.certSerialNumber);c.serialNumber=u.toHex(),c.signatureOid=Me.asn1.derToOid(r.certSignatureOid),c.signatureParameters=_l(c.signatureOid,r.certSignatureParams,!0),c.siginfo.algorithmOid=Me.asn1.derToOid(r.certinfoSignatureOid),c.siginfo.parameters=_l(c.siginfo.algorithmOid,r.certinfoSignatureParams,!1),c.signature=r.certSignature;var v=[];if(r.certValidity1UTCTime!==void 0&&v.push(wt.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&v.push(wt.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&v.push(wt.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&v.push(wt.generalizedTimeToDate(r.certValidity4GeneralizedTime)),v.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(v.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(c.validity.notBefore=v[0],c.validity.notAfter=v[1],c.tbsCertificate=r.tbsCertificate,e){c.md=hc({signatureOid:c.signatureOid,type:"certificate"});var o=wt.toDer(c.tbsCertificate);c.md.update(o.getBytes())}var h=Me.md.sha1.create(),g=wt.toDer(r.certIssuer);h.update(g.getBytes()),c.issuer.getField=function(A){return ga(c.issuer,A)},c.issuer.addField=function(A){Ki([A]),c.issuer.attributes.push(A)},c.issuer.attributes=ve.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(c.issuer.uniqueId=r.certIssuerUniqueId),c.issuer.hash=h.digest().toHex();var y=Me.md.sha1.create(),_=wt.toDer(r.certSubject);return y.update(_.getBytes()),c.subject.getField=function(A){return ga(c.subject,A)},c.subject.addField=function(A){Ki([A]),c.subject.attributes.push(A)},c.subject.attributes=ve.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(c.subject.uniqueId=r.certSubjectUniqueId),c.subject.hash=y.digest().toHex(),r.certExtensions?c.extensions=ve.certificateExtensionsFromAsn1(r.certExtensions):c.extensions=[],c.publicKey=ve.publicKeyFromAsn1(r.subjectPublicKeyInfo),c};ve.certificateExtensionsFromAsn1=function(i){for(var e=[],r=0;r<i.value.length;++r)for(var t=i.value[r],a=0;a<t.value.length;++a)e.push(ve.certificateExtensionFromAsn1(t.value[a]));return e};ve.certificateExtensionFromAsn1=function(i){var e={};if(e.id=wt.derToOid(i.value[0].value),e.critical=!1,i.value[1].type===wt.Type.BOOLEAN?(e.critical=i.value[1].value.charCodeAt(0)!==0,e.value=i.value[2].value):e.value=i.value[1].value,e.id in vr){if(e.name=vr[e.id],e.name==="keyUsage"){var r=wt.fromDer(e.value),t=0,a=0;r.value.length>1&&(t=r.value.charCodeAt(1),a=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(t&128)===128,e.nonRepudiation=(t&64)===64,e.keyEncipherment=(t&32)===32,e.dataEncipherment=(t&16)===16,e.keyAgreement=(t&8)===8,e.keyCertSign=(t&4)===4,e.cRLSign=(t&2)===2,e.encipherOnly=(t&1)===1,e.decipherOnly=(a&128)===128}else if(e.name==="basicConstraints"){var r=wt.fromDer(e.value);r.value.length>0&&r.value[0].type===wt.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var n=null;r.value.length>0&&r.value[0].type===wt.Type.INTEGER?n=r.value[0].value:r.value.length>1&&(n=r.value[1].value),n!==null&&(e.pathLenConstraint=wt.derToInteger(n))}else if(e.name==="extKeyUsage")for(var r=wt.fromDer(e.value),c=0;c<r.value.length;++c){var u=wt.derToOid(r.value[c].value);u in vr?e[vr[u]]=!0:e[u]=!0}else if(e.name==="nsCertType"){var r=wt.fromDer(e.value),t=0;r.value.length>1&&(t=r.value.charCodeAt(1)),e.client=(t&128)===128,e.server=(t&64)===64,e.email=(t&32)===32,e.objsign=(t&16)===16,e.reserved=(t&8)===8,e.sslCA=(t&4)===4,e.emailCA=(t&2)===2,e.objCA=(t&1)===1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var v,r=wt.fromDer(e.value),o=0;o<r.value.length;++o){v=r.value[o];var h={type:v.type,value:v.value};switch(e.altNames.push(h),v.type){case 1:case 2:case 6:break;case 7:h.ip=Me.util.bytesToIP(v.value);break;case 8:h.oid=wt.derToOid(v.value);break}}}else if(e.name==="subjectKeyIdentifier"){var r=wt.fromDer(e.value);e.subjectKeyIdentifier=Me.util.bytesToHex(r.value)}}return e};ve.certificationRequestFromAsn1=function(i,e){var r={},t=[];if(!wt.validate(i,gT,r,t)){var a=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw a.errors=t,a}var n=wt.derToOid(r.publicKeyOid);if(n!==ve.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var c=ve.createCertificationRequest();if(c.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,c.signatureOid=Me.asn1.derToOid(r.csrSignatureOid),c.signatureParameters=_l(c.signatureOid,r.csrSignatureParams,!0),c.siginfo.algorithmOid=Me.asn1.derToOid(r.csrSignatureOid),c.siginfo.parameters=_l(c.siginfo.algorithmOid,r.csrSignatureParams,!1),c.signature=r.csrSignature,c.certificationRequestInfo=r.certificationRequestInfo,e){c.md=hc({signatureOid:c.signatureOid,type:"certification request"});var u=wt.toDer(c.certificationRequestInfo);c.md.update(u.getBytes())}var v=Me.md.sha1.create();return c.subject.getField=function(o){return ga(c.subject,o)},c.subject.addField=function(o){Ki([o]),c.subject.attributes.push(o)},c.subject.attributes=ve.RDNAttributesAsArray(r.certificationRequestInfoSubject,v),c.subject.hash=v.digest().toHex(),c.publicKey=ve.publicKeyFromAsn1(r.subjectPublicKeyInfo),c.getAttribute=function(o){return ga(c,o)},c.addAttribute=function(o){Ki([o]),c.attributes.push(o)},c.attributes=ve.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),c};ve.createCertificationRequest=function(){var i={};return i.version=0,i.signatureOid=null,i.signature=null,i.siginfo={},i.siginfo.algorithmOid=null,i.subject={},i.subject.getField=function(e){return ga(i.subject,e)},i.subject.addField=function(e){Ki([e]),i.subject.attributes.push(e)},i.subject.attributes=[],i.subject.hash=null,i.publicKey=null,i.attributes=[],i.getAttribute=function(e){return ga(i,e)},i.addAttribute=function(e){Ki([e]),i.attributes.push(e)},i.md=null,i.setSubject=function(e){Ki(e),i.subject.attributes=e,i.subject.hash=null},i.setAttributes=function(e){Ki(e),i.attributes=e},i.sign=function(e,r){i.md=r||Me.md.sha1.create();var t=vr[i.md.algorithm+"WithRSAEncryption"];if(!t){var a=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw a.algorithm=i.md.algorithm,a}i.signatureOid=i.siginfo.algorithmOid=t,i.certificationRequestInfo=ve.getCertificationRequestInfo(i);var n=wt.toDer(i.certificationRequestInfo);i.md.update(n.getBytes()),i.signature=e.sign(i.md)},i.verify=function(){var e=!1,r=i.md;if(r===null){r=hc({signatureOid:i.signatureOid,type:"certification request"});var t=i.certificationRequestInfo||ve.getCertificationRequestInfo(i),a=wt.toDer(t);r.update(a.getBytes())}return r!==null&&(e=R4({certificate:i,md:r,signature:i.signature})),e},i};function Ss(i){for(var e=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[]),r,t,a=i.attributes,n=0;n<a.length;++n){r=a[n];var c=r.value,u=wt.Type.PRINTABLESTRING;"valueTagClass"in r&&(u=r.valueTagClass,u===wt.Type.UTF8&&(c=Me.util.encodeUtf8(c))),t=wt.create(wt.Class.UNIVERSAL,wt.Type.SET,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.OID,!1,wt.oidToDer(r.type).getBytes()),wt.create(wt.Class.UNIVERSAL,u,!1,c)])]),e.value.push(t)}return e}function Ki(i){for(var e,r=0;r<i.length;++r){if(e=i[r],typeof e.name>"u"&&(e.type&&e.type in ve.oids?e.name=ve.oids[e.type]:e.shortName&&e.shortName in Fr&&(e.name=ve.oids[Fr[e.shortName]])),typeof e.type>"u")if(e.name&&e.name in ve.oids)e.type=ve.oids[e.name];else{var t=new Error("Attribute type not specified.");throw t.attribute=e,t}if(typeof e.shortName>"u"&&e.name&&e.name in Fr&&(e.shortName=Fr[e.name]),e.type===vr.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=wt.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var a=0;a<e.extensions.length;++a)e.value.push(ve.certificateExtensionToAsn1(N4(e.extensions[a])))}if(typeof e.value>"u"){var t=new Error("Attribute value not specified.");throw t.attribute=e,t}}}function N4(i,e){if(e=e||{},typeof i.name>"u"&&i.id&&i.id in ve.oids&&(i.name=ve.oids[i.id]),typeof i.id>"u")if(i.name&&i.name in ve.oids)i.id=ve.oids[i.name];else{var r=new Error("Extension ID not specified.");throw r.extension=i,r}if(typeof i.value<"u")return i;if(i.name==="keyUsage"){var t=0,a=0,n=0;i.digitalSignature&&(a|=128,t=7),i.nonRepudiation&&(a|=64,t=6),i.keyEncipherment&&(a|=32,t=5),i.dataEncipherment&&(a|=16,t=4),i.keyAgreement&&(a|=8,t=3),i.keyCertSign&&(a|=4,t=2),i.cRLSign&&(a|=2,t=1),i.encipherOnly&&(a|=1,t=0),i.decipherOnly&&(n|=128,t=7);var c=String.fromCharCode(t);n!==0?c+=String.fromCharCode(a)+String.fromCharCode(n):a!==0&&(c+=String.fromCharCode(a)),i.value=wt.create(wt.Class.UNIVERSAL,wt.Type.BITSTRING,!1,c)}else if(i.name==="basicConstraints")i.value=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[]),i.cA&&i.value.value.push(wt.create(wt.Class.UNIVERSAL,wt.Type.BOOLEAN,!1,"")),"pathLenConstraint"in i&&i.value.value.push(wt.create(wt.Class.UNIVERSAL,wt.Type.INTEGER,!1,wt.integerToDer(i.pathLenConstraint).getBytes()));else if(i.name==="extKeyUsage"){i.value=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[]);var u=i.value.value;for(var v in i)i[v]===!0&&(v in vr?u.push(wt.create(wt.Class.UNIVERSAL,wt.Type.OID,!1,wt.oidToDer(vr[v]).getBytes())):v.indexOf(".")!==-1&&u.push(wt.create(wt.Class.UNIVERSAL,wt.Type.OID,!1,wt.oidToDer(v).getBytes())))}else if(i.name==="nsCertType"){var t=0,a=0;i.client&&(a|=128,t=7),i.server&&(a|=64,t=6),i.email&&(a|=32,t=5),i.objsign&&(a|=16,t=4),i.reserved&&(a|=8,t=3),i.sslCA&&(a|=4,t=2),i.emailCA&&(a|=2,t=1),i.objCA&&(a|=1,t=0);var c=String.fromCharCode(t);a!==0&&(c+=String.fromCharCode(a)),i.value=wt.create(wt.Class.UNIVERSAL,wt.Type.BITSTRING,!1,c)}else if(i.name==="subjectAltName"||i.name==="issuerAltName"){i.value=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[]);for(var o,h=0;h<i.altNames.length;++h){o=i.altNames[h];var c=o.value;if(o.type===7&&o.ip){if(c=Me.util.bytesFromIP(o.ip),c===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=i,r}}else o.type===8&&(o.oid?c=wt.oidToDer(wt.oidToDer(o.oid)):c=wt.oidToDer(c));i.value.value.push(wt.create(wt.Class.CONTEXT_SPECIFIC,o.type,!1,c))}}else if(i.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(i.comment)||i.comment.length<1||i.comment.length>128)throw new Error('Invalid "nsComment" content.');i.value=wt.create(wt.Class.UNIVERSAL,wt.Type.IA5STRING,!1,i.comment)}else if(i.name==="subjectKeyIdentifier"&&e.cert){var g=e.cert.generateSubjectKeyIdentifier();i.subjectKeyIdentifier=g.toHex(),i.value=wt.create(wt.Class.UNIVERSAL,wt.Type.OCTETSTRING,!1,g.getBytes())}else if(i.name==="authorityKeyIdentifier"&&e.cert){i.value=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[]);var u=i.value.value;if(i.keyIdentifier){var y=i.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():i.keyIdentifier;u.push(wt.create(wt.Class.CONTEXT_SPECIFIC,0,!1,y))}if(i.authorityCertIssuer){var _=[wt.create(wt.Class.CONTEXT_SPECIFIC,4,!0,[Ss(i.authorityCertIssuer===!0?e.cert.issuer:i.authorityCertIssuer)])];u.push(wt.create(wt.Class.CONTEXT_SPECIFIC,1,!0,_))}if(i.serialNumber){var A=Me.util.hexToBytes(i.serialNumber===!0?e.cert.serialNumber:i.serialNumber);u.push(wt.create(wt.Class.CONTEXT_SPECIFIC,2,!1,A))}}else if(i.name==="cRLDistributionPoints"){i.value=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[]);for(var u=i.value.value,S=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[]),T=wt.create(wt.Class.CONTEXT_SPECIFIC,0,!0,[]),o,h=0;h<i.altNames.length;++h){o=i.altNames[h];var c=o.value;if(o.type===7&&o.ip){if(c=Me.util.bytesFromIP(o.ip),c===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=i,r}}else o.type===8&&(o.oid?c=wt.oidToDer(wt.oidToDer(o.oid)):c=wt.oidToDer(c));T.value.push(wt.create(wt.Class.CONTEXT_SPECIFIC,o.type,!1,c))}S.value.push(wt.create(wt.Class.CONTEXT_SPECIFIC,0,!0,[T])),u.push(S)}if(typeof i.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=i,r}return i}function op(i,e){switch(i){case vr["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(wt.create(wt.Class.CONTEXT_SPECIFIC,0,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.OID,!1,wt.oidToDer(e.hash.algorithmOid).getBytes()),wt.create(wt.Class.UNIVERSAL,wt.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(wt.create(wt.Class.CONTEXT_SPECIFIC,1,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.OID,!1,wt.oidToDer(e.mgf.algorithmOid).getBytes()),wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.OID,!1,wt.oidToDer(e.mgf.hash.algorithmOid).getBytes()),wt.create(wt.Class.UNIVERSAL,wt.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(wt.create(wt.Class.CONTEXT_SPECIFIC,2,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.INTEGER,!1,wt.integerToDer(e.saltLength).getBytes())])),wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,r);default:return wt.create(wt.Class.UNIVERSAL,wt.Type.NULL,!1,"")}}function mT(i){var e=wt.create(wt.Class.CONTEXT_SPECIFIC,0,!0,[]);if(i.attributes.length===0)return e;for(var r=i.attributes,t=0;t<r.length;++t){var a=r[t],n=a.value,c=wt.Type.UTF8;"valueTagClass"in a&&(c=a.valueTagClass),c===wt.Type.UTF8&&(n=Me.util.encodeUtf8(n));var u=!1;"valueConstructed"in a&&(u=a.valueConstructed);var v=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.OID,!1,wt.oidToDer(a.type).getBytes()),wt.create(wt.Class.UNIVERSAL,wt.Type.SET,!0,[wt.create(wt.Class.UNIVERSAL,c,u,n)])]);e.value.push(v)}return e}var yT=new Date("1950-01-01T00:00:00Z"),bT=new Date("2050-01-01T00:00:00Z");function X3(i){return i>=yT&&i<bT?wt.create(wt.Class.UNIVERSAL,wt.Type.UTCTIME,!1,wt.dateToUtcTime(i)):wt.create(wt.Class.UNIVERSAL,wt.Type.GENERALIZEDTIME,!1,wt.dateToGeneralizedTime(i))}ve.getTBSCertificate=function(i){var e=X3(i.validity.notBefore),r=X3(i.validity.notAfter),t=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[wt.create(wt.Class.CONTEXT_SPECIFIC,0,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.INTEGER,!1,wt.integerToDer(i.version).getBytes())]),wt.create(wt.Class.UNIVERSAL,wt.Type.INTEGER,!1,Me.util.hexToBytes(i.serialNumber)),wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.OID,!1,wt.oidToDer(i.siginfo.algorithmOid).getBytes()),op(i.siginfo.algorithmOid,i.siginfo.parameters)]),Ss(i.issuer),wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[e,r]),Ss(i.subject),ve.publicKeyToAsn1(i.publicKey)]);return i.issuer.uniqueId&&t.value.push(wt.create(wt.Class.CONTEXT_SPECIFIC,1,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.BITSTRING,!1,"\0"+i.issuer.uniqueId)])),i.subject.uniqueId&&t.value.push(wt.create(wt.Class.CONTEXT_SPECIFIC,2,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.BITSTRING,!1,"\0"+i.subject.uniqueId)])),i.extensions.length>0&&t.value.push(ve.certificateExtensionsToAsn1(i.extensions)),t};ve.getCertificationRequestInfo=function(i){var e=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.INTEGER,!1,wt.integerToDer(i.version).getBytes()),Ss(i.subject),ve.publicKeyToAsn1(i.publicKey),mT(i)]);return e};ve.distinguishedNameToAsn1=function(i){return Ss(i)};ve.certificateToAsn1=function(i){var e=i.tbsCertificate||ve.getTBSCertificate(i);return wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[e,wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.OID,!1,wt.oidToDer(i.signatureOid).getBytes()),op(i.signatureOid,i.signatureParameters)]),wt.create(wt.Class.UNIVERSAL,wt.Type.BITSTRING,!1,"\0"+i.signature)])};ve.certificateExtensionsToAsn1=function(i){var e=wt.create(wt.Class.CONTEXT_SPECIFIC,3,!0,[]),r=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[]);e.value.push(r);for(var t=0;t<i.length;++t)r.value.push(ve.certificateExtensionToAsn1(i[t]));return e};ve.certificateExtensionToAsn1=function(i){var e=wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[]);e.value.push(wt.create(wt.Class.UNIVERSAL,wt.Type.OID,!1,wt.oidToDer(i.id).getBytes())),i.critical&&e.value.push(wt.create(wt.Class.UNIVERSAL,wt.Type.BOOLEAN,!1,""));var r=i.value;return typeof i.value!="string"&&(r=wt.toDer(r).getBytes()),e.value.push(wt.create(wt.Class.UNIVERSAL,wt.Type.OCTETSTRING,!1,r)),e};ve.certificationRequestToAsn1=function(i){var e=i.certificationRequestInfo||ve.getCertificationRequestInfo(i);return wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[e,wt.create(wt.Class.UNIVERSAL,wt.Type.SEQUENCE,!0,[wt.create(wt.Class.UNIVERSAL,wt.Type.OID,!1,wt.oidToDer(i.signatureOid).getBytes()),op(i.signatureOid,i.signatureParameters)]),wt.create(wt.Class.UNIVERSAL,wt.Type.BITSTRING,!1,"\0"+i.signature)])};ve.createCaStore=function(i){var e={certs:{}};e.getIssuer=function(c){var u=r(c.issuer);return u},e.addCertificate=function(c){if(typeof c=="string"&&(c=Me.pki.certificateFromPem(c)),t(c.subject),!e.hasCertificate(c))if(c.subject.hash in e.certs){var u=e.certs[c.subject.hash];Me.util.isArray(u)||(u=[u]),u.push(c),e.certs[c.subject.hash]=u}else e.certs[c.subject.hash]=c},e.hasCertificate=function(c){typeof c=="string"&&(c=Me.pki.certificateFromPem(c));var u=r(c.subject);if(!u)return!1;Me.util.isArray(u)||(u=[u]);for(var v=wt.toDer(ve.certificateToAsn1(c)).getBytes(),o=0;o<u.length;++o){var h=wt.toDer(ve.certificateToAsn1(u[o])).getBytes();if(v===h)return!0}return!1},e.listAllCertificates=function(){var c=[];for(var u in e.certs)if(e.certs.hasOwnProperty(u)){var v=e.certs[u];if(!Me.util.isArray(v))c.push(v);else for(var o=0;o<v.length;++o)c.push(v[o])}return c},e.removeCertificate=function(c){var u;if(typeof c=="string"&&(c=Me.pki.certificateFromPem(c)),t(c.subject),!e.hasCertificate(c))return null;var v=r(c.subject);if(!Me.util.isArray(v))return u=e.certs[c.subject.hash],delete e.certs[c.subject.hash],u;for(var o=wt.toDer(ve.certificateToAsn1(c)).getBytes(),h=0;h<v.length;++h){var g=wt.toDer(ve.certificateToAsn1(v[h])).getBytes();o===g&&(u=v[h],v.splice(h,1))}return v.length===0&&delete e.certs[c.subject.hash],u};function r(c){return t(c),e.certs[c.hash]||null}function t(c){if(!c.hash){var u=Me.md.sha1.create();c.attributes=ve.RDNAttributesAsArray(Ss(c),u),c.hash=u.digest().toHex()}}if(i)for(var a=0;a<i.length;++a){var n=i[a];e.addCertificate(n)}return e};ve.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};ve.verifyCertificateChain=function(i,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var t=e.slice(0),a=r.validityCheckDate;typeof a>"u"&&(a=new Date);var n=!0,c=null,u=0;do{var v=e.shift(),o=null,h=!1;if(a&&(a<v.validity.notBefore||a>v.validity.notAfter)&&(c={message:"Certificate is not valid yet or has expired.",error:ve.certificateError.certificate_expired,notBefore:v.validity.notBefore,notAfter:v.validity.notAfter,now:a}),c===null){if(o=e[0]||i.getIssuer(v),o===null&&v.isIssuer(v)&&(h=!0,o=v),o){var g=o;Me.util.isArray(g)||(g=[g]);for(var y=!1;!y&&g.length>0;){o=g.shift();try{y=o.verify(v)}catch{}}y||(c={message:"Certificate signature is invalid.",error:ve.certificateError.bad_certificate})}c===null&&(!o||h)&&!i.hasCertificate(v)&&(c={message:"Certificate is not trusted.",error:ve.certificateError.unknown_ca})}if(c===null&&o&&!v.isIssuer(o)&&(c={message:"Certificate issuer is invalid.",error:ve.certificateError.bad_certificate}),c===null)for(var _={keyUsage:!0,basicConstraints:!0},A=0;c===null&&A<v.extensions.length;++A){var S=v.extensions[A];S.critical&&!(S.name in _)&&(c={message:"Certificate has an unsupported critical extension.",error:ve.certificateError.unsupported_certificate})}if(c===null&&(!n||e.length===0&&(!o||h))){var T=v.getExtension("basicConstraints"),B=v.getExtension("keyUsage");if(B!==null&&(!B.keyCertSign||T===null)&&(c={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:ve.certificateError.bad_certificate}),c===null&&T!==null&&!T.cA&&(c={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:ve.certificateError.bad_certificate}),c===null&&B!==null&&"pathLenConstraint"in T){var M=u-1;M>T.pathLenConstraint&&(c={message:"Certificate basicConstraints pathLenConstraint violated.",error:ve.certificateError.bad_certificate})}}var R=c===null?!0:c.error,P=r.verify?r.verify(R,u,t):R;if(P===!0)c=null;else throw R===!0&&(c={message:"The application rejected the certificate.",error:ve.certificateError.bad_certificate}),(P||P===0)&&(typeof P=="object"&&!Me.util.isArray(P)?(P.message&&(c.message=P.message),P.error&&(c.error=P.error)):typeof P=="string"&&(c.error=P)),c;n=!1,++u}while(e.length>0);return!0};var Mr=or,Kt=Mr.asn1,lr=Mr.pki,Do=Mr.pkcs12=Mr.pkcs12||{},k4={name:"ContentInfo",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Kt.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},_T={name:"PFX",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.INTEGER,constructed:!1,capture:"version"},k4,{name:"PFX.macData",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:Kt.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},wT={name:"SafeBag",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:Kt.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},CT={name:"Attribute",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SET,constructed:!0,capture:"values"}]},ET={name:"CertBag",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:Kt.Class.UNIVERSAL,type:Kt.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:Kt.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:Kt.Class.UNIVERSAL,type:Kt.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function io(i,e,r,t){for(var a=[],n=0;n<i.length;n++)for(var c=0;c<i[n].safeBags.length;c++){var u=i[n].safeBags[c];if(!(t!==void 0&&u.type!==t)){if(e===null){a.push(u);continue}u.attributes[e]!==void 0&&u.attributes[e].indexOf(r)>=0&&a.push(u)}}return a}Do.pkcs12FromAsn1=function(i,e,r){typeof e=="string"?(r=e,e=!0):e===void 0&&(e=!0);var t={},a=[];if(!Kt.validate(i,_T,t,a)){var n=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw n.errors=n,n}var c={version:t.version.charCodeAt(0),safeContents:[],getBags:function(T){var B={},M;return"localKeyId"in T?M=T.localKeyId:"localKeyIdHex"in T&&(M=Mr.util.hexToBytes(T.localKeyIdHex)),M===void 0&&!("friendlyName"in T)&&"bagType"in T&&(B[T.bagType]=io(c.safeContents,null,null,T.bagType)),M!==void 0&&(B.localKeyId=io(c.safeContents,"localKeyId",M,T.bagType)),"friendlyName"in T&&(B.friendlyName=io(c.safeContents,"friendlyName",T.friendlyName,T.bagType)),B},getBagsByFriendlyName:function(T,B){return io(c.safeContents,"friendlyName",T,B)},getBagsByLocalKeyId:function(T,B){return io(c.safeContents,"localKeyId",T,B)}};if(t.version.charCodeAt(0)!==3){var n=new Error("PKCS#12 PFX of version other than 3 not supported.");throw n.version=t.version.charCodeAt(0),n}if(Kt.derToOid(t.contentType)!==lr.oids.data){var n=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw n.oid=Kt.derToOid(t.contentType),n}var u=t.content.value[0];if(u.tagClass!==Kt.Class.UNIVERSAL||u.type!==Kt.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(u=fp(u),t.mac){var v=null,o=0,h=Kt.derToOid(t.macAlgorithm);switch(h){case lr.oids.sha1:v=Mr.md.sha1.create(),o=20;break;case lr.oids.sha256:v=Mr.md.sha256.create(),o=32;break;case lr.oids.sha384:v=Mr.md.sha384.create(),o=48;break;case lr.oids.sha512:v=Mr.md.sha512.create(),o=64;break;case lr.oids.md5:v=Mr.md.md5.create(),o=16;break}if(v===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+h);var g=new Mr.util.ByteBuffer(t.macSalt),y="macIterations"in t?parseInt(Mr.util.bytesToHex(t.macIterations),16):1,_=Do.generateKey(r,g,3,y,o,v),A=Mr.hmac.create();A.start(v,_),A.update(u.value);var S=A.getMac();if(S.getBytes()!==t.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return AT(c,u.value,e,r),c};function fp(i){if(i.composed||i.constructed){for(var e=Mr.util.createBuffer(),r=0;r<i.value.length;++r)e.putBytes(i.value[r].value);i.composed=i.constructed=!1,i.value=e.getBytes()}return i}function AT(i,e,r,t){if(e=Kt.fromDer(e,r),e.tagClass!==Kt.Class.UNIVERSAL||e.type!==Kt.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var a=0;a<e.value.length;a++){var n=e.value[a],c={},u=[];if(!Kt.validate(n,k4,c,u)){var v=new Error("Cannot read ContentInfo.");throw v.errors=u,v}var o={encrypted:!1},h=null,g=c.content.value[0];switch(Kt.derToOid(c.contentType)){case lr.oids.data:if(g.tagClass!==Kt.Class.UNIVERSAL||g.type!==Kt.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");h=fp(g).value;break;case lr.oids.encryptedData:h=ST(g,t),o.encrypted=!0;break;default:var v=new Error("Unsupported PKCS#12 contentType.");throw v.contentType=Kt.derToOid(c.contentType),v}o.safeBags=xT(h,r,t),i.safeContents.push(o)}}function ST(i,e){var r={},t=[];if(!Kt.validate(i,Mr.pkcs7.asn1.encryptedDataValidator,r,t)){var a=new Error("Cannot read EncryptedContentInfo.");throw a.errors=t,a}var n=Kt.derToOid(r.contentType);if(n!==lr.oids.data){var a=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw a.oid=n,a}n=Kt.derToOid(r.encAlgorithm);var c=lr.pbe.getCipher(n,r.encParameter,e),u=fp(r.encryptedContentAsn1),v=Mr.util.createBuffer(u.value);if(c.update(v),!c.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return c.output.getBytes()}function xT(i,e,r){if(!e&&i.length===0)return[];if(i=Kt.fromDer(i,e),i.tagClass!==Kt.Class.UNIVERSAL||i.type!==Kt.Type.SEQUENCE||i.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var t=[],a=0;a<i.value.length;a++){var n=i.value[a],c={},u=[];if(!Kt.validate(n,wT,c,u)){var v=new Error("Cannot read SafeBag.");throw v.errors=u,v}var o={type:Kt.derToOid(c.bagId),attributes:IT(c.bagAttributes)};t.push(o);var h,g,y=c.bagValue.value[0];switch(o.type){case lr.oids.pkcs8ShroudedKeyBag:if(y=lr.decryptPrivateKeyInfo(y,r),y===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case lr.oids.keyBag:try{o.key=lr.privateKeyFromAsn1(y)}catch{o.key=null,o.asn1=y}continue;case lr.oids.certBag:h=ET,g=function(){if(Kt.derToOid(c.certId)!==lr.oids.x509Certificate){var A=new Error("Unsupported certificate type, only X.509 supported.");throw A.oid=Kt.derToOid(c.certId),A}var S=Kt.fromDer(c.cert,e);try{o.cert=lr.certificateFromAsn1(S,!0)}catch{o.cert=null,o.asn1=S}};break;default:var v=new Error("Unsupported PKCS#12 SafeBag type.");throw v.oid=o.type,v}if(h!==void 0&&!Kt.validate(y,h,c,u)){var v=new Error("Cannot read PKCS#12 "+h.name);throw v.errors=u,v}g()}return t}function IT(i){var e={};if(i!==void 0)for(var r=0;r<i.length;++r){var t={},a=[];if(!Kt.validate(i[r],CT,t,a)){var n=new Error("Cannot read PKCS#12 BagAttribute.");throw n.errors=a,n}var c=Kt.derToOid(t.oid);if(lr.oids[c]!==void 0){e[lr.oids[c]]=[];for(var u=0;u<t.values.length;++u)e[lr.oids[c]].push(t.values[u].value)}}return e}Do.toPkcs12Asn1=function(i,e,r,t){t=t||{},t.saltSize=t.saltSize||8,t.count=t.count||2048,t.algorithm=t.algorithm||t.encAlgorithm||"aes128","useMac"in t||(t.useMac=!0),"localKeyId"in t||(t.localKeyId=null),"generateLocalKeyId"in t||(t.generateLocalKeyId=!0);var a=t.localKeyId,n;if(a!==null)a=Mr.util.hexToBytes(a);else if(t.generateLocalKeyId)if(e){var c=Mr.util.isArray(e)?e[0]:e;typeof c=="string"&&(c=lr.certificateFromPem(c));var u=Mr.md.sha1.create();u.update(Kt.toDer(lr.certificateToAsn1(c)).getBytes()),a=u.digest().getBytes()}else a=Mr.random.getBytes(20);var v=[];a!==null&&v.push(Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OID,!1,Kt.oidToDer(lr.oids.localKeyId).getBytes()),Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SET,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OCTETSTRING,!1,a)])])),"friendlyName"in t&&v.push(Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OID,!1,Kt.oidToDer(lr.oids.friendlyName).getBytes()),Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SET,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.BMPSTRING,!1,t.friendlyName)])])),v.length>0&&(n=Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SET,!0,v));var o=[],h=[];e!==null&&(Mr.util.isArray(e)?h=e:h=[e]);for(var g=[],y=0;y<h.length;++y){e=h[y],typeof e=="string"&&(e=lr.certificateFromPem(e));var _=y===0?n:void 0,A=lr.certificateToAsn1(e),S=Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OID,!1,Kt.oidToDer(lr.oids.certBag).getBytes()),Kt.create(Kt.Class.CONTEXT_SPECIFIC,0,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OID,!1,Kt.oidToDer(lr.oids.x509Certificate).getBytes()),Kt.create(Kt.Class.CONTEXT_SPECIFIC,0,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OCTETSTRING,!1,Kt.toDer(A).getBytes())])])]),_]);g.push(S)}if(g.length>0){var T=Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,g),B=Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OID,!1,Kt.oidToDer(lr.oids.data).getBytes()),Kt.create(Kt.Class.CONTEXT_SPECIFIC,0,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OCTETSTRING,!1,Kt.toDer(T).getBytes())])]);o.push(B)}var M=null;if(i!==null){var R=lr.wrapRsaPrivateKey(lr.privateKeyToAsn1(i));r===null?M=Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OID,!1,Kt.oidToDer(lr.oids.keyBag).getBytes()),Kt.create(Kt.Class.CONTEXT_SPECIFIC,0,!0,[R]),n]):M=Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OID,!1,Kt.oidToDer(lr.oids.pkcs8ShroudedKeyBag).getBytes()),Kt.create(Kt.Class.CONTEXT_SPECIFIC,0,!0,[lr.encryptPrivateKeyInfo(R,r,t)]),n]);var P=Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[M]),D=Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OID,!1,Kt.oidToDer(lr.oids.data).getBytes()),Kt.create(Kt.Class.CONTEXT_SPECIFIC,0,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OCTETSTRING,!1,Kt.toDer(P).getBytes())])]);o.push(D)}var q=Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,o),k;if(t.useMac){var u=Mr.md.sha1.create(),U=new Mr.util.ByteBuffer(Mr.random.getBytes(t.saltSize)),O=t.count,i=Do.generateKey(r,U,3,O,20),G=Mr.hmac.create();G.start(u,i),G.update(Kt.toDer(q).getBytes());var E=G.getMac();k=Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OID,!1,Kt.oidToDer(lr.oids.sha1).getBytes()),Kt.create(Kt.Class.UNIVERSAL,Kt.Type.NULL,!1,"")]),Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OCTETSTRING,!1,E.getBytes())]),Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OCTETSTRING,!1,U.getBytes()),Kt.create(Kt.Class.UNIVERSAL,Kt.Type.INTEGER,!1,Kt.integerToDer(O).getBytes())])}return Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.INTEGER,!1,Kt.integerToDer(3).getBytes()),Kt.create(Kt.Class.UNIVERSAL,Kt.Type.SEQUENCE,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OID,!1,Kt.oidToDer(lr.oids.data).getBytes()),Kt.create(Kt.Class.CONTEXT_SPECIFIC,0,!0,[Kt.create(Kt.Class.UNIVERSAL,Kt.Type.OCTETSTRING,!1,Kt.toDer(q).getBytes())])]),k])};Do.generateKey=Mr.pbe.generatePkcs12Key;var ma=or,lp=ma.asn1,xs=ma.pki=ma.pki||{};xs.pemToDer=function(i){var e=ma.pem.decode(i)[0];if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return ma.util.createBuffer(e.body)};xs.privateKeyFromPem=function(i){var e=ma.pem.decode(i)[0];if(e.type!=="PRIVATE KEY"&&e.type!=="RSA PRIVATE KEY"){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var t=lp.fromDer(e.body);return xs.privateKeyFromAsn1(t)};xs.privateKeyToPem=function(i,e){var r={type:"RSA PRIVATE KEY",body:lp.toDer(xs.privateKeyToAsn1(i)).getBytes()};return ma.pem.encode(r,{maxline:e})};xs.privateKeyInfoToPem=function(i,e){var r={type:"PRIVATE KEY",body:lp.toDer(i).getBytes()};return ma.pem.encode(r,{maxline:e})};var oe=or,dc=function(i,e,r,t){var a=oe.util.createBuffer(),n=i.length>>1,c=n+(i.length&1),u=i.substr(0,c),v=i.substr(n,c),o=oe.util.createBuffer(),h=oe.hmac.create();r=e+r;var g=Math.ceil(t/16),y=Math.ceil(t/20);h.start("MD5",u);var _=oe.util.createBuffer();o.putBytes(r);for(var A=0;A<g;++A)h.start(null,null),h.update(o.getBytes()),o.putBuffer(h.digest()),h.start(null,null),h.update(o.bytes()+r),_.putBuffer(h.digest());h.start("SHA1",v);var S=oe.util.createBuffer();o.clear(),o.putBytes(r);for(var A=0;A<y;++A)h.start(null,null),h.update(o.getBytes()),o.putBuffer(h.digest()),h.start(null,null),h.update(o.bytes()+r),S.putBuffer(h.digest());return a.putBytes(oe.util.xorBytes(_.getBytes(),S.getBytes(),t)),a},MT=function(i,e,r){var t=oe.hmac.create();t.start("SHA1",i);var a=oe.util.createBuffer();return a.putInt32(e[0]),a.putInt32(e[1]),a.putByte(r.type),a.putByte(r.version.major),a.putByte(r.version.minor),a.putInt16(r.length),a.putBytes(r.fragment.bytes()),t.update(a.getBytes()),t.digest().getBytes()},BT=function(i,e,r){var t=!1;try{var a=i.deflate(e.fragment.getBytes());e.fragment=oe.util.createBuffer(a),e.length=a.length,t=!0}catch{}return t},LT=function(i,e,r){var t=!1;try{var a=i.inflate(e.fragment.getBytes());e.fragment=oe.util.createBuffer(a),e.length=a.length,t=!0}catch{}return t},Bi=function(i,e){var r=0;switch(e){case 1:r=i.getByte();break;case 2:r=i.getInt16();break;case 3:r=i.getInt24();break;case 4:r=i.getInt32();break}return oe.util.createBuffer(i.getBytes(r))},qi=function(i,e,r){i.putInt(r.length(),e<<3),i.putBuffer(r)},Et={};Et.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};Et.SupportedVersions=[Et.Versions.TLS_1_1,Et.Versions.TLS_1_0];Et.Version=Et.SupportedVersions[0];Et.MaxFragment=15360;Et.ConnectionEnd={server:0,client:1};Et.PRFAlgorithm={tls_prf_sha256:0};Et.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};Et.CipherType={stream:0,block:1,aead:2};Et.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};Et.CompressionMethod={none:0,deflate:1};Et.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};Et.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};Et.Alert={};Et.Alert.Level={warning:1,fatal:2};Et.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};Et.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};Et.CipherSuites={};Et.getCipherSuite=function(i){var e=null;for(var r in Et.CipherSuites){var t=Et.CipherSuites[r];if(t.id[0]===i.charCodeAt(0)&&t.id[1]===i.charCodeAt(1)){e=t;break}}return e};Et.handleUnexpected=function(i,e){var r=!i.open&&i.entity===Et.ConnectionEnd.client;r||i.error(i,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.unexpected_message}})};Et.handleHelloRequest=function(i,e,r){!i.handshaking&&i.handshakes>0&&(Et.queue(i,Et.createAlert(i,{level:Et.Alert.Level.warning,description:Et.Alert.Description.no_renegotiation})),Et.flush(i)),i.process()};Et.parseHelloMessage=function(i,e,r){var t=null,a=i.entity===Et.ConnectionEnd.client;if(r<38)i.error(i,{message:a?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.illegal_parameter}});else{var n=e.fragment,c=n.length();if(t={version:{major:n.getByte(),minor:n.getByte()},random:oe.util.createBuffer(n.getBytes(32)),session_id:Bi(n,1),extensions:[]},a?(t.cipher_suite=n.getBytes(2),t.compression_method=n.getByte()):(t.cipher_suites=Bi(n,2),t.compression_methods=Bi(n,1)),c=r-(c-n.length()),c>0){for(var u=Bi(n,2);u.length()>0;)t.extensions.push({type:[u.getByte(),u.getByte()],data:Bi(u,2)});if(!a)for(var v=0;v<t.extensions.length;++v){var o=t.extensions[v];if(o.type[0]===0&&o.type[1]===0)for(var h=Bi(o.data,2);h.length()>0;){var g=h.getByte();if(g!==0)break;i.session.extensions.server_name.serverNameList.push(Bi(h,2).getBytes())}}}if(i.session.version&&(t.version.major!==i.session.version.major||t.version.minor!==i.session.version.minor))return i.error(i,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.protocol_version}});if(a)i.session.cipherSuite=Et.getCipherSuite(t.cipher_suite);else for(var y=oe.util.createBuffer(t.cipher_suites.bytes());y.length()>0&&(i.session.cipherSuite=Et.getCipherSuite(y.getBytes(2)),i.session.cipherSuite===null););if(i.session.cipherSuite===null)return i.error(i,{message:"No cipher suites in common.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.handshake_failure},cipherSuite:oe.util.bytesToHex(t.cipher_suite)});a?i.session.compressionMethod=t.compression_method:i.session.compressionMethod=Et.CompressionMethod.none}return t};Et.createSecurityParameters=function(i,e){var r=i.entity===Et.ConnectionEnd.client,t=e.random.bytes(),a=r?i.session.sp.client_random:t,n=r?t:Et.createRandom().getBytes();i.session.sp={entity:i.entity,prf_algorithm:Et.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:i.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:a,server_random:n}};Et.handleServerHello=function(i,e,r){var t=Et.parseHelloMessage(i,e,r);if(!i.fail){if(t.version.minor<=i.version.minor)i.version.minor=t.version.minor;else return i.error(i,{message:"Incompatible TLS version.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.protocol_version}});i.session.version=i.version;var a=t.session_id.bytes();a.length>0&&a===i.session.id?(i.expect=P4,i.session.resuming=!0,i.session.sp.server_random=t.random.bytes()):(i.expect=RT,i.session.resuming=!1,Et.createSecurityParameters(i,t)),i.session.id=a,i.process()}};Et.handleClientHello=function(i,e,r){var t=Et.parseHelloMessage(i,e,r);if(!i.fail){var a=t.session_id.bytes(),n=null;if(i.sessionCache&&(n=i.sessionCache.getSession(a),n===null?a="":(n.version.major!==t.version.major||n.version.minor>t.version.minor)&&(n=null,a="")),a.length===0&&(a=oe.random.getBytes(32)),i.session.id=a,i.session.clientHelloVersion=t.version,i.session.sp={},n)i.version=i.session.version=n.version,i.session.sp=n.sp;else{for(var c,u=1;u<Et.SupportedVersions.length&&(c=Et.SupportedVersions[u],!(c.minor<=t.version.minor));++u);i.version={major:c.major,minor:c.minor},i.session.version=i.version}n!==null?(i.expect=cp,i.session.resuming=!0,i.session.sp.client_random=t.random.bytes()):(i.expect=i.verifyClient!==!1?FT:Qd,i.session.resuming=!1,Et.createSecurityParameters(i,t)),i.open=!0,Et.queue(i,Et.createRecord(i,{type:Et.ContentType.handshake,data:Et.createServerHello(i)})),i.session.resuming?(Et.queue(i,Et.createRecord(i,{type:Et.ContentType.change_cipher_spec,data:Et.createChangeCipherSpec()})),i.state.pending=Et.createConnectionState(i),i.state.current.write=i.state.pending.write,Et.queue(i,Et.createRecord(i,{type:Et.ContentType.handshake,data:Et.createFinished(i)}))):(Et.queue(i,Et.createRecord(i,{type:Et.ContentType.handshake,data:Et.createCertificate(i)})),i.fail||(Et.queue(i,Et.createRecord(i,{type:Et.ContentType.handshake,data:Et.createServerKeyExchange(i)})),i.verifyClient!==!1&&Et.queue(i,Et.createRecord(i,{type:Et.ContentType.handshake,data:Et.createCertificateRequest(i)})),Et.queue(i,Et.createRecord(i,{type:Et.ContentType.handshake,data:Et.createServerHelloDone(i)})))),Et.flush(i),i.process()}};Et.handleCertificate=function(i,e,r){if(r<3)return i.error(i,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.illegal_parameter}});var t=e.fragment,a={certificate_list:Bi(t,3)},n,c,u=[];try{for(;a.certificate_list.length()>0;)n=Bi(a.certificate_list,3),c=oe.asn1.fromDer(n),n=oe.pki.certificateFromAsn1(c,!0),u.push(n)}catch(o){return i.error(i,{message:"Could not parse certificate list.",cause:o,send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.bad_certificate}})}var v=i.entity===Et.ConnectionEnd.client;(v||i.verifyClient===!0)&&u.length===0?i.error(i,{message:v?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.illegal_parameter}}):u.length===0?i.expect=v?J3:Qd:(v?i.session.serverCertificate=u[0]:i.session.clientCertificate=u[0],Et.verifyCertificateChain(i,u)&&(i.expect=v?J3:Qd)),i.process()};Et.handleServerKeyExchange=function(i,e,r){if(r>0)return i.error(i,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.unsupported_certificate}});i.expect=NT,i.process()};Et.handleClientKeyExchange=function(i,e,r){if(r<48)return i.error(i,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.unsupported_certificate}});var t=e.fragment,a={enc_pre_master_secret:Bi(t,2).getBytes()},n=null;if(i.getPrivateKey)try{n=i.getPrivateKey(i,i.session.serverCertificate),n=oe.pki.privateKeyFromPem(n)}catch(v){i.error(i,{message:"Could not get private key.",cause:v,send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.internal_error}})}if(n===null)return i.error(i,{message:"No private key set.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.internal_error}});try{var c=i.session.sp;c.pre_master_secret=n.decrypt(a.enc_pre_master_secret);var u=i.session.clientHelloVersion;if(u.major!==c.pre_master_secret.charCodeAt(0)||u.minor!==c.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{c.pre_master_secret=oe.random.getBytes(48)}i.expect=cp,i.session.clientCertificate!==null&&(i.expect=qT),i.process()};Et.handleCertificateRequest=function(i,e,r){if(r<3)return i.error(i,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.illegal_parameter}});var t=e.fragment,a={certificate_types:Bi(t,1),certificate_authorities:Bi(t,2)};i.session.certificateRequest=a,i.expect=kT,i.process()};Et.handleCertificateVerify=function(i,e,r){if(r<2)return i.error(i,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.illegal_parameter}});var t=e.fragment;t.read-=4;var a=t.bytes();t.read+=4;var n={signature:Bi(t,2).getBytes()},c=oe.util.createBuffer();c.putBuffer(i.session.md5.digest()),c.putBuffer(i.session.sha1.digest()),c=c.getBytes();try{var u=i.session.clientCertificate;if(!u.publicKey.verify(c,n.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");i.session.md5.update(a),i.session.sha1.update(a)}catch{return i.error(i,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.handshake_failure}})}i.expect=cp,i.process()};Et.handleServerHelloDone=function(i,e,r){if(r>0)return i.error(i,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.record_overflow}});if(i.serverCertificate===null){var t={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.insufficient_security}},a=0,n=i.verify(i,t.alert.description,a,[]);if(n!==!0)return(n||n===0)&&(typeof n=="object"&&!oe.util.isArray(n)?(n.message&&(t.message=n.message),n.alert&&(t.alert.description=n.alert)):typeof n=="number"&&(t.alert.description=n)),i.error(i,t)}i.session.certificateRequest!==null&&(e=Et.createRecord(i,{type:Et.ContentType.handshake,data:Et.createCertificate(i)}),Et.queue(i,e)),e=Et.createRecord(i,{type:Et.ContentType.handshake,data:Et.createClientKeyExchange(i)}),Et.queue(i,e),i.expect=DT;var c=function(u,v){u.session.certificateRequest!==null&&u.session.clientCertificate!==null&&Et.queue(u,Et.createRecord(u,{type:Et.ContentType.handshake,data:Et.createCertificateVerify(u,v)})),Et.queue(u,Et.createRecord(u,{type:Et.ContentType.change_cipher_spec,data:Et.createChangeCipherSpec()})),u.state.pending=Et.createConnectionState(u),u.state.current.write=u.state.pending.write,Et.queue(u,Et.createRecord(u,{type:Et.ContentType.handshake,data:Et.createFinished(u)})),u.expect=P4,Et.flush(u),u.process()};if(i.session.certificateRequest===null||i.session.clientCertificate===null)return c(i,null);Et.getClientSignature(i,c)};Et.handleChangeCipherSpec=function(i,e){if(e.fragment.getByte()!==1)return i.error(i,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.illegal_parameter}});var r=i.entity===Et.ConnectionEnd.client;(i.session.resuming&&r||!i.session.resuming&&!r)&&(i.state.pending=Et.createConnectionState(i)),i.state.current.read=i.state.pending.read,(!i.session.resuming&&r||i.session.resuming&&!r)&&(i.state.pending=null),i.expect=r?PT:zT,i.process()};Et.handleFinished=function(i,e,r){var t=e.fragment;t.read-=4;var a=t.bytes();t.read+=4;var n=e.fragment.getBytes();t=oe.util.createBuffer(),t.putBuffer(i.session.md5.digest()),t.putBuffer(i.session.sha1.digest());var c=i.entity===Et.ConnectionEnd.client,u=c?"server finished":"client finished",v=i.session.sp,o=12,h=dc;if(t=h(v.master_secret,u,t.getBytes(),o),t.getBytes()!==n)return i.error(i,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.decrypt_error}});i.session.md5.update(a),i.session.sha1.update(a),(i.session.resuming&&c||!i.session.resuming&&!c)&&(Et.queue(i,Et.createRecord(i,{type:Et.ContentType.change_cipher_spec,data:Et.createChangeCipherSpec()})),i.state.current.write=i.state.pending.write,i.state.pending=null,Et.queue(i,Et.createRecord(i,{type:Et.ContentType.handshake,data:Et.createFinished(i)}))),i.expect=c?UT:VT,i.handshaking=!1,++i.handshakes,i.peerCertificate=c?i.session.serverCertificate:i.session.clientCertificate,Et.flush(i),i.isConnected=!0,i.connected(i),i.process()};Et.handleAlert=function(i,e){var r=e.fragment,t={level:r.getByte(),description:r.getByte()},a;switch(t.description){case Et.Alert.Description.close_notify:a="Connection closed.";break;case Et.Alert.Description.unexpected_message:a="Unexpected message.";break;case Et.Alert.Description.bad_record_mac:a="Bad record MAC.";break;case Et.Alert.Description.decryption_failed:a="Decryption failed.";break;case Et.Alert.Description.record_overflow:a="Record overflow.";break;case Et.Alert.Description.decompression_failure:a="Decompression failed.";break;case Et.Alert.Description.handshake_failure:a="Handshake failure.";break;case Et.Alert.Description.bad_certificate:a="Bad certificate.";break;case Et.Alert.Description.unsupported_certificate:a="Unsupported certificate.";break;case Et.Alert.Description.certificate_revoked:a="Certificate revoked.";break;case Et.Alert.Description.certificate_expired:a="Certificate expired.";break;case Et.Alert.Description.certificate_unknown:a="Certificate unknown.";break;case Et.Alert.Description.illegal_parameter:a="Illegal parameter.";break;case Et.Alert.Description.unknown_ca:a="Unknown certificate authority.";break;case Et.Alert.Description.access_denied:a="Access denied.";break;case Et.Alert.Description.decode_error:a="Decode error.";break;case Et.Alert.Description.decrypt_error:a="Decrypt error.";break;case Et.Alert.Description.export_restriction:a="Export restriction.";break;case Et.Alert.Description.protocol_version:a="Unsupported protocol version.";break;case Et.Alert.Description.insufficient_security:a="Insufficient security.";break;case Et.Alert.Description.internal_error:a="Internal error.";break;case Et.Alert.Description.user_canceled:a="User canceled.";break;case Et.Alert.Description.no_renegotiation:a="Renegotiation not supported.";break;default:a="Unknown error.";break}if(t.description===Et.Alert.Description.close_notify)return i.close();i.error(i,{message:a,send:!1,origin:i.entity===Et.ConnectionEnd.client?"server":"client",alert:t}),i.process()};Et.handleHandshake=function(i,e){var r=e.fragment,t=r.getByte(),a=r.getInt24();if(a>r.length())return i.fragmented=e,e.fragment=oe.util.createBuffer(),r.read-=4,i.process();i.fragmented=null,r.read-=4;var n=r.bytes(a+4);r.read+=4,t in wl[i.entity][i.expect]?(i.entity===Et.ConnectionEnd.server&&!i.open&&!i.fail&&(i.handshaking=!0,i.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:oe.md.md5.create(),sha1:oe.md.sha1.create()}),t!==Et.HandshakeType.hello_request&&t!==Et.HandshakeType.certificate_verify&&t!==Et.HandshakeType.finished&&(i.session.md5.update(n),i.session.sha1.update(n)),wl[i.entity][i.expect][t](i,e,a)):Et.handleUnexpected(i,e)};Et.handleApplicationData=function(i,e){i.data.putBuffer(e.fragment),i.dataReady(i),i.process()};Et.handleHeartbeat=function(i,e){var r=e.fragment,t=r.getByte(),a=r.getInt16(),n=r.getBytes(a);if(t===Et.HeartbeatMessageType.heartbeat_request){if(i.handshaking||a>n.length)return i.process();Et.queue(i,Et.createRecord(i,{type:Et.ContentType.heartbeat,data:Et.createHeartbeat(Et.HeartbeatMessageType.heartbeat_response,n)})),Et.flush(i)}else if(t===Et.HeartbeatMessageType.heartbeat_response){if(n!==i.expectedHeartbeatPayload)return i.process();i.heartbeatReceived&&i.heartbeatReceived(i,oe.util.createBuffer(n))}i.process()};var TT=0,RT=1,J3=2,NT=3,kT=4,P4=5,PT=6,UT=7,DT=8,OT=0,FT=1,Qd=2,qT=3,cp=4,zT=5,VT=6,Ct=Et.handleUnexpected,U4=Et.handleChangeCipherSpec,Jr=Et.handleAlert,hi=Et.handleHandshake,D4=Et.handleApplicationData,ti=Et.handleHeartbeat,up=[];up[Et.ConnectionEnd.client]=[[Ct,Jr,hi,Ct,ti],[Ct,Jr,hi,Ct,ti],[Ct,Jr,hi,Ct,ti],[Ct,Jr,hi,Ct,ti],[Ct,Jr,hi,Ct,ti],[U4,Jr,Ct,Ct,ti],[Ct,Jr,hi,Ct,ti],[Ct,Jr,hi,D4,ti],[Ct,Jr,hi,Ct,ti]];up[Et.ConnectionEnd.server]=[[Ct,Jr,hi,Ct,ti],[Ct,Jr,hi,Ct,ti],[Ct,Jr,hi,Ct,ti],[Ct,Jr,hi,Ct,ti],[U4,Jr,Ct,Ct,ti],[Ct,Jr,hi,Ct,ti],[Ct,Jr,hi,D4,ti],[Ct,Jr,hi,Ct,ti]];var Xn=Et.handleHelloRequest,GT=Et.handleServerHello,O4=Et.handleCertificate,ty=Et.handleServerKeyExchange,Kh=Et.handleCertificateRequest,Df=Et.handleServerHelloDone,F4=Et.handleFinished,wl=[];wl[Et.ConnectionEnd.client]=[[Ct,Ct,GT,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Xn,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,O4,ty,Kh,Df,Ct,Ct,Ct,Ct,Ct,Ct],[Xn,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,ty,Kh,Df,Ct,Ct,Ct,Ct,Ct,Ct],[Xn,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Kh,Df,Ct,Ct,Ct,Ct,Ct,Ct],[Xn,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Df,Ct,Ct,Ct,Ct,Ct,Ct],[Xn,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Xn,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,F4],[Xn,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Xn,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct]];var KT=Et.handleClientHello,HT=Et.handleClientKeyExchange,QT=Et.handleCertificateVerify;wl[Et.ConnectionEnd.server]=[[Ct,KT,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,O4,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,HT,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,QT,Ct,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,F4],[Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct],[Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct,Ct]];Et.generateKeys=function(i,e){var r=dc,t=e.client_random+e.server_random;i.session.resuming||(e.master_secret=r(e.pre_master_secret,"master secret",t,48).bytes(),e.pre_master_secret=null),t=e.server_random+e.client_random;var a=2*e.mac_key_length+2*e.enc_key_length,n=i.version.major===Et.Versions.TLS_1_0.major&&i.version.minor===Et.Versions.TLS_1_0.minor;n&&(a+=2*e.fixed_iv_length);var c=r(e.master_secret,"key expansion",t,a),u={client_write_MAC_key:c.getBytes(e.mac_key_length),server_write_MAC_key:c.getBytes(e.mac_key_length),client_write_key:c.getBytes(e.enc_key_length),server_write_key:c.getBytes(e.enc_key_length)};return n&&(u.client_write_IV=c.getBytes(e.fixed_iv_length),u.server_write_IV=c.getBytes(e.fixed_iv_length)),u};Et.createConnectionState=function(i){var e=i.entity===Et.ConnectionEnd.client,r=function(){var n={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(c){return!0},compressionState:null,compressFunction:function(c){return!0},updateSequenceNumber:function(){n.sequenceNumber[1]===4294967295?(n.sequenceNumber[1]=0,++n.sequenceNumber[0]):++n.sequenceNumber[1]}};return n},t={read:r(),write:r()};if(t.read.update=function(n,c){return t.read.cipherFunction(c,t.read)?t.read.compressFunction(n,c,t.read)||n.error(n,{message:"Could not decompress record.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.decompression_failure}}):n.error(n,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.bad_record_mac}}),!n.fail},t.write.update=function(n,c){return t.write.compressFunction(n,c,t.write)?t.write.cipherFunction(c,t.write)||n.error(n,{message:"Could not encrypt record.",send:!1,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.internal_error}}):n.error(n,{message:"Could not compress record.",send:!1,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.internal_error}}),!n.fail},i.session){var a=i.session.sp;switch(i.session.cipherSuite.initSecurityParameters(a),a.keys=Et.generateKeys(i,a),t.read.macKey=e?a.keys.server_write_MAC_key:a.keys.client_write_MAC_key,t.write.macKey=e?a.keys.client_write_MAC_key:a.keys.server_write_MAC_key,i.session.cipherSuite.initConnectionState(t,i,a),a.compression_algorithm){case Et.CompressionMethod.none:break;case Et.CompressionMethod.deflate:t.read.compressFunction=LT,t.write.compressFunction=BT;break;default:throw new Error("Unsupported compression algorithm.")}}return t};Et.createRandom=function(){var i=new Date,e=+i+i.getTimezoneOffset()*6e4,r=oe.util.createBuffer();return r.putInt32(e),r.putBytes(oe.random.getBytes(28)),r};Et.createRecord=function(i,e){if(!e.data)return null;var r={type:e.type,version:{major:i.version.major,minor:i.version.minor},length:e.data.length(),fragment:e.data};return r};Et.createAlert=function(i,e){var r=oe.util.createBuffer();return r.putByte(e.level),r.putByte(e.description),Et.createRecord(i,{type:Et.ContentType.alert,data:r})};Et.createClientHello=function(i){i.session.clientHelloVersion={major:i.version.major,minor:i.version.minor};for(var e=oe.util.createBuffer(),r=0;r<i.cipherSuites.length;++r){var t=i.cipherSuites[r];e.putByte(t.id[0]),e.putByte(t.id[1])}var a=e.length(),n=oe.util.createBuffer();n.putByte(Et.CompressionMethod.none);var c=n.length(),u=oe.util.createBuffer();if(i.virtualHost){var v=oe.util.createBuffer();v.putByte(0),v.putByte(0);var o=oe.util.createBuffer();o.putByte(0),qi(o,2,oe.util.createBuffer(i.virtualHost));var h=oe.util.createBuffer();qi(h,2,o),qi(v,2,h),u.putBuffer(v)}var g=u.length();g>0&&(g+=2);var y=i.session.id,_=y.length+1+2+4+28+2+a+1+c+g,A=oe.util.createBuffer();return A.putByte(Et.HandshakeType.client_hello),A.putInt24(_),A.putByte(i.version.major),A.putByte(i.version.minor),A.putBytes(i.session.sp.client_random),qi(A,1,oe.util.createBuffer(y)),qi(A,2,e),qi(A,1,n),g>0&&qi(A,2,u),A};Et.createServerHello=function(i){var e=i.session.id,r=e.length+1+2+4+28+2+1,t=oe.util.createBuffer();return t.putByte(Et.HandshakeType.server_hello),t.putInt24(r),t.putByte(i.version.major),t.putByte(i.version.minor),t.putBytes(i.session.sp.server_random),qi(t,1,oe.util.createBuffer(e)),t.putByte(i.session.cipherSuite.id[0]),t.putByte(i.session.cipherSuite.id[1]),t.putByte(i.session.compressionMethod),t};Et.createCertificate=function(i){var e=i.entity===Et.ConnectionEnd.client,r=null;if(i.getCertificate){var t;e?t=i.session.certificateRequest:t=i.session.extensions.server_name.serverNameList,r=i.getCertificate(i,t)}var a=oe.util.createBuffer();if(r!==null)try{oe.util.isArray(r)||(r=[r]);for(var n=null,c=0;c<r.length;++c){var u=oe.pem.decode(r[c])[0];if(u.type!=="CERTIFICATE"&&u.type!=="X509 CERTIFICATE"&&u.type!=="TRUSTED CERTIFICATE"){var v=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw v.headerType=u.type,v}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var o=oe.util.createBuffer(u.body);n===null&&(n=oe.asn1.fromDer(o.bytes(),!1));var h=oe.util.createBuffer();qi(h,3,o),a.putBuffer(h)}r=oe.pki.certificateFromAsn1(n),e?i.session.clientCertificate=r:i.session.serverCertificate=r}catch(_){return i.error(i,{message:"Could not send certificate list.",cause:_,send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.bad_certificate}})}var g=3+a.length(),y=oe.util.createBuffer();return y.putByte(Et.HandshakeType.certificate),y.putInt24(g),qi(y,3,a),y};Et.createClientKeyExchange=function(i){var e=oe.util.createBuffer();e.putByte(i.session.clientHelloVersion.major),e.putByte(i.session.clientHelloVersion.minor),e.putBytes(oe.random.getBytes(46));var r=i.session.sp;r.pre_master_secret=e.getBytes();var t=i.session.serverCertificate.publicKey;e=t.encrypt(r.pre_master_secret);var a=e.length+2,n=oe.util.createBuffer();return n.putByte(Et.HandshakeType.client_key_exchange),n.putInt24(a),n.putInt16(e.length),n.putBytes(e),n};Et.createServerKeyExchange=function(i){var e=oe.util.createBuffer();return e};Et.getClientSignature=function(i,e){var r=oe.util.createBuffer();r.putBuffer(i.session.md5.digest()),r.putBuffer(i.session.sha1.digest()),r=r.getBytes(),i.getSignature=i.getSignature||function(t,a,n){var c=null;if(t.getPrivateKey)try{c=t.getPrivateKey(t,t.session.clientCertificate),c=oe.pki.privateKeyFromPem(c)}catch(u){t.error(t,{message:"Could not get private key.",cause:u,send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.internal_error}})}c===null?t.error(t,{message:"No private key set.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.internal_error}}):a=c.sign(a,null),n(t,a)},i.getSignature(i,r,e)};Et.createCertificateVerify=function(i,e){var r=e.length+2,t=oe.util.createBuffer();return t.putByte(Et.HandshakeType.certificate_verify),t.putInt24(r),t.putInt16(e.length),t.putBytes(e),t};Et.createCertificateRequest=function(i){var e=oe.util.createBuffer();e.putByte(1);var r=oe.util.createBuffer();for(var t in i.caStore.certs){var a=i.caStore.certs[t],n=oe.pki.distinguishedNameToAsn1(a.subject),c=oe.asn1.toDer(n);r.putInt16(c.length()),r.putBuffer(c)}var u=1+e.length()+2+r.length(),v=oe.util.createBuffer();return v.putByte(Et.HandshakeType.certificate_request),v.putInt24(u),qi(v,1,e),qi(v,2,r),v};Et.createServerHelloDone=function(i){var e=oe.util.createBuffer();return e.putByte(Et.HandshakeType.server_hello_done),e.putInt24(0),e};Et.createChangeCipherSpec=function(){var i=oe.util.createBuffer();return i.putByte(1),i};Et.createFinished=function(i){var e=oe.util.createBuffer();e.putBuffer(i.session.md5.digest()),e.putBuffer(i.session.sha1.digest());var r=i.entity===Et.ConnectionEnd.client,t=i.session.sp,a=12,n=dc,c=r?"client finished":"server finished";e=n(t.master_secret,c,e.getBytes(),a);var u=oe.util.createBuffer();return u.putByte(Et.HandshakeType.finished),u.putInt24(e.length()),u.putBuffer(e),u};Et.createHeartbeat=function(i,e,r){typeof r>"u"&&(r=e.length);var t=oe.util.createBuffer();t.putByte(i),t.putInt16(r),t.putBytes(e);var a=t.length(),n=Math.max(16,a-r-3);return t.putBytes(oe.random.getBytes(n)),t};Et.queue=function(i,e){if(e&&!(e.fragment.length()===0&&(e.type===Et.ContentType.handshake||e.type===Et.ContentType.alert||e.type===Et.ContentType.change_cipher_spec))){if(e.type===Et.ContentType.handshake){var r=e.fragment.bytes();i.session.md5.update(r),i.session.sha1.update(r),r=null}var t;if(e.fragment.length()<=Et.MaxFragment)t=[e];else{t=[];for(var a=e.fragment.bytes();a.length>Et.MaxFragment;)t.push(Et.createRecord(i,{type:e.type,data:oe.util.createBuffer(a.slice(0,Et.MaxFragment))})),a=a.slice(Et.MaxFragment);a.length>0&&t.push(Et.createRecord(i,{type:e.type,data:oe.util.createBuffer(a)}))}for(var n=0;n<t.length&&!i.fail;++n){var c=t[n],u=i.state.current.write;u.update(i,c)&&i.records.push(c)}}};Et.flush=function(i){for(var e=0;e<i.records.length;++e){var r=i.records[e];i.tlsData.putByte(r.type),i.tlsData.putByte(r.version.major),i.tlsData.putByte(r.version.minor),i.tlsData.putInt16(r.fragment.length()),i.tlsData.putBuffer(i.records[e].fragment)}return i.records=[],i.tlsDataReady(i)};var Hh=function(i){switch(i){case!0:return!0;case oe.pki.certificateError.bad_certificate:return Et.Alert.Description.bad_certificate;case oe.pki.certificateError.unsupported_certificate:return Et.Alert.Description.unsupported_certificate;case oe.pki.certificateError.certificate_revoked:return Et.Alert.Description.certificate_revoked;case oe.pki.certificateError.certificate_expired:return Et.Alert.Description.certificate_expired;case oe.pki.certificateError.certificate_unknown:return Et.Alert.Description.certificate_unknown;case oe.pki.certificateError.unknown_ca:return Et.Alert.Description.unknown_ca;default:return Et.Alert.Description.bad_certificate}},$T=function(i){switch(i){case!0:return!0;case Et.Alert.Description.bad_certificate:return oe.pki.certificateError.bad_certificate;case Et.Alert.Description.unsupported_certificate:return oe.pki.certificateError.unsupported_certificate;case Et.Alert.Description.certificate_revoked:return oe.pki.certificateError.certificate_revoked;case Et.Alert.Description.certificate_expired:return oe.pki.certificateError.certificate_expired;case Et.Alert.Description.certificate_unknown:return oe.pki.certificateError.certificate_unknown;case Et.Alert.Description.unknown_ca:return oe.pki.certificateError.unknown_ca;default:return oe.pki.certificateError.bad_certificate}};Et.verifyCertificateChain=function(i,e){try{var r={};for(var t in i.verifyOptions)r[t]=i.verifyOptions[t];r.verify=function(n,c,u){var v=Hh(n),o=i.verify(i,n,c,u);if(o!==!0){if(typeof o=="object"&&!oe.util.isArray(o)){var h=new Error("The application rejected the certificate.");throw h.send=!0,h.alert={level:Et.Alert.Level.fatal,description:Et.Alert.Description.bad_certificate},o.message&&(h.message=o.message),o.alert&&(h.alert.description=o.alert),h}o!==n&&(o=$T(o))}return o},oe.pki.verifyCertificateChain(i.caStore,e,r)}catch(n){var a=n;(typeof a!="object"||oe.util.isArray(a))&&(a={send:!0,alert:{level:Et.Alert.Level.fatal,description:Hh(n)}}),"send"in a||(a.send=!0),"alert"in a||(a.alert={level:Et.Alert.Level.fatal,description:Hh(a.error)}),i.error(i,a)}return!i.fail};Et.createSessionCache=function(i,e){var r=null;if(i&&i.getSession&&i.setSession&&i.order)r=i;else{r={},r.cache=i||{},r.capacity=Math.max(e||100,1),r.order=[];for(var t in i)r.order.length<=e?r.order.push(t):delete i[t];r.getSession=function(a){var n=null,c=null;if(a?c=oe.util.bytesToHex(a):r.order.length>0&&(c=r.order[0]),c!==null&&c in r.cache){n=r.cache[c],delete r.cache[c];for(var u in r.order)if(r.order[u]===c){r.order.splice(u,1);break}}return n},r.setSession=function(a,n){if(r.order.length===r.capacity){var c=r.order.shift();delete r.cache[c]}var c=oe.util.bytesToHex(a);r.order.push(c),r.cache[c]=n}}return r};Et.createConnection=function(i){var e=null;i.caStore?oe.util.isArray(i.caStore)?e=oe.pki.createCaStore(i.caStore):e=i.caStore:e=oe.pki.createCaStore();var r=i.cipherSuites||null;if(r===null){r=[];for(var t in Et.CipherSuites)r.push(Et.CipherSuites[t])}var a=i.server?Et.ConnectionEnd.server:Et.ConnectionEnd.client,n=i.sessionCache?Et.createSessionCache(i.sessionCache):null,c={version:{major:Et.Version.major,minor:Et.Version.minor},entity:a,sessionId:i.sessionId,caStore:e,sessionCache:n,cipherSuites:r,connected:i.connected,virtualHost:i.virtualHost||null,verifyClient:i.verifyClient||!1,verify:i.verify||function(h,g,y,_){return g},verifyOptions:i.verifyOptions||{},getCertificate:i.getCertificate||null,getPrivateKey:i.getPrivateKey||null,getSignature:i.getSignature||null,input:oe.util.createBuffer(),tlsData:oe.util.createBuffer(),data:oe.util.createBuffer(),tlsDataReady:i.tlsDataReady,dataReady:i.dataReady,heartbeatReceived:i.heartbeatReceived,closed:i.closed,error:function(h,g){g.origin=g.origin||(h.entity===Et.ConnectionEnd.client?"client":"server"),g.send&&(Et.queue(h,Et.createAlert(h,g.alert)),Et.flush(h));var y=g.fatal!==!1;y&&(h.fail=!0),i.error(h,g),y&&h.close(!1)},deflate:i.deflate||null,inflate:i.inflate||null};c.reset=function(h){c.version={major:Et.Version.major,minor:Et.Version.minor},c.record=null,c.session=null,c.peerCertificate=null,c.state={pending:null,current:null},c.expect=c.entity===Et.ConnectionEnd.client?TT:OT,c.fragmented=null,c.records=[],c.open=!1,c.handshakes=0,c.handshaking=!1,c.isConnected=!1,c.fail=!(h||typeof h>"u"),c.input.clear(),c.tlsData.clear(),c.data.clear(),c.state.current=Et.createConnectionState(c)},c.reset();var u=function(h,g){var y=g.type-Et.ContentType.change_cipher_spec,_=up[h.entity][h.expect];y in _?_[y](h,g):Et.handleUnexpected(h,g)},v=function(h){var g=0,y=h.input,_=y.length();if(_<5)g=5-_;else{h.record={type:y.getByte(),version:{major:y.getByte(),minor:y.getByte()},length:y.getInt16(),fragment:oe.util.createBuffer(),ready:!1};var A=h.record.version.major===h.version.major;A&&h.session&&h.session.version&&(A=h.record.version.minor===h.version.minor),A||h.error(h,{message:"Incompatible TLS version.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.protocol_version}})}return g},o=function(h){var g=0,y=h.input,_=y.length();if(_<h.record.length)g=h.record.length-_;else{h.record.fragment.putBytes(y.getBytes(h.record.length)),y.compact();var A=h.state.current.read;A.update(h,h.record)&&(h.fragmented!==null&&(h.fragmented.type===h.record.type?(h.fragmented.fragment.putBuffer(h.record.fragment),h.record=h.fragmented):h.error(h,{message:"Invalid fragmented record.",send:!0,alert:{level:Et.Alert.Level.fatal,description:Et.Alert.Description.unexpected_message}})),h.record.ready=!0)}return g};return c.handshake=function(h){if(c.entity!==Et.ConnectionEnd.client)c.error(c,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(c.handshaking)c.error(c,{message:"Handshake already in progress.",fatal:!1});else{c.fail&&!c.open&&c.handshakes===0&&(c.fail=!1),c.handshaking=!0,h=h||"";var g=null;h.length>0&&(c.sessionCache&&(g=c.sessionCache.getSession(h)),g===null&&(h="")),h.length===0&&c.sessionCache&&(g=c.sessionCache.getSession(),g!==null&&(h=g.id)),c.session={id:h,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:oe.md.md5.create(),sha1:oe.md.sha1.create()},g&&(c.version=g.version,c.session.sp=g.sp),c.session.sp.client_random=Et.createRandom().getBytes(),c.open=!0,Et.queue(c,Et.createRecord(c,{type:Et.ContentType.handshake,data:Et.createClientHello(c)})),Et.flush(c)}},c.process=function(h){var g=0;return h&&c.input.putBytes(h),c.fail||(c.record!==null&&c.record.ready&&c.record.fragment.isEmpty()&&(c.record=null),c.record===null&&(g=v(c)),!c.fail&&c.record!==null&&!c.record.ready&&(g=o(c)),!c.fail&&c.record!==null&&c.record.ready&&u(c,c.record)),g},c.prepare=function(h){return Et.queue(c,Et.createRecord(c,{type:Et.ContentType.application_data,data:oe.util.createBuffer(h)})),Et.flush(c)},c.prepareHeartbeatRequest=function(h,g){return h instanceof oe.util.ByteBuffer&&(h=h.bytes()),typeof g>"u"&&(g=h.length),c.expectedHeartbeatPayload=h,Et.queue(c,Et.createRecord(c,{type:Et.ContentType.heartbeat,data:Et.createHeartbeat(Et.HeartbeatMessageType.heartbeat_request,h,g)})),Et.flush(c)},c.close=function(h){if(!c.fail&&c.sessionCache&&c.session){var g={id:c.session.id,version:c.session.version,sp:c.session.sp};g.sp.keys=null,c.sessionCache.setSession(g.id,g)}c.open&&(c.open=!1,c.input.clear(),(c.isConnected||c.handshaking)&&(c.isConnected=c.handshaking=!1,Et.queue(c,Et.createAlert(c,{level:Et.Alert.Level.warning,description:Et.Alert.Description.close_notify})),Et.flush(c)),c.closed(c)),c.reset(h)},c};oe.tls=oe.tls||{};for(var Qh in Et)typeof Et[Qh]!="function"&&(oe.tls[Qh]=Et[Qh]);oe.tls.prf_tls1=dc;oe.tls.hmac_sha1=MT;oe.tls.createSessionCache=Et.createSessionCache;oe.tls.createConnection=Et.createConnection;var ha=or,Hi=ha.tls;Hi.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(i){i.bulk_cipher_algorithm=Hi.BulkCipherAlgorithm.aes,i.cipher_type=Hi.CipherType.block,i.enc_key_length=16,i.block_length=16,i.fixed_iv_length=16,i.record_iv_length=16,i.mac_algorithm=Hi.MACAlgorithm.hmac_sha1,i.mac_length=20,i.mac_key_length=20},initConnectionState:q4};Hi.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(i){i.bulk_cipher_algorithm=Hi.BulkCipherAlgorithm.aes,i.cipher_type=Hi.CipherType.block,i.enc_key_length=32,i.block_length=16,i.fixed_iv_length=16,i.record_iv_length=16,i.mac_algorithm=Hi.MACAlgorithm.hmac_sha1,i.mac_length=20,i.mac_key_length=20},initConnectionState:q4};function q4(i,e,r){var t=e.entity===ha.tls.ConnectionEnd.client;i.read.cipherState={init:!1,cipher:ha.cipher.createDecipher("AES-CBC",t?r.keys.server_write_key:r.keys.client_write_key),iv:t?r.keys.server_write_IV:r.keys.client_write_IV},i.write.cipherState={init:!1,cipher:ha.cipher.createCipher("AES-CBC",t?r.keys.client_write_key:r.keys.server_write_key),iv:t?r.keys.client_write_IV:r.keys.server_write_IV},i.read.cipherFunction=YT,i.write.cipherFunction=ZT,i.read.macLength=i.write.macLength=r.mac_length,i.read.macFunction=i.write.macFunction=Hi.hmac_sha1}function ZT(i,e){var r=!1,t=e.macFunction(e.macKey,e.sequenceNumber,i);i.fragment.putBytes(t),e.updateSequenceNumber();var a;i.version.minor===Hi.Versions.TLS_1_0.minor?a=e.cipherState.init?null:e.cipherState.iv:a=ha.random.getBytesSync(16),e.cipherState.init=!0;var n=e.cipherState.cipher;return n.start({iv:a}),i.version.minor>=Hi.Versions.TLS_1_1.minor&&n.output.putBytes(a),n.update(i.fragment),n.finish(jT)&&(i.fragment=n.output,i.length=i.fragment.length(),r=!0),r}function jT(i,e,r){if(!r){var t=i-e.length()%i;e.fillWithByte(t-1,t)}return!0}function WT(i,e,r){var t=!0;if(r){for(var a=e.length(),n=e.last(),c=a-1-n;c<a-1;++c)t=t&&e.at(c)==n;t&&e.truncate(n+1)}return t}function YT(i,e){var r=!1,t;i.version.minor===Hi.Versions.TLS_1_0.minor?t=e.cipherState.init?null:e.cipherState.iv:t=i.fragment.getBytes(16),e.cipherState.init=!0;var a=e.cipherState.cipher;a.start({iv:t}),a.update(i.fragment),r=a.finish(WT);var n=e.macLength,c=ha.random.getBytesSync(n),u=a.output.length();u>=n?(i.fragment=a.output.getBytes(u-n),c=a.output.getBytes(n)):i.fragment=a.output.getBytes(),i.fragment=ha.util.createBuffer(i.fragment),i.length=i.fragment.length();var v=e.macFunction(e.macKey,e.sequenceNumber,i);return e.updateSequenceNumber(),r=XT(e.macKey,c,v)&&r,r}function XT(i,e,r){var t=ha.hmac.create();return t.start("SHA1",i),t.update(e),e=t.digest().getBytes(),t.start(null,null),t.update(r),r=t.digest().getBytes(),e===r}var kr=or,lf=kr.sha512=kr.sha512||{};kr.md.sha512=kr.md.algorithms.sha512=lf;var z4=kr.sha384=kr.sha512.sha384=kr.sha512.sha384||{};z4.create=function(){return lf.create("SHA-384")};kr.md.sha384=kr.md.algorithms.sha384=z4;kr.sha512.sha256=kr.sha512.sha256||{create:function(){return lf.create("SHA-512/256")}};kr.md["sha512/256"]=kr.md.algorithms["sha512/256"]=kr.sha512.sha256;kr.sha512.sha224=kr.sha512.sha224||{create:function(){return lf.create("SHA-512/224")}};kr.md["sha512/224"]=kr.md.algorithms["sha512/224"]=kr.sha512.sha224;lf.create=function(i){if(V4||JT(),typeof i>"u"&&(i="SHA-512"),!(i in Na))throw new Error("Invalid SHA-512 algorithm: "+i);for(var e=Na[i],r=null,t=kr.util.createBuffer(),a=new Array(80),n=0;n<80;++n)a[n]=new Array(2);var c=64;switch(i){case"SHA-384":c=48;break;case"SHA-512/256":c=32;break;case"SHA-512/224":c=28;break}var u={algorithm:i.replace("-","").toLowerCase(),blockLength:128,digestLength:c,messageLength:0,fullMessageLength:null,messageLengthSize:16};return u.start=function(){u.messageLength=0,u.fullMessageLength=u.messageLength128=[];for(var v=u.messageLengthSize/4,o=0;o<v;++o)u.fullMessageLength.push(0);t=kr.util.createBuffer(),r=new Array(e.length);for(var o=0;o<e.length;++o)r[o]=e[o].slice(0);return u},u.start(),u.update=function(v,o){o==="utf8"&&(v=kr.util.encodeUtf8(v));var h=v.length;u.messageLength+=h,h=[h/4294967296>>>0,h>>>0];for(var g=u.fullMessageLength.length-1;g>=0;--g)u.fullMessageLength[g]+=h[1],h[1]=h[0]+(u.fullMessageLength[g]/4294967296>>>0),u.fullMessageLength[g]=u.fullMessageLength[g]>>>0,h[0]=h[1]/4294967296>>>0;return t.putBytes(v),ey(r,a,t),(t.read>2048||t.length()===0)&&t.compact(),u},u.digest=function(){var v=kr.util.createBuffer();v.putBytes(t.bytes());var o=u.fullMessageLength[u.fullMessageLength.length-1]+u.messageLengthSize,h=o&u.blockLength-1;v.putBytes($d.substr(0,u.blockLength-h));for(var g,y,_=u.fullMessageLength[0]*8,A=0;A<u.fullMessageLength.length-1;++A)g=u.fullMessageLength[A+1]*8,y=g/4294967296>>>0,_+=y,v.putInt32(_>>>0),_=g>>>0;v.putInt32(_);for(var S=new Array(r.length),A=0;A<r.length;++A)S[A]=r[A].slice(0);ey(S,a,v);var T=kr.util.createBuffer(),B;i==="SHA-512"?B=S.length:i==="SHA-384"?B=S.length-2:B=S.length-4;for(var A=0;A<B;++A)T.putInt32(S[A][0]),(A!==B-1||i!=="SHA-512/224")&&T.putInt32(S[A][1]);return T},u};var $d=null,V4=!1,Zd=null,Na=null;function JT(){$d="",$d+=kr.util.fillString("\0",128),Zd=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Na={},Na["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Na["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Na["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Na["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],V4=!0}function ey(i,e,r){for(var t,a,n,c,u,v,o,h,g,y,_,A,S,T,B,M,R,P,D,q,k,U,O,G,E,s,l,d,p,m,w,x,b,f,C,F=r.length();F>=128;){for(p=0;p<16;++p)e[p][0]=r.getInt32()>>>0,e[p][1]=r.getInt32()>>>0;for(;p<80;++p)x=e[p-2],m=x[0],w=x[1],t=((m>>>19|w<<13)^(w>>>29|m<<3)^m>>>6)>>>0,a=((m<<13|w>>>19)^(w<<3|m>>>29)^(m<<26|w>>>6))>>>0,f=e[p-15],m=f[0],w=f[1],n=((m>>>1|w<<31)^(m>>>8|w<<24)^m>>>7)>>>0,c=((m<<31|w>>>1)^(m<<24|w>>>8)^(m<<25|w>>>7))>>>0,b=e[p-7],C=e[p-16],w=a+b[1]+c+C[1],e[p][0]=t+b[0]+n+C[0]+(w/4294967296>>>0)>>>0,e[p][1]=w>>>0;for(S=i[0][0],T=i[0][1],B=i[1][0],M=i[1][1],R=i[2][0],P=i[2][1],D=i[3][0],q=i[3][1],k=i[4][0],U=i[4][1],O=i[5][0],G=i[5][1],E=i[6][0],s=i[6][1],l=i[7][0],d=i[7][1],p=0;p<80;++p)o=((k>>>14|U<<18)^(k>>>18|U<<14)^(U>>>9|k<<23))>>>0,h=((k<<18|U>>>14)^(k<<14|U>>>18)^(U<<23|k>>>9))>>>0,g=(E^k&(O^E))>>>0,y=(s^U&(G^s))>>>0,u=((S>>>28|T<<4)^(T>>>2|S<<30)^(T>>>7|S<<25))>>>0,v=((S<<4|T>>>28)^(T<<30|S>>>2)^(T<<25|S>>>7))>>>0,_=(S&B|R&(S^B))>>>0,A=(T&M|P&(T^M))>>>0,w=d+h+y+Zd[p][1]+e[p][1],t=l+o+g+Zd[p][0]+e[p][0]+(w/4294967296>>>0)>>>0,a=w>>>0,w=v+A,n=u+_+(w/4294967296>>>0)>>>0,c=w>>>0,l=E,d=s,E=O,s=G,O=k,G=U,w=q+a,k=D+t+(w/4294967296>>>0)>>>0,U=w>>>0,D=R,q=P,R=B,P=M,B=S,M=T,w=a+c,S=t+n+(w/4294967296>>>0)>>>0,T=w>>>0;w=i[0][1]+T,i[0][0]=i[0][0]+S+(w/4294967296>>>0)>>>0,i[0][1]=w>>>0,w=i[1][1]+M,i[1][0]=i[1][0]+B+(w/4294967296>>>0)>>>0,i[1][1]=w>>>0,w=i[2][1]+P,i[2][0]=i[2][0]+R+(w/4294967296>>>0)>>>0,i[2][1]=w>>>0,w=i[3][1]+q,i[3][0]=i[3][0]+D+(w/4294967296>>>0)>>>0,i[3][1]=w>>>0,w=i[4][1]+U,i[4][0]=i[4][0]+k+(w/4294967296>>>0)>>>0,i[4][1]=w>>>0,w=i[5][1]+G,i[5][0]=i[5][0]+O+(w/4294967296>>>0)>>>0,i[5][1]=w>>>0,w=i[6][1]+s,i[6][0]=i[6][0]+E+(w/4294967296>>>0)>>>0,i[6][1]=w>>>0,w=i[7][1]+d,i[7][0]=i[7][0]+l+(w/4294967296>>>0)>>>0,i[7][1]=w>>>0,F-=128}}var hp={},tR=or,Qr=tR.asn1;hp.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Qr.Class.UNIVERSAL,type:Qr.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Qr.Class.UNIVERSAL,type:Qr.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Qr.Class.UNIVERSAL,type:Qr.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Qr.Class.UNIVERSAL,type:Qr.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Qr.Class.UNIVERSAL,type:Qr.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};hp.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Qr.Class.UNIVERSAL,type:Qr.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Qr.Class.UNIVERSAL,type:Qr.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Qr.Class.UNIVERSAL,type:Qr.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Qr.Class.UNIVERSAL,type:Qr.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]};var ei=or,G4=hp,eR=G4.publicKeyValidator,rR=G4.privateKeyValidator;if(typeof iR>"u")var iR=ei.jsbn.BigInteger;var jd=ei.util.ByteBuffer,Si=typeof Buffer>"u"?Uint8Array:Buffer;ei.pki=ei.pki||{};ei.pki.ed25519=ei.ed25519=ei.ed25519||{};var cr=ei.ed25519;cr.constants={};cr.constants.PUBLIC_KEY_BYTE_LENGTH=32;cr.constants.PRIVATE_KEY_BYTE_LENGTH=64;cr.constants.SEED_BYTE_LENGTH=32;cr.constants.SIGN_BYTE_LENGTH=64;cr.constants.HASH_BYTE_LENGTH=64;cr.generateKeyPair=function(i){i=i||{};var e=i.seed;if(e===void 0)e=ei.random.getBytesSync(cr.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==cr.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+cr.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=Qn({message:e,encoding:"binary"});for(var r=new Si(cr.constants.PUBLIC_KEY_BYTE_LENGTH),t=new Si(cr.constants.PRIVATE_KEY_BYTE_LENGTH),a=0;a<32;++a)t[a]=e[a];return oR(r,t),{publicKey:r,privateKey:t}};cr.privateKeyFromAsn1=function(i){var e={},r=[],t=ei.asn1.validate(i,rR,e,r);if(!t){var a=new Error("Invalid Key.");throw a.errors=r,a}var n=ei.asn1.derToOid(e.privateKeyOid),c=ei.oids.EdDSA25519;if(n!==c)throw new Error('Invalid OID "'+n+'"; OID must be "'+c+'".');var u=e.privateKey,v=Qn({message:ei.asn1.fromDer(u).value,encoding:"binary"});return{privateKeyBytes:v}};cr.publicKeyFromAsn1=function(i){var e={},r=[],t=ei.asn1.validate(i,eR,e,r);if(!t){var a=new Error("Invalid Key.");throw a.errors=r,a}var n=ei.asn1.derToOid(e.publicKeyOid),c=ei.oids.EdDSA25519;if(n!==c)throw new Error('Invalid OID "'+n+'"; OID must be "'+c+'".');var u=e.ed25519PublicKey;if(u.length!==cr.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return Qn({message:u,encoding:"binary"})};cr.publicKeyFromPrivateKey=function(i){i=i||{};var e=Qn({message:i.privateKey,encoding:"binary"});if(e.length!==cr.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+cr.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new Si(cr.constants.PUBLIC_KEY_BYTE_LENGTH),t=0;t<r.length;++t)r[t]=e[32+t];return r};cr.sign=function(i){i=i||{};var e=Qn(i),r=Qn({message:i.privateKey,encoding:"binary"});if(r.length===cr.constants.SEED_BYTE_LENGTH){var t=cr.generateKeyPair({seed:r});r=t.privateKey}else if(r.length!==cr.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+cr.constants.SEED_BYTE_LENGTH+" or "+cr.constants.PRIVATE_KEY_BYTE_LENGTH);var a=new Si(cr.constants.SIGN_BYTE_LENGTH+e.length);fR(a,e,e.length,r);for(var n=new Si(cr.constants.SIGN_BYTE_LENGTH),c=0;c<n.length;++c)n[c]=a[c];return n};cr.verify=function(i){i=i||{};var e=Qn(i);if(i.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=Qn({message:i.signature,encoding:"binary"});if(r.length!==cr.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+cr.constants.SIGN_BYTE_LENGTH);var t=Qn({message:i.publicKey,encoding:"binary"});if(t.length!==cr.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+cr.constants.PUBLIC_KEY_BYTE_LENGTH);var a=new Si(cr.constants.SIGN_BYTE_LENGTH+e.length),n=new Si(cr.constants.SIGN_BYTE_LENGTH+e.length),c;for(c=0;c<cr.constants.SIGN_BYTE_LENGTH;++c)a[c]=r[c];for(c=0;c<e.length;++c)a[c+cr.constants.SIGN_BYTE_LENGTH]=e[c];return lR(n,a,a.length,t)>=0};function Qn(i){var e=i.message;if(e instanceof Uint8Array||e instanceof Si)return e;var r=i.encoding;if(e===void 0)if(i.md)e=i.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.from(e,r);e=new jd(e,r)}else if(!(e instanceof jd))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var t=new Si(e.length()),a=0;a<t.length;++a)t[a]=e.at(a);return t}var Wd=Re(),Cl=Re([1]),nR=Re([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),aR=Re([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),ry=Re([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),iy=Re([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$h=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),sR=Re([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function xo(i,e){var r=ei.md.sha512.create(),t=new jd(i);r.update(t.getBytes(e),"binary");var a=r.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(a,"binary");for(var n=new Si(cr.constants.HASH_BYTE_LENGTH),c=0;c<64;++c)n[c]=a.charCodeAt(c);return n}function oR(i,e){var r=[Re(),Re(),Re(),Re()],t,a=xo(e,32);for(a[0]&=248,a[31]&=127,a[31]|=64,pp(r,a),dp(i,r),t=0;t<32;++t)e[t+32]=i[t];return 0}function fR(i,e,r,t){var a,n,c=new Float64Array(64),u=[Re(),Re(),Re(),Re()],v=xo(t,32);v[0]&=248,v[31]&=127,v[31]|=64;var o=r+64;for(a=0;a<r;++a)i[64+a]=e[a];for(a=0;a<32;++a)i[32+a]=v[32+a];var h=xo(i.subarray(32),r+32);for(Yd(h),pp(u,h),dp(i,u),a=32;a<64;++a)i[a]=t[a];var g=xo(i,r+64);for(Yd(g),a=32;a<64;++a)c[a]=0;for(a=0;a<32;++a)c[a]=h[a];for(a=0;a<32;++a)for(n=0;n<32;n++)c[a+n]+=g[a]*v[n];return K4(i.subarray(32),c),o}function lR(i,e,r,t){var a,n,c=new Si(32),u=[Re(),Re(),Re(),Re()],v=[Re(),Re(),Re(),Re()];if(n=-1,r<64||cR(v,t))return-1;for(a=0;a<r;++a)i[a]=e[a];for(a=0;a<32;++a)i[a+32]=t[a];var o=xo(i,r);if(Yd(o),$4(u,v,o),pp(v,e.subarray(32)),Xd(u,v),dp(c,u),r-=64,H4(e,0,c,0)){for(a=0;a<r;++a)i[a]=0;return-1}for(a=0;a<r;++a)i[a]=e[a+64];return n=r,n}function K4(i,e){var r,t,a,n;for(t=63;t>=32;--t){for(r=0,a=t-32,n=t-12;a<n;++a)e[a]+=r-16*e[t]*$h[a-(t-32)],r=e[a]+128>>8,e[a]-=r*256;e[a]+=r,e[t]=0}for(r=0,a=0;a<32;++a)e[a]+=r-(e[31]>>4)*$h[a],r=e[a]>>8,e[a]&=255;for(a=0;a<32;++a)e[a]-=r*$h[a];for(t=0;t<32;++t)e[t+1]+=e[t]>>8,i[t]=e[t]&255}function Yd(i){for(var e=new Float64Array(64),r=0;r<64;++r)e[r]=i[r],i[r]=0;K4(i,e)}function Xd(i,e){var r=Re(),t=Re(),a=Re(),n=Re(),c=Re(),u=Re(),v=Re(),o=Re(),h=Re();cs(r,i[1],i[0]),cs(h,e[1],e[0]),Ir(r,r,h),os(t,i[0],i[1]),os(h,e[0],e[1]),Ir(t,t,h),Ir(a,i[3],e[3]),Ir(a,a,aR),Ir(n,i[2],e[2]),os(n,n,n),cs(c,t,r),cs(u,n,a),os(v,n,a),os(o,t,r),Ir(i[0],c,u),Ir(i[1],o,v),Ir(i[2],v,u),Ir(i[3],c,o)}function ny(i,e,r){for(var t=0;t<4;++t)Z4(i[t],e[t],r)}function dp(i,e){var r=Re(),t=Re(),a=Re();pR(a,e[2]),Ir(r,e[0],a),Ir(t,e[1],a),El(i,t),i[31]^=Q4(r)<<7}function El(i,e){var r,t,a,n=Re(),c=Re();for(r=0;r<16;++r)c[r]=e[r];for(Zh(c),Zh(c),Zh(c),t=0;t<2;++t){for(n[0]=c[0]-65517,r=1;r<15;++r)n[r]=c[r]-65535-(n[r-1]>>16&1),n[r-1]&=65535;n[15]=c[15]-32767-(n[14]>>16&1),a=n[15]>>16&1,n[14]&=65535,Z4(c,n,1-a)}for(r=0;r<16;r++)i[2*r]=c[r]&255,i[2*r+1]=c[r]>>8}function cR(i,e){var r=Re(),t=Re(),a=Re(),n=Re(),c=Re(),u=Re(),v=Re();return oa(i[2],Cl),uR(i[1],e),ka(a,i[1]),Ir(n,a,nR),cs(a,a,i[2]),os(n,i[2],n),ka(c,n),ka(u,c),Ir(v,u,c),Ir(r,v,a),Ir(r,r,n),hR(r,r),Ir(r,r,a),Ir(r,r,n),Ir(r,r,n),Ir(i[0],r,n),ka(t,i[0]),Ir(t,t,n),ay(t,a)&&Ir(i[0],i[0],sR),ka(t,i[0]),Ir(t,t,n),ay(t,a)?-1:(Q4(i[0])===e[31]>>7&&cs(i[0],Wd,i[0]),Ir(i[3],i[0],i[1]),0)}function uR(i,e){var r;for(r=0;r<16;++r)i[r]=e[2*r]+(e[2*r+1]<<8);i[15]&=32767}function hR(i,e){var r=Re(),t;for(t=0;t<16;++t)r[t]=e[t];for(t=250;t>=0;--t)ka(r,r),t!==1&&Ir(r,r,e);for(t=0;t<16;++t)i[t]=r[t]}function ay(i,e){var r=new Si(32),t=new Si(32);return El(r,i),El(t,e),H4(r,0,t,0)}function H4(i,e,r,t){return dR(i,e,r,t,32)}function dR(i,e,r,t,a){var n,c=0;for(n=0;n<a;++n)c|=i[e+n]^r[t+n];return(1&c-1>>>8)-1}function Q4(i){var e=new Si(32);return El(e,i),e[0]&1}function $4(i,e,r){var t,a;for(oa(i[0],Wd),oa(i[1],Cl),oa(i[2],Cl),oa(i[3],Wd),a=255;a>=0;--a)t=r[a/8|0]>>(a&7)&1,ny(i,e,t),Xd(e,i),Xd(i,i),ny(i,e,t)}function pp(i,e){var r=[Re(),Re(),Re(),Re()];oa(r[0],ry),oa(r[1],iy),oa(r[2],Cl),Ir(r[3],ry,iy),$4(i,r,e)}function oa(i,e){var r;for(r=0;r<16;r++)i[r]=e[r]|0}function pR(i,e){var r=Re(),t;for(t=0;t<16;++t)r[t]=e[t];for(t=253;t>=0;--t)ka(r,r),t!==2&&t!==4&&Ir(r,r,e);for(t=0;t<16;++t)i[t]=r[t]}function Zh(i){var e,r,t=1;for(e=0;e<16;++e)r=i[e]+t+65535,t=Math.floor(r/65536),i[e]=r-t*65536;i[0]+=t-1+37*(t-1)}function Z4(i,e,r){for(var t,a=~(r-1),n=0;n<16;++n)t=a&(i[n]^e[n]),i[n]^=t,e[n]^=t}function Re(i){var e,r=new Float64Array(16);if(i)for(e=0;e<i.length;++e)r[e]=i[e];return r}function os(i,e,r){for(var t=0;t<16;++t)i[t]=e[t]+r[t]}function cs(i,e,r){for(var t=0;t<16;++t)i[t]=e[t]-r[t]}function ka(i,e){Ir(i,e,e)}function Ir(i,e,r){var t,a,n=0,c=0,u=0,v=0,o=0,h=0,g=0,y=0,_=0,A=0,S=0,T=0,B=0,M=0,R=0,P=0,D=0,q=0,k=0,U=0,O=0,G=0,E=0,s=0,l=0,d=0,p=0,m=0,w=0,x=0,b=0,f=r[0],C=r[1],F=r[2],z=r[3],W=r[4],$=r[5],I=r[6],K=r[7],N=r[8],X=r[9],Q=r[10],L=r[11],V=r[12],Z=r[13],H=r[14],j=r[15];t=e[0],n+=t*f,c+=t*C,u+=t*F,v+=t*z,o+=t*W,h+=t*$,g+=t*I,y+=t*K,_+=t*N,A+=t*X,S+=t*Q,T+=t*L,B+=t*V,M+=t*Z,R+=t*H,P+=t*j,t=e[1],c+=t*f,u+=t*C,v+=t*F,o+=t*z,h+=t*W,g+=t*$,y+=t*I,_+=t*K,A+=t*N,S+=t*X,T+=t*Q,B+=t*L,M+=t*V,R+=t*Z,P+=t*H,D+=t*j,t=e[2],u+=t*f,v+=t*C,o+=t*F,h+=t*z,g+=t*W,y+=t*$,_+=t*I,A+=t*K,S+=t*N,T+=t*X,B+=t*Q,M+=t*L,R+=t*V,P+=t*Z,D+=t*H,q+=t*j,t=e[3],v+=t*f,o+=t*C,h+=t*F,g+=t*z,y+=t*W,_+=t*$,A+=t*I,S+=t*K,T+=t*N,B+=t*X,M+=t*Q,R+=t*L,P+=t*V,D+=t*Z,q+=t*H,k+=t*j,t=e[4],o+=t*f,h+=t*C,g+=t*F,y+=t*z,_+=t*W,A+=t*$,S+=t*I,T+=t*K,B+=t*N,M+=t*X,R+=t*Q,P+=t*L,D+=t*V,q+=t*Z,k+=t*H,U+=t*j,t=e[5],h+=t*f,g+=t*C,y+=t*F,_+=t*z,A+=t*W,S+=t*$,T+=t*I,B+=t*K,M+=t*N,R+=t*X,P+=t*Q,D+=t*L,q+=t*V,k+=t*Z,U+=t*H,O+=t*j,t=e[6],g+=t*f,y+=t*C,_+=t*F,A+=t*z,S+=t*W,T+=t*$,B+=t*I,M+=t*K,R+=t*N,P+=t*X,D+=t*Q,q+=t*L,k+=t*V,U+=t*Z,O+=t*H,G+=t*j,t=e[7],y+=t*f,_+=t*C,A+=t*F,S+=t*z,T+=t*W,B+=t*$,M+=t*I,R+=t*K,P+=t*N,D+=t*X,q+=t*Q,k+=t*L,U+=t*V,O+=t*Z,G+=t*H,E+=t*j,t=e[8],_+=t*f,A+=t*C,S+=t*F,T+=t*z,B+=t*W,M+=t*$,R+=t*I,P+=t*K,D+=t*N,q+=t*X,k+=t*Q,U+=t*L,O+=t*V,G+=t*Z,E+=t*H,s+=t*j,t=e[9],A+=t*f,S+=t*C,T+=t*F,B+=t*z,M+=t*W,R+=t*$,P+=t*I,D+=t*K,q+=t*N,k+=t*X,U+=t*Q,O+=t*L,G+=t*V,E+=t*Z,s+=t*H,l+=t*j,t=e[10],S+=t*f,T+=t*C,B+=t*F,M+=t*z,R+=t*W,P+=t*$,D+=t*I,q+=t*K,k+=t*N,U+=t*X,O+=t*Q,G+=t*L,E+=t*V,s+=t*Z,l+=t*H,d+=t*j,t=e[11],T+=t*f,B+=t*C,M+=t*F,R+=t*z,P+=t*W,D+=t*$,q+=t*I,k+=t*K,U+=t*N,O+=t*X,G+=t*Q,E+=t*L,s+=t*V,l+=t*Z,d+=t*H,p+=t*j,t=e[12],B+=t*f,M+=t*C,R+=t*F,P+=t*z,D+=t*W,q+=t*$,k+=t*I,U+=t*K,O+=t*N,G+=t*X,E+=t*Q,s+=t*L,l+=t*V,d+=t*Z,p+=t*H,m+=t*j,t=e[13],M+=t*f,R+=t*C,P+=t*F,D+=t*z,q+=t*W,k+=t*$,U+=t*I,O+=t*K,G+=t*N,E+=t*X,s+=t*Q,l+=t*L,d+=t*V,p+=t*Z,m+=t*H,w+=t*j,t=e[14],R+=t*f,P+=t*C,D+=t*F,q+=t*z,k+=t*W,U+=t*$,O+=t*I,G+=t*K,E+=t*N,s+=t*X,l+=t*Q,d+=t*L,p+=t*V,m+=t*Z,w+=t*H,x+=t*j,t=e[15],P+=t*f,D+=t*C,q+=t*F,k+=t*z,U+=t*W,O+=t*$,G+=t*I,E+=t*K,s+=t*N,l+=t*X,d+=t*Q,p+=t*L,m+=t*V,w+=t*Z,x+=t*H,b+=t*j,n+=38*D,c+=38*q,u+=38*k,v+=38*U,o+=38*O,h+=38*G,g+=38*E,y+=38*s,_+=38*l,A+=38*d,S+=38*p,T+=38*m,B+=38*w,M+=38*x,R+=38*b,a=1,t=n+a+65535,a=Math.floor(t/65536),n=t-a*65536,t=c+a+65535,a=Math.floor(t/65536),c=t-a*65536,t=u+a+65535,a=Math.floor(t/65536),u=t-a*65536,t=v+a+65535,a=Math.floor(t/65536),v=t-a*65536,t=o+a+65535,a=Math.floor(t/65536),o=t-a*65536,t=h+a+65535,a=Math.floor(t/65536),h=t-a*65536,t=g+a+65535,a=Math.floor(t/65536),g=t-a*65536,t=y+a+65535,a=Math.floor(t/65536),y=t-a*65536,t=_+a+65535,a=Math.floor(t/65536),_=t-a*65536,t=A+a+65535,a=Math.floor(t/65536),A=t-a*65536,t=S+a+65535,a=Math.floor(t/65536),S=t-a*65536,t=T+a+65535,a=Math.floor(t/65536),T=t-a*65536,t=B+a+65535,a=Math.floor(t/65536),B=t-a*65536,t=M+a+65535,a=Math.floor(t/65536),M=t-a*65536,t=R+a+65535,a=Math.floor(t/65536),R=t-a*65536,t=P+a+65535,a=Math.floor(t/65536),P=t-a*65536,n+=a-1+37*(a-1),a=1,t=n+a+65535,a=Math.floor(t/65536),n=t-a*65536,t=c+a+65535,a=Math.floor(t/65536),c=t-a*65536,t=u+a+65535,a=Math.floor(t/65536),u=t-a*65536,t=v+a+65535,a=Math.floor(t/65536),v=t-a*65536,t=o+a+65535,a=Math.floor(t/65536),o=t-a*65536,t=h+a+65535,a=Math.floor(t/65536),h=t-a*65536,t=g+a+65535,a=Math.floor(t/65536),g=t-a*65536,t=y+a+65535,a=Math.floor(t/65536),y=t-a*65536,t=_+a+65535,a=Math.floor(t/65536),_=t-a*65536,t=A+a+65535,a=Math.floor(t/65536),A=t-a*65536,t=S+a+65535,a=Math.floor(t/65536),S=t-a*65536,t=T+a+65535,a=Math.floor(t/65536),T=t-a*65536,t=B+a+65535,a=Math.floor(t/65536),B=t-a*65536,t=M+a+65535,a=Math.floor(t/65536),M=t-a*65536,t=R+a+65535,a=Math.floor(t/65536),R=t-a*65536,t=P+a+65535,a=Math.floor(t/65536),P=t-a*65536,n+=a-1+37*(a-1),i[0]=n,i[1]=c,i[2]=u,i[3]=v,i[4]=o,i[5]=h,i[6]=g,i[7]=y,i[8]=_,i[9]=A,i[10]=S,i[11]=T,i[12]=B,i[13]=M,i[14]=R,i[15]=P}var Ti=or;Ti.kem=Ti.kem||{};var sy=Ti.jsbn.BigInteger;Ti.kem.rsa={};Ti.kem.rsa.create=function(i,e){e=e||{};var r=e.prng||Ti.random,t={};return t.encrypt=function(a,n){var c=Math.ceil(a.n.bitLength()/8),u;do u=new sy(Ti.util.bytesToHex(r.getBytesSync(c)),16).mod(a.n);while(u.compareTo(sy.ONE)<=0);u=Ti.util.hexToBytes(u.toString(16));var v=c-u.length;v>0&&(u=Ti.util.fillString("\0",v)+u);var o=a.encrypt(u,"NONE"),h=i.generate(u,n);return{encapsulation:o,key:h}},t.decrypt=function(a,n,c){var u=a.decrypt(n,"NONE");return i.generate(u,c)},t};Ti.kem.kdf1=function(i,e){j4(this,i,0,e||i.digestLength)};Ti.kem.kdf2=function(i,e){j4(this,i,1,e||i.digestLength)};function j4(i,e,r,t){i.generate=function(a,n){for(var c=new Ti.util.ByteBuffer,u=Math.ceil(n/t)+r,v=new Ti.util.ByteBuffer,o=r;o<u;++o){v.putInt32(o),e.start(),e.update(a+v.getBytes());var h=e.digest();c.putBytes(h.getBytes(t))}return c.truncate(c.length()-n),c.getBytes()}}var dr=or;dr.log=dr.log||{};dr.log.levels=["none","error","warning","info","debug","verbose","max"];var Al={},Jd=[],Io=null;dr.log.LEVEL_LOCKED=2;dr.log.NO_LEVEL_CHECK=4;dr.log.INTERPOLATE=8;for(var fa=0;fa<dr.log.levels.length;++fa){var oy=dr.log.levels[fa];Al[oy]={index:fa,name:oy.toUpperCase()}}dr.log.logMessage=function(i){for(var e=Al[i.level].index,r=0;r<Jd.length;++r){var t=Jd[r];if(t.flags&dr.log.NO_LEVEL_CHECK)t.f(i);else{var a=Al[t.level].index;e<=a&&t.f(t,i)}}};dr.log.prepareStandard=function(i){"standard"in i||(i.standard=Al[i.level].name+" ["+i.category+"] "+i.message)};dr.log.prepareFull=function(i){if(!("full"in i)){var e=[i.message];e=e.concat([]),i.full=dr.util.format.apply(this,e)}};dr.log.prepareStandardFull=function(i){"standardFull"in i||(dr.log.prepareStandard(i),i.standardFull=i.standard)};for(var fy=["error","warning","info","debug","verbose"],fa=0;fa<fy.length;++fa)(function(e){dr.log[e]=function(r,t){var a=Array.prototype.slice.call(arguments).slice(2),n={timestamp:new Date,level:e,category:r,message:t,arguments:a};dr.log.logMessage(n)}})(fy[fa]);dr.log.makeLogger=function(i){var e={flags:0,f:i};return dr.log.setLevel(e,"none"),e};dr.log.setLevel=function(i,e){var r=!1;if(i&&!(i.flags&dr.log.LEVEL_LOCKED))for(var t=0;t<dr.log.levels.length;++t){var a=dr.log.levels[t];if(e==a){i.level=e,r=!0;break}}return r};dr.log.lock=function(i,e){typeof e>"u"||e?i.flags|=dr.log.LEVEL_LOCKED:i.flags&=~dr.log.LEVEL_LOCKED};dr.log.addLogger=function(i){Jd.push(i)};if(typeof console<"u"&&"log"in console){var no;if(console.error&&console.warn&&console.info&&console.debug){var vR={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},vp=function(i,e){dr.log.prepareStandard(e);var r=vR[e.level],t=[e.standard];t=t.concat(e.arguments.slice()),r.apply(console,t)};no=dr.log.makeLogger(vp)}else{var vp=function(e,r){dr.log.prepareStandardFull(r),console.log(r.standardFull)};no=dr.log.makeLogger(vp)}dr.log.setLevel(no,"debug"),dr.log.addLogger(no),Io=no}else console={log:function(){}};if(Io!==null&&typeof window<"u"&&window.location){var Of=new URL(window.location.href).searchParams;if(Of.has("console.level")&&dr.log.setLevel(Io,Of.get("console.level").slice(-1)[0]),Of.has("console.lock")){var gR=Of.get("console.lock").slice(-1)[0];gR=="true"&&dr.log.lock(Io)}}dr.log.consoleLogger=Io;var me=or,Zt=me.asn1,pi=me.pkcs7=me.pkcs7||{};pi.messageFromPem=function(i){var e=me.pem.decode(i)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var t=Zt.fromDer(e.body);return pi.messageFromAsn1(t)};pi.messageToPem=function(i,e){var r={type:"PKCS7",body:Zt.toDer(i.toAsn1()).getBytes()};return me.pem.encode(r,{maxline:e})};pi.messageFromAsn1=function(i){var e={},r=[];if(!Zt.validate(i,pi.asn1.contentInfoValidator,e,r)){var t=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw t.errors=r,t}var a=Zt.derToOid(e.contentType),n;switch(a){case me.pki.oids.envelopedData:n=pi.createEnvelopedData();break;case me.pki.oids.encryptedData:n=pi.createEncryptedData();break;case me.pki.oids.signedData:n=pi.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+a+" is not (yet) supported.")}return n.fromAsn1(e.content.value[0]),n};pi.createSignedData=function(){var i=null;return i={type:me.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(gp(i,t,pi.asn1.signedDataValidator),i.certificates=[],i.crls=[],i.digestAlgorithmIdentifiers=[],i.contentInfo=null,i.signerInfos=[],i.rawCapture.certificates)for(var a=i.rawCapture.certificates.value,n=0;n<a.length;++n)i.certificates.push(me.pki.certificateFromAsn1(a[n]))},toAsn1:function(){i.contentInfo||i.sign();for(var t=[],a=0;a<i.certificates.length;++a)t.push(me.pki.certificateToAsn1(i.certificates[a]));var n=[],c=Zt.create(Zt.Class.CONTEXT_SPECIFIC,0,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.INTEGER,!1,Zt.integerToDer(i.version).getBytes()),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SET,!0,i.digestAlgorithmIdentifiers),i.contentInfo])]);return t.length>0&&c.value[0].value.push(Zt.create(Zt.Class.CONTEXT_SPECIFIC,0,!0,t)),n.length>0&&c.value[0].value.push(Zt.create(Zt.Class.CONTEXT_SPECIFIC,1,!0,n)),c.value[0].value.push(Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SET,!0,i.signerInfos)),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OID,!1,Zt.oidToDer(i.type).getBytes()),c])},addSigner:function(t){var a=t.issuer,n=t.serialNumber;if(t.certificate){var c=t.certificate;typeof c=="string"&&(c=me.pki.certificateFromPem(c)),a=c.issuer.attributes,n=c.serialNumber}var u=t.key;if(!u)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof u=="string"&&(u=me.pki.privateKeyFromPem(u));var v=t.digestAlgorithm||me.pki.oids.sha1;switch(v){case me.pki.oids.sha1:case me.pki.oids.sha256:case me.pki.oids.sha384:case me.pki.oids.sha512:case me.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+v)}var o=t.authenticatedAttributes||[];if(o.length>0){for(var h=!1,g=!1,y=0;y<o.length;++y){var _=o[y];if(!h&&_.type===me.pki.oids.contentType){if(h=!0,g)break;continue}if(!g&&_.type===me.pki.oids.messageDigest){if(g=!0,h)break;continue}}if(!h||!g)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}i.signers.push({key:u,version:1,issuer:a,serialNumber:n,digestAlgorithm:v,signatureAlgorithm:me.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:o,unauthenticatedAttributes:[]})},sign:function(t){if(t=t||{},(typeof i.content!="object"||i.contentInfo===null)&&(i.contentInfo=Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OID,!1,Zt.oidToDer(me.pki.oids.data).getBytes())]),"content"in i)){var a;i.content instanceof me.util.ByteBuffer?a=i.content.bytes():typeof i.content=="string"&&(a=me.util.encodeUtf8(i.content)),t.detached?i.detachedContent=Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OCTETSTRING,!1,a):i.contentInfo.value.push(Zt.create(Zt.Class.CONTEXT_SPECIFIC,0,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OCTETSTRING,!1,a)]))}if(i.signers.length!==0){var n=e();r(n)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){typeof t=="string"&&(t=me.pki.certificateFromPem(t)),i.certificates.push(t)},addCertificateRevokationList:function(t){throw new Error("PKCS#7 CRL support not yet implemented.")}},i;function e(){for(var t={},a=0;a<i.signers.length;++a){var n=i.signers[a],c=n.digestAlgorithm;c in t||(t[c]=me.md[me.pki.oids[c]].create()),n.authenticatedAttributes.length===0?n.md=t[c]:n.md=me.md[me.pki.oids[c]].create()}i.digestAlgorithmIdentifiers=[];for(var c in t)i.digestAlgorithmIdentifiers.push(Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OID,!1,Zt.oidToDer(c).getBytes()),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.NULL,!1,"")]));return t}function r(t){var a;if(i.detachedContent?a=i.detachedContent:(a=i.contentInfo.value[1],a=a.value[0]),!a)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var n=Zt.derToOid(i.contentInfo.value[0].value),c=Zt.toDer(a);c.getByte(),Zt.getBerValueLength(c),c=c.getBytes();for(var u in t)t[u].start().update(c);for(var v=new Date,o=0;o<i.signers.length;++o){var h=i.signers[o];if(h.authenticatedAttributes.length===0){if(n!==me.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{h.authenticatedAttributesAsn1=Zt.create(Zt.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var g=Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SET,!0,[]),y=0;y<h.authenticatedAttributes.length;++y){var _=h.authenticatedAttributes[y];_.type===me.pki.oids.messageDigest?_.value=t[h.digestAlgorithm].digest():_.type===me.pki.oids.signingTime&&(_.value||(_.value=v)),g.value.push(t1(_)),h.authenticatedAttributesAsn1.value.push(t1(_))}c=Zt.toDer(g).getBytes(),h.md.start().update(c)}h.signature=h.key.sign(h.md,"RSASSA-PKCS1-V1_5")}i.signerInfos=CR(i.signers)}};pi.createEncryptedData=function(){var i=null;return i={type:me.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:me.pki.oids["aes256-CBC"]},fromAsn1:function(e){gp(i,e,pi.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(i.encryptedContent.key=e),W4(i)}},i};pi.createEnvelopedData=function(){var i=null;return i={type:me.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:me.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=gp(i,e,pi.asn1.envelopedDataValidator);i.recipients=bR(r.recipientInfos.value)},toAsn1:function(){return Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OID,!1,Zt.oidToDer(i.type).getBytes()),Zt.create(Zt.Class.CONTEXT_SPECIFIC,0,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.INTEGER,!1,Zt.integerToDer(i.version).getBytes()),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SET,!0,_R(i.recipients)),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,ER(i.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,t=0;t<i.recipients.length;++t){var a=i.recipients[t],n=a.issuer;if(a.serialNumber===e.serialNumber&&n.length===r.length){for(var c=!0,u=0;u<r.length;++u)if(n[u].type!==r[u].type||n[u].value!==r[u].value){c=!1;break}if(c)return a}}return null},decrypt:function(e,r){if(i.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case me.pki.oids.rsaEncryption:case me.pki.oids.desCBC:var t=r.decrypt(e.encryptedContent.content);i.encryptedContent.key=me.util.createBuffer(t);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}W4(i)},addRecipient:function(e){i.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:me.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(i.encryptedContent.content===void 0){r=r||i.encryptedContent.algorithm,e=e||i.encryptedContent.key;var t,a,n;switch(r){case me.pki.oids["aes128-CBC"]:t=16,a=16,n=me.aes.createEncryptionCipher;break;case me.pki.oids["aes192-CBC"]:t=24,a=16,n=me.aes.createEncryptionCipher;break;case me.pki.oids["aes256-CBC"]:t=32,a=16,n=me.aes.createEncryptionCipher;break;case me.pki.oids["des-EDE3-CBC"]:t=24,a=8,n=me.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=me.util.createBuffer(me.random.getBytes(t));else if(e.length()!=t)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+t+".");i.encryptedContent.algorithm=r,i.encryptedContent.key=e,i.encryptedContent.parameter=me.util.createBuffer(me.random.getBytes(a));var c=n(e);if(c.start(i.encryptedContent.parameter.copy()),c.update(i.content),!c.finish())throw new Error("Symmetric encryption failed.");i.encryptedContent.content=c.output}for(var u=0;u<i.recipients.length;++u){var v=i.recipients[u];if(v.encryptedContent.content===void 0)switch(v.encryptedContent.algorithm){case me.pki.oids.rsaEncryption:v.encryptedContent.content=v.encryptedContent.key.encrypt(i.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+v.encryptedContent.algorithm)}}}},i};function mR(i){var e={},r=[];if(!Zt.validate(i,pi.asn1.recipientInfoValidator,e,r)){var t=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw t.errors=r,t}return{version:e.version.charCodeAt(0),issuer:me.pki.RDNAttributesAsArray(e.issuer),serialNumber:me.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:Zt.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function yR(i){return Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.INTEGER,!1,Zt.integerToDer(i.version).getBytes()),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[me.pki.distinguishedNameToAsn1({attributes:i.issuer}),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.INTEGER,!1,me.util.hexToBytes(i.serialNumber))]),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OID,!1,Zt.oidToDer(i.encryptedContent.algorithm).getBytes()),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.NULL,!1,"")]),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OCTETSTRING,!1,i.encryptedContent.content)])}function bR(i){for(var e=[],r=0;r<i.length;++r)e.push(mR(i[r]));return e}function _R(i){for(var e=[],r=0;r<i.length;++r)e.push(yR(i[r]));return e}function wR(i){var e=Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.INTEGER,!1,Zt.integerToDer(i.version).getBytes()),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[me.pki.distinguishedNameToAsn1({attributes:i.issuer}),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.INTEGER,!1,me.util.hexToBytes(i.serialNumber))]),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OID,!1,Zt.oidToDer(i.digestAlgorithm).getBytes()),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.NULL,!1,"")])]);if(i.authenticatedAttributesAsn1&&e.value.push(i.authenticatedAttributesAsn1),e.value.push(Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OID,!1,Zt.oidToDer(i.signatureAlgorithm).getBytes()),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.NULL,!1,"")])),e.value.push(Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OCTETSTRING,!1,i.signature)),i.unauthenticatedAttributes.length>0){for(var r=Zt.create(Zt.Class.CONTEXT_SPECIFIC,1,!0,[]),t=0;t<i.unauthenticatedAttributes.length;++t){var a=i.unauthenticatedAttributes[t];r.values.push(t1(a))}e.value.push(r)}return e}function CR(i){for(var e=[],r=0;r<i.length;++r)e.push(wR(i[r]));return e}function t1(i){var e;if(i.type===me.pki.oids.contentType)e=Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OID,!1,Zt.oidToDer(i.value).getBytes());else if(i.type===me.pki.oids.messageDigest)e=Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OCTETSTRING,!1,i.value.bytes());else if(i.type===me.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),t=new Date("2050-01-01T00:00:00Z"),a=i.value;if(typeof a=="string"){var n=Date.parse(a);isNaN(n)?a.length===13?a=Zt.utcTimeToDate(a):a=Zt.generalizedTimeToDate(a):a=new Date(n)}a>=r&&a<t?e=Zt.create(Zt.Class.UNIVERSAL,Zt.Type.UTCTIME,!1,Zt.dateToUtcTime(a)):e=Zt.create(Zt.Class.UNIVERSAL,Zt.Type.GENERALIZEDTIME,!1,Zt.dateToGeneralizedTime(a))}return Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OID,!1,Zt.oidToDer(i.type).getBytes()),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SET,!0,[e])])}function ER(i){return[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OID,!1,Zt.oidToDer(me.pki.oids.data).getBytes()),Zt.create(Zt.Class.UNIVERSAL,Zt.Type.SEQUENCE,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OID,!1,Zt.oidToDer(i.algorithm).getBytes()),i.parameter?Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OCTETSTRING,!1,i.parameter.getBytes()):void 0]),Zt.create(Zt.Class.CONTEXT_SPECIFIC,0,!0,[Zt.create(Zt.Class.UNIVERSAL,Zt.Type.OCTETSTRING,!1,i.content.getBytes())])]}function gp(i,e,r){var t={},a=[];if(!Zt.validate(e,r,t,a)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw n.errors=n,n}var c=Zt.derToOid(t.contentType);if(c!==me.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(t.encryptedContent){var u="";if(me.util.isArray(t.encryptedContent))for(var v=0;v<t.encryptedContent.length;++v){if(t.encryptedContent[v].type!==Zt.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");u+=t.encryptedContent[v].value}else u=t.encryptedContent;i.encryptedContent={algorithm:Zt.derToOid(t.encAlgorithm),parameter:me.util.createBuffer(t.encParameter.value),content:me.util.createBuffer(u)}}if(t.content){var u="";if(me.util.isArray(t.content))for(var v=0;v<t.content.length;++v){if(t.content[v].type!==Zt.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");u+=t.content[v].value}else u=t.content;i.content=me.util.createBuffer(u)}return i.version=t.version.charCodeAt(0),i.rawCapture=t,t}function W4(i){if(i.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(i.content===void 0){var e;switch(i.encryptedContent.algorithm){case me.pki.oids["aes128-CBC"]:case me.pki.oids["aes192-CBC"]:case me.pki.oids["aes256-CBC"]:e=me.aes.createDecryptionCipher(i.encryptedContent.key);break;case me.pki.oids.desCBC:case me.pki.oids["des-EDE3-CBC"]:e=me.des.createDecryptionCipher(i.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+i.encryptedContent.algorithm)}if(e.start(i.encryptedContent.parameter),e.update(i.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");i.content=e.output}}var zr=or,pc=zr.ssh=zr.ssh||{};pc.privateKeyToPutty=function(i,e,r){r=r||"",e=e||"";var t="ssh-rsa",a=e===""?"none":"aes256-cbc",n="PuTTY-User-Key-File-2: "+t+`\r
`;n+="Encryption: "+a+`\r
`,n+="Comment: "+r+`\r
`;var c=zr.util.createBuffer();us(c,t),mn(c,i.e),mn(c,i.n);var u=zr.util.encode64(c.bytes(),64),v=Math.floor(u.length/66)+1;n+="Public-Lines: "+v+`\r
`,n+=u;var o=zr.util.createBuffer();mn(o,i.d),mn(o,i.p),mn(o,i.q),mn(o,i.qInv);var h;if(!e)h=zr.util.encode64(o.bytes(),64);else{var g=o.length()+16-1;g-=g%16;var y=Ff(o.bytes());y.truncate(y.length()-g+o.length()),o.putBuffer(y);var _=zr.util.createBuffer();_.putBuffer(Ff("\0\0\0\0",e)),_.putBuffer(Ff("\0\0\0",e));var A=zr.aes.createEncryptionCipher(_.truncate(8),"CBC");A.start(zr.util.createBuffer().fillWithByte(0,16)),A.update(o.copy()),A.finish();var S=A.output;S.truncate(16),h=zr.util.encode64(S.bytes(),64)}v=Math.floor(h.length/66)+1,n+=`\r
Private-Lines: `+v+`\r
`,n+=h;var T=Ff("putty-private-key-file-mac-key",e),B=zr.util.createBuffer();us(B,t),us(B,a),us(B,r),B.putInt32(c.length()),B.putBuffer(c),B.putInt32(o.length()),B.putBuffer(o);var M=zr.hmac.create();return M.start("sha1",T),M.update(B.bytes()),n+=`\r
Private-MAC: `+M.digest().toHex()+`\r
`,n};pc.publicKeyToOpenSSH=function(i,e){var r="ssh-rsa";e=e||"";var t=zr.util.createBuffer();return us(t,r),mn(t,i.e),mn(t,i.n),r+" "+zr.util.encode64(t.bytes())+" "+e};pc.privateKeyToOpenSSH=function(i,e){return e?zr.pki.encryptRsaPrivateKey(i,e,{legacy:!0,algorithm:"aes128"}):zr.pki.privateKeyToPem(i)};pc.getPublicKeyFingerprint=function(i,e){e=e||{};var r=e.md||zr.md.md5.create(),t="ssh-rsa",a=zr.util.createBuffer();us(a,t),mn(a,i.e),mn(a,i.n),r.start(),r.update(a.getBytes());var n=r.digest();if(e.encoding==="hex"){var c=n.toHex();return e.delimiter?c.match(/.{2}/g).join(e.delimiter):c}else{if(e.encoding==="binary")return n.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return n};function mn(i,e){var r=e.toString(16);r[0]>="8"&&(r="00"+r);var t=zr.util.hexToBytes(r);i.putInt32(t.length),i.putBytes(t)}function us(i,e){i.putInt32(e.length),i.putString(e)}function Ff(){for(var i=zr.md.sha1.create(),e=arguments.length,r=0;r<e;++r)i.update(arguments[r]);return i.digest()}var MR=or;export{e1 as a,Ko as b,di as c,IR as d,SR as g,MR as l,c1 as r};
